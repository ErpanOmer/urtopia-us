{% comment %}
  Renders the collection filters component
  
  Usage:
  {% render 'collection-filters' %}
{% endcomment %}

<style>
  /* Filters Component Styles - Using 1rem = 10px base */
  .filters {
    font-size: 1.4rem; /* 14px */
  }

  /* Filter Header */
  .filters__header {
    padding: 1.6rem 0;
    border-bottom: 1px solid #EBEDF0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .filters__results-count {
    font-size: 1.2rem; /* 12px */
    font-weight: 500;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: #242729;
  }

  .filters__results-count .highlight {
    color: #00A3E0;
  }

  .filters__clear-link {
    font-size: 1.4rem; /* 14px */
    color: #00A3E0;
    text-decoration: none;
    cursor: pointer;
    transition: opacity 0.2s;
  }

  .filters__clear-link:hover {
    opacity: 0.7;
  }

  /* Filter Section */
  .filters__section {
    border-bottom: 1px solid #EBEDF0;
  }

  .filters__section-header {
    padding: 1.6rem 0;
    cursor: pointer;
    user-select: none;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .filters__section-title {
    font-size: 1.2rem; /* 12px */
    font-weight: 500;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: #242729;
  }

  .filters__section-arrow {
    width: 1rem;
    height: 1rem;
    transition: transform 0.3s ease;
  }

  .filters__section.is-collapsed .filters__section-arrow {
    transform: rotate(180deg);
  }

  .filters__section-content {
    padding-bottom: 2rem;
    overflow: hidden;
    transition: max-height 0.3s ease, opacity 0.3s ease, padding 0.3s ease;
  }

  .filters__section.is-collapsed .filters__section-content {
    max-height: 0 !important;
    padding-bottom: 0;
    opacity: 0;
  }

  /* Ensure last item has proper spacing */
  .filters__options-list li:last-child {
    margin-bottom: 0;
  }

  /* Filter Options List */
  .filters__options-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1.2rem; /* 12px */
  }

  /* Radio Option (Collections) */
  .filters__radio-option {
    display: flex;
    align-items: center;
    gap: 1rem; /* 10px */
    cursor: pointer;
    position: relative;
  }

  .filters__radio-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .filters__radio-circle {
    width: 1.4rem; /* 14px */
    height: 1.4rem; /* 14px */
    border: 1.5px solid #A0A1A2;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: border-color 0.2s;
  }

  .filters__radio-circle-inner {
    width: 0.8rem; /* 8px */
    height: 0.8rem; /* 8px */
    background-color: #242729;
    border-radius: 50%;
    opacity: 0;
    transform: scale(0);
    transition: opacity 0.2s, transform 0.2s;
  }

  .filters__radio-option input[type="radio"]:checked + .filters__radio-circle {
    border-color: #242729;
  }

  .filters__radio-option input[type="radio"]:checked + .filters__radio-circle .filters__radio-circle-inner {
    opacity: 1;
    transform: scale(1);
  }

  .filters__option-label {
    font-size: 1.4rem; /* 14px */
    color: #242729;
    line-height: 1.4;
  }

  /* Checkbox Option (Price, Range, Max Speed) */
  .filters__checkbox-option {
    display: flex;
    align-items: center;
    gap: 1rem; /* 10px */
    cursor: pointer;
    position: relative;
  }

  .filters__checkbox-option input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .filters__checkbox-box {
    width: 1.6rem; /* 16px */
    height: 1.6rem; /* 16px */
    border: 1.5px solid #A0A1A2;
    border-radius: 0.3rem; /* 3px */
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: background-color 0.2s, border-color 0.2s;
  }

  .filters__checkbox-check {
    opacity: 0;
    transform: scale(0);
    transition: opacity 0.2s, transform 0.2s;
  }

  .filters__checkbox-option input[type="checkbox"]:checked + .filters__checkbox-box {
    background-color: #00A3E0;
    border-color: #00A3E0;
  }

  .filters__checkbox-option input[type="checkbox"]:checked + .filters__checkbox-box .filters__checkbox-check {
    opacity: 1;
    transform: scale(1);
  }

  .filters__option-count {
    color: #A0A1A2;
    font-size: 1.4rem; /* 14px */
  }
</style>

<div class="filters__header">
  <span class="filters__results-count">
    <span class="highlight js-results-shown">0</span> OF <span class="js-results-total">1</span> RESULTS
  </span>
  <a href="#" class="filters__clear-link js-clear-filters">Clear filters (<span class="js-active-count">1</span>)</a>
</div>

<!-- Model Section -->
<div class="filters__section" data-filter-section="model">
  <div class="filters__section-header">
    <span class="filters__section-title">Model</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="all">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">All</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="carbon-series">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Carbon Series</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="carbon-joy">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Carbon Joy</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="carbon-fold-series">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Carbon Fold Series</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="carbon-st">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Carbon ST</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="carbon-fusion">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Carbon Fusion</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="smart-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Smart E-bikes</span>
        </label>
      </li>
    </ul>
  </div>
</div>

<!-- Category Section -->
<div class="filters__section" data-filter-section="category">
  <div class="filters__section-header">
    <span class="filters__section-title">Category</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="all">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">All</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="lightweight-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Lightweight Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="commuter-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Commuter Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="cruiser-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Cruiser Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="step-through-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Step-Through Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="folding-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Folding Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="fat-tire-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Fat Tire Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="utility-cargo-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Utility&Cargo Ebikes</span>
        </label>
      </li>
      <li>
        <label class="filters__radio-option">
          <input type="radio" name="collection" value="off-road-ebikes">
          <span class="filters__radio-circle">
            <span class="filters__radio-circle-inner"></span>
          </span>
          <span class="filters__option-label">Off Road Ebikes</span>
        </label>
      </li>
    </ul>
  </div>
</div>

<!-- PRICE Section -->
<div class="filters__section" data-filter-section="price">
  <div class="filters__section-header">
    <span class="filters__section-title">PRICE</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="price" value="price-1500-2000">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">$1,500 to $2,000<span class="filters__option-count">(0)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="price" value="price-2000-2500">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">$2,000 to $2,500 <span class="filters__option-count">(0)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="price" value="over-2000">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">Over $2,500 <span class="filters__option-count">(1)</span></span>
        </label>
      </li>
    </ul>
  </div>
</div>

<!-- RANGE Section -->
<div class="filters__section" data-filter-section="range">
  <div class="filters__section-header">
    <span class="filters__section-title">RANGE</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="range" value="range-40-49">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">40 miles - 49 miles <span class="filters__option-count">(1)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="range" value="range-50-59">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">50 miles - 59 miles <span class="filters__option-count">(1)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="range" value="range-60-69">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">60 miles - 69 miles <span class="filters__option-count">(0)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="range" value="range-70-79">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">70 miles - 79 miles <span class="filters__option-count">(6)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="range" value="range-80-89">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">80 miles - 89 miles <span class="filters__option-count">(2)</span></span>
        </label>
      </li>
    </ul>
  </div>
</div>

<!-- WEIGHT Section -->
<div class="filters__section" data-filter-section="weight">
  <div class="filters__section-header">
    <span class="filters__section-title">WEIGHT</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="weight" value="weight-under-30">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">Under 30 lbs <span class="filters__option-count">(1)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="weight" value="weight-30-40">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">30 lbs - 40 lbs <span class="filters__option-count">(6)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="weight" value="weight-40-50">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">40 lbs - 50 lbs <span class="filters__option-count">(4)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="weight" value="weight-over-50">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">Over 50 lbs <span class="filters__option-count">(0)</span></span>
        </label>
      </li>
    </ul>
  </div>
</div>

<!-- THROTTLE INCLUDED Section -->
<div class="filters__section" data-filter-section="throttle">
  <div class="filters__section-header">
    <span class="filters__section-title">THROTTLE INCLUDED</span>
    <svg class="filters__section-arrow" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L5 5L9 1" stroke="#242729" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  <div class="filters__section-content">
    <ul class="filters__options-list">
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="throttle" value="throttle-yes">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">Includes throttle <span class="filters__option-count">(7)</span></span>
        </label>
      </li>
      <li>
        <label class="filters__checkbox-option">
          <input type="checkbox" name="throttle" value="throttle-no">
          <span class="filters__checkbox-box">
            <svg class="filters__checkbox-check" width="10" height="8" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="filters__option-label">Does not include throttle <span class="filters__option-count">(3)</span></span>
        </label>
      </li>
    </ul>
  </div>
</div>

<script>
/**
 * Collection Filters Component
 * A clean, modular filter system using jQuery
 */
(function($) {
  'use strict';

  // Filters Module
  var Filters = {
    $container: null,

    // Initialize the filters
    init: function() {
      this.$container = $('.filters');
      if (!this.$container.length) return;

      this.bindEvents();
      this.initAccordions();
      this.updateCount();
    },

    // Bind all event handlers
    bindEvents: function() {
      var self = this;

      // Accordion toggle
      this.$container.on('click', '.filters__section-header', function() {
        self.toggleSection($(this).closest('.filters__section'));
      });

      // Filter change
      this.$container.on('change', 'input[type="checkbox"], input[type="radio"]', function() {
        self.onFilterChange($(this));
      });

      // Clear all
      this.$container.on('click', '.js-clear-filters', function(e) {
        e.preventDefault();
        self.clearAll();
      });
    },

    // Initialize accordion heights
    initAccordions: function() {
      this.$container.find('.filters__section-content').each(function() {
        var $content = $(this);
        var $section = $content.closest('.filters__section');
        
        if (!$section.hasClass('is-collapsed')) {
          $content.css('max-height', $content.prop('scrollHeight') + 'px');
        }
      });
    },

    // Toggle accordion section
    toggleSection: function($section) {
      var $content = $section.find('.filters__section-content');
      
      $section.toggleClass('is-collapsed');
      
      if ($section.hasClass('is-collapsed')) {
        $content.css('max-height', 0);
      } else {
        $content.css('max-height', $content.prop('scrollHeight') + 'px');
      }
    },

    // Handle filter change
    onFilterChange: function($input) {
      this.updateCount();
      
      // Trigger custom event
      $(document).trigger('filters:changed', {
        type: $input.attr('name'),
        value: $input.val(),
        checked: $input.is(':checked')
      });
    },

    // Update active filter count
    updateCount: function() {
      var count = 0;
      
      // Count checkboxes
      count += this.$container.find('input[type="checkbox"]:checked').length;
      
      // Count radio groups (each group = 1)
      var radioGroups = {};
      this.$container.find('input[type="radio"]:checked').each(function() {
        radioGroups[$(this).attr('name')] = true;
      });
      count += Object.keys(radioGroups).length;
      
      // Update UI
      this.$container.find('.js-active-count').text(count);
      this.$container.find('.js-clear-filters').toggle(count > 0);
    },

    // Clear all filters
    clearAll: function() {
      this.$container.find('input[type="checkbox"]').prop('checked', false);
      this.$container.find('input[type="radio"]').prop('checked', false);
      
      this.updateCount();
      
      // Trigger custom event
      $(document).trigger('filters:cleared');
    },

    // Get current filter state (for external use)
    getState: function() {
      var state = {};
      
      this.$container.find('input:checked').each(function() {
        var name = $(this).attr('name');
        var value = $(this).val();
        
        if (!state[name]) {
          state[name] = [];
        }
        state[name].push(value);
      });
      
      return state;
    }
  };

  // Initialize on DOM ready
  $(function() {
    Filters.init();
    
    // Expose to global scope for external access
    window.CollectionFilters = Filters;
  });

})(jQuery);
</script>

