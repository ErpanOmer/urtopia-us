<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="module" crossorigin>var Z5=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var mae=Z5((ka,Na)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const y of d)if(y.type==="childList")for(const w of y.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&c(w)}).observe(document,{childList:!0,subtree:!0});function o(d){const y={};return d.integrity&&(y.integrity=d.integrity),d.referrerPolicy&&(y.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?y.credentials="include":d.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(d){if(d.ep)return;d.ep=!0;const y=o(d);fetch(d.href,y)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function n2(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const vi={},Wf=[],Cl=()=>{},Y5=()=>!1,Yv=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),r2=e=>e.startsWith("onUpdate:"),bo=Object.assign,i2=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},X5=Object.prototype.hasOwnProperty,ti=(e,t)=>X5.call(e,t),ur=Array.isArray,qf=e=>Xv(e)==="[object Map]",iD=e=>Xv(e)==="[object Set]",vr=e=>typeof e=="function",Zi=e=>typeof e=="string",Mu=e=>typeof e=="symbol",Mi=e=>e!==null&&typeof e=="object",oD=e=>(Mi(e)||vr(e))&&vr(e.then)&&vr(e.catch),aD=Object.prototype.toString,Xv=e=>aD.call(e),K5=e=>Xv(e).slice(8,-1),sD=e=>Xv(e)==="[object Object]",o2=e=>Zi(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,$g=n2(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kv=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},J5=/-(\w)/g,El=Kv(e=>e.replace(J5,(t,o)=>o?o.toUpperCase():"")),Q5=/\B([A-Z])/g,yh=Kv(e=>e.replace(Q5,"-$1").toLowerCase()),a2=Kv(e=>e.charAt(0).toUpperCase()+e.slice(1)),F1=Kv(e=>e?`on${a2(e)}`:""),wu=(e,t)=>!Object.is(e,t),B1=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},lD=(e,t,o,c=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:c,value:o})},ek=e=>{const t=parseFloat(e);return isNaN(t)?e:t},tk=e=>{const t=Zi(e)?Number(e):NaN;return isNaN(t)?e:t};let $I;const Jv=()=>$I||($I=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qv(e){if(ur(e)){const t={};for(let o=0;o<e.length;o++){const c=e[o],d=Zi(c)?ok(c):Qv(c);if(d)for(const y in d)t[y]=d[y]}return t}else if(Zi(e)||Mi(e))return e}const nk=/;(?![^(]*\))/g,rk=/:([^]+)/,ik=/\/\*[^]*?\*\//g;function ok(e){const t={};return e.replace(ik,"").split(nk).forEach(o=>{if(o){const c=o.split(rk);c.length>1&&(t[c[0].trim()]=c[1].trim())}}),t}function np(e){let t="";if(Zi(e))t=e;else if(ur(e))for(let o=0;o<e.length;o++){const c=np(e[o]);c&&(t+=c+" ")}else if(Mi(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const ak="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",sk=n2(ak);function cD(e){return!!e||e===""}const uD=e=>!!(e&&e.__v_isRef===!0),Gr=e=>Zi(e)?e:e==null?"":ur(e)||Mi(e)&&(e.toString===aD||!vr(e.toString))?uD(e)?Gr(e.value):JSON.stringify(e,dD,2):String(e),dD=(e,t)=>uD(t)?dD(e,t.value):qf(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[c,d],y)=>(o[k1(c,y)+" =>"]=d,o),{})}:iD(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>k1(o))}:Mu(t)?k1(t):Mi(t)&&!ur(t)&&!sD(t)?String(t):t,k1=(e,t="")=>{var o;return Mu(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let za;class lk{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=za,!t&&za&&(this.index=(za.scopes||(za.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=za;try{return za=this,t()}finally{za=o}}}on(){za=this}off(){za=this.parent}stop(t){if(this._active){this._active=!1;let o,c;for(o=0,c=this.effects.length;o<c;o++)this.effects[o].stop();for(this.effects.length=0,o=0,c=this.cleanups.length;o<c;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,c=this.scopes.length;o<c;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function ck(){return za}let Ti;const N1=new WeakSet;class hD{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,za&&za.active&&za.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,N1.has(this)&&(N1.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||pD(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,FI(this),mD(this);const t=Ti,o=Us;Ti=this,Us=!0;try{return this.fn()}finally{gD(this),Ti=t,Us=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)c2(t);this.deps=this.depsTail=void 0,FI(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?N1.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Fw(this)&&this.run()}get dirty(){return Fw(this)}}let fD=0,Fg,Bg;function pD(e,t=!1){if(e.flags|=8,t){e.next=Bg,Bg=e;return}e.next=Fg,Fg=e}function s2(){fD++}function l2(){if(--fD>0)return;if(Bg){let t=Bg;for(Bg=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;Fg;){let t=Fg;for(Fg=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(c){e||(e=c)}t=o}}if(e)throw e}function mD(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function gD(e){let t,o=e.depsTail,c=o;for(;c;){const d=c.prevDep;c.version===-1?(c===o&&(o=d),c2(c),uk(c)):t=c,c.dep.activeLink=c.prevActiveLink,c.prevActiveLink=void 0,c=d}e.deps=t,e.depsTail=o}function Fw(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(_D(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function _D(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Qg))return;e.globalVersion=Qg;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Fw(e)){e.flags&=-3;return}const o=Ti,c=Us;Ti=e,Us=!0;try{mD(e);const d=e.fn(e._value);(t.version===0||wu(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{Ti=o,Us=c,gD(e),e.flags&=-3}}function c2(e,t=!1){const{dep:o,prevSub:c,nextSub:d}=e;if(c&&(c.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=c,e.nextSub=void 0),o.subs===e&&(o.subs=c,!c&&o.computed)){o.computed.flags&=-5;for(let y=o.computed.deps;y;y=y.nextDep)c2(y,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function uk(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Us=!0;const yD=[];function Iu(){yD.push(Us),Us=!1}function Au(){const e=yD.pop();Us=e===void 0?!0:e}function FI(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Ti;Ti=void 0;try{t()}finally{Ti=o}}}let Qg=0;class dk{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class u2{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ti||!Us||Ti===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Ti)o=this.activeLink=new dk(Ti,this),Ti.deps?(o.prevDep=Ti.depsTail,Ti.depsTail.nextDep=o,Ti.depsTail=o):Ti.deps=Ti.depsTail=o,vD(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const c=o.nextDep;c.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=c),o.prevDep=Ti.depsTail,o.nextDep=void 0,Ti.depsTail.nextDep=o,Ti.depsTail=o,Ti.deps===o&&(Ti.deps=c)}return o}trigger(t){this.version++,Qg++,this.notify(t)}notify(t){s2();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{l2()}}}function vD(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let c=t.deps;c;c=c.nextDep)vD(c)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const yv=new WeakMap,nh=Symbol(""),Bw=Symbol(""),e_=Symbol("");function Ho(e,t,o){if(Us&&Ti){let c=yv.get(e);c||yv.set(e,c=new Map);let d=c.get(o);d||(c.set(o,d=new u2),d.map=c,d.key=o),d.track()}}function fc(e,t,o,c,d,y){const w=yv.get(e);if(!w){Qg++;return}const i=O=>{O&&O.trigger()};if(s2(),t==="clear")w.forEach(i);else{const O=ur(e),L=O&&o2(o);if(O&&o==="length"){const z=Number(c);w.forEach((F,N)=>{(N==="length"||N===e_||!Mu(N)&&N>=z)&&i(F)})}else switch((o!==void 0||w.has(void 0))&&i(w.get(o)),L&&i(w.get(e_)),t){case"add":O?L&&i(w.get("length")):(i(w.get(nh)),qf(e)&&i(w.get(Bw)));break;case"delete":O||(i(w.get(nh)),qf(e)&&i(w.get(Bw)));break;case"set":qf(e)&&i(w.get(nh));break}}l2()}function hk(e,t){const o=yv.get(e);return o&&o.get(t)}function Rf(e){const t=Ir(e);return t===e?t:(Ho(t,"iterate",e_),fs(e)?t:t.map(Go))}function ex(e){return Ho(e=Ir(e),"iterate",e_),e}const fk={__proto__:null,[Symbol.iterator](){return V1(this,Symbol.iterator,Go)},concat(...e){return Rf(this).concat(...e.map(t=>ur(t)?Rf(t):t))},entries(){return V1(this,"entries",e=>(e[1]=Go(e[1]),e))},every(e,t){return lc(this,"every",e,t,void 0,arguments)},filter(e,t){return lc(this,"filter",e,t,o=>o.map(Go),arguments)},find(e,t){return lc(this,"find",e,t,Go,arguments)},findIndex(e,t){return lc(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return lc(this,"findLast",e,t,Go,arguments)},findLastIndex(e,t){return lc(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return lc(this,"forEach",e,t,void 0,arguments)},includes(...e){return j1(this,"includes",e)},indexOf(...e){return j1(this,"indexOf",e)},join(e){return Rf(this).join(e)},lastIndexOf(...e){return j1(this,"lastIndexOf",e)},map(e,t){return lc(this,"map",e,t,void 0,arguments)},pop(){return vg(this,"pop")},push(...e){return vg(this,"push",e)},reduce(e,...t){return BI(this,"reduce",e,t)},reduceRight(e,...t){return BI(this,"reduceRight",e,t)},shift(){return vg(this,"shift")},some(e,t){return lc(this,"some",e,t,void 0,arguments)},splice(...e){return vg(this,"splice",e)},toReversed(){return Rf(this).toReversed()},toSorted(e){return Rf(this).toSorted(e)},toSpliced(...e){return Rf(this).toSpliced(...e)},unshift(...e){return vg(this,"unshift",e)},values(){return V1(this,"values",Go)}};function V1(e,t,o){const c=ex(e),d=c[t]();return c!==e&&!fs(e)&&(d._next=d.next,d.next=()=>{const y=d._next();return y.value&&(y.value=o(y.value)),y}),d}const pk=Array.prototype;function lc(e,t,o,c,d,y){const w=ex(e),i=w!==e&&!fs(e),O=w[t];if(O!==pk[t]){const F=O.apply(e,y);return i?Go(F):F}let L=o;w!==e&&(i?L=function(F,N){return o.call(this,Go(F),N,e)}:o.length>2&&(L=function(F,N){return o.call(this,F,N,e)}));const z=O.call(w,L,c);return i&&d?d(z):z}function BI(e,t,o,c){const d=ex(e);let y=o;return d!==e&&(fs(e)?o.length>3&&(y=function(w,i,O){return o.call(this,w,i,O,e)}):y=function(w,i,O){return o.call(this,w,Go(i),O,e)}),d[t](y,...c)}function j1(e,t,o){const c=Ir(e);Ho(c,"iterate",e_);const d=c[t](...o);return(d===-1||d===!1)&&f2(o[0])?(o[0]=Ir(o[0]),c[t](...o)):d}function vg(e,t,o=[]){Iu(),s2();const c=Ir(e)[t].apply(e,o);return l2(),Au(),c}const mk=n2("__proto__,__v_isRef,__isVue"),xD=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Mu));function gk(e){Mu(e)||(e=String(e));const t=Ir(this);return Ho(t,"has",e),t.hasOwnProperty(e)}class bD{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,c){if(o==="__v_skip")return t.__v_skip;const d=this._isReadonly,y=this._isShallow;if(o==="__v_isReactive")return!d;if(o==="__v_isReadonly")return d;if(o==="__v_isShallow")return y;if(o==="__v_raw")return c===(d?y?Ek:TD:y?CD:SD).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(c)?t:void 0;const w=ur(t);if(!d){let O;if(w&&(O=fk[o]))return O;if(o==="hasOwnProperty")return gk}const i=Reflect.get(t,o,lo(t)?t:c);return(Mu(o)?xD.has(o):mk(o))||(d||Ho(t,"get",o),y)?i:lo(i)?w&&o2(o)?i:i.value:Mi(i)?d?ED(i):no(i):i}}class wD extends bD{constructor(t=!1){super(!1,t)}set(t,o,c,d){let y=t[o];if(!this._isShallow){const O=uh(y);if(!fs(c)&&!uh(c)&&(y=Ir(y),c=Ir(c)),!ur(t)&&lo(y)&&!lo(c))return O?!1:(y.value=c,!0)}const w=ur(t)&&o2(o)?Number(o)<t.length:ti(t,o),i=Reflect.set(t,o,c,lo(t)?t:d);return t===Ir(d)&&(w?wu(c,y)&&fc(t,"set",o,c):fc(t,"add",o,c)),i}deleteProperty(t,o){const c=ti(t,o);t[o];const d=Reflect.deleteProperty(t,o);return d&&c&&fc(t,"delete",o,void 0),d}has(t,o){const c=Reflect.has(t,o);return(!Mu(o)||!xD.has(o))&&Ho(t,"has",o),c}ownKeys(t){return Ho(t,"iterate",ur(t)?"length":nh),Reflect.ownKeys(t)}}class _k extends bD{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const yk=new wD,vk=new _k,xk=new wD(!0),kw=e=>e,fy=e=>Reflect.getPrototypeOf(e);function bk(e,t,o){return function(...c){const d=this.__v_raw,y=Ir(d),w=qf(y),i=e==="entries"||e===Symbol.iterator&&w,O=e==="keys"&&w,L=d[e](...c),z=o?kw:t?Nw:Go;return!t&&Ho(y,"iterate",O?Bw:nh),{next(){const{value:F,done:N}=L.next();return N?{value:F,done:N}:{value:i?[z(F[0]),z(F[1])]:z(F),done:N}},[Symbol.iterator](){return this}}}}function py(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function wk(e,t){const o={get(d){const y=this.__v_raw,w=Ir(y),i=Ir(d);e||(wu(d,i)&&Ho(w,"get",d),Ho(w,"get",i));const{has:O}=fy(w),L=t?kw:e?Nw:Go;if(O.call(w,d))return L(y.get(d));if(O.call(w,i))return L(y.get(i));y!==w&&y.get(d)},get size(){const d=this.__v_raw;return!e&&Ho(Ir(d),"iterate",nh),Reflect.get(d,"size",d)},has(d){const y=this.__v_raw,w=Ir(y),i=Ir(d);return e||(wu(d,i)&&Ho(w,"has",d),Ho(w,"has",i)),d===i?y.has(d):y.has(d)||y.has(i)},forEach(d,y){const w=this,i=w.__v_raw,O=Ir(i),L=t?kw:e?Nw:Go;return!e&&Ho(O,"iterate",nh),i.forEach((z,F)=>d.call(y,L(z),L(F),w))}};return bo(o,e?{add:py("add"),set:py("set"),delete:py("delete"),clear:py("clear")}:{add(d){!t&&!fs(d)&&!uh(d)&&(d=Ir(d));const y=Ir(this);return fy(y).has.call(y,d)||(y.add(d),fc(y,"add",d,d)),this},set(d,y){!t&&!fs(y)&&!uh(y)&&(y=Ir(y));const w=Ir(this),{has:i,get:O}=fy(w);let L=i.call(w,d);L||(d=Ir(d),L=i.call(w,d));const z=O.call(w,d);return w.set(d,y),L?wu(y,z)&&fc(w,"set",d,y):fc(w,"add",d,y),this},delete(d){const y=Ir(this),{has:w,get:i}=fy(y);let O=w.call(y,d);O||(d=Ir(d),O=w.call(y,d)),i&&i.call(y,d);const L=y.delete(d);return O&&fc(y,"delete",d,void 0),L},clear(){const d=Ir(this),y=d.size!==0,w=d.clear();return y&&fc(d,"clear",void 0,void 0),w}}),["keys","values","entries",Symbol.iterator].forEach(d=>{o[d]=bk(d,e,t)}),o}function d2(e,t){const o=wk(e,t);return(c,d,y)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?c:Reflect.get(ti(o,d)&&d in c?o:c,d,y)}const Sk={get:d2(!1,!1)},Ck={get:d2(!1,!0)},Tk={get:d2(!0,!1)},SD=new WeakMap,CD=new WeakMap,TD=new WeakMap,Ek=new WeakMap;function Mk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ik(e){return e.__v_skip||!Object.isExtensible(e)?0:Mk(K5(e))}function no(e){return uh(e)?e:h2(e,!1,yk,Sk,SD)}function Ak(e){return h2(e,!1,xk,Ck,CD)}function ED(e){return h2(e,!0,vk,Tk,TD)}function h2(e,t,o,c,d){if(!Mi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const y=d.get(e);if(y)return y;const w=Ik(e);if(w===0)return e;const i=new Proxy(e,w===2?c:o);return d.set(e,i),i}function Zf(e){return uh(e)?Zf(e.__v_raw):!!(e&&e.__v_isReactive)}function uh(e){return!!(e&&e.__v_isReadonly)}function fs(e){return!!(e&&e.__v_isShallow)}function f2(e){return e?!!e.__v_raw:!1}function Ir(e){const t=e&&e.__v_raw;return t?Ir(t):e}function Pk(e){return!ti(e,"__v_skip")&&Object.isExtensible(e)&&lD(e,"__v_skip",!0),e}const Go=e=>Mi(e)?no(e):e,Nw=e=>Mi(e)?ED(e):e;function lo(e){return e?e.__v_isRef===!0:!1}function tn(e){return MD(e,!1)}function Xt(e){return MD(e,!0)}function MD(e,t){return lo(e)?e:new Ok(e,t)}class Ok{constructor(t,o){this.dep=new u2,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Ir(t),this._value=o?t:Go(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,c=this.__v_isShallow||fs(t)||uh(t);t=c?t:Ir(t),wu(t,o)&&(this._rawValue=t,this._value=c?t:Go(t),this.dep.trigger())}}function Dk(e){e.dep&&e.dep.trigger()}function Ar(e){return lo(e)?e.value:e}function kI(e){return vr(e)?e():Ar(e)}const Rk={get:(e,t,o)=>t==="__v_raw"?e:Ar(Reflect.get(e,t,o)),set:(e,t,o,c)=>{const d=e[t];return lo(d)&&!lo(o)?(d.value=o,!0):Reflect.set(e,t,o,c)}};function ID(e){return Zf(e)?e:new Proxy(e,Rk)}function zk(e){const t=ur(e)?new Array(e.length):{};for(const o in e)t[o]=AD(e,o);return t}class Lk{constructor(t,o,c){this._object=t,this._key=o,this._defaultValue=c,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return hk(Ir(this._object),this._key)}}class $k{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function ra(e,t,o){return lo(e)?e:vr(e)?new $k(e):Mi(e)&&arguments.length>1?AD(e,t,o):tn(e)}function AD(e,t,o){const c=e[t];return lo(c)?c:new Lk(e,t,o)}class Fk{constructor(t,o,c){this.fn=t,this.setter=o,this._value=void 0,this.dep=new u2(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Qg-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=c}notify(){if(this.flags|=16,!(this.flags&8)&&Ti!==this)return pD(this,!0),!0}get value(){const t=this.dep.track();return _D(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Bk(e,t,o=!1){let c,d;return vr(e)?c=e:(c=e.get,d=e.set),new Fk(c,d,o)}const my={},vv=new WeakMap;let Zd;function kk(e,t=!1,o=Zd){if(o){let c=vv.get(o);c||vv.set(o,c=[]),c.push(e)}}function Nk(e,t,o=vi){const{immediate:c,deep:d,once:y,scheduler:w,augmentJob:i,call:O}=o,L=ne=>d?ne:fs(ne)||d===!1||d===0?pc(ne,1):pc(ne);let z,F,N,G,Y=!1,K=!1;if(lo(e)?(F=()=>e.value,Y=fs(e)):Zf(e)?(F=()=>L(e),Y=!0):ur(e)?(K=!0,Y=e.some(ne=>Zf(ne)||fs(ne)),F=()=>e.map(ne=>{if(lo(ne))return ne.value;if(Zf(ne))return L(ne);if(vr(ne))return O?O(ne,2):ne()})):vr(e)?t?F=O?()=>O(e,2):e:F=()=>{if(N){Iu();try{N()}finally{Au()}}const ne=Zd;Zd=z;try{return O?O(e,3,[G]):e(G)}finally{Zd=ne}}:F=Cl,t&&d){const ne=F,ue=d===!0?1/0:d;F=()=>pc(ne(),ue)}const J=ck(),X=()=>{z.stop(),J&&J.active&&i2(J.effects,z)};if(y&&t){const ne=t;t=(...ue)=>{ne(...ue),X()}}let se=K?new Array(e.length).fill(my):my;const te=ne=>{if(!(!(z.flags&1)||!z.dirty&&!ne))if(t){const ue=z.run();if(d||Y||(K?ue.some((ge,ee)=>wu(ge,se[ee])):wu(ue,se))){N&&N();const ge=Zd;Zd=z;try{const ee=[ue,se===my?void 0:K&&se[0]===my?[]:se,G];O?O(t,3,ee):t(...ee),se=ue}finally{Zd=ge}}}else z.run()};return i&&i(te),z=new hD(F),z.scheduler=w?()=>w(te,!1):te,G=ne=>kk(ne,!1,z),N=z.onStop=()=>{const ne=vv.get(z);if(ne){if(O)O(ne,4);else for(const ue of ne)ue();vv.delete(z)}},t?c?te(!0):se=z.run():w?w(te.bind(null,!0),!0):z.run(),X.pause=z.pause.bind(z),X.resume=z.resume.bind(z),X.stop=X,X}function pc(e,t=1/0,o){if(t<=0||!Mi(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),t--,lo(e))pc(e.value,t,o);else if(ur(e))for(let c=0;c<e.length;c++)pc(e[c],t,o);else if(iD(e)||qf(e))e.forEach(c=>{pc(c,t,o)});else if(sD(e)){for(const c in e)pc(e[c],t,o);for(const c of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,c)&&pc(e[c],t,o)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function b_(e,t,o,c){try{return c?e(...c):e()}catch(d){tx(d,t,o)}}function Ws(e,t,o,c){if(vr(e)){const d=b_(e,t,o,c);return d&&oD(d)&&d.catch(y=>{tx(y,t,o)}),d}if(ur(e)){const d=[];for(let y=0;y<e.length;y++)d.push(Ws(e[y],t,o,c));return d}}function tx(e,t,o,c=!0){const d=t?t.vnode:null,{errorHandler:y,throwUnhandledErrorInProduction:w}=t&&t.appContext.config||vi;if(t){let i=t.parent;const O=t.proxy,L=`https://vuejs.org/error-reference/#runtime-${o}`;for(;i;){const z=i.ec;if(z){for(let F=0;F<z.length;F++)if(z[F](e,O,L)===!1)return}i=i.parent}if(y){Iu(),b_(y,null,10,[e,O,L]),Au();return}}Vk(e,o,d,c,w)}function Vk(e,t,o,c=!0,d=!1){if(d)throw e;console.error(e)}const oa=[];let yl=-1;const Yf=[];let pu=null,kf=0;const PD=Promise.resolve();let xv=null;function si(e){const t=xv||PD;return e?t.then(this?e.bind(this):e):t}function jk(e){let t=yl+1,o=oa.length;for(;t<o;){const c=t+o>>>1,d=oa[c],y=t_(d);y<e||y===e&&d.flags&2?t=c+1:o=c}return t}function p2(e){if(!(e.flags&1)){const t=t_(e),o=oa[oa.length-1];!o||!(e.flags&2)&&t>=t_(o)?oa.push(e):oa.splice(jk(t),0,e),e.flags|=1,OD()}}function OD(){xv||(xv=PD.then(RD))}function Uk(e){ur(e)?Yf.push(...e):pu&&e.id===-1?pu.splice(kf+1,0,e):e.flags&1||(Yf.push(e),e.flags|=1),OD()}function NI(e,t,o=yl+1){for(;o<oa.length;o++){const c=oa[o];if(c&&c.flags&2){if(e&&c.id!==e.uid)continue;oa.splice(o,1),o--,c.flags&4&&(c.flags&=-2),c(),c.flags&4||(c.flags&=-2)}}}function DD(e){if(Yf.length){const t=[...new Set(Yf)].sort((o,c)=>t_(o)-t_(c));if(Yf.length=0,pu){pu.push(...t);return}for(pu=t,kf=0;kf<pu.length;kf++){const o=pu[kf];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}pu=null,kf=0}}const t_=e=>e.id==null?e.flags&2?-1:1/0:e.id;function RD(e){try{for(yl=0;yl<oa.length;yl++){const t=oa[yl];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),b_(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;yl<oa.length;yl++){const t=oa[yl];t&&(t.flags&=-2)}yl=-1,oa.length=0,DD(),xv=null,(oa.length||Yf.length)&&RD()}}let ya=null,zD=null;function bv(e){const t=ya;return ya=e,zD=e&&e.type.__scopeId||null,t}function yr(e,t=ya,o){if(!t||e._n)return e;const c=(...d)=>{c._d&&eA(-1);const y=bv(t);let w;try{w=e(...d)}finally{bv(y),c._d&&eA(1)}return w};return c._n=!0,c._c=!0,c._d=!0,c}function Ns(e,t){if(ya===null)return e;const o=ox(ya),c=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[y,w,i,O=vi]=t[d];y&&(vr(y)&&(y={mounted:y,updated:y}),y.deep&&pc(w),c.push({dir:y,instance:o,value:w,oldValue:void 0,arg:i,modifiers:O}))}return e}function Vd(e,t,o,c){const d=e.dirs,y=t&&t.dirs;for(let w=0;w<d.length;w++){const i=d[w];y&&(i.oldValue=y[w].value);let O=i.dir[c];O&&(Iu(),Ws(O,o,8,[e.el,i,e,t]),Au())}}const LD=Symbol("_vte"),$D=e=>e.__isTeleport,kg=e=>e&&(e.disabled||e.disabled===""),VI=e=>e&&(e.defer||e.defer===""),jI=e=>typeof SVGElement<"u"&&e instanceof SVGElement,UI=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Vw=(e,t)=>{const o=e&&e.to;return Zi(o)?t?t(o):null:o},FD={name:"Teleport",__isTeleport:!0,process(e,t,o,c,d,y,w,i,O,L){const{mc:z,pc:F,pbc:N,o:{insert:G,querySelector:Y,createText:K,createComment:J}}=L,X=kg(t.props);let{shapeFlag:se,children:te,dynamicChildren:ne}=t;if(e==null){const ue=t.el=K(""),ge=t.anchor=K("");G(ue,o,c),G(ge,o,c);const ee=(Ie,Ee)=>{se&16&&(d&&d.isCE&&(d.ce._teleportTarget=Ie),z(te,Ie,Ee,d,y,w,i,O))},be=()=>{const Ie=t.target=Vw(t.props,Y),Ee=kD(Ie,t,K,G);Ie&&(w!=="svg"&&jI(Ie)?w="svg":w!=="mathml"&&UI(Ie)&&(w="mathml"),X||(ee(Ie,Ee),Uy(t,!1)))};X&&(ee(o,ge),Uy(t,!0)),VI(t.props)?na(()=>{be(),t.el.__isMounted=!0},y):be()}else{if(VI(t.props)&&!e.el.__isMounted){na(()=>{FD.process(e,t,o,c,d,y,w,i,O,L),delete e.el.__isMounted},y);return}t.el=e.el,t.targetStart=e.targetStart;const ue=t.anchor=e.anchor,ge=t.target=e.target,ee=t.targetAnchor=e.targetAnchor,be=kg(e.props),Ie=be?o:ge,Ee=be?ue:ee;if(w==="svg"||jI(ge)?w="svg":(w==="mathml"||UI(ge))&&(w="mathml"),ne?(N(e.dynamicChildren,ne,Ie,d,y,w,i),v2(e,t,!0)):O||F(e,t,Ie,Ee,d,y,w,i,!1),X)be?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):gy(t,o,ue,L,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const Re=t.target=Vw(t.props,Y);Re&&gy(t,Re,null,L,0)}else be&&gy(t,ge,ee,L,1);Uy(t,X)}},remove(e,t,o,{um:c,o:{remove:d}},y){const{shapeFlag:w,children:i,anchor:O,targetStart:L,targetAnchor:z,target:F,props:N}=e;if(F&&(d(L),d(z)),y&&d(O),w&16){const G=y||!kg(N);for(let Y=0;Y<i.length;Y++){const K=i[Y];c(K,t,o,G,!!K.dynamicChildren)}}},move:gy,hydrate:Hk};function gy(e,t,o,{o:{insert:c},m:d},y=2){y===0&&c(e.targetAnchor,t,o);const{el:w,anchor:i,shapeFlag:O,children:L,props:z}=e,F=y===2;if(F&&c(w,t,o),(!F||kg(z))&&O&16)for(let N=0;N<L.length;N++)d(L[N],t,o,2);F&&c(i,t,o)}function Hk(e,t,o,c,d,y,{o:{nextSibling:w,parentNode:i,querySelector:O,insert:L,createText:z}},F){const N=t.target=Vw(t.props,O);if(N){const G=kg(t.props),Y=N._lpa||N.firstChild;if(t.shapeFlag&16)if(G)t.anchor=F(w(e),t,i(e),o,c,d,y),t.targetStart=Y,t.targetAnchor=Y&&w(Y);else{t.anchor=w(e);let K=Y;for(;K;){if(K&&K.nodeType===8){if(K.data==="teleport start anchor")t.targetStart=K;else if(K.data==="teleport anchor"){t.targetAnchor=K,N._lpa=t.targetAnchor&&w(t.targetAnchor);break}}K=w(K)}t.targetAnchor||kD(N,t,z,L),F(Y&&w(Y),t,N,o,c,d,y)}Uy(t,G)}return t.anchor&&w(t.anchor)}const BD=FD;function Uy(e,t){const o=e.ctx;if(o&&o.ut){let c,d;for(t?(c=e.el,d=e.anchor):(c=e.targetStart,d=e.targetAnchor);c&&c!==d;)c.nodeType===1&&c.setAttribute("data-v-owner",o.uid),c=c.nextSibling;o.ut()}}function kD(e,t,o,c){const d=t.targetStart=o(""),y=t.targetAnchor=o("");return d[LD]=y,e&&(c(d,e),c(y,e)),y}const mu=Symbol("_leaveCb"),_y=Symbol("_enterCb");function ND(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qr(()=>{e.isMounted=!0}),fi(()=>{e.isUnmounting=!0}),e}const ss=[Function,Array],VD={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ss,onEnter:ss,onAfterEnter:ss,onEnterCancelled:ss,onBeforeLeave:ss,onLeave:ss,onAfterLeave:ss,onLeaveCancelled:ss,onBeforeAppear:ss,onAppear:ss,onAfterAppear:ss,onAppearCancelled:ss},jD=e=>{const t=e.subTree;return t.component?jD(t.component):t},Gk={name:"BaseTransition",props:VD,setup(e,{slots:t}){const o=Ys(),c=ND();return()=>{const d=t.default&&m2(t.default(),!0);if(!d||!d.length)return;const y=UD(d),w=Ir(e),{mode:i}=w;if(c.isLeaving)return U1(y);const O=HI(y);if(!O)return U1(y);let L=n_(O,w,c,o,F=>L=F);O.type!==aa&&dh(O,L);let z=o.subTree&&HI(o.subTree);if(z&&z.type!==aa&&!Yd(O,z)&&jD(o).type!==aa){let F=n_(z,w,c,o);if(dh(z,F),i==="out-in"&&O.type!==aa)return c.isLeaving=!0,F.afterLeave=()=>{c.isLeaving=!1,o.job.flags&8||o.update(),delete F.afterLeave,z=void 0},U1(y);i==="in-out"&&O.type!==aa?F.delayLeave=(N,G,Y)=>{const K=HD(c,z);K[String(z.key)]=z,N[mu]=()=>{G(),N[mu]=void 0,delete L.delayedLeave,z=void 0},L.delayedLeave=()=>{Y(),delete L.delayedLeave,z=void 0}}:z=void 0}else z&&(z=void 0);return y}}};function UD(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==aa){t=o;break}}return t}const Wk=Gk;function HD(e,t){const{leavingVNodes:o}=e;let c=o.get(t.type);return c||(c=Object.create(null),o.set(t.type,c)),c}function n_(e,t,o,c,d){const{appear:y,mode:w,persisted:i=!1,onBeforeEnter:O,onEnter:L,onAfterEnter:z,onEnterCancelled:F,onBeforeLeave:N,onLeave:G,onAfterLeave:Y,onLeaveCancelled:K,onBeforeAppear:J,onAppear:X,onAfterAppear:se,onAppearCancelled:te}=t,ne=String(e.key),ue=HD(o,e),ge=(Ie,Ee)=>{Ie&&Ws(Ie,c,9,Ee)},ee=(Ie,Ee)=>{const Re=Ee[1];ge(Ie,Ee),ur(Ie)?Ie.every(Qe=>Qe.length<=1)&&Re():Ie.length<=1&&Re()},be={mode:w,persisted:i,beforeEnter(Ie){let Ee=O;if(!o.isMounted)if(y)Ee=J||O;else return;Ie[mu]&&Ie[mu](!0);const Re=ue[ne];Re&&Yd(e,Re)&&Re.el[mu]&&Re.el[mu](),ge(Ee,[Ie])},enter(Ie){let Ee=L,Re=z,Qe=F;if(!o.isMounted)if(y)Ee=X||L,Re=se||z,Qe=te||F;else return;let et=!1;const We=Ie[_y]=me=>{et||(et=!0,me?ge(Qe,[Ie]):ge(Re,[Ie]),be.delayedLeave&&be.delayedLeave(),Ie[_y]=void 0)};Ee?ee(Ee,[Ie,We]):We()},leave(Ie,Ee){const Re=String(e.key);if(Ie[_y]&&Ie[_y](!0),o.isUnmounting)return Ee();ge(N,[Ie]);let Qe=!1;const et=Ie[mu]=We=>{Qe||(Qe=!0,Ee(),We?ge(K,[Ie]):ge(Y,[Ie]),Ie[mu]=void 0,ue[Re]===e&&delete ue[Re])};ue[Re]=e,G?ee(G,[Ie,et]):et()},clone(Ie){const Ee=n_(Ie,t,o,c,d);return d&&d(Ee),Ee}};return be}function U1(e){if(nx(e))return e=Va(e),e.children=null,e}function HI(e){if(!nx(e))return $D(e.type)&&e.children?UD(e.children):e;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&vr(o.default))return o.default()}}function dh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,dh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function m2(e,t=!1,o){let c=[],d=0;for(let y=0;y<e.length;y++){let w=e[y];const i=o==null?w.key:String(o)+String(w.key!=null?w.key:y);w.type===hr?(w.patchFlag&128&&d++,c=c.concat(m2(w.children,t,i))):(t||w.type!==aa)&&c.push(i!=null?Va(w,{key:i}):w)}if(d>1)for(let y=0;y<c.length;y++)c[y].patchFlag=-2;return c}/*! #__NO_SIDE_EFFECTS__ */function cn(e,t){return vr(e)?bo({name:e.name},t,{setup:e}):e}function GD(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function wv(e,t,o,c,d=!1){if(ur(e)){e.forEach((Y,K)=>wv(Y,t&&(ur(t)?t[K]:t),o,c,d));return}if(Ng(c)&&!d){c.shapeFlag&512&&c.type.__asyncResolved&&c.component.subTree.component&&wv(e,t,o,c.component.subTree);return}const y=c.shapeFlag&4?ox(c.component):c.el,w=d?null:y,{i,r:O}=e,L=t&&t.r,z=i.refs===vi?i.refs={}:i.refs,F=i.setupState,N=Ir(F),G=F===vi?()=>!1:Y=>ti(N,Y);if(L!=null&&L!==O&&(Zi(L)?(z[L]=null,G(L)&&(F[L]=null)):lo(L)&&(L.value=null)),vr(O))b_(O,i,12,[w,z]);else{const Y=Zi(O),K=lo(O);if(Y||K){const J=()=>{if(e.f){const X=Y?G(O)?F[O]:z[O]:O.value;d?ur(X)&&i2(X,y):ur(X)?X.includes(y)||X.push(y):Y?(z[O]=[y],G(O)&&(F[O]=z[O])):(O.value=[y],e.k&&(z[e.k]=O.value))}else Y?(z[O]=w,G(O)&&(F[O]=w)):K&&(O.value=w,e.k&&(z[e.k]=w))};w?(J.id=-1,na(J,o)):J()}}}Jv().requestIdleCallback;Jv().cancelIdleCallback;const Ng=e=>!!e.type.__asyncLoader,nx=e=>e.type.__isKeepAlive;function WD(e,t){qD(e,"a",t)}function qk(e,t){qD(e,"da",t)}function qD(e,t,o=Fo){const c=e.__wdc||(e.__wdc=()=>{let d=o;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(rx(t,c,o),o){let d=o.parent;for(;d&&d.parent;)nx(d.parent.vnode)&&Zk(c,t,o,d),d=d.parent}}function Zk(e,t,o,c){const d=rx(t,e,c,!0);Cc(()=>{i2(c[t],d)},o)}function rx(e,t,o=Fo,c=!1){if(o){const d=o[e]||(o[e]=[]),y=t.__weh||(t.__weh=(...w)=>{Iu();const i=w_(o),O=Ws(t,o,e,w);return i(),Au(),O});return c?d.unshift(y):d.push(y),y}}const Sc=e=>(t,o=Fo)=>{(!i_||e==="sp")&&rx(e,(...c)=>t(...c),o)},g2=Sc("bm"),Qr=Sc("m"),_2=Sc("bu"),Pu=Sc("u"),fi=Sc("bum"),Cc=Sc("um"),Yk=Sc("sp"),Xk=Sc("rtg"),Kk=Sc("rtc");function Jk(e,t=Fo){rx("ec",e,t)}const Qk="directives",eN=Symbol.for("v-ndc");function tN(e){return nN(Qk,e)}function nN(e,t,o=!0,c=!1){const d=ya||Fo;if(d){const y=d.type,w=GI(d[e]||y[e],t)||GI(d.appContext[e],t);return!w&&c?y:w}}function GI(e,t){return e&&(e[t]||e[El(t)]||e[a2(El(t))])}function Hs(e,t,o,c){let d;const y=o,w=ur(e);if(w||Zi(e)){const i=w&&Zf(e);let O=!1;i&&(O=!fs(e),e=ex(e)),d=new Array(e.length);for(let L=0,z=e.length;L<z;L++)d[L]=t(O?Go(e[L]):e[L],L,void 0,y)}else if(typeof e=="number"){d=new Array(e);for(let i=0;i<e;i++)d[i]=t(i+1,i,void 0,y)}else if(Mi(e))if(e[Symbol.iterator])d=Array.from(e,(i,O)=>t(i,O,void 0,y));else{const i=Object.keys(e);d=new Array(i.length);for(let O=0,L=i.length;O<L;O++){const z=i[O];d[O]=t(e[z],z,O,y)}}else d=[];return d}const jw=e=>e?hR(e)?ox(e):jw(e.parent):null,Vg=bo(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jw(e.parent),$root:e=>jw(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>YD(e),$forceUpdate:e=>e.f||(e.f=()=>{p2(e.update)}),$nextTick:e=>e.n||(e.n=si.bind(e.proxy)),$watch:e=>TN.bind(e)}),H1=(e,t)=>e!==vi&&!e.__isScriptSetup&&ti(e,t),rN={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:c,data:d,props:y,accessCache:w,type:i,appContext:O}=e;let L;if(t[0]!=="$"){const G=w[t];if(G!==void 0)switch(G){case 1:return c[t];case 2:return d[t];case 4:return o[t];case 3:return y[t]}else{if(H1(c,t))return w[t]=1,c[t];if(d!==vi&&ti(d,t))return w[t]=2,d[t];if((L=e.propsOptions[0])&&ti(L,t))return w[t]=3,y[t];if(o!==vi&&ti(o,t))return w[t]=4,o[t];Uw&&(w[t]=0)}}const z=Vg[t];let F,N;if(z)return t==="$attrs"&&Ho(e.attrs,"get",""),z(e);if((F=i.__cssModules)&&(F=F[t]))return F;if(o!==vi&&ti(o,t))return w[t]=4,o[t];if(N=O.config.globalProperties,ti(N,t))return N[t]},set({_:e},t,o){const{data:c,setupState:d,ctx:y}=e;return H1(d,t)?(d[t]=o,!0):c!==vi&&ti(c,t)?(c[t]=o,!0):ti(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(y[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:c,appContext:d,propsOptions:y}},w){let i;return!!o[w]||e!==vi&&ti(e,w)||H1(t,w)||(i=y[0])&&ti(i,w)||ti(c,w)||ti(Vg,w)||ti(d.config.globalProperties,w)},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:ti(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function iN(){return oN().attrs}function oN(){const e=Ys();return e.setupContext||(e.setupContext=pR(e))}function WI(e){return ur(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Uw=!0;function aN(e){const t=YD(e),o=e.proxy,c=e.ctx;Uw=!1,t.beforeCreate&&qI(t.beforeCreate,e,"bc");const{data:d,computed:y,methods:w,watch:i,provide:O,inject:L,created:z,beforeMount:F,mounted:N,beforeUpdate:G,updated:Y,activated:K,deactivated:J,beforeDestroy:X,beforeUnmount:se,destroyed:te,unmounted:ne,render:ue,renderTracked:ge,renderTriggered:ee,errorCaptured:be,serverPrefetch:Ie,expose:Ee,inheritAttrs:Re,components:Qe,directives:et,filters:We}=t;if(L&&sN(L,c,null),w)for(const Fe in w){const Ke=w[Fe];vr(Ke)&&(c[Fe]=Ke.bind(o))}if(d){const Fe=d.call(o,o);Mi(Fe)&&(e.data=no(Fe))}if(Uw=!0,y)for(const Fe in y){const Ke=y[Fe],$e=vr(Ke)?Ke.bind(o,o):vr(Ke.get)?Ke.get.bind(o,o):Cl,pt=!vr(Ke)&&vr(Ke.set)?Ke.set.bind(o):Cl,Ct=He({get:$e,set:pt});Object.defineProperty(c,Fe,{enumerable:!0,configurable:!0,get:()=>Ct.value,set:Lt=>Ct.value=Lt})}if(i)for(const Fe in i)ZD(i[Fe],c,o,Fe);if(O){const Fe=vr(O)?O.call(o):O;Reflect.ownKeys(Fe).forEach(Ke=>{li(Ke,Fe[Ke])})}z&&qI(z,e,"c");function Oe(Fe,Ke){ur(Ke)?Ke.forEach($e=>Fe($e.bind(o))):Ke&&Fe(Ke.bind(o))}if(Oe(g2,F),Oe(Qr,N),Oe(_2,G),Oe(Pu,Y),Oe(WD,K),Oe(qk,J),Oe(Jk,be),Oe(Kk,ge),Oe(Xk,ee),Oe(fi,se),Oe(Cc,ne),Oe(Yk,Ie),ur(Ee))if(Ee.length){const Fe=e.exposed||(e.exposed={});Ee.forEach(Ke=>{Object.defineProperty(Fe,Ke,{get:()=>o[Ke],set:$e=>o[Ke]=$e})})}else e.exposed||(e.exposed={});ue&&e.render===Cl&&(e.render=ue),Re!=null&&(e.inheritAttrs=Re),Qe&&(e.components=Qe),et&&(e.directives=et),Ie&&GD(e)}function sN(e,t,o=Cl){ur(e)&&(e=Hw(e));for(const c in e){const d=e[c];let y;Mi(d)?"default"in d?y=Zr(d.from||c,d.default,!0):y=Zr(d.from||c):y=Zr(d),lo(y)?Object.defineProperty(t,c,{enumerable:!0,configurable:!0,get:()=>y.value,set:w=>y.value=w}):t[c]=y}}function qI(e,t,o){Ws(ur(e)?e.map(c=>c.bind(t.proxy)):e.bind(t.proxy),t,o)}function ZD(e,t,o,c){let d=c.includes(".")?sR(o,c):()=>o[c];if(Zi(e)){const y=t[e];vr(y)&&On(d,y)}else if(vr(e))On(d,e.bind(o));else if(Mi(e))if(ur(e))e.forEach(y=>ZD(y,t,o,c));else{const y=vr(e.handler)?e.handler.bind(o):t[e.handler];vr(y)&&On(d,y,e)}}function YD(e){const t=e.type,{mixins:o,extends:c}=t,{mixins:d,optionsCache:y,config:{optionMergeStrategies:w}}=e.appContext,i=y.get(t);let O;return i?O=i:!d.length&&!o&&!c?O=t:(O={},d.length&&d.forEach(L=>Sv(O,L,w,!0)),Sv(O,t,w)),Mi(t)&&y.set(t,O),O}function Sv(e,t,o,c=!1){const{mixins:d,extends:y}=t;y&&Sv(e,y,o,!0),d&&d.forEach(w=>Sv(e,w,o,!0));for(const w in t)if(!(c&&w==="expose")){const i=lN[w]||o&&o[w];e[w]=i?i(e[w],t[w]):t[w]}return e}const lN={data:ZI,props:YI,emits:YI,methods:Ig,computed:Ig,beforeCreate:ta,created:ta,beforeMount:ta,mounted:ta,beforeUpdate:ta,updated:ta,beforeDestroy:ta,beforeUnmount:ta,destroyed:ta,unmounted:ta,activated:ta,deactivated:ta,errorCaptured:ta,serverPrefetch:ta,components:Ig,directives:Ig,watch:uN,provide:ZI,inject:cN};function ZI(e,t){return t?e?function(){return bo(vr(e)?e.call(this,this):e,vr(t)?t.call(this,this):t)}:t:e}function cN(e,t){return Ig(Hw(e),Hw(t))}function Hw(e){if(ur(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function ta(e,t){return e?[...new Set([].concat(e,t))]:t}function Ig(e,t){return e?bo(Object.create(null),e,t):t}function YI(e,t){return e?ur(e)&&ur(t)?[...new Set([...e,...t])]:bo(Object.create(null),WI(e),WI(t??{})):t}function uN(e,t){if(!e)return t;if(!t)return e;const o=bo(Object.create(null),e);for(const c in t)o[c]=ta(e[c],t[c]);return o}function XD(){return{app:null,config:{isNativeTag:Y5,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let dN=0;function hN(e,t){return function(c,d=null){vr(c)||(c=bo({},c)),d!=null&&!Mi(d)&&(d=null);const y=XD(),w=new WeakSet,i=[];let O=!1;const L=y.app={_uid:dN++,_component:c,_props:d,_container:null,_context:y,_instance:null,version:HN,get config(){return y.config},set config(z){},use(z,...F){return w.has(z)||(z&&vr(z.install)?(w.add(z),z.install(L,...F)):vr(z)&&(w.add(z),z(L,...F))),L},mixin(z){return y.mixins.includes(z)||y.mixins.push(z),L},component(z,F){return F?(y.components[z]=F,L):y.components[z]},directive(z,F){return F?(y.directives[z]=F,L):y.directives[z]},mount(z,F,N){if(!O){const G=L._ceVNode||le(c,d);return G.appContext=y,N===!0?N="svg":N===!1&&(N=void 0),e(G,z,N),O=!0,L._container=z,z.__vue_app__=L,ox(G.component)}},onUnmount(z){i.push(z)},unmount(){O&&(Ws(i,L._instance,16),e(null,L._container),delete L._container.__vue_app__)},provide(z,F){return y.provides[z]=F,L},runWithContext(z){const F=Xf;Xf=L;try{return z()}finally{Xf=F}}};return L}}let Xf=null;function li(e,t){if(Fo){let o=Fo.provides;const c=Fo.parent&&Fo.parent.provides;c===o&&(o=Fo.provides=Object.create(c)),o[e]=t}}function Zr(e,t,o=!1){const c=Fo||ya;if(c||Xf){const d=Xf?Xf._context.provides:c?c.parent==null?c.vnode.appContext&&c.vnode.appContext.provides:c.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return o&&vr(t)?t.call(c&&c.proxy):t}}const KD={},JD=()=>Object.create(KD),QD=e=>Object.getPrototypeOf(e)===KD;function fN(e,t,o,c=!1){const d={},y=JD();e.propsDefaults=Object.create(null),eR(e,t,d,y);for(const w in e.propsOptions[0])w in d||(d[w]=void 0);o?e.props=c?d:Ak(d):e.type.props?e.props=d:e.props=y,e.attrs=y}function pN(e,t,o,c){const{props:d,attrs:y,vnode:{patchFlag:w}}=e,i=Ir(d),[O]=e.propsOptions;let L=!1;if((c||w>0)&&!(w&16)){if(w&8){const z=e.vnode.dynamicProps;for(let F=0;F<z.length;F++){let N=z[F];if(ix(e.emitsOptions,N))continue;const G=t[N];if(O)if(ti(y,N))G!==y[N]&&(y[N]=G,L=!0);else{const Y=El(N);d[Y]=Gw(O,i,Y,G,e,!1)}else G!==y[N]&&(y[N]=G,L=!0)}}}else{eR(e,t,d,y)&&(L=!0);let z;for(const F in i)(!t||!ti(t,F)&&((z=yh(F))===F||!ti(t,z)))&&(O?o&&(o[F]!==void 0||o[z]!==void 0)&&(d[F]=Gw(O,i,F,void 0,e,!0)):delete d[F]);if(y!==i)for(const F in y)(!t||!ti(t,F))&&(delete y[F],L=!0)}L&&fc(e.attrs,"set","")}function eR(e,t,o,c){const[d,y]=e.propsOptions;let w=!1,i;if(t)for(let O in t){if($g(O))continue;const L=t[O];let z;d&&ti(d,z=El(O))?!y||!y.includes(z)?o[z]=L:(i||(i={}))[z]=L:ix(e.emitsOptions,O)||(!(O in c)||L!==c[O])&&(c[O]=L,w=!0)}if(y){const O=Ir(o),L=i||vi;for(let z=0;z<y.length;z++){const F=y[z];o[F]=Gw(d,O,F,L[F],e,!ti(L,F))}}return w}function Gw(e,t,o,c,d,y){const w=e[o];if(w!=null){const i=ti(w,"default");if(i&&c===void 0){const O=w.default;if(w.type!==Function&&!w.skipFactory&&vr(O)){const{propsDefaults:L}=d;if(o in L)c=L[o];else{const z=w_(d);c=L[o]=O.call(null,t),z()}}else c=O;d.ce&&d.ce._setProp(o,c)}w[0]&&(y&&!i?c=!1:w[1]&&(c===""||c===yh(o))&&(c=!0))}return c}const mN=new WeakMap;function tR(e,t,o=!1){const c=o?mN:t.propsCache,d=c.get(e);if(d)return d;const y=e.props,w={},i=[];let O=!1;if(!vr(e)){const z=F=>{O=!0;const[N,G]=tR(F,t,!0);bo(w,N),G&&i.push(...G)};!o&&t.mixins.length&&t.mixins.forEach(z),e.extends&&z(e.extends),e.mixins&&e.mixins.forEach(z)}if(!y&&!O)return Mi(e)&&c.set(e,Wf),Wf;if(ur(y))for(let z=0;z<y.length;z++){const F=El(y[z]);XI(F)&&(w[F]=vi)}else if(y)for(const z in y){const F=El(z);if(XI(F)){const N=y[z],G=w[F]=ur(N)||vr(N)?{type:N}:bo({},N),Y=G.type;let K=!1,J=!0;if(ur(Y))for(let X=0;X<Y.length;++X){const se=Y[X],te=vr(se)&&se.name;if(te==="Boolean"){K=!0;break}else te==="String"&&(J=!1)}else K=vr(Y)&&Y.name==="Boolean";G[0]=K,G[1]=J,(K||ti(G,"default"))&&i.push(F)}}const L=[w,i];return Mi(e)&&c.set(e,L),L}function XI(e){return e[0]!=="$"&&!$g(e)}const nR=e=>e[0]==="_"||e==="$stable",y2=e=>ur(e)?e.map(xl):[xl(e)],gN=(e,t,o)=>{if(t._n)return t;const c=yr((...d)=>y2(t(...d)),o);return c._c=!1,c},rR=(e,t,o)=>{const c=e._ctx;for(const d in e){if(nR(d))continue;const y=e[d];if(vr(y))t[d]=gN(d,y,c);else if(y!=null){const w=y2(y);t[d]=()=>w}}},iR=(e,t)=>{const o=y2(t);e.slots.default=()=>o},oR=(e,t,o)=>{for(const c in t)(o||c!=="_")&&(e[c]=t[c])},_N=(e,t,o)=>{const c=e.slots=JD();if(e.vnode.shapeFlag&32){const d=t._;d?(oR(c,t,o),o&&lD(c,"_",d,!0)):rR(t,c)}else t&&iR(e,t)},yN=(e,t,o)=>{const{vnode:c,slots:d}=e;let y=!0,w=vi;if(c.shapeFlag&32){const i=t._;i?o&&i===1?y=!1:oR(d,t,o):(y=!t.$stable,rR(t,d)),w=t}else t&&(iR(e,t),w={default:1});if(y)for(const i in d)!nR(i)&&w[i]==null&&delete d[i]},na=DN;function vN(e){return xN(e)}function xN(e,t){const o=Jv();o.__VUE__=!0;const{insert:c,remove:d,patchProp:y,createElement:w,createText:i,createComment:O,setText:L,setElementText:z,parentNode:F,nextSibling:N,setScopeId:G=Cl,insertStaticContent:Y}=e,K=(Ve,Ye,je,Mt=null,Pt=null,qt=null,zt=void 0,Kt=null,an=!!Ye.dynamicChildren)=>{if(Ve===Ye)return;Ve&&!Yd(Ve,Ye)&&(Mt=xn(Ve),Lt(Ve,Pt,qt,!0),Ve=null),Ye.patchFlag===-2&&(an=!1,Ye.dynamicChildren=null);const{type:un,ref:Nn,shapeFlag:Sn}=Ye;switch(un){case pp:J(Ve,Ye,je,Mt);break;case aa:X(Ve,Ye,je,Mt);break;case W1:Ve==null&&se(Ye,je,Mt,zt);break;case hr:Qe(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an);break;default:Sn&1?ue(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an):Sn&6?et(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an):(Sn&64||Sn&128)&&un.process(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an,_e)}Nn!=null&&Pt&&wv(Nn,Ve&&Ve.ref,qt,Ye||Ve,!Ye)},J=(Ve,Ye,je,Mt)=>{if(Ve==null)c(Ye.el=i(Ye.children),je,Mt);else{const Pt=Ye.el=Ve.el;Ye.children!==Ve.children&&L(Pt,Ye.children)}},X=(Ve,Ye,je,Mt)=>{Ve==null?c(Ye.el=O(Ye.children||""),je,Mt):Ye.el=Ve.el},se=(Ve,Ye,je,Mt)=>{[Ve.el,Ve.anchor]=Y(Ve.children,Ye,je,Mt,Ve.el,Ve.anchor)},te=({el:Ve,anchor:Ye},je,Mt)=>{let Pt;for(;Ve&&Ve!==Ye;)Pt=N(Ve),c(Ve,je,Mt),Ve=Pt;c(Ye,je,Mt)},ne=({el:Ve,anchor:Ye})=>{let je;for(;Ve&&Ve!==Ye;)je=N(Ve),d(Ve),Ve=je;d(Ye)},ue=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an)=>{Ye.type==="svg"?zt="svg":Ye.type==="math"&&(zt="mathml"),Ve==null?ge(Ye,je,Mt,Pt,qt,zt,Kt,an):Ie(Ve,Ye,Pt,qt,zt,Kt,an)},ge=(Ve,Ye,je,Mt,Pt,qt,zt,Kt)=>{let an,un;const{props:Nn,shapeFlag:Sn,transition:Qt,dirs:Hn}=Ve;if(an=Ve.el=w(Ve.type,qt,Nn&&Nn.is,Nn),Sn&8?z(an,Ve.children):Sn&16&&be(Ve.children,an,null,Mt,Pt,G1(Ve,qt),zt,Kt),Hn&&Vd(Ve,null,Mt,"created"),ee(an,Ve,Ve.scopeId,zt,Mt),Nn){for(const Pr in Nn)Pr!=="value"&&!$g(Pr)&&y(an,Pr,null,Nn[Pr],qt,Mt);"value"in Nn&&y(an,"value",null,Nn.value,qt),(un=Nn.onVnodeBeforeMount)&&ml(un,Mt,Ve)}Hn&&Vd(Ve,null,Mt,"beforeMount");const tr=bN(Pt,Qt);tr&&Qt.beforeEnter(an),c(an,Ye,je),((un=Nn&&Nn.onVnodeMounted)||tr||Hn)&&na(()=>{un&&ml(un,Mt,Ve),tr&&Qt.enter(an),Hn&&Vd(Ve,null,Mt,"mounted")},Pt)},ee=(Ve,Ye,je,Mt,Pt)=>{if(je&&G(Ve,je),Mt)for(let qt=0;qt<Mt.length;qt++)G(Ve,Mt[qt]);if(Pt){let qt=Pt.subTree;if(Ye===qt||cR(qt.type)&&(qt.ssContent===Ye||qt.ssFallback===Ye)){const zt=Pt.vnode;ee(Ve,zt,zt.scopeId,zt.slotScopeIds,Pt.parent)}}},be=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an=0)=>{for(let un=an;un<Ve.length;un++){const Nn=Ve[un]=Kt?gu(Ve[un]):xl(Ve[un]);K(null,Nn,Ye,je,Mt,Pt,qt,zt,Kt)}},Ie=(Ve,Ye,je,Mt,Pt,qt,zt)=>{const Kt=Ye.el=Ve.el;let{patchFlag:an,dynamicChildren:un,dirs:Nn}=Ye;an|=Ve.patchFlag&16;const Sn=Ve.props||vi,Qt=Ye.props||vi;let Hn;if(je&&jd(je,!1),(Hn=Qt.onVnodeBeforeUpdate)&&ml(Hn,je,Ye,Ve),Nn&&Vd(Ye,Ve,je,"beforeUpdate"),je&&jd(je,!0),(Sn.innerHTML&&Qt.innerHTML==null||Sn.textContent&&Qt.textContent==null)&&z(Kt,""),un?Ee(Ve.dynamicChildren,un,Kt,je,Mt,G1(Ye,Pt),qt):zt||Ke(Ve,Ye,Kt,null,je,Mt,G1(Ye,Pt),qt,!1),an>0){if(an&16)Re(Kt,Sn,Qt,je,Pt);else if(an&2&&Sn.class!==Qt.class&&y(Kt,"class",null,Qt.class,Pt),an&4&&y(Kt,"style",Sn.style,Qt.style,Pt),an&8){const tr=Ye.dynamicProps;for(let Pr=0;Pr<tr.length;Pr++){const nr=tr[Pr],pi=Sn[nr],xi=Qt[nr];(xi!==pi||nr==="value")&&y(Kt,nr,pi,xi,Pt,je)}}an&1&&Ve.children!==Ye.children&&z(Kt,Ye.children)}else!zt&&un==null&&Re(Kt,Sn,Qt,je,Pt);((Hn=Qt.onVnodeUpdated)||Nn)&&na(()=>{Hn&&ml(Hn,je,Ye,Ve),Nn&&Vd(Ye,Ve,je,"updated")},Mt)},Ee=(Ve,Ye,je,Mt,Pt,qt,zt)=>{for(let Kt=0;Kt<Ye.length;Kt++){const an=Ve[Kt],un=Ye[Kt],Nn=an.el&&(an.type===hr||!Yd(an,un)||an.shapeFlag&70)?F(an.el):je;K(an,un,Nn,null,Mt,Pt,qt,zt,!0)}},Re=(Ve,Ye,je,Mt,Pt)=>{if(Ye!==je){if(Ye!==vi)for(const qt in Ye)!$g(qt)&&!(qt in je)&&y(Ve,qt,Ye[qt],null,Pt,Mt);for(const qt in je){if($g(qt))continue;const zt=je[qt],Kt=Ye[qt];zt!==Kt&&qt!=="value"&&y(Ve,qt,Kt,zt,Pt,Mt)}"value"in je&&y(Ve,"value",Ye.value,je.value,Pt)}},Qe=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an)=>{const un=Ye.el=Ve?Ve.el:i(""),Nn=Ye.anchor=Ve?Ve.anchor:i("");let{patchFlag:Sn,dynamicChildren:Qt,slotScopeIds:Hn}=Ye;Hn&&(Kt=Kt?Kt.concat(Hn):Hn),Ve==null?(c(un,je,Mt),c(Nn,je,Mt),be(Ye.children||[],je,Nn,Pt,qt,zt,Kt,an)):Sn>0&&Sn&64&&Qt&&Ve.dynamicChildren?(Ee(Ve.dynamicChildren,Qt,je,Pt,qt,zt,Kt),(Ye.key!=null||Pt&&Ye===Pt.subTree)&&v2(Ve,Ye,!0)):Ke(Ve,Ye,je,Nn,Pt,qt,zt,Kt,an)},et=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an)=>{Ye.slotScopeIds=Kt,Ve==null?Ye.shapeFlag&512?Pt.ctx.activate(Ye,je,Mt,zt,an):We(Ye,je,Mt,Pt,qt,zt,an):me(Ve,Ye,an)},We=(Ve,Ye,je,Mt,Pt,qt,zt)=>{const Kt=Ve.component=kN(Ve,Mt,Pt);if(nx(Ve)&&(Kt.ctx.renderer=_e),NN(Kt,!1,zt),Kt.asyncDep){if(Pt&&Pt.registerDep(Kt,Oe,zt),!Ve.el){const an=Kt.subTree=le(aa);X(null,an,Ye,je)}}else Oe(Kt,Ve,Ye,je,Pt,qt,zt)},me=(Ve,Ye,je)=>{const Mt=Ye.component=Ve.component;if(PN(Ve,Ye,je))if(Mt.asyncDep&&!Mt.asyncResolved){Fe(Mt,Ye,je);return}else Mt.next=Ye,Mt.update();else Ye.el=Ve.el,Mt.vnode=Ye},Oe=(Ve,Ye,je,Mt,Pt,qt,zt)=>{const Kt=()=>{if(Ve.isMounted){let{next:Sn,bu:Qt,u:Hn,parent:tr,vnode:Pr}=Ve;{const Xi=aR(Ve);if(Xi){Sn&&(Sn.el=Pr.el,Fe(Ve,Sn,zt)),Xi.asyncDep.then(()=>{Ve.isUnmounted||Kt()});return}}let nr=Sn,pi;jd(Ve,!1),Sn?(Sn.el=Pr.el,Fe(Ve,Sn,zt)):Sn=Pr,Qt&&B1(Qt),(pi=Sn.props&&Sn.props.onVnodeBeforeUpdate)&&ml(pi,tr,Sn,Pr),jd(Ve,!0);const xi=JI(Ve),Yi=Ve.subTree;Ve.subTree=xi,K(Yi,xi,F(Yi.el),xn(Yi),Ve,Pt,qt),Sn.el=xi.el,nr===null&&ON(Ve,xi.el),Hn&&na(Hn,Pt),(pi=Sn.props&&Sn.props.onVnodeUpdated)&&na(()=>ml(pi,tr,Sn,Pr),Pt)}else{let Sn;const{el:Qt,props:Hn}=Ye,{bm:tr,m:Pr,parent:nr,root:pi,type:xi}=Ve,Yi=Ng(Ye);jd(Ve,!1),tr&&B1(tr),!Yi&&(Sn=Hn&&Hn.onVnodeBeforeMount)&&ml(Sn,nr,Ye),jd(Ve,!0);{pi.ce&&pi.ce._injectChildStyle(xi);const Xi=Ve.subTree=JI(Ve);K(null,Xi,je,Mt,Ve,Pt,qt),Ye.el=Xi.el}if(Pr&&na(Pr,Pt),!Yi&&(Sn=Hn&&Hn.onVnodeMounted)){const Xi=Ye;na(()=>ml(Sn,nr,Xi),Pt)}(Ye.shapeFlag&256||nr&&Ng(nr.vnode)&&nr.vnode.shapeFlag&256)&&Ve.a&&na(Ve.a,Pt),Ve.isMounted=!0,Ye=je=Mt=null}};Ve.scope.on();const an=Ve.effect=new hD(Kt);Ve.scope.off();const un=Ve.update=an.run.bind(an),Nn=Ve.job=an.runIfDirty.bind(an);Nn.i=Ve,Nn.id=Ve.uid,an.scheduler=()=>p2(Nn),jd(Ve,!0),un()},Fe=(Ve,Ye,je)=>{Ye.component=Ve;const Mt=Ve.vnode.props;Ve.vnode=Ye,Ve.next=null,pN(Ve,Ye.props,Mt,je),yN(Ve,Ye.children,je),Iu(),NI(Ve),Au()},Ke=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an=!1)=>{const un=Ve&&Ve.children,Nn=Ve?Ve.shapeFlag:0,Sn=Ye.children,{patchFlag:Qt,shapeFlag:Hn}=Ye;if(Qt>0){if(Qt&128){pt(un,Sn,je,Mt,Pt,qt,zt,Kt,an);return}else if(Qt&256){$e(un,Sn,je,Mt,Pt,qt,zt,Kt,an);return}}Hn&8?(Nn&16&&ln(un,Pt,qt),Sn!==un&&z(je,Sn)):Nn&16?Hn&16?pt(un,Sn,je,Mt,Pt,qt,zt,Kt,an):ln(un,Pt,qt,!0):(Nn&8&&z(je,""),Hn&16&&be(Sn,je,Mt,Pt,qt,zt,Kt,an))},$e=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an)=>{Ve=Ve||Wf,Ye=Ye||Wf;const un=Ve.length,Nn=Ye.length,Sn=Math.min(un,Nn);let Qt;for(Qt=0;Qt<Sn;Qt++){const Hn=Ye[Qt]=an?gu(Ye[Qt]):xl(Ye[Qt]);K(Ve[Qt],Hn,je,null,Pt,qt,zt,Kt,an)}un>Nn?ln(Ve,Pt,qt,!0,!1,Sn):be(Ye,je,Mt,Pt,qt,zt,Kt,an,Sn)},pt=(Ve,Ye,je,Mt,Pt,qt,zt,Kt,an)=>{let un=0;const Nn=Ye.length;let Sn=Ve.length-1,Qt=Nn-1;for(;un<=Sn&&un<=Qt;){const Hn=Ve[un],tr=Ye[un]=an?gu(Ye[un]):xl(Ye[un]);if(Yd(Hn,tr))K(Hn,tr,je,null,Pt,qt,zt,Kt,an);else break;un++}for(;un<=Sn&&un<=Qt;){const Hn=Ve[Sn],tr=Ye[Qt]=an?gu(Ye[Qt]):xl(Ye[Qt]);if(Yd(Hn,tr))K(Hn,tr,je,null,Pt,qt,zt,Kt,an);else break;Sn--,Qt--}if(un>Sn){if(un<=Qt){const Hn=Qt+1,tr=Hn<Nn?Ye[Hn].el:Mt;for(;un<=Qt;)K(null,Ye[un]=an?gu(Ye[un]):xl(Ye[un]),je,tr,Pt,qt,zt,Kt,an),un++}}else if(un>Qt)for(;un<=Sn;)Lt(Ve[un],Pt,qt,!0),un++;else{const Hn=un,tr=un,Pr=new Map;for(un=tr;un<=Qt;un++){const Bi=Ye[un]=an?gu(Ye[un]):xl(Ye[un]);Bi.key!=null&&Pr.set(Bi.key,un)}let nr,pi=0;const xi=Qt-tr+1;let Yi=!1,Xi=0;const Ai=new Array(xi);for(un=0;un<xi;un++)Ai[un]=0;for(un=Hn;un<=Sn;un++){const Bi=Ve[un];if(pi>=xi){Lt(Bi,Pt,qt,!0);continue}let ci;if(Bi.key!=null)ci=Pr.get(Bi.key);else for(nr=tr;nr<=Qt;nr++)if(Ai[nr-tr]===0&&Yd(Bi,Ye[nr])){ci=nr;break}ci===void 0?Lt(Bi,Pt,qt,!0):(Ai[ci-tr]=un+1,ci>=Xi?Xi=ci:Yi=!0,K(Bi,Ye[ci],je,null,Pt,qt,zt,Kt,an),pi++)}const xa=Yi?wN(Ai):Wf;for(nr=xa.length-1,un=xi-1;un>=0;un--){const Bi=tr+un,ci=Ye[Bi],ba=Bi+1<Nn?Ye[Bi+1].el:Mt;Ai[un]===0?K(null,ci,je,ba,Pt,qt,zt,Kt,an):Yi&&(nr<0||un!==xa[nr]?Ct(ci,je,ba,2):nr--)}}},Ct=(Ve,Ye,je,Mt,Pt=null)=>{const{el:qt,type:zt,transition:Kt,children:an,shapeFlag:un}=Ve;if(un&6){Ct(Ve.component.subTree,Ye,je,Mt);return}if(un&128){Ve.suspense.move(Ye,je,Mt);return}if(un&64){zt.move(Ve,Ye,je,_e);return}if(zt===hr){c(qt,Ye,je);for(let Sn=0;Sn<an.length;Sn++)Ct(an[Sn],Ye,je,Mt);c(Ve.anchor,Ye,je);return}if(zt===W1){te(Ve,Ye,je);return}if(Mt!==2&&un&1&&Kt)if(Mt===0)Kt.beforeEnter(qt),c(qt,Ye,je),na(()=>Kt.enter(qt),Pt);else{const{leave:Sn,delayLeave:Qt,afterLeave:Hn}=Kt,tr=()=>c(qt,Ye,je),Pr=()=>{Sn(qt,()=>{tr(),Hn&&Hn()})};Qt?Qt(qt,tr,Pr):Pr()}else c(qt,Ye,je)},Lt=(Ve,Ye,je,Mt=!1,Pt=!1)=>{const{type:qt,props:zt,ref:Kt,children:an,dynamicChildren:un,shapeFlag:Nn,patchFlag:Sn,dirs:Qt,cacheIndex:Hn}=Ve;if(Sn===-2&&(Pt=!1),Kt!=null&&wv(Kt,null,je,Ve,!0),Hn!=null&&(Ye.renderCache[Hn]=void 0),Nn&256){Ye.ctx.deactivate(Ve);return}const tr=Nn&1&&Qt,Pr=!Ng(Ve);let nr;if(Pr&&(nr=zt&&zt.onVnodeBeforeUnmount)&&ml(nr,Ye,Ve),Nn&6)Ut(Ve.component,je,Mt);else{if(Nn&128){Ve.suspense.unmount(je,Mt);return}tr&&Vd(Ve,null,Ye,"beforeUnmount"),Nn&64?Ve.type.remove(Ve,Ye,je,_e,Mt):un&&!un.hasOnce&&(qt!==hr||Sn>0&&Sn&64)?ln(un,Ye,je,!1,!0):(qt===hr&&Sn&384||!Pt&&Nn&16)&&ln(an,Ye,je),Mt&&It(Ve)}(Pr&&(nr=zt&&zt.onVnodeUnmounted)||tr)&&na(()=>{nr&&ml(nr,Ye,Ve),tr&&Vd(Ve,null,Ye,"unmounted")},je)},It=Ve=>{const{type:Ye,el:je,anchor:Mt,transition:Pt}=Ve;if(Ye===hr){_n(je,Mt);return}if(Ye===W1){ne(Ve);return}const qt=()=>{d(je),Pt&&!Pt.persisted&&Pt.afterLeave&&Pt.afterLeave()};if(Ve.shapeFlag&1&&Pt&&!Pt.persisted){const{leave:zt,delayLeave:Kt}=Pt,an=()=>zt(je,qt);Kt?Kt(Ve.el,qt,an):an()}else qt()},_n=(Ve,Ye)=>{let je;for(;Ve!==Ye;)je=N(Ve),d(Ve),Ve=je;d(Ye)},Ut=(Ve,Ye,je)=>{const{bum:Mt,scope:Pt,job:qt,subTree:zt,um:Kt,m:an,a:un}=Ve;KI(an),KI(un),Mt&&B1(Mt),Pt.stop(),qt&&(qt.flags|=8,Lt(zt,Ve,Ye,je)),Kt&&na(Kt,Ye),na(()=>{Ve.isUnmounted=!0},Ye),Ye&&Ye.pendingBranch&&!Ye.isUnmounted&&Ve.asyncDep&&!Ve.asyncResolved&&Ve.suspenseId===Ye.pendingId&&(Ye.deps--,Ye.deps===0&&Ye.resolve())},ln=(Ve,Ye,je,Mt=!1,Pt=!1,qt=0)=>{for(let zt=qt;zt<Ve.length;zt++)Lt(Ve[zt],Ye,je,Mt,Pt)},xn=Ve=>{if(Ve.shapeFlag&6)return xn(Ve.component.subTree);if(Ve.shapeFlag&128)return Ve.suspense.next();const Ye=N(Ve.anchor||Ve.el),je=Ye&&Ye[LD];return je?N(je):Ye};let En=!1;const Nt=(Ve,Ye,je)=>{Ve==null?Ye._vnode&&Lt(Ye._vnode,null,null,!0):K(Ye._vnode||null,Ve,Ye,null,null,null,je),Ye._vnode=Ve,En||(En=!0,NI(),DD(),En=!1)},_e={p:K,um:Lt,m:Ct,r:It,mt:We,mc:be,pc:Ke,pbc:Ee,n:xn,o:e};return{render:Nt,hydrate:void 0,createApp:hN(Nt)}}function G1({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function jd({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function bN(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function v2(e,t,o=!1){const c=e.children,d=t.children;if(ur(c)&&ur(d))for(let y=0;y<c.length;y++){const w=c[y];let i=d[y];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=d[y]=gu(d[y]),i.el=w.el),!o&&i.patchFlag!==-2&&v2(w,i)),i.type===pp&&(i.el=w.el)}}function wN(e){const t=e.slice(),o=[0];let c,d,y,w,i;const O=e.length;for(c=0;c<O;c++){const L=e[c];if(L!==0){if(d=o[o.length-1],e[d]<L){t[c]=d,o.push(c);continue}for(y=0,w=o.length-1;y<w;)i=y+w>>1,e[o[i]]<L?y=i+1:w=i;L<e[o[y]]&&(y>0&&(t[c]=o[y-1]),o[y]=c)}}for(y=o.length,w=o[y-1];y-- >0;)o[y]=w,w=t[w];return o}function aR(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:aR(t)}function KI(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const SN=Symbol.for("v-scx"),CN=()=>Zr(SN);function Ii(e,t){return x2(e,null,t)}function On(e,t,o){return x2(e,t,o)}function x2(e,t,o=vi){const{immediate:c,deep:d,flush:y,once:w}=o,i=bo({},o),O=t&&c||!t&&y!=="post";let L;if(i_){if(y==="sync"){const G=CN();L=G.__watcherHandles||(G.__watcherHandles=[])}else if(!O){const G=()=>{};return G.stop=Cl,G.resume=Cl,G.pause=Cl,G}}const z=Fo;i.call=(G,Y,K)=>Ws(G,z,Y,K);let F=!1;y==="post"?i.scheduler=G=>{na(G,z&&z.suspense)}:y!=="sync"&&(F=!0,i.scheduler=(G,Y)=>{Y?G():p2(G)}),i.augmentJob=G=>{t&&(G.flags|=4),F&&(G.flags|=2,z&&(G.id=z.uid,G.i=z))};const N=Nk(e,t,i);return i_&&(L?L.push(N):O&&N()),N}function TN(e,t,o){const c=this.proxy,d=Zi(e)?e.includes(".")?sR(c,e):()=>c[e]:e.bind(c,c);let y;vr(t)?y=t:(y=t.handler,o=t);const w=w_(this),i=x2(d,y.bind(c),o);return w(),i}function sR(e,t){const o=t.split(".");return()=>{let c=e;for(let d=0;d<o.length&&c;d++)c=c[o[d]];return c}}const EN=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${El(t)}Modifiers`]||e[`${yh(t)}Modifiers`];function MN(e,t,...o){if(e.isUnmounted)return;const c=e.vnode.props||vi;let d=o;const y=t.startsWith("update:"),w=y&&EN(c,t.slice(7));w&&(w.trim&&(d=o.map(z=>Zi(z)?z.trim():z)),w.number&&(d=o.map(ek)));let i,O=c[i=F1(t)]||c[i=F1(El(t))];!O&&y&&(O=c[i=F1(yh(t))]),O&&Ws(O,e,6,d);const L=c[i+"Once"];if(L){if(!e.emitted)e.emitted={};else if(e.emitted[i])return;e.emitted[i]=!0,Ws(L,e,6,d)}}function lR(e,t,o=!1){const c=t.emitsCache,d=c.get(e);if(d!==void 0)return d;const y=e.emits;let w={},i=!1;if(!vr(e)){const O=L=>{const z=lR(L,t,!0);z&&(i=!0,bo(w,z))};!o&&t.mixins.length&&t.mixins.forEach(O),e.extends&&O(e.extends),e.mixins&&e.mixins.forEach(O)}return!y&&!i?(Mi(e)&&c.set(e,null),null):(ur(y)?y.forEach(O=>w[O]=null):bo(w,y),Mi(e)&&c.set(e,w),w)}function ix(e,t){return!e||!Yv(t)?!1:(t=t.slice(2).replace(/Once$/,""),ti(e,t[0].toLowerCase()+t.slice(1))||ti(e,yh(t))||ti(e,t))}function JI(e){const{type:t,vnode:o,proxy:c,withProxy:d,propsOptions:[y],slots:w,attrs:i,emit:O,render:L,renderCache:z,props:F,data:N,setupState:G,ctx:Y,inheritAttrs:K}=e,J=bv(e);let X,se;try{if(o.shapeFlag&4){const ne=d||c,ue=ne;X=xl(L.call(ue,ne,z,F,G,N,Y)),se=i}else{const ne=t;X=xl(ne.length>1?ne(F,{attrs:i,slots:w,emit:O}):ne(F,null)),se=t.props?i:IN(i)}}catch(ne){jg.length=0,tx(ne,e,1),X=le(aa)}let te=X;if(se&&K!==!1){const ne=Object.keys(se),{shapeFlag:ue}=te;ne.length&&ue&7&&(y&&ne.some(r2)&&(se=AN(se,y)),te=Va(te,se,!1,!0))}return o.dirs&&(te=Va(te,null,!1,!0),te.dirs=te.dirs?te.dirs.concat(o.dirs):o.dirs),o.transition&&dh(te,o.transition),X=te,bv(J),X}const IN=e=>{let t;for(const o in e)(o==="class"||o==="style"||Yv(o))&&((t||(t={}))[o]=e[o]);return t},AN=(e,t)=>{const o={};for(const c in e)(!r2(c)||!(c.slice(9)in t))&&(o[c]=e[c]);return o};function PN(e,t,o){const{props:c,children:d,component:y}=e,{props:w,children:i,patchFlag:O}=t,L=y.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&O>=0){if(O&1024)return!0;if(O&16)return c?QI(c,w,L):!!w;if(O&8){const z=t.dynamicProps;for(let F=0;F<z.length;F++){const N=z[F];if(w[N]!==c[N]&&!ix(L,N))return!0}}}else return(d||i)&&(!i||!i.$stable)?!0:c===w?!1:c?w?QI(c,w,L):!0:!!w;return!1}function QI(e,t,o){const c=Object.keys(t);if(c.length!==Object.keys(e).length)return!0;for(let d=0;d<c.length;d++){const y=c[d];if(t[y]!==e[y]&&!ix(o,y))return!0}return!1}function ON({vnode:e,parent:t},o){for(;t;){const c=t.subTree;if(c.suspense&&c.suspense.activeBranch===e&&(c.el=e.el),c===e)(e=t.vnode).el=o,t=t.parent;else break}}const cR=e=>e.__isSuspense;function DN(e,t){t&&t.pendingBranch?ur(e)?t.effects.push(...e):t.effects.push(e):Uk(e)}const hr=Symbol.for("v-fgt"),pp=Symbol.for("v-txt"),aa=Symbol.for("v-cmt"),W1=Symbol.for("v-stc"),jg=[];let Fa=null;function lr(e=!1){jg.push(Fa=e?null:[])}function RN(){jg.pop(),Fa=jg[jg.length-1]||null}let r_=1;function eA(e,t=!1){r_+=e,e<0&&Fa&&t&&(Fa.hasOnce=!0)}function uR(e){return e.dynamicChildren=r_>0?Fa||Wf:null,RN(),r_>0&&Fa&&Fa.push(e),e}function $r(e,t,o,c,d,y){return uR(gn(e,t,o,c,d,y,!0))}function Vs(e,t,o,c,d){return uR(le(e,t,o,c,d,!0))}function qs(e){return e?e.__v_isVNode===!0:!1}function Yd(e,t){return e.type===t.type&&e.key===t.key}const dR=({key:e})=>e??null,Hy=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Zi(e)||lo(e)||vr(e)?{i:ya,r:e,k:t,f:!!o}:e:null);function gn(e,t=null,o=null,c=0,d=null,y=e===hr?0:1,w=!1,i=!1){const O={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&dR(t),ref:t&&Hy(t),scopeId:zD,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:y,patchFlag:c,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:ya};return i?(b2(O,o),y&128&&e.normalize(O)):o&&(O.shapeFlag|=Zi(o)?8:16),r_>0&&!w&&Fa&&(O.patchFlag>0||y&6)&&O.patchFlag!==32&&Fa.push(O),O}const le=zN;function zN(e,t=null,o=null,c=0,d=null,y=!1){if((!e||e===eN)&&(e=aa),qs(e)){const i=Va(e,t,!0);return o&&b2(i,o),r_>0&&!y&&Fa&&(i.shapeFlag&6?Fa[Fa.indexOf(e)]=i:Fa.push(i)),i.patchFlag=-2,i}if(UN(e)&&(e=e.__vccOpts),t){t=LN(t);let{class:i,style:O}=t;i&&!Zi(i)&&(t.class=np(i)),Mi(O)&&(f2(O)&&!ur(O)&&(O=bo({},O)),t.style=Qv(O))}const w=Zi(e)?1:cR(e)?128:$D(e)?64:Mi(e)?4:vr(e)?2:0;return gn(e,t,o,c,d,w,y,!0)}function LN(e){return e?f2(e)||QD(e)?bo({},e):e:null}function Va(e,t,o=!1,c=!1){const{props:d,ref:y,patchFlag:w,children:i,transition:O}=e,L=t?$N(d||{},t):d,z={__v_isVNode:!0,__v_skip:!0,type:e.type,props:L,key:L&&dR(L),ref:t&&t.ref?o&&y?ur(y)?y.concat(Hy(t)):[y,Hy(t)]:Hy(t):y,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==hr?w===-1?16:w|16:w,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:O,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Va(e.ssContent),ssFallback:e.ssFallback&&Va(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return O&&c&&dh(z,O.clone(z)),z}function Fi(e=" ",t=0){return le(pp,null,e,t)}function Lo(e="",t=!1){return t?(lr(),Vs(aa,null,e)):le(aa,null,e)}function xl(e){return e==null||typeof e=="boolean"?le(aa):ur(e)?le(hr,null,e.slice()):qs(e)?gu(e):le(pp,null,String(e))}function gu(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Va(e)}function b2(e,t){let o=0;const{shapeFlag:c}=e;if(t==null)t=null;else if(ur(t))o=16;else if(typeof t=="object")if(c&65){const d=t.default;d&&(d._c&&(d._d=!1),b2(e,d()),d._c&&(d._d=!0));return}else{o=32;const d=t._;!d&&!QD(t)?t._ctx=ya:d===3&&ya&&(ya.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else vr(t)?(t={default:t,_ctx:ya},o=32):(t=String(t),c&64?(o=16,t=[Fi(t)]):o=8);e.children=t,e.shapeFlag|=o}function $N(...e){const t={};for(let o=0;o<e.length;o++){const c=e[o];for(const d in c)if(d==="class")t.class!==c.class&&(t.class=np([t.class,c.class]));else if(d==="style")t.style=Qv([t.style,c.style]);else if(Yv(d)){const y=t[d],w=c[d];w&&y!==w&&!(ur(y)&&y.includes(w))&&(t[d]=y?[].concat(y,w):w)}else d!==""&&(t[d]=c[d])}return t}function ml(e,t,o,c=null){Ws(e,t,7,[o,c])}const FN=XD();let BN=0;function kN(e,t,o){const c=e.type,d=(t?t.appContext:e.appContext)||FN,y={uid:BN++,vnode:e,type:c,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new lk(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:tR(c,d),emitsOptions:lR(c,d),emit:null,emitted:null,propsDefaults:vi,inheritAttrs:c.inheritAttrs,ctx:vi,data:vi,props:vi,attrs:vi,slots:vi,refs:vi,setupState:vi,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return y.ctx={_:y},y.root=t?t.root:y,y.emit=MN.bind(null,y),e.ce&&e.ce(y),y}let Fo=null;const Ys=()=>Fo||ya;let Cv,Ww;{const e=Jv(),t=(o,c)=>{let d;return(d=e[o])||(d=e[o]=[]),d.push(c),y=>{d.length>1?d.forEach(w=>w(y)):d[0](y)}};Cv=t("__VUE_INSTANCE_SETTERS__",o=>Fo=o),Ww=t("__VUE_SSR_SETTERS__",o=>i_=o)}const w_=e=>{const t=Fo;return Cv(e),e.scope.on(),()=>{e.scope.off(),Cv(t)}},tA=()=>{Fo&&Fo.scope.off(),Cv(null)};function hR(e){return e.vnode.shapeFlag&4}let i_=!1;function NN(e,t=!1,o=!1){t&&Ww(t);const{props:c,children:d}=e.vnode,y=hR(e);fN(e,c,y,t),_N(e,d,o);const w=y?VN(e,t):void 0;return t&&Ww(!1),w}function VN(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,rN);const{setup:c}=o;if(c){Iu();const d=e.setupContext=c.length>1?pR(e):null,y=w_(e),w=b_(c,e,0,[e.props,d]),i=oD(w);if(Au(),y(),(i||e.sp)&&!Ng(e)&&GD(e),i){if(w.then(tA,tA),t)return w.then(O=>{nA(e,O)}).catch(O=>{tx(O,e,0)});e.asyncDep=w}else nA(e,w)}else fR(e)}function nA(e,t,o){vr(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Mi(t)&&(e.setupState=ID(t)),fR(e)}function fR(e,t,o){const c=e.type;e.render||(e.render=c.render||Cl);{const d=w_(e);Iu();try{aN(e)}finally{Au(),d()}}}const jN={get(e,t){return Ho(e,"get",""),e[t]}};function pR(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,jN),slots:e.slots,emit:e.emit,expose:t}}function ox(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(ID(Pk(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Vg)return Vg[o](e)},has(t,o){return o in t||o in Vg}})):e.proxy}function UN(e){return vr(e)&&"__vccOpts"in e}const He=(e,t)=>Bk(e,t,i_);function hh(e,t,o){const c=arguments.length;return c===2?Mi(t)&&!ur(t)?qs(t)?le(e,null,[t]):le(e,t):le(e,null,t):(c>3?o=Array.prototype.slice.call(arguments,2):c===3&&qs(o)&&(o=[o]),le(e,t,o))}const HN="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let qw;const rA=typeof window<"u"&&window.trustedTypes;if(rA)try{qw=rA.createPolicy("vue",{createHTML:e=>e})}catch{}const mR=qw?e=>qw.createHTML(e):e=>e,GN="http://www.w3.org/2000/svg",WN="http://www.w3.org/1998/Math/MathML",dc=typeof document<"u"?document:null,iA=dc&&dc.createElement("template"),qN={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,c)=>{const d=t==="svg"?dc.createElementNS(GN,e):t==="mathml"?dc.createElementNS(WN,e):o?dc.createElement(e,{is:o}):dc.createElement(e);return e==="select"&&c&&c.multiple!=null&&d.setAttribute("multiple",c.multiple),d},createText:e=>dc.createTextNode(e),createComment:e=>dc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>dc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,c,d,y){const w=o?o.previousSibling:t.lastChild;if(d&&(d===y||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),o),!(d===y||!(d=d.nextSibling)););else{iA.innerHTML=mR(c==="svg"?`<svg>${e}</svg>`:c==="mathml"?`<math>${e}</math>`:e);const i=iA.content;if(c==="svg"||c==="mathml"){const O=i.firstChild;for(;O.firstChild;)i.appendChild(O.firstChild);i.removeChild(O)}t.insertBefore(i,o)}return[w?w.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},hu="transition",xg="animation",rp=Symbol("_vtc"),gR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},_R=bo({},VD,gR),ZN=e=>(e.displayName="Transition",e.props=_R,e),Al=ZN((e,{slots:t})=>hh(Wk,yR(e),t)),Ud=(e,t=[])=>{ur(e)?e.forEach(o=>o(...t)):e&&e(...t)},oA=e=>e?ur(e)?e.some(t=>t.length>1):e.length>1:!1;function yR(e){const t={};for(const Qe in e)Qe in gR||(t[Qe]=e[Qe]);if(e.css===!1)return t;const{name:o="v",type:c,duration:d,enterFromClass:y=`${o}-enter-from`,enterActiveClass:w=`${o}-enter-active`,enterToClass:i=`${o}-enter-to`,appearFromClass:O=y,appearActiveClass:L=w,appearToClass:z=i,leaveFromClass:F=`${o}-leave-from`,leaveActiveClass:N=`${o}-leave-active`,leaveToClass:G=`${o}-leave-to`}=e,Y=YN(d),K=Y&&Y[0],J=Y&&Y[1],{onBeforeEnter:X,onEnter:se,onEnterCancelled:te,onLeave:ne,onLeaveCancelled:ue,onBeforeAppear:ge=X,onAppear:ee=se,onAppearCancelled:be=te}=t,Ie=(Qe,et,We,me)=>{Qe._enterCancelled=me,fu(Qe,et?z:i),fu(Qe,et?L:w),We&&We()},Ee=(Qe,et)=>{Qe._isLeaving=!1,fu(Qe,F),fu(Qe,G),fu(Qe,N),et&&et()},Re=Qe=>(et,We)=>{const me=Qe?ee:se,Oe=()=>Ie(et,Qe,We);Ud(me,[et,Oe]),aA(()=>{fu(et,Qe?O:y),gl(et,Qe?z:i),oA(me)||sA(et,c,K,Oe)})};return bo(t,{onBeforeEnter(Qe){Ud(X,[Qe]),gl(Qe,y),gl(Qe,w)},onBeforeAppear(Qe){Ud(ge,[Qe]),gl(Qe,O),gl(Qe,L)},onEnter:Re(!1),onAppear:Re(!0),onLeave(Qe,et){Qe._isLeaving=!0;const We=()=>Ee(Qe,et);gl(Qe,F),Qe._enterCancelled?(gl(Qe,N),Zw()):(Zw(),gl(Qe,N)),aA(()=>{Qe._isLeaving&&(fu(Qe,F),gl(Qe,G),oA(ne)||sA(Qe,c,J,We))}),Ud(ne,[Qe,We])},onEnterCancelled(Qe){Ie(Qe,!1,void 0,!0),Ud(te,[Qe])},onAppearCancelled(Qe){Ie(Qe,!0,void 0,!0),Ud(be,[Qe])},onLeaveCancelled(Qe){Ee(Qe),Ud(ue,[Qe])}})}function YN(e){if(e==null)return null;if(Mi(e))return[q1(e.enter),q1(e.leave)];{const t=q1(e);return[t,t]}}function q1(e){return tk(e)}function gl(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[rp]||(e[rp]=new Set)).add(t)}function fu(e,t){t.split(/\s+/).forEach(c=>c&&e.classList.remove(c));const o=e[rp];o&&(o.delete(t),o.size||(e[rp]=void 0))}function aA(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let XN=0;function sA(e,t,o,c){const d=e._endId=++XN,y=()=>{d===e._endId&&c()};if(o!=null)return setTimeout(y,o);const{type:w,timeout:i,propCount:O}=vR(e,t);if(!w)return c();const L=w+"end";let z=0;const F=()=>{e.removeEventListener(L,N),y()},N=G=>{G.target===e&&++z>=O&&F()};setTimeout(()=>{z<O&&F()},i+1),e.addEventListener(L,N)}function vR(e,t){const o=window.getComputedStyle(e),c=Y=>(o[Y]||"").split(", "),d=c(`${hu}Delay`),y=c(`${hu}Duration`),w=lA(d,y),i=c(`${xg}Delay`),O=c(`${xg}Duration`),L=lA(i,O);let z=null,F=0,N=0;t===hu?w>0&&(z=hu,F=w,N=y.length):t===xg?L>0&&(z=xg,F=L,N=O.length):(F=Math.max(w,L),z=F>0?w>L?hu:xg:null,N=z?z===hu?y.length:O.length:0);const G=z===hu&&/\b(transform|all)(,|$)/.test(c(`${hu}Property`).toString());return{type:z,timeout:F,propCount:N,hasTransform:G}}function lA(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,c)=>cA(o)+cA(e[c])))}function cA(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Zw(){return document.body.offsetHeight}function KN(e,t,o){const c=e[rp];c&&(t=(t?[t,...c]:[...c]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Tv=Symbol("_vod"),xR=Symbol("_vsh"),bl={beforeMount(e,{value:t},{transition:o}){e[Tv]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):bg(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:c}){!t!=!o&&(c?t?(c.beforeEnter(e),bg(e,!0),c.enter(e)):c.leave(e,()=>{bg(e,!1)}):bg(e,t))},beforeUnmount(e,{value:t}){bg(e,t)}};function bg(e,t){e.style.display=t?e[Tv]:"none",e[xR]=!t}const JN=Symbol(""),QN=/(^|;)\s*display\s*:/;function e6(e,t,o){const c=e.style,d=Zi(o);let y=!1;if(o&&!d){if(t)if(Zi(t))for(const w of t.split(";")){const i=w.slice(0,w.indexOf(":")).trim();o[i]==null&&Gy(c,i,"")}else for(const w in t)o[w]==null&&Gy(c,w,"");for(const w in o)w==="display"&&(y=!0),Gy(c,w,o[w])}else if(d){if(t!==o){const w=c[JN];w&&(o+=";"+w),c.cssText=o,y=QN.test(o)}}else t&&e.removeAttribute("style");Tv in e&&(e[Tv]=y?c.display:"",e[xR]&&(c.display="none"))}const uA=/\s*!important$/;function Gy(e,t,o){if(ur(o))o.forEach(c=>Gy(e,t,c));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const c=t6(e,t);uA.test(o)?e.setProperty(yh(c),o.replace(uA,""),"important"):e[c]=o}}const dA=["Webkit","Moz","ms"],Z1={};function t6(e,t){const o=Z1[t];if(o)return o;let c=El(t);if(c!=="filter"&&c in e)return Z1[t]=c;c=a2(c);for(let d=0;d<dA.length;d++){const y=dA[d]+c;if(y in e)return Z1[t]=y}return t}const hA="http://www.w3.org/1999/xlink";function fA(e,t,o,c,d,y=sk(t)){c&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(hA,t.slice(6,t.length)):e.setAttributeNS(hA,t,o):o==null||y&&!cD(o)?e.removeAttribute(t):e.setAttribute(t,y?"":Mu(o)?String(o):o)}function pA(e,t,o,c,d){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?mR(o):o);return}const y=e.tagName;if(t==="value"&&y!=="PROGRESS"&&!y.includes("-")){const i=y==="OPTION"?e.getAttribute("value")||"":e.value,O=o==null?e.type==="checkbox"?"on":"":String(o);(i!==O||!("_value"in e))&&(e.value=O),o==null&&e.removeAttribute(t),e._value=o;return}let w=!1;if(o===""||o==null){const i=typeof e[t];i==="boolean"?o=cD(o):o==null&&i==="string"?(o="",w=!0):i==="number"&&(o=0,w=!0)}try{e[t]=o}catch{}w&&e.removeAttribute(d||t)}function n6(e,t,o,c){e.addEventListener(t,o,c)}function r6(e,t,o,c){e.removeEventListener(t,o,c)}const mA=Symbol("_vei");function i6(e,t,o,c,d=null){const y=e[mA]||(e[mA]={}),w=y[t];if(c&&w)w.value=c;else{const[i,O]=o6(t);if(c){const L=y[t]=l6(c,d);n6(e,i,L,O)}else w&&(r6(e,i,w,O),y[t]=void 0)}}const gA=/(?:Once|Passive|Capture)$/;function o6(e){let t;if(gA.test(e)){t={};let c;for(;c=e.match(gA);)e=e.slice(0,e.length-c[0].length),t[c[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):yh(e.slice(2)),t]}let Y1=0;const a6=Promise.resolve(),s6=()=>Y1||(a6.then(()=>Y1=0),Y1=Date.now());function l6(e,t){const o=c=>{if(!c._vts)c._vts=Date.now();else if(c._vts<=o.attached)return;Ws(c6(c,o.value),t,5,[c])};return o.value=e,o.attached=s6(),o}function c6(e,t){if(ur(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(c=>d=>!d._stopped&&c&&c(d))}else return t}const _A=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,u6=(e,t,o,c,d,y)=>{const w=d==="svg";t==="class"?KN(e,c,w):t==="style"?e6(e,o,c):Yv(t)?r2(t)||i6(e,t,o,c,y):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):d6(e,t,c,w))?(pA(e,t,c),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&fA(e,t,c,w,y,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Zi(c))?pA(e,El(t),c,y,t):(t==="true-value"?e._trueValue=c:t==="false-value"&&(e._falseValue=c),fA(e,t,c,w))};function d6(e,t,o,c){if(c)return!!(t==="innerHTML"||t==="textContent"||t in e&&_A(t)&&vr(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return _A(t)&&Zi(o)?!1:t in e}const bR=new WeakMap,wR=new WeakMap,Ev=Symbol("_moveCb"),yA=Symbol("_enterCb"),h6=e=>(delete e.props.mode,e),f6=h6({name:"TransitionGroup",props:bo({},_R,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=Ys(),c=ND();let d,y;return Pu(()=>{if(!d.length)return;const w=e.moveClass||`${e.name||"v"}-move`;if(!_6(d[0].el,o.vnode.el,w))return;d.forEach(p6),d.forEach(m6);const i=d.filter(g6);Zw(),i.forEach(O=>{const L=O.el,z=L.style;gl(L,w),z.transform=z.webkitTransform=z.transitionDuration="";const F=L[Ev]=N=>{N&&N.target!==L||(!N||/transform$/.test(N.propertyName))&&(L.removeEventListener("transitionend",F),L[Ev]=null,fu(L,w))};L.addEventListener("transitionend",F)})}),()=>{const w=Ir(e),i=yR(w);let O=w.tag||hr;if(d=[],y)for(let L=0;L<y.length;L++){const z=y[L];z.el&&z.el instanceof Element&&(d.push(z),dh(z,n_(z,i,c,o)),bR.set(z,z.el.getBoundingClientRect()))}y=t.default?m2(t.default()):[];for(let L=0;L<y.length;L++){const z=y[L];z.key!=null&&dh(z,n_(z,i,c,o))}return le(O,null,y)}}}),w2=f6;function p6(e){const t=e.el;t[Ev]&&t[Ev](),t[yA]&&t[yA]()}function m6(e){wR.set(e,e.el.getBoundingClientRect())}function g6(e){const t=bR.get(e),o=wR.get(e),c=t.left-o.left,d=t.top-o.top;if(c||d){const y=e.el.style;return y.transform=y.webkitTransform=`translate(${c}px,${d}px)`,y.transitionDuration="0s",e}}function _6(e,t,o){const c=e.cloneNode(),d=e[rp];d&&d.forEach(i=>{i.split(/\s+/).forEach(O=>O&&c.classList.remove(O))}),o.split(/\s+/).forEach(i=>i&&c.classList.add(i)),c.style.display="none";const y=t.nodeType===1?t:t.parentNode;y.appendChild(c);const{hasTransform:w}=vR(c);return y.removeChild(c),w}const y6=["ctrl","shift","alt","meta"],v6={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>y6.some(o=>e[`${o}Key`]&&!t.includes(o))},mc=(e,t)=>{const o=e._withMods||(e._withMods={}),c=t.join(".");return o[c]||(o[c]=(d,...y)=>{for(let w=0;w<t.length;w++){const i=v6[t[w]];if(i&&i(d,t))return}return e(d,...y)})},x6=bo({patchProp:u6},qN);let vA;function SR(){return vA||(vA=vN(x6))}const Cu=(...e)=>{SR().render(...e)},b6=(...e)=>{const t=SR().createApp(...e),{mount:o}=t;return t.mount=c=>{const d=S6(c);if(!d)return;const y=t._component;!vr(y)&&!y.render&&!y.template&&(y.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const w=o(d,!1,w6(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),w},t};function w6(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function S6(e){return Zi(e)?document.querySelector(e):e}function o_(e){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function C6(e,t){if(o_(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,t||"default");if(o_(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T6(e){var t=C6(e,"string");return o_(t)=="symbol"?t:t+""}function E6(e,t,o){return(t=T6(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function xA(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function it(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?xA(Object(o),!0).forEach(function(c){E6(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):xA(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function re(){return re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var c in o)({}).hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},re.apply(null,arguments)}const M6=e=>typeof e=="function",I6=Array.isArray,A6=e=>typeof e=="string",P6=e=>e!==null&&typeof e=="object",O6=/^on[^a-z]/,D6=e=>O6.test(e),S2=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},R6=/-(\w)/g,CR=S2(e=>e.replace(R6,(t,o)=>o?o.toUpperCase():"")),z6=/\B([A-Z])/g,L6=S2(e=>e.replace(z6,"-$1").toLowerCase()),$6=S2(e=>e.charAt(0).toUpperCase()+e.slice(1)),F6=Object.prototype.hasOwnProperty,bA=(e,t)=>F6.call(e,t);function B6(e,t,o,c){const d=e[o];if(d!=null){const y=bA(d,"default");if(y&&c===void 0){const w=d.default;c=d.type!==Function&&M6(w)?w():w}d.type===Boolean&&(!bA(t,o)&&!y?c=!1:c===""&&(c=!0))}return c}function k6(e){return Object.keys(e).reduce((t,o)=>((o.startsWith("data-")||o.startsWith("aria-"))&&(t[o]=e[o]),t),{})}function Uf(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return typeof e=="function"?e(t):e??o}function N6(e){let t;const o=new Promise(d=>{t=e(()=>{d(!0)})}),c=()=>{t==null||t()};return c.then=(d,y)=>o.then(d,y),c.promise=o,c}function hn(){const e=[];for(let t=0;t<arguments.length;t++){const o=t<0||arguments.length<=t?void 0:arguments[t];if(o){if(A6(o))e.push(o);else if(I6(o))for(let c=0;c<o.length;c++){const d=hn(o[c]);d&&e.push(d)}else if(P6(o))for(const c in o)o[c]&&e.push(c)}}return e.join(" ")}var TR=function(){if(typeof Map<"u")return Map;function e(t,o){var c=-1;return t.some(function(d,y){return d[0]===o?(c=y,!0):!1}),c}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(o){var c=e(this.__entries__,o),d=this.__entries__[c];return d&&d[1]},t.prototype.set=function(o,c){var d=e(this.__entries__,o);~d?this.__entries__[d][1]=c:this.__entries__.push([o,c])},t.prototype.delete=function(o){var c=this.__entries__,d=e(c,o);~d&&c.splice(d,1)},t.prototype.has=function(o){return!!~e(this.__entries__,o)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(o,c){c===void 0&&(c=null);for(var d=0,y=this.__entries__;d<y.length;d++){var w=y[d];o.call(c,w[1],w[0])}},t}()}(),Yw=typeof window<"u"&&typeof document<"u"&&window.document===document,Mv=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),V6=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Mv):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),j6=2;function U6(e,t){var o=!1,c=!1,d=0;function y(){o&&(o=!1,e()),c&&i()}function w(){V6(y)}function i(){var O=Date.now();if(o){if(O-d<j6)return;c=!0}else o=!0,c=!1,setTimeout(w,t);d=O}return i}var H6=20,G6=["top","right","bottom","left","width","height","size","weight"],W6=typeof MutationObserver<"u",q6=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=U6(this.refresh.bind(this),H6)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var o=this.observers_,c=o.indexOf(t);~c&&o.splice(c,1),!o.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(o){return o.gatherActive(),o.hasActive()});return t.forEach(function(o){return o.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!Yw||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),W6?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!Yw||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var o=t.propertyName,c=o===void 0?"":o,d=G6.some(function(y){return!!~c.indexOf(y)});d&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ER=function(e,t){for(var o=0,c=Object.keys(t);o<c.length;o++){var d=c[o];Object.defineProperty(e,d,{value:t[d],enumerable:!1,writable:!1,configurable:!0})}return e},ip=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||Mv},MR=ax(0,0,0,0);function Iv(e){return parseFloat(e)||0}function wA(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.reduce(function(c,d){var y=e["border-"+d+"-width"];return c+Iv(y)},0)}function Z6(e){for(var t=["top","right","bottom","left"],o={},c=0,d=t;c<d.length;c++){var y=d[c],w=e["padding-"+y];o[y]=Iv(w)}return o}function Y6(e){var t=e.getBBox();return ax(0,0,t.width,t.height)}function X6(e){var t=e.clientWidth,o=e.clientHeight;if(!t&&!o)return MR;var c=ip(e).getComputedStyle(e),d=Z6(c),y=d.left+d.right,w=d.top+d.bottom,i=Iv(c.width),O=Iv(c.height);if(c.boxSizing==="border-box"&&(Math.round(i+y)!==t&&(i-=wA(c,"left","right")+y),Math.round(O+w)!==o&&(O-=wA(c,"top","bottom")+w)),!J6(e)){var L=Math.round(i+y)-t,z=Math.round(O+w)-o;Math.abs(L)!==1&&(i-=L),Math.abs(z)!==1&&(O-=z)}return ax(d.left,d.top,i,O)}var K6=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof ip(e).SVGGraphicsElement}:function(e){return e instanceof ip(e).SVGElement&&typeof e.getBBox=="function"}}();function J6(e){return e===ip(e).document.documentElement}function Q6(e){return Yw?K6(e)?Y6(e):X6(e):MR}function eV(e){var t=e.x,o=e.y,c=e.width,d=e.height,y=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,w=Object.create(y.prototype);return ER(w,{x:t,y:o,width:c,height:d,top:o,right:t+c,bottom:d+o,left:t}),w}function ax(e,t,o,c){return{x:e,y:t,width:o,height:c}}var tV=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=ax(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=Q6(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),nV=function(){function e(t,o){var c=eV(o);ER(this,{target:t,contentRect:c})}return e}(),rV=function(){function e(t,o,c){if(this.activeObservations_=[],this.observations_=new TR,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=o,this.callbackCtx_=c}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof ip(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(t)||(o.set(t,new tV(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof ip(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(t)&&(o.delete(t),o.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(o){o.isActive()&&t.activeObservations_.push(o)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,o=this.activeObservations_.map(function(c){return new nV(c.target,c.broadcastRect())});this.callback_.call(t,o,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),IR=typeof WeakMap<"u"?new WeakMap:new TR,AR=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var o=q6.getInstance(),c=new rV(t,o,this);IR.set(this,c)}return e}();["observe","unobserve","disconnect"].forEach(function(e){AR.prototype[e]=function(){var t;return(t=IR.get(this))[e].apply(t,arguments)}});var PR=function(){return typeof Mv.ResizeObserver<"u"?Mv.ResizeObserver:AR}();const iV=e=>e!=null&&e!=="",Wo=(e,t)=>{const o=re({},e);return Object.keys(t).forEach(c=>{const d=o[c];if(d)d.type||d.default?d.default=t[c]:d.def?d.def(t[c]):o[c]={type:d,default:t[c]};else throw new Error(`not have ${c} prop`)}),o},oV=e=>{const t=Object.keys(e),o={},c={},d={};for(let y=0,w=t.length;y<w;y++){const i=t[y];D6(i)?(o[i[2].toLowerCase()+i.slice(3)]=e[i],c[i]=e[i]):d[i]=e[i]}return{onEvents:c,events:o,extraAttrs:d}},aV=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const o={},c=/;(?![^(]*\))/g,d=/:(.+)/;return typeof e=="object"?e:(e.split(c).forEach(function(y){if(y){const w=y.split(d);if(w.length>1){const i=t?CR(w[0].trim()):w[0].trim();o[i]=w[1].trim()}}}),o)},Av=(e,t)=>e[t]!==void 0,sV=Symbol("skipFlatten"),vo=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const o=Array.isArray(e)?e:[e],c=[];return o.forEach(d=>{Array.isArray(d)?c.push(...vo(d,t)):d&&d.type===hr?d.key===sV?c.push(d):c.push(...vo(d.children,t)):d&&qs(d)?t&&!T2(d)?c.push(d):t||c.push(d):iV(d)&&c.push(d)}),c},C2=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(qs(e))return e.type===hr?t==="default"?vo(e.children):[]:e.children&&e.children[t]?vo(e.children[t](o)):[];{const c=e.$slots[t]&&e.$slots[t](o);return vo(c)}},gc=e=>{var t;let o=((t=e==null?void 0:e.vnode)===null||t===void 0?void 0:t.el)||e&&(e.$el||e);for(;o&&!o.tagName;)o=o.nextSibling;return o},lV=e=>{const t={};if(e.$&&e.$.vnode){const o=e.$.vnode.props||{};Object.keys(e.$props).forEach(c=>{const d=e.$props[c],y=L6(c);(d!==void 0||y in o)&&(t[c]=d)})}else if(qs(e)&&typeof e.type=="object"){const o=e.props||{},c={};Object.keys(o).forEach(y=>{c[CR(y)]=o[y]});const d=e.type.props||{};Object.keys(d).forEach(y=>{const w=B6(d,c,y,c[y]);(w!==void 0||y in c)&&(t[y]=w)})}return t},cV=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,d;if(e.$){const y=e[t];if(y!==void 0)return typeof y=="function"&&c?y(o):y;d=e.$slots[t],d=c&&d?d(o):d}else if(qs(e)){const y=e.props&&e.props[t];if(y!==void 0&&e.props!==null)return typeof y=="function"&&c?y(o):y;e.type===hr?d=e.children:e.children&&e.children[t]&&(d=e.children[t],d=c&&d?d(o):d)}return Array.isArray(d)&&(d=vo(d),d=d.length===1?d[0]:d,d=d.length===0?void 0:d),d};function SA(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o={};return e.$?o=re(re({},o),e.$attrs):o=re(re({},o),e.props),oV(o)[t?"onEvents":"events"]}function uV(e){const o=((qs(e)?e.props:e.$attrs)||{}).class||{};let c={};return typeof o=="string"?o.split(" ").forEach(d=>{c[d.trim()]=!0}):Array.isArray(o)?hn(o).split(" ").forEach(d=>{c[d.trim()]=!0}):c=re(re({},c),o),c}function OR(e,t){let c=((qs(e)?e.props:e.$attrs)||{}).style||{};return typeof c=="string"&&(c=aV(c,t)),c}function dV(e){return e.length===1&&e[0].type===hr}function T2(e){return e&&(e.type===aa||e.type===hr&&e.children.length===0||e.type===pp&&e.children.trim()==="")}function ms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return e.forEach(o=>{Array.isArray(o)?t.push(...o):(o==null?void 0:o.type)===hr?t.push(...ms(o.children)):t.push(o)}),t.filter(o=>!T2(o))}function Tc(e){return Array.isArray(e)&&e.length===1&&(e=e[0]),e&&e.__v_isVNode&&typeof e.type!="symbol"}function DR(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"default";var c,d;return(c=t[o])!==null&&c!==void 0?c:(d=e[o])===null||d===void 0?void 0:d.call(e)}const sx=cn({compatConfig:{MODE:3},name:"ResizeObserver",props:{disabled:Boolean,onResize:Function},emits:["resize"],setup(e,t){let{slots:o}=t;const c=no({width:0,height:0,offsetHeight:0,offsetWidth:0});let d=null,y=null;const w=()=>{y&&(y.disconnect(),y=null)},i=z=>{const{onResize:F}=e,N=z[0].target,{width:G,height:Y}=N.getBoundingClientRect(),{offsetWidth:K,offsetHeight:J}=N,X=Math.floor(G),se=Math.floor(Y);if(c.width!==X||c.height!==se||c.offsetWidth!==K||c.offsetHeight!==J){const te={width:X,height:se,offsetWidth:K,offsetHeight:J};re(c,te),F&&Promise.resolve().then(()=>{F(re(re({},te),{offsetWidth:K,offsetHeight:J}),N)})}},O=Ys(),L=()=>{const{disabled:z}=e;if(z){w();return}const F=gc(O);F!==d&&(w(),d=F),!y&&F&&(y=new PR(i),y.observe(F))};return Qr(()=>{L()}),Pu(()=>{L()}),Cc(()=>{w()}),On(()=>e.disabled,()=>{L()},{flush:"post"}),()=>{var z;return(z=o.default)===null||z===void 0?void 0:z.call(o)[0]}}});let RR=e=>setTimeout(e,16),zR=e=>clearTimeout(e);typeof window<"u"&&"requestAnimationFrame"in window&&(RR=e=>window.requestAnimationFrame(e),zR=e=>window.cancelAnimationFrame(e));let CA=0;const E2=new Map;function LR(e){E2.delete(e)}function qr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;CA+=1;const o=CA;function c(d){if(d===0)LR(o),e();else{const y=RR(()=>{c(d-1)});E2.set(o,y)}}return c(t),o}qr.cancel=e=>{const t=E2.get(e);return LR(t),zR(t)};const Tu=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return t},Pl=e=>{const t=e;return t.install=function(o){o.component(t.displayName||t.name,e)},e};function a_(){return{type:[Function,Array]}}function oi(e){return{type:Object,default:e}}function Cr(e){return{type:Boolean,default:e}}function Jr(e){return{type:Function,default:e}}function La(e,t){const o={validator:()=>!0,default:e};return o}function op(e){return{type:Array,default:e}}function Io(e){return{type:String,default:e}}function Mo(e,t){return e?{type:e,default:t}:La(t)}let $o=!1;try{const e=Object.defineProperty({},"passive",{get(){$o=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}function js(e,t,o,c){if(e&&e.addEventListener){let d=c;d===void 0&&$o&&(t==="touchstart"||t==="touchmove"||t==="wheel")&&(d={passive:!1}),e.addEventListener(t,o,d)}return{remove:()=>{e&&e.removeEventListener&&e.removeEventListener(t,o)}}}const M2="anticon",$R=Symbol("GlobalFormContextKey"),hV=e=>{li($R,e)},fV=()=>Zr($R,{validateMessages:He(()=>{})}),pV=()=>({iconPrefixCls:String,getTargetContainer:{type:Function},getPopupContainer:{type:Function},prefixCls:String,getPrefixCls:{type:Function},renderEmpty:{type:Function},transformCellText:{type:Function},csp:oi(),input:oi(),autoInsertSpaceInButton:{type:Boolean,default:void 0},locale:oi(),pageHeader:oi(),componentSize:{type:String},componentDisabled:{type:Boolean,default:void 0},direction:{type:String,default:"ltr"},space:oi(),virtual:{type:Boolean,default:void 0},dropdownMatchSelectWidth:{type:[Number,Boolean],default:!0},form:oi(),pagination:oi(),theme:oi(),select:oi(),wave:oi()}),I2=Symbol("configProvider"),FR={getPrefixCls:(e,t)=>t||(e?`ant-${e}`:"ant"),iconPrefixCls:He(()=>M2),getPopupContainer:He(()=>()=>document.body),direction:He(()=>"ltr")},A2=()=>Zr(I2,FR),mV=e=>li(I2,e),BR=Symbol("DisabledContextKey"),yc=()=>Zr(BR,tn(void 0)),kR=e=>{const t=yc();return li(BR,He(()=>{var o;return(o=e.value)!==null&&o!==void 0?o:t.value})),e},gV={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages"},_V={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},NR={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},Xw={lang:re({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},_V),timePickerLocale:re({},NR)},Oa="${label} is not a valid ${type}",Eu={locale:"en",Pagination:gV,DatePicker:Xw,TimePicker:NR,Calendar:Xw,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Oa,method:Oa,array:Oa,object:Oa,number:Oa,date:Oa,boolean:Oa,integer:Oa,float:Oa,regexp:Oa,email:Oa,url:Oa,hex:Oa},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"}},VR=cn({compatConfig:{MODE:3},name:"LocaleReceiver",props:{componentName:String,defaultLocale:{type:[Object,Function]},children:{type:Function}},setup(e,t){let{slots:o}=t;const c=Zr("localeData",{}),d=He(()=>{const{componentName:w="global",defaultLocale:i}=e,O=i||Eu[w||"global"],{antLocale:L}=c,z=w&&L?L[w]:{};return re(re({},typeof O=="function"?O():O),z||{})}),y=He(()=>{const{antLocale:w}=c,i=w&&w.locale;return w&&w.exist&&!i?Eu.locale:i});return()=>{const w=e.children||o.default,{antLocale:i}=c;return w==null?void 0:w(d.value,y.value,i)}}});function S_(e,t,o){const c=Zr("localeData",{});return[He(()=>{const{antLocale:y}=c,w=Ar(t)||Eu[e||"global"],i=e&&y?y[e]:{};return re(re(re({},typeof w=="function"?w():w),i||{}),Ar(o)||{})})]}function P2(e){for(var t=0,o,c=0,d=e.length;d>=4;++c,d-=4)o=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,t=(o&65535)*1540483477+((o>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(d){case 3:t^=(e.charCodeAt(c+2)&255)<<16;case 2:t^=(e.charCodeAt(c+1)&255)<<8;case 1:t^=e.charCodeAt(c)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}const TA="%";class yV{constructor(t){this.cache=new Map,this.instanceId=t}get(t){return this.cache.get(Array.isArray(t)?t.join(TA):t)||null}update(t,o){const c=Array.isArray(t)?t.join(TA):t,d=this.cache.get(c),y=o(d);y===null?this.cache.delete(c):this.cache.set(c,y)}}const jR="data-token-hash",rh="data-css-hash",Hf="__cssinjs_instance__";function s_(){const e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){const t=document.body.querySelectorAll(`style[${rh}]`)||[],{firstChild:o}=document.head;Array.from(t).forEach(d=>{d[Hf]=d[Hf]||e,d[Hf]===e&&document.head.insertBefore(d,o)});const c={};Array.from(document.querySelectorAll(`style[${rh}]`)).forEach(d=>{var y;const w=d.getAttribute(rh);c[w]?d[Hf]===e&&((y=d.parentNode)===null||y===void 0||y.removeChild(d)):c[w]=!0})}return new yV(e)}const UR=Symbol("StyleContextKey"),vV=()=>{var e,t,o;const c=Ys();let d;if(c&&c.appContext){const y=(o=(t=(e=c.appContext)===null||e===void 0?void 0:e.config)===null||t===void 0?void 0:t.globalProperties)===null||o===void 0?void 0:o.__ANTDV_CSSINJS_CACHE__;y?d=y:(d=s_(),c.appContext.config.globalProperties&&(c.appContext.config.globalProperties.__ANTDV_CSSINJS_CACHE__=d))}else d=s_();return d},HR={cache:s_(),defaultCache:!0,hashPriority:"low"},lx=()=>{const e=vV();return Zr(UR,Xt(re(re({},HR),{cache:e})))},xV=e=>{const t=lx(),o=Xt(re(re({},HR),{cache:s_()}));return On([()=>Ar(e),t],()=>{const c=re({},t.value),d=Ar(e);Object.keys(d).forEach(w=>{const i=d[w];d[w]!==void 0&&(c[w]=i)});const{cache:y}=d;c.cache=c.cache||s_(),c.defaultCache=!y&&t.value.defaultCache,o.value=c},{immediate:!0}),li(UR,o),o},bV=()=>({autoClear:Cr(),mock:Io(),cache:oi(),defaultCache:Cr(),hashPriority:Io(),container:Mo(),ssrInline:Cr(),transformers:op(),linters:op()}),wV=Pl(cn({name:"AStyleProvider",inheritAttrs:!1,props:bV(),setup(e,t){let{slots:o}=t;return xV(e),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}}));function GR(e,t,o,c){const d=lx(),y=Xt(""),w=Xt();Ii(()=>{y.value=[e,...t.value].join("%")});const i=O=>{d.value.cache.update(O,L=>{const[z=0,F]=L||[];return z-1===0?(c==null||c(F,!1),null):[z-1,F]})};return On(y,(O,L)=>{L&&i(L),d.value.cache.update(O,z=>{const[F=0,N]=z||[],Y=N||o();return[F+1,Y]}),w.value=d.value.cache.get(y.value)[1]},{immediate:!0}),fi(()=>{i(y.value)}),w}function gs(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function _u(e,t){return e&&e.contains?e.contains(t):!1}const EA="data-vc-order",SV="vc-util-key",Kw=new Map;function WR(){let{mark:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e?e.startsWith("data-")?e:`data-${e}`:SV}function cx(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function CV(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function qR(e){return Array.from((Kw.get(e)||e).children).filter(t=>t.tagName==="STYLE")}function ZR(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!gs())return null;const{csp:o,prepend:c}=t,d=document.createElement("style");d.setAttribute(EA,CV(c)),o!=null&&o.nonce&&(d.nonce=o==null?void 0:o.nonce),d.innerHTML=e;const y=cx(t),{firstChild:w}=y;if(c){if(c==="queue"){const i=qR(y).filter(O=>["prepend","prependQueue"].includes(O.getAttribute(EA)));if(i.length)return y.insertBefore(d,i[i.length-1].nextSibling),d}y.insertBefore(d,w)}else y.appendChild(d);return d}function YR(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=cx(t);return qR(o).find(c=>c.getAttribute(WR(t))===e)}function Pv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=YR(e,t);o&&cx(t).removeChild(o)}function TV(e,t){const o=Kw.get(e);if(!o||!_u(document,o)){const c=ZR("",t),{parentNode:d}=c;Kw.set(e,d),e.removeChild(c)}}function l_(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var c,d,y;const w=cx(o);TV(w,o);const i=YR(t,o);if(i)return!((c=o.csp)===null||c===void 0)&&c.nonce&&i.nonce!==((d=o.csp)===null||d===void 0?void 0:d.nonce)&&(i.nonce=(y=o.csp)===null||y===void 0?void 0:y.nonce),i.innerHTML!==e&&(i.innerHTML=e),i;const O=ZR(e,o);return O.setAttribute(WR(o),t),O}function EV(e,t){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}class ap{constructor(){this.cache=new Map,this.keys=[],this.cacheCallTimes=0}size(){return this.keys.length}internalGet(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c={map:this.cache};return t.forEach(d=>{var y;c?c=(y=c==null?void 0:c.map)===null||y===void 0?void 0:y.get(d):c=void 0}),c!=null&&c.value&&o&&(c.value[1]=this.cacheCallTimes++),c==null?void 0:c.value}get(t){var o;return(o=this.internalGet(t,!0))===null||o===void 0?void 0:o[0]}has(t){return!!this.internalGet(t)}set(t,o){if(!this.has(t)){if(this.size()+1>ap.MAX_CACHE_SIZE+ap.MAX_CACHE_OFFSET){const[d]=this.keys.reduce((y,w)=>{const[,i]=y;return this.internalGet(w)[1]<i?[w,this.internalGet(w)[1]]:y},[this.keys[0],this.cacheCallTimes]);this.delete(d)}this.keys.push(t)}let c=this.cache;t.forEach((d,y)=>{if(y===t.length-1)c.set(d,{value:[o,this.cacheCallTimes++]});else{const w=c.get(d);w?w.map||(w.map=new Map):c.set(d,{map:new Map}),c=c.get(d).map}})}deleteByPath(t,o){var c;const d=t.get(o[0]);if(o.length===1)return d.map?t.set(o[0],{map:d.map}):t.delete(o[0]),(c=d.value)===null||c===void 0?void 0:c[0];const y=this.deleteByPath(d.map,o.slice(1));return(!d.map||d.map.size===0)&&!d.value&&t.delete(o[0]),y}delete(t){if(this.has(t))return this.keys=this.keys.filter(o=>!EV(o,t)),this.deleteByPath(this.cache,t)}}ap.MAX_CACHE_SIZE=20;ap.MAX_CACHE_OFFSET=5;let MA={};function MV(e,t){}function IV(e,t){}function XR(e,t,o){!t&&!MA[o]&&(e(!1,o),MA[o]=!0)}function AV(e,t){XR(MV,e,t)}function PV(e,t){XR(IV,e,t)}function OV(){}let Ou=OV,IA=0;class KR{constructor(t){this.derivatives=Array.isArray(t)?t:[t],this.id=IA,t.length===0&&Ou(t.length>0),IA+=1}getDerivativeToken(t){return this.derivatives.reduce((o,c)=>c(t,o),void 0)}}const X1=new ap;function JR(e){const t=Array.isArray(e)?e:[e];return X1.has(t)||X1.set(t,new KR(t)),X1.get(t)}const AA=new WeakMap;function Ov(e){let t=AA.get(e)||"";return t||(Object.keys(e).forEach(o=>{const c=e[o];t+=o,c instanceof KR?t+=c.id:c&&typeof c=="object"?t+=Ov(c):t+=c}),AA.set(e,t)),t}function DV(e,t){return P2(`${t}_${Ov(e)}`)}const Ug=`random-${Date.now()}-${Math.random()}`.replace(/\./g,""),QR="_bAmBoO_";function RV(e,t,o){var c,d;if(gs()){l_(e,Ug);const y=document.createElement("div");y.style.position="fixed",y.style.left="0",y.style.top="0",t==null||t(y),document.body.appendChild(y);const w=o?o(y):(c=getComputedStyle(y).content)===null||c===void 0?void 0:c.includes(QR);return(d=y.parentNode)===null||d===void 0||d.removeChild(y),Pv(Ug),w}return!1}let K1;function zV(){return K1===void 0&&(K1=RV(`@layer ${Ug} { .${Ug} { content: "${QR}"!important; } }`,e=>{e.className=Ug})),K1}const PA={},LV="css",Xd=new Map;function $V(e){Xd.set(e,(Xd.get(e)||0)+1)}function FV(e,t){typeof document<"u"&&document.querySelectorAll(`style[${jR}="${e}"]`).forEach(c=>{var d;c[Hf]===t&&((d=c.parentNode)===null||d===void 0||d.removeChild(c))})}const BV=0;function kV(e,t){Xd.set(e,(Xd.get(e)||0)-1);const o=Array.from(Xd.keys()),c=o.filter(d=>(Xd.get(d)||0)<=0);o.length-c.length>BV&&c.forEach(d=>{FV(d,t),Xd.delete(d)})}const NV=(e,t,o,c)=>{const d=o.getDerivativeToken(e);let y=re(re({},d),t);return c&&(y=c(y)),y};function VV(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tn({});const c=lx(),d=He(()=>re({},...t.value)),y=He(()=>Ov(d.value)),w=He(()=>Ov(o.value.override||PA));return GR("token",He(()=>[o.value.salt||"",e.value.id,y.value,w.value]),()=>{const{salt:O="",override:L=PA,formatToken:z,getComputedToken:F}=o.value,N=F?F(d.value,L,e.value):NV(d.value,L,e.value,z),G=DV(N,O);N._tokenKey=G,$V(G);const Y=`${LV}-${P2(G)}`;return N._hashId=Y,[N,Y]},O=>{var L;kV(O[0]._tokenKey,(L=c.value)===null||L===void 0?void 0:L.cache.instanceId)})}var jV={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ez="comm",tz="rule",nz="decl",UV="@import",HV="@namespace",GV="@keyframes",WV="@layer",rz=Math.abs,O2=String.fromCharCode;function iz(e){return e.trim()}function Wy(e,t,o){return e.replace(t,o)}function qV(e,t,o){return e.indexOf(t,o)}function Kf(e,t){return e.charCodeAt(t)|0}function sp(e,t,o){return e.slice(t,o)}function vl(e){return e.length}function ZV(e){return e.length}function yy(e,t){return t.push(e),e}var ux=1,lp=1,oz=0,_s=0,so=0,mp="";function D2(e,t,o,c,d,y,w,i){return{value:e,root:t,parent:o,type:c,props:d,children:y,line:ux,column:lp,length:w,return:"",siblings:i}}function YV(){return so}function XV(){return so=_s>0?Kf(mp,--_s):0,lp--,so===10&&(lp=1,ux--),so}function Gs(){return so=_s<oz?Kf(mp,_s++):0,lp++,so===10&&(lp=1,ux++),so}function vu(){return Kf(mp,_s)}function qy(){return _s}function dx(e,t){return sp(mp,e,t)}function c_(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function KV(e){return ux=lp=1,oz=vl(mp=e),_s=0,[]}function JV(e){return mp="",e}function J1(e){return iz(dx(_s-1,Jw(e===91?e+2:e===40?e+1:e)))}function QV(e){for(;(so=vu())&&so<33;)Gs();return c_(e)>2||c_(so)>3?"":" "}function e8(e,t){for(;--t&&Gs()&&!(so<48||so>102||so>57&&so<65||so>70&&so<97););return dx(e,qy()+(t<6&&vu()==32&&Gs()==32))}function Jw(e){for(;Gs();)switch(so){case e:return _s;case 34:case 39:e!==34&&e!==39&&Jw(so);break;case 40:e===41&&Jw(e);break;case 92:Gs();break}return _s}function t8(e,t){for(;Gs()&&e+so!==57;)if(e+so===84&&vu()===47)break;return"/*"+dx(t,_s-1)+"*"+O2(e===47?e:Gs())}function n8(e){for(;!c_(vu());)Gs();return dx(e,_s)}function r8(e){return JV(Zy("",null,null,null,[""],e=KV(e),0,[0],e))}function Zy(e,t,o,c,d,y,w,i,O){for(var L=0,z=0,F=w,N=0,G=0,Y=0,K=1,J=1,X=1,se=0,te="",ne=d,ue=y,ge=c,ee=te;J;)switch(Y=se,se=Gs()){case 40:if(Y!=108&&Kf(ee,F-1)==58){qV(ee+=Wy(J1(se),"&","&\f"),"&\f",rz(L?i[L-1]:0))!=-1&&(X=-1);break}case 34:case 39:case 91:ee+=J1(se);break;case 9:case 10:case 13:case 32:ee+=QV(Y);break;case 92:ee+=e8(qy()-1,7);continue;case 47:switch(vu()){case 42:case 47:yy(i8(t8(Gs(),qy()),t,o,O),O),(c_(Y||1)==5||c_(vu()||1)==5)&&vl(ee)&&sp(ee,-1,void 0)!==" "&&(ee+=" ");break;default:ee+="/"}break;case 123*K:i[L++]=vl(ee)*X;case 125*K:case 59:case 0:switch(se){case 0:case 125:J=0;case 59+z:X==-1&&(ee=Wy(ee,/\f/g,"")),G>0&&(vl(ee)-F||K===0&&Y===47)&&yy(G>32?DA(ee+";",c,o,F-1,O):DA(Wy(ee," ","")+";",c,o,F-2,O),O);break;case 59:ee+=";";default:if(yy(ge=OA(ee,t,o,L,z,d,i,te,ne=[],ue=[],F,y),y),se===123)if(z===0)Zy(ee,t,ge,ge,ne,y,F,i,ue);else{switch(N){case 99:if(Kf(ee,3)===110)break;case 108:if(Kf(ee,2)===97)break;default:z=0;case 100:case 109:case 115:}z?Zy(e,ge,ge,c&&yy(OA(e,ge,ge,0,0,d,i,te,d,ne=[],F,ue),ue),d,ue,F,i,c?ne:ue):Zy(ee,ge,ge,ge,[""],ue,0,i,ue)}}L=z=G=0,K=X=1,te=ee="",F=w;break;case 58:F=1+vl(ee),G=Y;default:if(K<1){if(se==123)--K;else if(se==125&&K++==0&&XV()==125)continue}switch(ee+=O2(se),se*K){case 38:X=z>0?1:(ee+="\f",-1);break;case 44:i[L++]=(vl(ee)-1)*X,X=1;break;case 64:vu()===45&&(ee+=J1(Gs())),N=vu(),z=F=vl(te=ee+=n8(qy())),se++;break;case 45:Y===45&&vl(ee)==2&&(K=0)}}return y}function OA(e,t,o,c,d,y,w,i,O,L,z,F){for(var N=d-1,G=d===0?y:[""],Y=ZV(G),K=0,J=0,X=0;K<c;++K)for(var se=0,te=sp(e,N+1,N=rz(J=w[K])),ne=e;se<Y;++se)(ne=iz(J>0?G[se]+" "+te:Wy(te,/&\f/g,G[se])))&&(O[X++]=ne);return D2(e,t,o,d===0?tz:i,O,L,z,F)}function i8(e,t,o,c){return D2(e,t,o,ez,O2(YV()),sp(e,2,-2),0,c)}function DA(e,t,o,c,d){return D2(e,t,o,nz,sp(e,0,c),sp(e,c+1,-1),c,d)}function Qw(e,t){for(var o="",c=0;c<e.length;c++)o+=t(e[c],c,e,t)||"";return o}function o8(e,t,o,c){switch(e.type){case WV:if(e.children.length)break;case UV:case HV:case nz:return e.return=e.return||e.value;case ez:return"";case GV:return e.return=e.value+"{"+Qw(e.children,c)+"}";case tz:if(!vl(e.value=e.props.join(",")))return""}return vl(o=Qw(e.children,c))?e.return=e.value+"{"+o+"}":""}const RA="data-ant-cssinjs-cache-path",a8="_FILE_STYLE__";let ih,az=!0;function s8(){var e;if(!ih&&(ih={},gs())){const t=document.createElement("div");t.className=RA,t.style.position="fixed",t.style.visibility="hidden",t.style.top="-9999px",document.body.appendChild(t);let o=getComputedStyle(t).content||"";o=o.replace(/^"/,"").replace(/"$/,""),o.split(";").forEach(d=>{const[y,w]=d.split(":");ih[y]=w});const c=document.querySelector(`style[${RA}]`);c&&(az=!1,(e=c.parentNode)===null||e===void 0||e.removeChild(c)),document.body.removeChild(t)}}function l8(e){return s8(),!!ih[e]}function c8(e){const t=ih[e];let o=null;if(t&&gs())if(az)o=a8;else{const c=document.querySelector(`style[${rh}="${ih[e]}"]`);c?o=c.innerHTML:delete ih[e]}return[o,t]}const zA=gs(),u8="_skip_check_",sz="_multi_value_";function LA(e){return Qw(r8(e),o8).replace(/\{%%%\:[^;];}/g,";")}function d8(e){return typeof e=="object"&&e&&(u8 in e||sz in e)}function h8(e,t,o){if(!t)return e;const c=`.${t}`,d=o==="low"?`:where(${c})`:c;return e.split(",").map(w=>{var i;const O=w.trim().split(/\s+/);let L=O[0]||"";const z=((i=L.match(/^\w+/))===null||i===void 0?void 0:i[0])||"";return L=`${z}${d}${L.slice(z.length)}`,[L,...O.slice(1)].join(" ")}).join(",")}const $A=new Set,eS=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{root:o,injectHash:c,parentSelectors:d}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]};const{hashId:y,layer:w,path:i,hashPriority:O,transformers:L=[],linters:z=[]}=t;let F="",N={};function G(J){const X=J.getName(y);if(!N[X]){const[se]=eS(J.style,t,{root:!1,parentSelectors:d});N[X]=`@keyframes ${J.getName(y)}${se}`}}function Y(J){let X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return J.forEach(se=>{Array.isArray(se)?Y(se,X):se&&X.push(se)}),X}if(Y(Array.isArray(e)?e:[e]).forEach(J=>{const X=typeof J=="string"&&!o?{}:J;if(typeof X=="string")F+=`${X}
`;else if(X._keyframe)G(X);else{const se=L.reduce((te,ne)=>{var ue;return((ue=ne==null?void 0:ne.visit)===null||ue===void 0?void 0:ue.call(ne,te))||te},X);Object.keys(se).forEach(te=>{var ne;const ue=se[te];if(typeof ue=="object"&&ue&&(te!=="animationName"||!ue._keyframe)&&!d8(ue)){let ge=!1,ee=te.trim(),be=!1;(o||c)&&y?ee.startsWith("@")?ge=!0:ee=h8(te,y,O):o&&!y&&(ee==="&"||ee==="")&&(ee="",be=!0);const[Ie,Ee]=eS(ue,t,{root:be,injectHash:ge,parentSelectors:[...d,ee]});N=re(re({},N),Ee),F+=`${ee}${Ie}`}else{let ge=function(be,Ie){const Ee=be.replace(/[A-Z]/g,Qe=>`-${Qe.toLowerCase()}`);let Re=Ie;!jV[be]&&typeof Re=="number"&&Re!==0&&(Re=`${Re}px`),be==="animationName"&&(Ie!=null&&Ie._keyframe)&&(G(Ie),Re=Ie.getName(y)),F+=`${Ee}:${Re};`};const ee=(ne=ue==null?void 0:ue.value)!==null&&ne!==void 0?ne:ue;typeof ue=="object"&&(ue!=null&&ue[sz])&&Array.isArray(ee)?ee.forEach(be=>{ge(te,be)}):ge(te,ee)}})}}),!o)F=`{${F}}`;else if(w&&zV()){const J=w.split(",");F=`@layer ${J[J.length-1].trim()} {${F}}`,J.length>1&&(F=`@layer ${w}{%%%:%}${F}`)}return[F,N]};function f8(e,t){return P2(`${e.join("%")}${t}`)}function tS(e,t){const o=lx(),c=He(()=>e.value.token._tokenKey),d=He(()=>[c.value,...e.value.path]);let y=zA;return GR("style",d,()=>{const{path:w,hashId:i,layer:O,nonce:L,clientOnly:z,order:F=0}=e.value,N=d.value.join("|");if(l8(N)){const[ee,be]=c8(N);if(ee)return[ee,c.value,be,{},z,F]}const G=t(),{hashPriority:Y,container:K,transformers:J,linters:X,cache:se}=o.value,[te,ne]=eS(G,{hashId:i,hashPriority:Y,layer:O,path:w.join("-"),transformers:J,linters:X}),ue=LA(te),ge=f8(d.value,ue);if(y){const ee={mark:rh,prepend:"queue",attachTo:K,priority:F},be=typeof L=="function"?L():L;be&&(ee.csp={nonce:be});const Ie=l_(ue,ge,ee);Ie[Hf]=se.instanceId,Ie.setAttribute(jR,c.value),Object.keys(ne).forEach(Ee=>{$A.has(Ee)||($A.add(Ee),l_(LA(ne[Ee]),`_effect-${Ee}`,{mark:rh,prepend:"queue",attachTo:K}))})}return[ue,c.value,ge,ne,z,F]},(w,i)=>{let[,,O]=w;(i||o.value.autoClear)&&zA&&Pv(O,{mark:rh})}),w=>w}class xr{constructor(t,o){this._keyframe=!0,this.name=t,this.style=o}getName(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t?`${t}-${this.name}`:this.name}}function p8(e){if(typeof e=="number")return[e];const t=String(e).split(/\s+/);let o="",c=0;return t.reduce((d,y)=>(y.includes("(")?(o+=y,c+=y.split("(").length-1):y.includes(")")?(o+=` ${y}`,c-=y.split(")").length-1,c===0&&(d.push(o),o="")):c>0?o+=` ${y}`:d.push(y),d),[])}function zf(e){return e.notSplit=!0,e}const m8={inset:["top","right","bottom","left"],insetBlock:["top","bottom"],insetBlockStart:["top"],insetBlockEnd:["bottom"],insetInline:["left","right"],insetInlineStart:["left"],insetInlineEnd:["right"],marginBlock:["marginTop","marginBottom"],marginBlockStart:["marginTop"],marginBlockEnd:["marginBottom"],marginInline:["marginLeft","marginRight"],marginInlineStart:["marginLeft"],marginInlineEnd:["marginRight"],paddingBlock:["paddingTop","paddingBottom"],paddingBlockStart:["paddingTop"],paddingBlockEnd:["paddingBottom"],paddingInline:["paddingLeft","paddingRight"],paddingInlineStart:["paddingLeft"],paddingInlineEnd:["paddingRight"],borderBlock:zf(["borderTop","borderBottom"]),borderBlockStart:zf(["borderTop"]),borderBlockEnd:zf(["borderBottom"]),borderInline:zf(["borderLeft","borderRight"]),borderInlineStart:zf(["borderLeft"]),borderInlineEnd:zf(["borderRight"]),borderBlockWidth:["borderTopWidth","borderBottomWidth"],borderBlockStartWidth:["borderTopWidth"],borderBlockEndWidth:["borderBottomWidth"],borderInlineWidth:["borderLeftWidth","borderRightWidth"],borderInlineStartWidth:["borderLeftWidth"],borderInlineEndWidth:["borderRightWidth"],borderBlockStyle:["borderTopStyle","borderBottomStyle"],borderBlockStartStyle:["borderTopStyle"],borderBlockEndStyle:["borderBottomStyle"],borderInlineStyle:["borderLeftStyle","borderRightStyle"],borderInlineStartStyle:["borderLeftStyle"],borderInlineEndStyle:["borderRightStyle"],borderBlockColor:["borderTopColor","borderBottomColor"],borderBlockStartColor:["borderTopColor"],borderBlockEndColor:["borderBottomColor"],borderInlineColor:["borderLeftColor","borderRightColor"],borderInlineStartColor:["borderLeftColor"],borderInlineEndColor:["borderRightColor"],borderStartStartRadius:["borderTopLeftRadius"],borderStartEndRadius:["borderTopRightRadius"],borderEndStartRadius:["borderBottomLeftRadius"],borderEndEndRadius:["borderBottomRightRadius"]};function vy(e){return{_skip_check_:!0,value:e}}const g8={visit:e=>{const t={};return Object.keys(e).forEach(o=>{const c=e[o],d=m8[o];if(d&&(typeof c=="number"||typeof c=="string")){const y=p8(c);d.length&&d.notSplit?d.forEach(w=>{t[w]=vy(c)}):d.length===1?t[d[0]]=vy(c):d.length===2?d.forEach((w,i)=>{var O;t[w]=vy((O=y[i])!==null&&O!==void 0?O:y[0])}):d.length===4?d.forEach((w,i)=>{var O,L;t[w]=vy((L=(O=y[i])!==null&&O!==void 0?O:y[i-2])!==null&&L!==void 0?L:y[0])}):t[o]=c}else t[o]=c}),t}},_8="4.2.6",u_=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"];function Bo(e,t){y8(e)&&(e="100%");var o=v8(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function xy(e){return Math.min(1,Math.max(0,e))}function y8(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function v8(e){return typeof e=="string"&&e.indexOf("%")!==-1}function lz(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function by(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Qd(e){return e.length===1?"0"+e:String(e)}function x8(e,t,o){return{r:Bo(e,255)*255,g:Bo(t,255)*255,b:Bo(o,255)*255}}function FA(e,t,o){e=Bo(e,255),t=Bo(t,255),o=Bo(o,255);var c=Math.max(e,t,o),d=Math.min(e,t,o),y=0,w=0,i=(c+d)/2;if(c===d)w=0,y=0;else{var O=c-d;switch(w=i>.5?O/(2-c-d):O/(c+d),c){case e:y=(t-o)/O+(t<o?6:0);break;case t:y=(o-e)/O+2;break;case o:y=(e-t)/O+4;break}y/=6}return{h:y,s:w,l:i}}function Q1(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(t-e)*(6*o):o<1/2?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function b8(e,t,o){var c,d,y;if(e=Bo(e,360),t=Bo(t,100),o=Bo(o,100),t===0)d=o,y=o,c=o;else{var w=o<.5?o*(1+t):o+t-o*t,i=2*o-w;c=Q1(i,w,e+1/3),d=Q1(i,w,e),y=Q1(i,w,e-1/3)}return{r:c*255,g:d*255,b:y*255}}function nS(e,t,o){e=Bo(e,255),t=Bo(t,255),o=Bo(o,255);var c=Math.max(e,t,o),d=Math.min(e,t,o),y=0,w=c,i=c-d,O=c===0?0:i/c;if(c===d)y=0;else{switch(c){case e:y=(t-o)/i+(t<o?6:0);break;case t:y=(o-e)/i+2;break;case o:y=(e-t)/i+4;break}y/=6}return{h:y,s:O,v:w}}function w8(e,t,o){e=Bo(e,360)*6,t=Bo(t,100),o=Bo(o,100);var c=Math.floor(e),d=e-c,y=o*(1-t),w=o*(1-d*t),i=o*(1-(1-d)*t),O=c%6,L=[o,w,y,y,i,o][O],z=[i,o,o,w,y,y][O],F=[y,y,i,o,o,w][O];return{r:L*255,g:z*255,b:F*255}}function rS(e,t,o,c){var d=[Qd(Math.round(e).toString(16)),Qd(Math.round(t).toString(16)),Qd(Math.round(o).toString(16))];return c&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function S8(e,t,o,c,d){var y=[Qd(Math.round(e).toString(16)),Qd(Math.round(t).toString(16)),Qd(Math.round(o).toString(16)),Qd(C8(c))];return d&&y[0].startsWith(y[0].charAt(1))&&y[1].startsWith(y[1].charAt(1))&&y[2].startsWith(y[2].charAt(1))&&y[3].startsWith(y[3].charAt(1))?y[0].charAt(0)+y[1].charAt(0)+y[2].charAt(0)+y[3].charAt(0):y.join("")}function C8(e){return Math.round(parseFloat(e)*255).toString(16)}function BA(e){return Ra(e)/255}function Ra(e){return parseInt(e,16)}function T8(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var iS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Nf(e){var t={r:0,g:0,b:0},o=1,c=null,d=null,y=null,w=!1,i=!1;return typeof e=="string"&&(e=I8(e)),typeof e=="object"&&(cc(e.r)&&cc(e.g)&&cc(e.b)?(t=x8(e.r,e.g,e.b),w=!0,i=String(e.r).substr(-1)==="%"?"prgb":"rgb"):cc(e.h)&&cc(e.s)&&cc(e.v)?(c=by(e.s),d=by(e.v),t=w8(e.h,c,d),w=!0,i="hsv"):cc(e.h)&&cc(e.s)&&cc(e.l)&&(c=by(e.s),y=by(e.l),t=b8(e.h,c,y),w=!0,i="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=lz(o),{ok:w,format:e.format||i,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:o}}var E8="[-\\+]?\\d+%?",M8="[-\\+]?\\d*\\.\\d+%?",xu="(?:".concat(M8,")|(?:").concat(E8,")"),ew="[\\s|\\(]+(".concat(xu,")[,|\\s]+(").concat(xu,")[,|\\s]+(").concat(xu,")\\s*\\)?"),tw="[\\s|\\(]+(".concat(xu,")[,|\\s]+(").concat(xu,")[,|\\s]+(").concat(xu,")[,|\\s]+(").concat(xu,")\\s*\\)?"),Bs={CSS_UNIT:new RegExp(xu),rgb:new RegExp("rgb"+ew),rgba:new RegExp("rgba"+tw),hsl:new RegExp("hsl"+ew),hsla:new RegExp("hsla"+tw),hsv:new RegExp("hsv"+ew),hsva:new RegExp("hsva"+tw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function I8(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(iS[e])e=iS[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=Bs.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=Bs.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=Bs.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=Bs.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=Bs.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=Bs.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=Bs.hex8.exec(e),o?{r:Ra(o[1]),g:Ra(o[2]),b:Ra(o[3]),a:BA(o[4]),format:t?"name":"hex8"}:(o=Bs.hex6.exec(e),o?{r:Ra(o[1]),g:Ra(o[2]),b:Ra(o[3]),format:t?"name":"hex"}:(o=Bs.hex4.exec(e),o?{r:Ra(o[1]+o[1]),g:Ra(o[2]+o[2]),b:Ra(o[3]+o[3]),a:BA(o[4]+o[4]),format:t?"name":"hex8"}:(o=Bs.hex3.exec(e),o?{r:Ra(o[1]+o[1]),g:Ra(o[2]+o[2]),b:Ra(o[3]+o[3]),format:t?"name":"hex"}:!1)))))))))}function cc(e){return!!Bs.CSS_UNIT.exec(String(e))}var qi=function(){function e(t,o){t===void 0&&(t=""),o===void 0&&(o={});var c;if(t instanceof e)return t;typeof t=="number"&&(t=T8(t)),this.originalInput=t;var d=Nf(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(c=o.format)!==null&&c!==void 0?c:d.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),o,c,d,y=t.r/255,w=t.g/255,i=t.b/255;return y<=.03928?o=y/12.92:o=Math.pow((y+.055)/1.055,2.4),w<=.03928?c=w/12.92:c=Math.pow((w+.055)/1.055,2.4),i<=.03928?d=i/12.92:d=Math.pow((i+.055)/1.055,2.4),.2126*o+.7152*c+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=lz(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=nS(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=nS(this.r,this.g,this.b),o=Math.round(t.h*360),c=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(o,", ").concat(c,"%, ").concat(d,"%)"):"hsva(".concat(o,", ").concat(c,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=FA(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=FA(this.r,this.g,this.b),o=Math.round(t.h*360),c=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(o,", ").concat(c,"%, ").concat(d,"%)"):"hsla(".concat(o,", ").concat(c,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),rS(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),S8(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),o=Math.round(this.g),c=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(o,", ").concat(c,")"):"rgba(".concat(t,", ").concat(o,", ").concat(c,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(o){return"".concat(Math.round(Bo(o,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(o){return Math.round(Bo(o,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+rS(this.r,this.g,this.b,!1),o=0,c=Object.entries(iS);o<c.length;o++){var d=c[o],y=d[0],w=d[1];if(t===w)return y}return!1},e.prototype.toString=function(t){var o=!!t;t=t??this.format;var c=!1,d=this.a<1&&this.a>=0,y=!o&&d&&(t.startsWith("hex")||t==="name");return y?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(c=this.toRgbString()),t==="prgb"&&(c=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(c=this.toHexString()),t==="hex3"&&(c=this.toHexString(!0)),t==="hex4"&&(c=this.toHex8String(!0)),t==="hex8"&&(c=this.toHex8String()),t==="name"&&(c=this.toName()),t==="hsl"&&(c=this.toHslString()),t==="hsv"&&(c=this.toHsvString()),c||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l+=t/100,o.l=xy(o.l),new e(o)},e.prototype.brighten=function(t){t===void 0&&(t=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(t/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(t/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(t/100)))),new e(o)},e.prototype.darken=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l-=t/100,o.l=xy(o.l),new e(o)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s-=t/100,o.s=xy(o.s),new e(o)},e.prototype.saturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s+=t/100,o.s=xy(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var o=this.toHsl(),c=(o.h+t)%360;return o.h=c<0?360+c:c,new e(o)},e.prototype.mix=function(t,o){o===void 0&&(o=50);var c=this.toRgb(),d=new e(t).toRgb(),y=o/100,w={r:(d.r-c.r)*y+c.r,g:(d.g-c.g)*y+c.g,b:(d.b-c.b)*y+c.b,a:(d.a-c.a)*y+c.a};return new e(w)},e.prototype.analogous=function(t,o){t===void 0&&(t=6),o===void 0&&(o=30);var c=this.toHsl(),d=360/o,y=[this];for(c.h=(c.h-(d*t>>1)+720)%360;--t;)c.h=(c.h+d)%360,y.push(new e(c));return y},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var o=this.toHsv(),c=o.h,d=o.s,y=o.v,w=[],i=1/t;t--;)w.push(new e({h:c,s:d,v:y})),y=(y+i)%1;return w},e.prototype.splitcomplement=function(){var t=this.toHsl(),o=t.h;return[this,new e({h:(o+72)%360,s:t.s,l:t.l}),new e({h:(o+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var o=this.toRgb(),c=new e(t).toRgb(),d=o.a+c.a*(1-o.a);return new e({r:(o.r*o.a+c.r*c.a*(1-o.a))/d,g:(o.g*o.a+c.g*c.a*(1-o.a))/d,b:(o.b*o.a+c.b*c.a*(1-o.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var o=this.toHsl(),c=o.h,d=[this],y=360/t,w=1;w<t;w++)d.push(new e({h:(c+w*y)%360,s:o.s,l:o.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}(),wy=2,kA=.16,A8=.05,P8=.05,O8=.15,cz=5,uz=4,D8=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function NA(e){var t=e.r,o=e.g,c=e.b,d=nS(t,o,c);return{h:d.h*360,s:d.s,v:d.v}}function Sy(e){var t=e.r,o=e.g,c=e.b;return"#".concat(rS(t,o,c,!1))}function R8(e,t,o){var c=o/100,d={r:(t.r-e.r)*c+e.r,g:(t.g-e.g)*c+e.g,b:(t.b-e.b)*c+e.b};return d}function VA(e,t,o){var c;return Math.round(e.h)>=60&&Math.round(e.h)<=240?c=o?Math.round(e.h)-wy*t:Math.round(e.h)+wy*t:c=o?Math.round(e.h)+wy*t:Math.round(e.h)-wy*t,c<0?c+=360:c>=360&&(c-=360),c}function jA(e,t,o){if(e.h===0&&e.s===0)return e.s;var c;return o?c=e.s-kA*t:t===uz?c=e.s+kA:c=e.s+A8*t,c>1&&(c=1),o&&t===cz&&c>.1&&(c=.1),c<.06&&(c=.06),Number(c.toFixed(2))}function UA(e,t,o){var c;return o?c=e.v+P8*t:c=e.v-O8*t,c>1&&(c=1),Number(c.toFixed(2))}function fh(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=[],c=Nf(e),d=cz;d>0;d-=1){var y=NA(c),w=Sy(Nf({h:VA(y,d,!0),s:jA(y,d,!0),v:UA(y,d,!0)}));o.push(w)}o.push(Sy(c));for(var i=1;i<=uz;i+=1){var O=NA(c),L=Sy(Nf({h:VA(O,i),s:jA(O,i),v:UA(O,i)}));o.push(L)}return t.theme==="dark"?D8.map(function(z){var F=z.index,N=z.opacity,G=Sy(R8(Nf(t.backgroundColor||"#141414"),Nf(o[F]),N*100));return G}):o}var nw={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Yy={},rw={};Object.keys(nw).forEach(function(e){Yy[e]=fh(nw[e]),Yy[e].primary=Yy[e][5],rw[e]=fh(nw[e],{theme:"dark",backgroundColor:"#141414"}),rw[e].primary=rw[e][5]});var z8=Yy.blue;const L8=e=>{const{controlHeight:t}=e;return{controlHeightSM:t*.75,controlHeightXS:t*.5,controlHeightLG:t*1.25}};function $8(e){const{sizeUnit:t,sizeStep:o}=e;return{sizeXXL:t*(o+8),sizeXL:t*(o+4),sizeLG:t*(o+2),sizeMD:t*(o+1),sizeMS:t*o,size:t*o,sizeSM:t*(o-1),sizeXS:t*(o-2),sizeXXS:t*(o-3)}}const dz={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},hx=re(re({},dz),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1});function F8(e,t){let{generateColorPalettes:o,generateNeutralColorPalettes:c}=t;const{colorSuccess:d,colorWarning:y,colorError:w,colorInfo:i,colorPrimary:O,colorBgBase:L,colorTextBase:z}=e,F=o(O),N=o(d),G=o(y),Y=o(w),K=o(i),J=c(L,z);return re(re({},J),{colorPrimaryBg:F[1],colorPrimaryBgHover:F[2],colorPrimaryBorder:F[3],colorPrimaryBorderHover:F[4],colorPrimaryHover:F[5],colorPrimary:F[6],colorPrimaryActive:F[7],colorPrimaryTextHover:F[8],colorPrimaryText:F[9],colorPrimaryTextActive:F[10],colorSuccessBg:N[1],colorSuccessBgHover:N[2],colorSuccessBorder:N[3],colorSuccessBorderHover:N[4],colorSuccessHover:N[4],colorSuccess:N[6],colorSuccessActive:N[7],colorSuccessTextHover:N[8],colorSuccessText:N[9],colorSuccessTextActive:N[10],colorErrorBg:Y[1],colorErrorBgHover:Y[2],colorErrorBorder:Y[3],colorErrorBorderHover:Y[4],colorErrorHover:Y[5],colorError:Y[6],colorErrorActive:Y[7],colorErrorTextHover:Y[8],colorErrorText:Y[9],colorErrorTextActive:Y[10],colorWarningBg:G[1],colorWarningBgHover:G[2],colorWarningBorder:G[3],colorWarningBorderHover:G[4],colorWarningHover:G[4],colorWarning:G[6],colorWarningActive:G[7],colorWarningTextHover:G[8],colorWarningText:G[9],colorWarningTextActive:G[10],colorInfoBg:K[1],colorInfoBgHover:K[2],colorInfoBorder:K[3],colorInfoBorderHover:K[4],colorInfoHover:K[4],colorInfo:K[6],colorInfoActive:K[7],colorInfoTextHover:K[8],colorInfoText:K[9],colorInfoTextActive:K[10],colorBgMask:new qi("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const B8=e=>{let t=e,o=e,c=e,d=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?o=4:e<8&&e>=7?o=5:e<14&&e>=8?o=6:e<16&&e>=14?o=7:e>=16&&(o=8),e<6&&e>=2?c=1:e>=6&&(c=2),e>4&&e<8?d=4:e>=8&&(d=6),{borderRadius:e>16?16:e,borderRadiusXS:c,borderRadiusSM:o,borderRadiusLG:t,borderRadiusOuter:d}};function k8(e){const{motionUnit:t,motionBase:o,borderRadius:c,lineWidth:d}=e;return re({motionDurationFast:`${(o+t).toFixed(1)}s`,motionDurationMid:`${(o+t*2).toFixed(1)}s`,motionDurationSlow:`${(o+t*3).toFixed(1)}s`,lineWidthBold:d+1},B8(c))}const uc=(e,t)=>new qi(e).setAlpha(t).toRgbString(),wg=(e,t)=>new qi(e).darken(t).toHexString(),N8=e=>{const t=fh(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},V8=(e,t)=>{const o=e||"#fff",c=t||"#000";return{colorBgBase:o,colorTextBase:c,colorText:uc(c,.88),colorTextSecondary:uc(c,.65),colorTextTertiary:uc(c,.45),colorTextQuaternary:uc(c,.25),colorFill:uc(c,.15),colorFillSecondary:uc(c,.06),colorFillTertiary:uc(c,.04),colorFillQuaternary:uc(c,.02),colorBgLayout:wg(o,4),colorBgContainer:wg(o,0),colorBgElevated:wg(o,0),colorBgSpotlight:uc(c,.85),colorBorder:wg(o,15),colorBorderSecondary:wg(o,6)}};function j8(e){const t=new Array(10).fill(null).map((o,c)=>{const d=c-1,y=e*Math.pow(2.71828,d/5),w=c>1?Math.floor(y):Math.ceil(y);return Math.floor(w/2)*2});return t[1]=e,t.map(o=>{const c=o+8;return{size:o,lineHeight:c/o}})}const U8=e=>{const t=j8(e),o=t.map(d=>d.size),c=t.map(d=>d.lineHeight);return{fontSizeSM:o[0],fontSize:o[1],fontSizeLG:o[2],fontSizeXL:o[3],fontSizeHeading1:o[6],fontSizeHeading2:o[5],fontSizeHeading3:o[4],fontSizeHeading4:o[3],fontSizeHeading5:o[2],lineHeight:c[1],lineHeightLG:c[2],lineHeightSM:c[0],lineHeightHeading1:c[6],lineHeightHeading2:c[5],lineHeightHeading3:c[4],lineHeightHeading4:c[3],lineHeightHeading5:c[2]}};function H8(e){const t=Object.keys(dz).map(o=>{const c=fh(e[o]);return new Array(10).fill(1).reduce((d,y,w)=>(d[`${o}-${w+1}`]=c[w],d),{})}).reduce((o,c)=>(o=re(re({},o),c),o),{});return re(re(re(re(re(re(re({},e),t),F8(e,{generateColorPalettes:N8,generateNeutralColorPalettes:V8})),U8(e.fontSize)),$8(e)),L8(e)),k8(e))}function iw(e){return e>=0&&e<=255}function Cy(e,t){const{r:o,g:c,b:d,a:y}=new qi(e).toRgb();if(y<1)return e;const{r:w,g:i,b:O}=new qi(t).toRgb();for(let L=.01;L<=1;L+=.01){const z=Math.round((o-w*(1-L))/L),F=Math.round((c-i*(1-L))/L),N=Math.round((d-O*(1-L))/L);if(iw(z)&&iw(F)&&iw(N))return new qi({r:z,g:F,b:N,a:Math.round(L*100)/100}).toRgbString()}return new qi({r:o,g:c,b:d,a:1}).toRgbString()}var G8=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};function W8(e){const{override:t}=e,o=G8(e,["override"]),c=re({},t);Object.keys(hx).forEach(G=>{delete c[G]});const d=re(re({},o),c),y=480,w=576,i=768,O=992,L=1200,z=1600,F=2e3;return re(re(re({},d),{colorLink:d.colorInfoText,colorLinkHover:d.colorInfoHover,colorLinkActive:d.colorInfoActive,colorFillContent:d.colorFillSecondary,colorFillContentHover:d.colorFill,colorFillAlter:d.colorFillQuaternary,colorBgContainerDisabled:d.colorFillTertiary,colorBorderBg:d.colorBgContainer,colorSplit:Cy(d.colorBorderSecondary,d.colorBgContainer),colorTextPlaceholder:d.colorTextQuaternary,colorTextDisabled:d.colorTextQuaternary,colorTextHeading:d.colorText,colorTextLabel:d.colorTextSecondary,colorTextDescription:d.colorTextTertiary,colorTextLightSolid:d.colorWhite,colorHighlight:d.colorError,colorBgTextHover:d.colorFillSecondary,colorBgTextActive:d.colorFill,colorIcon:d.colorTextTertiary,colorIconHover:d.colorText,colorErrorOutline:Cy(d.colorErrorBg,d.colorBgContainer),colorWarningOutline:Cy(d.colorWarningBg,d.colorBgContainer),fontSizeIcon:d.fontSizeSM,lineWidth:d.lineWidth,controlOutlineWidth:d.lineWidth*2,controlInteractiveSize:d.controlHeight/2,controlItemBgHover:d.colorFillTertiary,controlItemBgActive:d.colorPrimaryBg,controlItemBgActiveHover:d.colorPrimaryBgHover,controlItemBgActiveDisabled:d.colorFill,controlTmpOutline:d.colorFillQuaternary,controlOutline:Cy(d.colorPrimaryBg,d.colorBgContainer),lineType:d.lineType,borderRadius:d.borderRadius,borderRadiusXS:d.borderRadiusXS,borderRadiusSM:d.borderRadiusSM,borderRadiusLG:d.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:d.sizeXXS,paddingXS:d.sizeXS,paddingSM:d.sizeSM,padding:d.size,paddingMD:d.sizeMD,paddingLG:d.sizeLG,paddingXL:d.sizeXL,paddingContentHorizontalLG:d.sizeLG,paddingContentVerticalLG:d.sizeMS,paddingContentHorizontal:d.sizeMS,paddingContentVertical:d.sizeSM,paddingContentHorizontalSM:d.size,paddingContentVerticalSM:d.sizeXS,marginXXS:d.sizeXXS,marginXS:d.sizeXS,marginSM:d.sizeSM,margin:d.size,marginMD:d.sizeMD,marginLG:d.sizeLG,marginXL:d.sizeXL,marginXXL:d.sizeXXL,boxShadow:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:y,screenXSMin:y,screenXSMax:w-1,screenSM:w,screenSMMin:w,screenSMMax:i-1,screenMD:i,screenMDMin:i,screenMDMax:O-1,screenLG:O,screenLGMin:O,screenLGMax:L-1,screenXL:L,screenXLMin:L,screenXLMax:z-1,screenXXL:z,screenXXLMin:z,screenXXLMax:F-1,screenXXXL:F,screenXXXLMin:F,boxShadowPopoverArrow:"3px 3px 7px rgba(0, 0, 0, 0.1)",boxShadowCard:`
      0 1px 2px -2px ${new qi("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new qi("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new qi("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),c)}const q8=(e,t,o,c,d)=>{const y=e/2,w=0,i=y,O=o*1/Math.sqrt(2),L=y-o*(1-1/Math.sqrt(2)),z=y-t*(1/Math.sqrt(2)),F=o*(Math.sqrt(2)-1)+t*(1/Math.sqrt(2)),N=2*y-z,G=F,Y=2*y-O,K=L,J=2*y-w,X=i,se=y*Math.sqrt(2)+o*(Math.sqrt(2)-2),te=o*(Math.sqrt(2)-1);return{pointerEvents:"none",width:e,height:e,overflow:"hidden","&::after":{content:'""',position:"absolute",width:se,height:se,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${t}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:d,zIndex:0,background:"transparent"},"&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:e,height:e/2,background:c,clipPath:{_multi_value_:!0,value:[`polygon(${te}px 100%, 50% ${te}px, ${2*y-te}px 100%, ${te}px 100%)`,`path('M ${w} ${i} A ${o} ${o} 0 0 0 ${O} ${L} L ${z} ${F} A ${t} ${t} 0 0 1 ${N} ${G} L ${Y} ${K} A ${o} ${o} 0 0 0 ${J} ${X} Z')`]},content:'""'}}};function Dv(e,t){return u_.reduce((o,c)=>{const d=e[`${c}-1`],y=e[`${c}-3`],w=e[`${c}-6`],i=e[`${c}-7`];return re(re({},o),t(c,{lightColor:d,lightBorderColor:y,darkColor:w,textColor:i}))},{})}const Rv={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},Ei=e=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:e.fontFamily}),fx=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),hz=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),Z8=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active,\n  &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),Y8=(e,t)=>{const{fontFamily:o,fontSize:c}=e,d=`[class^="${t}"], [class*=" ${t}"]`;return{[d]:{fontFamily:o,fontSize:c,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[d]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},px=e=>({outline:`${e.lineWidthBold}px solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),fz=e=>({"&:focus-visible":re({},px(e))});function Ui(e,t,o){return c=>{const d=He(()=>c==null?void 0:c.value),[y,w,i]=gp(),{getPrefixCls:O,iconPrefixCls:L}=A2(),z=He(()=>O()),F=He(()=>({theme:y.value,token:w.value,hashId:i.value,path:["Shared",z.value]}));tS(F,()=>[{"&":Z8(w.value)}]);const N=He(()=>({theme:y.value,token:w.value,hashId:i.value,path:[e,d.value,L.value]}));return[tS(N,()=>{const{token:G,flush:Y}=K8(w.value),K=typeof o=="function"?o(G):o,J=re(re({},K),w.value[e]),X=`.${d.value}`,se=Wr(G,{componentCls:X,prefixCls:d.value,iconCls:`.${L.value}`,antCls:`.${z.value}`},J),te=t(se,{hashId:i.value,prefixCls:d.value,rootPrefixCls:z.value,iconPrefixCls:L.value,overrideComponentToken:w.value[e]});return Y(e,J),[Y8(w.value,d.value),te]}),i]}}const pz=typeof CSSINJS_STATISTIC<"u";let oS=!0;function Wr(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(!pz)return re({},...t);oS=!1;const c={};return t.forEach(d=>{Object.keys(d).forEach(w=>{Object.defineProperty(c,w,{configurable:!0,enumerable:!0,get:()=>d[w]})})}),oS=!0,c}function X8(){}function K8(e){let t,o=e,c=X8;return pz&&(t=new Set,o=new Proxy(e,{get(d,y){return oS&&t.add(y),d[y]}}),c=(d,y)=>{Array.from(t)}),{token:o,keys:t,flush:c}}const J8=JR(H8),mz={token:hx,hashed:!0},gz=Symbol("DesignTokenContext"),aS=Xt(),Q8=e=>{li(gz,e),On(e,()=>{aS.value=Ar(e),Dk(aS)},{immediate:!0,deep:!0})},ej=cn({props:{value:oi()},setup(e,t){let{slots:o}=t;return Q8(He(()=>e.value)),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}});function gp(){const e=Zr(gz,He(()=>aS.value||mz)),t=He(()=>`${_8}-${e.value.hashed||""}`),o=He(()=>e.value.theme||J8),c=VV(o,He(()=>[hx,e.value.token]),He(()=>({salt:t.value,override:re({override:e.value.token},e.value.components),formatToken:W8})));return[o,He(()=>c.value[0]),He(()=>e.value.hashed?c.value[1]:"")]}const R2=cn({compatConfig:{MODE:3},setup(){const[,e]=gp(),t=He(()=>new qi(e.value.colorBgBase).toHsl().l<.5?{opacity:.65}:{});return()=>le("svg",{style:t.value,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},[le("g",{fill:"none","fill-rule":"evenodd"},[le("g",{transform:"translate(24 31.67)"},[le("ellipse",{"fill-opacity":".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"},null),le("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"},null),le("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"},null),le("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"},null),le("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"},null)]),le("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"},null),le("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},[le("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"},null),le("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"},null)])])])}});R2.PRESENTED_IMAGE_DEFAULT=!0;const _z=cn({compatConfig:{MODE:3},setup(){const[,e]=gp(),t=He(()=>{const{colorFill:o,colorFillTertiary:c,colorFillQuaternary:d,colorBgContainer:y}=e.value;return{borderColor:new qi(o).onBackground(y).toHexString(),shadowColor:new qi(c).onBackground(y).toHexString(),contentColor:new qi(d).onBackground(y).toHexString()}});return()=>le("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},[le("g",{transform:"translate(0 1)",fill:"none","fill-rule":"evenodd"},[le("ellipse",{fill:t.value.shadowColor,cx:"32",cy:"33",rx:"32",ry:"7"},null),le("g",{"fill-rule":"nonzero",stroke:t.value.borderColor},[le("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"},null),le("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:t.value.contentColor},null)])])])}});_z.PRESENTED_IMAGE_SIMPLE=!0;const tj=e=>{const{componentCls:t,margin:o,marginXS:c,marginXL:d,fontSize:y,lineHeight:w}=e;return{[t]:{marginInline:c,fontSize:y,lineHeight:w,textAlign:"center",[`${t}-image`]:{height:e.emptyImgHeight,marginBottom:c,opacity:e.opacityImage,img:{height:"100%"},svg:{height:"100%",margin:"auto"}},[`${t}-footer`]:{marginTop:o},"&-normal":{marginBlock:d,color:e.colorTextDisabled,[`${t}-image`]:{height:e.emptyImgHeightMD}},"&-small":{marginBlock:c,color:e.colorTextDisabled,[`${t}-image`]:{height:e.emptyImgHeightSM}}}}},nj=Ui("Empty",e=>{const{componentCls:t,controlHeightLG:o}=e,c=Wr(e,{emptyImgCls:`${t}-img`,emptyImgHeight:o*2.5,emptyImgHeightMD:o,emptyImgHeightSM:o*.875});return[tj(c)]});var rj=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const ij=()=>({prefixCls:String,imageStyle:oi(),image:La(),description:La()}),z2=cn({name:"AEmpty",compatConfig:{MODE:3},inheritAttrs:!1,props:ij(),setup(e,t){let{slots:o={},attrs:c}=t;const{direction:d,prefixCls:y}=Rr("empty",e),[w,i]=nj(y);return()=>{var O,L;const z=y.value,F=re(re({},e),c),{image:N=((O=o.image)===null||O===void 0?void 0:O.call(o))||hh(R2),description:G=((L=o.description)===null||L===void 0?void 0:L.call(o))||void 0,imageStyle:Y,class:K=""}=F,J=rj(F,["image","description","imageStyle","class"]),X=typeof N=="function"?N():N,se=typeof X=="object"&&"type"in X&&X.type.PRESENTED_IMAGE_SIMPLE;return w(le(VR,{componentName:"Empty",children:te=>{const ne=typeof G<"u"?G:te.description,ue=typeof ne=="string"?ne:"empty";let ge=null;return typeof X=="string"?ge=le("img",{alt:ue,src:X},null):ge=X,le("div",it({class:hn(z,K,i.value,{[`${z}-normal`]:se,[`${z}-rtl`]:d.value==="rtl"})},J),[le("div",{class:`${z}-image`,style:Y},[ge]),ne&&le("p",{class:`${z}-description`},[ne]),o.default&&le("div",{class:`${z}-footer`},[ms(o.default())])])}},null))}}});z2.PRESENTED_IMAGE_DEFAULT=()=>hh(R2);z2.PRESENTED_IMAGE_SIMPLE=()=>hh(_z);const Sg=Pl(z2),L2=e=>{const{prefixCls:t}=Rr("empty",e);return(c=>{switch(c){case"Table":case"List":return le(Sg,{image:Sg.PRESENTED_IMAGE_SIMPLE},null);case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return le(Sg,{image:Sg.PRESENTED_IMAGE_SIMPLE,class:`${t.value}-small`},null);default:return le(Sg,null,null)}})(e.componentName)};function oj(e){return le(L2,{componentName:e},null)}const yz=Symbol("SizeContextKey"),vz=()=>Zr(yz,tn(void 0)),xz=e=>{const t=vz();return li(yz,He(()=>e.value||t.value)),e},Rr=(e,t)=>{const o=vz(),c=yc(),d=Zr(I2,re(re({},FR),{renderEmpty:ee=>hh(L2,{componentName:ee})})),y=He(()=>d.getPrefixCls(e,t.prefixCls)),w=He(()=>{var ee,be;return(ee=t.direction)!==null&&ee!==void 0?ee:(be=d.direction)===null||be===void 0?void 0:be.value}),i=He(()=>{var ee;return(ee=t.iconPrefixCls)!==null&&ee!==void 0?ee:d.iconPrefixCls.value}),O=He(()=>d.getPrefixCls()),L=He(()=>{var ee;return(ee=d.autoInsertSpaceInButton)===null||ee===void 0?void 0:ee.value}),z=d.renderEmpty,F=d.space,N=d.pageHeader,G=d.form,Y=He(()=>{var ee,be;return(ee=t.getTargetContainer)!==null&&ee!==void 0?ee:(be=d.getTargetContainer)===null||be===void 0?void 0:be.value}),K=He(()=>{var ee,be,Ie;return(be=(ee=t.getContainer)!==null&&ee!==void 0?ee:t.getPopupContainer)!==null&&be!==void 0?be:(Ie=d.getPopupContainer)===null||Ie===void 0?void 0:Ie.value}),J=He(()=>{var ee,be;return(ee=t.dropdownMatchSelectWidth)!==null&&ee!==void 0?ee:(be=d.dropdownMatchSelectWidth)===null||be===void 0?void 0:be.value}),X=He(()=>{var ee;return(t.virtual===void 0?((ee=d.virtual)===null||ee===void 0?void 0:ee.value)!==!1:t.virtual!==!1)&&J.value!==!1}),se=He(()=>t.size||o.value),te=He(()=>{var ee,be,Ie;return(ee=t.autocomplete)!==null&&ee!==void 0?ee:(Ie=(be=d.input)===null||be===void 0?void 0:be.value)===null||Ie===void 0?void 0:Ie.autocomplete}),ne=He(()=>{var ee;return(ee=t.disabled)!==null&&ee!==void 0?ee:c.value}),ue=He(()=>{var ee;return(ee=t.csp)!==null&&ee!==void 0?ee:d.csp}),ge=He(()=>{var ee,be;return(ee=t.wave)!==null&&ee!==void 0?ee:(be=d.wave)===null||be===void 0?void 0:be.value});return{configProvider:d,prefixCls:y,direction:w,size:se,getTargetContainer:Y,getPopupContainer:K,space:F,pageHeader:N,form:G,autoInsertSpaceInButton:L,renderEmpty:z,virtual:X,dropdownMatchSelectWidth:J,rootPrefixCls:O,getPrefixCls:d.getPrefixCls,autocomplete:te,csp:ue,iconPrefixCls:i,disabled:ne,select:d.select,wave:ge}};function co(e,t){const o=re({},e);for(let c=0;c<t.length;c+=1){const d=t[c];delete o[d]}return o}function HA(e){return typeof e=="object"&&e!=null&&e.nodeType===1}function GA(e,t){return(!t||e!=="hidden")&&e!=="visible"&&e!=="clip"}function ow(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var o=getComputedStyle(e,null);return GA(o.overflowY,t)||GA(o.overflowX,t)||function(c){var d=function(y){if(!y.ownerDocument||!y.ownerDocument.defaultView)return null;try{return y.ownerDocument.defaultView.frameElement}catch{return null}}(c);return!!d&&(d.clientHeight<c.scrollHeight||d.clientWidth<c.scrollWidth)}(e)}return!1}function Ty(e,t,o,c,d,y,w,i){return y<e&&w>t||y>e&&w<t?0:y<=e&&i<=o||w>=t&&i>=o?y-e-c:w>t&&i<o||y<e&&i>o?w-t+d:0}var WA=function(e,t){var o=window,c=t.scrollMode,d=t.block,y=t.inline,w=t.boundary,i=t.skipOverflowHiddenElements,O=typeof w=="function"?w:function(je){return je!==w};if(!HA(e))throw new TypeError("Invalid target");for(var L,z,F=document.scrollingElement||document.documentElement,N=[],G=e;HA(G)&&O(G);){if((G=(z=(L=G).parentElement)==null?L.getRootNode().host||null:z)===F){N.push(G);break}G!=null&&G===document.body&&ow(G)&&!ow(document.documentElement)||G!=null&&ow(G,i)&&N.push(G)}for(var Y=o.visualViewport?o.visualViewport.width:innerWidth,K=o.visualViewport?o.visualViewport.height:innerHeight,J=window.scrollX||pageXOffset,X=window.scrollY||pageYOffset,se=e.getBoundingClientRect(),te=se.height,ne=se.width,ue=se.top,ge=se.right,ee=se.bottom,be=se.left,Ie=d==="start"||d==="nearest"?ue:d==="end"?ee:ue+te/2,Ee=y==="center"?be+ne/2:y==="end"?ge:be,Re=[],Qe=0;Qe<N.length;Qe++){var et=N[Qe],We=et.getBoundingClientRect(),me=We.height,Oe=We.width,Fe=We.top,Ke=We.right,$e=We.bottom,pt=We.left;if(c==="if-needed"&&ue>=0&&be>=0&&ee<=K&&ge<=Y&&ue>=Fe&&ee<=$e&&be>=pt&&ge<=Ke)return Re;var Ct=getComputedStyle(et),Lt=parseInt(Ct.borderLeftWidth,10),It=parseInt(Ct.borderTopWidth,10),_n=parseInt(Ct.borderRightWidth,10),Ut=parseInt(Ct.borderBottomWidth,10),ln=0,xn=0,En="offsetWidth"in et?et.offsetWidth-et.clientWidth-Lt-_n:0,Nt="offsetHeight"in et?et.offsetHeight-et.clientHeight-It-Ut:0,_e="offsetWidth"in et?et.offsetWidth===0?0:Oe/et.offsetWidth:0,Ft="offsetHeight"in et?et.offsetHeight===0?0:me/et.offsetHeight:0;if(F===et)ln=d==="start"?Ie:d==="end"?Ie-K:d==="nearest"?Ty(X,X+K,K,It,Ut,X+Ie,X+Ie+te,te):Ie-K/2,xn=y==="start"?Ee:y==="center"?Ee-Y/2:y==="end"?Ee-Y:Ty(J,J+Y,Y,Lt,_n,J+Ee,J+Ee+ne,ne),ln=Math.max(0,ln+X),xn=Math.max(0,xn+J);else{ln=d==="start"?Ie-Fe-It:d==="end"?Ie-$e+Ut+Nt:d==="nearest"?Ty(Fe,$e,me,It,Ut+Nt,Ie,Ie+te,te):Ie-(Fe+me/2)+Nt/2,xn=y==="start"?Ee-pt-Lt:y==="center"?Ee-(pt+Oe/2)+En/2:y==="end"?Ee-Ke+_n+En:Ty(pt,Ke,Oe,Lt,_n+En,Ee,Ee+ne,ne);var Ve=et.scrollLeft,Ye=et.scrollTop;Ie+=Ye-(ln=Math.max(0,Math.min(Ye+ln/Ft,et.scrollHeight-me/Ft+Nt))),Ee+=Ve-(xn=Math.max(0,Math.min(Ve+xn/_e,et.scrollWidth-Oe/_e+En)))}Re.push({el:et,top:ln,left:xn})}return Re};function bz(e){return e===Object(e)&&Object.keys(e).length!==0}function aj(e,t){t===void 0&&(t="auto");var o="scrollBehavior"in document.body.style;e.forEach(function(c){var d=c.el,y=c.top,w=c.left;d.scroll&&o?d.scroll({top:y,left:w,behavior:t}):(d.scrollTop=y,d.scrollLeft=w)})}function sj(e){return e===!1?{block:"end",inline:"nearest"}:bz(e)?e:{block:"start",inline:"nearest"}}function lj(e,t){var o=e.isConnected||e.ownerDocument.documentElement.contains(e);if(bz(t)&&typeof t.behavior=="function")return t.behavior(o?WA(e,t):[]);if(o){var c=sj(t);return aj(WA(e,c),c.behavior)}}function cj(e,t){for(var o=0;o<t.length;o++){var c=t[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function wz(e,t,o){return o&&cj(e,o),e}function Xy(){return(Xy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e}).apply(this,arguments)}function Sz(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Cz(e,t){if(e==null)return{};var o,c,d={},y=Object.keys(e);for(c=0;c<y.length;c++)t.indexOf(o=y[c])>=0||(d[o]=e[o]);return d}function qA(e){return((t=e)!=null&&typeof t=="object"&&Array.isArray(t)===!1)==1&&Object.prototype.toString.call(e)==="[object Object]";var t}var Tz=Object.prototype,Ez=Tz.toString,uj=Tz.hasOwnProperty,Mz=/^\s*function (\w+)/;function ZA(e){var t,o=(t=e==null?void 0:e.type)!==null&&t!==void 0?t:e;if(o){var c=o.toString().match(Mz);return c?c[1]:""}return""}var ph=function(e){var t,o;return qA(e)!==!1&&typeof(t=e.constructor)=="function"&&qA(o=t.prototype)!==!1&&o.hasOwnProperty("isPrototypeOf")!==!1},dj=function(e){return e},sa=dj,d_=function(e,t){return uj.call(e,t)},hj=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e},cp=Array.isArray||function(e){return Ez.call(e)==="[object Array]"},up=function(e){return Ez.call(e)==="[object Function]"},zv=function(e){return ph(e)&&d_(e,"_vueTypes_name")},Iz=function(e){return ph(e)&&(d_(e,"type")||["_vueTypes_name","validator","default","required"].some(function(t){return d_(e,t)}))};function $2(e,t){return Object.defineProperty(e.bind(t),"__original",{value:e})}function vh(e,t,o){var c;o===void 0&&(o=!1);var d=!0,y="";c=ph(e)?e:{type:e};var w=zv(c)?c._vueTypes_name+" - ":"";if(Iz(c)&&c.type!==null){if(c.type===void 0||c.type===!0||!c.required&&t===void 0)return d;cp(c.type)?(d=c.type.some(function(F){return vh(F,t,!0)===!0}),y=c.type.map(function(F){return ZA(F)}).join(" or ")):d=(y=ZA(c))==="Array"?cp(t):y==="Object"?ph(t):y==="String"||y==="Number"||y==="Boolean"||y==="Function"?function(F){if(F==null)return"";var N=F.constructor.toString().match(Mz);return N?N[1]:""}(t)===y:t instanceof c.type}if(!d){var i=w+'value "'+t+'" should be of type "'+y+'"';return o===!1?(sa(i),!1):i}if(d_(c,"validator")&&up(c.validator)){var O=sa,L=[];if(sa=function(F){L.push(F)},d=c.validator(t),sa=O,!d){var z=(L.length>1?"* ":"")+L.join(`
* `);return L.length=0,o===!1?(sa(z),d):z}}return d}function ja(e,t){var o=Object.defineProperties(t,{_vueTypes_name:{value:e,writable:!0},isRequired:{get:function(){return this.required=!0,this}},def:{value:function(d){return d!==void 0||this.default?up(d)||vh(this,d,!0)===!0?(this.default=cp(d)?function(){return[].concat(d)}:ph(d)?function(){return Object.assign({},d)}:d,this):(sa(this._vueTypes_name+' - invalid default value: "'+d+'"'),this):this}}}),c=o.validator;return up(c)&&(o.validator=$2(c,o)),o}function Ml(e,t){var o=ja(e,t);return Object.defineProperty(o,"validate",{value:function(c){return up(this.validator)&&sa(this._vueTypes_name+` - calling .validate() will overwrite the current custom validator function. Validator info:
`+JSON.stringify(this)),this.validator=$2(c,this),this}})}function YA(e,t,o){var c,d,y=(c=t,d={},Object.getOwnPropertyNames(c).forEach(function(F){d[F]=Object.getOwnPropertyDescriptor(c,F)}),Object.defineProperties({},d));if(y._vueTypes_name=e,!ph(o))return y;var w,i,O=o.validator,L=Cz(o,["validator"]);if(up(O)){var z=y.validator;z&&(z=(i=(w=z).__original)!==null&&i!==void 0?i:w),y.validator=$2(z?function(F){return z.call(this,F)&&O.call(this,F)}:O,y)}return Object.assign(y,L)}function mx(e){return e.replace(/^(?!\s*$)/gm,"  ")}var fj=function(){return Ml("any",{})},pj=function(){return Ml("function",{type:Function})},mj=function(){return Ml("boolean",{type:Boolean})},gj=function(){return Ml("string",{type:String})},_j=function(){return Ml("number",{type:Number})},yj=function(){return Ml("array",{type:Array})},vj=function(){return Ml("object",{type:Object})},xj=function(){return ja("integer",{type:Number,validator:function(e){return hj(e)}})},bj=function(){return ja("symbol",{validator:function(e){return typeof e=="symbol"}})};function wj(e,t){if(t===void 0&&(t="custom validation failed"),typeof e!="function")throw new TypeError("[VueTypes error]: You must provide a function as argument");return ja(e.name||"<<anonymous function>>",{validator:function(o){var c=e(o);return c||sa(this._vueTypes_name+" - "+t),c}})}function Sj(e){if(!cp(e))throw new TypeError("[VueTypes error]: You must provide an array as argument.");var t='oneOf - value should be one of "'+e.join('", "')+'".',o=e.reduce(function(c,d){if(d!=null){var y=d.constructor;c.indexOf(y)===-1&&c.push(y)}return c},[]);return ja("oneOf",{type:o.length>0?o:void 0,validator:function(c){var d=e.indexOf(c)!==-1;return d||sa(t),d}})}function Cj(e){if(!cp(e))throw new TypeError("[VueTypes error]: You must provide an array as argument");for(var t=!1,o=[],c=0;c<e.length;c+=1){var d=e[c];if(Iz(d)){if(zv(d)&&d._vueTypes_name==="oneOf"){o=o.concat(d.type);continue}if(up(d.validator)&&(t=!0),d.type!==!0&&d.type){o=o.concat(d.type);continue}}o.push(d)}return o=o.filter(function(y,w){return o.indexOf(y)===w}),ja("oneOfType",t?{type:o,validator:function(y){var w=[],i=e.some(function(O){var L=vh(zv(O)&&O._vueTypes_name==="oneOf"?O.type||null:O,y,!0);return typeof L=="string"&&w.push(L),L===!0});return i||sa("oneOfType - provided value does not match any of the "+w.length+` passed-in validators:
`+mx(w.join(`
`))),i}}:{type:o})}function Tj(e){return ja("arrayOf",{type:Array,validator:function(t){var o,c=t.every(function(d){return(o=vh(e,d,!0))===!0});return c||sa(`arrayOf - value validation error:
`+mx(o)),c}})}function Ej(e){return ja("instanceOf",{type:e})}function Mj(e){return ja("objectOf",{type:Object,validator:function(t){var o,c=Object.keys(t).every(function(d){return(o=vh(e,t[d],!0))===!0});return c||sa(`objectOf - value validation error:
`+mx(o)),c}})}function Ij(e){var t=Object.keys(e),o=t.filter(function(d){var y;return!!(!((y=e[d])===null||y===void 0)&&y.required)}),c=ja("shape",{type:Object,validator:function(d){var y=this;if(!ph(d))return!1;var w=Object.keys(d);if(o.length>0&&o.some(function(O){return w.indexOf(O)===-1})){var i=o.filter(function(O){return w.indexOf(O)===-1});return sa(i.length===1?'shape - required property "'+i[0]+'" is not defined.':'shape - required properties "'+i.join('", "')+'" are not defined.'),!1}return w.every(function(O){if(t.indexOf(O)===-1)return y._vueTypes_isLoose===!0||(sa('shape - shape definition does not include a "'+O+'" property. Allowed keys: "'+t.join('", "')+'".'),!1);var L=vh(e[O],d[O],!0);return typeof L=="string"&&sa('shape - "'+O+`" property validation error:
 `+mx(L)),L===!0})}});return Object.defineProperty(c,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(c,"loose",{get:function(){return this._vueTypes_isLoose=!0,this}}),c}var _l=function(){function e(){}return e.extend=function(t){var o=this;if(cp(t))return t.forEach(function(F){return o.extend(F)}),this;var c=t.name,d=t.validate,y=d!==void 0&&d,w=t.getter,i=w!==void 0&&w,O=Cz(t,["name","validate","getter"]);if(d_(this,c))throw new TypeError('[VueTypes error]: Type "'+c+'" already defined');var L,z=O.type;return zv(z)?(delete O.type,Object.defineProperty(this,c,i?{get:function(){return YA(c,z,O)}}:{value:function(){var F,N=YA(c,z,O);return N.validator&&(N.validator=(F=N.validator).bind.apply(F,[N].concat([].slice.call(arguments)))),N}})):(L=i?{get:function(){var F=Object.assign({},O);return y?Ml(c,F):ja(c,F)},enumerable:!0}:{value:function(){var F,N,G=Object.assign({},O);return F=y?Ml(c,G):ja(c,G),G.validator&&(F.validator=(N=G.validator).bind.apply(N,[F].concat([].slice.call(arguments)))),F},enumerable:!0},Object.defineProperty(this,c,L))},wz(e,null,[{key:"any",get:function(){return fj()}},{key:"func",get:function(){return pj().def(this.defaults.func)}},{key:"bool",get:function(){return mj().def(this.defaults.bool)}},{key:"string",get:function(){return gj().def(this.defaults.string)}},{key:"number",get:function(){return _j().def(this.defaults.number)}},{key:"array",get:function(){return yj().def(this.defaults.array)}},{key:"object",get:function(){return vj().def(this.defaults.object)}},{key:"integer",get:function(){return xj().def(this.defaults.integer)}},{key:"symbol",get:function(){return bj()}}]),e}();function Az(e){var t;return e===void 0&&(e={func:function(){},bool:!0,string:"",number:0,array:function(){return[]},object:function(){return{}},integer:0}),(t=function(o){function c(){return o.apply(this,arguments)||this}return Sz(c,o),wz(c,null,[{key:"sensibleDefaults",get:function(){return Xy({},this.defaults)},set:function(d){this.defaults=d!==!1?Xy({},d!==!0?d:e):{}}}]),c}(_l)).defaults=Xy({},e),t}_l.defaults={},_l.custom=wj,_l.oneOf=Sj,_l.instanceOf=Ej,_l.oneOfType=Cj,_l.arrayOf=Tj,_l.objectOf=Mj,_l.shape=Ij,_l.utils={validate:function(e,t){return vh(t,e,!0)===!0},toType:function(e,t,o){return o===void 0&&(o=!1),o?Ml(e,t):ja(e,t)}};(function(e){function t(){return e.apply(this,arguments)||this}return Sz(t,e),t})(Az());const wt=Az({func:void 0,bool:void 0,string:void 0,number:void 0,array:void 0,object:void 0,integer:void 0});wt.extend([{name:"looseBool",getter:!0,type:Boolean,default:void 0},{name:"style",getter:!0,type:[String,Object],default:void 0},{name:"VueNode",getter:!0,type:null}]);function Aj(e){return e.default=void 0,e}const F2=(e,t,o)=>{AV(e,`[ant-design-vue: ${t}] ${o}`)};function XA(e,t){const{key:o}=e;let c;return"value"in e&&({value:c}=e),o??(c!==void 0?c:`rc-index-key-${t}`)}function Pz(e,t){const{label:o,value:c,options:d}=e||{};return{label:o||(t?"children":"label"),value:c||"value",options:d||"options"}}function Pj(e){let{fieldNames:t,childrenAsData:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],{label:d,value:y,options:w}=Pz(t,!1);function i(O,L){O.forEach(z=>{const F=z[d];if(L||!(w in z)){const N=z[y];c.push({key:XA(z,c.length),groupOption:L,data:z,label:F,value:N})}else{let N=F;N===void 0&&o&&(N=z.label),c.push({key:XA(z,c.length),group:!0,data:z,label:N}),i(z[w],!0)}})}return i(e,!1),c}function sS(e){const t=re({},e);return"props"in t||Object.defineProperty(t,"props",{get(){return t}}),t}function Oj(e,t){if(!t||!t.length)return null;let o=!1;function c(y,w){let[i,...O]=w;if(!i)return[y];const L=y.split(i);return o=o||L.length>1,L.reduce((z,F)=>[...z,...c(F,O)],[]).filter(z=>z)}const d=c(e,t);return o?d:null}function Dj(){return""}function Rj(e){return e?e.ownerDocument:window.document}function Oz(){}const zj=()=>({action:wt.oneOfType([wt.string,wt.arrayOf(wt.string)]).def([]),showAction:wt.any.def([]),hideAction:wt.any.def([]),getPopupClassNameFromAlign:wt.any.def(Dj),onPopupVisibleChange:Function,afterPopupVisibleChange:wt.func.def(Oz),popup:wt.any,arrow:wt.bool.def(!0),popupStyle:{type:Object,default:void 0},prefixCls:wt.string.def("rc-trigger-popup"),popupClassName:wt.string.def(""),popupPlacement:String,builtinPlacements:wt.object,popupTransitionName:String,popupAnimation:wt.any,mouseEnterDelay:wt.number.def(0),mouseLeaveDelay:wt.number.def(.1),zIndex:Number,focusDelay:wt.number.def(0),blurDelay:wt.number.def(.15),getPopupContainer:Function,getDocument:wt.func.def(Rj),forceRender:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:!1},mask:{type:Boolean,default:!1},maskClosable:{type:Boolean,default:!0},popupAlign:wt.object.def(()=>({})),popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},maskTransitionName:String,maskAnimation:String,stretch:String,alignPoint:{type:Boolean,default:void 0},autoDestroy:{type:Boolean,default:!1},mobile:Object,getTriggerDOMNode:Function}),B2={visible:Boolean,prefixCls:String,zIndex:Number,destroyPopupOnHide:Boolean,forceRender:Boolean,arrow:{type:Boolean,default:!0},animation:[String,Object],transitionName:String,stretch:{type:String},align:{type:Object},point:{type:Object},getRootDomNode:{type:Function},getClassNameFromAlign:{type:Function},onAlign:{type:Function},onMouseenter:{type:Function},onMouseleave:{type:Function},onMousedown:{type:Function},onTouchstart:{type:Function}},Lj=re(re({},B2),{mobile:{type:Object}}),$j=re(re({},B2),{mask:Boolean,mobile:{type:Object},maskAnimation:String,maskTransitionName:String});function k2(e){let{prefixCls:t,animation:o,transitionName:c}=e;return o?{name:`${t}-${o}`}:c?{name:c}:{}}function Dz(e){const{prefixCls:t,visible:o,zIndex:c,mask:d,maskAnimation:y,maskTransitionName:w}=e;if(!d)return null;let i={};return(w||y)&&(i=k2({prefixCls:t,transitionName:w,animation:y})),le(Al,it({appear:!0},i),{default:()=>[Ns(le("div",{style:{zIndex:c},class:`${t}-mask`},null),[[tN("if"),o]])]})}Dz.displayName="Mask";const Fj=cn({compatConfig:{MODE:3},name:"MobilePopupInner",inheritAttrs:!1,props:Lj,emits:["mouseenter","mouseleave","mousedown","touchstart","align"],setup(e,t){let{expose:o,slots:c}=t;const d=tn();return o({forceAlign:()=>{},getElement:()=>d.value}),()=>{var y;const{zIndex:w,visible:i,prefixCls:O,mobile:{popupClassName:L,popupStyle:z,popupMotion:F={},popupRender:N}={}}=e,G=re({zIndex:w},z);let Y=vo((y=c.default)===null||y===void 0?void 0:y.call(c));Y.length>1&&(Y=le("div",{class:`${O}-content`},[Y])),N&&(Y=N(Y));const K=hn(O,L);return le(Al,it({ref:d},F),{default:()=>[i?le("div",{class:K,style:G},[Y]):null]})}}});var Bj=function(e,t,o,c){function d(y){return y instanceof o?y:new o(function(w){w(y)})}return new(o||(o=Promise))(function(y,w){function i(z){try{L(c.next(z))}catch(F){w(F)}}function O(z){try{L(c.throw(z))}catch(F){w(F)}}function L(z){z.done?y(z.value):d(z.value).then(i,O)}L((c=c.apply(e,t||[])).next())})};const KA=["measure","align",null,"motion"],kj=(e,t)=>{const o=Xt(null),c=Xt(),d=Xt(!1);function y(O){d.value||(o.value=O)}function w(){qr.cancel(c.value)}function i(O){w(),c.value=qr(()=>{let L=o.value;switch(o.value){case"align":L="motion";break;case"motion":L="stable";break}y(L),O==null||O()})}return On(e,()=>{y("measure")},{immediate:!0,flush:"post"}),Qr(()=>{On(o,()=>{switch(o.value){case"measure":t();break}o.value&&(c.value=qr(()=>Bj(void 0,void 0,void 0,function*(){const O=KA.indexOf(o.value),L=KA[O+1];L&&O!==-1&&y(L)})))},{immediate:!0,flush:"post"})}),fi(()=>{d.value=!0,w()}),[o,i]},Nj=e=>{const t=Xt({width:0,height:0});function o(d){t.value={width:d.offsetWidth,height:d.offsetHeight}}return[He(()=>{const d={};if(e.value){const{width:y,height:w}=t.value;e.value.indexOf("height")!==-1&&w?d.height=`${w}px`:e.value.indexOf("minHeight")!==-1&&w&&(d.minHeight=`${w}px`),e.value.indexOf("width")!==-1&&y?d.width=`${y}px`:e.value.indexOf("minWidth")!==-1&&y&&(d.minWidth=`${y}px`)}return d}),o]};function JA(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function QA(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?JA(Object(o),!0).forEach(function(c){Vj(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):JA(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function lS(e){"@babel/helpers - typeof";return lS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lS(e)}function Vj(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Cg,jj={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function Lv(){if(Cg!==void 0)return Cg;Cg="";var e=document.createElement("p").style,t="Transform";for(var o in jj)o+t in e&&(Cg=o);return Cg}function Rz(){return Lv()?"".concat(Lv(),"TransitionProperty"):"transitionProperty"}function gx(){return Lv()?"".concat(Lv(),"Transform"):"transform"}function eP(e,t){var o=Rz();o&&(e.style[o]=t,o!=="transitionProperty"&&(e.style.transitionProperty=t))}function aw(e,t){var o=gx();o&&(e.style[o]=t,o!=="transform"&&(e.style.transform=t))}function Uj(e){return e.style.transitionProperty||e.style[Rz()]}function Hj(e){var t=window.getComputedStyle(e,null),o=t.getPropertyValue("transform")||t.getPropertyValue(gx());if(o&&o!=="none"){var c=o.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(c[12]||c[4],0),y:parseFloat(c[13]||c[5],0)}}return{x:0,y:0}}var Gj=/matrix\((.*)\)/,Wj=/matrix3d\((.*)\)/;function qj(e,t){var o=window.getComputedStyle(e,null),c=o.getPropertyValue("transform")||o.getPropertyValue(gx());if(c&&c!=="none"){var d,y=c.match(Gj);if(y)y=y[1],d=y.split(",").map(function(i){return parseFloat(i,10)}),d[4]=t.x,d[5]=t.y,aw(e,"matrix(".concat(d.join(","),")"));else{var w=c.match(Wj)[1];d=w.split(",").map(function(i){return parseFloat(i,10)}),d[12]=t.x,d[13]=t.y,aw(e,"matrix3d(".concat(d.join(","),")"))}}else aw(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}var Zj=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,C_;function tP(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function Jf(e,t,o){var c=o;if(lS(t)==="object"){for(var d in t)t.hasOwnProperty(d)&&Jf(e,d,t[d]);return}if(typeof c<"u"){typeof c=="number"&&(c="".concat(c,"px")),e.style[t]=c;return}return C_(e,t)}function Yj(e){var t,o,c,d=e.ownerDocument,y=d.body,w=d&&d.documentElement;return t=e.getBoundingClientRect(),o=Math.floor(t.left),c=Math.floor(t.top),o-=w.clientLeft||y.clientLeft||0,c-=w.clientTop||y.clientTop||0,{left:o,top:c}}function zz(e,t){var o=e["page".concat(t?"Y":"X","Offset")],c="scroll".concat(t?"Top":"Left");if(typeof o!="number"){var d=e.document;o=d.documentElement[c],typeof o!="number"&&(o=d.body[c])}return o}function Lz(e){return zz(e)}function $z(e){return zz(e,!0)}function h_(e){var t=Yj(e),o=e.ownerDocument,c=o.defaultView||o.parentWindow;return t.left+=Lz(c),t.top+=$z(c),t}function N2(e){return e!=null&&e==e.window}function Fz(e){return N2(e)?e.document:e.nodeType===9?e:e.ownerDocument}function Xj(e,t,o){var c=o,d="",y=Fz(e);return c=c||y.defaultView.getComputedStyle(e,null),c&&(d=c.getPropertyValue(t)||c[t]),d}var Kj=new RegExp("^(".concat(Zj,")(?!px)[a-z%]+$"),"i"),Jj=/^(top|right|bottom|left)$/,sw="currentStyle",lw="runtimeStyle",Hd="left",Qj="px";function eU(e,t){var o=e[sw]&&e[sw][t];if(Kj.test(o)&&!Jj.test(t)){var c=e.style,d=c[Hd],y=e[lw][Hd];e[lw][Hd]=e[sw][Hd],c[Hd]=t==="fontSize"?"1em":o||0,o=c.pixelLeft+Qj,c[Hd]=d,e[lw][Hd]=y}return o===""?"auto":o}typeof window<"u"&&(C_=window.getComputedStyle?Xj:eU);function Ey(e,t){return e==="left"?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function nP(e){if(e==="left")return"right";if(e==="right")return"left";if(e==="top")return"bottom";if(e==="bottom")return"top"}function rP(e,t,o){Jf(e,"position")==="static"&&(e.style.position="relative");var c=-999,d=-999,y=Ey("left",o),w=Ey("top",o),i=nP(y),O=nP(w);y!=="left"&&(c=999),w!=="top"&&(d=999);var L="",z=h_(e);("left"in t||"top"in t)&&(L=Uj(e)||"",eP(e,"none")),"left"in t&&(e.style[i]="",e.style[y]="".concat(c,"px")),"top"in t&&(e.style[O]="",e.style[w]="".concat(d,"px")),tP(e);var F=h_(e),N={};for(var G in t)if(t.hasOwnProperty(G)){var Y=Ey(G,o),K=G==="left"?c:d,J=z[G]-F[G];Y===G?N[Y]=K+J:N[Y]=K-J}Jf(e,N),tP(e),("left"in t||"top"in t)&&eP(e,L);var X={};for(var se in t)if(t.hasOwnProperty(se)){var te=Ey(se,o),ne=t[se]-z[se];se===te?X[te]=N[te]+ne:X[te]=N[te]-ne}Jf(e,X)}function tU(e,t){var o=h_(e),c=Hj(e),d={x:c.x,y:c.y};"left"in t&&(d.x=c.x+t.left-o.left),"top"in t&&(d.y=c.y+t.top-o.top),qj(e,d)}function nU(e,t,o){if(o.ignoreShake){var c=h_(e),d=c.left.toFixed(0),y=c.top.toFixed(0),w=t.left.toFixed(0),i=t.top.toFixed(0);if(d===w&&y===i)return}o.useCssRight||o.useCssBottom?rP(e,t,o):o.useCssTransform&&gx()in document.body.style?tU(e,t):rP(e,t,o)}function V2(e,t){for(var o=0;o<e.length;o++)t(e[o])}function Bz(e){return C_(e,"boxSizing")==="border-box"}var rU=["margin","border","padding"],cS=-1,iU=2,uS=1,oU=0;function aU(e,t,o){var c={},d=e.style,y;for(y in t)t.hasOwnProperty(y)&&(c[y]=d[y],d[y]=t[y]);o.call(e);for(y in t)t.hasOwnProperty(y)&&(d[y]=c[y])}function Ag(e,t,o){var c=0,d,y,w;for(y=0;y<t.length;y++)if(d=t[y],d)for(w=0;w<o.length;w++){var i=void 0;d==="border"?i="".concat(d).concat(o[w],"Width"):i=d+o[w],c+=parseFloat(C_(e,i))||0}return c}var wl={getParent:function(t){var o=t;do o.nodeType===11&&o.host?o=o.host:o=o.parentNode;while(o&&o.nodeType!==1&&o.nodeType!==9);return o}};V2(["Width","Height"],function(e){wl["doc".concat(e)]=function(t){var o=t.document;return Math.max(o.documentElement["scroll".concat(e)],o.body["scroll".concat(e)],wl["viewport".concat(e)](o))},wl["viewport".concat(e)]=function(t){var o="client".concat(e),c=t.document,d=c.body,y=c.documentElement,w=y[o];return c.compatMode==="CSS1Compat"&&w||d&&d[o]||w}});function iP(e,t,o){var c=o;if(N2(e))return t==="width"?wl.viewportWidth(e):wl.viewportHeight(e);if(e.nodeType===9)return t==="width"?wl.docWidth(e):wl.docHeight(e);var d=t==="width"?["Left","Right"]:["Top","Bottom"],y=Math.floor(t==="width"?e.getBoundingClientRect().width:e.getBoundingClientRect().height),w=Bz(e),i=0;(y==null||y<=0)&&(y=void 0,i=C_(e,t),(i==null||Number(i)<0)&&(i=e.style[t]||0),i=Math.floor(parseFloat(i))||0),c===void 0&&(c=w?uS:cS);var O=y!==void 0||w,L=y||i;return c===cS?O?L-Ag(e,["border","padding"],d):i:O?c===uS?L:L+(c===iU?-Ag(e,["border"],d):Ag(e,["margin"],d)):i+Ag(e,rU.slice(c),d)}var sU={position:"absolute",visibility:"hidden",display:"block"};function oP(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var c,d=t[0];return d.offsetWidth!==0?c=iP.apply(void 0,t):aU(d,sU,function(){c=iP.apply(void 0,t)}),c}V2(["width","height"],function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);wl["outer".concat(t)]=function(c,d){return c&&oP(c,e,d?oU:uS)};var o=e==="width"?["Left","Right"]:["Top","Bottom"];wl[e]=function(c,d){var y=d;if(y!==void 0){if(c){var w=Bz(c);return w&&(y+=Ag(c,["padding","border"],o)),Jf(c,e,y)}return}return c&&oP(c,e,cS)}});function kz(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}var br={getWindow:function(t){if(t&&t.document&&t.setTimeout)return t;var o=t.ownerDocument||t;return o.defaultView||o.parentWindow},getDocument:Fz,offset:function(t,o,c){if(typeof o<"u")nU(t,o,c||{});else return h_(t)},isWindow:N2,each:V2,css:Jf,clone:function(t){var o,c={};for(o in t)t.hasOwnProperty(o)&&(c[o]=t[o]);var d=t.overflow;if(d)for(o in t)t.hasOwnProperty(o)&&(c.overflow[o]=t.overflow[o]);return c},mix:kz,getWindowScrollLeft:function(t){return Lz(t)},getWindowScrollTop:function(t){return $z(t)},merge:function(){for(var t={},o=0;o<arguments.length;o++)br.mix(t,o<0||arguments.length<=o?void 0:arguments[o]);return t},viewportWidth:0,viewportHeight:0};kz(br,wl);var cw=br.getParent;function dS(e){if(br.isWindow(e)||e.nodeType===9)return null;var t=br.getDocument(e),o=t.body,c,d=br.css(e,"position"),y=d==="fixed"||d==="absolute";if(!y)return e.nodeName.toLowerCase()==="html"?null:cw(e);for(c=cw(e);c&&c!==o&&c.nodeType!==9;c=cw(c))if(d=br.css(c,"position"),d!=="static")return c;return null}var aP=br.getParent;function lU(e){if(br.isWindow(e)||e.nodeType===9)return!1;var t=br.getDocument(e),o=t.body,c=null;for(c=aP(e);c&&c!==o&&c!==t;c=aP(c)){var d=br.css(c,"position");if(d==="fixed")return!0}return!1}function j2(e,t){for(var o={left:0,right:1/0,top:0,bottom:1/0},c=dS(e),d=br.getDocument(e),y=d.defaultView||d.parentWindow,w=d.body,i=d.documentElement;c;){if((navigator.userAgent.indexOf("MSIE")===-1||c.clientWidth!==0)&&c!==w&&c!==i&&br.css(c,"overflow")!=="visible"){var O=br.offset(c);O.left+=c.clientLeft,O.top+=c.clientTop,o.top=Math.max(o.top,O.top),o.right=Math.min(o.right,O.left+c.clientWidth),o.bottom=Math.min(o.bottom,O.top+c.clientHeight),o.left=Math.max(o.left,O.left)}else if(c===w||c===i)break;c=dS(c)}var L=null;if(!br.isWindow(e)&&e.nodeType!==9){L=e.style.position;var z=br.css(e,"position");z==="absolute"&&(e.style.position="fixed")}var F=br.getWindowScrollLeft(y),N=br.getWindowScrollTop(y),G=br.viewportWidth(y),Y=br.viewportHeight(y),K=i.scrollWidth,J=i.scrollHeight,X=window.getComputedStyle(w);if(X.overflowX==="hidden"&&(K=y.innerWidth),X.overflowY==="hidden"&&(J=y.innerHeight),e.style&&(e.style.position=L),t||lU(e))o.left=Math.max(o.left,F),o.top=Math.max(o.top,N),o.right=Math.min(o.right,F+G),o.bottom=Math.min(o.bottom,N+Y);else{var se=Math.max(K,F+G);o.right=Math.min(o.right,se);var te=Math.max(J,N+Y);o.bottom=Math.min(o.bottom,te)}return o.top>=0&&o.left>=0&&o.bottom>o.top&&o.right>o.left?o:null}function cU(e,t,o,c){var d=br.clone(e),y={width:t.width,height:t.height};return c.adjustX&&d.left<o.left&&(d.left=o.left),c.resizeWidth&&d.left>=o.left&&d.left+y.width>o.right&&(y.width-=d.left+y.width-o.right),c.adjustX&&d.left+y.width>o.right&&(d.left=Math.max(o.right-y.width,o.left)),c.adjustY&&d.top<o.top&&(d.top=o.top),c.resizeHeight&&d.top>=o.top&&d.top+y.height>o.bottom&&(y.height-=d.top+y.height-o.bottom),c.adjustY&&d.top+y.height>o.bottom&&(d.top=Math.max(o.bottom-y.height,o.top)),br.mix(d,y)}function U2(e){var t,o,c;if(!br.isWindow(e)&&e.nodeType!==9)t=br.offset(e),o=br.outerWidth(e),c=br.outerHeight(e);else{var d=br.getWindow(e);t={left:br.getWindowScrollLeft(d),top:br.getWindowScrollTop(d)},o=br.viewportWidth(d),c=br.viewportHeight(d)}return t.width=o,t.height=c,t}function sP(e,t){var o=t.charAt(0),c=t.charAt(1),d=e.width,y=e.height,w=e.left,i=e.top;return o==="c"?i+=y/2:o==="b"&&(i+=y),c==="c"?w+=d/2:c==="r"&&(w+=d),{left:w,top:i}}function My(e,t,o,c,d){var y=sP(t,o[1]),w=sP(e,o[0]),i=[w.left-y.left,w.top-y.top];return{left:Math.round(e.left-i[0]+c[0]-d[0]),top:Math.round(e.top-i[1]+c[1]-d[1])}}function lP(e,t,o){return e.left<o.left||e.left+t.width>o.right}function cP(e,t,o){return e.top<o.top||e.top+t.height>o.bottom}function uU(e,t,o){return e.left>o.right||e.left+t.width<o.left}function dU(e,t,o){return e.top>o.bottom||e.top+t.height<o.top}function Iy(e,t,o){var c=[];return br.each(e,function(d){c.push(d.replace(t,function(y){return o[y]}))}),c}function Ay(e,t){return e[t]=-e[t],e}function uP(e,t){var o;return/%$/.test(e)?o=parseInt(e.substring(0,e.length-1),10)/100*t:o=parseInt(e,10),o||0}function dP(e,t){e[0]=uP(e[0],t.width),e[1]=uP(e[1],t.height)}function Nz(e,t,o,c){var d=o.points,y=o.offset||[0,0],w=o.targetOffset||[0,0],i=o.overflow,O=o.source||e;y=[].concat(y),w=[].concat(w),i=i||{};var L={},z=0,F=!!(i&&i.alwaysByViewport),N=j2(O,F),G=U2(O);dP(y,G),dP(w,t);var Y=My(G,t,d,y,w),K=br.merge(G,Y);if(N&&(i.adjustX||i.adjustY)&&c){if(i.adjustX&&lP(Y,G,N)){var J=Iy(d,/[lr]/gi,{l:"r",r:"l"}),X=Ay(y,0),se=Ay(w,0),te=My(G,t,J,X,se);uU(te,G,N)||(z=1,d=J,y=X,w=se)}if(i.adjustY&&cP(Y,G,N)){var ne=Iy(d,/[tb]/gi,{t:"b",b:"t"}),ue=Ay(y,1),ge=Ay(w,1),ee=My(G,t,ne,ue,ge);dU(ee,G,N)||(z=1,d=ne,y=ue,w=ge)}z&&(Y=My(G,t,d,y,w),br.mix(K,Y));var be=lP(Y,G,N),Ie=cP(Y,G,N);if(be||Ie){var Ee=d;be&&(Ee=Iy(d,/[lr]/gi,{l:"r",r:"l"})),Ie&&(Ee=Iy(d,/[tb]/gi,{t:"b",b:"t"})),d=Ee,y=o.offset||[0,0],w=o.targetOffset||[0,0]}L.adjustX=i.adjustX&&be,L.adjustY=i.adjustY&&Ie,(L.adjustX||L.adjustY)&&(K=cU(Y,G,N,L))}return K.width!==G.width&&br.css(O,"width",br.width(O)+K.width-G.width),K.height!==G.height&&br.css(O,"height",br.height(O)+K.height-G.height),br.offset(O,{left:K.left,top:K.top},{useCssRight:o.useCssRight,useCssBottom:o.useCssBottom,useCssTransform:o.useCssTransform,ignoreShake:o.ignoreShake}),{points:d,offset:y,targetOffset:w,overflow:L}}function hU(e,t){var o=j2(e,t),c=U2(e);return!o||c.left+c.width<=o.left||c.top+c.height<=o.top||c.left>=o.right||c.top>=o.bottom}function H2(e,t,o){var c=o.target||t,d=U2(c),y=!hU(c,o.overflow&&o.overflow.alwaysByViewport);return Nz(e,d,o,y)}H2.__getOffsetParent=dS;H2.__getVisibleRectForElement=j2;function fU(e,t,o){var c,d,y=br.getDocument(e),w=y.defaultView||y.parentWindow,i=br.getWindowScrollLeft(w),O=br.getWindowScrollTop(w),L=br.viewportWidth(w),z=br.viewportHeight(w);"pageX"in t?c=t.pageX:c=i+t.clientX,"pageY"in t?d=t.pageY:d=O+t.clientY;var F={left:c,top:d,width:0,height:0},N=c>=0&&c<=i+L&&d>=0&&d<=O+z,G=[o.points[0],"cc"];return Nz(e,F,QA(QA({},o),{},{points:G}),N)}function xo(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=e;if(Array.isArray(e)&&(d=ms(e)[0]),!d)return null;const y=Va(d,t,c);return y.props=o?re(re({},y.props),t):y.props,Ou(typeof y.props.class!="object"),y}function pU(e,t,o){Cu(Va(e,re({},t)),o)}const G2=e=>{if(!e)return!1;if(e.offsetParent)return!0;if(e.getBBox){const t=e.getBBox();if(t.width||t.height)return!0}if(e.getBoundingClientRect){const t=e.getBoundingClientRect();if(t.width||t.height)return!0}return!1};function mU(e,t){return e===t?!0:!e||!t?!1:"pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t?e.clientX===t.clientX&&e.clientY===t.clientY:!1}function gU(e,t){e!==document.activeElement&&_u(t,e)&&typeof e.focus=="function"&&e.focus()}function hP(e,t){let o=null,c=null;function d(w){let[{target:i}]=w;if(!document.documentElement.contains(i))return;const{width:O,height:L}=i.getBoundingClientRect(),z=Math.floor(O),F=Math.floor(L);(o!==z||c!==F)&&Promise.resolve().then(()=>{t({width:z,height:F})}),o=z,c=F}const y=new PR(d);return e&&y.observe(e),()=>{y.disconnect()}}const _U=(e,t)=>{let o=!1,c=null;function d(){clearTimeout(c)}function y(w){if(!o||w===!0){if(e()===!1)return;o=!0,d(),c=setTimeout(()=>{o=!1},t.value)}else d(),c=setTimeout(()=>{o=!1,y()},t.value)}return[y,()=>{o=!1,d()}]};function yU(){this.__data__=[],this.size=0}function W2(e,t){return e===t||e!==e&&t!==t}function _x(e,t){for(var o=e.length;o--;)if(W2(e[o][0],t))return o;return-1}var vU=Array.prototype,xU=vU.splice;function bU(e){var t=this.__data__,o=_x(t,e);if(o<0)return!1;var c=t.length-1;return o==c?t.pop():xU.call(t,o,1),--this.size,!0}function wU(e){var t=this.__data__,o=_x(t,e);return o<0?void 0:t[o][1]}function SU(e){return _x(this.__data__,e)>-1}function CU(e,t){var o=this.__data__,c=_x(o,e);return c<0?(++this.size,o.push([e,t])):o[c][1]=t,this}function Ec(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var c=e[t];this.set(c[0],c[1])}}Ec.prototype.clear=yU;Ec.prototype.delete=bU;Ec.prototype.get=wU;Ec.prototype.has=SU;Ec.prototype.set=CU;function TU(){this.__data__=new Ec,this.size=0}function EU(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function MU(e){return this.__data__.get(e)}function IU(e){return this.__data__.has(e)}var Vz=typeof global=="object"&&global&&global.Object===Object&&global,AU=typeof self=="object"&&self&&self.Object===Object&&self,Xs=Vz||AU||Function("return this")(),ys=Xs.Symbol,jz=Object.prototype,PU=jz.hasOwnProperty,OU=jz.toString,Tg=ys?ys.toStringTag:void 0;function DU(e){var t=PU.call(e,Tg),o=e[Tg];try{e[Tg]=void 0;var c=!0}catch{}var d=OU.call(e);return c&&(t?e[Tg]=o:delete e[Tg]),d}var RU=Object.prototype,zU=RU.toString;function LU(e){return zU.call(e)}var $U="[object Null]",FU="[object Undefined]",fP=ys?ys.toStringTag:void 0;function xh(e){return e==null?e===void 0?FU:$U:fP&&fP in Object(e)?DU(e):LU(e)}function vc(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var BU="[object AsyncFunction]",kU="[object Function]",NU="[object GeneratorFunction]",VU="[object Proxy]";function Uz(e){if(!vc(e))return!1;var t=xh(e);return t==kU||t==NU||t==BU||t==VU}var uw=Xs["__core-js_shared__"],pP=function(){var e=/[^.]+$/.exec(uw&&uw.keys&&uw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function jU(e){return!!pP&&pP in e}var UU=Function.prototype,HU=UU.toString;function bh(e){if(e!=null){try{return HU.call(e)}catch{}try{return e+""}catch{}}return""}var GU=/[\\^$.*+?()[\]{}|]/g,WU=/^\[object .+?Constructor\]$/,qU=Function.prototype,ZU=Object.prototype,YU=qU.toString,XU=ZU.hasOwnProperty,KU=RegExp("^"+YU.call(XU).replace(GU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function JU(e){if(!vc(e)||jU(e))return!1;var t=Uz(e)?KU:WU;return t.test(bh(e))}function QU(e,t){return e==null?void 0:e[t]}function wh(e,t){var o=QU(e,t);return JU(o)?o:void 0}var f_=wh(Xs,"Map"),p_=wh(Object,"create");function eH(){this.__data__=p_?p_(null):{},this.size=0}function tH(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var nH="__lodash_hash_undefined__",rH=Object.prototype,iH=rH.hasOwnProperty;function oH(e){var t=this.__data__;if(p_){var o=t[e];return o===nH?void 0:o}return iH.call(t,e)?t[e]:void 0}var aH=Object.prototype,sH=aH.hasOwnProperty;function lH(e){var t=this.__data__;return p_?t[e]!==void 0:sH.call(t,e)}var cH="__lodash_hash_undefined__";function uH(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=p_&&t===void 0?cH:t,this}function mh(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var c=e[t];this.set(c[0],c[1])}}mh.prototype.clear=eH;mh.prototype.delete=tH;mh.prototype.get=oH;mh.prototype.has=lH;mh.prototype.set=uH;function dH(){this.size=0,this.__data__={hash:new mh,map:new(f_||Ec),string:new mh}}function hH(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function yx(e,t){var o=e.__data__;return hH(t)?o[typeof t=="string"?"string":"hash"]:o.map}function fH(e){var t=yx(this,e).delete(e);return this.size-=t?1:0,t}function pH(e){return yx(this,e).get(e)}function mH(e){return yx(this,e).has(e)}function gH(e,t){var o=yx(this,e),c=o.size;return o.set(e,t),this.size+=o.size==c?0:1,this}function Mc(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var c=e[t];this.set(c[0],c[1])}}Mc.prototype.clear=dH;Mc.prototype.delete=fH;Mc.prototype.get=pH;Mc.prototype.has=mH;Mc.prototype.set=gH;var _H=200;function yH(e,t){var o=this.__data__;if(o instanceof Ec){var c=o.__data__;if(!f_||c.length<_H-1)return c.push([e,t]),this.size=++o.size,this;o=this.__data__=new Mc(c)}return o.set(e,t),this.size=o.size,this}function Tl(e){var t=this.__data__=new Ec(e);this.size=t.size}Tl.prototype.clear=TU;Tl.prototype.delete=EU;Tl.prototype.get=MU;Tl.prototype.has=IU;Tl.prototype.set=yH;var vH="__lodash_hash_undefined__";function xH(e){return this.__data__.set(e,vH),this}function bH(e){return this.__data__.has(e)}function m_(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new Mc;++t<o;)this.add(e[t])}m_.prototype.add=m_.prototype.push=xH;m_.prototype.has=bH;function wH(e,t){for(var o=-1,c=e==null?0:e.length;++o<c;)if(t(e[o],o,e))return!0;return!1}function hS(e,t){return e.has(t)}var SH=1,CH=2;function Hz(e,t,o,c,d,y){var w=o&SH,i=e.length,O=t.length;if(i!=O&&!(w&&O>i))return!1;var L=y.get(e),z=y.get(t);if(L&&z)return L==t&&z==e;var F=-1,N=!0,G=o&CH?new m_:void 0;for(y.set(e,t),y.set(t,e);++F<i;){var Y=e[F],K=t[F];if(c)var J=w?c(K,Y,F,t,e,y):c(Y,K,F,e,t,y);if(J!==void 0){if(J)continue;N=!1;break}if(G){if(!wH(t,function(X,se){if(!hS(G,se)&&(Y===X||d(Y,X,o,c,y)))return G.push(se)})){N=!1;break}}else if(!(Y===K||d(Y,K,o,c,y))){N=!1;break}}return y.delete(e),y.delete(t),N}var $v=Xs.Uint8Array;function TH(e){var t=-1,o=Array(e.size);return e.forEach(function(c,d){o[++t]=[d,c]}),o}function EH(e){var t=-1,o=Array(e.size);return e.forEach(function(c){o[++t]=c}),o}var MH=1,IH=2,AH="[object Boolean]",PH="[object Date]",OH="[object Error]",DH="[object Map]",RH="[object Number]",zH="[object RegExp]",LH="[object Set]",$H="[object String]",FH="[object Symbol]",BH="[object ArrayBuffer]",kH="[object DataView]",mP=ys?ys.prototype:void 0,dw=mP?mP.valueOf:void 0;function NH(e,t,o,c,d,y,w){switch(o){case kH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case BH:return!(e.byteLength!=t.byteLength||!y(new $v(e),new $v(t)));case AH:case PH:case RH:return W2(+e,+t);case OH:return e.name==t.name&&e.message==t.message;case zH:case $H:return e==t+"";case DH:var i=TH;case LH:var O=c&MH;if(i||(i=EH),e.size!=t.size&&!O)return!1;var L=w.get(e);if(L)return L==t;c|=IH,w.set(e,t);var z=Hz(i(e),i(t),c,d,y,w);return w.delete(e),z;case FH:if(dw)return dw.call(e)==dw.call(t)}return!1}function q2(e,t){for(var o=-1,c=t.length,d=e.length;++o<c;)e[d+o]=t[o];return e}var vs=Array.isArray;function Gz(e,t,o){var c=t(e);return vs(e)?c:q2(c,o(e))}function VH(e,t){for(var o=-1,c=e==null?0:e.length,d=0,y=[];++o<c;){var w=e[o];t(w,o,e)&&(y[d++]=w)}return y}function Wz(){return[]}var jH=Object.prototype,UH=jH.propertyIsEnumerable,gP=Object.getOwnPropertySymbols,Z2=gP?function(e){return e==null?[]:(e=Object(e),VH(gP(e),function(t){return UH.call(e,t)}))}:Wz;function HH(e,t){for(var o=-1,c=Array(e);++o<e;)c[o]=t(o);return c}function Il(e){return e!=null&&typeof e=="object"}var GH="[object Arguments]";function _P(e){return Il(e)&&xh(e)==GH}var qz=Object.prototype,WH=qz.hasOwnProperty,qH=qz.propertyIsEnumerable,vx=_P(function(){return arguments}())?_P:function(e){return Il(e)&&WH.call(e,"callee")&&!qH.call(e,"callee")};function ZH(){return!1}var Zz=typeof ka=="object"&&ka&&!ka.nodeType&&ka,yP=Zz&&typeof Na=="object"&&Na&&!Na.nodeType&&Na,YH=yP&&yP.exports===Zz,vP=YH?Xs.Buffer:void 0,XH=vP?vP.isBuffer:void 0,g_=XH||ZH,KH=9007199254740991,JH=/^(?:0|[1-9]\d*)$/;function Yz(e,t){var o=typeof e;return t=t??KH,!!t&&(o=="number"||o!="symbol"&&JH.test(e))&&e>-1&&e%1==0&&e<t}var QH=9007199254740991;function Y2(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=QH}var e7="[object Arguments]",t7="[object Array]",n7="[object Boolean]",r7="[object Date]",i7="[object Error]",o7="[object Function]",a7="[object Map]",s7="[object Number]",l7="[object Object]",c7="[object RegExp]",u7="[object Set]",d7="[object String]",h7="[object WeakMap]",f7="[object ArrayBuffer]",p7="[object DataView]",m7="[object Float32Array]",g7="[object Float64Array]",_7="[object Int8Array]",y7="[object Int16Array]",v7="[object Int32Array]",x7="[object Uint8Array]",b7="[object Uint8ClampedArray]",w7="[object Uint16Array]",S7="[object Uint32Array]",zi={};zi[m7]=zi[g7]=zi[_7]=zi[y7]=zi[v7]=zi[x7]=zi[b7]=zi[w7]=zi[S7]=!0;zi[e7]=zi[t7]=zi[f7]=zi[n7]=zi[p7]=zi[r7]=zi[i7]=zi[o7]=zi[a7]=zi[s7]=zi[l7]=zi[c7]=zi[u7]=zi[d7]=zi[h7]=!1;function C7(e){return Il(e)&&Y2(e.length)&&!!zi[xh(e)]}function X2(e){return function(t){return e(t)}}var Xz=typeof ka=="object"&&ka&&!ka.nodeType&&ka,Hg=Xz&&typeof Na=="object"&&Na&&!Na.nodeType&&Na,T7=Hg&&Hg.exports===Xz,hw=T7&&Vz.process,dp=function(){try{var e=Hg&&Hg.require&&Hg.require("util").types;return e||hw&&hw.binding&&hw.binding("util")}catch{}}(),xP=dp&&dp.isTypedArray,K2=xP?X2(xP):C7,E7=Object.prototype,M7=E7.hasOwnProperty;function Kz(e,t){var o=vs(e),c=!o&&vx(e),d=!o&&!c&&g_(e),y=!o&&!c&&!d&&K2(e),w=o||c||d||y,i=w?HH(e.length,String):[],O=i.length;for(var L in e)(t||M7.call(e,L))&&!(w&&(L=="length"||d&&(L=="offset"||L=="parent")||y&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Yz(L,O)))&&i.push(L);return i}var I7=Object.prototype;function xx(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||I7;return e===o}function Jz(e,t){return function(o){return e(t(o))}}var A7=Jz(Object.keys,Object),P7=Object.prototype,O7=P7.hasOwnProperty;function Qz(e){if(!xx(e))return A7(e);var t=[];for(var o in Object(e))O7.call(e,o)&&o!="constructor"&&t.push(o);return t}function T_(e){return e!=null&&Y2(e.length)&&!Uz(e)}function E_(e){return T_(e)?Kz(e):Qz(e)}function fS(e){return Gz(e,E_,Z2)}var D7=1,R7=Object.prototype,z7=R7.hasOwnProperty;function L7(e,t,o,c,d,y){var w=o&D7,i=fS(e),O=i.length,L=fS(t),z=L.length;if(O!=z&&!w)return!1;for(var F=O;F--;){var N=i[F];if(!(w?N in t:z7.call(t,N)))return!1}var G=y.get(e),Y=y.get(t);if(G&&Y)return G==t&&Y==e;var K=!0;y.set(e,t),y.set(t,e);for(var J=w;++F<O;){N=i[F];var X=e[N],se=t[N];if(c)var te=w?c(se,X,N,t,e,y):c(X,se,N,e,t,y);if(!(te===void 0?X===se||d(X,se,o,c,y):te)){K=!1;break}J||(J=N=="constructor")}if(K&&!J){var ne=e.constructor,ue=t.constructor;ne!=ue&&"constructor"in e&&"constructor"in t&&!(typeof ne=="function"&&ne instanceof ne&&typeof ue=="function"&&ue instanceof ue)&&(K=!1)}return y.delete(e),y.delete(t),K}var pS=wh(Xs,"DataView"),mS=wh(Xs,"Promise"),gS=wh(Xs,"Set"),_S=wh(Xs,"WeakMap"),bP="[object Map]",$7="[object Object]",wP="[object Promise]",SP="[object Set]",CP="[object WeakMap]",TP="[object DataView]",F7=bh(pS),B7=bh(f_),k7=bh(mS),N7=bh(gS),V7=bh(_S),hs=xh;(pS&&hs(new pS(new ArrayBuffer(1)))!=TP||f_&&hs(new f_)!=bP||mS&&hs(mS.resolve())!=wP||gS&&hs(new gS)!=SP||_S&&hs(new _S)!=CP)&&(hs=function(e){var t=xh(e),o=t==$7?e.constructor:void 0,c=o?bh(o):"";if(c)switch(c){case F7:return TP;case B7:return bP;case k7:return wP;case N7:return SP;case V7:return CP}return t});var j7=1,EP="[object Arguments]",MP="[object Array]",Py="[object Object]",U7=Object.prototype,IP=U7.hasOwnProperty;function H7(e,t,o,c,d,y){var w=vs(e),i=vs(t),O=w?MP:hs(e),L=i?MP:hs(t);O=O==EP?Py:O,L=L==EP?Py:L;var z=O==Py,F=L==Py,N=O==L;if(N&&g_(e)){if(!g_(t))return!1;w=!0,z=!1}if(N&&!z)return y||(y=new Tl),w||K2(e)?Hz(e,t,o,c,d,y):NH(e,t,O,o,c,d,y);if(!(o&j7)){var G=z&&IP.call(e,"__wrapped__"),Y=F&&IP.call(t,"__wrapped__");if(G||Y){var K=G?e.value():e,J=Y?t.value():t;return y||(y=new Tl),d(K,J,o,c,y)}}return N?(y||(y=new Tl),L7(e,t,o,c,d,y)):!1}function bx(e,t,o,c,d){return e===t?!0:e==null||t==null||!Il(e)&&!Il(t)?e!==e&&t!==t:H7(e,t,o,c,bx,d)}function J2(e,t){return bx(e,t)}const G7={align:Object,target:[Object,Function],onAlign:Function,monitorBufferTime:Number,monitorWindowResize:Boolean,disabled:Boolean};function AP(e){return typeof e!="function"?null:e()}function PP(e){return typeof e!="object"||!e?null:e}const W7=cn({compatConfig:{MODE:3},name:"Align",props:G7,emits:["align"],setup(e,t){let{expose:o,slots:c}=t;const d=tn({}),y=tn(),[w,i]=_U(()=>{const{disabled:N,target:G,align:Y,onAlign:K}=e;if(!N&&G&&y.value){const J=y.value;let X;const se=AP(G),te=PP(G);d.value.element=se,d.value.point=te,d.value.align=Y;const{activeElement:ne}=document;return se&&G2(se)?X=H2(J,se,Y):te&&(X=fU(J,te,Y)),gU(ne,J),K&&X&&K(J,X),!0}return!1},He(()=>e.monitorBufferTime)),O=tn({cancel:()=>{}}),L=tn({cancel:()=>{}}),z=()=>{const N=e.target,G=AP(N),Y=PP(N);y.value!==L.value.element&&(L.value.cancel(),L.value.element=y.value,L.value.cancel=hP(y.value,w)),(d.value.element!==G||!mU(d.value.point,Y)||!J2(d.value.align,e.align))&&(w(),O.value.element!==G&&(O.value.cancel(),O.value.element=G,O.value.cancel=hP(G,w)))};Qr(()=>{si(()=>{z()})}),Pu(()=>{si(()=>{z()})}),On(()=>e.disabled,N=>{N?i():w()},{immediate:!0,flush:"post"});const F=tn(null);return On(()=>e.monitorWindowResize,N=>{N?F.value||(F.value=js(window,"resize",w)):F.value&&(F.value.remove(),F.value=null)},{flush:"post"}),Cc(()=>{O.value.cancel(),L.value.cancel(),F.value&&F.value.remove(),i()}),o({forceAlign:()=>w(!0)}),()=>{const N=c==null?void 0:c.default();return N?xo(N[0],{ref:y},!0,!0):null}}});Tu("bottomLeft","bottomRight","topLeft","topRight");const q7=e=>e!==void 0&&(e==="topLeft"||e==="topRight")?"slide-down":"slide-up",M_=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return re(e?{name:e,appear:!0,enterFromClass:`${e}-enter ${e}-enter-prepare ${e}-enter-start`,enterActiveClass:`${e}-enter ${e}-enter-prepare`,enterToClass:`${e}-enter ${e}-enter-active`,leaveFromClass:` ${e}-leave`,leaveActiveClass:`${e}-leave ${e}-leave-active`,leaveToClass:`${e}-leave ${e}-leave-active`}:{css:!1},t)},Q2=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return re(e?{name:e,appear:!0,appearActiveClass:`${e}`,appearToClass:`${e}-appear ${e}-appear-active`,enterFromClass:`${e}-appear ${e}-enter ${e}-appear-prepare ${e}-enter-prepare`,enterActiveClass:`${e}`,enterToClass:`${e}-enter ${e}-appear ${e}-appear-active ${e}-enter-active`,leaveActiveClass:`${e} ${e}-leave`,leaveToClass:`${e}-leave-active`}:{css:!1},t)},gh=(e,t,o)=>o!==void 0?o:`${e}-${t}`,Z7=cn({compatConfig:{MODE:3},name:"PopupInner",inheritAttrs:!1,props:B2,emits:["mouseenter","mouseleave","mousedown","touchstart","align"],setup(e,t){let{expose:o,attrs:c,slots:d}=t;const y=Xt(),w=Xt(),i=Xt(),[O,L]=Nj(ra(e,"stretch")),z=()=>{e.stretch&&L(e.getRootDomNode())},F=Xt(!1);let N;On(()=>e.visible,ge=>{clearTimeout(N),ge?N=setTimeout(()=>{F.value=e.visible}):F.value=!1},{immediate:!0});const[G,Y]=kj(F,z),K=Xt(),J=()=>e.point?e.point:e.getRootDomNode,X=()=>{var ge;(ge=y.value)===null||ge===void 0||ge.forceAlign()},se=(ge,ee)=>{var be;const Ie=e.getClassNameFromAlign(ee),Ee=i.value;i.value!==Ie&&(i.value=Ie),G.value==="align"&&(Ee!==Ie?Promise.resolve().then(()=>{X()}):Y(()=>{var Re;(Re=K.value)===null||Re===void 0||Re.call(K)}),(be=e.onAlign)===null||be===void 0||be.call(e,ge,ee))},te=He(()=>{const ge=typeof e.animation=="object"?e.animation:k2(e);return["onAfterEnter","onAfterLeave"].forEach(ee=>{const be=ge[ee];ge[ee]=Ie=>{Y(),G.value="stable",be==null||be(Ie)}}),ge}),ne=()=>new Promise(ge=>{K.value=ge});On([te,G],()=>{!te.value&&G.value==="motion"&&Y()},{immediate:!0}),o({forceAlign:X,getElement:()=>w.value.$el||w.value});const ue=He(()=>{var ge;return!(!((ge=e.align)===null||ge===void 0)&&ge.points&&(G.value==="align"||G.value==="stable"))});return()=>{var ge;const{zIndex:ee,align:be,prefixCls:Ie,destroyPopupOnHide:Ee,onMouseenter:Re,onMouseleave:Qe,onTouchstart:et=()=>{},onMousedown:We}=e,me=G.value,Oe=[re(re({},O.value),{zIndex:ee,opacity:me==="motion"||me==="stable"||!F.value?null:0,pointerEvents:!F.value&&me!=="stable"?"none":null}),c.style];let Fe=vo((ge=d.default)===null||ge===void 0?void 0:ge.call(d,{visible:e.visible}));Fe.length>1&&(Fe=le("div",{class:`${Ie}-content`},[Fe]));const Ke=hn(Ie,c.class,i.value,!e.arrow&&`${Ie}-arrow-hidden`),pt=F.value||!e.visible?M_(te.value.name,te.value):{};return le(Al,it(it({ref:w},pt),{},{onBeforeEnter:ne}),{default:()=>!Ee||e.visible?Ns(le(W7,{target:J(),key:"popup",ref:y,monitorWindowResize:!0,disabled:ue.value,align:be,onAlign:se},{default:()=>le("div",{class:Ke,onMouseenter:Re,onMouseleave:Qe,onMousedown:mc(We,["capture"]),[$o?"onTouchstartPassive":"onTouchstart"]:mc(et,["capture"]),style:Oe},[Fe])}),[[bl,F.value]]):null})}}}),Y7=cn({compatConfig:{MODE:3},name:"Popup",inheritAttrs:!1,props:$j,setup(e,t){let{attrs:o,slots:c,expose:d}=t;const y=Xt(!1),w=Xt(!1),i=Xt(),O=Xt();return On([()=>e.visible,()=>e.mobile],()=>{y.value=e.visible,e.visible&&e.mobile&&(w.value=!0)},{immediate:!0,flush:"post"}),d({forceAlign:()=>{var L;(L=i.value)===null||L===void 0||L.forceAlign()},getElement:()=>{var L;return(L=i.value)===null||L===void 0?void 0:L.getElement()}}),()=>{const L=re(re(re({},e),o),{visible:y.value}),z=w.value?le(Fj,it(it({},L),{},{mobile:e.mobile,ref:i}),{default:c.default}):le(Z7,it(it({},L),{},{ref:i}),{default:c.default});return le("div",{ref:O},[le(Dz,L,null),z])}}});function X7(e,t,o){return o?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function OP(e,t,o){const c=e[t]||{};return re(re({},c),o)}function K7(e,t,o,c){const{points:d}=o,y=Object.keys(e);for(let w=0;w<y.length;w+=1){const i=y[w];if(X7(e[i].points,d,c))return`${t}-placement-${i}`}return""}const wx={methods:{setState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,o=typeof e=="function"?e(this.$data,this.$props):e;if(this.getDerivedStateFromProps){const c=this.getDerivedStateFromProps(lV(this),re(re({},this.$data),o));if(c===null)return;o=re(re({},o),c||{})}re(this.$data,o),this._.isMounted&&this.$forceUpdate(),si(()=>{t&&t()})},__emit(){const e=[].slice.call(arguments,0);let t=e[0];t=`on${t[0].toUpperCase()}${t.substring(1)}`;const o=this.$props[t]||this.$attrs[t];if(e.length&&o)if(Array.isArray(o))for(let c=0,d=o.length;c<d;c++)o[c](...e.slice(1));else o(...e.slice(1))}}},eL=Symbol("PortalContextKey"),eC=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inTriggerContext:!0};li(eL,{inTriggerContext:t.inTriggerContext,shouldRender:He(()=>{const{sPopupVisible:o,popupRef:c,forceRender:d,autoDestroy:y}=e||{};let w=!1;return(o||c||d)&&(w=!0),!o&&y&&(w=!1),w})})},J7=()=>{eC({},{inTriggerContext:!1});const e=Zr(eL,{shouldRender:He(()=>!1),inTriggerContext:!1});return{shouldRender:He(()=>e.shouldRender.value||e.inTriggerContext===!1)}},tL=cn({compatConfig:{MODE:3},name:"Portal",inheritAttrs:!1,props:{getContainer:wt.func.isRequired,didUpdate:Function},setup(e,t){let{slots:o}=t,c=!0,d;const{shouldRender:y}=J7();function w(){y.value&&(d=e.getContainer())}g2(()=>{c=!1,w()}),Qr(()=>{d||w()});const i=On(y,()=>{y.value&&!d&&(d=e.getContainer()),d&&i()});return Pu(()=>{si(()=>{var O;y.value&&((O=e.didUpdate)===null||O===void 0||O.call(e,e))})}),()=>{var O;return y.value?c?(O=o.default)===null||O===void 0?void 0:O.call(o):d?le(BD,{to:d},o):null:null}}});let fw;function Q7(e){if(typeof document>"u")return 0;if(fw===void 0){const t=document.createElement("div");t.style.width="100%",t.style.height="200px";const o=document.createElement("div"),c=o.style;c.position="absolute",c.top="0",c.left="0",c.pointerEvents="none",c.visibility="hidden",c.width="200px",c.height="150px",c.overflow="hidden",o.appendChild(t),document.body.appendChild(o);const d=t.offsetWidth;o.style.overflow="scroll";let y=t.offsetWidth;d===y&&(y=o.clientWidth),document.body.removeChild(o),fw=d-y}return fw}const e9=`vc-util-locker-${Date.now()}`;let DP=0;function t9(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}function n9(e){const t=He(()=>!!e&&!!e.value);DP+=1;const o=`${e9}_${DP}`;Ii(c=>{if(gs()){if(t.value){const d=Q7(),y=t9();l_(`
html body {
  overflow-y: hidden;
  ${y?`width: calc(100% - ${d}px);`:""}
}`,o)}else Pv(o);c(()=>{Pv(o)})}},{flush:"post"})}let Gd=0;const Ky=gs(),RP=e=>{if(!Ky)return null;if(e){if(typeof e=="string")return document.querySelectorAll(e)[0];if(typeof e=="function")return e();if(typeof e=="object"&&e instanceof window.HTMLElement)return e}return document.body},nL=cn({compatConfig:{MODE:3},name:"PortalWrapper",inheritAttrs:!1,props:{wrapperClassName:String,forceRender:{type:Boolean,default:void 0},getContainer:wt.any,visible:{type:Boolean,default:void 0},autoLock:Cr(),didUpdate:Function},setup(e,t){let{slots:o}=t;const c=Xt(),d=Xt(),y=Xt(),w=Xt(1),i=gs()&&document.createElement("div"),O=()=>{var G,Y;c.value===i&&((Y=(G=c.value)===null||G===void 0?void 0:G.parentNode)===null||Y===void 0||Y.removeChild(c.value)),c.value=null};let L=null;const z=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)||c.value&&!c.value.parentNode?(L=RP(e.getContainer),L?(L.appendChild(c.value),!0):!1):!0},F=()=>Ky?(c.value||(c.value=i,z(!0)),N(),c.value):null,N=()=>{const{wrapperClassName:G}=e;c.value&&G&&G!==c.value.className&&(c.value.className=G)};return Pu(()=>{N(),z()}),n9(He(()=>e.autoLock&&e.visible&&gs()&&(c.value===document.body||c.value===i))),Qr(()=>{let G=!1;On([()=>e.visible,()=>e.getContainer],(Y,K)=>{let[J,X]=Y,[se,te]=K;Ky&&(L=RP(e.getContainer),L===document.body&&(J&&!se?Gd+=1:G&&(Gd-=1))),G&&(typeof X=="function"&&typeof te=="function"?X.toString()!==te.toString():X!==te)&&O(),G=!0},{immediate:!0,flush:"post"}),si(()=>{z()||(y.value=qr(()=>{w.value+=1}))})}),fi(()=>{const{visible:G}=e;Ky&&L===document.body&&(Gd=G&&Gd?Gd-1:Gd),O(),qr.cancel(y.value)}),()=>{const{forceRender:G,visible:Y}=e;let K=null;const J={getOpenCount:()=>Gd,getContainer:F};return w.value&&(G||Y||d.value)&&(K=le(tL,{getContainer:F,ref:d,didUpdate:e.didUpdate},{default:()=>{var X;return(X=o.default)===null||X===void 0?void 0:X.call(o,J)}})),K}}}),r9=["onClick","onMousedown","onTouchstart","onMouseenter","onMouseleave","onFocus","onBlur","onContextmenu"],rL=cn({compatConfig:{MODE:3},name:"Trigger",mixins:[wx],inheritAttrs:!1,props:zj(),setup(e){const t=He(()=>{const{popupPlacement:d,popupAlign:y,builtinPlacements:w}=e;return d&&w?OP(w,d,y):y}),o=Xt(null),c=d=>{o.value=d};return{vcTriggerContext:Zr("vcTriggerContext",{}),popupRef:o,setPopupRef:c,triggerRef:Xt(null),align:t,focusTime:null,clickOutsideHandler:null,contextmenuOutsideHandler1:null,contextmenuOutsideHandler2:null,touchOutsideHandler:null,attachId:null,delayTimer:null,hasPopupMouseDown:!1,preClickTime:null,preTouchTime:null,mouseDownTimeout:null,childOriginEvents:{}}},data(){const e=this.$props;let t;return this.popupVisible!==void 0?t=!!e.popupVisible:t=!!e.defaultPopupVisible,r9.forEach(o=>{this[`fire${o}`]=c=>{this.fireEvents(o,c)}}),{prevPopupVisible:t,sPopupVisible:t,point:null}},watch:{popupVisible(e){e!==void 0&&(this.prevPopupVisible=this.sPopupVisible,this.sPopupVisible=e)}},created(){li("vcTriggerContext",{onPopupMouseDown:this.onPopupMouseDown,onPopupMouseenter:this.onPopupMouseenter,onPopupMouseleave:this.onPopupMouseleave}),eC(this)},deactivated(){this.setPopupVisible(!1)},mounted(){this.$nextTick(()=>{this.updatedCal()})},updated(){this.$nextTick(()=>{this.updatedCal()})},beforeUnmount(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),qr.cancel(this.attachId)},methods:{updatedCal(){const e=this.$props;if(this.$data.sPopupVisible){let o;!this.clickOutsideHandler&&(this.isClickToHide()||this.isContextmenuToShow())&&(o=e.getDocument(this.getRootDomNode()),this.clickOutsideHandler=js(o,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(o=o||e.getDocument(this.getRootDomNode()),this.touchOutsideHandler=js(o,"touchstart",this.onDocumentClick,$o?{passive:!1}:!1)),!this.contextmenuOutsideHandler1&&this.isContextmenuToShow()&&(o=o||e.getDocument(this.getRootDomNode()),this.contextmenuOutsideHandler1=js(o,"scroll",this.onContextmenuClose)),!this.contextmenuOutsideHandler2&&this.isContextmenuToShow()&&(this.contextmenuOutsideHandler2=js(window,"blur",this.onContextmenuClose))}else this.clearOutsideHandler()},onMouseenter(e){const{mouseEnterDelay:t}=this.$props;this.fireEvents("onMouseenter",e),this.delaySetPopupVisible(!0,t,t?null:e)},onMouseMove(e){this.fireEvents("onMousemove",e),this.setPoint(e)},onMouseleave(e){this.fireEvents("onMouseleave",e),this.delaySetPopupVisible(!1,this.$props.mouseLeaveDelay)},onPopupMouseenter(){const{vcTriggerContext:e={}}=this;e.onPopupMouseenter&&e.onPopupMouseenter(),this.clearDelayTimer()},onPopupMouseleave(e){var t;if(e&&e.relatedTarget&&!e.relatedTarget.setTimeout&&_u((t=this.popupRef)===null||t===void 0?void 0:t.getElement(),e.relatedTarget))return;this.isMouseLeaveToHide()&&this.delaySetPopupVisible(!1,this.$props.mouseLeaveDelay);const{vcTriggerContext:o={}}=this;o.onPopupMouseleave&&o.onPopupMouseleave(e)},onFocus(e){this.fireEvents("onFocus",e),this.clearDelayTimer(),this.isFocusToShow()&&(this.focusTime=Date.now(),this.delaySetPopupVisible(!0,this.$props.focusDelay))},onMousedown(e){this.fireEvents("onMousedown",e),this.preClickTime=Date.now()},onTouchstart(e){this.fireEvents("onTouchstart",e),this.preTouchTime=Date.now()},onBlur(e){_u(e.target,e.relatedTarget||document.activeElement)||(this.fireEvents("onBlur",e),this.clearDelayTimer(),this.isBlurToHide()&&this.delaySetPopupVisible(!1,this.$props.blurDelay))},onContextmenu(e){e.preventDefault(),this.fireEvents("onContextmenu",e),this.setPopupVisible(!0,e)},onContextmenuClose(){this.isContextmenuToShow()&&this.close()},onClick(e){if(this.fireEvents("onClick",e),this.focusTime){let o;if(this.preClickTime&&this.preTouchTime?o=Math.min(this.preClickTime,this.preTouchTime):this.preClickTime?o=this.preClickTime:this.preTouchTime&&(o=this.preTouchTime),Math.abs(o-this.focusTime)<20)return;this.focusTime=0}this.preClickTime=0,this.preTouchTime=0,this.isClickToShow()&&(this.isClickToHide()||this.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault(),e&&e.domEvent&&e.domEvent.preventDefault();const t=!this.$data.sPopupVisible;(this.isClickToHide()&&!t||t&&this.isClickToShow())&&this.setPopupVisible(!this.$data.sPopupVisible,e)},onPopupMouseDown(){const{vcTriggerContext:e={}}=this;this.hasPopupMouseDown=!0,clearTimeout(this.mouseDownTimeout),this.mouseDownTimeout=setTimeout(()=>{this.hasPopupMouseDown=!1},0),e.onPopupMouseDown&&e.onPopupMouseDown(...arguments)},onDocumentClick(e){if(this.$props.mask&&!this.$props.maskClosable)return;const t=e.target,o=this.getRootDomNode(),c=this.getPopupDomNode();(!_u(o,t)||this.isContextMenuOnly())&&!_u(c,t)&&!this.hasPopupMouseDown&&this.delaySetPopupVisible(!1,.1)},getPopupDomNode(){var e;return((e=this.popupRef)===null||e===void 0?void 0:e.getElement())||null},getRootDomNode(){var e,t,o,c;const{getTriggerDOMNode:d}=this.$props;if(d){const y=((t=(e=this.triggerRef)===null||e===void 0?void 0:e.$el)===null||t===void 0?void 0:t.nodeName)==="#comment"?null:gc(this.triggerRef);return gc(d(y))}try{const y=((c=(o=this.triggerRef)===null||o===void 0?void 0:o.$el)===null||c===void 0?void 0:c.nodeName)==="#comment"?null:gc(this.triggerRef);if(y)return y}catch{}return gc(this)},handleGetPopupClassFromAlign(e){const t=[],o=this.$props,{popupPlacement:c,builtinPlacements:d,prefixCls:y,alignPoint:w,getPopupClassNameFromAlign:i}=o;return c&&d&&t.push(K7(d,y,e,w)),i&&t.push(i(e)),t.join(" ")},getPopupAlign(){const e=this.$props,{popupPlacement:t,popupAlign:o,builtinPlacements:c}=e;return t&&c?OP(c,t,o):o},getComponent(){const e={};this.isMouseEnterToShow()&&(e.onMouseenter=this.onPopupMouseenter),this.isMouseLeaveToHide()&&(e.onMouseleave=this.onPopupMouseleave),e.onMousedown=this.onPopupMouseDown,e[$o?"onTouchstartPassive":"onTouchstart"]=this.onPopupMouseDown;const{handleGetPopupClassFromAlign:t,getRootDomNode:o,$attrs:c}=this,{prefixCls:d,destroyPopupOnHide:y,popupClassName:w,popupAnimation:i,popupTransitionName:O,popupStyle:L,mask:z,maskAnimation:F,maskTransitionName:N,zIndex:G,stretch:Y,alignPoint:K,mobile:J,arrow:X,forceRender:se}=this.$props,{sPopupVisible:te,point:ne}=this.$data,ue=re(re({prefixCls:d,arrow:X,destroyPopupOnHide:y,visible:te,point:K?ne:null,align:this.align,animation:i,getClassNameFromAlign:t,stretch:Y,getRootDomNode:o,mask:z,zIndex:G,transitionName:O,maskAnimation:F,maskTransitionName:N,class:w,style:L,onAlign:c.onPopupAlign||Oz},e),{ref:this.setPopupRef,mobile:J,forceRender:se});return le(Y7,ue,{default:this.$slots.popup||(()=>cV(this,"popup"))})},attachParent(e){qr.cancel(this.attachId);const{getPopupContainer:t,getDocument:o}=this.$props,c=this.getRootDomNode();let d;t?(c||t.length===0)&&(d=t(c)):d=o(this.getRootDomNode()).body,d?d.appendChild(e):this.attachId=qr(()=>{this.attachParent(e)})},getContainer(){const{$props:e}=this,{getDocument:t}=e,o=t(this.getRootDomNode()).createElement("div");return o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",this.attachParent(o),o},setPopupVisible(e,t){const{alignPoint:o,sPopupVisible:c,onPopupVisibleChange:d}=this;this.clearDelayTimer(),c!==e&&(Av(this,"popupVisible")||this.setState({sPopupVisible:e,prevPopupVisible:c}),d&&d(e)),o&&t&&e&&this.setPoint(t)},setPoint(e){const{alignPoint:t}=this.$props;!t||!e||this.setState({point:{pageX:e.pageX,pageY:e.pageY}})},handlePortalUpdate(){this.prevPopupVisible!==this.sPopupVisible&&this.afterPopupVisibleChange(this.sPopupVisible)},delaySetPopupVisible(e,t,o){const c=t*1e3;if(this.clearDelayTimer(),c){const d=o?{pageX:o.pageX,pageY:o.pageY}:null;this.delayTimer=setTimeout(()=>{this.setPopupVisible(e,d),this.clearDelayTimer()},c)}else this.setPopupVisible(e,o)},clearDelayTimer(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},clearOutsideHandler(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextmenuOutsideHandler1&&(this.contextmenuOutsideHandler1.remove(),this.contextmenuOutsideHandler1=null),this.contextmenuOutsideHandler2&&(this.contextmenuOutsideHandler2.remove(),this.contextmenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)},createTwoChains(e){let t=()=>{};const o=SA(this);return this.childOriginEvents[e]&&o[e]?this[`fire${e}`]:(t=this.childOriginEvents[e]||o[e]||t,t)},isClickToShow(){const{action:e,showAction:t}=this.$props;return e.indexOf("click")!==-1||t.indexOf("click")!==-1},isContextMenuOnly(){const{action:e}=this.$props;return e==="contextmenu"||e.length===1&&e[0]==="contextmenu"},isContextmenuToShow(){const{action:e,showAction:t}=this.$props;return e.indexOf("contextmenu")!==-1||t.indexOf("contextmenu")!==-1},isClickToHide(){const{action:e,hideAction:t}=this.$props;return e.indexOf("click")!==-1||t.indexOf("click")!==-1},isMouseEnterToShow(){const{action:e,showAction:t}=this.$props;return e.indexOf("hover")!==-1||t.indexOf("mouseenter")!==-1},isMouseLeaveToHide(){const{action:e,hideAction:t}=this.$props;return e.indexOf("hover")!==-1||t.indexOf("mouseleave")!==-1},isFocusToShow(){const{action:e,showAction:t}=this.$props;return e.indexOf("focus")!==-1||t.indexOf("focus")!==-1},isBlurToHide(){const{action:e,hideAction:t}=this.$props;return e.indexOf("focus")!==-1||t.indexOf("blur")!==-1},forcePopupAlign(){var e;this.$data.sPopupVisible&&((e=this.popupRef)===null||e===void 0||e.forceAlign())},fireEvents(e,t){this.childOriginEvents[e]&&this.childOriginEvents[e](t);const o=this.$props[e]||this.$attrs[e];o&&o(t)},close(){this.setPopupVisible(!1)}},render(){const{$attrs:e}=this,t=ms(C2(this)),{alignPoint:o,getPopupContainer:c}=this.$props,d=t[0];this.childOriginEvents=SA(d);const y={key:"trigger"};this.isContextmenuToShow()?y.onContextmenu=this.onContextmenu:y.onContextmenu=this.createTwoChains("onContextmenu"),this.isClickToHide()||this.isClickToShow()?(y.onClick=this.onClick,y.onMousedown=this.onMousedown,y[$o?"onTouchstartPassive":"onTouchstart"]=this.onTouchstart):(y.onClick=this.createTwoChains("onClick"),y.onMousedown=this.createTwoChains("onMousedown"),y[$o?"onTouchstartPassive":"onTouchstart"]=this.createTwoChains("onTouchstart")),this.isMouseEnterToShow()?(y.onMouseenter=this.onMouseenter,o&&(y.onMousemove=this.onMouseMove)):y.onMouseenter=this.createTwoChains("onMouseenter"),this.isMouseLeaveToHide()?y.onMouseleave=this.onMouseleave:y.onMouseleave=this.createTwoChains("onMouseleave"),this.isFocusToShow()||this.isBlurToHide()?(y.onFocus=this.onFocus,y.onBlur=this.onBlur):(y.onFocus=this.createTwoChains("onFocus"),y.onBlur=L=>{L&&(!L.relatedTarget||!_u(L.target,L.relatedTarget))&&this.createTwoChains("onBlur")(L)});const w=hn(d&&d.props&&d.props.class,e.class);w&&(y.class=w);const i=xo(d,re(re({},y),{ref:"triggerRef"}),!0,!0),O=le(nL,{key:"portal",getContainer:c&&(()=>c(this.getRootDomNode())),didUpdate:this.handlePortalUpdate,visible:this.$data.sPopupVisible},{default:this.getComponent});return le(hr,null,[i,O])}});var i9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const o9=e=>{const t=e===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:t,adjustY:1}},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:t,adjustY:1}},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:t,adjustY:1}},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:t,adjustY:1}}}},a9=cn({name:"SelectTrigger",inheritAttrs:!1,props:{dropdownAlign:Object,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},dropdownClassName:String,dropdownStyle:wt.object,placement:String,empty:{type:Boolean,default:void 0},prefixCls:String,popupClassName:String,animation:String,transitionName:String,getPopupContainer:Function,dropdownRender:Function,containerWidth:Number,dropdownMatchSelectWidth:wt.oneOfType([Number,Boolean]).def(!0),popupElement:wt.any,direction:String,getTriggerDOMNode:Function,onPopupVisibleChange:Function,onPopupMouseEnter:Function,onPopupFocusin:Function,onPopupFocusout:Function},setup(e,t){let{slots:o,attrs:c,expose:d}=t;const y=He(()=>{const{dropdownMatchSelectWidth:i}=e;return o9(i)}),w=tn();return d({getPopupElement:()=>w.value}),()=>{const i=re(re({},e),c),{empty:O=!1}=i,L=i9(i,["empty"]),{visible:z,dropdownAlign:F,prefixCls:N,popupElement:G,dropdownClassName:Y,dropdownStyle:K,direction:J="ltr",placement:X,dropdownMatchSelectWidth:se,containerWidth:te,dropdownRender:ne,animation:ue,transitionName:ge,getPopupContainer:ee,getTriggerDOMNode:be,onPopupVisibleChange:Ie,onPopupMouseEnter:Ee,onPopupFocusin:Re,onPopupFocusout:Qe}=L,et=`${N}-dropdown`;let We=G;ne&&(We=ne({menuNode:G,props:e}));const me=ue?`${et}-${ue}`:ge,Oe=re({minWidth:`${te}px`},K);return typeof se=="number"?Oe.width=`${se}px`:se&&(Oe.width=`${te}px`),le(rL,it(it({},e),{},{showAction:Ie?["click"]:[],hideAction:Ie?["click"]:[],popupPlacement:X||(J==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:y.value,prefixCls:et,popupTransitionName:me,popupAlign:F,popupVisible:z,getPopupContainer:ee,popupClassName:hn(Y,{[`${et}-empty`]:O}),popupStyle:Oe,getTriggerDOMNode:be,onPopupVisibleChange:Ie}),{default:o.default,popup:()=>le("div",{ref:w,onMouseenter:Ee,onFocusin:Re,onFocusout:Qe},[We])})}}}),nn={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){const{keyCode:o}=t;if(t.altKey&&!t.ctrlKey||t.metaKey||o>=nn.F1&&o<=nn.F12)return!1;switch(o){case nn.ALT:case nn.CAPS_LOCK:case nn.CONTEXT_MENU:case nn.CTRL:case nn.DOWN:case nn.END:case nn.ESC:case nn.HOME:case nn.INSERT:case nn.LEFT:case nn.MAC_FF_META:case nn.META:case nn.NUMLOCK:case nn.NUM_CENTER:case nn.PAGE_DOWN:case nn.PAGE_UP:case nn.PAUSE:case nn.PRINT_SCREEN:case nn.RIGHT:case nn.SHIFT:case nn.UP:case nn.WIN_KEY:case nn.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=nn.ZERO&&t<=nn.NINE||t>=nn.NUM_ZERO&&t<=nn.NUM_MULTIPLY||t>=nn.A&&t<=nn.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case nn.SPACE:case nn.QUESTION_MARK:case nn.NUM_PLUS:case nn.NUM_MINUS:case nn.NUM_PERIOD:case nn.NUM_DIVISION:case nn.SEMICOLON:case nn.DASH:case nn.EQUALS:case nn.COMMA:case nn.PERIOD:case nn.SLASH:case nn.APOSTROPHE:case nn.SINGLE_QUOTE:case nn.OPEN_SQUARE_BRACKET:case nn.BACKSLASH:case nn.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},_h=(e,t)=>{let{slots:o}=t;var c;const{class:d,customizeIcon:y,customizeIconProps:w,onMousedown:i,onClick:O}=e;let L;return typeof y=="function"?L=y(w):L=qs(y)?Va(y):y,le("span",{class:d,onMousedown:z=>{z.preventDefault(),i&&i(z)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:O,"aria-hidden":!0},[L!==void 0?L:le("span",{class:d.split(/\s+/).map(z=>`${z}-icon`)},[(c=o.default)===null||c===void 0?void 0:c.call(o)])])};_h.inheritAttrs=!1;_h.displayName="TransBtn";_h.props={class:String,customizeIcon:wt.any,customizeIconProps:wt.any,onMousedown:Function,onClick:Function};var s9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const l9=cn({compatConfig:{MODE:3},props:{disabled:wt.looseBool,type:wt.string,value:wt.any,tag:{type:String,default:"input"},size:wt.string,onChange:Function,onInput:Function,onBlur:Function,onFocus:Function,onKeydown:Function,onCompositionstart:Function,onCompositionend:Function,onKeyup:Function,onPaste:Function,onMousedown:Function},emits:["change","input","blur","keydown","focus","compositionstart","compositionend","keyup","paste","mousedown"],setup(e,t){let{expose:o}=t;const c=Xt(null);return o({focus:()=>{c.value&&c.value.focus()},blur:()=>{c.value&&c.value.blur()},input:c,setSelectionRange:(O,L,z)=>{var F;(F=c.value)===null||F===void 0||F.setSelectionRange(O,L,z)},select:()=>{var O;(O=c.value)===null||O===void 0||O.select()},getSelectionStart:()=>{var O;return(O=c.value)===null||O===void 0?void 0:O.selectionStart},getSelectionEnd:()=>{var O;return(O=c.value)===null||O===void 0?void 0:O.selectionEnd},getScrollTop:()=>{var O;return(O=c.value)===null||O===void 0?void 0:O.scrollTop}}),()=>{const{tag:O,value:L}=e,z=s9(e,["tag","value"]);return le(O,it(it({},z),{},{ref:c,value:L}),null)}}});function c9(e){return Object.keys(e).reduce((t,o)=>{const c=e[o];return typeof c>"u"||c===null||(t+=`${o}: ${e[o]};`),t},"")}var u9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const tC=cn({compatConfig:{MODE:3},inheritAttrs:!1,props:{disabled:wt.looseBool,type:wt.string,value:wt.any,lazy:wt.bool.def(!0),tag:{type:String,default:"input"},size:wt.string,style:wt.oneOfType([String,Object]),class:wt.string},emits:["change","input","blur","keydown","focus","compositionstart","compositionend","keyup","paste","mousedown"],setup(e,t){let{emit:o,attrs:c,expose:d}=t;const y=Xt(null),w=tn(),i=tn(!1);On([()=>e.value,i],()=>{i.value||(w.value=e.value)},{immediate:!0});const O=ee=>{o("change",ee)},L=ee=>{i.value=!0,ee.target.composing=!0,o("compositionstart",ee)},z=ee=>{i.value=!1,ee.target.composing=!1,o("compositionend",ee);const be=document.createEvent("HTMLEvents");be.initEvent("input",!0,!0),ee.target.dispatchEvent(be),O(ee)},F=ee=>{if(i.value&&e.lazy){w.value=ee.target.value;return}o("input",ee)},N=ee=>{o("blur",ee)},G=ee=>{o("focus",ee)},Y=()=>{y.value&&y.value.focus()},K=()=>{y.value&&y.value.blur()},J=ee=>{o("keydown",ee)},X=ee=>{o("keyup",ee)},se=(ee,be,Ie)=>{var Ee;(Ee=y.value)===null||Ee===void 0||Ee.setSelectionRange(ee,be,Ie)},te=()=>{var ee;(ee=y.value)===null||ee===void 0||ee.select()};d({focus:Y,blur:K,input:He(()=>{var ee;return(ee=y.value)===null||ee===void 0?void 0:ee.input}),setSelectionRange:se,select:te,getSelectionStart:()=>{var ee;return(ee=y.value)===null||ee===void 0?void 0:ee.getSelectionStart()},getSelectionEnd:()=>{var ee;return(ee=y.value)===null||ee===void 0?void 0:ee.getSelectionEnd()},getScrollTop:()=>{var ee;return(ee=y.value)===null||ee===void 0?void 0:ee.getScrollTop()}});const ne=ee=>{o("mousedown",ee)},ue=ee=>{o("paste",ee)},ge=He(()=>e.style&&typeof e.style!="string"?c9(e.style):e.style);return()=>{const ee=u9(e,["style","lazy"]);return le(l9,it(it(it({},ee),c),{},{style:ge.value,onInput:F,onChange:O,onBlur:N,onFocus:G,ref:y,value:w.value,onCompositionstart:L,onCompositionend:z,onKeyup:X,onKeydown:J,onPaste:ue,onMousedown:ne}),null)}}}),d9={inputRef:wt.any,prefixCls:String,id:String,inputElement:wt.VueNode,disabled:{type:Boolean,default:void 0},autofocus:{type:Boolean,default:void 0},autocomplete:String,editable:{type:Boolean,default:void 0},activeDescendantId:String,value:String,open:{type:Boolean,default:void 0},tabindex:wt.oneOfType([wt.number,wt.string]),attrs:wt.object,onKeydown:{type:Function},onMousedown:{type:Function},onChange:{type:Function},onPaste:{type:Function},onCompositionstart:{type:Function},onCompositionend:{type:Function},onFocus:{type:Function},onBlur:{type:Function}},iL=cn({compatConfig:{MODE:3},name:"SelectInput",inheritAttrs:!1,props:d9,setup(e){let t=null;const o=Zr("VCSelectContainerEvent");return()=>{var c;const{prefixCls:d,id:y,inputElement:w,disabled:i,tabindex:O,autofocus:L,autocomplete:z,editable:F,activeDescendantId:N,value:G,onKeydown:Y,onMousedown:K,onChange:J,onPaste:X,onCompositionstart:se,onCompositionend:te,onFocus:ne,onBlur:ue,open:ge,inputRef:ee,attrs:be}=e;let Ie=w||le(tC,null,null);const Ee=Ie.props||{},{onKeydown:Re,onInput:Qe,onFocus:et,onBlur:We,onMousedown:me,onCompositionstart:Oe,onCompositionend:Fe,style:Ke}=Ee;return Ie=xo(Ie,re(re(re(re(re({type:"search"},Ee),{id:y,ref:ee,disabled:i,tabindex:O,lazy:!1,autocomplete:z||"off",autofocus:L,class:hn(`${d}-selection-search-input`,(c=Ie==null?void 0:Ie.props)===null||c===void 0?void 0:c.class),role:"combobox","aria-expanded":ge,"aria-haspopup":"listbox","aria-owns":`${y}_list`,"aria-autocomplete":"list","aria-controls":`${y}_list`,"aria-activedescendant":N}),be),{value:F?G:"",readonly:!F,unselectable:F?null:"on",style:re(re({},Ke),{opacity:F?null:0}),onKeydown:$e=>{Y($e),Re&&Re($e)},onMousedown:$e=>{K($e),me&&me($e)},onInput:$e=>{J($e),Qe&&Qe($e)},onCompositionstart($e){se($e),Oe&&Oe($e)},onCompositionend($e){te($e),Fe&&Fe($e)},onPaste:X,onFocus:function(){clearTimeout(t),et&&et(arguments.length<=0?void 0:arguments[0]),ne&&ne(arguments.length<=0?void 0:arguments[0]),o==null||o.focus(arguments.length<=0?void 0:arguments[0])},onBlur:function(){for(var $e=arguments.length,pt=new Array($e),Ct=0;Ct<$e;Ct++)pt[Ct]=arguments[Ct];t=setTimeout(()=>{We&&We(pt[0]),ue&&ue(pt[0]),o==null||o.blur(pt[0])},100)}}),Ie.type==="textarea"?{}:{type:"search"}),!0,!0),Ie}}}),h9=`accept acceptcharset accesskey action allowfullscreen allowtransparency
alt async autocomplete autofocus autoplay capture cellpadding cellspacing challenge
charset checked classid classname colspan cols content contenteditable contextmenu
controls coords crossorigin data datetime default defer dir disabled download draggable
enctype form formaction formenctype formmethod formnovalidate formtarget frameborder
headers height hidden high href hreflang htmlfor for httpequiv icon id inputmode integrity
is keyparams keytype kind label lang list loop low manifest marginheight marginwidth max maxlength media
mediagroup method min minlength multiple muted name novalidate nonce open
optimum pattern placeholder poster preload radiogroup readonly rel required
reversed role rowspan rows sandbox scope scoped scrolling seamless selected
shape size sizes span spellcheck src srcdoc srclang srcset start step style
summary tabindex target title type usemap value width wmode wrap`,f9=`onCopy onCut onPaste onCompositionend onCompositionstart onCompositionupdate onKeydown
    onKeypress onKeyup onFocus onBlur onChange onInput onSubmit onClick onContextmenu onDoubleclick onDblclick
    onDrag onDragend onDragenter onDragexit onDragleave onDragover onDragstart onDrop onMousedown
    onMouseenter onMouseleave onMousemove onMouseout onMouseover onMouseup onSelect onTouchcancel
    onTouchend onTouchmove onTouchstart onTouchstartPassive onTouchmovePassive onScroll onWheel onAbort onCanplay onCanplaythrough
    onDurationchange onEmptied onEncrypted onEnded onError onLoadeddata onLoadedmetadata
    onLoadstart onPause onPlay onPlaying onProgress onRatechange onSeeked onSeeking onStalled onSuspend onTimeupdate onVolumechange onWaiting onLoad onError`,zP=`${h9} ${f9}`.split(/[\s\n]+/),p9="aria-",m9="data-";function LP(e,t){return e.indexOf(t)===0}function Sx(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o;t===!1?o={aria:!0,data:!0,attr:!0}:t===!0?o={aria:!0}:o=re({},t);const c={};return Object.keys(e).forEach(d=>{(o.aria&&(d==="role"||LP(d,p9))||o.data&&LP(d,m9)||o.attr&&(zP.includes(d)||zP.includes(d.toLowerCase())))&&(c[d]=e[d])}),c}const oL=Symbol("OverflowContextProviderKey"),yS=cn({compatConfig:{MODE:3},name:"OverflowContextProvider",inheritAttrs:!1,props:{value:{type:Object}},setup(e,t){let{slots:o}=t;return li(oL,He(()=>e.value)),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}}),g9=()=>Zr(oL,He(()=>null));var _9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const Lf=void 0,Jy=cn({compatConfig:{MODE:3},name:"Item",props:{prefixCls:String,item:wt.any,renderItem:Function,responsive:Boolean,itemKey:{type:[String,Number]},registerSize:Function,display:Boolean,order:Number,component:wt.any,invalidate:Boolean},setup(e,t){let{slots:o,expose:c}=t;const d=He(()=>e.responsive&&!e.display),y=tn();c({itemNodeRef:y});function w(i){e.registerSize(e.itemKey,i)}return Cc(()=>{w(null)}),()=>{var i;const{prefixCls:O,invalidate:L,item:z,renderItem:F,responsive:N,registerSize:G,itemKey:Y,display:K,order:J,component:X="div"}=e,se=_9(e,["prefixCls","invalidate","item","renderItem","responsive","registerSize","itemKey","display","order","component"]),te=(i=o.default)===null||i===void 0?void 0:i.call(o),ne=F&&z!==Lf?F(z):te;let ue;L||(ue={opacity:d.value?0:1,height:d.value?0:Lf,overflowY:d.value?"hidden":Lf,order:N?J:Lf,pointerEvents:d.value?"none":Lf,position:d.value?"absolute":Lf});const ge={};return d.value&&(ge["aria-hidden"]=!0),le(sx,{disabled:!N,onResize:ee=>{let{offsetWidth:be}=ee;w(be)}},{default:()=>le(X,it(it(it({class:hn(!L&&O),style:ue},ge),se),{},{ref:y}),{default:()=>[ne]})})}}});var pw=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const y9=cn({compatConfig:{MODE:3},name:"RawItem",inheritAttrs:!1,props:{component:wt.any,title:wt.any,id:String,onMouseenter:{type:Function},onMouseleave:{type:Function},onClick:{type:Function},onKeydown:{type:Function},onFocus:{type:Function},role:String,tabindex:Number},setup(e,t){let{slots:o,attrs:c}=t;const d=g9();return()=>{var y;if(!d.value){const{component:F="div"}=e,N=pw(e,["component"]);return le(F,it(it({},N),c),{default:()=>[(y=o.default)===null||y===void 0?void 0:y.call(o)]})}const w=d.value,{className:i}=w,O=pw(w,["className"]),{class:L}=c,z=pw(c,["class"]);return le(yS,{value:null},{default:()=>[le(Jy,it(it(it({class:hn(i,L)},O),z),e),o)]})}}});var v9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const aL="responsive",sL="invalidate";function x9(e){return`+ ${e.length} ...`}const b9=()=>({id:String,prefixCls:String,data:Array,itemKey:[String,Number,Function],itemWidth:{type:Number,default:10},renderItem:Function,renderRawItem:Function,maxCount:[Number,String],renderRest:Function,renderRawRest:Function,suffix:wt.any,component:String,itemComponent:wt.any,onVisibleChange:Function,ssr:String,onMousedown:Function,role:String}),Cx=cn({name:"Overflow",inheritAttrs:!1,props:b9(),emits:["visibleChange"],setup(e,t){let{attrs:o,emit:c,slots:d}=t;const y=He(()=>e.ssr==="full"),w=Xt(null),i=He(()=>w.value||0),O=Xt(new Map),L=Xt(0),z=Xt(0),F=Xt(0),N=Xt(null),G=Xt(null),Y=He(()=>G.value===null&&y.value?Number.MAX_SAFE_INTEGER:G.value||0),K=Xt(!1),J=He(()=>`${e.prefixCls}-item`),X=He(()=>Math.max(L.value,z.value)),se=He(()=>!!(e.data.length&&e.maxCount===aL)),te=He(()=>e.maxCount===sL),ne=He(()=>se.value||typeof e.maxCount=="number"&&e.data.length>e.maxCount),ue=He(()=>{let me=e.data;return se.value?w.value===null&&y.value?me=e.data:me=e.data.slice(0,Math.min(e.data.length,i.value/e.itemWidth)):typeof e.maxCount=="number"&&(me=e.data.slice(0,e.maxCount)),me}),ge=He(()=>se.value?e.data.slice(Y.value+1):e.data.slice(ue.value.length)),ee=(me,Oe)=>{var Fe;return typeof e.itemKey=="function"?e.itemKey(me):(Fe=e.itemKey&&(me==null?void 0:me[e.itemKey]))!==null&&Fe!==void 0?Fe:Oe},be=He(()=>e.renderItem||(me=>me)),Ie=(me,Oe)=>{G.value=me,Oe||(K.value=me<e.data.length-1,c("visibleChange",me))},Ee=(me,Oe)=>{w.value=Oe.clientWidth},Re=(me,Oe)=>{const Fe=new Map(O.value);Oe===null?Fe.delete(me):Fe.set(me,Oe),O.value=Fe},Qe=(me,Oe)=>{L.value=z.value,z.value=Oe},et=(me,Oe)=>{F.value=Oe},We=me=>O.value.get(ee(ue.value[me],me));return On([i,O,z,F,()=>e.itemKey,ue],()=>{if(i.value&&X.value&&ue.value){let me=F.value;const Oe=ue.value.length,Fe=Oe-1;if(!Oe){Ie(0),N.value=null;return}for(let Ke=0;Ke<Oe;Ke+=1){const $e=We(Ke);if($e===void 0){Ie(Ke-1,!0);break}if(me+=$e,Fe===0&&me<=i.value||Ke===Fe-1&&me+We(Fe)<=i.value){Ie(Fe),N.value=null;break}else if(me+X.value>i.value){Ie(Ke-1),N.value=me-$e-F.value+z.value;break}}e.suffix&&We(0)+F.value>i.value&&(N.value=null)}}),()=>{const me=K.value&&!!ge.value.length,{itemComponent:Oe,renderRawItem:Fe,renderRawRest:Ke,renderRest:$e,prefixCls:pt="rc-overflow",suffix:Ct,component:Lt="div",id:It,onMousedown:_n}=e,{class:Ut,style:ln}=o,xn=v9(o,["class","style"]);let En={};N.value!==null&&se.value&&(En={position:"absolute",left:`${N.value}px`,top:0});const Nt={prefixCls:J.value,responsive:se.value,component:Oe,invalidate:te.value},_e=Fe?(je,Mt)=>{const Pt=ee(je,Mt);return le(yS,{key:Pt,value:re(re({},Nt),{order:Mt,item:je,itemKey:Pt,registerSize:Re,display:Mt<=Y.value})},{default:()=>[Fe(je,Mt)]})}:(je,Mt)=>{const Pt=ee(je,Mt);return le(Jy,it(it({},Nt),{},{order:Mt,key:Pt,item:je,renderItem:be.value,itemKey:Pt,registerSize:Re,display:Mt<=Y.value}),null)};let Ft=()=>null;const Ve={order:me?Y.value:Number.MAX_SAFE_INTEGER,className:`${J.value} ${J.value}-rest`,registerSize:Qe,display:me};if(Ke)Ke&&(Ft=()=>le(yS,{value:re(re({},Nt),Ve)},{default:()=>[Ke(ge.value)]}));else{const je=$e||x9;Ft=()=>le(Jy,it(it({},Nt),Ve),{default:()=>typeof je=="function"?je(ge.value):je})}const Ye=()=>{var je;return le(Lt,it({id:It,class:hn(!te.value&&pt,Ut),style:ln,onMousedown:_n,role:e.role},xn),{default:()=>[ue.value.map(_e),ne.value?Ft():null,Ct&&le(Jy,it(it({},Nt),{},{order:Y.value,class:`${J.value}-suffix`,registerSize:et,display:!0,style:En}),{default:()=>Ct}),(je=d.default)===null||je===void 0?void 0:je.call(d)]})};return le(sx,{disabled:!se.value,onResize:Ee},{default:Ye})}}});Cx.Item=y9;Cx.RESPONSIVE=aL;Cx.INVALIDATE=sL;const w9=Symbol("TreeSelectLegacyContextPropsKey");function nC(){return Zr(w9,{})}const S9={id:String,prefixCls:String,values:wt.array,open:{type:Boolean,default:void 0},searchValue:String,inputRef:wt.any,placeholder:wt.any,disabled:{type:Boolean,default:void 0},mode:String,showSearch:{type:Boolean,default:void 0},autofocus:{type:Boolean,default:void 0},autocomplete:String,activeDescendantId:String,tabindex:wt.oneOfType([wt.number,wt.string]),compositionStatus:Boolean,removeIcon:wt.any,choiceTransitionName:String,maxTagCount:wt.oneOfType([wt.number,wt.string]),maxTagTextLength:Number,maxTagPlaceholder:wt.any.def(()=>e=>`+ ${e.length} ...`),tagRender:Function,onToggleOpen:{type:Function},onRemove:Function,onInputChange:Function,onInputPaste:Function,onInputKeyDown:Function,onInputMouseDown:Function,onInputCompositionStart:Function,onInputCompositionEnd:Function},$P=e=>{e.preventDefault(),e.stopPropagation()},C9=cn({name:"MultipleSelectSelector",inheritAttrs:!1,props:S9,setup(e){const t=Xt(),o=Xt(0),c=Xt(!1),d=nC(),y=He(()=>`${e.prefixCls}-selection`),w=He(()=>e.open||e.mode==="tags"?e.searchValue:""),i=He(()=>e.mode==="tags"||e.showSearch&&(e.open||c.value)),O=tn("");Ii(()=>{O.value=w.value}),Qr(()=>{On(O,()=>{o.value=t.value.scrollWidth},{flush:"post",immediate:!0})});function L(Y,K,J,X,se){return le("span",{class:hn(`${y.value}-item`,{[`${y.value}-item-disabled`]:J}),title:typeof Y=="string"||typeof Y=="number"?Y.toString():void 0},[le("span",{class:`${y.value}-item-content`},[K]),X&&le(_h,{class:`${y.value}-item-remove`,onMousedown:$P,onClick:se,customizeIcon:e.removeIcon},{default:()=>[Fi("")]})])}function z(Y,K,J,X,se,te){var ne;const ue=ee=>{$P(ee),e.onToggleOpen(!open)};let ge=te;return d.keyEntities&&(ge=((ne=d.keyEntities[Y])===null||ne===void 0?void 0:ne.node)||{}),le("span",{key:Y,onMousedown:ue},[e.tagRender({label:K,value:Y,disabled:J,closable:X,onClose:se,option:ge})])}function F(Y){const{disabled:K,label:J,value:X,option:se}=Y,te=!e.disabled&&!K;let ne=J;if(typeof e.maxTagTextLength=="number"&&(typeof J=="string"||typeof J=="number")){const ge=String(ne);ge.length>e.maxTagTextLength&&(ne=`${ge.slice(0,e.maxTagTextLength)}...`)}const ue=ge=>{var ee;ge&&ge.stopPropagation(),(ee=e.onRemove)===null||ee===void 0||ee.call(e,Y)};return typeof e.tagRender=="function"?z(X,ne,K,te,ue,se):L(J,ne,K,te,ue)}function N(Y){const{maxTagPlaceholder:K=X=>`+ ${X.length} ...`}=e,J=typeof K=="function"?K(Y):K;return L(J,J,!1)}const G=Y=>{const K=Y.target.composing;O.value=Y.target.value,K||e.onInputChange(Y)};return()=>{const{id:Y,prefixCls:K,values:J,open:X,inputRef:se,placeholder:te,disabled:ne,autofocus:ue,autocomplete:ge,activeDescendantId:ee,tabindex:be,compositionStatus:Ie,onInputPaste:Ee,onInputKeyDown:Re,onInputMouseDown:Qe,onInputCompositionStart:et,onInputCompositionEnd:We}=e,me=le("div",{class:`${y.value}-search`,style:{width:o.value+"px"},key:"input"},[le(iL,{inputRef:se,open:X,prefixCls:K,id:Y,inputElement:null,disabled:ne,autofocus:ue,autocomplete:ge,editable:i.value,activeDescendantId:ee,value:O.value,onKeydown:Re,onMousedown:Qe,onChange:G,onPaste:Ee,onCompositionstart:et,onCompositionend:We,tabindex:be,attrs:Sx(e,!0),onFocus:()=>c.value=!0,onBlur:()=>c.value=!1},null),le("span",{ref:t,class:`${y.value}-search-mirror`,"aria-hidden":!0},[O.value,Fi("")])]),Oe=le(Cx,{prefixCls:`${y.value}-overflow`,data:J,renderItem:F,renderRest:N,suffix:me,itemKey:"key",maxCount:e.maxTagCount,key:"overflow"},null);return le(hr,null,[Oe,!J.length&&!w.value&&!Ie&&le("span",{class:`${y.value}-placeholder`},[te])])}}}),T9={inputElement:wt.any,id:String,prefixCls:String,values:wt.array,open:{type:Boolean,default:void 0},searchValue:String,inputRef:wt.any,placeholder:wt.any,compositionStatus:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},mode:String,showSearch:{type:Boolean,default:void 0},autofocus:{type:Boolean,default:void 0},autocomplete:String,activeDescendantId:String,tabindex:wt.oneOfType([wt.number,wt.string]),activeValue:String,backfill:{type:Boolean,default:void 0},optionLabelRender:Function,onInputChange:Function,onInputPaste:Function,onInputKeyDown:Function,onInputMouseDown:Function,onInputCompositionStart:Function,onInputCompositionEnd:Function},rC=cn({name:"SingleSelector",setup(e){const t=Xt(!1),o=He(()=>e.mode==="combobox"),c=He(()=>o.value||e.showSearch),d=He(()=>{let z=e.searchValue||"";return o.value&&e.activeValue&&!t.value&&(z=e.activeValue),z}),y=nC();On([o,()=>e.activeValue],()=>{o.value&&(t.value=!1)},{immediate:!0});const w=He(()=>e.mode!=="combobox"&&!e.open&&!e.showSearch?!1:!!d.value||e.compositionStatus),i=He(()=>{const z=e.values[0];return z&&(typeof z.label=="string"||typeof z.label=="number")?z.label.toString():void 0}),O=()=>{if(e.values[0])return null;const z=w.value?{visibility:"hidden"}:void 0;return le("span",{class:`${e.prefixCls}-selection-placeholder`,style:z},[e.placeholder])},L=z=>{z.target.composing||(t.value=!0,e.onInputChange(z))};return()=>{var z,F,N,G;const{inputElement:Y,prefixCls:K,id:J,values:X,inputRef:se,disabled:te,autofocus:ne,autocomplete:ue,activeDescendantId:ge,open:ee,tabindex:be,optionLabelRender:Ie,onInputKeyDown:Ee,onInputMouseDown:Re,onInputPaste:Qe,onInputCompositionStart:et,onInputCompositionEnd:We}=e,me=X[0];let Oe=null;if(me&&y.customSlots){const Fe=(z=me.key)!==null&&z!==void 0?z:me.value,Ke=((F=y.keyEntities[Fe])===null||F===void 0?void 0:F.node)||{};Oe=y.customSlots[(N=Ke.slots)===null||N===void 0?void 0:N.title]||y.customSlots.title||me.label,typeof Oe=="function"&&(Oe=Oe(Ke))}else Oe=Ie&&me?Ie(me.option):me==null?void 0:me.label;return le(hr,null,[le("span",{class:`${K}-selection-search`},[le(iL,{inputRef:se,prefixCls:K,id:J,open:ee,inputElement:Y,disabled:te,autofocus:ne,autocomplete:ue,editable:c.value,activeDescendantId:ge,value:d.value,onKeydown:Ee,onMousedown:Re,onChange:L,onPaste:Qe,onCompositionstart:et,onCompositionend:We,tabindex:be,attrs:Sx(e,!0)},null)]),!o.value&&me&&!w.value&&le("span",{class:`${K}-selection-item`,title:i.value},[le(hr,{key:(G=me.key)!==null&&G!==void 0?G:me.value},[Oe])]),O()])}}});rC.props=T9;rC.inheritAttrs=!1;function E9(e){return![nn.ESC,nn.SHIFT,nn.BACKSPACE,nn.TAB,nn.WIN_KEY,nn.ALT,nn.META,nn.WIN_KEY_RIGHT,nn.CTRL,nn.SEMICOLON,nn.EQUALS,nn.CAPS_LOCK,nn.CONTEXT_MENU,nn.F1,nn.F2,nn.F3,nn.F4,nn.F5,nn.F6,nn.F7,nn.F8,nn.F9,nn.F10,nn.F11,nn.F12].includes(e)}function lL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,t=null,o;fi(()=>{clearTimeout(o)});function c(d){(d||t===null)&&(t=d),clearTimeout(o),o=setTimeout(()=>{t=null},e)}return[()=>t,c]}function __(){const e=t=>{e.current=t};return e}const M9=cn({name:"Selector",inheritAttrs:!1,props:{id:String,prefixCls:String,showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},values:wt.array,multiple:{type:Boolean,default:void 0},mode:String,searchValue:String,activeValue:String,inputElement:wt.any,autofocus:{type:Boolean,default:void 0},activeDescendantId:String,tabindex:wt.oneOfType([wt.number,wt.string]),disabled:{type:Boolean,default:void 0},placeholder:wt.any,removeIcon:wt.any,maxTagCount:wt.oneOfType([wt.number,wt.string]),maxTagTextLength:Number,maxTagPlaceholder:wt.any,tagRender:Function,optionLabelRender:Function,tokenWithEnter:{type:Boolean,default:void 0},choiceTransitionName:String,onToggleOpen:{type:Function},onSearch:Function,onSearchSubmit:Function,onRemove:Function,onInputKeyDown:{type:Function},domRef:Function},setup(e,t){let{expose:o}=t;const c=__(),d=tn(!1),[y,w]=lL(0),i=X=>{const{which:se}=X;(se===nn.UP||se===nn.DOWN)&&X.preventDefault(),e.onInputKeyDown&&e.onInputKeyDown(X),se===nn.ENTER&&e.mode==="tags"&&!d.value&&!e.open&&e.onSearchSubmit(X.target.value),E9(se)&&e.onToggleOpen(!0)},O=()=>{w(!0)};let L=null;const z=X=>{e.onSearch(X,!0,d.value)!==!1&&e.onToggleOpen(!0)},F=()=>{d.value=!0},N=X=>{d.value=!1,e.mode!=="combobox"&&z(X.target.value)},G=X=>{let{target:{value:se}}=X;if(e.tokenWithEnter&&L&&/[\r\n]/.test(L)){const te=L.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");se=se.replace(te,L)}L=null,z(se)},Y=X=>{const{clipboardData:se}=X;L=se.getData("text")},K=X=>{let{target:se}=X;se!==c.current&&(document.body.style.msTouchAction!==void 0?setTimeout(()=>{c.current.focus()}):c.current.focus())},J=X=>{const se=y();X.target!==c.current&&!se&&X.preventDefault(),(e.mode!=="combobox"&&(!e.showSearch||!se)||!e.open)&&(e.open&&e.onSearch("",!0,!1),e.onToggleOpen())};return o({focus:()=>{c.current.focus()},blur:()=>{c.current.blur()}}),()=>{const{prefixCls:X,domRef:se,mode:te}=e,ne={inputRef:c,onInputKeyDown:i,onInputMouseDown:O,onInputChange:G,onInputPaste:Y,compositionStatus:d.value,onInputCompositionStart:F,onInputCompositionEnd:N},ue=te==="multiple"||te==="tags"?le(C9,it(it({},e),ne),null):le(rC,it(it({},e),ne),null);return le("div",{ref:se,class:`${X}-selector`,onClick:K,onMousedown:J},[ue])}}});function I9(e,t,o){function c(d){var y,w,i;let O=d.target;O.shadowRoot&&d.composed&&(O=d.composedPath()[0]||O);const L=[(y=e[0])===null||y===void 0?void 0:y.value,(i=(w=e[1])===null||w===void 0?void 0:w.value)===null||i===void 0?void 0:i.getPopupElement()];t.value&&L.every(z=>z&&!z.contains(O)&&z!==O)&&o(!1)}Qr(()=>{window.addEventListener("mousedown",c)}),fi(()=>{window.removeEventListener("mousedown",c)})}function A9(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;const t=Xt(!1);let o;const c=()=>{clearTimeout(o)};return Qr(()=>{c()}),[t,(y,w)=>{c(),o=setTimeout(()=>{t.value=y,w&&w()},e)},c]}const cL=Symbol("BaseSelectContextKey");function P9(e){return li(cL,e)}function O9(){return Zr(cL,{})}const D9=()=>{if(typeof navigator>"u"||typeof window>"u")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substring(0,4))};function uL(e){if(!lo(e))return no(e);const t=new Proxy({},{get(o,c,d){return Reflect.get(e.value,c,d)},set(o,c,d){return e.value[c]=d,!0},deleteProperty(o,c){return Reflect.deleteProperty(e.value,c)},has(o,c){return Reflect.has(e.value,c)},ownKeys(){return Object.keys(e.value)},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}}});return no(t)}var R9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const z9=["value","onChange","removeIcon","placeholder","autofocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabindex","OptionList","notFoundContent"],L9=()=>({prefixCls:String,id:String,omitDomProps:Array,displayValues:Array,onDisplayValuesChange:Function,activeValue:String,activeDescendantId:String,onActiveValueChange:Function,searchValue:String,onSearch:Function,onSearchSplit:Function,maxLength:Number,OptionList:wt.any,emptyOptions:Boolean}),dL=()=>({showSearch:{type:Boolean,default:void 0},tagRender:{type:Function},optionLabelRender:{type:Function},direction:{type:String},tabindex:Number,autofocus:Boolean,notFoundContent:wt.any,placeholder:wt.any,onClear:Function,choiceTransitionName:String,mode:String,disabled:{type:Boolean,default:void 0},loading:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},onDropdownVisibleChange:{type:Function},getInputElement:{type:Function},getRawInputElement:{type:Function},maxTagTextLength:Number,maxTagCount:{type:[String,Number]},maxTagPlaceholder:wt.any,tokenSeparators:{type:Array},allowClear:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:void 0},inputIcon:wt.any,clearIcon:wt.any,removeIcon:wt.any,animation:String,transitionName:String,dropdownStyle:{type:Object},dropdownClassName:String,dropdownMatchSelectWidth:{type:[Boolean,Number],default:void 0},dropdownRender:{type:Function},dropdownAlign:Object,placement:{type:String},getPopupContainer:{type:Function},showAction:{type:Array},onBlur:{type:Function},onFocus:{type:Function},onKeyup:Function,onKeydown:Function,onMousedown:Function,onPopupScroll:Function,onInputKeyDown:Function,onMouseenter:Function,onMouseleave:Function,onClick:Function}),$9=()=>re(re({},L9()),dL());function hL(e){return e==="tags"||e==="multiple"}const F9=cn({compatConfig:{MODE:3},name:"BaseSelect",inheritAttrs:!1,props:Wo($9(),{showAction:[],notFoundContent:"Not Found"}),setup(e,t){let{attrs:o,expose:c,slots:d}=t;const y=He(()=>hL(e.mode)),w=He(()=>e.showSearch!==void 0?e.showSearch:y.value||e.mode==="combobox"),i=Xt(!1);Qr(()=>{i.value=D9()});const O=nC(),L=Xt(null),z=__(),F=Xt(null),N=Xt(null),G=Xt(null),Y=tn(!1),[K,J,X]=A9();c({focus:()=>{var _e;(_e=N.value)===null||_e===void 0||_e.focus()},blur:()=>{var _e;(_e=N.value)===null||_e===void 0||_e.blur()},scrollTo:_e=>{var Ft;return(Ft=G.value)===null||Ft===void 0?void 0:Ft.scrollTo(_e)}});const ne=He(()=>{var _e;if(e.mode!=="combobox")return e.searchValue;const Ft=(_e=e.displayValues[0])===null||_e===void 0?void 0:_e.value;return typeof Ft=="string"||typeof Ft=="number"?String(Ft):""}),ue=e.open!==void 0?e.open:e.defaultOpen,ge=Xt(ue),ee=Xt(ue),be=_e=>{ge.value=e.open!==void 0?e.open:_e,ee.value=ge.value};On(()=>e.open,()=>{be(e.open)});const Ie=He(()=>!e.notFoundContent&&e.emptyOptions);Ii(()=>{ee.value=ge.value,(e.disabled||Ie.value&&ee.value&&e.mode==="combobox")&&(ee.value=!1)});const Ee=He(()=>Ie.value?!1:ee.value),Re=_e=>{const Ft=_e!==void 0?_e:!ee.value;ee.value!==Ft&&!e.disabled&&(be(Ft),e.onDropdownVisibleChange&&e.onDropdownVisibleChange(Ft),!Ft&&Lt.value&&(Lt.value=!1,J(!1,()=>{pt.value=!1,Y.value=!1})))},Qe=He(()=>(e.tokenSeparators||[]).some(_e=>[`
`,`\r
`].includes(_e))),et=(_e,Ft,Ve)=>{var Ye,je;let Mt=!0,Pt=_e;(Ye=e.onActiveValueChange)===null||Ye===void 0||Ye.call(e,null);const qt=Ve?null:Oj(_e,e.tokenSeparators);return e.mode!=="combobox"&&qt&&(Pt="",(je=e.onSearchSplit)===null||je===void 0||je.call(e,qt),Re(!1),Mt=!1),e.onSearch&&ne.value!==Pt&&e.onSearch(Pt,{source:Ft?"typing":"effect"}),Mt},We=_e=>{var Ft;!_e||!_e.trim()||(Ft=e.onSearch)===null||Ft===void 0||Ft.call(e,_e,{source:"submit"})};On(ee,()=>{!ee.value&&!y.value&&e.mode!=="combobox"&&et("",!1,!1)},{immediate:!0,flush:"post"}),On(()=>e.disabled,()=>{ge.value&&e.disabled&&be(!1),e.disabled&&!Y.value&&J(!1)},{immediate:!0});const[me,Oe]=lL(),Fe=function(_e){var Ft;const Ve=me(),{which:Ye}=_e;if(Ye===nn.ENTER&&(e.mode!=="combobox"&&_e.preventDefault(),ee.value||Re(!0)),Oe(!!ne.value),Ye===nn.BACKSPACE&&!Ve&&y.value&&!ne.value&&e.displayValues.length){const qt=[...e.displayValues];let zt=null;for(let Kt=qt.length-1;Kt>=0;Kt-=1){const an=qt[Kt];if(!an.disabled){qt.splice(Kt,1),zt=an;break}}zt&&e.onDisplayValuesChange(qt,{type:"remove",values:[zt]})}for(var je=arguments.length,Mt=new Array(je>1?je-1:0),Pt=1;Pt<je;Pt++)Mt[Pt-1]=arguments[Pt];ee.value&&G.value&&G.value.onKeydown(_e,...Mt),(Ft=e.onKeydown)===null||Ft===void 0||Ft.call(e,_e,...Mt)},Ke=function(_e){for(var Ft=arguments.length,Ve=new Array(Ft>1?Ft-1:0),Ye=1;Ye<Ft;Ye++)Ve[Ye-1]=arguments[Ye];ee.value&&G.value&&G.value.onKeyup(_e,...Ve),e.onKeyup&&e.onKeyup(_e,...Ve)},$e=_e=>{const Ft=e.displayValues.filter(Ve=>Ve!==_e);e.onDisplayValuesChange(Ft,{type:"remove",values:[_e]})},pt=Xt(!1),Ct=function(){J(!0),e.disabled||(e.onFocus&&!pt.value&&e.onFocus(...arguments),e.showAction&&e.showAction.includes("focus")&&Re(!0)),pt.value=!0},Lt=tn(!1),It=function(){if(Lt.value||(Y.value=!0,J(!1,()=>{pt.value=!1,Y.value=!1,Re(!1)}),e.disabled))return;const _e=ne.value;_e&&(e.mode==="tags"?e.onSearch(_e,{source:"submit"}):e.mode==="multiple"&&e.onSearch("",{source:"blur"})),e.onBlur&&e.onBlur(...arguments)},_n=()=>{Lt.value=!0},Ut=()=>{Lt.value=!1};li("VCSelectContainerEvent",{focus:Ct,blur:It});const ln=[];Qr(()=>{ln.forEach(_e=>clearTimeout(_e)),ln.splice(0,ln.length)}),fi(()=>{ln.forEach(_e=>clearTimeout(_e)),ln.splice(0,ln.length)});const xn=function(_e){var Ft,Ve;const{target:Ye}=_e,je=(Ft=F.value)===null||Ft===void 0?void 0:Ft.getPopupElement();if(je&&je.contains(Ye)){const zt=setTimeout(()=>{var Kt;const an=ln.indexOf(zt);an!==-1&&ln.splice(an,1),X(),!i.value&&!je.contains(document.activeElement)&&((Kt=N.value)===null||Kt===void 0||Kt.focus())});ln.push(zt)}for(var Mt=arguments.length,Pt=new Array(Mt>1?Mt-1:0),qt=1;qt<Mt;qt++)Pt[qt-1]=arguments[qt];(Ve=e.onMousedown)===null||Ve===void 0||Ve.call(e,_e,...Pt)},En=Xt(null),Nt=()=>{};return Qr(()=>{On(Ee,()=>{var _e;if(Ee.value){const Ft=Math.ceil((_e=L.value)===null||_e===void 0?void 0:_e.offsetWidth);En.value!==Ft&&!Number.isNaN(Ft)&&(En.value=Ft)}},{immediate:!0,flush:"post"})}),I9([L,F],Ee,Re),P9(uL(re(re({},zk(e)),{open:ee,triggerOpen:Ee,showSearch:w,multiple:y,toggleOpen:Re}))),()=>{const _e=re(re({},e),o),{prefixCls:Ft,id:Ve,open:Ye,defaultOpen:je,mode:Mt,showSearch:Pt,searchValue:qt,onSearch:zt,allowClear:Kt,clearIcon:an,showArrow:un,inputIcon:Nn,disabled:Sn,loading:Qt,getInputElement:Hn,getPopupContainer:tr,placement:Pr,animation:nr,transitionName:pi,dropdownStyle:xi,dropdownClassName:Yi,dropdownMatchSelectWidth:Xi,dropdownRender:Ai,dropdownAlign:xa,showAction:Bi,direction:ci,tokenSeparators:ba,tagRender:kn,optionLabelRender:ca,onPopupScroll:Bu,onDropdownVisibleChange:Ao,onFocus:Ua,onBlur:Dl,onKeyup:Rl,onKeydown:zl,onMousedown:ku,onClear:Ha,omitDomProps:Js,getRawInputElement:Ll,displayValues:ni,onDisplayValuesChange:$l,emptyOptions:Pc,activeDescendantId:Fl,activeValue:Gi,OptionList:ua}=_e,mt=R9(_e,["prefixCls","id","open","defaultOpen","mode","showSearch","searchValue","onSearch","allowClear","clearIcon","showArrow","inputIcon","disabled","loading","getInputElement","getPopupContainer","placement","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","showAction","direction","tokenSeparators","tagRender","optionLabelRender","onPopupScroll","onDropdownVisibleChange","onFocus","onBlur","onKeyup","onKeydown","onMousedown","onClear","omitDomProps","getRawInputElement","displayValues","onDisplayValuesChange","emptyOptions","activeDescendantId","activeValue","OptionList"]),ae=Mt==="combobox"&&Hn&&Hn()||null,pe=typeof Ll=="function"&&Ll(),ye=re({},mt);let De;pe&&(De=jt=>{Re(jt)}),z9.forEach(jt=>{delete ye[jt]}),Js==null||Js.forEach(jt=>{delete ye[jt]});const ze=un!==void 0?un:Qt||!y.value&&Mt!=="combobox";let qe;ze&&(qe=le(_h,{class:hn(`${Ft}-arrow`,{[`${Ft}-arrow-loading`]:Qt}),customizeIcon:Nn,customizeIconProps:{loading:Qt,searchValue:ne.value,open:ee.value,focused:K.value,showSearch:w.value}},null));let at;const Xe=()=>{Ha==null||Ha(),$l([],{type:"clear",values:ni}),et("",!1,!1)};!Sn&&Kt&&(ni.length||ne.value)&&(at=le(_h,{class:`${Ft}-clear`,onMousedown:Xe,customizeIcon:an},{default:()=>[Fi("")]}));const ht=le(ua,{ref:G},re(re({},O.customSlots),{option:d.option})),dt=hn(Ft,o.class,{[`${Ft}-focused`]:K.value,[`${Ft}-multiple`]:y.value,[`${Ft}-single`]:!y.value,[`${Ft}-allow-clear`]:Kt,[`${Ft}-show-arrow`]:ze,[`${Ft}-disabled`]:Sn,[`${Ft}-loading`]:Qt,[`${Ft}-open`]:ee.value,[`${Ft}-customize-input`]:ae,[`${Ft}-show-search`]:w.value}),ft=le(a9,{ref:F,disabled:Sn,prefixCls:Ft,visible:Ee.value,popupElement:ht,containerWidth:En.value,animation:nr,transitionName:pi,dropdownStyle:xi,dropdownClassName:Yi,direction:ci,dropdownMatchSelectWidth:Xi,dropdownRender:Ai,dropdownAlign:xa,placement:Pr,getPopupContainer:tr,empty:Pc,getTriggerDOMNode:()=>z.current,onPopupVisibleChange:De,onPopupMouseEnter:Nt,onPopupFocusin:_n,onPopupFocusout:Ut},{default:()=>pe?Tc(pe)&&xo(pe,{ref:z},!1,!0):le(M9,it(it({},e),{},{domRef:z,prefixCls:Ft,inputElement:ae,ref:N,id:Ve,showSearch:w.value,mode:Mt,activeDescendantId:Fl,tagRender:kn,optionLabelRender:ca,values:ni,open:ee.value,onToggleOpen:Re,activeValue:Gi,searchValue:ne.value,onSearch:et,onSearchSubmit:We,onRemove:$e,tokenWithEnter:Qe.value}),null)});let At;return pe?At=ft:At=le("div",it(it({},ye),{},{class:dt,ref:L,onMousedown:xn,onKeydown:Fe,onKeyup:Ke}),[K.value&&!ee.value&&le("span",{style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0},"aria-live":"polite"},[`${ni.map(jt=>{let{label:Wt,value:bn}=jt;return["number","string"].includes(typeof Wt)?Wt:bn}).join(", ")}`]),ft,qe,at]),At}}}),Tx=(e,t)=>{let{height:o,offset:c,prefixCls:d,onInnerResize:y}=e,{slots:w}=t;var i;let O={},L={display:"flex",flexDirection:"column"};return c!==void 0&&(O={height:`${o}px`,position:"relative",overflow:"hidden"},L=re(re({},L),{transform:`translateY(${c}px)`,position:"absolute",left:0,right:0,top:0})),le("div",{style:O},[le(sx,{onResize:z=>{let{offsetHeight:F}=z;F&&y&&y()}},{default:()=>[le("div",{style:L,class:hn({[`${d}-holder-inner`]:d})},[(i=w.default)===null||i===void 0?void 0:i.call(w)])]})])};Tx.displayName="Filter";Tx.inheritAttrs=!1;Tx.props={prefixCls:String,height:Number,offset:Number,onInnerResize:Function};const fL=(e,t)=>{let{setRef:o}=e,{slots:c}=t;var d;const y=vo((d=c.default)===null||d===void 0?void 0:d.call(c));return y.length?Va(y[0],{ref:o}):y};fL.props={setRef:{type:Function,default:()=>{}}};const B9=20;function FP(e){return"touches"in e?e.touches[0].pageY:e.pageY}const k9=cn({compatConfig:{MODE:3},name:"ScrollBar",inheritAttrs:!1,props:{prefixCls:String,scrollTop:Number,scrollHeight:Number,height:Number,count:Number,onScroll:{type:Function},onStartMove:{type:Function},onStopMove:{type:Function}},setup(){return{moveRaf:null,scrollbarRef:__(),thumbRef:__(),visibleTimeout:null,state:no({dragging:!1,pageY:null,startTop:null,visible:!1})}},watch:{scrollTop:{handler(){this.delayHidden()},flush:"post"}},mounted(){var e,t;(e=this.scrollbarRef.current)===null||e===void 0||e.addEventListener("touchstart",this.onScrollbarTouchStart,$o?{passive:!1}:!1),(t=this.thumbRef.current)===null||t===void 0||t.addEventListener("touchstart",this.onMouseDown,$o?{passive:!1}:!1)},beforeUnmount(){this.removeEvents(),clearTimeout(this.visibleTimeout)},methods:{delayHidden(){clearTimeout(this.visibleTimeout),this.state.visible=!0,this.visibleTimeout=setTimeout(()=>{this.state.visible=!1},2e3)},onScrollbarTouchStart(e){e.preventDefault()},onContainerMouseDown(e){e.stopPropagation(),e.preventDefault()},patchEvents(){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.thumbRef.current.addEventListener("touchmove",this.onMouseMove,$o?{passive:!1}:!1),this.thumbRef.current.addEventListener("touchend",this.onMouseUp)},removeEvents(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.scrollbarRef.current.removeEventListener("touchstart",this.onScrollbarTouchStart,$o?{passive:!1}:!1),this.thumbRef.current&&(this.thumbRef.current.removeEventListener("touchstart",this.onMouseDown,$o?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchmove",this.onMouseMove,$o?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchend",this.onMouseUp)),qr.cancel(this.moveRaf)},onMouseDown(e){const{onStartMove:t}=this.$props;re(this.state,{dragging:!0,pageY:FP(e),startTop:this.getTop()}),t(),this.patchEvents(),e.stopPropagation(),e.preventDefault()},onMouseMove(e){const{dragging:t,pageY:o,startTop:c}=this.state,{onScroll:d}=this.$props;if(qr.cancel(this.moveRaf),t){const y=FP(e)-o,w=c+y,i=this.getEnableScrollRange(),O=this.getEnableHeightRange(),L=O?w/O:0,z=Math.ceil(L*i);this.moveRaf=qr(()=>{d(z)})}},onMouseUp(){const{onStopMove:e}=this.$props;this.state.dragging=!1,e(),this.removeEvents()},getSpinHeight(){const{height:e,scrollHeight:t}=this.$props;let o=e/t*100;return o=Math.max(o,B9),o=Math.min(o,e/2),Math.floor(o)},getEnableScrollRange(){const{scrollHeight:e,height:t}=this.$props;return e-t||0},getEnableHeightRange(){const{height:e}=this.$props,t=this.getSpinHeight();return e-t||0},getTop(){const{scrollTop:e}=this.$props,t=this.getEnableScrollRange(),o=this.getEnableHeightRange();return e===0||t===0?0:e/t*o},showScroll(){const{height:e,scrollHeight:t}=this.$props;return t>e}},render(){const{dragging:e,visible:t}=this.state,{prefixCls:o}=this.$props,c=this.getSpinHeight()+"px",d=this.getTop()+"px",y=this.showScroll(),w=y&&t;return le("div",{ref:this.scrollbarRef,class:hn(`${o}-scrollbar`,{[`${o}-scrollbar-show`]:y}),style:{width:"8px",top:0,bottom:0,right:0,position:"absolute",display:w?void 0:"none"},onMousedown:this.onContainerMouseDown,onMousemove:this.delayHidden},[le("div",{ref:this.thumbRef,class:hn(`${o}-scrollbar-thumb`,{[`${o}-scrollbar-thumb-moving`]:e}),style:{width:"100%",height:c,top:d,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:"99px",cursor:"pointer",userSelect:"none"},onMousedown:this.onMouseDown},null)])}});function N9(e,t,o,c){const d=new Map,y=new Map,w=tn(Symbol("update"));On(e,()=>{w.value=Symbol("update")});let i;function O(){qr.cancel(i)}function L(){O(),i=qr(()=>{d.forEach((F,N)=>{if(F&&F.offsetParent){const{offsetHeight:G}=F;y.get(N)!==G&&(w.value=Symbol("update"),y.set(N,F.offsetHeight))}})})}function z(F,N){const G=t(F);d.get(G),N?(d.set(G,N.$el||N),L()):d.delete(G)}return Cc(()=>{O()}),[z,L,y,w]}function V9(e,t,o,c,d,y,w,i){let O;return L=>{if(L==null){i();return}qr.cancel(O);const z=t.value,F=c.itemHeight;if(typeof L=="number")w(L);else if(L&&typeof L=="object"){let N;const{align:G}=L;"index"in L?{index:N}=L:N=z.findIndex(J=>d(J)===L.key);const{offset:Y=0}=L,K=(J,X)=>{if(J<0||!e.value)return;const se=e.value.clientHeight;let te=!1,ne=X;if(se){const ue=X||G;let ge=0,ee=0,be=0;const Ie=Math.min(z.length,N);for(let Qe=0;Qe<=Ie;Qe+=1){const et=d(z[Qe]);ee=ge;const We=o.get(et);be=ee+(We===void 0?F:We),ge=be,Qe===N&&We===void 0&&(te=!0)}const Ee=e.value.scrollTop;let Re=null;switch(ue){case"top":Re=ee-Y;break;case"bottom":Re=be-se+Y;break;default:{const Qe=Ee+se;ee<Ee?ne="top":be>Qe&&(ne="bottom")}}Re!==null&&Re!==Ee&&w(Re)}O=qr(()=>{te&&y(),K(J-1,ne)},2)};K(5)}}}const j9=typeof navigator=="object"&&/Firefox/i.test(navigator.userAgent),pL=(e,t)=>{let o=!1,c=null;function d(){clearTimeout(c),o=!0,c=setTimeout(()=>{o=!1},50)}return function(y){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=y<0&&e.value||y>0&&t.value;return w&&i?(clearTimeout(c),o=!1):(!i||o)&&d(),!o&&i}};function U9(e,t,o,c){let d=0,y=null,w=null,i=!1;const O=pL(t,o);function L(F){if(!e.value)return;qr.cancel(y);const{deltaY:N}=F;d+=N,w=N,!O(N)&&(j9||F.preventDefault(),y=qr(()=>{c(d*(i?10:1)),d=0}))}function z(F){e.value&&(i=F.detail===w)}return[L,z]}const H9=14/15;function G9(e,t,o){let c=!1,d=0,y=null,w=null;const i=()=>{y&&(y.removeEventListener("touchmove",O),y.removeEventListener("touchend",L))},O=N=>{if(c){const G=Math.ceil(N.touches[0].pageY);let Y=d-G;d=G,o(Y)&&N.preventDefault(),clearInterval(w),w=setInterval(()=>{Y*=H9,(!o(Y,!0)||Math.abs(Y)<=.1)&&clearInterval(w)},16)}},L=()=>{c=!1,i()},z=N=>{i(),N.touches.length===1&&!c&&(c=!0,d=Math.ceil(N.touches[0].pageY),y=N.target,y.addEventListener("touchmove",O,{passive:!1}),y.addEventListener("touchend",L))},F=()=>{};Qr(()=>{document.addEventListener("touchmove",F,{passive:!1}),On(e,N=>{t.value.removeEventListener("touchstart",z),i(),clearInterval(w),N&&t.value.addEventListener("touchstart",z,{passive:!1})},{immediate:!0})}),fi(()=>{document.removeEventListener("touchmove",F)})}var W9=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const q9=[],Z9={overflowY:"auto",overflowAnchor:"none"};function Y9(e,t,o,c,d,y){let{getKey:w}=y;return e.slice(t,o+1).map((i,O)=>{const L=t+O,z=d(i,L,{}),F=w(i);return le(fL,{key:F,setRef:N=>c(i,N)},{default:()=>[z]})})}const X9=cn({compatConfig:{MODE:3},name:"List",inheritAttrs:!1,props:{prefixCls:String,data:wt.array,height:Number,itemHeight:Number,fullHeight:{type:Boolean,default:void 0},itemKey:{type:[String,Number,Function],required:!0},component:{type:[String,Object]},virtual:{type:Boolean,default:void 0},children:Function,onScroll:Function,onMousedown:Function,onMouseenter:Function,onVisibleChange:Function},setup(e,t){let{expose:o}=t;const c=He(()=>{const{height:$e,itemHeight:pt,virtual:Ct}=e;return!!(Ct!==!1&&$e&&pt)}),d=He(()=>{const{height:$e,itemHeight:pt,data:Ct}=e;return c.value&&Ct&&pt*Ct.length>$e}),y=no({scrollTop:0,scrollMoving:!1}),w=He(()=>e.data||q9),i=Xt([]);On(w,()=>{i.value=Ir(w.value).slice()},{immediate:!0});const O=Xt($e=>{});On(()=>e.itemKey,$e=>{typeof $e=="function"?O.value=$e:O.value=pt=>pt==null?void 0:pt[$e]},{immediate:!0});const L=Xt(),z=Xt(),F=Xt(),N=$e=>O.value($e),G={getKey:N};function Y($e){let pt;typeof $e=="function"?pt=$e(y.scrollTop):pt=$e;const Ct=ge(pt);L.value&&(L.value.scrollTop=Ct),y.scrollTop=Ct}const[K,J,X,se]=N9(i,N),te=no({scrollHeight:void 0,start:0,end:0,offset:void 0}),ne=Xt(0);Qr(()=>{si(()=>{var $e;ne.value=(($e=z.value)===null||$e===void 0?void 0:$e.offsetHeight)||0})}),Pu(()=>{si(()=>{var $e;ne.value=(($e=z.value)===null||$e===void 0?void 0:$e.offsetHeight)||0})}),On([c,i],()=>{c.value||re(te,{scrollHeight:void 0,start:0,end:i.value.length-1,offset:void 0})},{immediate:!0}),On([c,i,ne,d],()=>{c.value&&!d.value&&re(te,{scrollHeight:ne.value,start:0,end:i.value.length-1,offset:void 0}),L.value&&(y.scrollTop=L.value.scrollTop)},{immediate:!0}),On([d,c,()=>y.scrollTop,i,se,()=>e.height,ne],()=>{if(!c.value||!d.value)return;let $e=0,pt,Ct,Lt;const It=i.value.length,_n=i.value,Ut=y.scrollTop,{itemHeight:ln,height:xn}=e,En=Ut+xn;for(let Nt=0;Nt<It;Nt+=1){const _e=_n[Nt],Ft=N(_e);let Ve=X.get(Ft);Ve===void 0&&(Ve=ln);const Ye=$e+Ve;pt===void 0&&Ye>=Ut&&(pt=Nt,Ct=$e),Lt===void 0&&Ye>En&&(Lt=Nt),$e=Ye}pt===void 0&&(pt=0,Ct=0,Lt=Math.ceil(xn/ln)),Lt===void 0&&(Lt=It-1),Lt=Math.min(Lt+1,It),re(te,{scrollHeight:$e,start:pt,end:Lt,offset:Ct})},{immediate:!0});const ue=He(()=>te.scrollHeight-e.height);function ge($e){let pt=$e;return Number.isNaN(ue.value)||(pt=Math.min(pt,ue.value)),pt=Math.max(pt,0),pt}const ee=He(()=>y.scrollTop<=0),be=He(()=>y.scrollTop>=ue.value),Ie=pL(ee,be);function Ee($e){Y($e)}function Re($e){var pt;const{scrollTop:Ct}=$e.currentTarget;Ct!==y.scrollTop&&Y(Ct),(pt=e.onScroll)===null||pt===void 0||pt.call(e,$e)}const[Qe,et]=U9(c,ee,be,$e=>{Y(pt=>pt+$e)});G9(c,L,($e,pt)=>Ie($e,pt)?!1:(Qe({preventDefault(){},deltaY:$e}),!0));function We($e){c.value&&$e.preventDefault()}const me=()=>{L.value&&(L.value.removeEventListener("wheel",Qe,$o?{passive:!1}:!1),L.value.removeEventListener("DOMMouseScroll",et),L.value.removeEventListener("MozMousePixelScroll",We))};Ii(()=>{si(()=>{L.value&&(me(),L.value.addEventListener("wheel",Qe,$o?{passive:!1}:!1),L.value.addEventListener("DOMMouseScroll",et),L.value.addEventListener("MozMousePixelScroll",We))})}),fi(()=>{me()});const Oe=V9(L,i,X,e,N,J,Y,()=>{var $e;($e=F.value)===null||$e===void 0||$e.delayHidden()});o({scrollTo:Oe});const Fe=He(()=>{let $e=null;return e.height&&($e=re({[e.fullHeight?"height":"maxHeight"]:e.height+"px"},Z9),c.value&&($e.overflowY="hidden",y.scrollMoving&&($e.pointerEvents="none"))),$e});return On([()=>te.start,()=>te.end,i],()=>{if(e.onVisibleChange){const $e=i.value.slice(te.start,te.end+1);e.onVisibleChange($e,i.value)}},{flush:"post"}),{state:y,mergedData:i,componentStyle:Fe,onFallbackScroll:Re,onScrollBar:Ee,componentRef:L,useVirtual:c,calRes:te,collectHeight:J,setInstance:K,sharedConfig:G,scrollBarRef:F,fillerInnerRef:z,delayHideScrollBar:()=>{var $e;($e=F.value)===null||$e===void 0||$e.delayHidden()}}},render(){const e=re(re({},this.$props),this.$attrs),{prefixCls:t="rc-virtual-list",height:o,itemHeight:c,fullHeight:d,data:y,itemKey:w,virtual:i,component:O="div",onScroll:L,children:z=this.$slots.default,style:F,class:N}=e,G=W9(e,["prefixCls","height","itemHeight","fullHeight","data","itemKey","virtual","component","onScroll","children","style","class"]),Y=hn(t,N),{scrollTop:K}=this.state,{scrollHeight:J,offset:X,start:se,end:te}=this.calRes,{componentStyle:ne,onFallbackScroll:ue,onScrollBar:ge,useVirtual:ee,collectHeight:be,sharedConfig:Ie,setInstance:Ee,mergedData:Re,delayHideScrollBar:Qe}=this;return le("div",it({style:re(re({},F),{position:"relative"}),class:Y},G),[le(O,{class:`${t}-holder`,style:ne,ref:"componentRef",onScroll:ue,onMouseenter:Qe},{default:()=>[le(Tx,{prefixCls:t,height:J,offset:X,onInnerResize:be,ref:"fillerInnerRef"},{default:()=>Y9(Re,se,te,Ee,z,Ie)})]}),ee&&le(k9,{ref:"scrollBarRef",prefixCls:t,scrollTop:K,height:o,scrollHeight:J,count:Re.length,onScroll:ge,onStartMove:()=>{this.state.scrollMoving=!0},onStopMove:()=>{this.state.scrollMoving=!1}},null)])}});function K9(e,t,o){const c=tn(e());return On(t,(d,y)=>{o(d,y)&&(c.value=e())}),c}function J9(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}const mL=Symbol("SelectContextKey");function Q9(e){return li(mL,e)}function eG(){return Zr(mL,{})}var tG=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};function BP(e){return typeof e=="string"||typeof e=="number"}const nG=cn({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(e,t){let{expose:o,slots:c}=t;const d=O9(),y=eG(),w=He(()=>`${d.prefixCls}-item`),i=K9(()=>y.flattenOptions,[()=>d.open,()=>y.flattenOptions],ue=>ue[0]),O=__(),L=ue=>{ue.preventDefault()},z=ue=>{O.current&&O.current.scrollTo(typeof ue=="number"?{index:ue}:ue)},F=function(ue){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const ee=i.value.length;for(let be=0;be<ee;be+=1){const Ie=(ue+be*ge+ee)%ee,{group:Ee,data:Re}=i.value[Ie];if(!Ee&&!Re.disabled)return Ie}return-1},N=no({activeIndex:F(0)}),G=function(ue){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;N.activeIndex=ue;const ee={source:ge?"keyboard":"mouse"},be=i.value[ue];if(!be){y.onActiveValue(null,-1,ee);return}y.onActiveValue(be.value,ue,ee)};On([()=>i.value.length,()=>d.searchValue],()=>{G(y.defaultActiveFirstOption!==!1?F(0):-1)},{immediate:!0});const Y=ue=>y.rawValues.has(ue)&&d.mode!=="combobox";On([()=>d.open,()=>d.searchValue],()=>{if(!d.multiple&&d.open&&y.rawValues.size===1){const ue=Array.from(y.rawValues)[0],ge=Ir(i.value).findIndex(ee=>{let{data:be}=ee;return be[y.fieldNames.value]===ue});ge!==-1&&(G(ge),si(()=>{z(ge)}))}d.open&&si(()=>{var ue;(ue=O.current)===null||ue===void 0||ue.scrollTo(void 0)})},{immediate:!0,flush:"post"});const K=ue=>{ue!==void 0&&y.onSelect(ue,{selected:!y.rawValues.has(ue)}),d.multiple||d.toggleOpen(!1)},J=ue=>typeof ue.label=="function"?ue.label():ue.label;function X(ue){const ge=i.value[ue];if(!ge)return null;const ee=ge.data||{},{value:be}=ee,{group:Ie}=ge,Ee=Sx(ee,!0),Re=J(ge);return ge?le("div",it(it({"aria-label":typeof Re=="string"&&!Ie?Re:null},Ee),{},{key:ue,role:Ie?"presentation":"option",id:`${d.id}_list_${ue}`,"aria-selected":Y(be)}),[be]):null}return o({onKeydown:ue=>{const{which:ge,ctrlKey:ee}=ue;switch(ge){case nn.N:case nn.P:case nn.UP:case nn.DOWN:{let be=0;if(ge===nn.UP?be=-1:ge===nn.DOWN?be=1:J9()&&ee&&(ge===nn.N?be=1:ge===nn.P&&(be=-1)),be!==0){const Ie=F(N.activeIndex+be,be);z(Ie),G(Ie,!0)}break}case nn.ENTER:{const be=i.value[N.activeIndex];be&&!be.data.disabled?K(be.value):K(void 0),d.open&&ue.preventDefault();break}case nn.ESC:d.toggleOpen(!1),d.open&&ue.stopPropagation()}},onKeyup:()=>{},scrollTo:ue=>{z(ue)}}),()=>{const{id:ue,notFoundContent:ge,onPopupScroll:ee}=d,{menuItemSelectedIcon:be,fieldNames:Ie,virtual:Ee,listHeight:Re,listItemHeight:Qe}=y,et=c.option,{activeIndex:We}=N,me=Object.keys(Ie).map(Oe=>Ie[Oe]);return i.value.length===0?le("div",{role:"listbox",id:`${ue}_list`,class:`${w.value}-empty`,onMousedown:L},[ge]):le(hr,null,[le("div",{role:"listbox",id:`${ue}_list`,style:{height:0,width:0,overflow:"hidden"}},[X(We-1),X(We),X(We+1)]),le(X9,{itemKey:"key",ref:O,data:i.value,height:Re,itemHeight:Qe,fullHeight:!1,onMousedown:L,onScroll:ee,virtual:Ee},{default:(Oe,Fe)=>{var Ke;const{group:$e,groupOption:pt,data:Ct,value:Lt}=Oe,{key:It}=Ct,_n=typeof Oe.label=="function"?Oe.label():Oe.label;if($e){const an=(Ke=Ct.title)!==null&&Ke!==void 0?Ke:BP(_n)&&_n;return le("div",{class:hn(w.value,`${w.value}-group`),title:an},[et?et(Ct):_n!==void 0?_n:It])}const{disabled:Ut,title:ln,children:xn,style:En,class:Nt,className:_e}=Ct,Ft=tG(Ct,["disabled","title","children","style","class","className"]),Ve=co(Ft,me),Ye=Y(Lt),je=`${w.value}-option`,Mt=hn(w.value,je,Nt,_e,{[`${je}-grouped`]:pt,[`${je}-active`]:We===Fe&&!Ut,[`${je}-disabled`]:Ut,[`${je}-selected`]:Ye}),Pt=J(Oe),qt=!be||typeof be=="function"||Ye,zt=typeof Pt=="number"?Pt:Pt||Lt;let Kt=BP(zt)?zt.toString():void 0;return ln!==void 0&&(Kt=ln),le("div",it(it({},Ve),{},{"aria-selected":Ye,class:Mt,title:Kt,onMousemove:an=>{Ft.onMousemove&&Ft.onMousemove(an),!(We===Fe||Ut)&&G(Fe)},onClick:an=>{Ut||K(Lt),Ft.onClick&&Ft.onClick(an)},style:En}),[le("div",{class:`${je}-content`},[et?et(Ct):zt]),Tc(be)||Ye,qt&&le(_h,{class:`${w.value}-option-state`,customizeIcon:be,customizeIconProps:{isSelected:Ye}},{default:()=>[Ye?"":null]})])}})])}}});var rG=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};function iG(e){const t=e,{key:o,children:c}=t,d=t.props,{value:y,disabled:w}=d,i=rG(d,["value","disabled"]),O=c==null?void 0:c.default;return re({key:o,value:y!==void 0?y:o,children:O,disabled:w||w===""},i)}function gL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return vo(e).map((c,d)=>{var y;if(!Tc(c)||!c.type)return null;const{type:{isSelectOptGroup:w},key:i,children:O,props:L}=c;if(t||!w)return iG(c);const z=O&&O.default?O.default():void 0,F=(L==null?void 0:L.label)||((y=O.label)===null||y===void 0?void 0:y.call(O))||i;return re(re({key:`__RC_SELECT_GRP__${i===null?d:String(i)}__`},L),{label:F,options:gL(z||[])})}).filter(c=>c)}function oG(e,t,o){const c=Xt(),d=Xt(),y=Xt(),w=Xt([]);return On([e,t],()=>{e.value?w.value=Ir(e.value).slice():w.value=gL(t.value)},{immediate:!0,deep:!0}),Ii(()=>{const i=w.value,O=new Map,L=new Map,z=o.value;function F(N){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(let Y=0;Y<N.length;Y+=1){const K=N[Y];!K[z.options]||G?(O.set(K[z.value],K),L.set(K[z.label],K)):F(K[z.options],!0)}}F(i),c.value=i,d.value=O,y.value=L}),{options:c,valueOptions:d,labelOptions:y}}let kP=0;const aG=gs();function sG(){let e;return aG?(e=kP,kP+=1):e="TEST_OR_SSR",e}function lG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tn("");const t=`rc_select_${sG()}`;return e.value||t}function _L(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function mw(e,t){return _L(e).join("").toUpperCase().includes(t)}const cG=(e,t,o,c,d)=>He(()=>{const y=o.value,w=d==null?void 0:d.value,i=c==null?void 0:c.value;if(!y||i===!1)return e.value;const{options:O,label:L,value:z}=t.value,F=[],N=typeof i=="function",G=y.toUpperCase(),Y=N?i:(J,X)=>w?mw(X[w],G):X[O]?mw(X[L!=="children"?L:"label"],G):mw(X[z],G),K=N?J=>sS(J):J=>J;return e.value.forEach(J=>{if(J[O]){if(Y(y,K(J)))F.push(J);else{const se=J[O].filter(te=>Y(y,K(te)));se.length&&F.push(re(re({},J),{[O]:se}))}return}Y(y,K(J))&&F.push(J)}),F}),uG=(e,t)=>{const o=Xt({values:new Map,options:new Map});return[He(()=>{const{values:y,options:w}=o.value,i=e.value.map(z=>{var F;return z.label===void 0?re(re({},z),{label:(F=y.get(z.value))===null||F===void 0?void 0:F.label}):z}),O=new Map,L=new Map;return i.forEach(z=>{O.set(z.value,z),L.set(z.value,t.value.get(z.value)||w.get(z.value))}),o.value.values=O,o.value.options=L,i}),y=>t.value.get(y)||o.value.options.get(y)]};function oh(e,t){const{defaultValue:o,value:c=tn()}=t||{};let d=typeof e=="function"?e():e;c.value!==void 0&&(d=Ar(c)),o!==void 0&&(d=typeof o=="function"?o():o);const y=tn(d),w=tn(d);Ii(()=>{let O=c.value!==void 0?c.value:y.value;t.postState&&(O=t.postState(O)),w.value=O});function i(O){const L=w.value;y.value=O,Ir(w.value)!==O&&t.onChange&&t.onChange(O,L)}return On(c,()=>{y.value=c.value}),[w,i]}function hc(e){const t=typeof e=="function"?e():e,o=tn(t);function c(d){o.value=d}return[o,c]}const dG=["inputValue"];function yL(){return re(re({},dL()),{prefixCls:String,id:String,backfill:{type:Boolean,default:void 0},fieldNames:Object,inputValue:String,searchValue:String,onSearch:Function,autoClearSearchValue:{type:Boolean,default:void 0},onSelect:Function,onDeselect:Function,filterOption:{type:[Boolean,Function],default:void 0},filterSort:Function,optionFilterProp:String,optionLabelProp:String,options:Array,defaultActiveFirstOption:{type:Boolean,default:void 0},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,menuItemSelectedIcon:wt.any,mode:String,labelInValue:{type:Boolean,default:void 0},value:wt.any,defaultValue:wt.any,onChange:Function,children:Array})}function hG(e){return!e||typeof e!="object"}const fG=cn({compatConfig:{MODE:3},name:"VcSelect",inheritAttrs:!1,props:Wo(yL(),{prefixCls:"vc-select",autoClearSearchValue:!0,listHeight:200,listItemHeight:20,dropdownMatchSelectWidth:!0}),setup(e,t){let{expose:o,attrs:c,slots:d}=t;const y=lG(ra(e,"id")),w=He(()=>hL(e.mode)),i=He(()=>!!(!e.options&&e.children)),O=He(()=>e.filterOption===void 0&&e.mode==="combobox"?!1:e.filterOption),L=He(()=>Pz(e.fieldNames,i.value)),[z,F]=oh("",{value:He(()=>e.searchValue!==void 0?e.searchValue:e.inputValue),postState:Nt=>Nt||""}),N=oG(ra(e,"options"),ra(e,"children"),L),{valueOptions:G,labelOptions:Y,options:K}=N,J=Nt=>_L(Nt).map(Ft=>{var Ve,Ye;let je,Mt,Pt,qt;hG(Ft)?je=Ft:(Pt=Ft.key,Mt=Ft.label,je=(Ve=Ft.value)!==null&&Ve!==void 0?Ve:Pt);const zt=G.value.get(je);return zt&&(Mt===void 0&&(Mt=zt==null?void 0:zt[e.optionLabelProp||L.value.label]),Pt===void 0&&(Pt=(Ye=zt==null?void 0:zt.key)!==null&&Ye!==void 0?Ye:je),qt=zt==null?void 0:zt.disabled),{label:Mt,value:je,key:Pt,disabled:qt,option:zt}}),[X,se]=oh(e.defaultValue,{value:ra(e,"value")}),te=He(()=>{var Nt;const _e=J(X.value);return e.mode==="combobox"&&!(!((Nt=_e[0])===null||Nt===void 0)&&Nt.value)?[]:_e}),[ne,ue]=uG(te,G),ge=He(()=>{if(!e.mode&&ne.value.length===1){const Nt=ne.value[0];if(Nt.value===null&&(Nt.label===null||Nt.label===void 0))return[]}return ne.value.map(Nt=>{var _e;return re(re({},Nt),{label:(_e=typeof Nt.label=="function"?Nt.label():Nt.label)!==null&&_e!==void 0?_e:Nt.value})})}),ee=He(()=>new Set(ne.value.map(Nt=>Nt.value)));Ii(()=>{var Nt;if(e.mode==="combobox"){const _e=(Nt=ne.value[0])===null||Nt===void 0?void 0:Nt.value;_e!=null&&F(String(_e))}},{flush:"post"});const be=(Nt,_e)=>{const Ft=_e??Nt;return{[L.value.value]:Nt,[L.value.label]:Ft}},Ie=Xt();Ii(()=>{if(e.mode!=="tags"){Ie.value=K.value;return}const Nt=K.value.slice(),_e=Ft=>G.value.has(Ft);[...ne.value].sort((Ft,Ve)=>Ft.value<Ve.value?-1:1).forEach(Ft=>{const Ve=Ft.value;_e(Ve)||Nt.push(be(Ve,Ft.label))}),Ie.value=Nt});const Ee=cG(Ie,L,z,O,ra(e,"optionFilterProp")),Re=He(()=>e.mode!=="tags"||!z.value||Ee.value.some(Nt=>Nt[e.optionFilterProp||"value"]===z.value)?Ee.value:[be(z.value),...Ee.value]),Qe=He(()=>e.filterSort?[...Re.value].sort((Nt,_e)=>e.filterSort(Nt,_e)):Re.value),et=He(()=>Pj(Qe.value,{fieldNames:L.value,childrenAsData:i.value})),We=Nt=>{const _e=J(Nt);if(se(_e),e.onChange&&(_e.length!==ne.value.length||_e.some((Ft,Ve)=>{var Ye;return((Ye=ne.value[Ve])===null||Ye===void 0?void 0:Ye.value)!==(Ft==null?void 0:Ft.value)}))){const Ft=e.labelInValue?_e.map(Ye=>re(re({},Ye),{originLabel:Ye.label,label:typeof Ye.label=="function"?Ye.label():Ye.label})):_e.map(Ye=>Ye.value),Ve=_e.map(Ye=>sS(ue(Ye.value)));e.onChange(w.value?Ft:Ft[0],w.value?Ve:Ve[0])}},[me,Oe]=hc(null),[Fe,Ke]=hc(0),$e=He(()=>e.defaultActiveFirstOption!==void 0?e.defaultActiveFirstOption:e.mode!=="combobox"),pt=function(Nt,_e){let{source:Ft="keyboard"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ke(_e),e.backfill&&e.mode==="combobox"&&Nt!==null&&Ft==="keyboard"&&Oe(String(Nt))},Ct=(Nt,_e)=>{const Ft=()=>{var Ve;const Ye=ue(Nt),je=Ye==null?void 0:Ye[L.value.label];return[e.labelInValue?{label:typeof je=="function"?je():je,originLabel:je,value:Nt,key:(Ve=Ye==null?void 0:Ye.key)!==null&&Ve!==void 0?Ve:Nt}:Nt,sS(Ye)]};if(_e&&e.onSelect){const[Ve,Ye]=Ft();e.onSelect(Ve,Ye)}else if(!_e&&e.onDeselect){const[Ve,Ye]=Ft();e.onDeselect(Ve,Ye)}},Lt=(Nt,_e)=>{let Ft;const Ve=w.value?_e.selected:!0;Ve?Ft=w.value?[...ne.value,Nt]:[Nt]:Ft=ne.value.filter(Ye=>Ye.value!==Nt),We(Ft),Ct(Nt,Ve),e.mode==="combobox"?Oe(""):(!w.value||e.autoClearSearchValue)&&(F(""),Oe(""))},It=(Nt,_e)=>{We(Nt),(_e.type==="remove"||_e.type==="clear")&&_e.values.forEach(Ft=>{Ct(Ft.value,!1)})},_n=(Nt,_e)=>{var Ft;if(F(Nt),Oe(null),_e.source==="submit"){const Ve=(Nt||"").trim();if(Ve){const Ye=Array.from(new Set([...ee.value,Ve]));We(Ye),Ct(Ve,!0),F("")}return}_e.source!=="blur"&&(e.mode==="combobox"&&We(Nt),(Ft=e.onSearch)===null||Ft===void 0||Ft.call(e,Nt))},Ut=Nt=>{let _e=Nt;e.mode!=="tags"&&(_e=Nt.map(Ve=>{const Ye=Y.value.get(Ve);return Ye==null?void 0:Ye.value}).filter(Ve=>Ve!==void 0));const Ft=Array.from(new Set([...ee.value,..._e]));We(Ft),Ft.forEach(Ve=>{Ct(Ve,!0)})},ln=He(()=>e.virtual!==!1&&e.dropdownMatchSelectWidth!==!1);Q9(uL(re(re({},N),{flattenOptions:et,onActiveValue:pt,defaultActiveFirstOption:$e,onSelect:Lt,menuItemSelectedIcon:ra(e,"menuItemSelectedIcon"),rawValues:ee,fieldNames:L,virtual:ln,listHeight:ra(e,"listHeight"),listItemHeight:ra(e,"listItemHeight"),childrenAsData:i})));const xn=tn();o({focus(){var Nt;(Nt=xn.value)===null||Nt===void 0||Nt.focus()},blur(){var Nt;(Nt=xn.value)===null||Nt===void 0||Nt.blur()},scrollTo(Nt){var _e;(_e=xn.value)===null||_e===void 0||_e.scrollTo(Nt)}});const En=He(()=>co(e,["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"]));return()=>le(F9,it(it(it({},En.value),c),{},{id:y,prefixCls:e.prefixCls,ref:xn,omitDomProps:dG,mode:e.mode,displayValues:ge.value,onDisplayValuesChange:It,searchValue:z.value,onSearch:_n,onSearchSplit:Ut,dropdownMatchSelectWidth:e.dropdownMatchSelectWidth,OptionList:nG,emptyOptions:!et.value.length,activeValue:me.value,activeDescendantId:`${y}_list_${Fe.value}`}),d)}}),iC=()=>null;iC.isSelectOption=!0;iC.displayName="ASelectOption";const oC=()=>null;oC.isSelectOptGroup=!0;oC.displayName="ASelectOptGroup";var pG={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},mG=Symbol("iconContext"),vL=function(){return Zr(mG,{prefixCls:tn("anticon"),rootClassName:tn(""),csp:tn()})};function aC(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function gG(e,t){return e&&e.contains?e.contains(t):!1}var NP="data-vc-order",_G="vc-icon-key",vS=new Map;function xL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):_G}function sC(e){if(e.attachTo)return e.attachTo;var t=document.querySelector("head");return t||document.body}function yG(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function bL(e){return Array.from((vS.get(e)||e).children).filter(function(t){return t.tagName==="STYLE"})}function wL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!aC())return null;var o=t.csp,c=t.prepend,d=document.createElement("style");d.setAttribute(NP,yG(c)),o&&o.nonce&&(d.nonce=o.nonce),d.innerHTML=e;var y=sC(t),w=y.firstChild;if(c){if(c==="queue"){var i=bL(y).filter(function(O){return["prepend","prependQueue"].includes(O.getAttribute(NP))});if(i.length)return y.insertBefore(d,i[i.length-1].nextSibling),d}y.insertBefore(d,w)}else y.appendChild(d);return d}function vG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=sC(t);return bL(o).find(function(c){return c.getAttribute(xL(t))===e})}function xG(e,t){var o=vS.get(e);if(!o||!gG(document,o)){var c=wL("",t),d=c.parentNode;vS.set(e,d),e.removeChild(c)}}function bG(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=sC(o);xG(c,o);var d=vG(t,o);if(d)return o.csp&&o.csp.nonce&&d.nonce!==o.csp.nonce&&(d.nonce=o.csp.nonce),d.innerHTML!==e&&(d.innerHTML=e),d;var y=wL(e,o);return y.setAttribute(xL(o),t),y}function VP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){wG(e,d,o[d])})}return e}function wG(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function jP(e){return typeof e=="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(typeof e.icon=="object"||typeof e.icon=="function")}function xS(e,t,o){return o?hh(e.tag,VP({key:t},o,e.attrs),(e.children||[]).map(function(c,d){return xS(c,"".concat(t,"-").concat(e.tag,"-").concat(d))})):hh(e.tag,VP({key:t},e.attrs),(e.children||[]).map(function(c,d){return xS(c,"".concat(t,"-").concat(e.tag,"-").concat(d))}))}function SL(e){return fh(e)[0]}function CL(e){return e?Array.isArray(e)?e:[e]:[]}var SG=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`;function TL(e){return e&&e.getRootNode&&e.getRootNode()}function CG(e){return aC()?TL(e)instanceof ShadowRoot:!1}function TG(e){return CG(e)?TL(e):null}var EG=function(){var t=vL(),o=t.prefixCls,c=t.csp,d=Ys(),y=SG;o&&(y=y.replace(/anticon/g,o.value)),si(function(){if(aC()){var w=d.vnode.el,i=TG(w);bG(y,"@ant-design-vue-icons",{prepend:!0,csp:c.value,attachTo:i})}})},MG=["icon","primaryColor","secondaryColor"];function IG(e,t){if(e==null)return{};var o=AG(e,t),c,d;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(d=0;d<y.length;d++)c=y[d],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(o[c]=e[c])}return o}function AG(e,t){if(e==null)return{};var o={},c=Object.keys(e),d,y;for(y=0;y<c.length;y++)d=c[y],!(t.indexOf(d)>=0)&&(o[d]=e[d]);return o}function Qy(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){PG(e,d,o[d])})}return e}function PG(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Gg=no({primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1});function OG(e){var t=e.primaryColor,o=e.secondaryColor;Gg.primaryColor=t,Gg.secondaryColor=o||SL(t),Gg.calculated=!!o}function DG(){return Qy({},Gg)}var Du=function(t,o){var c=Qy({},t,o.attrs),d=c.icon,y=c.primaryColor,w=c.secondaryColor,i=IG(c,MG),O=Gg;if(y&&(O={primaryColor:y,secondaryColor:w||SL(y)}),jP(d),!jP(d))return null;var L=d;return L&&typeof L.icon=="function"&&(L=Qy({},L,{icon:L.icon(O.primaryColor,O.secondaryColor)})),xS(L.icon,"svg-".concat(L.name),Qy({},i,{"data-icon":L.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}))};Du.props={icon:Object,primaryColor:String,secondaryColor:String,focusable:String};Du.inheritAttrs=!1;Du.displayName="IconBase";Du.getTwoToneColors=DG;Du.setTwoToneColors=OG;function RG(e,t){return FG(e)||$G(e,t)||LG(e,t)||zG()}function zG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LG(e,t){if(e){if(typeof e=="string")return UP(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return UP(e,t)}}function UP(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,c=new Array(t);o<t;o++)c[o]=e[o];return c}function $G(e,t){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var c=[],d=!0,y=!1,w,i;try{for(o=o.call(e);!(d=(w=o.next()).done)&&(c.push(w.value),!(t&&c.length===t));d=!0);}catch(O){y=!0,i=O}finally{try{!d&&o.return!=null&&o.return()}finally{if(y)throw i}}return c}}function FG(e){if(Array.isArray(e))return e}function EL(e){var t=CL(e),o=RG(t,2),c=o[0],d=o[1];return Du.setTwoToneColors({primaryColor:c,secondaryColor:d})}function BG(){var e=Du.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var kG=cn({name:"InsertStyles",setup:function(){return EG(),function(){return null}}}),NG=["class","icon","spin","rotate","tabindex","twoToneColor","onClick"];function VG(e,t){return GG(e)||HG(e,t)||UG(e,t)||jG()}function jG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UG(e,t){if(e){if(typeof e=="string")return HP(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return HP(e,t)}}function HP(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,c=new Array(t);o<t;o++)c[o]=e[o];return c}function HG(e,t){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var c=[],d=!0,y=!1,w,i;try{for(o=o.call(e);!(d=(w=o.next()).done)&&(c.push(w.value),!(t&&c.length===t));d=!0);}catch(O){y=!0,i=O}finally{try{!d&&o.return!=null&&o.return()}finally{if(y)throw i}}return c}}function GG(e){if(Array.isArray(e))return e}function GP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){Pg(e,d,o[d])})}return e}function Pg(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function WG(e,t){if(e==null)return{};var o=qG(e,t),c,d;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(d=0;d<y.length;d++)c=y[d],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(o[c]=e[c])}return o}function qG(e,t){if(e==null)return{};var o={},c=Object.keys(e),d,y;for(y=0;y<c.length;y++)d=c[y],!(t.indexOf(d)>=0)&&(o[d]=e[d]);return o}EL(z8.primary);var Hi=function(t,o){var c,d=GP({},t,o.attrs),y=d.class,w=d.icon,i=d.spin,O=d.rotate,L=d.tabindex,z=d.twoToneColor,F=d.onClick,N=WG(d,NG),G=vL(),Y=G.prefixCls,K=G.rootClassName,J=(c={},Pg(c,K.value,!!K.value),Pg(c,Y.value,!0),Pg(c,"".concat(Y.value,"-").concat(w.name),!!w.name),Pg(c,"".concat(Y.value,"-spin"),!!i||w.name==="loading"),c),X=L;X===void 0&&F&&(X=-1);var se=O?{msTransform:"rotate(".concat(O,"deg)"),transform:"rotate(".concat(O,"deg)")}:void 0,te=CL(z),ne=VG(te,2),ue=ne[0],ge=ne[1];return le("span",GP({role:"img","aria-label":w.name},N,{onClick:F,class:[J,y],tabindex:X}),[le(Du,{icon:w,primaryColor:ue,secondaryColor:ge,style:se},null),le(kG,null,null)])};Hi.props={spin:Boolean,rotate:Number,icon:Object,twoToneColor:[String,Array]};Hi.displayName="AntdIcon";Hi.inheritAttrs=!1;Hi.getTwoToneColor=BG;Hi.setTwoToneColor=EL;function WP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){ZG(e,d,o[d])})}return e}function ZG(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var lC=function(t,o){var c=WP({},t,o.attrs);return le(Hi,WP({},c,{icon:pG}),null)};lC.displayName="DownOutlined";lC.inheritAttrs=!1;var YG={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};function qP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){XG(e,d,o[d])})}return e}function XG(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var xc=function(t,o){var c=qP({},t,o.attrs);return le(Hi,qP({},c,{icon:YG}),null)};xc.displayName="LoadingOutlined";xc.inheritAttrs=!1;var KG={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};function ZP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){JG(e,d,o[d])})}return e}function JG(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var cC=function(t,o){var c=ZP({},t,o.attrs);return le(Hi,ZP({},c,{icon:KG}),null)};cC.displayName="CheckOutlined";cC.inheritAttrs=!1;var QG={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};function YP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){eW(e,d,o[d])})}return e}function eW(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Ru=function(t,o){var c=YP({},t,o.attrs);return le(Hi,YP({},c,{icon:QG}),null)};Ru.displayName="CloseOutlined";Ru.inheritAttrs=!1;var tW={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};function XP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){nW(e,d,o[d])})}return e}function nW(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Ks=function(t,o){var c=XP({},t,o.attrs);return le(Hi,XP({},c,{icon:tW}),null)};Ks.displayName="CloseCircleFilled";Ks.inheritAttrs=!1;var rW={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"};function KP(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){iW(e,d,o[d])})}return e}function iW(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Ex=function(t,o){var c=KP({},t,o.attrs);return le(Hi,KP({},c,{icon:rW}),null)};Ex.displayName="SearchOutlined";Ex.inheritAttrs=!1;function oW(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{loading:o,multiple:c,prefixCls:d,hasFeedback:y,feedbackIcon:w,showArrow:i}=e,O=e.suffixIcon||t.suffixIcon&&t.suffixIcon(),L=e.clearIcon||t.clearIcon&&t.clearIcon(),z=e.menuItemSelectedIcon||t.menuItemSelectedIcon&&t.menuItemSelectedIcon(),F=e.removeIcon||t.removeIcon&&t.removeIcon(),N=L??le(Ks,null,null),G=X=>le(hr,null,[i!==!1&&X,y&&w]);let Y=null;if(O!==void 0)Y=G(O);else if(o)Y=G(le(xc,{spin:!0},null));else{const X=`${d}-suffix`;Y=se=>{let{open:te,showSearch:ne}=se;return G(te&&ne?le(Ex,{class:X},null):le(lC,{class:X},null))}}let K=null;z!==void 0?K=z:c?K=le(cC,null,null):K=null;let J=null;return F!==void 0?J=F:J=le(Ru,null,null),{clearIcon:N,suffixIcon:Y,itemIcon:K,removeIcon:J}}function uC(e){const t=Symbol("contextKey");return{useProvide:(d,y)=>{const w=no({});return li(t,w),Ii(()=>{re(w,d,y||{})}),w},useInject:()=>Zr(t,e)||{}}}const Fv=Symbol("ContextProps"),Bv=Symbol("InternalContextProps"),aW=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:He(()=>!0);const o=tn(new Map),c=(y,w)=>{o.value.set(y,w),o.value=new Map(o.value)},d=y=>{o.value.delete(y),o.value=new Map(o.value)};On([t,o],()=>{}),li(Fv,e),li(Bv,{addFormItemField:c,removeFormItemField:d})},bS={id:He(()=>{}),onFieldBlur:()=>{},onFieldChange:()=>{},clearValidate:()=>{}},wS={addFormItemField:()=>{},removeFormItemField:()=>{}},Ic=()=>{const e=Zr(Bv,wS),t=Symbol("FormItemFieldKey"),o=Ys();return e.addFormItemField(t,o.type),fi(()=>{e.removeFormItemField(t)}),li(Bv,wS),li(Fv,bS),Zr(Fv,bS)},SS=cn({compatConfig:{MODE:3},name:"AFormItemRest",setup(e,t){let{slots:o}=t;return li(Bv,wS),li(Fv,bS),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}}),xs=uC({}),JP=cn({name:"NoFormStatus",setup(e,t){let{slots:o}=t;return xs.useProvide({}),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}});function Qf(e,t,o){return hn({[`${e}-status-success`]:t==="success",[`${e}-status-warning`]:t==="warning",[`${e}-status-error`]:t==="error",[`${e}-status-validating`]:t==="validating",[`${e}-has-feedback`]:o})}const Mx=(e,t)=>t||e,sW=e=>{const{componentCls:t}=e;return{[t]:{display:"inline-flex","&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},lW=e=>{const{componentCls:t}=e;return{[t]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${t}-item`]:{"&:empty":{display:"none"}}}}},cW=Ui("Space",e=>[lW(e),sW(e)]);var uW="[object Symbol]";function Ix(e){return typeof e=="symbol"||Il(e)&&xh(e)==uW}function dC(e,t){for(var o=-1,c=e==null?0:e.length,d=Array(c);++o<c;)d[o]=t(e[o],o,e);return d}var dW=1/0,QP=ys?ys.prototype:void 0,e3=QP?QP.toString:void 0;function ML(e){if(typeof e=="string")return e;if(vs(e))return dC(e,ML)+"";if(Ix(e))return e3?e3.call(e):"";var t=e+"";return t=="0"&&1/e==-dW?"-0":t}var hW=/\s/;function fW(e){for(var t=e.length;t--&&hW.test(e.charAt(t)););return t}var pW=/^\s+/;function mW(e){return e&&e.slice(0,fW(e)+1).replace(pW,"")}var t3=NaN,gW=/^[-+]0x[0-9a-f]+$/i,_W=/^0b[01]+$/i,yW=/^0o[0-7]+$/i,vW=parseInt;function CS(e){if(typeof e=="number")return e;if(Ix(e))return t3;if(vc(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=vc(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=mW(e);var o=_W.test(e);return o||yW.test(e)?vW(e.slice(2),o?2:8):gW.test(e)?t3:+e}var n3=1/0,xW=17976931348623157e292;function bW(e){if(!e)return e===0?e:0;if(e=CS(e),e===n3||e===-n3){var t=e<0?-1:1;return t*xW}return e===e?e:0}function wW(e){var t=bW(e),o=t%1;return t===t?o?t-o:t:0}function hC(e){return e}var r3=Object.create,SW=function(){function e(){}return function(t){if(!vc(t))return{};if(r3)return r3(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();function CW(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function TW(e,t){var o=-1,c=e.length;for(t||(t=Array(c));++o<c;)t[o]=e[o];return t}var EW=800,MW=16,IW=Date.now;function AW(e){var t=0,o=0;return function(){var c=IW(),d=MW-(c-o);if(o=c,d>0){if(++t>=EW)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function PW(e){return function(){return e}}var kv=function(){try{var e=wh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),OW=kv?function(e,t){return kv(e,"toString",{configurable:!0,enumerable:!1,value:PW(t),writable:!0})}:hC,IL=AW(OW);function DW(e,t){for(var o=-1,c=e==null?0:e.length;++o<c&&t(e[o],o,e)!==!1;);return e}function AL(e,t,o,c){for(var d=e.length,y=o+-1;++y<d;)if(t(e[y],y,e))return y;return-1}function RW(e){return e!==e}function zW(e,t,o){for(var c=o-1,d=e.length;++c<d;)if(e[c]===t)return c;return-1}function LW(e,t,o){return t===t?zW(e,t,o):AL(e,RW,o)}function $W(e,t){var o=e==null?0:e.length;return!!o&&LW(e,t,0)>-1}function PL(e,t,o){t=="__proto__"&&kv?kv(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}var FW=Object.prototype,BW=FW.hasOwnProperty;function OL(e,t,o){var c=e[t];(!(BW.call(e,t)&&W2(c,o))||o===void 0&&!(t in e))&&PL(e,t,o)}function I_(e,t,o,c){var d=!o;o||(o={});for(var y=-1,w=t.length;++y<w;){var i=t[y],O=void 0;O===void 0&&(O=e[i]),d?PL(o,i,O):OL(o,i,O)}return o}var i3=Math.max;function DL(e,t,o){return t=i3(t===void 0?e.length-1:t,0),function(){for(var c=arguments,d=-1,y=i3(c.length-t,0),w=Array(y);++d<y;)w[d]=c[t+d];d=-1;for(var i=Array(t+1);++d<t;)i[d]=c[d];return i[t]=o(w),CW(e,this,i)}}function kW(e,t){return IL(DL(e,t,hC),e+"")}function NW(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var VW=Object.prototype,jW=VW.hasOwnProperty;function UW(e){if(!vc(e))return NW(e);var t=xx(e),o=[];for(var c in e)c=="constructor"&&(t||!jW.call(e,c))||o.push(c);return o}function fC(e){return T_(e)?Kz(e,!0):UW(e)}var HW=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,GW=/^\w*$/;function pC(e,t){if(vs(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||Ix(e)?!0:GW.test(e)||!HW.test(e)||t!=null&&e in Object(t)}var WW="Expected a function";function mC(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(WW);var o=function(){var c=arguments,d=t?t.apply(this,c):c[0],y=o.cache;if(y.has(d))return y.get(d);var w=e.apply(this,c);return o.cache=y.set(d,w)||y,w};return o.cache=new(mC.Cache||Mc),o}mC.Cache=Mc;var qW=500;function ZW(e){var t=mC(e,function(c){return o.size===qW&&o.clear(),c}),o=t.cache;return t}var YW=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,XW=/\\(\\)?/g,KW=ZW(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(YW,function(o,c,d,y){t.push(d?y.replace(XW,"$1"):c||o)}),t});function JW(e){return e==null?"":ML(e)}function Ax(e,t){return vs(e)?e:pC(e,t)?[e]:KW(JW(e))}var QW=1/0;function A_(e){if(typeof e=="string"||Ix(e))return e;var t=e+"";return t=="0"&&1/e==-QW?"-0":t}function gC(e,t){t=Ax(t,e);for(var o=0,c=t.length;e!=null&&o<c;)e=e[A_(t[o++])];return o&&o==c?e:void 0}function eq(e,t,o){var c=e==null?void 0:gC(e,t);return c===void 0?o:c}var o3=ys?ys.isConcatSpreadable:void 0;function tq(e){return vs(e)||vx(e)||!!(o3&&e&&e[o3])}function nq(e,t,o,c,d){var y=-1,w=e.length;for(o||(o=tq),d||(d=[]);++y<w;){var i=e[y];o(i)?q2(d,i):d[d.length]=i}return d}function rq(e){var t=e==null?0:e.length;return t?nq(e):[]}function iq(e){return IL(DL(e,void 0,rq),e+"")}var _C=Jz(Object.getPrototypeOf,Object),oq="[object Object]",aq=Function.prototype,sq=Object.prototype,RL=aq.toString,lq=sq.hasOwnProperty,cq=RL.call(Object);function zL(e){if(!Il(e)||xh(e)!=oq)return!1;var t=_C(e);if(t===null)return!0;var o=lq.call(t,"constructor")&&t.constructor;return typeof o=="function"&&o instanceof o&&RL.call(o)==cq}function uq(e,t,o){var c=-1,d=e.length;t<0&&(t=-t>d?0:d+t),o=o>d?d:o,o<0&&(o+=d),d=t>o?0:o-t>>>0,t>>>=0;for(var y=Array(d);++c<d;)y[c]=e[c+t];return y}function dq(e,t){return e&&I_(t,E_(t),e)}function hq(e,t){return e&&I_(t,fC(t),e)}var LL=typeof ka=="object"&&ka&&!ka.nodeType&&ka,a3=LL&&typeof Na=="object"&&Na&&!Na.nodeType&&Na,fq=a3&&a3.exports===LL,s3=fq?Xs.Buffer:void 0,l3=s3?s3.allocUnsafe:void 0;function pq(e,t){if(t)return e.slice();var o=e.length,c=l3?l3(o):new e.constructor(o);return e.copy(c),c}function mq(e,t){return I_(e,Z2(e),t)}var gq=Object.getOwnPropertySymbols,$L=gq?function(e){for(var t=[];e;)q2(t,Z2(e)),e=_C(e);return t}:Wz;function _q(e,t){return I_(e,$L(e),t)}function FL(e){return Gz(e,fC,$L)}var yq=Object.prototype,vq=yq.hasOwnProperty;function xq(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&vq.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function yC(e){var t=new e.constructor(e.byteLength);return new $v(t).set(new $v(e)),t}function bq(e,t){var o=t?yC(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var wq=/\w*$/;function Sq(e){var t=new e.constructor(e.source,wq.exec(e));return t.lastIndex=e.lastIndex,t}var c3=ys?ys.prototype:void 0,u3=c3?c3.valueOf:void 0;function Cq(e){return u3?Object(u3.call(e)):{}}function Tq(e,t){var o=t?yC(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var Eq="[object Boolean]",Mq="[object Date]",Iq="[object Map]",Aq="[object Number]",Pq="[object RegExp]",Oq="[object Set]",Dq="[object String]",Rq="[object Symbol]",zq="[object ArrayBuffer]",Lq="[object DataView]",$q="[object Float32Array]",Fq="[object Float64Array]",Bq="[object Int8Array]",kq="[object Int16Array]",Nq="[object Int32Array]",Vq="[object Uint8Array]",jq="[object Uint8ClampedArray]",Uq="[object Uint16Array]",Hq="[object Uint32Array]";function Gq(e,t,o){var c=e.constructor;switch(t){case zq:return yC(e);case Eq:case Mq:return new c(+e);case Lq:return bq(e,o);case $q:case Fq:case Bq:case kq:case Nq:case Vq:case jq:case Uq:case Hq:return Tq(e,o);case Iq:return new c;case Aq:case Dq:return new c(e);case Pq:return Sq(e);case Oq:return new c;case Rq:return Cq(e)}}function Wq(e){return typeof e.constructor=="function"&&!xx(e)?SW(_C(e)):{}}var qq="[object Map]";function Zq(e){return Il(e)&&hs(e)==qq}var d3=dp&&dp.isMap,Yq=d3?X2(d3):Zq,Xq="[object Set]";function Kq(e){return Il(e)&&hs(e)==Xq}var h3=dp&&dp.isSet,Jq=h3?X2(h3):Kq,Qq=1,eZ=2,tZ=4,BL="[object Arguments]",nZ="[object Array]",rZ="[object Boolean]",iZ="[object Date]",oZ="[object Error]",kL="[object Function]",aZ="[object GeneratorFunction]",sZ="[object Map]",lZ="[object Number]",NL="[object Object]",cZ="[object RegExp]",uZ="[object Set]",dZ="[object String]",hZ="[object Symbol]",fZ="[object WeakMap]",pZ="[object ArrayBuffer]",mZ="[object DataView]",gZ="[object Float32Array]",_Z="[object Float64Array]",yZ="[object Int8Array]",vZ="[object Int16Array]",xZ="[object Int32Array]",bZ="[object Uint8Array]",wZ="[object Uint8ClampedArray]",SZ="[object Uint16Array]",CZ="[object Uint32Array]",Ci={};Ci[BL]=Ci[nZ]=Ci[pZ]=Ci[mZ]=Ci[rZ]=Ci[iZ]=Ci[gZ]=Ci[_Z]=Ci[yZ]=Ci[vZ]=Ci[xZ]=Ci[sZ]=Ci[lZ]=Ci[NL]=Ci[cZ]=Ci[uZ]=Ci[dZ]=Ci[hZ]=Ci[bZ]=Ci[wZ]=Ci[SZ]=Ci[CZ]=!0;Ci[oZ]=Ci[kL]=Ci[fZ]=!1;function Wg(e,t,o,c,d,y){var w,i=t&Qq,O=t&eZ,L=t&tZ;if(o&&(w=d?o(e,c,d,y):o(e)),w!==void 0)return w;if(!vc(e))return e;var z=vs(e);if(z){if(w=xq(e),!i)return TW(e,w)}else{var F=hs(e),N=F==kL||F==aZ;if(g_(e))return pq(e,i);if(F==NL||F==BL||N&&!d){if(w=O||N?{}:Wq(e),!i)return O?_q(e,hq(w,e)):mq(e,dq(w,e))}else{if(!Ci[F])return d?e:{};w=Gq(e,F,i)}}y||(y=new Tl);var G=y.get(e);if(G)return G;y.set(e,w),Jq(e)?e.forEach(function(J){w.add(Wg(J,t,o,J,e,y))}):Yq(e)&&e.forEach(function(J,X){w.set(X,Wg(J,t,o,X,e,y))});var Y=L?O?FL:fS:O?fC:E_,K=z?void 0:Y(e);return DW(K||e,function(J,X){K&&(X=J,J=e[X]),OL(w,X,Wg(J,t,o,X,e,y))}),w}var TZ=1,EZ=4;function ev(e){return Wg(e,TZ|EZ)}var MZ=1,IZ=2;function AZ(e,t,o,c){var d=o.length,y=d;if(e==null)return!y;for(e=Object(e);d--;){var w=o[d];if(w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++d<y;){w=o[d];var i=w[0],O=e[i],L=w[1];if(w[2]){if(O===void 0&&!(i in e))return!1}else{var z=new Tl,F;if(!(F===void 0?bx(L,O,MZ|IZ,c,z):F))return!1}}return!0}function VL(e){return e===e&&!vc(e)}function PZ(e){for(var t=E_(e),o=t.length;o--;){var c=t[o],d=e[c];t[o]=[c,d,VL(d)]}return t}function jL(e,t){return function(o){return o==null?!1:o[e]===t&&(t!==void 0||e in Object(o))}}function OZ(e){var t=PZ(e);return t.length==1&&t[0][2]?jL(t[0][0],t[0][1]):function(o){return o===e||AZ(o,e,t)}}function DZ(e,t){return e!=null&&t in Object(e)}function RZ(e,t,o){t=Ax(t,e);for(var c=-1,d=t.length,y=!1;++c<d;){var w=A_(t[c]);if(!(y=e!=null&&o(e,w)))break;e=e[w]}return y||++c!=d?y:(d=e==null?0:e.length,!!d&&Y2(d)&&Yz(w,d)&&(vs(e)||vx(e)))}function zZ(e,t){return e!=null&&RZ(e,t,DZ)}var LZ=1,$Z=2;function FZ(e,t){return pC(e)&&VL(t)?jL(A_(e),t):function(o){var c=eq(o,e);return c===void 0&&c===t?zZ(o,e):bx(t,c,LZ|$Z)}}function BZ(e){return function(t){return t==null?void 0:t[e]}}function kZ(e){return function(t){return gC(t,e)}}function NZ(e){return pC(e)?BZ(A_(e)):kZ(e)}function UL(e){return typeof e=="function"?e:e==null?hC:typeof e=="object"?vs(e)?FZ(e[0],e[1]):OZ(e):NZ(e)}var gw=function(){return Xs.Date.now()},VZ="Expected a function",jZ=Math.max,UZ=Math.min;function HZ(e,t,o){var c,d,y,w,i,O,L=0,z=!1,F=!1,N=!0;if(typeof e!="function")throw new TypeError(VZ);t=CS(t)||0,vc(o)&&(z=!!o.leading,F="maxWait"in o,y=F?jZ(CS(o.maxWait)||0,t):y,N="trailing"in o?!!o.trailing:N);function G(ge){var ee=c,be=d;return c=d=void 0,L=ge,w=e.apply(be,ee),w}function Y(ge){return L=ge,i=setTimeout(X,t),z?G(ge):w}function K(ge){var ee=ge-O,be=ge-L,Ie=t-ee;return F?UZ(Ie,y-be):Ie}function J(ge){var ee=ge-O,be=ge-L;return O===void 0||ee>=t||ee<0||F&&be>=y}function X(){var ge=gw();if(J(ge))return se(ge);i=setTimeout(X,K(ge))}function se(ge){return i=void 0,N&&c?G(ge):(c=d=void 0,w)}function te(){i!==void 0&&clearTimeout(i),L=0,c=O=d=i=void 0}function ne(){return i===void 0?w:se(gw())}function ue(){var ge=gw(),ee=J(ge);if(c=arguments,d=this,O=ge,ee){if(i===void 0)return Y(O);if(F)return clearTimeout(i),i=setTimeout(X,t),G(O)}return i===void 0&&(i=setTimeout(X,t)),w}return ue.cancel=te,ue.flush=ne,ue}function GZ(e){return Il(e)&&T_(e)}function WZ(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function qZ(e){return function(t,o,c){var d=Object(t);if(!T_(t)){var y=UL(o);t=E_(t),o=function(i){return y(d[i],i,d)}}var w=e(t,o,c);return w>-1?d[y?t[w]:w]:void 0}}var ZZ=Math.max;function YZ(e,t,o){var c=e==null?0:e.length;if(!c)return-1;var d=o==null?0:wW(o);return d<0&&(d=ZZ(c+d,0)),AL(e,UL(t),d)}var XZ=qZ(YZ),KZ=Math.min;function JZ(e,t,o){for(var c=$W,d=e[0].length,y=e.length,w=y,i=Array(y),O=1/0,L=[];w--;){var z=e[w];O=KZ(z.length,O),i[w]=d>=120&&z.length>=120?new m_(w&&z):void 0}z=e[0];var F=-1,N=i[0];e:for(;++F<d&&L.length<O;){var G=z[F],Y=G;if(G=G!==0?G:0,!(N?hS(N,Y):c(L,Y))){for(w=y;--w;){var K=i[w];if(!(K?hS(K,Y):c(e[w],Y)))continue e}N&&N.push(Y),L.push(G)}}return L}function QZ(e){return GZ(e)?e:[]}var eY=kW(function(e){var t=dC(e,QZ);return t.length&&t[0]===e[0]?JZ(t):[]});function tY(e,t){return t.length<2?e:gC(e,uq(t,0,-1))}var nY="[object Map]",rY="[object Set]",iY=Object.prototype,oY=iY.hasOwnProperty;function HL(e){if(e==null)return!0;if(T_(e)&&(vs(e)||typeof e=="string"||typeof e.splice=="function"||g_(e)||K2(e)||vx(e)))return!e.length;var t=hs(e);if(t==nY||t==rY)return!e.size;if(xx(e))return!Qz(e).length;for(var o in e)if(oY.call(e,o))return!1;return!0}function aY(e,t){return t=Ax(t,e),e=tY(e,t),e==null||delete e[A_(WZ(t))]}function sY(e){return zL(e)?void 0:e}var lY=1,cY=2,uY=4,dY=iq(function(e,t){var o={};if(e==null)return o;var c=!1;t=dC(t,function(y){return y=Ax(y,e),c||(c=y.length>1),y}),I_(e,FL(e),o),c&&(o=Wg(o,lY|cY|uY,sY));for(var d=t.length;d--;)aY(o,t[d]);return o});const hY=()=>({compactSize:String,compactDirection:wt.oneOf(Tu("horizontal","vertical")).def("horizontal"),isFirstItem:Cr(),isLastItem:Cr()}),Px=uC(null),vC=(e,t)=>{const o=Px.useInject(),c=He(()=>{if(!o||HL(o))return"";const{compactDirection:d,isFirstItem:y,isLastItem:w}=o,i=d==="vertical"?"-vertical-":"-";return hn({[`${e.value}-compact${i}item`]:!0,[`${e.value}-compact${i}first-item`]:y,[`${e.value}-compact${i}last-item`]:w,[`${e.value}-compact${i}item-rtl`]:t.value==="rtl"})});return{compactSize:He(()=>o==null?void 0:o.compactSize),compactDirection:He(()=>o==null?void 0:o.compactDirection),compactItemClassnames:c}},f3=cn({name:"NoCompactStyle",setup(e,t){let{slots:o}=t;return Px.useProvide(null),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}}),fY=()=>({prefixCls:String,size:{type:String},direction:wt.oneOf(Tu("horizontal","vertical")).def("horizontal"),align:wt.oneOf(Tu("start","end","center","baseline")),block:{type:Boolean,default:void 0}}),pY=cn({name:"CompactItem",props:hY(),setup(e,t){let{slots:o}=t;return Px.useProvide(e),()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}});fY();const mY=e=>({animationDuration:e,animationFillMode:"both"}),gY=e=>({animationDuration:e,animationFillMode:"both"}),Ox=function(e,t,o,c){const y=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${y}${e}-enter,
      ${y}${e}-appear
    `]:re(re({},mY(c)),{animationPlayState:"paused"}),[`${y}${e}-leave`]:re(re({},gY(c)),{animationPlayState:"paused"}),[`
      ${y}${e}-enter${e}-enter-active,
      ${y}${e}-appear${e}-appear-active
    `]:{animationName:t,animationPlayState:"running"},[`${y}${e}-leave${e}-leave-active`]:{animationName:o,animationPlayState:"running",pointerEvents:"none"}}},_Y=new xr("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),yY=new xr("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),vY=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:o}=e,c=`${o}-fade`,d=t?"&":"";return[Ox(c,_Y,yY,e.motionDurationMid,t),{[`
        ${d}${c}-enter,
        ${d}${c}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${d}${c}-leave`]:{animationTimingFunction:"linear"}}]},xY=new xr("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),bY=new xr("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),wY=new xr("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),SY=new xr("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),CY=new xr("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),TY=new xr("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),EY=new xr("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),MY=new xr("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),IY={"move-up":{inKeyframes:EY,outKeyframes:MY},"move-down":{inKeyframes:xY,outKeyframes:bY},"move-left":{inKeyframes:wY,outKeyframes:SY},"move-right":{inKeyframes:CY,outKeyframes:TY}},p3=(e,t)=>{const{antCls:o}=e,c=`${o}-${t}`,{inKeyframes:d,outKeyframes:y}=IY[t];return[Ox(c,d,y,e.motionDurationMid),{[`
        ${c}-enter,
        ${c}-appear
      `]:{opacity:0,animationTimingFunction:e.motionEaseOutCirc},[`${c}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},GL=new xr("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),WL=new xr("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),qL=new xr("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),ZL=new xr("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),AY=new xr("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),PY=new xr("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),OY=new xr("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),DY=new xr("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),RY={"slide-up":{inKeyframes:GL,outKeyframes:WL},"slide-down":{inKeyframes:qL,outKeyframes:ZL},"slide-left":{inKeyframes:AY,outKeyframes:PY},"slide-right":{inKeyframes:OY,outKeyframes:DY}},m3=(e,t)=>{const{antCls:o}=e,c=`${o}-${t}`,{inKeyframes:d,outKeyframes:y}=RY[t];return[Ox(c,d,y,e.motionDurationMid),{[`
      ${c}-enter,
      ${c}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint},[`${c}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},xC=new xr("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),zY=new xr("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),g3=new xr("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),_3=new xr("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),LY=new xr("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),$Y=new xr("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),FY=new xr("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),BY=new xr("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),kY=new xr("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),NY=new xr("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),VY=new xr("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),jY=new xr("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),UY={zoom:{inKeyframes:xC,outKeyframes:zY},"zoom-big":{inKeyframes:g3,outKeyframes:_3},"zoom-big-fast":{inKeyframes:g3,outKeyframes:_3},"zoom-left":{inKeyframes:FY,outKeyframes:BY},"zoom-right":{inKeyframes:kY,outKeyframes:NY},"zoom-up":{inKeyframes:LY,outKeyframes:$Y},"zoom-down":{inKeyframes:VY,outKeyframes:jY}},bC=(e,t)=>{const{antCls:o}=e,c=`${o}-${t}`,{inKeyframes:d,outKeyframes:y}=UY[t];return[Ox(c,d,y,t==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${c}-enter,
        ${c}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${c}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},YL=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),y3=e=>{const{controlPaddingHorizontal:t}=e;return{position:"relative",display:"block",minHeight:e.controlHeight,padding:`${(e.controlHeight-e.fontSize*e.lineHeight)/2}px ${t}px`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,boxSizing:"border-box"}},HY=e=>{const{antCls:t,componentCls:o}=e,c=`${o}-item`;return[{[`${o}-dropdown`]:re(re({},Ei(e)),{position:"absolute",top:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",padding:e.paddingXXS,overflow:"hidden",fontSize:e.fontSize,fontVariant:"initial",backgroundColor:e.colorBgElevated,borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary,[`
            &${t}-slide-up-enter${t}-slide-up-enter-active${o}-dropdown-placement-bottomLeft,
            &${t}-slide-up-appear${t}-slide-up-appear-active${o}-dropdown-placement-bottomLeft
          `]:{animationName:GL},[`
            &${t}-slide-up-enter${t}-slide-up-enter-active${o}-dropdown-placement-topLeft,
            &${t}-slide-up-appear${t}-slide-up-appear-active${o}-dropdown-placement-topLeft
          `]:{animationName:qL},[`&${t}-slide-up-leave${t}-slide-up-leave-active${o}-dropdown-placement-bottomLeft`]:{animationName:WL},[`&${t}-slide-up-leave${t}-slide-up-leave-active${o}-dropdown-placement-topLeft`]:{animationName:ZL},"&-hidden":{display:"none"},"&-empty":{color:e.colorTextDisabled},[`${c}-empty`]:re(re({},y3(e)),{color:e.colorTextDisabled}),[`${c}`]:re(re({},y3(e)),{cursor:"pointer",transition:`background ${e.motionDurationSlow} ease`,borderRadius:e.borderRadiusSM,"&-group":{color:e.colorTextDescription,fontSize:e.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":re({flex:"auto"},Rv),"&-state":{flex:"none"},[`&-active:not(${c}-option-disabled)`]:{backgroundColor:e.controlItemBgHover},[`&-selected:not(${c}-option-disabled)`]:{color:e.colorText,fontWeight:e.fontWeightStrong,backgroundColor:e.controlItemBgActive,[`${c}-option-state`]:{color:e.colorPrimary}},"&-disabled":{[`&${c}-option-selected`]:{backgroundColor:e.colorBgContainerDisabled},color:e.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:e.controlPaddingHorizontal*2}}}),"&-rtl":{direction:"rtl"}})},m3(e,"slide-up"),m3(e,"slide-down"),p3(e,"move-up"),p3(e,"move-down")]},$f=2;function XL(e){let{controlHeightSM:t,controlHeight:o,lineWidth:c}=e;const d=(o-t)/2-c,y=Math.ceil(d/2);return[d,y]}function _w(e,t){const{componentCls:o,iconCls:c}=e,d=`${o}-selection-overflow`,y=e.controlHeightSM,[w]=XL(e),i=t?`${o}-${t}`:"";return{[`${o}-multiple${i}`]:{fontSize:e.fontSize,[d]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"}},[`${o}-selector`]:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:`${w-$f}px ${$f*2}px`,borderRadius:e.borderRadius,[`${o}-show-search&`]:{cursor:"text"},[`${o}-disabled&`]:{background:e.colorBgContainerDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${$f}px 0`,lineHeight:`${y}px`,content:'"\\a0"'}},[`
        &${o}-show-arrow ${o}-selector,
        &${o}-allow-clear ${o}-selector
      `]:{paddingInlineEnd:e.fontSizeIcon+e.controlPaddingHorizontal},[`${o}-selection-item`]:{position:"relative",display:"flex",flex:"none",boxSizing:"border-box",maxWidth:"100%",height:y,marginTop:$f,marginBottom:$f,lineHeight:`${y-e.lineWidth*2}px`,background:e.colorFillSecondary,border:`${e.lineWidth}px solid ${e.colorSplit}`,borderRadius:e.borderRadiusSM,cursor:"default",transition:`font-size ${e.motionDurationSlow}, line-height ${e.motionDurationSlow}, height ${e.motionDurationSlow}`,userSelect:"none",marginInlineEnd:$f*2,paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS/2,[`${o}-disabled&`]:{color:e.colorTextDisabled,borderColor:e.colorBorder,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:e.paddingXS/2,overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":re(re({},fx()),{display:"inline-block",color:e.colorIcon,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${c}`]:{verticalAlign:"-0.2em"},"&:hover":{color:e.colorIconHover}})},[`${d}-item + ${d}-item`]:{[`${o}-selection-search`]:{marginInlineStart:0}},[`${o}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:e.inputPaddingHorizontalBase-w,"\n          &-input,\n          &-mirror\n        ":{height:y,fontFamily:e.fontFamily,lineHeight:`${y}px`,transition:`all ${e.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${o}-selection-placeholder `]:{position:"absolute",top:"50%",insetInlineStart:e.inputPaddingHorizontalBase,insetInlineEnd:e.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${e.motionDurationSlow}`}}}}function GY(e){const{componentCls:t}=e,o=Wr(e,{controlHeight:e.controlHeightSM,controlHeightSM:e.controlHeightXS,borderRadius:e.borderRadiusSM,borderRadiusSM:e.borderRadiusXS}),[,c]=XL(e);return[_w(e),_w(o,"sm"),{[`${t}-multiple${t}-sm`]:{[`${t}-selection-placeholder`]:{insetInlineStart:e.controlPaddingHorizontalSM-e.lineWidth,insetInlineEnd:"auto"},[`${t}-selection-search`]:{marginInlineStart:c}}},_w(Wr(e,{fontSize:e.fontSizeLG,controlHeight:e.controlHeightLG,controlHeightSM:e.controlHeight,borderRadius:e.borderRadiusLG,borderRadiusSM:e.borderRadius}),"lg")]}function yw(e,t){const{componentCls:o,inputPaddingHorizontalBase:c,borderRadius:d}=e,y=e.controlHeight-e.lineWidth*2,w=Math.ceil(e.fontSize*1.25),i=t?`${o}-${t}`:"";return{[`${o}-single${i}`]:{fontSize:e.fontSize,[`${o}-selector`]:re(re({},Ei(e)),{display:"flex",borderRadius:d,[`${o}-selection-search`]:{position:"absolute",top:0,insetInlineStart:c,insetInlineEnd:c,bottom:0,"&-input":{width:"100%"}},[`
          ${o}-selection-item,
          ${o}-selection-placeholder
        `]:{padding:0,lineHeight:`${y}px`,transition:`all ${e.motionDurationSlow}`,"@supports (-moz-appearance: meterbar)":{lineHeight:`${y}px`}},[`${o}-selection-item`]:{position:"relative",userSelect:"none"},[`${o}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${o}-selection-item:after`,`${o}-selection-placeholder:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${o}-show-arrow ${o}-selection-item,
        &${o}-show-arrow ${o}-selection-placeholder
      `]:{paddingInlineEnd:w},[`&${o}-open ${o}-selection-item`]:{color:e.colorTextPlaceholder},[`&:not(${o}-customize-input)`]:{[`${o}-selector`]:{width:"100%",height:e.controlHeight,padding:`0 ${c}px`,[`${o}-selection-search-input`]:{height:y},"&:after":{lineHeight:`${y}px`}}},[`&${o}-customize-input`]:{[`${o}-selector`]:{"&:after":{display:"none"},[`${o}-selection-search`]:{position:"static",width:"100%"},[`${o}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${c}px`,"&:after":{display:"none"}}}}}}}function WY(e){const{componentCls:t}=e,o=e.controlPaddingHorizontalSM-e.lineWidth;return[yw(e),yw(Wr(e,{controlHeight:e.controlHeightSM,borderRadius:e.borderRadiusSM}),"sm"),{[`${t}-single${t}-sm`]:{[`&:not(${t}-customize-input)`]:{[`${t}-selection-search`]:{insetInlineStart:o,insetInlineEnd:o},[`${t}-selector`]:{padding:`0 ${o}px`},[`&${t}-show-arrow ${t}-selection-search`]:{insetInlineEnd:o+e.fontSize*1.5},[`
            &${t}-show-arrow ${t}-selection-item,
            &${t}-show-arrow ${t}-selection-placeholder
          `]:{paddingInlineEnd:e.fontSize*1.5}}}},yw(Wr(e,{controlHeight:e.controlHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG}),"lg")]}function qY(e,t,o){const{focusElCls:c,focus:d,borderElCls:y}=o,w=y?"> *":"",i=["hover",d?"focus":null,"active"].filter(Boolean).map(O=>`&:${O} ${w}`).join(",");return{[`&-item:not(${t}-last-item)`]:{marginInlineEnd:-e.lineWidth},"&-item":re(re({[i]:{zIndex:2}},c?{[`&${c}`]:{zIndex:2}}:{}),{[`&[disabled] ${w}`]:{zIndex:0}})}}function ZY(e,t,o){const{borderElCls:c}=o,d=c?`> ${c}`:"";return{[`&-item:not(${t}-first-item):not(${t}-last-item) ${d}`]:{borderRadius:0},[`&-item:not(${t}-last-item)${t}-first-item`]:{[`& ${d}, &${e}-sm ${d}, &${e}-lg ${d}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${t}-first-item)${t}-last-item`]:{[`& ${d}, &${e}-sm ${d}, &${e}-lg ${d}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function wC(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:o}=e,c=`${o}-compact`;return{[c]:re(re({},qY(e,c,t)),ZY(o,c,t))}}const YY=e=>{const{componentCls:t}=e;return{position:"relative",backgroundColor:e.colorBgContainer,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,input:{cursor:"pointer"},[`${t}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit"}},[`${t}-disabled&`]:{color:e.colorTextDisabled,background:e.colorBgContainerDisabled,cursor:"not-allowed",[`${t}-multiple&`]:{background:e.colorBgContainerDisabled},input:{cursor:"not-allowed"}}}},vw=function(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{componentCls:c,borderHoverColor:d,outlineColor:y,antCls:w}=t,i=o?{[`${c}-selector`]:{borderColor:d}}:{};return{[e]:{[`&:not(${c}-disabled):not(${c}-customize-input):not(${w}-pagination-size-changer)`]:re(re({},i),{[`${c}-focused& ${c}-selector`]:{borderColor:d,boxShadow:`0 0 0 ${t.controlOutlineWidth}px ${y}`,borderInlineEndWidth:`${t.controlLineWidth}px !important`,outline:0},[`&:hover ${c}-selector`]:{borderColor:d,borderInlineEndWidth:`${t.controlLineWidth}px !important`}})}}},XY=e=>{const{componentCls:t}=e;return{[`${t}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none","&::-webkit-search-cancel-button":{display:"none","-webkit-appearance":"none"}}}},KY=e=>{const{componentCls:t,inputPaddingHorizontalBase:o,iconCls:c}=e;return{[t]:re(re({},Ei(e)),{position:"relative",display:"inline-block",cursor:"pointer",[`&:not(${t}-customize-input) ${t}-selector`]:re(re({},YY(e)),XY(e)),[`${t}-selection-item`]:re({flex:1,fontWeight:"normal"},Rv),[`${t}-selection-placeholder`]:re(re({},Rv),{flex:1,color:e.colorTextPlaceholder,pointerEvents:"none"}),[`${t}-arrow`]:re(re({},fx()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:o,height:e.fontSizeIcon,marginTop:-e.fontSizeIcon/2,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",[c]:{verticalAlign:"top",transition:`transform ${e.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${t}-suffix)`]:{pointerEvents:"auto"}},[`${t}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${t}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:o,zIndex:1,display:"inline-block",width:e.fontSizeIcon,height:e.fontSizeIcon,marginTop:-e.fontSizeIcon/2,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",background:e.colorBgContainer,cursor:"pointer",opacity:0,transition:`color ${e.motionDurationMid} ease, opacity ${e.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:e.colorTextTertiary}},"&:hover":{[`${t}-clear`]:{opacity:1}}}),[`${t}-has-feedback`]:{[`${t}-clear`]:{insetInlineEnd:o+e.fontSize+e.paddingXXS}}}},JY=e=>{const{componentCls:t}=e;return[{[t]:{[`&-borderless ${t}-selector`]:{backgroundColor:"transparent !important",borderColor:"transparent !important",boxShadow:"none !important"},[`&${t}-in-form-item`]:{width:"100%"}}},KY(e),WY(e),GY(e),HY(e),{[`${t}-rtl`]:{direction:"rtl"}},vw(t,Wr(e,{borderHoverColor:e.colorPrimaryHover,outlineColor:e.controlOutline})),vw(`${t}-status-error`,Wr(e,{borderHoverColor:e.colorErrorHover,outlineColor:e.colorErrorOutline}),!0),vw(`${t}-status-warning`,Wr(e,{borderHoverColor:e.colorWarningHover,outlineColor:e.colorWarningOutline}),!0),wC(e,{borderElCls:`${t}-selector`,focusElCls:`${t}-focused`})]},QY=Ui("Select",(e,t)=>{let{rootPrefixCls:o}=t;const c=Wr(e,{rootPrefixCls:o,inputPaddingHorizontalBase:e.paddingSM-1});return[JY(c)]},e=>({zIndexPopup:e.zIndexPopupBase+50})),KL=()=>re(re({},co(yL(),["inputIcon","mode","getInputElement","getRawInputElement","backfill"])),{value:Mo([Array,Object,String,Number]),defaultValue:Mo([Array,Object,String,Number]),notFoundContent:wt.any,suffixIcon:wt.any,itemIcon:wt.any,size:Io(),mode:Io(),bordered:Cr(!0),transitionName:String,choiceTransitionName:Io(""),popupClassName:String,dropdownClassName:String,placement:Io(),status:Io(),"onUpdate:value":Jr()}),v3="SECRET_COMBOBOX_MODE_DO_NOT_USE",_a=cn({compatConfig:{MODE:3},name:"ASelect",Option:iC,OptGroup:oC,inheritAttrs:!1,props:Wo(KL(),{listHeight:256,listItemHeight:24}),SECRET_COMBOBOX_MODE_DO_NOT_USE:v3,slots:Object,setup(e,t){let{attrs:o,emit:c,slots:d,expose:y}=t;const w=tn(),i=Ic(),O=xs.useInject(),L=He(()=>Mx(O.status,e.status)),z=()=>{var Lt;(Lt=w.value)===null||Lt===void 0||Lt.focus()},F=()=>{var Lt;(Lt=w.value)===null||Lt===void 0||Lt.blur()},N=Lt=>{var It;(It=w.value)===null||It===void 0||It.scrollTo(Lt)},G=He(()=>{const{mode:Lt}=e;if(Lt!=="combobox")return Lt===v3?"combobox":Lt}),{prefixCls:Y,direction:K,configProvider:J,renderEmpty:X,size:se,getPrefixCls:te,getPopupContainer:ne,disabled:ue,select:ge}=Rr("select",e),{compactSize:ee,compactItemClassnames:be}=vC(Y,K),Ie=He(()=>ee.value||se.value),Ee=yc(),Re=He(()=>{var Lt;return(Lt=ue.value)!==null&&Lt!==void 0?Lt:Ee.value}),[Qe,et]=QY(Y),We=He(()=>te()),me=He(()=>e.placement!==void 0?e.placement:K.value==="rtl"?"bottomRight":"bottomLeft"),Oe=He(()=>gh(We.value,q7(me.value),e.transitionName)),Fe=He(()=>hn({[`${Y.value}-lg`]:Ie.value==="large",[`${Y.value}-sm`]:Ie.value==="small",[`${Y.value}-rtl`]:K.value==="rtl",[`${Y.value}-borderless`]:!e.bordered,[`${Y.value}-in-form-item`]:O.isFormItemInput},Qf(Y.value,L.value,O.hasFeedback),be.value,et.value)),Ke=function(){for(var Lt=arguments.length,It=new Array(Lt),_n=0;_n<Lt;_n++)It[_n]=arguments[_n];c("update:value",It[0]),c("change",...It),i.onFieldChange()},$e=Lt=>{c("blur",Lt),i.onFieldBlur()};y({blur:F,focus:z,scrollTo:N});const pt=He(()=>G.value==="multiple"||G.value==="tags"),Ct=He(()=>e.showArrow!==void 0?e.showArrow:e.loading||!(pt.value||G.value==="combobox"));return()=>{var Lt,It,_n,Ut;const{notFoundContent:ln,listHeight:xn=256,listItemHeight:En=24,popupClassName:Nt,dropdownClassName:_e,virtual:Ft,dropdownMatchSelectWidth:Ve,id:Ye=i.id.value,placeholder:je=(Lt=d.placeholder)===null||Lt===void 0?void 0:Lt.call(d),showArrow:Mt}=e,{hasFeedback:Pt,feedbackIcon:qt}=O;let zt;ln!==void 0?zt=ln:d.notFoundContent?zt=d.notFoundContent():G.value==="combobox"?zt=null:zt=(X==null?void 0:X("Select"))||le(L2,{componentName:"Select"},null);const{suffixIcon:Kt,itemIcon:an,removeIcon:un,clearIcon:Nn}=oW(re(re({},e),{multiple:pt.value,prefixCls:Y.value,hasFeedback:Pt,feedbackIcon:qt,showArrow:Ct.value}),d),Sn=co(e,["prefixCls","suffixIcon","itemIcon","removeIcon","clearIcon","size","bordered","status"]),Qt=hn(Nt||_e,{[`${Y.value}-dropdown-${K.value}`]:K.value==="rtl"},et.value);return Qe(le(fG,it(it(it({ref:w,virtual:Ft,dropdownMatchSelectWidth:Ve},Sn),o),{},{showSearch:(It=e.showSearch)!==null&&It!==void 0?It:(_n=ge==null?void 0:ge.value)===null||_n===void 0?void 0:_n.showSearch,placeholder:je,listHeight:xn,listItemHeight:En,mode:G.value,prefixCls:Y.value,direction:K.value,inputIcon:Kt,menuItemSelectedIcon:an,removeIcon:un,clearIcon:Nn,notFoundContent:zt,class:[Fe.value,o.class],getPopupContainer:ne==null?void 0:ne.value,dropdownClassName:Qt,onChange:Ke,onBlur:$e,id:Ye,dropdownRender:Sn.dropdownRender||d.dropdownRender,transitionName:Oe.value,children:(Ut=d.default)===null||Ut===void 0?void 0:Ut.call(d),tagRender:e.tagRender||d.tagRender,optionLabelRender:d.optionLabel,maxTagPlaceholder:e.maxTagPlaceholder||d.maxTagPlaceholder,showArrow:Pt||Mt,disabled:Re.value}),{option:d.option}))}}});_a.install=function(e){return e.component(_a.name,_a),e.component(_a.Option.displayName,_a.Option),e.component(_a.OptGroup.displayName,_a.OptGroup),e};const eX=_a.Option;_a.OptGroup;const ah=()=>null;ah.isSelectOption=!0;ah.displayName="AAutoCompleteOption";const qg=()=>null;qg.isSelectOptGroup=!0;qg.displayName="AAutoCompleteOptGroup";function tX(e){var t,o;return((t=e==null?void 0:e.type)===null||t===void 0?void 0:t.isSelectOption)||((o=e==null?void 0:e.type)===null||o===void 0?void 0:o.isSelectOptGroup)}const nX=()=>re(re({},co(KL(),["loading","mode","optionLabelProp","labelInValue"])),{dataSource:Array,dropdownMenuStyle:{type:Object,default:void 0},dropdownMatchSelectWidth:{type:[Number,Boolean],default:!0},prefixCls:String,showSearch:{type:Boolean,default:void 0},transitionName:String,choiceTransitionName:{type:String,default:"zoom"},autofocus:{type:Boolean,default:void 0},backfill:{type:Boolean,default:void 0},filterOption:{type:[Boolean,Function],default:!1},defaultActiveFirstOption:{type:Boolean,default:!0},status:String}),xw=cn({compatConfig:{MODE:3},name:"AAutoComplete",inheritAttrs:!1,props:nX(),slots:Object,setup(e,t){let{slots:o,attrs:c,expose:d}=t;Ou(!e.dropdownClassName);const y=tn(),w=()=>{var z;const F=vo((z=o.default)===null||z===void 0?void 0:z.call(o));return F.length?F[0]:void 0};d({focus:()=>{var z;(z=y.value)===null||z===void 0||z.focus()},blur:()=>{var z;(z=y.value)===null||z===void 0||z.blur()}});const{prefixCls:L}=Rr("select",e);return()=>{var z,F,N;const{size:G,dataSource:Y,notFoundContent:K=(z=o.notFoundContent)===null||z===void 0?void 0:z.call(o)}=e;let J;const{class:X}=c,se={[X]:!!X,[`${L.value}-lg`]:G==="large",[`${L.value}-sm`]:G==="small",[`${L.value}-show-search`]:!0,[`${L.value}-auto-complete`]:!0};if(e.options===void 0){const ne=((F=o.dataSource)===null||F===void 0?void 0:F.call(o))||((N=o.options)===null||N===void 0?void 0:N.call(o))||[];ne.length&&tX(ne[0])?J=ne:J=Y?Y.map(ue=>{if(Tc(ue))return ue;switch(typeof ue){case"string":return le(ah,{key:ue,value:ue},{default:()=>[ue]});case"object":return le(ah,{key:ue.value,value:ue.value},{default:()=>[ue.text]});default:throw new Error("AutoComplete[dataSource] only supports type `string[] | Object[]`.")}}):[]}const te=co(re(re(re({},e),c),{mode:_a.SECRET_COMBOBOX_MODE_DO_NOT_USE,getInputElement:w,notFoundContent:K,class:se,popupClassName:e.popupClassName||e.dropdownClassName,ref:y}),["dataSource","loading"]);return le(_a,te,it({default:()=>[J]},co(o,["default","dataSource","options"])))}}}),rX=re(xw,{Option:ah,OptGroup:qg,install(e){return e.component(xw.name,xw),e.component(ah.displayName,ah),e.component(qg.displayName,qg),e}});var iX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};function x3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){oX(e,d,o[d])})}return e}function oX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var SC=function(t,o){var c=x3({},t,o.attrs);return le(Hi,x3({},c,{icon:iX}),null)};SC.displayName="CheckCircleOutlined";SC.inheritAttrs=!1;var aX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};function b3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){sX(e,d,o[d])})}return e}function sX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var CC=function(t,o){var c=b3({},t,o.attrs);return le(Hi,b3({},c,{icon:aX}),null)};CC.displayName="ExclamationCircleOutlined";CC.inheritAttrs=!1;var lX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};function w3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){cX(e,d,o[d])})}return e}function cX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var TC=function(t,o){var c=w3({},t,o.attrs);return le(Hi,w3({},c,{icon:lX}),null)};TC.displayName="InfoCircleOutlined";TC.inheritAttrs=!1;var uX={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};function S3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){dX(e,d,o[d])})}return e}function dX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var EC=function(t,o){var c=S3({},t,o.attrs);return le(Hi,S3({},c,{icon:uX}),null)};EC.displayName="CloseCircleOutlined";EC.inheritAttrs=!1;var hX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};function C3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){fX(e,d,o[d])})}return e}function fX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var zu=function(t,o){var c=C3({},t,o.attrs);return le(Hi,C3({},c,{icon:hX}),null)};zu.displayName="CheckCircleFilled";zu.inheritAttrs=!1;var pX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"};function T3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){mX(e,d,o[d])})}return e}function mX(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Lu=function(t,o){var c=T3({},t,o.attrs);return le(Hi,T3({},c,{icon:pX}),null)};Lu.displayName="ExclamationCircleFilled";Lu.inheritAttrs=!1;var gX={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"};function E3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){_X(e,d,o[d])})}return e}function _X(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Sh=function(t,o){var c=E3({},t,o.attrs);return le(Hi,E3({},c,{icon:gX}),null)};Sh.displayName="InfoCircleFilled";Sh.inheritAttrs=!1;const Gf=["xxxl","xxl","xl","lg","md","sm","xs"],yX=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`,xxxl:`{min-width: ${e.screenXXXL}px}`});function JL(){const[,e]=gp();return He(()=>{const t=yX(e.value),o=new Map;let c=-1,d={};return{matchHandlers:{},dispatch(y){return d=y,o.forEach(w=>w(d)),o.size>=1},subscribe(y){return o.size||this.register(),c+=1,o.set(c,y),y(d),c},unsubscribe(y){o.delete(y),o.size||this.unregister()},unregister(){Object.keys(t).forEach(y=>{const w=t[y],i=this.matchHandlers[w];i==null||i.mql.removeListener(i==null?void 0:i.listener)}),o.clear()},register(){Object.keys(t).forEach(y=>{const w=t[y],i=L=>{let{matches:z}=L;this.dispatch(re(re({},d),{[y]:z}))},O=window.matchMedia(w);O.addListener(i),this.matchHandlers[w]={mql:O,listener:i},i(O)})},responsiveMap:t}})}const ls={adjustX:1,adjustY:1},cs=[0,0],QL={left:{points:["cr","cl"],overflow:ls,offset:[-4,0],targetOffset:cs},right:{points:["cl","cr"],overflow:ls,offset:[4,0],targetOffset:cs},top:{points:["bc","tc"],overflow:ls,offset:[0,-4],targetOffset:cs},bottom:{points:["tc","bc"],overflow:ls,offset:[0,4],targetOffset:cs},topLeft:{points:["bl","tl"],overflow:ls,offset:[0,-4],targetOffset:cs},leftTop:{points:["tr","tl"],overflow:ls,offset:[-4,0],targetOffset:cs},topRight:{points:["br","tr"],overflow:ls,offset:[0,-4],targetOffset:cs},rightTop:{points:["tl","tr"],overflow:ls,offset:[4,0],targetOffset:cs},bottomRight:{points:["tr","br"],overflow:ls,offset:[0,4],targetOffset:cs},rightBottom:{points:["bl","br"],overflow:ls,offset:[4,0],targetOffset:cs},bottomLeft:{points:["tl","bl"],overflow:ls,offset:[0,4],targetOffset:cs},leftBottom:{points:["br","bl"],overflow:ls,offset:[-4,0],targetOffset:cs}},vX={prefixCls:String,id:String,overlayInnerStyle:wt.any},xX=cn({compatConfig:{MODE:3},name:"TooltipContent",props:vX,setup(e,t){let{slots:o}=t;return()=>{var c;return le("div",{class:`${e.prefixCls}-inner`,id:e.id,role:"tooltip",style:e.overlayInnerStyle},[(c=o.overlay)===null||c===void 0?void 0:c.call(o)])}}});var bX=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};function M3(){}const wX=cn({compatConfig:{MODE:3},name:"Tooltip",inheritAttrs:!1,props:{trigger:wt.any.def(["hover"]),defaultVisible:{type:Boolean,default:void 0},visible:{type:Boolean,default:void 0},placement:wt.string.def("right"),transitionName:String,animation:wt.any,afterVisibleChange:wt.func.def(()=>{}),overlayStyle:{type:Object,default:void 0},overlayClassName:String,prefixCls:wt.string.def("rc-tooltip"),mouseEnterDelay:wt.number.def(.1),mouseLeaveDelay:wt.number.def(.1),getPopupContainer:Function,destroyTooltipOnHide:{type:Boolean,default:!1},align:wt.object.def(()=>({})),arrowContent:wt.any.def(null),tipId:String,builtinPlacements:wt.object,overlayInnerStyle:{type:Object,default:void 0},popupVisible:{type:Boolean,default:void 0},onVisibleChange:Function,onPopupAlign:Function,arrow:{type:Boolean,default:!0}},setup(e,t){let{slots:o,attrs:c,expose:d}=t;const y=Xt(),w=()=>{const{prefixCls:z,tipId:F,overlayInnerStyle:N}=e;return[e.arrow?le("div",{class:`${z}-arrow`,key:"arrow"},[DR(o,e,"arrowContent")]):null,le(xX,{key:"content",prefixCls:z,id:F,overlayInnerStyle:N},{overlay:o.overlay})]};d({getPopupDomNode:()=>y.value.getPopupDomNode(),triggerDOM:y,forcePopupAlign:()=>{var z;return(z=y.value)===null||z===void 0?void 0:z.forcePopupAlign()}});const O=Xt(!1),L=Xt(!1);return Ii(()=>{const{destroyTooltipOnHide:z}=e;if(typeof z=="boolean")O.value=z;else if(z&&typeof z=="object"){const{keepParent:F}=z;O.value=F===!0,L.value=F===!1}}),()=>{const{overlayClassName:z,trigger:F,mouseEnterDelay:N,mouseLeaveDelay:G,overlayStyle:Y,prefixCls:K,afterVisibleChange:J,transitionName:X,animation:se,placement:te,align:ne,destroyTooltipOnHide:ue,defaultVisible:ge}=e,ee=bX(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","afterVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible"]),be=re({},ee);e.visible!==void 0&&(be.popupVisible=e.visible);const Ie=re(re(re({popupClassName:z,prefixCls:K,action:F,builtinPlacements:QL,popupPlacement:te,popupAlign:ne,afterPopupVisibleChange:J,popupTransitionName:X,popupAnimation:se,defaultPopupVisible:ge,destroyPopupOnHide:O.value,autoDestroy:L.value,mouseLeaveDelay:G,popupStyle:Y,mouseEnterDelay:N},be),c),{onPopupVisibleChange:e.onVisibleChange||M3,onPopupAlign:e.onPopupAlign||M3,ref:y,arrow:!!e.arrow,popup:w()});return le(rL,Ie,{default:o.default})}}}),e4=()=>({trigger:[String,Array],open:{type:Boolean,default:void 0},visible:{type:Boolean,default:void 0},placement:String,color:String,transitionName:String,overlayStyle:oi(),overlayInnerStyle:oi(),overlayClassName:String,openClassName:String,prefixCls:String,mouseEnterDelay:Number,mouseLeaveDelay:Number,getPopupContainer:Function,arrowPointAtCenter:{type:Boolean,default:void 0},arrow:{type:[Boolean,Object],default:!0},autoAdjustOverflow:{type:[Boolean,Object],default:void 0},destroyTooltipOnHide:{type:Boolean,default:void 0},align:oi(),builtinPlacements:oi(),children:Array,onVisibleChange:Function,"onUpdate:visible":Function,onOpenChange:Function,"onUpdate:open":Function}),SX={adjustX:1,adjustY:1},I3={adjustX:0,adjustY:0},CX=[0,0];function A3(e){return typeof e=="boolean"?e?SX:I3:re(re({},I3),e)}function TX(e){const{arrowWidth:t=4,horizontalArrowShift:o=16,verticalArrowShift:c=8,autoAdjustOverflow:d,arrowPointAtCenter:y}=e,w={left:{points:["cr","cl"],offset:[-4,0]},right:{points:["cl","cr"],offset:[4,0]},top:{points:["bc","tc"],offset:[0,-4]},bottom:{points:["tc","bc"],offset:[0,4]},topLeft:{points:["bl","tc"],offset:[-(o+t),-4]},leftTop:{points:["tr","cl"],offset:[-4,-(c+t)]},topRight:{points:["br","tc"],offset:[o+t,-4]},rightTop:{points:["tl","cr"],offset:[4,-(c+t)]},bottomRight:{points:["tr","bc"],offset:[o+t,4]},rightBottom:{points:["bl","cr"],offset:[4,c+t]},bottomLeft:{points:["tl","bc"],offset:[-(o+t),4]},leftBottom:{points:["br","cl"],offset:[-4,c+t]}};return Object.keys(w).forEach(i=>{w[i]=y?re(re({},w[i]),{overflow:A3(d),targetOffset:CX}):re(re({},QL[i]),{overflow:A3(d)}),w[i].ignoreShake=!0}),w}function t4(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];for(let t=0,o=e.length;t<o;t++)if(e[t]!==void 0)return e[t]}const EX=u_.map(e=>`${e}-inverse`),MX=["success","processing","error","default","warning"];function Dx(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[...EX,...u_].includes(e):u_.includes(e)}function IX(e){return MX.includes(e)}function AX(e,t){const o=Dx(t),c=hn({[`${e}-${t}`]:t&&o}),d={},y={};return t&&!o&&(d.background=t,y["--antd-arrow-background-color"]=t),{className:c,overlayStyle:d,arrowStyle:y}}function Oy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.map(o=>`${t}${o}`).join(",")}const n4=8;function PX(e){const t=n4,{sizePopupArrow:o,contentRadius:c,borderRadiusOuter:d,limitVerticalRadius:y}=e,w=o/2-Math.ceil(d*(Math.sqrt(2)-1)),i=(c>12?c+2:12)-w,O=y?t-w:i;return{dropdownArrowOffset:i,dropdownArrowOffsetVertical:O}}function r4(e,t){const{componentCls:o,sizePopupArrow:c,marginXXS:d,borderRadiusXS:y,borderRadiusOuter:w,boxShadowPopoverArrow:i}=e,{colorBg:O,showArrowCls:L,contentRadius:z=e.borderRadiusLG,limitVerticalRadius:F}=t,{dropdownArrowOffsetVertical:N,dropdownArrowOffset:G}=PX({sizePopupArrow:c,contentRadius:z,borderRadiusOuter:w,limitVerticalRadius:F}),Y=c/2+d;return{[o]:{[`${o}-arrow`]:[re(re({position:"absolute",zIndex:1,display:"block"},q8(c,y,w,O,i)),{"&:before":{background:O}})],[[`&-placement-top ${o}-arrow`,`&-placement-topLeft ${o}-arrow`,`&-placement-topRight ${o}-arrow`].join(",")]:{bottom:0,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:G}},[`&-placement-topRight ${o}-arrow`]:{right:{_skip_check_:!0,value:G}},[[`&-placement-bottom ${o}-arrow`,`&-placement-bottomLeft ${o}-arrow`,`&-placement-bottomRight ${o}-arrow`].join(",")]:{top:0,transform:"translateY(-100%)"},[`&-placement-bottom ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:G}},[`&-placement-bottomRight ${o}-arrow`]:{right:{_skip_check_:!0,value:G}},[[`&-placement-left ${o}-arrow`,`&-placement-leftTop ${o}-arrow`,`&-placement-leftBottom ${o}-arrow`].join(",")]:{right:{_skip_check_:!0,value:0},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${o}-arrow`]:{top:N},[`&-placement-leftBottom ${o}-arrow`]:{bottom:N},[[`&-placement-right ${o}-arrow`,`&-placement-rightTop ${o}-arrow`,`&-placement-rightBottom ${o}-arrow`].join(",")]:{left:{_skip_check_:!0,value:0},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${o}-arrow`]:{top:N},[`&-placement-rightBottom ${o}-arrow`]:{bottom:N},[Oy(["&-placement-topLeft","&-placement-top","&-placement-topRight"].map(K=>K+=":not(&-arrow-hidden)"),L)]:{paddingBottom:Y},[Oy(["&-placement-bottomLeft","&-placement-bottom","&-placement-bottomRight"].map(K=>K+=":not(&-arrow-hidden)"),L)]:{paddingTop:Y},[Oy(["&-placement-leftTop","&-placement-left","&-placement-leftBottom"].map(K=>K+=":not(&-arrow-hidden)"),L)]:{paddingRight:{_skip_check_:!0,value:Y}},[Oy(["&-placement-rightTop","&-placement-right","&-placement-rightBottom"].map(K=>K+=":not(&-arrow-hidden)"),L)]:{paddingLeft:{_skip_check_:!0,value:Y}}}}}const OX=e=>{const{componentCls:t,tooltipMaxWidth:o,tooltipColor:c,tooltipBg:d,tooltipBorderRadius:y,zIndexPopup:w,controlHeight:i,boxShadowSecondary:O,paddingSM:L,paddingXS:z,tooltipRadiusOuter:F}=e;return[{[t]:re(re(re(re({},Ei(e)),{position:"absolute",zIndex:w,display:"block","&":[{width:"max-content"},{width:"intrinsic"}],maxWidth:o,visibility:"visible","&-hidden":{display:"none"},"--antd-arrow-background-color":d,[`${t}-inner`]:{minWidth:i,minHeight:i,padding:`${L/2}px ${z}px`,color:c,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:d,borderRadius:y,boxShadow:O},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${t}-inner`]:{borderRadius:Math.min(y,n4)}},[`${t}-content`]:{position:"relative"}}),Dv(e,(N,G)=>{let{darkColor:Y}=G;return{[`&${t}-${N}`]:{[`${t}-inner`]:{backgroundColor:Y},[`${t}-arrow`]:{"--antd-arrow-background-color":Y}}}})),{"&-rtl":{direction:"rtl"}})},r4(Wr(e,{borderRadiusOuter:F}),{colorBg:"var(--antd-arrow-background-color)",showArrowCls:"",contentRadius:y,limitVerticalRadius:!0}),{[`${t}-pure`]:{position:"relative",maxWidth:"none"}}]},DX=(e,t)=>Ui("Tooltip",c=>{if((t==null?void 0:t.value)===!1)return[];const{borderRadius:d,colorTextLightSolid:y,colorBgDefault:w,borderRadiusOuter:i}=c,O=Wr(c,{tooltipMaxWidth:250,tooltipColor:y,tooltipBorderRadius:d,tooltipBg:w,tooltipRadiusOuter:i>4?4:i});return[OX(O),bC(c,"zoom-big-fast")]},c=>{let{zIndexPopupBase:d,colorBgSpotlight:y}=c;return{zIndexPopup:d+70,colorBgDefault:y}})(e),RX=(e,t)=>{const o={},c=re({},e);return t.forEach(d=>{e&&d in e&&(o[d]=e[d],delete c[d])}),{picked:o,omitted:c}},i4=()=>re(re({},e4()),{title:wt.any}),zX=()=>({trigger:"hover",align:{},placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0}),LX=cn({compatConfig:{MODE:3},name:"ATooltip",inheritAttrs:!1,props:Wo(i4(),{trigger:"hover",align:{},placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0}),slots:Object,setup(e,t){let{slots:o,emit:c,attrs:d,expose:y}=t;const{prefixCls:w,getPopupContainer:i,direction:O,rootPrefixCls:L}=Rr("tooltip",e),z=He(()=>{var Ee;return(Ee=e.open)!==null&&Ee!==void 0?Ee:e.visible}),F=tn(t4([e.open,e.visible])),N=tn();let G;On(z,Ee=>{qr.cancel(G),G=qr(()=>{F.value=!!Ee})});const Y=()=>{var Ee;const Re=(Ee=e.title)!==null&&Ee!==void 0?Ee:o.title;return!Re&&Re!==0},K=Ee=>{const Re=Y();z.value===void 0&&(F.value=Re?!1:Ee),Re||(c("update:visible",Ee),c("visibleChange",Ee),c("update:open",Ee),c("openChange",Ee))};y({getPopupDomNode:()=>N.value.getPopupDomNode(),open:F,forcePopupAlign:()=>{var Ee;return(Ee=N.value)===null||Ee===void 0?void 0:Ee.forcePopupAlign()}});const X=He(()=>{var Ee;const{builtinPlacements:Re,autoAdjustOverflow:Qe,arrow:et,arrowPointAtCenter:We}=e;let me=We;return typeof et=="object"&&(me=(Ee=et.pointAtCenter)!==null&&Ee!==void 0?Ee:We),Re||TX({arrowPointAtCenter:me,autoAdjustOverflow:Qe})}),se=Ee=>Ee||Ee==="",te=Ee=>{const Re=Ee.type;if(typeof Re=="object"&&Ee.props&&((Re.__ANT_BUTTON===!0||Re==="button")&&se(Ee.props.disabled)||Re.__ANT_SWITCH===!0&&(se(Ee.props.disabled)||se(Ee.props.loading))||Re.__ANT_RADIO===!0&&se(Ee.props.disabled))){const{picked:Qe,omitted:et}=RX(OR(Ee),["position","left","right","top","bottom","float","display","zIndex"]),We=re(re({display:"inline-block"},Qe),{cursor:"not-allowed",lineHeight:1,width:Ee.props&&Ee.props.block?"100%":void 0}),me=re(re({},et),{pointerEvents:"none"}),Oe=xo(Ee,{style:me},!0);return le("span",{style:We,class:`${w.value}-disabled-compatible-wrapper`},[Oe])}return Ee},ne=()=>{var Ee,Re;return(Ee=e.title)!==null&&Ee!==void 0?Ee:(Re=o.title)===null||Re===void 0?void 0:Re.call(o)},ue=(Ee,Re)=>{const Qe=X.value,et=Object.keys(Qe).find(We=>{var me,Oe;return Qe[We].points[0]===((me=Re.points)===null||me===void 0?void 0:me[0])&&Qe[We].points[1]===((Oe=Re.points)===null||Oe===void 0?void 0:Oe[1])});if(et){const We=Ee.getBoundingClientRect(),me={top:"50%",left:"50%"};et.indexOf("top")>=0||et.indexOf("Bottom")>=0?me.top=`${We.height-Re.offset[1]}px`:(et.indexOf("Top")>=0||et.indexOf("bottom")>=0)&&(me.top=`${-Re.offset[1]}px`),et.indexOf("left")>=0||et.indexOf("Right")>=0?me.left=`${We.width-Re.offset[0]}px`:(et.indexOf("right")>=0||et.indexOf("Left")>=0)&&(me.left=`${-Re.offset[0]}px`),Ee.style.transformOrigin=`${me.left} ${me.top}`}},ge=He(()=>AX(w.value,e.color)),ee=He(()=>d["data-popover-inject"]),[be,Ie]=DX(w,He(()=>!ee.value));return()=>{var Ee,Re;const{openClassName:Qe,overlayClassName:et,overlayStyle:We,overlayInnerStyle:me}=e;let Oe=(Re=ms((Ee=o.default)===null||Ee===void 0?void 0:Ee.call(o)))!==null&&Re!==void 0?Re:null;Oe=Oe.length===1?Oe[0]:Oe;let Fe=F.value;if(z.value===void 0&&Y()&&(Fe=!1),!Oe)return null;const Ke=te(Tc(Oe)&&!dV(Oe)?Oe:le("span",null,[Oe])),$e=hn({[Qe||`${w.value}-open`]:!0,[Ke.props&&Ke.props.class]:Ke.props&&Ke.props.class}),pt=hn(et,{[`${w.value}-rtl`]:O.value==="rtl"},ge.value.className,Ie.value),Ct=re(re({},ge.value.overlayStyle),me),Lt=ge.value.arrowStyle,It=re(re(re({},d),e),{prefixCls:w.value,arrow:!!e.arrow,getPopupContainer:i==null?void 0:i.value,builtinPlacements:X.value,visible:Fe,ref:N,overlayClassName:pt,overlayStyle:re(re({},Lt),We),overlayInnerStyle:Ct,onVisibleChange:K,onPopupAlign:ue,transitionName:gh(L.value,"zoom-big-fast",e.transitionName)});return be(le(wX,It,{default:()=>[F.value?xo(Ke,{class:$e}):Ke],arrowContent:()=>le("span",{class:`${w.value}-arrow-content`},null),overlay:ne}))}}}),MC=Pl(LX),$X=e=>{const{componentCls:t,popoverBg:o,popoverColor:c,width:d,fontWeightStrong:y,popoverPadding:w,boxShadowSecondary:i,colorTextHeading:O,borderRadiusLG:L,zIndexPopup:z,marginXS:F,colorBgElevated:N}=e;return[{[t]:re(re({},Ei(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:z,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--antd-arrow-background-color":N,"&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:o,backgroundClip:"padding-box",borderRadius:L,boxShadow:i,padding:w},[`${t}-title`]:{minWidth:d,marginBottom:F,color:O,fontWeight:y},[`${t}-inner-content`]:{color:c}})},r4(e,{colorBg:"var(--antd-arrow-background-color)"}),{[`${t}-pure`]:{position:"relative",maxWidth:"none",[`${t}-content`]:{display:"inline-block"}}}]},FX=e=>{const{componentCls:t}=e;return{[t]:u_.map(o=>{const c=e[`${o}-6`];return{[`&${t}-${o}`]:{"--antd-arrow-background-color":c,[`${t}-inner`]:{backgroundColor:c},[`${t}-arrow`]:{background:"transparent"}}}})}},BX=e=>{const{componentCls:t,lineWidth:o,lineType:c,colorSplit:d,paddingSM:y,controlHeight:w,fontSize:i,lineHeight:O,padding:L}=e,z=w-Math.round(i*O),F=z/2,N=z/2-o,G=L;return{[t]:{[`${t}-inner`]:{padding:0},[`${t}-title`]:{margin:0,padding:`${F}px ${G}px ${N}px`,borderBottom:`${o}px ${c} ${d}`},[`${t}-inner-content`]:{padding:`${y}px ${G}px`}}}},kX=Ui("Popover",e=>{const{colorBgElevated:t,colorText:o,wireframe:c}=e,d=Wr(e,{popoverBg:t,popoverColor:o,popoverPadding:12});return[$X(d),FX(d),c&&BX(d),bC(d,"zoom-big")]},e=>{let{zIndexPopupBase:t}=e;return{zIndexPopup:t+30,width:177}}),NX=()=>re(re({},e4()),{content:La(),title:La()}),VX=cn({compatConfig:{MODE:3},name:"APopover",inheritAttrs:!1,props:Wo(NX(),re(re({},zX()),{trigger:"hover",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1})),setup(e,t){let{expose:o,slots:c,attrs:d}=t;const y=tn();Ou(e.visible===void 0),o({getPopupDomNode:()=>{var N,G;return(G=(N=y.value)===null||N===void 0?void 0:N.getPopupDomNode)===null||G===void 0?void 0:G.call(N)}});const{prefixCls:w,configProvider:i}=Rr("popover",e),[O,L]=kX(w),z=He(()=>i.getPrefixCls()),F=()=>{var N,G;const{title:Y=ms((N=c.title)===null||N===void 0?void 0:N.call(c)),content:K=ms((G=c.content)===null||G===void 0?void 0:G.call(c))}=e,J=!!(Array.isArray(Y)?Y.length:Y),X=!!(Array.isArray(K)?K.length:Y);return!J&&!X?null:le(hr,null,[J&&le("div",{class:`${w.value}-title`},[Y]),le("div",{class:`${w.value}-inner-content`},[K])])};return()=>{const N=hn(e.overlayClassName,L.value);return O(le(MC,it(it(it({},co(e,["title","content"])),d),{},{prefixCls:w.value,ref:y,overlayClassName:N,transitionName:gh(z.value,"zoom-big",e.transitionName),"data-popover-inject":!0}),{title:F,default:c.default}))}}}),jX=Pl(VX);function P3(e){let{prefixCls:t,value:o,current:c,offset:d=0}=e,y;return d&&(y={position:"absolute",top:`${d}00%`,left:0}),le("p",{style:y,class:hn(`${t}-only-unit`,{current:c})},[o])}function UX(e,t,o){let c=e,d=0;for(;(c+10)%10!==t;)c+=o,d+=o;return d}const HX=cn({compatConfig:{MODE:3},name:"SingleNumber",props:{prefixCls:String,value:String,count:Number},setup(e){const t=He(()=>Number(e.value)),o=He(()=>Math.abs(e.count)),c=no({prevValue:t.value,prevCount:o.value}),d=()=>{c.prevValue=t.value,c.prevCount=o.value},y=tn();return On(t,()=>{clearTimeout(y.value),y.value=setTimeout(()=>{d()},1e3)},{flush:"post"}),Cc(()=>{clearTimeout(y.value)}),()=>{let w,i={};const O=t.value;if(c.prevValue===O||Number.isNaN(O)||Number.isNaN(c.prevValue))w=[P3(re(re({},e),{current:!0}))],i={transition:"none"};else{w=[];const L=O+10,z=[];for(let G=O;G<=L;G+=1)z.push(G);const F=z.findIndex(G=>G%10===c.prevValue);w=z.map((G,Y)=>{const K=G%10;return P3(re(re({},e),{value:K,offset:Y-F,current:Y===F}))});const N=c.prevCount<o.value?1:-1;i={transform:`translateY(${-UX(c.prevValue,O,N)}00%)`}}return le("span",{class:`${e.prefixCls}-only`,style:i,onTransitionend:()=>d()},[w])}}});var GX=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const WX={prefixCls:String,count:wt.any,component:String,title:wt.any,show:Boolean},qX=cn({compatConfig:{MODE:3},name:"ScrollNumber",inheritAttrs:!1,props:WX,setup(e,t){let{attrs:o,slots:c}=t;const{prefixCls:d}=Rr("scroll-number",e);return()=>{var y;const w=re(re({},e),o),{prefixCls:i,count:O,title:L,show:z,component:F="sup",class:N,style:G}=w,Y=GX(w,["prefixCls","count","title","show","component","class","style"]),K=re(re({},Y),{style:G,"data-show":e.show,class:hn(d.value,N),title:L});let J=O;if(O&&Number(O)%1===0){const se=String(O).split("");J=se.map((te,ne)=>le(HX,{prefixCls:d.value,count:Number(O),value:te,key:se.length-ne},null))}G&&G.borderColor&&(K.style=re(re({},G),{boxShadow:`0 0 0 1px ${G.borderColor} inset`}));const X=ms((y=c.default)===null||y===void 0?void 0:y.call(c));return X&&X.length?xo(X,{class:hn(`${d.value}-custom-component`)},!1):le(F,K,{default:()=>[J]})}}}),ZX=new xr("antStatusProcessing",{"0%":{transform:"scale(0.8)",opacity:.5},"100%":{transform:"scale(2.4)",opacity:0}}),YX=new xr("antZoomBadgeIn",{"0%":{transform:"scale(0) translate(50%, -50%)",opacity:0},"100%":{transform:"scale(1) translate(50%, -50%)"}}),XX=new xr("antZoomBadgeOut",{"0%":{transform:"scale(1) translate(50%, -50%)"},"100%":{transform:"scale(0) translate(50%, -50%)",opacity:0}}),KX=new xr("antNoWrapperZoomBadgeIn",{"0%":{transform:"scale(0)",opacity:0},"100%":{transform:"scale(1)"}}),JX=new xr("antNoWrapperZoomBadgeOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)",opacity:0}}),QX=new xr("antBadgeLoadingCircle",{"0%":{transformOrigin:"50%"},"100%":{transform:"translate(50%, -50%) rotate(360deg)",transformOrigin:"50%"}}),eK=e=>{const{componentCls:t,iconCls:o,antCls:c,badgeFontHeight:d,badgeShadowSize:y,badgeHeightSm:w,motionDurationSlow:i,badgeStatusSize:O,marginXS:L,badgeRibbonOffset:z}=e,F=`${c}-scroll-number`,N=`${c}-ribbon`,G=`${c}-ribbon-wrapper`,Y=Dv(e,(J,X)=>{let{darkColor:se}=X;return{[`&${t} ${t}-color-${J}`]:{background:se,[`&:not(${t}-count)`]:{color:se}}}}),K=Dv(e,(J,X)=>{let{darkColor:se}=X;return{[`&${N}-color-${J}`]:{background:se,color:se}}});return{[t]:re(re(re(re({},Ei(e)),{position:"relative",display:"inline-block",width:"fit-content",lineHeight:1,[`${t}-count`]:{zIndex:e.badgeZIndex,minWidth:e.badgeHeight,height:e.badgeHeight,color:e.badgeTextColor,fontWeight:e.badgeFontWeight,fontSize:e.badgeFontSize,lineHeight:`${e.badgeHeight}px`,whiteSpace:"nowrap",textAlign:"center",background:e.badgeColor,borderRadius:e.badgeHeight/2,boxShadow:`0 0 0 ${y}px ${e.badgeShadowColor}`,transition:`background ${e.motionDurationMid}`,a:{color:e.badgeTextColor},"a:hover":{color:e.badgeTextColor},"a:hover &":{background:e.badgeColorHover}},[`${t}-count-sm`]:{minWidth:w,height:w,fontSize:e.badgeFontSizeSm,lineHeight:`${w}px`,borderRadius:w/2},[`${t}-multiple-words`]:{padding:`0 ${e.paddingXS}px`},[`${t}-dot`]:{zIndex:e.badgeZIndex,width:e.badgeDotSize,minWidth:e.badgeDotSize,height:e.badgeDotSize,background:e.badgeColor,borderRadius:"100%",boxShadow:`0 0 0 ${y}px ${e.badgeShadowColor}`},[`${t}-dot${F}`]:{transition:`background ${i}`},[`${t}-count, ${t}-dot, ${F}-custom-component`]:{position:"absolute",top:0,insetInlineEnd:0,transform:"translate(50%, -50%)",transformOrigin:"100% 0%",[`&${o}-spin`]:{animationName:QX,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&${t}-status`]:{lineHeight:"inherit",verticalAlign:"baseline",[`${t}-status-dot`]:{position:"relative",top:-1,display:"inline-block",width:O,height:O,verticalAlign:"middle",borderRadius:"50%"},[`${t}-status-success`]:{backgroundColor:e.colorSuccess},[`${t}-status-processing`]:{overflow:"visible",color:e.colorPrimary,backgroundColor:e.colorPrimary,"&::after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderWidth:y,borderStyle:"solid",borderColor:"inherit",borderRadius:"50%",animationName:ZX,animationDuration:e.badgeProcessingDuration,animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",content:'""'}},[`${t}-status-default`]:{backgroundColor:e.colorTextPlaceholder},[`${t}-status-error`]:{backgroundColor:e.colorError},[`${t}-status-warning`]:{backgroundColor:e.colorWarning},[`${t}-status-text`]:{marginInlineStart:L,color:e.colorText,fontSize:e.fontSize}}}),Y),{[`${t}-zoom-appear, ${t}-zoom-enter`]:{animationName:YX,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`${t}-zoom-leave`]:{animationName:XX,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`&${t}-not-a-wrapper`]:{[`${t}-zoom-appear, ${t}-zoom-enter`]:{animationName:KX,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`${t}-zoom-leave`]:{animationName:JX,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`&:not(${t}-status)`]:{verticalAlign:"middle"},[`${F}-custom-component, ${t}-count`]:{transform:"none"},[`${F}-custom-component, ${F}`]:{position:"relative",top:"auto",display:"block",transformOrigin:"50% 50%"}},[`${F}`]:{overflow:"hidden",[`${F}-only`]:{position:"relative",display:"inline-block",height:e.badgeHeight,transition:`all ${e.motionDurationSlow} ${e.motionEaseOutBack}`,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden",[`> p${F}-only-unit`]:{height:e.badgeHeight,margin:0,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden"}},[`${F}-symbol`]:{verticalAlign:"top"}},"&-rtl":{direction:"rtl",[`${t}-count, ${t}-dot, ${F}-custom-component`]:{transform:"translate(-50%, -50%)"}}}),[`${G}`]:{position:"relative"},[`${N}`]:re(re(re(re({},Ei(e)),{position:"absolute",top:L,padding:`0 ${e.paddingXS}px`,color:e.colorPrimary,lineHeight:`${d}px`,whiteSpace:"nowrap",backgroundColor:e.colorPrimary,borderRadius:e.borderRadiusSM,[`${N}-text`]:{color:e.colorTextLightSolid},[`${N}-corner`]:{position:"absolute",top:"100%",width:z,height:z,color:"currentcolor",border:`${z/2}px solid`,transform:e.badgeRibbonCornerTransform,transformOrigin:"top",filter:e.badgeRibbonCornerFilter}}),K),{[`&${N}-placement-end`]:{insetInlineEnd:-z,borderEndEndRadius:0,[`${N}-corner`]:{insetInlineEnd:0,borderInlineEndColor:"transparent",borderBlockEndColor:"transparent"}},[`&${N}-placement-start`]:{insetInlineStart:-z,borderEndStartRadius:0,[`${N}-corner`]:{insetInlineStart:0,borderBlockEndColor:"transparent",borderInlineStartColor:"transparent"}},"&-rtl":{direction:"rtl"}})}},o4=Ui("Badge",e=>{const{fontSize:t,lineHeight:o,fontSizeSM:c,lineWidth:d,marginXS:y,colorBorderBg:w}=e,i=Math.round(t*o),O=d,L="auto",z=i-2*O,F=e.colorBgContainer,N="normal",G=c,Y=e.colorError,K=e.colorErrorHover,J=t,X=c/2,se=c,te=c/2,ne=Wr(e,{badgeFontHeight:i,badgeShadowSize:O,badgeZIndex:L,badgeHeight:z,badgeTextColor:F,badgeFontWeight:N,badgeFontSize:G,badgeColor:Y,badgeColorHover:K,badgeShadowColor:w,badgeHeightSm:J,badgeDotSize:X,badgeFontSizeSm:se,badgeStatusSize:te,badgeProcessingDuration:"1.2s",badgeRibbonOffset:y,badgeRibbonCornerTransform:"scaleY(0.75)",badgeRibbonCornerFilter:"brightness(75%)"});return[eK(ne)]});var tK=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const nK=()=>({prefix:String,color:{type:String},text:wt.any,placement:{type:String,default:"end"}}),TS=cn({compatConfig:{MODE:3},name:"ABadgeRibbon",inheritAttrs:!1,props:nK(),slots:Object,setup(e,t){let{attrs:o,slots:c}=t;const{prefixCls:d,direction:y}=Rr("ribbon",e),[w,i]=o4(d),O=He(()=>Dx(e.color,!1)),L=He(()=>[d.value,`${d.value}-placement-${e.placement}`,{[`${d.value}-rtl`]:y.value==="rtl",[`${d.value}-color-${e.color}`]:O.value}]);return()=>{var z,F;const{class:N,style:G}=o,Y=tK(o,["class","style"]),K={},J={};return e.color&&!O.value&&(K.background=e.color,J.color=e.color),w(le("div",it({class:`${d.value}-wrapper ${i.value}`},Y),[(z=c.default)===null||z===void 0?void 0:z.call(c),le("div",{class:[L.value,N,i.value],style:re(re({},K),G)},[le("span",{class:`${d.value}-text`},[e.text||((F=c.text)===null||F===void 0?void 0:F.call(c))]),le("div",{class:`${d.value}-corner`,style:J},null)])]))}}}),rK=e=>!isNaN(parseFloat(e))&&isFinite(e),iK=()=>({count:wt.any.def(null),showZero:{type:Boolean,default:void 0},overflowCount:{type:Number,default:99},dot:{type:Boolean,default:void 0},prefixCls:String,scrollNumberPrefixCls:String,status:{type:String},size:{type:String,default:"default"},color:String,text:wt.any,offset:Array,numberStyle:{type:Object,default:void 0},title:String}),tv=cn({compatConfig:{MODE:3},name:"ABadge",Ribbon:TS,inheritAttrs:!1,props:iK(),slots:Object,setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d,direction:y}=Rr("badge",e),[w,i]=o4(d),O=He(()=>e.count>e.overflowCount?`${e.overflowCount}+`:e.count),L=He(()=>O.value==="0"||O.value===0),z=He(()=>e.count===null||L.value&&!e.showZero),F=He(()=>(e.status!==null&&e.status!==void 0||e.color!==null&&e.color!==void 0)&&z.value),N=He(()=>e.dot&&!L.value),G=He(()=>N.value?"":O.value),Y=He(()=>(G.value===null||G.value===void 0||G.value===""||L.value&&!e.showZero)&&!N.value),K=tn(e.count),J=tn(G.value),X=tn(N.value);On([()=>e.count,G,N],()=>{Y.value||(K.value=e.count,J.value=G.value,X.value=N.value)},{immediate:!0});const se=He(()=>Dx(e.color,!1)),te=He(()=>({[`${d.value}-status-dot`]:F.value,[`${d.value}-status-${e.status}`]:!!e.status,[`${d.value}-color-${e.color}`]:se.value})),ne=He(()=>e.color&&!se.value?{background:e.color,color:e.color}:{}),ue=He(()=>({[`${d.value}-dot`]:X.value,[`${d.value}-count`]:!X.value,[`${d.value}-count-sm`]:e.size==="small",[`${d.value}-multiple-words`]:!X.value&&J.value&&J.value.toString().length>1,[`${d.value}-status-${e.status}`]:!!e.status,[`${d.value}-color-${e.color}`]:se.value}));return()=>{var ge,ee;const{offset:be,title:Ie,color:Ee}=e,Re=c.style,Qe=DR(o,e,"text"),et=d.value,We=K.value;let me=vo((ge=o.default)===null||ge===void 0?void 0:ge.call(o));me=me.length?me:null;const Oe=!!(!Y.value||o.count),Fe=(()=>{if(!be)return re({},Re);const _n={marginTop:rK(be[1])?`${be[1]}px`:be[1]};return y.value==="rtl"?_n.left=`${parseInt(be[0],10)}px`:_n.right=`${-parseInt(be[0],10)}px`,re(re({},_n),Re)})(),Ke=Ie??(typeof We=="string"||typeof We=="number"?We:void 0),$e=Oe||!Qe?null:le("span",{class:`${et}-status-text`},[Qe]),pt=typeof We=="object"||We===void 0&&o.count?xo(We??((ee=o.count)===null||ee===void 0?void 0:ee.call(o)),{style:Fe},!1):null,Ct=hn(et,{[`${et}-status`]:F.value,[`${et}-not-a-wrapper`]:!me,[`${et}-rtl`]:y.value==="rtl"},c.class,i.value);if(!me&&F.value){const _n=Fe.color;return w(le("span",it(it({},c),{},{class:Ct,style:Fe}),[le("span",{class:te.value,style:ne.value},null),le("span",{style:{color:_n},class:`${et}-status-text`},[Qe])]))}const Lt=M_(me?`${et}-zoom`:"",{appear:!1});let It=re(re({},Fe),e.numberStyle);return Ee&&!se.value&&(It=It||{},It.background=Ee),w(le("span",it(it({},c),{},{class:Ct}),[me,le(Al,Lt,{default:()=>[Ns(le(qX,{prefixCls:e.scrollNumberPrefixCls,show:Oe,class:ue.value,count:J.value,title:Ke,style:It,key:"scrollNumber"},{default:()=>[pt]}),[[bl,Oe]])]}),$e]))}}});tv.install=function(e){return e.component(tv.name,tv),e.component(TS.name,TS),e};const oK=e=>{const{componentCls:t,colorPrimary:o}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${o})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0}}}}},aK=Ui("Wave",e=>[oK(e)]);function sK(e){const t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return t&&t[1]&&t[2]&&t[3]?!(t[1]===t[2]&&t[2]===t[3]):!0}function bw(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&sK(e)&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function lK(e){const{borderTopColor:t,borderColor:o,backgroundColor:c}=getComputedStyle(e);return bw(t)?t:bw(o)?o:bw(c)?c:null}function ww(e){return Number.isNaN(e)?0:e}const cK=cn({props:{target:oi(),className:String},setup(e){const t=Xt(null),[o,c]=hc(null),[d,y]=hc([]),[w,i]=hc(0),[O,L]=hc(0),[z,F]=hc(0),[N,G]=hc(0),[Y,K]=hc(!1);function J(){const{target:ee}=e,be=getComputedStyle(ee);c(lK(ee));const Ie=be.position==="static",{borderLeftWidth:Ee,borderTopWidth:Re}=be;i(Ie?ee.offsetLeft:ww(-parseFloat(Ee))),L(Ie?ee.offsetTop:ww(-parseFloat(Re))),F(ee.offsetWidth),G(ee.offsetHeight);const{borderTopLeftRadius:Qe,borderTopRightRadius:et,borderBottomLeftRadius:We,borderBottomRightRadius:me}=be;y([Qe,et,me,We].map(Oe=>ww(parseFloat(Oe))))}let X,se,te;const ne=()=>{clearTimeout(te),qr.cancel(se),X==null||X.disconnect()},ue=()=>{var ee;const be=(ee=t.value)===null||ee===void 0?void 0:ee.parentElement;be&&(Cu(null,be),be.parentElement&&be.parentElement.removeChild(be))};Qr(()=>{ne(),te=setTimeout(()=>{ue()},5e3);const{target:ee}=e;ee&&(se=qr(()=>{J(),K(!0)}),typeof ResizeObserver<"u"&&(X=new ResizeObserver(J),X.observe(ee)))}),fi(()=>{ne()});const ge=ee=>{ee.propertyName==="opacity"&&ue()};return()=>{if(!Y.value)return null;const ee={left:`${w.value}px`,top:`${O.value}px`,width:`${z.value}px`,height:`${N.value}px`,borderRadius:d.value.map(be=>`${be}px`).join(" ")};return o&&(ee["--wave-color"]=o.value),le(Al,{appear:!0,name:"wave-motion",appearFromClass:"wave-motion-appear",appearActiveClass:"wave-motion-appear",appearToClass:"wave-motion-appear wave-motion-appear-active"},{default:()=>[le("div",{ref:t,class:e.className,style:ee,onTransitionend:ge},null)]})}}});function uK(e,t){const o=document.createElement("div");return o.style.position="absolute",o.style.left="0px",o.style.top="0px",e==null||e.insertBefore(o,e==null?void 0:e.firstChild),Cu(le(cK,{target:e,className:t},null),o),()=>{Cu(null,o),o.parentElement&&o.parentElement.removeChild(o)}}function dK(e,t){const o=Ys();let c;function d(){var y;const w=gc(o);c==null||c(),!(!((y=t==null?void 0:t.value)===null||y===void 0)&&y.disabled||!w)&&(c=uK(w,e.value))}return fi(()=>{c==null||c()}),d}const a4=cn({compatConfig:{MODE:3},name:"Wave",props:{disabled:Boolean},setup(e,t){let{slots:o}=t;const c=Ys(),{prefixCls:d,wave:y}=Rr("wave",e),[,w]=aK(d),i=dK(He(()=>hn(d.value,w.value)),y);let O;const L=()=>{gc(c).removeEventListener("click",O,!0)};return Qr(()=>{On(()=>e.disabled,()=>{L(),si(()=>{const z=gc(c);z==null||z.removeEventListener("click",O,!0),!(!z||z.nodeType!==1||e.disabled)&&(O=F=>{F.target.tagName==="INPUT"||!G2(F.target)||!z.getAttribute||z.getAttribute("disabled")||z.disabled||z.className.includes("disabled")||z.className.includes("-leave")||i()},z.addEventListener("click",O,!0))})},{immediate:!0,flush:"post"})}),fi(()=>{L()}),()=>{var z;return(z=o.default)===null||z===void 0?void 0:z.call(o)[0]}}});function s4(e){return e==="danger"?{danger:!0}:{type:e}}const hK=()=>({prefixCls:String,type:String,htmlType:{type:String,default:"button"},shape:{type:String},size:{type:String},loading:{type:[Boolean,Object],default:()=>!1},disabled:{type:Boolean,default:void 0},ghost:{type:Boolean,default:void 0},block:{type:Boolean,default:void 0},danger:{type:Boolean,default:void 0},icon:wt.any,href:String,target:String,title:String,onClick:a_(),onMousedown:a_()}),O3=e=>{e&&(e.style.width="0px",e.style.opacity="0",e.style.transform="scale(0)")},D3=e=>{si(()=>{e&&(e.style.width=`${e.scrollWidth}px`,e.style.opacity="1",e.style.transform="scale(1)")})},R3=e=>{e&&e.style&&(e.style.width=null,e.style.opacity=null,e.style.transform=null)},fK=cn({compatConfig:{MODE:3},name:"LoadingIcon",props:{prefixCls:String,loading:[Boolean,Object],existIcon:Boolean},setup(e){return()=>{const{existIcon:t,prefixCls:o,loading:c}=e;if(t)return le("span",{class:`${o}-loading-icon`},[le(xc,null,null)]);const d=!!c;return le(Al,{name:`${o}-loading-icon-motion`,onBeforeEnter:O3,onEnter:D3,onAfterEnter:R3,onBeforeLeave:D3,onLeave:y=>{setTimeout(()=>{O3(y)})},onAfterLeave:R3},{default:()=>[d?le("span",{class:`${o}-loading-icon`},[le(xc,null,null)]):null]})}}}),z3=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}}),pK=e=>{const{componentCls:t,fontSize:o,lineWidth:c,colorPrimaryHover:d,colorErrorHover:y}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-c,[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:o}},z3(`${t}-primary`,d),z3(`${t}-danger`,y)]}};function mK(e,t){return{[`&-item:not(${t}-last-item)`]:{marginBottom:-e.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function gK(e,t){return{[`&-item:not(${t}-first-item):not(${t}-last-item)`]:{borderRadius:0},[`&-item${t}-first-item:not(${t}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${t}-last-item:not(${t}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function _K(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:re(re({},mK(e,t)),gK(e.componentCls,t))}}const yK=e=>{const{componentCls:t,iconCls:o}=e;return{[t]:{outline:"none",position:"relative",display:"inline-block",fontWeight:400,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${e.lineWidth}px ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:e.lineHeight,color:e.colorText,"> span":{display:"inline-block"},[`> ${o} + span, > span + ${o}`]:{marginInlineStart:e.marginXS},"> a":{color:"currentColor"},"&:not(:disabled)":re({},fz(e)),[`&-icon-only${t}-compact-item`]:{flex:"none"},[`&-compact-item${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:e.lineWidth,height:`calc(100% + ${e.lineWidth*2}px)`,backgroundColor:e.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-vertical-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:`calc(100% + ${e.lineWidth*2}px)`,height:e.lineWidth,backgroundColor:e.colorPrimaryHover,content:'""'}}}}}}},bc=(e,t)=>({"&:not(:disabled)":{"&:hover":e,"&:active":t}}),vK=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),xK=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.controlHeight/2,paddingInlineEnd:e.controlHeight/2}),ES=e=>({cursor:"not-allowed",borderColor:e.colorBorder,color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,boxShadow:"none"}),Nv=(e,t,o,c,d,y,w)=>({[`&${e}-background-ghost`]:re(re({color:t||void 0,backgroundColor:"transparent",borderColor:o||void 0,boxShadow:"none"},bc(re({backgroundColor:"transparent"},y),re({backgroundColor:"transparent"},w))),{"&:disabled":{cursor:"not-allowed",color:c||void 0,borderColor:d||void 0}})}),IC=e=>({"&:disabled":re({},ES(e))}),l4=e=>re({},IC(e)),Vv=e=>({"&:disabled":{cursor:"not-allowed",color:e.colorTextDisabled}}),c4=e=>re(re(re(re(re({},l4(e)),{backgroundColor:e.colorBgContainer,borderColor:e.colorBorder,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`}),bc({color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),Nv(e.componentCls,e.colorBgContainer,e.colorBgContainer,e.colorTextDisabled,e.colorBorder)),{[`&${e.componentCls}-dangerous`]:re(re(re({color:e.colorError,borderColor:e.colorError},bc({color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),Nv(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder)),IC(e))}),bK=e=>re(re(re(re(re({},l4(e)),{color:e.colorTextLightSolid,backgroundColor:e.colorPrimary,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`}),bc({color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryHover},{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryActive})),Nv(e.componentCls,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),{[`&${e.componentCls}-dangerous`]:re(re(re({backgroundColor:e.colorError,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`},bc({backgroundColor:e.colorErrorHover},{backgroundColor:e.colorErrorActive})),Nv(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),IC(e))}),wK=e=>re(re({},c4(e)),{borderStyle:"dashed"}),SK=e=>re(re(re({color:e.colorLink},bc({color:e.colorLinkHover},{color:e.colorLinkActive})),Vv(e)),{[`&${e.componentCls}-dangerous`]:re(re({color:e.colorError},bc({color:e.colorErrorHover},{color:e.colorErrorActive})),Vv(e))}),CK=e=>re(re(re({},bc({color:e.colorText,backgroundColor:e.colorBgTextHover},{color:e.colorText,backgroundColor:e.colorBgTextActive})),Vv(e)),{[`&${e.componentCls}-dangerous`]:re(re({color:e.colorError},Vv(e)),bc({color:e.colorErrorHover,backgroundColor:e.colorErrorBg},{color:e.colorErrorHover,backgroundColor:e.colorErrorBg}))}),TK=e=>re(re({},ES(e)),{[`&${e.componentCls}:hover`]:re({},ES(e))}),EK=e=>{const{componentCls:t}=e;return{[`${t}-default`]:c4(e),[`${t}-primary`]:bK(e),[`${t}-dashed`]:wK(e),[`${t}-link`]:SK(e),[`${t}-text`]:CK(e),[`${t}-disabled`]:TK(e)}},AC=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:o,iconCls:c,controlHeight:d,fontSize:y,lineHeight:w,lineWidth:i,borderRadius:O,buttonPaddingHorizontal:L}=e,z=Math.max(0,(d-y*w)/2-i),F=L-i,N=`${o}-icon-only`;return[{[`${o}${t}`]:{fontSize:y,height:d,padding:`${z}px ${F}px`,borderRadius:O,[`&${N}`]:{width:d,paddingInlineStart:0,paddingInlineEnd:0,[`&${o}-round`]:{width:"auto"},"> span":{transform:"scale(1.143)"}},[`&${o}-loading`]:{opacity:e.opacityLoading,cursor:"default"},[`${o}-loading-icon`]:{transition:`width ${e.motionDurationSlow} ${e.motionEaseInOut}, opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`},[`&:not(${N}) ${o}-loading-icon > ${c}`]:{marginInlineEnd:e.marginXS}}},{[`${o}${o}-circle${t}`]:vK(e)},{[`${o}${o}-round${t}`]:xK(e)}]},MK=e=>AC(e),IK=e=>{const t=Wr(e,{controlHeight:e.controlHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:8,borderRadius:e.borderRadiusSM});return AC(t,`${e.componentCls}-sm`)},AK=e=>{const t=Wr(e,{controlHeight:e.controlHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG});return AC(t,`${e.componentCls}-lg`)},PK=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}},OK=Ui("Button",e=>{const{controlTmpOutline:t,paddingContentHorizontal:o}=e,c=Wr(e,{colorOutlineDefault:t,buttonPaddingHorizontal:o});return[yK(c),IK(c),MK(c),AK(c),PK(c),EK(c),pK(c),wC(e,{focus:!1}),_K(e)]}),DK=()=>({prefixCls:String,size:{type:String}}),u4=uC(),MS=cn({compatConfig:{MODE:3},name:"AButtonGroup",props:DK(),setup(e,t){let{slots:o}=t;const{prefixCls:c,direction:d}=Rr("btn-group",e),[,,y]=gp();u4.useProvide(no({size:He(()=>e.size)}));const w=He(()=>{const{size:i}=e;let O="";switch(i){case"large":O="lg";break;case"small":O="sm";break;case"middle":case void 0:break;default:F2(!i,"Button.Group","Invalid prop `size`.")}return{[`${c.value}`]:!0,[`${c.value}-${O}`]:O,[`${c.value}-rtl`]:d.value==="rtl",[y.value]:!0}});return()=>{var i;return le("div",{class:w.value},[vo((i=o.default)===null||i===void 0?void 0:i.call(o))])}}}),L3=/^[\u4e00-\u9fa5]{2}$/,$3=L3.test.bind(L3);function Dy(e){return e==="text"||e==="link"}const ps=cn({compatConfig:{MODE:3},name:"AButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:Wo(hK(),{type:"default"}),slots:Object,setup(e,t){let{slots:o,attrs:c,emit:d,expose:y}=t;const{prefixCls:w,autoInsertSpaceInButton:i,direction:O,size:L}=Rr("btn",e),[z,F]=OK(w),N=u4.useInject(),G=yc(),Y=He(()=>{var me;return(me=e.disabled)!==null&&me!==void 0?me:G.value}),K=Xt(null),J=Xt(void 0);let X=!1;const se=Xt(!1),te=Xt(!1),ne=He(()=>i.value!==!1),{compactSize:ue,compactItemClassnames:ge}=vC(w,O),ee=He(()=>typeof e.loading=="object"&&e.loading.delay?e.loading.delay||!0:!!e.loading);On(ee,me=>{clearTimeout(J.value),typeof ee.value=="number"?J.value=setTimeout(()=>{se.value=me},ee.value):se.value=me},{immediate:!0});const be=He(()=>{const{type:me,shape:Oe="default",ghost:Fe,block:Ke,danger:$e}=e,pt=w.value,Ct={large:"lg",small:"sm",middle:void 0},Lt=ue.value||(N==null?void 0:N.size)||L.value,It=Lt&&Ct[Lt]||"";return[ge.value,{[F.value]:!0,[`${pt}`]:!0,[`${pt}-${Oe}`]:Oe!=="default"&&Oe,[`${pt}-${me}`]:me,[`${pt}-${It}`]:It,[`${pt}-loading`]:se.value,[`${pt}-background-ghost`]:Fe&&!Dy(me),[`${pt}-two-chinese-chars`]:te.value&&ne.value,[`${pt}-block`]:Ke,[`${pt}-dangerous`]:!!$e,[`${pt}-rtl`]:O.value==="rtl"}]}),Ie=()=>{const me=K.value;if(!me||i.value===!1)return;const Oe=me.textContent;X&&$3(Oe)?te.value||(te.value=!0):te.value&&(te.value=!1)},Ee=me=>{if(se.value||Y.value){me.preventDefault();return}d("click",me)},Re=me=>{d("mousedown",me)},Qe=(me,Oe)=>{const Fe=Oe?" ":"";if(me.type===pp){let Ke=me.children.trim();return $3(Ke)&&(Ke=Ke.split("").join(Fe)),le("span",null,[Ke])}return me};return Ii(()=>{F2(!(e.ghost&&Dy(e.type)),"Button","`link` or `text` button can't be a `ghost` button.")}),Qr(Ie),Pu(Ie),fi(()=>{J.value&&clearTimeout(J.value)}),y({focus:()=>{var me;(me=K.value)===null||me===void 0||me.focus()},blur:()=>{var me;(me=K.value)===null||me===void 0||me.blur()}}),()=>{var me,Oe;const{icon:Fe=(me=o.icon)===null||me===void 0?void 0:me.call(o)}=e,Ke=vo((Oe=o.default)===null||Oe===void 0?void 0:Oe.call(o));X=Ke.length===1&&!Fe&&!Dy(e.type);const{type:$e,htmlType:pt,href:Ct,title:Lt,target:It}=e,_n=se.value?"loading":Fe,Ut=re(re({},c),{title:Lt,disabled:Y.value,class:[be.value,c.class,{[`${w.value}-icon-only`]:Ke.length===0&&!!_n}],onClick:Ee,onMousedown:Re});Y.value||delete Ut.disabled;const ln=Fe&&!se.value?Fe:le(fK,{existIcon:!!Fe,prefixCls:w.value,loading:!!se.value},null),xn=Ke.map(Nt=>Qe(Nt,X&&ne.value));if(Ct!==void 0)return z(le("a",it(it({},Ut),{},{href:Ct,target:It,ref:K}),[ln,xn]));let En=le("button",it(it({},Ut),{},{ref:K,type:pt}),[ln,xn]);if(!Dy($e)){const Nt=function(){return En}();En=le(a4,{ref:"wave",disabled:!!se.value},{default:()=>[Nt]})}return z(En)}}});ps.Group=MS;ps.install=function(e){return e.component(ps.name,ps),e.component(MS.name,MS),e};var RK={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};function F3(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){zK(e,d,o[d])})}return e}function zK(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var PC=function(t,o){var c=F3({},t,o.attrs);return le(Hi,F3({},c,{icon:RK}),null)};PC.displayName="RightOutlined";PC.inheritAttrs=!1;function d4(e,t){return e.classList?e.classList.contains(t):` ${e.className} `.indexOf(` ${t} `)>-1}function B3(e,t){e.classList?e.classList.add(t):d4(e,t)||(e.className=`${e.className} ${t}`)}function k3(e,t){if(e.classList)e.classList.remove(t);else if(d4(e,t)){const o=e.className;e.className=` ${o} `.replace(` ${t} `," ")}}const h4=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant-motion-collapse",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{name:e,appear:t,css:!0,onBeforeEnter:o=>{o.style.height="0px",o.style.opacity="0",B3(o,e)},onEnter:o=>{si(()=>{o.style.height=`${o.scrollHeight}px`,o.style.opacity="1"})},onAfterEnter:o=>{o&&(k3(o,e),o.style.height=null,o.style.opacity=null)},onBeforeLeave:o=>{B3(o,e),o.style.height=`${o.offsetHeight}px`,o.style.opacity=null},onLeave:o=>{setTimeout(()=>{o.style.height="0px",o.style.opacity="0"})},onAfterLeave:o=>{o&&(k3(o,e),o.style&&(o.style.height=null,o.style.opacity=null))}}};function Ac(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nv={exports:{}},LK=nv.exports,N3;function $K(){return N3||(N3=1,function(e,t){(function(o,c){e.exports=c()})(LK,function(){var o=1e3,c=6e4,d=36e5,y="millisecond",w="second",i="minute",O="hour",L="day",z="week",F="month",N="quarter",G="year",Y="date",K="Invalid Date",J=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,X=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,se={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(We){var me=["th","st","nd","rd"],Oe=We%100;return"["+We+(me[(Oe-20)%10]||me[Oe]||me[0])+"]"}},te=function(We,me,Oe){var Fe=String(We);return!Fe||Fe.length>=me?We:""+Array(me+1-Fe.length).join(Oe)+We},ne={s:te,z:function(We){var me=-We.utcOffset(),Oe=Math.abs(me),Fe=Math.floor(Oe/60),Ke=Oe%60;return(me<=0?"+":"-")+te(Fe,2,"0")+":"+te(Ke,2,"0")},m:function We(me,Oe){if(me.date()<Oe.date())return-We(Oe,me);var Fe=12*(Oe.year()-me.year())+(Oe.month()-me.month()),Ke=me.clone().add(Fe,F),$e=Oe-Ke<0,pt=me.clone().add(Fe+($e?-1:1),F);return+(-(Fe+(Oe-Ke)/($e?Ke-pt:pt-Ke))||0)},a:function(We){return We<0?Math.ceil(We)||0:Math.floor(We)},p:function(We){return{M:F,y:G,w:z,d:L,D:Y,h:O,m:i,s:w,ms:y,Q:N}[We]||String(We||"").toLowerCase().replace(/s$/,"")},u:function(We){return We===void 0}},ue="en",ge={};ge[ue]=se;var ee="$isDayjsObject",be=function(We){return We instanceof Qe||!(!We||!We[ee])},Ie=function We(me,Oe,Fe){var Ke;if(!me)return ue;if(typeof me=="string"){var $e=me.toLowerCase();ge[$e]&&(Ke=$e),Oe&&(ge[$e]=Oe,Ke=$e);var pt=me.split("-");if(!Ke&&pt.length>1)return We(pt[0])}else{var Ct=me.name;ge[Ct]=me,Ke=Ct}return!Fe&&Ke&&(ue=Ke),Ke||!Fe&&ue},Ee=function(We,me){if(be(We))return We.clone();var Oe=typeof me=="object"?me:{};return Oe.date=We,Oe.args=arguments,new Qe(Oe)},Re=ne;Re.l=Ie,Re.i=be,Re.w=function(We,me){return Ee(We,{locale:me.$L,utc:me.$u,x:me.$x,$offset:me.$offset})};var Qe=function(){function We(Oe){this.$L=Ie(Oe.locale,null,!0),this.parse(Oe),this.$x=this.$x||Oe.x||{},this[ee]=!0}var me=We.prototype;return me.parse=function(Oe){this.$d=function(Fe){var Ke=Fe.date,$e=Fe.utc;if(Ke===null)return new Date(NaN);if(Re.u(Ke))return new Date;if(Ke instanceof Date)return new Date(Ke);if(typeof Ke=="string"&&!/Z$/i.test(Ke)){var pt=Ke.match(J);if(pt){var Ct=pt[2]-1||0,Lt=(pt[7]||"0").substring(0,3);return $e?new Date(Date.UTC(pt[1],Ct,pt[3]||1,pt[4]||0,pt[5]||0,pt[6]||0,Lt)):new Date(pt[1],Ct,pt[3]||1,pt[4]||0,pt[5]||0,pt[6]||0,Lt)}}return new Date(Ke)}(Oe),this.init()},me.init=function(){var Oe=this.$d;this.$y=Oe.getFullYear(),this.$M=Oe.getMonth(),this.$D=Oe.getDate(),this.$W=Oe.getDay(),this.$H=Oe.getHours(),this.$m=Oe.getMinutes(),this.$s=Oe.getSeconds(),this.$ms=Oe.getMilliseconds()},me.$utils=function(){return Re},me.isValid=function(){return this.$d.toString()!==K},me.isSame=function(Oe,Fe){var Ke=Ee(Oe);return this.startOf(Fe)<=Ke&&Ke<=this.endOf(Fe)},me.isAfter=function(Oe,Fe){return Ee(Oe)<this.startOf(Fe)},me.isBefore=function(Oe,Fe){return this.endOf(Fe)<Ee(Oe)},me.$g=function(Oe,Fe,Ke){return Re.u(Oe)?this[Fe]:this.set(Ke,Oe)},me.unix=function(){return Math.floor(this.valueOf()/1e3)},me.valueOf=function(){return this.$d.getTime()},me.startOf=function(Oe,Fe){var Ke=this,$e=!!Re.u(Fe)||Fe,pt=Re.p(Oe),Ct=function(Nt,_e){var Ft=Re.w(Ke.$u?Date.UTC(Ke.$y,_e,Nt):new Date(Ke.$y,_e,Nt),Ke);return $e?Ft:Ft.endOf(L)},Lt=function(Nt,_e){return Re.w(Ke.toDate()[Nt].apply(Ke.toDate("s"),($e?[0,0,0,0]:[23,59,59,999]).slice(_e)),Ke)},It=this.$W,_n=this.$M,Ut=this.$D,ln="set"+(this.$u?"UTC":"");switch(pt){case G:return $e?Ct(1,0):Ct(31,11);case F:return $e?Ct(1,_n):Ct(0,_n+1);case z:var xn=this.$locale().weekStart||0,En=(It<xn?It+7:It)-xn;return Ct($e?Ut-En:Ut+(6-En),_n);case L:case Y:return Lt(ln+"Hours",0);case O:return Lt(ln+"Minutes",1);case i:return Lt(ln+"Seconds",2);case w:return Lt(ln+"Milliseconds",3);default:return this.clone()}},me.endOf=function(Oe){return this.startOf(Oe,!1)},me.$set=function(Oe,Fe){var Ke,$e=Re.p(Oe),pt="set"+(this.$u?"UTC":""),Ct=(Ke={},Ke[L]=pt+"Date",Ke[Y]=pt+"Date",Ke[F]=pt+"Month",Ke[G]=pt+"FullYear",Ke[O]=pt+"Hours",Ke[i]=pt+"Minutes",Ke[w]=pt+"Seconds",Ke[y]=pt+"Milliseconds",Ke)[$e],Lt=$e===L?this.$D+(Fe-this.$W):Fe;if($e===F||$e===G){var It=this.clone().set(Y,1);It.$d[Ct](Lt),It.init(),this.$d=It.set(Y,Math.min(this.$D,It.daysInMonth())).$d}else Ct&&this.$d[Ct](Lt);return this.init(),this},me.set=function(Oe,Fe){return this.clone().$set(Oe,Fe)},me.get=function(Oe){return this[Re.p(Oe)]()},me.add=function(Oe,Fe){var Ke,$e=this;Oe=Number(Oe);var pt=Re.p(Fe),Ct=function(_n){var Ut=Ee($e);return Re.w(Ut.date(Ut.date()+Math.round(_n*Oe)),$e)};if(pt===F)return this.set(F,this.$M+Oe);if(pt===G)return this.set(G,this.$y+Oe);if(pt===L)return Ct(1);if(pt===z)return Ct(7);var Lt=(Ke={},Ke[i]=c,Ke[O]=d,Ke[w]=o,Ke)[pt]||1,It=this.$d.getTime()+Oe*Lt;return Re.w(It,this)},me.subtract=function(Oe,Fe){return this.add(-1*Oe,Fe)},me.format=function(Oe){var Fe=this,Ke=this.$locale();if(!this.isValid())return Ke.invalidDate||K;var $e=Oe||"YYYY-MM-DDTHH:mm:ssZ",pt=Re.z(this),Ct=this.$H,Lt=this.$m,It=this.$M,_n=Ke.weekdays,Ut=Ke.months,ln=Ke.meridiem,xn=function(_e,Ft,Ve,Ye){return _e&&(_e[Ft]||_e(Fe,$e))||Ve[Ft].slice(0,Ye)},En=function(_e){return Re.s(Ct%12||12,_e,"0")},Nt=ln||function(_e,Ft,Ve){var Ye=_e<12?"AM":"PM";return Ve?Ye.toLowerCase():Ye};return $e.replace(X,function(_e,Ft){return Ft||function(Ve){switch(Ve){case"YY":return String(Fe.$y).slice(-2);case"YYYY":return Re.s(Fe.$y,4,"0");case"M":return It+1;case"MM":return Re.s(It+1,2,"0");case"MMM":return xn(Ke.monthsShort,It,Ut,3);case"MMMM":return xn(Ut,It);case"D":return Fe.$D;case"DD":return Re.s(Fe.$D,2,"0");case"d":return String(Fe.$W);case"dd":return xn(Ke.weekdaysMin,Fe.$W,_n,2);case"ddd":return xn(Ke.weekdaysShort,Fe.$W,_n,3);case"dddd":return _n[Fe.$W];case"H":return String(Ct);case"HH":return Re.s(Ct,2,"0");case"h":return En(1);case"hh":return En(2);case"a":return Nt(Ct,Lt,!0);case"A":return Nt(Ct,Lt,!1);case"m":return String(Lt);case"mm":return Re.s(Lt,2,"0");case"s":return String(Fe.$s);case"ss":return Re.s(Fe.$s,2,"0");case"SSS":return Re.s(Fe.$ms,3,"0");case"Z":return pt}return null}(_e)||pt.replace(":","")})},me.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},me.diff=function(Oe,Fe,Ke){var $e,pt=this,Ct=Re.p(Fe),Lt=Ee(Oe),It=(Lt.utcOffset()-this.utcOffset())*c,_n=this-Lt,Ut=function(){return Re.m(pt,Lt)};switch(Ct){case G:$e=Ut()/12;break;case F:$e=Ut();break;case N:$e=Ut()/3;break;case z:$e=(_n-It)/6048e5;break;case L:$e=(_n-It)/864e5;break;case O:$e=_n/d;break;case i:$e=_n/c;break;case w:$e=_n/o;break;default:$e=_n}return Ke?$e:Re.a($e)},me.daysInMonth=function(){return this.endOf(F).$D},me.$locale=function(){return ge[this.$L]},me.locale=function(Oe,Fe){if(!Oe)return this.$L;var Ke=this.clone(),$e=Ie(Oe,Fe,!0);return $e&&(Ke.$L=$e),Ke},me.clone=function(){return Re.w(this.$d,this)},me.toDate=function(){return new Date(this.valueOf())},me.toJSON=function(){return this.isValid()?this.toISOString():null},me.toISOString=function(){return this.$d.toISOString()},me.toString=function(){return this.$d.toUTCString()},We}(),et=Qe.prototype;return Ee.prototype=et,[["$ms",y],["$s",w],["$m",i],["$H",O],["$W",L],["$M",F],["$y",G],["$D",Y]].forEach(function(We){et[We[1]]=function(me){return this.$g(me,We[0],We[1])}}),Ee.extend=function(We,me){return We.$i||(We(me,Qe,Ee),We.$i=!0),Ee},Ee.locale=Ie,Ee.isDayjs=be,Ee.unix=function(We){return Ee(1e3*We)},Ee.en=ge[ue],Ee.Ls=ge,Ee.p={},Ee})}(nv)),nv.exports}var FK=$K();const ai=Ac(FK);var rv={exports:{}},BK=rv.exports,V3;function kK(){return V3||(V3=1,function(e,t){(function(o,c){e.exports=c()})(BK,function(){return function(o,c){c.prototype.weekday=function(d){var y=this.$locale().weekStart||0,w=this.$W,i=(w<y?w+7:w)-y;return this.$utils().u(d)?i:this.subtract(i,"day").add(d,"day")}}})}(rv)),rv.exports}var NK=kK();const VK=Ac(NK);var iv={exports:{}},jK=iv.exports,j3;function UK(){return j3||(j3=1,function(e,t){(function(o,c){e.exports=c()})(jK,function(){return function(o,c,d){var y=c.prototype,w=function(F){return F&&(F.indexOf?F:F.s)},i=function(F,N,G,Y,K){var J=F.name?F:F.$locale(),X=w(J[N]),se=w(J[G]),te=X||se.map(function(ue){return ue.slice(0,Y)});if(!K)return te;var ne=J.weekStart;return te.map(function(ue,ge){return te[(ge+(ne||0))%7]})},O=function(){return d.Ls[d.locale()]},L=function(F,N){return F.formats[N]||function(G){return G.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Y,K,J){return K||J.slice(1)})}(F.formats[N.toUpperCase()])},z=function(){var F=this;return{months:function(N){return N?N.format("MMMM"):i(F,"months")},monthsShort:function(N){return N?N.format("MMM"):i(F,"monthsShort","months",3)},firstDayOfWeek:function(){return F.$locale().weekStart||0},weekdays:function(N){return N?N.format("dddd"):i(F,"weekdays")},weekdaysMin:function(N){return N?N.format("dd"):i(F,"weekdaysMin","weekdays",2)},weekdaysShort:function(N){return N?N.format("ddd"):i(F,"weekdaysShort","weekdays",3)},longDateFormat:function(N){return L(F.$locale(),N)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};y.localeData=function(){return z.bind(this)()},d.localeData=function(){var F=O();return{firstDayOfWeek:function(){return F.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(N){return L(F,N)},meridiem:F.meridiem,ordinal:F.ordinal}},d.months=function(){return i(O(),"months")},d.monthsShort=function(){return i(O(),"monthsShort","months",3)},d.weekdays=function(F){return i(O(),"weekdays",null,null,F)},d.weekdaysShort=function(F){return i(O(),"weekdaysShort","weekdays",3,F)},d.weekdaysMin=function(F){return i(O(),"weekdaysMin","weekdays",2,F)}}})}(iv)),iv.exports}var HK=UK();const GK=Ac(HK);var ov={exports:{}},WK=ov.exports,U3;function qK(){return U3||(U3=1,function(e,t){(function(o,c){e.exports=c()})(WK,function(){var o="week",c="year";return function(d,y,w){var i=y.prototype;i.week=function(O){if(O===void 0&&(O=null),O!==null)return this.add(7*(O-this.week()),"day");var L=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var z=w(this).startOf(c).add(1,c).date(L),F=w(this).endOf(o);if(z.isBefore(F))return 1}var N=w(this).startOf(c).date(L).startOf(o).subtract(1,"millisecond"),G=this.diff(N,o,!0);return G<0?w(this).startOf("week").week():Math.ceil(G)},i.weeks=function(O){return O===void 0&&(O=null),this.week(O)}}})}(ov)),ov.exports}var ZK=qK();const YK=Ac(ZK);var av={exports:{}},XK=av.exports,H3;function KK(){return H3||(H3=1,function(e,t){(function(o,c){e.exports=c()})(XK,function(){return function(o,c){c.prototype.weekYear=function(){var d=this.month(),y=this.week(),w=this.year();return y===1&&d===11?w+1:d===0&&y>=52?w-1:w}}})}(av)),av.exports}var JK=KK();const QK=Ac(JK);var sv={exports:{}},eJ=sv.exports,G3;function tJ(){return G3||(G3=1,function(e,t){(function(o,c){e.exports=c()})(eJ,function(){var o="month",c="quarter";return function(d,y){var w=y.prototype;w.quarter=function(L){return this.$utils().u(L)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(L-1))};var i=w.add;w.add=function(L,z){return L=Number(L),this.$utils().p(z)===c?this.add(3*L,o):i.bind(this)(L,z)};var O=w.startOf;w.startOf=function(L,z){var F=this.$utils(),N=!!F.u(z)||z;if(F.p(L)===c){var G=this.quarter()-1;return N?this.month(3*G).startOf(o).startOf("day"):this.month(3*G+2).endOf(o).endOf("day")}return O.bind(this)(L,z)}}})}(sv)),sv.exports}var nJ=tJ();const rJ=Ac(nJ);var lv={exports:{}},iJ=lv.exports,W3;function oJ(){return W3||(W3=1,function(e,t){(function(o,c){e.exports=c()})(iJ,function(){return function(o,c){var d=c.prototype,y=d.format;d.format=function(w){var i=this,O=this.$locale();if(!this.isValid())return y.bind(this)(w);var L=this.$utils(),z=(w||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(F){switch(F){case"Q":return Math.ceil((i.$M+1)/3);case"Do":return O.ordinal(i.$D);case"gggg":return i.weekYear();case"GGGG":return i.isoWeekYear();case"wo":return O.ordinal(i.week(),"W");case"w":case"ww":return L.s(i.week(),F==="w"?1:2,"0");case"W":case"WW":return L.s(i.isoWeek(),F==="W"?1:2,"0");case"k":case"kk":return L.s(String(i.$H===0?24:i.$H),F==="k"?1:2,"0");case"X":return Math.floor(i.$d.getTime()/1e3);case"x":return i.$d.getTime();case"z":return"["+i.offsetName()+"]";case"zzz":return"["+i.offsetName("long")+"]";default:return F}});return y.bind(this)(z)}}})}(lv)),lv.exports}var aJ=oJ();const sJ=Ac(aJ);var cv={exports:{}},lJ=cv.exports,q3;function cJ(){return q3||(q3=1,function(e,t){(function(o,c){e.exports=c()})(lJ,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},c=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,y=/\d\d/,w=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,O={},L=function(J){return(J=+J)+(J>68?1900:2e3)},z=function(J){return function(X){this[J]=+X}},F=[/[+-]\d\d:?(\d\d)?|Z/,function(J){(this.zone||(this.zone={})).offset=function(X){if(!X||X==="Z")return 0;var se=X.match(/([+-]|\d\d)/g),te=60*se[1]+(+se[2]||0);return te===0?0:se[0]==="+"?-te:te}(J)}],N=function(J){var X=O[J];return X&&(X.indexOf?X:X.s.concat(X.f))},G=function(J,X){var se,te=O.meridiem;if(te){for(var ne=1;ne<=24;ne+=1)if(J.indexOf(te(ne,0,X))>-1){se=ne>12;break}}else se=J===(X?"pm":"PM");return se},Y={A:[i,function(J){this.afternoon=G(J,!1)}],a:[i,function(J){this.afternoon=G(J,!0)}],Q:[d,function(J){this.month=3*(J-1)+1}],S:[d,function(J){this.milliseconds=100*+J}],SS:[y,function(J){this.milliseconds=10*+J}],SSS:[/\d{3}/,function(J){this.milliseconds=+J}],s:[w,z("seconds")],ss:[w,z("seconds")],m:[w,z("minutes")],mm:[w,z("minutes")],H:[w,z("hours")],h:[w,z("hours")],HH:[w,z("hours")],hh:[w,z("hours")],D:[w,z("day")],DD:[y,z("day")],Do:[i,function(J){var X=O.ordinal,se=J.match(/\d+/);if(this.day=se[0],X)for(var te=1;te<=31;te+=1)X(te).replace(/\[|\]/g,"")===J&&(this.day=te)}],w:[w,z("week")],ww:[y,z("week")],M:[w,z("month")],MM:[y,z("month")],MMM:[i,function(J){var X=N("months"),se=(N("monthsShort")||X.map(function(te){return te.slice(0,3)})).indexOf(J)+1;if(se<1)throw new Error;this.month=se%12||se}],MMMM:[i,function(J){var X=N("months").indexOf(J)+1;if(X<1)throw new Error;this.month=X%12||X}],Y:[/[+-]?\d+/,z("year")],YY:[y,function(J){this.year=L(J)}],YYYY:[/\d{4}/,z("year")],Z:F,ZZ:F};function K(J){var X,se;X=J,se=O&&O.formats;for(var te=(J=X.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(Ee,Re,Qe){var et=Qe&&Qe.toUpperCase();return Re||se[Qe]||o[Qe]||se[et].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(We,me,Oe){return me||Oe.slice(1)})})).match(c),ne=te.length,ue=0;ue<ne;ue+=1){var ge=te[ue],ee=Y[ge],be=ee&&ee[0],Ie=ee&&ee[1];te[ue]=Ie?{regex:be,parser:Ie}:ge.replace(/^\[|\]$/g,"")}return function(Ee){for(var Re={},Qe=0,et=0;Qe<ne;Qe+=1){var We=te[Qe];if(typeof We=="string")et+=We.length;else{var me=We.regex,Oe=We.parser,Fe=Ee.slice(et),Ke=me.exec(Fe)[0];Oe.call(Re,Ke),Ee=Ee.replace(Ke,"")}}return function($e){var pt=$e.afternoon;if(pt!==void 0){var Ct=$e.hours;pt?Ct<12&&($e.hours+=12):Ct===12&&($e.hours=0),delete $e.afternoon}}(Re),Re}}return function(J,X,se){se.p.customParseFormat=!0,J&&J.parseTwoDigitYear&&(L=J.parseTwoDigitYear);var te=X.prototype,ne=te.parse;te.parse=function(ue){var ge=ue.date,ee=ue.utc,be=ue.args;this.$u=ee;var Ie=be[1];if(typeof Ie=="string"){var Ee=be[2]===!0,Re=be[3]===!0,Qe=Ee||Re,et=be[2];Re&&(et=be[2]),O=this.$locale(),!Ee&&et&&(O=se.Ls[et]),this.$d=function(Fe,Ke,$e,pt){try{if(["x","X"].indexOf(Ke)>-1)return new Date((Ke==="X"?1e3:1)*Fe);var Ct=K(Ke)(Fe),Lt=Ct.year,It=Ct.month,_n=Ct.day,Ut=Ct.hours,ln=Ct.minutes,xn=Ct.seconds,En=Ct.milliseconds,Nt=Ct.zone,_e=Ct.week,Ft=new Date,Ve=_n||(Lt||It?1:Ft.getDate()),Ye=Lt||Ft.getFullYear(),je=0;Lt&&!It||(je=It>0?It-1:Ft.getMonth());var Mt,Pt=Ut||0,qt=ln||0,zt=xn||0,Kt=En||0;return Nt?new Date(Date.UTC(Ye,je,Ve,Pt,qt,zt,Kt+60*Nt.offset*1e3)):$e?new Date(Date.UTC(Ye,je,Ve,Pt,qt,zt,Kt)):(Mt=new Date(Ye,je,Ve,Pt,qt,zt,Kt),_e&&(Mt=pt(Mt).week(_e).toDate()),Mt)}catch{return new Date("")}}(ge,Ie,ee,se),this.init(),et&&et!==!0&&(this.$L=this.locale(et).$L),Qe&&ge!=this.format(Ie)&&(this.$d=new Date("")),O={}}else if(Ie instanceof Array)for(var We=Ie.length,me=1;me<=We;me+=1){be[1]=Ie[me-1];var Oe=se.apply(this,be);if(Oe.isValid()){this.$d=Oe.$d,this.$L=Oe.$L,this.init();break}me===We&&(this.$d=new Date(""))}else ne.call(this,ue)}}})}(cv)),cv.exports}var uJ=cJ();const dJ=Ac(uJ);ai.extend(dJ);ai.extend(sJ);ai.extend(VK);ai.extend(GK);ai.extend(YK);ai.extend(QK);ai.extend(rJ);ai.extend((e,t)=>{const o=t.prototype,c=o.format;o.format=function(y){const w=(y||"").replace("Wo","wo");return c.bind(this)(w)}});const hJ={bn_BD:"bn-bd",by_BY:"be",en_GB:"en-gb",en_US:"en",fr_BE:"fr",fr_CA:"fr-ca",hy_AM:"hy-am",kmr_IQ:"ku",nl_BE:"nl-be",pt_BR:"pt-br",zh_CN:"zh-cn",zh_HK:"zh-hk",zh_TW:"zh-tw"},Wd=e=>hJ[e]||e.split("_")[0],Z3=()=>{PV(!1,"Not match any format. Please help to fire a issue about this.")},fJ=/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|k{1,2}|S/g;function Y3(e,t,o){const c=[...new Set(e.split(o))];let d=0;for(let y=0;y<c.length;y++){const w=c[y];if(d+=w.length,d>t)return w;d+=o.length}}const X3=(e,t)=>{if(!e)return null;if(ai.isDayjs(e))return e;const o=t.matchAll(fJ);let c=ai(e,t);if(o===null)return c;for(const d of o){const y=d[0],w=d.index;if(y==="Q"){const i=e.slice(w-1,w),O=Y3(e,w,i).match(/\d+/)[0];c=c.quarter(parseInt(O))}if(y.toLowerCase()==="wo"){const i=e.slice(w-1,w),O=Y3(e,w,i).match(/\d+/)[0];c=c.week(parseInt(O))}y.toLowerCase()==="ww"&&(c=c.week(parseInt(e.slice(w,w+y.length)))),y.toLowerCase()==="w"&&(c=c.week(parseInt(e.slice(w,w+y.length+1))))}return c},pJ={getNow:()=>ai(),getFixedDate:e=>ai(e,["YYYY-M-DD","YYYY-MM-DD"]),getEndDate:e=>e.endOf("month"),getWeekDay:e=>{const t=e.locale("en");return t.weekday()+t.localeData().firstDayOfWeek()},getYear:e=>e.year(),getMonth:e=>e.month(),getDate:e=>e.date(),getHour:e=>e.hour(),getMinute:e=>e.minute(),getSecond:e=>e.second(),addYear:(e,t)=>e.add(t,"year"),addMonth:(e,t)=>e.add(t,"month"),addDate:(e,t)=>e.add(t,"day"),setYear:(e,t)=>e.year(t),setMonth:(e,t)=>e.month(t),setDate:(e,t)=>e.date(t),setHour:(e,t)=>e.hour(t),setMinute:(e,t)=>e.minute(t),setSecond:(e,t)=>e.second(t),isAfter:(e,t)=>e.isAfter(t),isValidate:e=>e.isValid(),locale:{getWeekFirstDay:e=>ai().locale(Wd(e)).localeData().firstDayOfWeek(),getWeekFirstDate:(e,t)=>t.locale(Wd(e)).weekday(0),getWeek:(e,t)=>t.locale(Wd(e)).week(),getShortWeekDays:e=>ai().locale(Wd(e)).localeData().weekdaysMin(),getShortMonths:e=>ai().locale(Wd(e)).localeData().monthsShort(),format:(e,t,o)=>t.locale(Wd(e)).format(o),parse:(e,t,o)=>{const c=Wd(e);for(let d=0;d<o.length;d+=1){const y=o[d],w=t;if(y.includes("wo")||y.includes("Wo")){const O=w.split("-")[0],L=w.split("-")[1],z=ai(O,"YYYY").startOf("year").locale(c);for(let F=0;F<=52;F+=1){const N=z.add(F,"week");if(N.format("Wo")===L)return N}return Z3(),null}const i=ai(w,y,!0).locale(c);if(i.isValid())return i}return t||Z3(),null}},toDate:(e,t)=>Array.isArray(e)?e.map(o=>X3(o,t)):X3(e,t),toString:(e,t)=>Array.isArray(e)?e.map(o=>ai.isDayjs(o)?o.format(t):o):ai.isDayjs(e)?e.format(t):e};function ro(e){const t=iN();return re(re({},e),t)}const f4=Symbol("PanelContextProps"),mJ=e=>{li(f4,e)},Ol=()=>Zr(f4,{}),Ry={visibility:"hidden"};function $u(e,t){let{slots:o}=t;var c;const d=ro(e),{prefixCls:y,prevIcon:w="",nextIcon:i="",superPrevIcon:O="",superNextIcon:L="",onSuperPrev:z,onSuperNext:F,onPrev:N,onNext:G}=d,{hideNextBtn:Y,hidePrevBtn:K}=Ol();return le("div",{class:y},[z&&le("button",{type:"button",onClick:z,tabindex:-1,class:`${y}-super-prev-btn`,style:K.value?Ry:{}},[O]),N&&le("button",{type:"button",onClick:N,tabindex:-1,class:`${y}-prev-btn`,style:K.value?Ry:{}},[w]),le("div",{class:`${y}-view`},[(c=o.default)===null||c===void 0?void 0:c.call(o)]),G&&le("button",{type:"button",onClick:G,tabindex:-1,class:`${y}-next-btn`,style:Y.value?Ry:{}},[i]),F&&le("button",{type:"button",onClick:F,tabindex:-1,class:`${y}-super-next-btn`,style:Y.value?Ry:{}},[L])])}$u.displayName="Header";$u.inheritAttrs=!1;function OC(e){const t=ro(e),{prefixCls:o,generateConfig:c,viewDate:d,onPrevDecades:y,onNextDecades:w}=t,{hideHeader:i}=Ol();if(i)return null;const O=`${o}-header`,L=c.getYear(d),z=Math.floor(L/_c)*_c,F=z+_c-1;return le($u,it(it({},t),{},{prefixCls:O,onSuperPrev:y,onSuperNext:w}),{default:()=>[z,Fi("-"),F]})}OC.displayName="DecadeHeader";OC.inheritAttrs=!1;function p4(e,t,o,c,d){let y=e.setHour(t,o);return y=e.setMinute(y,c),y=e.setSecond(y,d),y}function uv(e,t,o){if(!o)return t;let c=t;return c=e.setHour(c,e.getHour(o)),c=e.setMinute(c,e.getMinute(o)),c=e.setSecond(c,e.getSecond(o)),c}function gJ(e,t,o,c,d,y){const w=Math.floor(e/c)*c;if(w<e)return[w,60-d,60-y];const i=Math.floor(t/d)*d;if(i<t)return[w,i,60-y];const O=Math.floor(o/y)*y;return[w,i,O]}function _J(e,t){const o=e.getYear(t),c=e.getMonth(t)+1,d=e.getEndDate(e.getFixedDate(`${o}-${c}-01`)),y=e.getDate(d),w=c<10?`0${c}`:`${c}`;return`${o}-${w}-${y}`}function Ch(e){const{prefixCls:t,disabledDate:o,onSelect:c,picker:d,rowNum:y,colNum:w,prefixColumn:i,rowClassName:O,baseDate:L,getCellClassName:z,getCellText:F,getCellNode:N,getCellDate:G,generateConfig:Y,titleCell:K,headerCells:J}=ro(e),{onDateMouseenter:X,onDateMouseleave:se,mode:te}=Ol(),ne=`${t}-cell`,ue=[];for(let ge=0;ge<y;ge+=1){const ee=[];let be;for(let Ie=0;Ie<w;Ie+=1){const Ee=ge*w+Ie,Re=G(L,Ee),Qe=PS({cellDate:Re,mode:te.value,disabledDate:o,generateConfig:Y});Ie===0&&(be=Re,i&&ee.push(i(be)));const et=K&&K(Re);ee.push(le("td",{key:Ie,title:et,class:hn(ne,re({[`${ne}-disabled`]:Qe,[`${ne}-start`]:F(Re)===1||d==="year"&&Number(et)%10===0,[`${ne}-end`]:et===_J(Y,Re)||d==="year"&&Number(et)%10===9},z(Re))),onClick:We=>{We.stopPropagation(),Qe||c(Re)},onMouseenter:()=>{!Qe&&X&&X(Re)},onMouseleave:()=>{!Qe&&se&&se(Re)}},[N?N(Re):le("div",{class:`${ne}-inner`},[F(Re)])]))}ue.push(le("tr",{key:ge,class:O&&O(be)},[ee]))}return le("div",{class:`${t}-body`},[le("table",{class:`${t}-content`},[J&&le("thead",null,[le("tr",null,[J])]),le("tbody",null,[ue])])])}Ch.displayName="PanelBody";Ch.inheritAttrs=!1;const IS=3,K3=4;function DC(e){const t=ro(e),o=ks-1,{prefixCls:c,viewDate:d,generateConfig:y}=t,w=`${c}-cell`,i=y.getYear(d),O=Math.floor(i/ks)*ks,L=Math.floor(i/_c)*_c,z=L+_c-1,F=y.setYear(d,L-Math.ceil((IS*K3*ks-_c)/2)),N=G=>{const Y=y.getYear(G),K=Y+o;return{[`${w}-in-view`]:L<=Y&&K<=z,[`${w}-selected`]:Y===O}};return le(Ch,it(it({},t),{},{rowNum:K3,colNum:IS,baseDate:F,getCellText:G=>{const Y=y.getYear(G);return`${Y}-${Y+o}`},getCellClassName:N,getCellDate:(G,Y)=>y.addYear(G,Y*ks)}),null)}DC.displayName="DecadeBody";DC.inheritAttrs=!1;const zy=new Map;function yJ(e,t){let o;function c(){G2(e)?t():o=qr(()=>{c()})}return c(),()=>{qr.cancel(o)}}function AS(e,t,o){if(zy.get(e)&&qr.cancel(zy.get(e)),o<=0){zy.set(e,qr(()=>{e.scrollTop=t}));return}const d=(t-e.scrollTop)/o*10;zy.set(e,qr(()=>{e.scrollTop+=d,e.scrollTop!==t&&AS(e,t,o-10)}))}function _p(e,t){let{onLeftRight:o,onCtrlLeftRight:c,onUpDown:d,onPageUpDown:y,onEnter:w}=t;const{which:i,ctrlKey:O,metaKey:L}=e;switch(i){case nn.LEFT:if(O||L){if(c)return c(-1),!0}else if(o)return o(-1),!0;break;case nn.RIGHT:if(O||L){if(c)return c(1),!0}else if(o)return o(1),!0;break;case nn.UP:if(d)return d(-1),!0;break;case nn.DOWN:if(d)return d(1),!0;break;case nn.PAGE_UP:if(y)return y(-1),!0;break;case nn.PAGE_DOWN:if(y)return y(1),!0;break;case nn.ENTER:if(w)return w(),!0;break}return!1}const vJ=e=>e==="month"||e==="date"?"year":e,xJ=e=>e==="date"?"month":e,bJ=e=>e==="month"||e==="date"?"quarter":e,wJ=e=>e==="date"?"week":e,SJ={year:vJ,month:xJ,quarter:bJ,week:wJ,time:null,date:null},ks=10,_c=ks*10;function RC(e){const t=ro(e),{prefixCls:o,onViewDateChange:c,generateConfig:d,viewDate:y,operationRef:w,onSelect:i,onPanelChange:O}=t,L=`${o}-decade-panel`;w.value={onKeydown:N=>_p(N,{onLeftRight:G=>{i(d.addYear(y,G*ks),"key")},onCtrlLeftRight:G=>{i(d.addYear(y,G*_c),"key")},onUpDown:G=>{i(d.addYear(y,G*ks*IS),"key")},onEnter:()=>{O("year",y)}})};const z=N=>{const G=d.addYear(y,N*_c);c(G),O(null,G)},F=N=>{i(N,"mouse"),O("year",N)};return le("div",{class:L},[le(OC,it(it({},t),{},{prefixCls:o,onPrevDecades:()=>{z(-1)},onNextDecades:()=>{z(1)}}),null),le(DC,it(it({},t),{},{prefixCls:o,onSelect:F}),null)])}RC.displayName="DecadePanel";RC.inheritAttrs=!1;const dv=7;function yp(e,t){if(!e&&!t)return!0;if(!e||!t)return!1}function zC(e,t,o){const c=yp(t,o);return typeof c=="boolean"?c:e.getYear(t)===e.getYear(o)}function J3(e,t){return Math.floor(e.getMonth(t)/3)+1}function CJ(e,t,o){const c=yp(t,o);return typeof c=="boolean"?c:zC(e,t,o)&&J3(e,t)===J3(e,o)}function m4(e,t,o){const c=yp(t,o);return typeof c=="boolean"?c:zC(e,t,o)&&e.getMonth(t)===e.getMonth(o)}function jv(e,t,o){const c=yp(t,o);return typeof c=="boolean"?c:e.getYear(t)===e.getYear(o)&&e.getMonth(t)===e.getMonth(o)&&e.getDate(t)===e.getDate(o)}function TJ(e,t,o){const c=yp(t,o);return typeof c=="boolean"?c:e.getHour(t)===e.getHour(o)&&e.getMinute(t)===e.getMinute(o)&&e.getSecond(t)===e.getSecond(o)}function EJ(e,t,o,c){const d=yp(o,c);return typeof d=="boolean"?d:e.locale.getWeek(t,o)===e.locale.getWeek(t,c)}function Q3(e,t,o){return jv(e,t,o)&&TJ(e,t,o)}function Ly(e,t,o,c){return!t||!o||!c?!1:!jv(e,t,c)&&!jv(e,o,c)&&e.isAfter(c,t)&&e.isAfter(o,c)}function MJ(e,t,o){const c=t.locale.getWeekFirstDay(e),d=t.setDate(o,1),y=t.getWeekDay(d);let w=t.addDate(d,c-y);return t.getMonth(w)===t.getMonth(o)&&t.getDate(w)>1&&(w=t.addDate(w,-7)),w}function Zs(e,t){let{generateConfig:o,locale:c,format:d}=t;return typeof d=="function"?d(e):o.locale.format(c.locale,e,d)}function PS(e){let{cellDate:t,mode:o,disabledDate:c,generateConfig:d}=e;if(!c)return!1;const y=(w,i,O)=>{let L=i;for(;L<=O;){let z;switch(w){case"date":{if(z=d.setDate(t,L),!c(z))return!1;break}case"month":{if(z=d.setMonth(t,L),!PS({cellDate:z,mode:"month",generateConfig:d,disabledDate:c}))return!1;break}case"year":{if(z=d.setYear(t,L),!PS({cellDate:z,mode:"year",generateConfig:d,disabledDate:c}))return!1;break}}L+=1}return!0};switch(o){case"date":case"week":return c(t);case"month":{const i=d.getDate(d.getEndDate(t));return y("date",1,i)}case"quarter":{const w=Math.floor(d.getMonth(t)/3)*3,i=w+2;return y("month",w,i)}case"year":return y("month",0,11);case"decade":{const w=d.getYear(t),i=Math.floor(w/ks)*ks,O=i+ks-1;return y("year",i,O)}}}function LC(e){const t=ro(e),{hideHeader:o}=Ol();if(o.value)return null;const{prefixCls:c,generateConfig:d,locale:y,value:w,format:i}=t,O=`${c}-header`;return le($u,{prefixCls:O},{default:()=>[w?Zs(w,{locale:y,format:i,generateConfig:d}):""]})}LC.displayName="TimeHeader";LC.inheritAttrs=!1;const $y=cn({name:"TimeUnitColumn",props:["prefixCls","units","onSelect","value","active","hideDisabledOptions"],setup(e){const{open:t}=Ol(),o=Xt(null),c=tn(new Map),d=tn();return On(()=>e.value,()=>{const y=c.value.get(e.value);y&&t.value!==!1&&AS(o.value,y.offsetTop,120)}),fi(()=>{var y;(y=d.value)===null||y===void 0||y.call(d)}),On(t,()=>{var y;(y=d.value)===null||y===void 0||y.call(d),si(()=>{if(t.value){const w=c.value.get(e.value);w&&(d.value=yJ(w,()=>{AS(o.value,w.offsetTop,0)}))}})},{immediate:!0,flush:"post"}),()=>{const{prefixCls:y,units:w,onSelect:i,value:O,active:L,hideDisabledOptions:z}=e,F=`${y}-cell`;return le("ul",{class:hn(`${y}-column`,{[`${y}-column-active`]:L}),ref:o,style:{position:"relative"}},[w.map(N=>z&&N.disabled?null:le("li",{key:N.value,ref:G=>{c.value.set(N.value,G)},class:hn(F,{[`${F}-disabled`]:N.disabled,[`${F}-selected`]:O===N.value}),onClick:()=>{N.disabled||i(N.value)}},[le("div",{class:`${F}-inner`},[N.label])]))])}}});function g4(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0",c=String(e);for(;c.length<t;)c=`${o}${e}`;return c}const IJ=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return t};function Fy(e,t){return e?e[t]:null}function Sw(e,t,o,c){const d=[];for(let y=e;y<=t;y+=o)d.push({label:g4(y,2),value:y,disabled:(c||[]).includes(y)});return d}const AJ=cn({compatConfig:{MODE:3},name:"TimeBody",inheritAttrs:!1,props:["generateConfig","prefixCls","operationRef","activeColumnIndex","value","showHour","showMinute","showSecond","use12Hours","hourStep","minuteStep","secondStep","disabledHours","disabledMinutes","disabledSeconds","disabledTime","hideDisabledOptions","onSelect"],setup(e){const t=He(()=>e.value?e.generateConfig.getHour(e.value):-1),o=He(()=>e.use12Hours?t.value>=12:!1),c=He(()=>e.use12Hours?t.value%12:t.value),d=He(()=>e.value?e.generateConfig.getMinute(e.value):-1),y=He(()=>e.value?e.generateConfig.getSecond(e.value):-1),w=tn(e.generateConfig.getNow()),i=tn(),O=tn(),L=tn();_2(()=>{w.value=e.generateConfig.getNow()}),Ii(()=>{if(e.disabledTime){const J=e.disabledTime(w);[i.value,O.value,L.value]=[J.disabledHours,J.disabledMinutes,J.disabledSeconds]}else[i.value,O.value,L.value]=[e.disabledHours,e.disabledMinutes,e.disabledSeconds]});const z=(J,X,se,te)=>{let ne=e.value||e.generateConfig.getNow();const ue=Math.max(0,X),ge=Math.max(0,se),ee=Math.max(0,te);return ne=p4(e.generateConfig,ne,!e.use12Hours||!J?ue:ue+12,ge,ee),ne},F=He(()=>{var J;return Sw(0,23,(J=e.hourStep)!==null&&J!==void 0?J:1,i.value&&i.value())}),N=He(()=>{if(!e.use12Hours)return[!1,!1];const J=[!0,!0];return F.value.forEach(X=>{let{disabled:se,value:te}=X;se||(te>=12?J[1]=!1:J[0]=!1)}),J}),G=He(()=>e.use12Hours?F.value.filter(o.value?J=>J.value>=12:J=>J.value<12).map(J=>{const X=J.value%12,se=X===0?"12":g4(X,2);return re(re({},J),{label:se,value:X})}):F.value),Y=He(()=>{var J;return Sw(0,59,(J=e.minuteStep)!==null&&J!==void 0?J:1,O.value&&O.value(t.value))}),K=He(()=>{var J;return Sw(0,59,(J=e.secondStep)!==null&&J!==void 0?J:1,L.value&&L.value(t.value,d.value))});return()=>{const{prefixCls:J,operationRef:X,activeColumnIndex:se,showHour:te,showMinute:ne,showSecond:ue,use12Hours:ge,hideDisabledOptions:ee,onSelect:be}=e,Ie=[],Ee=`${J}-content`,Re=`${J}-time-panel`;X.value={onUpDown:We=>{const me=Ie[se];if(me){const Oe=me.units.findIndex(Ke=>Ke.value===me.value),Fe=me.units.length;for(let Ke=1;Ke<Fe;Ke+=1){const $e=me.units[(Oe+We*Ke+Fe)%Fe];if($e.disabled!==!0){me.onSelect($e.value);break}}}}};function Qe(We,me,Oe,Fe,Ke){We!==!1&&Ie.push({node:xo(me,{prefixCls:Re,value:Oe,active:se===Ie.length,onSelect:Ke,units:Fe,hideDisabledOptions:ee}),onSelect:Ke,value:Oe,units:Fe})}Qe(te,le($y,{key:"hour"},null),c.value,G.value,We=>{be(z(o.value,We,d.value,y.value),"mouse")}),Qe(ne,le($y,{key:"minute"},null),d.value,Y.value,We=>{be(z(o.value,c.value,We,y.value),"mouse")}),Qe(ue,le($y,{key:"second"},null),y.value,K.value,We=>{be(z(o.value,c.value,d.value,We),"mouse")});let et=-1;return typeof o.value=="boolean"&&(et=o.value?1:0),Qe(ge===!0,le($y,{key:"12hours"},null),et,[{label:"AM",value:0,disabled:N.value[0]},{label:"PM",value:1,disabled:N.value[1]}],We=>{be(z(!!We,c.value,d.value,y.value),"mouse")}),le("div",{class:Ee},[Ie.map(We=>{let{node:me}=We;return me})])}}}),PJ=e=>e.filter(t=>t!==!1).length;function Rx(e){const t=ro(e),{generateConfig:o,format:c="HH:mm:ss",prefixCls:d,active:y,operationRef:w,showHour:i,showMinute:O,showSecond:L,use12Hours:z=!1,onSelect:F,value:N}=t,G=`${d}-time-panel`,Y=tn(),K=tn(-1),J=PJ([i,O,L,z]);return w.value={onKeydown:X=>_p(X,{onLeftRight:se=>{K.value=(K.value+se+J)%J},onUpDown:se=>{K.value===-1?K.value=0:Y.value&&Y.value.onUpDown(se)},onEnter:()=>{F(N||o.getNow(),"key"),K.value=-1}}),onBlur:()=>{K.value=-1}},le("div",{class:hn(G,{[`${G}-active`]:y})},[le(LC,it(it({},t),{},{format:c,prefixCls:d}),null),le(AJ,it(it({},t),{},{prefixCls:d,activeColumnIndex:K.value,operationRef:Y}),null)])}Rx.displayName="TimePanel";Rx.inheritAttrs=!1;function zx(e){let{cellPrefixCls:t,generateConfig:o,rangedValue:c,hoverRangedValue:d,isInView:y,isSameCell:w,offsetCell:i,today:O,value:L}=e;function z(F){const N=i(F,-1),G=i(F,1),Y=Fy(c,0),K=Fy(c,1),J=Fy(d,0),X=Fy(d,1),se=Ly(o,J,X,F);function te(Ie){return w(Y,Ie)}function ne(Ie){return w(K,Ie)}const ue=w(J,F),ge=w(X,F),ee=(se||ge)&&(!y(N)||ne(N)),be=(se||ue)&&(!y(G)||te(G));return{[`${t}-in-view`]:y(F),[`${t}-in-range`]:Ly(o,Y,K,F),[`${t}-range-start`]:te(F),[`${t}-range-end`]:ne(F),[`${t}-range-start-single`]:te(F)&&!K,[`${t}-range-end-single`]:ne(F)&&!Y,[`${t}-range-start-near-hover`]:te(F)&&(w(N,J)||Ly(o,J,X,N)),[`${t}-range-end-near-hover`]:ne(F)&&(w(G,X)||Ly(o,J,X,G)),[`${t}-range-hover`]:se,[`${t}-range-hover-start`]:ue,[`${t}-range-hover-end`]:ge,[`${t}-range-hover-edge-start`]:ee,[`${t}-range-hover-edge-end`]:be,[`${t}-range-hover-edge-start-near-range`]:ee&&w(N,K),[`${t}-range-hover-edge-end-near-range`]:be&&w(G,Y),[`${t}-today`]:w(O,F),[`${t}-selected`]:w(L,F)}}return z}const OJ=Symbol("RangeContextProps"),P_=()=>Zr(OJ,{rangedValue:tn(),hoverRangedValue:tn(),inRange:tn(),panelPosition:tn()});function Lx(e){const t=ro(e),{prefixCls:o,generateConfig:c,prefixColumn:d,locale:y,rowCount:w,viewDate:i,value:O,dateRender:L}=t,{rangedValue:z,hoverRangedValue:F}=P_(),N=MJ(y.locale,c,i),G=`${o}-cell`,Y=c.locale.getWeekFirstDay(y.locale),K=c.getNow(),J=[],X=y.shortWeekDays||(c.locale.getShortWeekDays?c.locale.getShortWeekDays(y.locale):[]);d&&J.push(le("th",{key:"empty","aria-label":"empty cell"},null));for(let ne=0;ne<dv;ne+=1)J.push(le("th",{key:ne},[X[(ne+Y)%dv]]));const se=zx({cellPrefixCls:G,today:K,value:O,generateConfig:c,rangedValue:d?null:z.value,hoverRangedValue:d?null:F.value,isSameCell:(ne,ue)=>jv(c,ne,ue),isInView:ne=>m4(c,ne,i),offsetCell:(ne,ue)=>c.addDate(ne,ue)}),te=L?ne=>L({current:ne,today:K}):void 0;return le(Ch,it(it({},t),{},{rowNum:w,colNum:dv,baseDate:N,getCellNode:te,getCellText:c.getDate,getCellClassName:se,getCellDate:c.addDate,titleCell:ne=>Zs(ne,{locale:y,format:"YYYY-MM-DD",generateConfig:c}),headerCells:J}),null)}Lx.displayName="DateBody";Lx.inheritAttrs=!1;Lx.props=["prefixCls","generateConfig","value?","viewDate","locale","rowCount","onSelect","dateRender?","disabledDate?","prefixColumn?","rowClassName?"];function $C(e){const t=ro(e),{prefixCls:o,generateConfig:c,locale:d,viewDate:y,onNextMonth:w,onPrevMonth:i,onNextYear:O,onPrevYear:L,onYearClick:z,onMonthClick:F}=t,{hideHeader:N}=Ol();if(N.value)return null;const G=`${o}-header`,Y=d.shortMonths||(c.locale.getShortMonths?c.locale.getShortMonths(d.locale):[]),K=c.getMonth(y),J=le("button",{type:"button",key:"year",onClick:z,tabindex:-1,class:`${o}-year-btn`},[Zs(y,{locale:d,format:d.yearFormat,generateConfig:c})]),X=le("button",{type:"button",key:"month",onClick:F,tabindex:-1,class:`${o}-month-btn`},[d.monthFormat?Zs(y,{locale:d,format:d.monthFormat,generateConfig:c}):Y[K]]),se=d.monthBeforeYear?[X,J]:[J,X];return le($u,it(it({},t),{},{prefixCls:G,onSuperPrev:L,onPrev:i,onNext:w,onSuperNext:O}),{default:()=>[se]})}$C.displayName="DateHeader";$C.inheritAttrs=!1;const DJ=6;function O_(e){const t=ro(e),{prefixCls:o,panelName:c="date",keyboardConfig:d,active:y,operationRef:w,generateConfig:i,value:O,viewDate:L,onViewDateChange:z,onPanelChange:F,onSelect:N}=t,G=`${o}-${c}-panel`;w.value={onKeydown:J=>_p(J,re({onLeftRight:X=>{N(i.addDate(O||L,X),"key")},onCtrlLeftRight:X=>{N(i.addYear(O||L,X),"key")},onUpDown:X=>{N(i.addDate(O||L,X*dv),"key")},onPageUpDown:X=>{N(i.addMonth(O||L,X),"key")}},d))};const Y=J=>{const X=i.addYear(L,J);z(X),F(null,X)},K=J=>{const X=i.addMonth(L,J);z(X),F(null,X)};return le("div",{class:hn(G,{[`${G}-active`]:y})},[le($C,it(it({},t),{},{prefixCls:o,value:O,viewDate:L,onPrevYear:()=>{Y(-1)},onNextYear:()=>{Y(1)},onPrevMonth:()=>{K(-1)},onNextMonth:()=>{K(1)},onMonthClick:()=>{F("month",L)},onYearClick:()=>{F("year",L)}}),null),le(Lx,it(it({},t),{},{onSelect:J=>N(J,"mouse"),prefixCls:o,value:O,viewDate:L,rowCount:DJ}),null)])}O_.displayName="DatePanel";O_.inheritAttrs=!1;const eO=IJ("date","time");function FC(e){const t=ro(e),{prefixCls:o,operationRef:c,generateConfig:d,value:y,defaultValue:w,disabledTime:i,showTime:O,onSelect:L}=t,z=`${o}-datetime-panel`,F=tn(null),N=tn({}),G=tn({}),Y=typeof O=="object"?re({},O):{};function K(te){const ne=eO.indexOf(F.value)+te;return eO[ne]||null}const J=te=>{G.value.onBlur&&G.value.onBlur(te),F.value=null};c.value={onKeydown:te=>{if(te.which===nn.TAB){const ne=K(te.shiftKey?-1:1);return F.value=ne,ne&&te.preventDefault(),!0}if(F.value){const ne=F.value==="date"?N:G;return ne.value&&ne.value.onKeydown&&ne.value.onKeydown(te),!0}return[nn.LEFT,nn.RIGHT,nn.UP,nn.DOWN].includes(te.which)?(F.value="date",!0):!1},onBlur:J,onClose:J};const X=(te,ne)=>{let ue=te;ne==="date"&&!y&&Y.defaultValue?(ue=d.setHour(ue,d.getHour(Y.defaultValue)),ue=d.setMinute(ue,d.getMinute(Y.defaultValue)),ue=d.setSecond(ue,d.getSecond(Y.defaultValue))):ne==="time"&&!y&&w&&(ue=d.setYear(ue,d.getYear(w)),ue=d.setMonth(ue,d.getMonth(w)),ue=d.setDate(ue,d.getDate(w))),L&&L(ue,"mouse")},se=i?i(y||null):{};return le("div",{class:hn(z,{[`${z}-active`]:F.value})},[le(O_,it(it({},t),{},{operationRef:N,active:F.value==="date",onSelect:te=>{X(uv(d,te,!y&&typeof O=="object"?O.defaultValue:null),"date")}}),null),le(Rx,it(it(it(it({},t),{},{format:void 0},Y),se),{},{disabledTime:null,defaultValue:void 0,operationRef:G,active:F.value==="time",onSelect:te=>{X(te,"time")}}),null)])}FC.displayName="DatetimePanel";FC.inheritAttrs=!1;function BC(e){const t=ro(e),{prefixCls:o,generateConfig:c,locale:d,value:y}=t,w=`${o}-cell`,i=z=>le("td",{key:"week",class:hn(w,`${w}-week`)},[c.locale.getWeek(d.locale,z)]),O=`${o}-week-panel-row`,L=z=>hn(O,{[`${O}-selected`]:EJ(c,d.locale,y,z)});return le(O_,it(it({},t),{},{panelName:"week",prefixColumn:i,rowClassName:L,keyboardConfig:{onLeftRight:null}}),null)}BC.displayName="WeekPanel";BC.inheritAttrs=!1;function kC(e){const t=ro(e),{prefixCls:o,generateConfig:c,locale:d,viewDate:y,onNextYear:w,onPrevYear:i,onYearClick:O}=t,{hideHeader:L}=Ol();if(L.value)return null;const z=`${o}-header`;return le($u,it(it({},t),{},{prefixCls:z,onSuperPrev:i,onSuperNext:w}),{default:()=>[le("button",{type:"button",onClick:O,class:`${o}-year-btn`},[Zs(y,{locale:d,format:d.yearFormat,generateConfig:c})])]})}kC.displayName="MonthHeader";kC.inheritAttrs=!1;const _4=3,RJ=4;function NC(e){const t=ro(e),{prefixCls:o,locale:c,value:d,viewDate:y,generateConfig:w,monthCellRender:i}=t,{rangedValue:O,hoverRangedValue:L}=P_(),z=`${o}-cell`,F=zx({cellPrefixCls:z,value:d,generateConfig:w,rangedValue:O.value,hoverRangedValue:L.value,isSameCell:(K,J)=>m4(w,K,J),isInView:()=>!0,offsetCell:(K,J)=>w.addMonth(K,J)}),N=c.shortMonths||(w.locale.getShortMonths?w.locale.getShortMonths(c.locale):[]),G=w.setMonth(y,0),Y=i?K=>i({current:K,locale:c}):void 0;return le(Ch,it(it({},t),{},{rowNum:RJ,colNum:_4,baseDate:G,getCellNode:Y,getCellText:K=>c.monthFormat?Zs(K,{locale:c,format:c.monthFormat,generateConfig:w}):N[w.getMonth(K)],getCellClassName:F,getCellDate:w.addMonth,titleCell:K=>Zs(K,{locale:c,format:"YYYY-MM",generateConfig:w})}),null)}NC.displayName="MonthBody";NC.inheritAttrs=!1;function VC(e){const t=ro(e),{prefixCls:o,operationRef:c,onViewDateChange:d,generateConfig:y,value:w,viewDate:i,onPanelChange:O,onSelect:L}=t,z=`${o}-month-panel`;c.value={onKeydown:N=>_p(N,{onLeftRight:G=>{L(y.addMonth(w||i,G),"key")},onCtrlLeftRight:G=>{L(y.addYear(w||i,G),"key")},onUpDown:G=>{L(y.addMonth(w||i,G*_4),"key")},onEnter:()=>{O("date",w||i)}})};const F=N=>{const G=y.addYear(i,N);d(G),O(null,G)};return le("div",{class:z},[le(kC,it(it({},t),{},{prefixCls:o,onPrevYear:()=>{F(-1)},onNextYear:()=>{F(1)},onYearClick:()=>{O("year",i)}}),null),le(NC,it(it({},t),{},{prefixCls:o,onSelect:N=>{L(N,"mouse"),O("date",N)}}),null)])}VC.displayName="MonthPanel";VC.inheritAttrs=!1;function jC(e){const t=ro(e),{prefixCls:o,generateConfig:c,locale:d,viewDate:y,onNextYear:w,onPrevYear:i,onYearClick:O}=t,{hideHeader:L}=Ol();if(L.value)return null;const z=`${o}-header`;return le($u,it(it({},t),{},{prefixCls:z,onSuperPrev:i,onSuperNext:w}),{default:()=>[le("button",{type:"button",onClick:O,class:`${o}-year-btn`},[Zs(y,{locale:d,format:d.yearFormat,generateConfig:c})])]})}jC.displayName="QuarterHeader";jC.inheritAttrs=!1;const zJ=4,LJ=1;function UC(e){const t=ro(e),{prefixCls:o,locale:c,value:d,viewDate:y,generateConfig:w}=t,{rangedValue:i,hoverRangedValue:O}=P_(),L=`${o}-cell`,z=zx({cellPrefixCls:L,value:d,generateConfig:w,rangedValue:i.value,hoverRangedValue:O.value,isSameCell:(N,G)=>CJ(w,N,G),isInView:()=>!0,offsetCell:(N,G)=>w.addMonth(N,G*3)}),F=w.setDate(w.setMonth(y,0),1);return le(Ch,it(it({},t),{},{rowNum:LJ,colNum:zJ,baseDate:F,getCellText:N=>Zs(N,{locale:c,format:c.quarterFormat||"[Q]Q",generateConfig:w}),getCellClassName:z,getCellDate:(N,G)=>w.addMonth(N,G*3),titleCell:N=>Zs(N,{locale:c,format:"YYYY-[Q]Q",generateConfig:w})}),null)}UC.displayName="QuarterBody";UC.inheritAttrs=!1;function HC(e){const t=ro(e),{prefixCls:o,operationRef:c,onViewDateChange:d,generateConfig:y,value:w,viewDate:i,onPanelChange:O,onSelect:L}=t,z=`${o}-quarter-panel`;c.value={onKeydown:N=>_p(N,{onLeftRight:G=>{L(y.addMonth(w||i,G*3),"key")},onCtrlLeftRight:G=>{L(y.addYear(w||i,G),"key")},onUpDown:G=>{L(y.addYear(w||i,G),"key")}})};const F=N=>{const G=y.addYear(i,N);d(G),O(null,G)};return le("div",{class:z},[le(jC,it(it({},t),{},{prefixCls:o,onPrevYear:()=>{F(-1)},onNextYear:()=>{F(1)},onYearClick:()=>{O("year",i)}}),null),le(UC,it(it({},t),{},{prefixCls:o,onSelect:N=>{L(N,"mouse")}}),null)])}HC.displayName="QuarterPanel";HC.inheritAttrs=!1;function GC(e){const t=ro(e),{prefixCls:o,generateConfig:c,viewDate:d,onPrevDecade:y,onNextDecade:w,onDecadeClick:i}=t,{hideHeader:O}=Ol();if(O.value)return null;const L=`${o}-header`,z=c.getYear(d),F=Math.floor(z/bu)*bu,N=F+bu-1;return le($u,it(it({},t),{},{prefixCls:L,onSuperPrev:y,onSuperNext:w}),{default:()=>[le("button",{type:"button",onClick:i,class:`${o}-decade-btn`},[F,Fi("-"),N])]})}GC.displayName="YearHeader";GC.inheritAttrs=!1;const OS=3,tO=4;function WC(e){const t=ro(e),{prefixCls:o,value:c,viewDate:d,locale:y,generateConfig:w}=t,{rangedValue:i,hoverRangedValue:O}=P_(),L=`${o}-cell`,z=w.getYear(d),F=Math.floor(z/bu)*bu,N=F+bu-1,G=w.setYear(d,F-Math.ceil((OS*tO-bu)/2)),Y=J=>{const X=w.getYear(J);return F<=X&&X<=N},K=zx({cellPrefixCls:L,value:c,generateConfig:w,rangedValue:i.value,hoverRangedValue:O.value,isSameCell:(J,X)=>zC(w,J,X),isInView:Y,offsetCell:(J,X)=>w.addYear(J,X)});return le(Ch,it(it({},t),{},{rowNum:tO,colNum:OS,baseDate:G,getCellText:w.getYear,getCellClassName:K,getCellDate:w.addYear,titleCell:J=>Zs(J,{locale:y,format:"YYYY",generateConfig:w})}),null)}WC.displayName="YearBody";WC.inheritAttrs=!1;const bu=10;function qC(e){const t=ro(e),{prefixCls:o,operationRef:c,onViewDateChange:d,generateConfig:y,value:w,viewDate:i,sourceMode:O,onSelect:L,onPanelChange:z}=t,F=`${o}-year-panel`;c.value={onKeydown:G=>_p(G,{onLeftRight:Y=>{L(y.addYear(w||i,Y),"key")},onCtrlLeftRight:Y=>{L(y.addYear(w||i,Y*bu),"key")},onUpDown:Y=>{L(y.addYear(w||i,Y*OS),"key")},onEnter:()=>{z(O==="date"?"date":"month",w||i)}})};const N=G=>{const Y=y.addYear(i,G*10);d(Y),z(null,Y)};return le("div",{class:F},[le(GC,it(it({},t),{},{prefixCls:o,onPrevDecade:()=>{N(-1)},onNextDecade:()=>{N(1)},onDecadeClick:()=>{z("decade",i)}}),null),le(WC,it(it({},t),{},{prefixCls:o,onSelect:G=>{z(O==="date"?"date":"month",G),L(G,"mouse")}}),null)])}qC.displayName="YearPanel";qC.inheritAttrs=!1;function $J(e,t,o){return o?le("div",{class:`${e}-footer-extra`},[o(t)]):null}function FJ(e){let{prefixCls:t,components:o={},needConfirmButton:c,onNow:d,onOk:y,okDisabled:w,showNow:i,locale:O}=e,L,z;if(c){const F=o.button||"button";d&&i!==!1&&(L=le("li",{class:`${t}-now`},[le("a",{class:`${t}-now-btn`,onClick:d},[O.now])])),z=c&&le("li",{class:`${t}-ok`},[le(F,{disabled:w,onClick:N=>{N.stopPropagation(),y&&y()}},{default:()=>[O.ok]})])}return!L&&!z?null:le("ul",{class:`${t}-ranges`},[L,z])}function BJ(){return cn({name:"PickerPanel",inheritAttrs:!1,props:{prefixCls:String,locale:Object,generateConfig:Object,value:Object,defaultValue:Object,pickerValue:Object,defaultPickerValue:Object,disabledDate:Function,mode:String,picker:{type:String,default:"date"},tabindex:{type:[Number,String],default:0},showNow:{type:Boolean,default:void 0},showTime:[Boolean,Object],showToday:Boolean,renderExtraFooter:Function,dateRender:Function,hideHeader:{type:Boolean,default:void 0},onSelect:Function,onChange:Function,onPanelChange:Function,onMousedown:Function,onPickerValueChange:Function,onOk:Function,components:Object,direction:String,hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},secondStep:{type:Number,default:1}},setup(e,t){let{attrs:o}=t;const c=He(()=>e.picker==="date"&&!!e.showTime||e.picker==="time"),d=He(()=>24%e.hourStep===0),y=He(()=>60%e.minuteStep===0),w=He(()=>60%e.secondStep===0),i=Ol(),{operationRef:O,onSelect:L,hideRanges:z,defaultOpenValue:F}=i,{inRange:N,panelPosition:G,rangedValue:Y,hoverRangedValue:K}=P_(),J=tn({}),[X,se]=oh(null,{value:ra(e,"value"),defaultValue:e.defaultValue,postState:Fe=>!Fe&&(F!=null&&F.value)&&e.picker==="time"?F.value:Fe}),[te,ne]=oh(null,{value:ra(e,"pickerValue"),defaultValue:e.defaultPickerValue||X.value,postState:Fe=>{const{generateConfig:Ke,showTime:$e,defaultValue:pt}=e,Ct=Ke.getNow();return Fe?!X.value&&e.showTime?typeof $e=="object"?uv(Ke,Array.isArray(Fe)?Fe[0]:Fe,$e.defaultValue||Ct):pt?uv(Ke,Array.isArray(Fe)?Fe[0]:Fe,pt):uv(Ke,Array.isArray(Fe)?Fe[0]:Fe,Ct):Fe:Ct}}),ue=Fe=>{ne(Fe),e.onPickerValueChange&&e.onPickerValueChange(Fe)},ge=Fe=>{const Ke=SJ[e.picker];return Ke?Ke(Fe):Fe},[ee,be]=oh(()=>e.picker==="time"?"time":ge("date"),{value:ra(e,"mode")});On(()=>e.picker,()=>{be(e.picker)});const Ie=tn(ee.value),Ee=Fe=>{Ie.value=Fe},Re=(Fe,Ke)=>{const{onPanelChange:$e,generateConfig:pt}=e,Ct=ge(Fe||ee.value);Ee(ee.value),be(Ct),$e&&(ee.value!==Ct||Q3(pt,te.value,te.value))&&$e(Ke,Ct)},Qe=function(Fe,Ke){let $e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{picker:pt,generateConfig:Ct,onSelect:Lt,onChange:It,disabledDate:_n}=e;(ee.value===pt||$e)&&(se(Fe),Lt&&Lt(Fe),L&&L(Fe,Ke),It&&!Q3(Ct,Fe,X.value)&&!(_n!=null&&_n(Fe))&&It(Fe))},et=Fe=>J.value&&J.value.onKeydown?([nn.LEFT,nn.RIGHT,nn.UP,nn.DOWN,nn.PAGE_UP,nn.PAGE_DOWN,nn.ENTER].includes(Fe.which)&&Fe.preventDefault(),J.value.onKeydown(Fe)):!1,We=Fe=>{J.value&&J.value.onBlur&&J.value.onBlur(Fe)},me=()=>{const{generateConfig:Fe,hourStep:Ke,minuteStep:$e,secondStep:pt}=e,Ct=Fe.getNow(),Lt=gJ(Fe.getHour(Ct),Fe.getMinute(Ct),Fe.getSecond(Ct),d.value?Ke:1,y.value?$e:1,w.value?pt:1),It=p4(Fe,Ct,Lt[0],Lt[1],Lt[2]);Qe(It,"submit")},Oe=He(()=>{const{prefixCls:Fe,direction:Ke}=e;return hn(`${Fe}-panel`,{[`${Fe}-panel-has-range`]:Y&&Y.value&&Y.value[0]&&Y.value[1],[`${Fe}-panel-has-range-hover`]:K&&K.value&&K.value[0]&&K.value[1],[`${Fe}-panel-rtl`]:Ke==="rtl"})});return mJ(re(re({},i),{mode:ee,hideHeader:He(()=>{var Fe;return e.hideHeader!==void 0?e.hideHeader:(Fe=i.hideHeader)===null||Fe===void 0?void 0:Fe.value}),hidePrevBtn:He(()=>N.value&&G.value==="right"),hideNextBtn:He(()=>N.value&&G.value==="left")})),On(()=>e.value,()=>{e.value&&ne(e.value)}),()=>{const{prefixCls:Fe="ant-picker",locale:Ke,generateConfig:$e,disabledDate:pt,picker:Ct="date",tabindex:Lt=0,showNow:It,showTime:_n,showToday:Ut,renderExtraFooter:ln,onMousedown:xn,onOk:En,components:Nt}=e;O&&G.value!=="right"&&(O.value={onKeydown:et,onClose:()=>{J.value&&J.value.onClose&&J.value.onClose()}});let _e;const Ft=re(re(re({},o),e),{operationRef:J,prefixCls:Fe,viewDate:te.value,value:X.value,onViewDateChange:ue,sourceMode:Ie.value,onPanelChange:Re,disabledDate:pt});switch(delete Ft.onChange,delete Ft.onSelect,ee.value){case"decade":_e=le(RC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;case"year":_e=le(qC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;case"month":_e=le(VC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;case"quarter":_e=le(HC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;case"week":_e=le(BC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;case"time":delete Ft.showTime,_e=le(Rx,it(it(it({},Ft),typeof _n=="object"?_n:null),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null);break;default:_n?_e=le(FC,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null):_e=le(O_,it(it({},Ft),{},{onSelect:(Mt,Pt)=>{ue(Mt),Qe(Mt,Pt)}}),null)}let Ve,Ye;z!=null&&z.value||(Ve=$J(Fe,ee.value,ln),Ye=FJ({prefixCls:Fe,components:Nt,needConfirmButton:c.value,okDisabled:!X.value||pt&&pt(X.value),locale:Ke,showNow:It,onNow:c.value&&me,onOk:()=>{X.value&&(Qe(X.value,"submit",!0),En&&En(X.value))}}));let je;if(Ut&&ee.value==="date"&&Ct==="date"&&!_n){const Mt=$e.getNow(),Pt=`${Fe}-today-btn`,qt=pt&&pt(Mt);je=le("a",{class:hn(Pt,qt&&`${Pt}-disabled`),"aria-disabled":qt,onClick:()=>{qt||Qe(Mt,"mouse",!0)}},[Ke.today])}return le("div",{tabindex:Lt,class:hn(Oe.value,o.class),style:o.style,onKeydown:et,onBlur:We,onMousedown:xn},[_e,Ve||Ye||je?le("div",{class:`${Fe}-footer`},[Ve,Ye,je]):null])}}})}const kJ=BJ(),NJ=e=>le(kJ,e);var VJ=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const jJ={prefixCls:String,name:String,id:String,type:String,defaultChecked:{type:[Boolean,Number],default:void 0},checked:{type:[Boolean,Number],default:void 0},disabled:Boolean,tabindex:{type:[Number,String]},readonly:Boolean,autofocus:Boolean,value:wt.any,required:Boolean},y4=cn({compatConfig:{MODE:3},name:"Checkbox",inheritAttrs:!1,props:Wo(jJ,{prefixCls:"rc-checkbox",type:"checkbox",defaultChecked:!1}),emits:["click","change"],setup(e,t){let{attrs:o,emit:c,expose:d}=t;const y=tn(e.checked===void 0?e.defaultChecked:e.checked),w=tn();On(()=>e.checked,()=>{y.value=e.checked}),d({focus(){var z;(z=w.value)===null||z===void 0||z.focus()},blur(){var z;(z=w.value)===null||z===void 0||z.blur()}});const i=tn(),O=z=>{if(e.disabled)return;e.checked===void 0&&(y.value=z.target.checked),z.shiftKey=i.value;const F={target:re(re({},e),{checked:z.target.checked}),stopPropagation(){z.stopPropagation()},preventDefault(){z.preventDefault()},nativeEvent:z};e.checked!==void 0&&(w.value.checked=!!e.checked),c("change",F),i.value=!1},L=z=>{c("click",z),i.value=z.shiftKey};return()=>{const{prefixCls:z,name:F,id:N,type:G,disabled:Y,readonly:K,tabindex:J,autofocus:X,value:se,required:te}=e,ne=VJ(e,["prefixCls","name","id","type","disabled","readonly","tabindex","autofocus","value","required"]),{class:ue,onFocus:ge,onBlur:ee,onKeydown:be,onKeypress:Ie,onKeyup:Ee}=o,Re=re(re({},ne),o),Qe=Object.keys(Re).reduce((me,Oe)=>((Oe.startsWith("data-")||Oe.startsWith("aria-")||Oe==="role")&&(me[Oe]=Re[Oe]),me),{}),et=hn(z,ue,{[`${z}-checked`]:y.value,[`${z}-disabled`]:Y}),We=re(re({name:F,id:N,type:G,readonly:K,disabled:Y,tabindex:J,class:`${z}-input`,checked:!!y.value,autofocus:X,value:se},Qe),{onChange:O,onClick:L,onFocus:ge,onBlur:ee,onKeydown:be,onKeypress:Ie,onKeyup:Ee,required:te});return le("span",{class:et},[le("input",it({ref:w},We),null),le("span",{class:`${z}-inner`},null)])}}}),v4=Symbol("radioGroupContextKey"),UJ=e=>{li(v4,e)},HJ=()=>Zr(v4,void 0),x4=Symbol("radioOptionTypeContextKey"),GJ=e=>{li(x4,e)},WJ=()=>Zr(x4,void 0),qJ=new xr("antRadioEffect",{"0%":{transform:"scale(1)",opacity:.5},"100%":{transform:"scale(1.6)",opacity:0}}),ZJ=e=>{const{componentCls:t,antCls:o}=e,c=`${t}-group`;return{[c]:re(re({},Ei(e)),{display:"inline-block",fontSize:0,[`&${c}-rtl`]:{direction:"rtl"},[`${o}-badge ${o}-badge-count`]:{zIndex:1},[`> ${o}-badge:not(:first-child) > ${o}-button-wrapper`]:{borderInlineStart:"none"}})}},YJ=e=>{const{componentCls:t,radioWrapperMarginRight:o,radioCheckedColor:c,radioSize:d,motionDurationSlow:y,motionDurationMid:w,motionEaseInOut:i,motionEaseInOutCirc:O,radioButtonBg:L,colorBorder:z,lineWidth:F,radioDotSize:N,colorBgContainerDisabled:G,colorTextDisabled:Y,paddingXS:K,radioDotDisabledColor:J,lineType:X,radioDotDisabledSize:se,wireframe:te,colorWhite:ne}=e,ue=`${t}-inner`;return{[`${t}-wrapper`]:re(re({},Ei(e)),{position:"relative",display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:o,cursor:"pointer",[`&${t}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:e.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},[`${t}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${F}px ${X} ${c}`,borderRadius:"50%",visibility:"hidden",animationName:qJ,animationDuration:y,animationTimingFunction:i,animationFillMode:"both",content:'""'},[t]:re(re({},Ei(e)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center"}),[`${t}-wrapper:hover &,
        &:hover ${ue}`]:{borderColor:c},[`${t}-input:focus-visible + ${ue}`]:re({},px(e)),[`${t}:hover::after, ${t}-wrapper:hover &::after`]:{visibility:"visible"},[`${t}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:d,height:d,marginBlockStart:d/-2,marginInlineStart:d/-2,backgroundColor:te?c:ne,borderBlockStart:0,borderInlineStart:0,borderRadius:d,transform:"scale(0)",opacity:0,transition:`all ${y} ${O}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:d,height:d,backgroundColor:L,borderColor:z,borderStyle:"solid",borderWidth:F,borderRadius:"50%",transition:`all ${w}`},[`${t}-input`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,insetBlockEnd:0,insetInlineStart:0,zIndex:1,cursor:"pointer",opacity:0},[`${t}-checked`]:{[ue]:{borderColor:c,backgroundColor:te?L:c,"&::after":{transform:`scale(${N/d})`,opacity:1,transition:`all ${y} ${O}`}}},[`${t}-disabled`]:{cursor:"not-allowed",[ue]:{backgroundColor:G,borderColor:z,cursor:"not-allowed","&::after":{backgroundColor:J}},[`${t}-input`]:{cursor:"not-allowed"},[`${t}-disabled + span`]:{color:Y,cursor:"not-allowed"},[`&${t}-checked`]:{[ue]:{"&::after":{transform:`scale(${se/d})`}}}},[`span${t} + *`]:{paddingInlineStart:K,paddingInlineEnd:K}})}},XJ=e=>{const{radioButtonColor:t,controlHeight:o,componentCls:c,lineWidth:d,lineType:y,colorBorder:w,motionDurationSlow:i,motionDurationMid:O,radioButtonPaddingHorizontal:L,fontSize:z,radioButtonBg:F,fontSizeLG:N,controlHeightLG:G,controlHeightSM:Y,paddingXS:K,borderRadius:J,borderRadiusSM:X,borderRadiusLG:se,radioCheckedColor:te,radioButtonCheckedBg:ne,radioButtonHoverColor:ue,radioButtonActiveColor:ge,radioSolidCheckedColor:ee,colorTextDisabled:be,colorBgContainerDisabled:Ie,radioDisabledButtonCheckedColor:Ee,radioDisabledButtonCheckedBg:Re}=e;return{[`${c}-button-wrapper`]:{position:"relative",display:"inline-block",height:o,margin:0,paddingInline:L,paddingBlock:0,color:t,fontSize:z,lineHeight:`${o-d*2}px`,background:F,border:`${d}px ${y} ${w}`,borderBlockStartWidth:d+.02,borderInlineStartWidth:0,borderInlineEndWidth:d,cursor:"pointer",transition:[`color ${O}`,`background ${O}`,`border-color ${O}`,`box-shadow ${O}`].join(","),a:{color:t},[`> ${c}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:-d,insetInlineStart:-d,display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:d,paddingInline:0,backgroundColor:w,transition:`background-color ${i}`,content:'""'}},"&:first-child":{borderInlineStart:`${d}px ${y} ${w}`,borderStartStartRadius:J,borderEndStartRadius:J},"&:last-child":{borderStartEndRadius:J,borderEndEndRadius:J},"&:first-child:last-child":{borderRadius:J},[`${c}-group-large &`]:{height:G,fontSize:N,lineHeight:`${G-d*2}px`,"&:first-child":{borderStartStartRadius:se,borderEndStartRadius:se},"&:last-child":{borderStartEndRadius:se,borderEndEndRadius:se}},[`${c}-group-small &`]:{height:Y,paddingInline:K-d,paddingBlock:0,lineHeight:`${Y-d*2}px`,"&:first-child":{borderStartStartRadius:X,borderEndStartRadius:X},"&:last-child":{borderStartEndRadius:X,borderEndEndRadius:X}},"&:hover":{position:"relative",color:te},"&:has(:focus-visible)":re({},px(e)),[`${c}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${c}-button-wrapper-disabled)`]:{zIndex:1,color:te,background:ne,borderColor:te,"&::before":{backgroundColor:te},"&:first-child":{borderColor:te},"&:hover":{color:ue,borderColor:ue,"&::before":{backgroundColor:ue}},"&:active":{color:ge,borderColor:ge,"&::before":{backgroundColor:ge}}},[`${c}-group-solid &-checked:not(${c}-button-wrapper-disabled)`]:{color:ee,background:te,borderColor:te,"&:hover":{color:ee,background:ue,borderColor:ue},"&:active":{color:ee,background:ge,borderColor:ge}},"&-disabled":{color:be,backgroundColor:Ie,borderColor:w,cursor:"not-allowed","&:first-child, &:hover":{color:be,backgroundColor:Ie,borderColor:w}},[`&-disabled${c}-button-wrapper-checked`]:{color:Ee,backgroundColor:Re,borderColor:w,boxShadow:"none"}}}},b4=Ui("Radio",e=>{const{padding:t,lineWidth:o,controlItemBgActiveDisabled:c,colorTextDisabled:d,colorBgContainer:y,fontSizeLG:w,controlOutline:i,colorPrimaryHover:O,colorPrimaryActive:L,colorText:z,colorPrimary:F,marginXS:N,controlOutlineWidth:G,colorTextLightSolid:Y,wireframe:K}=e,J=`0 0 0 ${G}px ${i}`,X=J,se=w,te=4,ne=se-te*2,ue=K?ne:se-(te+o)*2,ge=F,ee=z,be=O,Ie=L,Ee=t-o,et=Wr(e,{radioFocusShadow:J,radioButtonFocusShadow:X,radioSize:se,radioDotSize:ue,radioDotDisabledSize:ne,radioCheckedColor:ge,radioDotDisabledColor:d,radioSolidCheckedColor:Y,radioButtonBg:y,radioButtonCheckedBg:y,radioButtonColor:ee,radioButtonHoverColor:be,radioButtonActiveColor:Ie,radioButtonPaddingHorizontal:Ee,radioDisabledButtonCheckedBg:c,radioDisabledButtonCheckedColor:d,radioWrapperMarginRight:N});return[ZJ(et),YJ(et),XJ(et)]});var KJ=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const w4=()=>({prefixCls:String,checked:Cr(),disabled:Cr(),isGroup:Cr(),value:wt.any,name:String,id:String,autofocus:Cr(),onChange:Jr(),onFocus:Jr(),onBlur:Jr(),onClick:Jr(),"onUpdate:checked":Jr(),"onUpdate:value":Jr()}),ds=cn({compatConfig:{MODE:3},name:"ARadio",inheritAttrs:!1,props:w4(),setup(e,t){let{emit:o,expose:c,slots:d,attrs:y}=t;const w=Ic(),i=xs.useInject(),O=WJ(),L=HJ(),z=yc(),F=He(()=>{var be;return(be=K.value)!==null&&be!==void 0?be:z.value}),N=tn(),{prefixCls:G,direction:Y,disabled:K}=Rr("radio",e),J=He(()=>(L==null?void 0:L.optionType.value)==="button"||O==="button"?`${G.value}-button`:G.value),X=yc(),[se,te]=b4(G);c({focus:()=>{N.value.focus()},blur:()=>{N.value.blur()}});const ge=be=>{const Ie=be.target.checked;o("update:checked",Ie),o("update:value",Ie),o("change",be),w.onFieldChange()},ee=be=>{o("change",be),L&&L.onChange&&L.onChange(be)};return()=>{var be;const Ie=L,{prefixCls:Ee,id:Re=w.id.value}=e,Qe=KJ(e,["prefixCls","id"]),et=re(re({prefixCls:J.value,id:Re},co(Qe,["onUpdate:checked","onUpdate:value"])),{disabled:(be=K.value)!==null&&be!==void 0?be:X.value});Ie?(et.name=Ie.name.value,et.onChange=ee,et.checked=e.value===Ie.value.value,et.disabled=F.value||Ie.disabled.value):et.onChange=ge;const We=hn({[`${J.value}-wrapper`]:!0,[`${J.value}-wrapper-checked`]:et.checked,[`${J.value}-wrapper-disabled`]:et.disabled,[`${J.value}-wrapper-rtl`]:Y.value==="rtl",[`${J.value}-wrapper-in-form-item`]:i.isFormItemInput},y.class,te.value);return se(le("label",it(it({},y),{},{class:We}),[le(y4,it(it({},et),{},{type:"radio",ref:N}),null),d.default&&le("span",null,[d.default()])]))}}}),JJ=()=>({prefixCls:String,value:wt.any,size:Io(),options:op(),disabled:Cr(),name:String,buttonStyle:Io("outline"),id:String,optionType:Io("default"),onChange:Jr(),"onUpdate:value":Jr()}),S4=cn({compatConfig:{MODE:3},name:"ARadioGroup",inheritAttrs:!1,props:JJ(),setup(e,t){let{slots:o,emit:c,attrs:d}=t;const y=Ic(),{prefixCls:w,direction:i,size:O}=Rr("radio",e),[L,z]=b4(w),F=tn(e.value),N=tn(!1);return On(()=>e.value,Y=>{F.value=Y,N.value=!1}),UJ({onChange:Y=>{const K=F.value,{value:J}=Y.target;"value"in e||(F.value=J),!N.value&&J!==K&&(N.value=!0,c("update:value",J),c("change",Y),y.onFieldChange()),si(()=>{N.value=!1})},value:F,disabled:He(()=>e.disabled),name:He(()=>e.name),optionType:He(()=>e.optionType)}),()=>{var Y;const{options:K,buttonStyle:J,id:X=y.id.value}=e,se=`${w.value}-group`,te=hn(se,`${se}-${J}`,{[`${se}-${O.value}`]:O.value,[`${se}-rtl`]:i.value==="rtl"},d.class,z.value);let ne=null;return K&&K.length>0?ne=K.map(ue=>{if(typeof ue=="string"||typeof ue=="number")return le(ds,{key:ue,prefixCls:w.value,disabled:e.disabled,value:ue,checked:F.value===ue},{default:()=>[ue]});const{value:ge,disabled:ee,label:be}=ue;return le(ds,{key:`radio-group-value-options-${ge}`,prefixCls:w.value,disabled:ee||e.disabled,value:ge,checked:F.value===ge},{default:()=>[be]})}):ne=(Y=o.default)===null||Y===void 0?void 0:Y.call(o),L(le("div",it(it({},d),{},{class:te,id:X}),[ne]))}}}),DS=cn({compatConfig:{MODE:3},name:"ARadioButton",inheritAttrs:!1,props:w4(),setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d}=Rr("radio",e);return GJ("button"),()=>{var y;return le(ds,it(it(it({},c),e),{},{prefixCls:d.value}),{default:()=>[(y=o.default)===null||y===void 0?void 0:y.call(o)]})}}});ds.Group=S4;ds.Button=DS;ds.install=function(e){return e.component(ds.name,ds),e.component(ds.Group.name,ds.Group),e.component(ds.Button.name,ds.Button),e};const QJ=10,eQ=20;function C4(e){const{fullscreen:t,validRange:o,generateConfig:c,locale:d,prefixCls:y,value:w,onChange:i,divRef:O}=e,L=c.getYear(w||c.getNow());let z=L-QJ,F=z+eQ;o&&(z=c.getYear(o[0]),F=c.getYear(o[1])+1);const N=d&&d.year===""?"":"",G=[];for(let Y=z;Y<F;Y++)G.push({label:`${Y}${N}`,value:Y});return le(_a,{size:t?void 0:"small",options:G,value:L,class:`${y}-year-select`,onChange:Y=>{let K=c.setYear(w,Y);if(o){const[J,X]=o,se=c.getYear(K),te=c.getMonth(K);se===c.getYear(X)&&te>c.getMonth(X)&&(K=c.setMonth(K,c.getMonth(X))),se===c.getYear(J)&&te<c.getMonth(J)&&(K=c.setMonth(K,c.getMonth(J)))}i(K)},getPopupContainer:()=>O.value},null)}C4.inheritAttrs=!1;function T4(e){const{prefixCls:t,fullscreen:o,validRange:c,value:d,generateConfig:y,locale:w,onChange:i,divRef:O}=e,L=y.getMonth(d||y.getNow());let z=0,F=11;if(c){const[Y,K]=c,J=y.getYear(d);y.getYear(K)===J&&(F=y.getMonth(K)),y.getYear(Y)===J&&(z=y.getMonth(Y))}const N=w.shortMonths||y.locale.getShortMonths(w.locale),G=[];for(let Y=z;Y<=F;Y+=1)G.push({label:N[Y],value:Y});return le(_a,{size:o?void 0:"small",class:`${t}-month-select`,value:L,options:G,onChange:Y=>{i(y.setMonth(d,Y))},getPopupContainer:()=>O.value},null)}T4.inheritAttrs=!1;function E4(e){const{prefixCls:t,locale:o,mode:c,fullscreen:d,onModeChange:y}=e;return le(S4,{onChange:w=>{let{target:{value:i}}=w;y(i)},value:c,size:d?void 0:"small",class:`${t}-mode-switch`},{default:()=>[le(DS,{value:"month"},{default:()=>[o.month]}),le(DS,{value:"year"},{default:()=>[o.year]})]})}E4.inheritAttrs=!1;const tQ=cn({name:"CalendarHeader",inheritAttrs:!1,props:["mode","prefixCls","value","validRange","generateConfig","locale","mode","fullscreen"],setup(e,t){let{attrs:o}=t;const c=tn(null),d=xs.useInject();return xs.useProvide(d,{isFormItemInput:!1}),()=>{const y=re(re({},e),o),{prefixCls:w,fullscreen:i,mode:O,onChange:L,onModeChange:z}=y,F=re(re({},y),{fullscreen:i,divRef:c});return le("div",{class:`${w}-header`,ref:c},[le(C4,it(it({},F),{},{onChange:N=>{L(N,"year")}}),null),O==="month"&&le(T4,it(it({},F),{},{onChange:N=>{L(N,"month")}}),null),le(E4,it(it({},F),{},{onModeChange:z}),null)])}}}),nQ=e=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:e,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),ZC=e=>({borderColor:e.inputBorderHoverColor,borderInlineEndWidth:e.lineWidth}),RS=e=>({borderColor:e.inputBorderHoverColor,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`,borderInlineEndWidth:e.lineWidth,outline:0}),rQ=e=>({color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"&:hover":re({},ZC(Wr(e,{inputBorderHoverColor:e.colorBorder})))}),M4=e=>{const{inputPaddingVerticalLG:t,fontSizeLG:o,lineHeightLG:c,borderRadiusLG:d,inputPaddingHorizontalLG:y}=e;return{padding:`${t}px ${y}px`,fontSize:o,lineHeight:c,borderRadius:d}},I4=e=>({padding:`${e.inputPaddingVerticalSM}px ${e.controlPaddingHorizontalSM-1}px`,borderRadius:e.borderRadiusSM}),A4=(e,t)=>{const{componentCls:o,colorError:c,colorWarning:d,colorErrorOutline:y,colorWarningOutline:w,colorErrorBorderHover:i,colorWarningBorderHover:O}=e;return{[`&-status-error:not(${t}-disabled):not(${t}-borderless)${t}`]:{borderColor:c,"&:hover":{borderColor:i},"&:focus, &-focused":re({},RS(Wr(e,{inputBorderActiveColor:c,inputBorderHoverColor:c,controlOutline:y}))),[`${o}-prefix`]:{color:c}},[`&-status-warning:not(${t}-disabled):not(${t}-borderless)${t}`]:{borderColor:d,"&:hover":{borderColor:O},"&:focus, &-focused":re({},RS(Wr(e,{inputBorderActiveColor:d,inputBorderHoverColor:d,controlOutline:w}))),[`${o}-prefix`]:{color:d}}}},P4=e=>re(re({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${e.inputPaddingVertical}px ${e.inputPaddingHorizontal}px`,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,backgroundColor:e.colorBgContainer,backgroundImage:"none",borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:e.colorBorder,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid}`},nQ(e.colorTextPlaceholder)),{"&:hover":re({},ZC(e)),"&:focus, &-focused":re({},RS(e)),"&-disabled, &[disabled]":re({},rQ(e)),"&-borderless":{"&, &:hover, &:focus, &-focused, &-disabled, &[disabled]":{backgroundColor:"transparent",border:"none",boxShadow:"none"}},"textarea&":{maxWidth:"100%",height:"auto",minHeight:e.controlHeight,lineHeight:e.lineHeight,verticalAlign:"bottom",transition:`all ${e.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":re({},M4(e)),"&-sm":re({},I4(e)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}}),iQ=e=>{const{componentCls:t,antCls:o}=e;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:e.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${t}, &-lg > ${t}-group-addon`]:re({},M4(e)),[`&-sm ${t}, &-sm > ${t}-group-addon`]:re({},I4(e)),[`> ${t}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${t}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${e.inputPaddingHorizontal}px`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,textAlign:"center",backgroundColor:e.colorFillAlter,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadius,transition:`all ${e.motionDurationSlow}`,lineHeight:1,[`${o}-select`]:{margin:`-${e.inputPaddingVertical+1}px -${e.inputPaddingHorizontal}px`,[`&${o}-select-single:not(${o}-select-customize-input)`]:{[`${o}-select-selector`]:{backgroundColor:"inherit",border:`${e.lineWidth}px ${e.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${o}-select-selector`]:{color:e.colorPrimary}}},[`${o}-cascader-picker`]:{margin:`-9px -${e.inputPaddingHorizontal}px`,backgroundColor:"transparent",[`${o}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}},[`${t}`]:{float:"inline-start",width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${t}-search-with-button &`]:{zIndex:0}}},[`> ${t}:first-child, ${t}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}-affix-wrapper`]:{[`&:not(:first-child) ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}:last-child, ${t}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${t}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-search &`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius}},[`&:not(:first-child), ${t}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${t}-group-compact`]:re(re({display:"block"},hz()),{[`${t}-group-addon, ${t}-group-wrap, > ${t}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:e.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`& > ${t}-affix-wrapper`]:{display:"inline-flex"},[`& > ${o}-picker-range`]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:-e.lineWidth,borderInlineEndWidth:e.lineWidth},[`${t}`]:{float:"none"},[`& > ${o}-select > ${o}-select-selector,
      & > ${o}-select-auto-complete ${t},
      & > ${o}-cascader-picker ${t},
      & > ${t}-group-wrapper ${t}`]:{borderInlineEndWidth:e.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${o}-select-focused`]:{zIndex:1},[`& > ${o}-select > ${o}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${o}-select:first-child > ${o}-select-selector,
      & > ${o}-select-auto-complete:first-child ${t},
      & > ${o}-cascader-picker:first-child ${t}`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius},[`& > *:last-child,
      & > ${o}-select:last-child > ${o}-select-selector,
      & > ${o}-cascader-picker:last-child ${t},
      & > ${o}-cascader-picker-focused:last-child ${t}`]:{borderInlineEndWidth:e.lineWidth,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius},[`& > ${o}-select-auto-complete ${t}`]:{verticalAlign:"top"},[`${t}-group-wrapper + ${t}-group-wrapper`]:{marginInlineStart:-e.lineWidth,[`${t}-affix-wrapper`]:{borderRadius:0}},[`${t}-group-wrapper:not(:last-child)`]:{[`&${t}-search > ${t}-group`]:{[`& > ${t}-group-addon > ${t}-search-button`]:{borderRadius:0},[`& > ${t}`]:{borderStartStartRadius:e.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:e.borderRadius}}}}),[`&&-sm ${o}-btn`]:{fontSize:e.fontSizeSM,height:e.controlHeightSM,lineHeight:"normal"},[`&&-lg ${o}-btn`]:{fontSize:e.fontSizeLG,height:e.controlHeightLG,lineHeight:"normal"},[`&&-lg ${o}-select-single ${o}-select-selector`]:{height:`${e.controlHeightLG}px`,[`${o}-select-selection-item, ${o}-select-selection-placeholder`]:{lineHeight:`${e.controlHeightLG-2}px`},[`${o}-select-selection-search-input`]:{height:`${e.controlHeightLG}px`}},[`&&-sm ${o}-select-single ${o}-select-selector`]:{height:`${e.controlHeightSM}px`,[`${o}-select-selection-item, ${o}-select-selection-placeholder`]:{lineHeight:`${e.controlHeightSM-2}px`},[`${o}-select-selection-search-input`]:{height:`${e.controlHeightSM}px`}}}},oQ=e=>{const{componentCls:t,controlHeightSM:o,lineWidth:c}=e,y=(o-c*2-16)/2;return{[t]:re(re(re(re({},Ei(e)),P4(e)),A4(e,t)),{'&[type="color"]':{height:e.controlHeight,[`&${t}-lg`]:{height:e.controlHeightLG},[`&${t}-sm`]:{height:o,paddingTop:y,paddingBottom:y}}})}},aQ=e=>{const{componentCls:t}=e;return{[`${t}-clear-icon`]:{margin:0,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextTertiary},"&:active":{color:e.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${e.inputAffixPadding}px`}},"&-textarea-with-clear-btn":{padding:"0 !important",border:"0 !important",[`${t}-clear-icon`]:{position:"absolute",insetBlockStart:e.paddingXS,insetInlineEnd:e.paddingXS,zIndex:1}}}},sQ=e=>{const{componentCls:t,inputAffixPadding:o,colorTextDescription:c,motionDurationSlow:d,colorIcon:y,colorIconHover:w,iconCls:i}=e;return{[`${t}-affix-wrapper`]:re(re(re(re(re({},P4(e)),{display:"inline-flex",[`&:not(${t}-affix-wrapper-disabled):hover`]:re(re({},ZC(e)),{zIndex:1,[`${t}-search-with-button &`]:{zIndex:0}}),"&-focused, &:focus":{zIndex:1},"&-disabled":{[`${t}[disabled]`]:{background:"transparent"}},[`> input${t}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none","&:focus":{boxShadow:"none !important"}},"&::before":{width:0,visibility:"hidden",content:'"\\a0"'},[`${t}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:e.paddingXS}},"&-show-count-suffix":{color:c},"&-show-count-has-suffix":{marginInlineEnd:e.paddingXXS},"&-prefix":{marginInlineEnd:o},"&-suffix":{marginInlineStart:o}}}),aQ(e)),{[`${i}${t}-password-icon`]:{color:y,cursor:"pointer",transition:`all ${d}`,"&:hover":{color:w}}}),A4(e,`${t}-affix-wrapper`))}},lQ=e=>{const{componentCls:t,colorError:o,colorSuccess:c,borderRadiusLG:d,borderRadiusSM:y}=e;return{[`${t}-group`]:re(re(re({},Ei(e)),iQ(e)),{"&-rtl":{direction:"rtl"},"&-wrapper":{display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${t}-group-addon`]:{borderRadius:d}},"&-sm":{[`${t}-group-addon`]:{borderRadius:y}},"&-status-error":{[`${t}-group-addon`]:{color:o,borderColor:o}},"&-status-warning":{[`${t}-group-addon:last-child`]:{color:c,borderColor:c}}}})}},cQ=e=>{const{componentCls:t,antCls:o}=e,c=`${t}-search`;return{[c]:{[`${t}`]:{"&:hover, &:focus":{borderColor:e.colorPrimaryHover,[`+ ${t}-group-addon ${c}-button:not(${o}-btn-primary)`]:{borderInlineStartColor:e.colorPrimaryHover}}},[`${t}-affix-wrapper`]:{borderRadius:0},[`${t}-lg`]:{lineHeight:e.lineHeightLG-2e-4},[`> ${t}-group`]:{[`> ${t}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${c}-button`]:{paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius,borderEndStartRadius:0},[`${c}-button:not(${o}-btn-primary)`]:{color:e.colorTextDescription,"&:hover":{color:e.colorPrimaryHover},"&:active":{color:e.colorPrimaryActive},[`&${o}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${c}-button`]:{height:e.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${c}-button`]:{height:e.controlHeightLG},[`&-small ${c}-button`]:{height:e.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${t}-compact-item`]:{[`&:not(${t}-compact-last-item)`]:{[`${t}-group-addon`]:{[`${t}-search-button`]:{marginInlineEnd:-e.lineWidth,borderRadius:0}}},[`&:not(${t}-compact-first-item)`]:{[`${t},${t}-affix-wrapper`]:{borderRadius:0}},[`> ${t}-group-addon ${t}-search-button,
        > ${t},
        ${t}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${t}-affix-wrapper-focused`]:{zIndex:2}}}}};function O4(e){return Wr(e,{inputAffixPadding:e.paddingXXS,inputPaddingVertical:Math.max(Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,3),inputPaddingVerticalLG:Math.ceil((e.controlHeightLG-e.fontSizeLG*e.lineHeightLG)/2*10)/10-e.lineWidth,inputPaddingVerticalSM:Math.max(Math.round((e.controlHeightSM-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,0),inputPaddingHorizontal:e.paddingSM-e.lineWidth,inputPaddingHorizontalSM:e.paddingXS-e.lineWidth,inputPaddingHorizontalLG:e.controlPaddingHorizontal-e.lineWidth,inputBorderHoverColor:e.colorPrimaryHover,inputBorderActiveColor:e.colorPrimaryHover})}const uQ=e=>{const{componentCls:t,inputPaddingHorizontal:o,paddingLG:c}=e,d=`${t}-textarea`;return{[d]:{position:"relative",[`${d}-suffix`]:{position:"absolute",top:0,insetInlineEnd:o,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto"},"&-status-error,\n        &-status-warning,\n        &-status-success,\n        &-status-validating":{[`&${d}-has-feedback`]:{[`${t}`]:{paddingInlineEnd:c}}},"&-show-count":{[`> ${t}`]:{height:"100%"},"&::after":{color:e.colorTextDescription,whiteSpace:"nowrap",content:"attr(data-count)",pointerEvents:"none",float:"right"}},"&-rtl":{"&::after":{float:"left"}}}}},YC=Ui("Input",e=>{const t=O4(e);return[oQ(t),uQ(t),sQ(t),lQ(t),cQ(t),wC(t)]}),dQ=e=>{const{componentCls:t,pickerCellCls:o,pickerCellInnerCls:c,pickerPanelCellHeight:d,motionDurationSlow:y,borderRadiusSM:w,motionDurationMid:i,controlItemBgHover:O,lineWidth:L,lineType:z,colorPrimary:F,controlItemBgActive:N,colorTextLightSolid:G,controlHeightSM:Y,pickerDateHoverRangeBorderColor:K,pickerCellBorderGap:J,pickerBasicCellHoverWithRangeColor:X,pickerPanelCellWidth:se,colorTextDisabled:te,colorBgContainerDisabled:ne}=e;return{"&::before":{position:"absolute",top:"50%",insetInlineStart:0,insetInlineEnd:0,zIndex:1,height:d,transform:"translateY(-50%)",transition:`all ${y}`,content:'""'},[c]:{position:"relative",zIndex:2,display:"inline-block",minWidth:d,height:d,lineHeight:`${d}px`,borderRadius:w,transition:`background ${i}, border ${i}`},[`&:hover:not(${o}-in-view),
    &:hover:not(${o}-selected):not(${o}-range-start):not(${o}-range-end):not(${o}-range-hover-start):not(${o}-range-hover-end)`]:{[c]:{background:O}},[`&-in-view${o}-today ${c}`]:{"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:1,border:`${L}px ${z} ${F}`,borderRadius:w,content:'""'}},[`&-in-view${o}-in-range`]:{position:"relative","&::before":{background:N}},[`&-in-view${o}-selected ${c},
      &-in-view${o}-range-start ${c},
      &-in-view${o}-range-end ${c}`]:{color:G,background:F},[`&-in-view${o}-range-start:not(${o}-range-start-single),
      &-in-view${o}-range-end:not(${o}-range-end-single)`]:{"&::before":{background:N}},[`&-in-view${o}-range-start::before`]:{insetInlineStart:"50%"},[`&-in-view${o}-range-end::before`]:{insetInlineEnd:"50%"},[`&-in-view${o}-range-hover-start:not(${o}-in-range):not(${o}-range-start):not(${o}-range-end),
      &-in-view${o}-range-hover-end:not(${o}-in-range):not(${o}-range-start):not(${o}-range-end),
      &-in-view${o}-range-hover-start${o}-range-start-single,
      &-in-view${o}-range-hover-start${o}-range-start${o}-range-end${o}-range-end-near-hover,
      &-in-view${o}-range-hover-end${o}-range-start${o}-range-end${o}-range-start-near-hover,
      &-in-view${o}-range-hover-end${o}-range-end-single,
      &-in-view${o}-range-hover:not(${o}-in-range)`]:{"&::after":{position:"absolute",top:"50%",zIndex:0,height:Y,borderTop:`${L}px dashed ${K}`,borderBottom:`${L}px dashed ${K}`,transform:"translateY(-50%)",transition:`all ${y}`,content:'""'}},"&-range-hover-start::after,\n      &-range-hover-end::after,\n      &-range-hover::after":{insetInlineEnd:0,insetInlineStart:J},[`&-in-view${o}-in-range${o}-range-hover::before,
      &-in-view${o}-range-start${o}-range-hover::before,
      &-in-view${o}-range-end${o}-range-hover::before,
      &-in-view${o}-range-start:not(${o}-range-start-single)${o}-range-hover-start::before,
      &-in-view${o}-range-end:not(${o}-range-end-single)${o}-range-hover-end::before,
      ${t}-panel
      > :not(${t}-date-panel)
      &-in-view${o}-in-range${o}-range-hover-start::before,
      ${t}-panel
      > :not(${t}-date-panel)
      &-in-view${o}-in-range${o}-range-hover-end::before`]:{background:X},[`&-in-view${o}-range-start:not(${o}-range-start-single):not(${o}-range-end) ${c}`]:{borderStartStartRadius:w,borderEndStartRadius:w,borderStartEndRadius:0,borderEndEndRadius:0},[`&-in-view${o}-range-end:not(${o}-range-end-single):not(${o}-range-start) ${c}`]:{borderStartStartRadius:0,borderEndStartRadius:0,borderStartEndRadius:w,borderEndEndRadius:w},[`&-range-hover${o}-range-end::after`]:{insetInlineStart:"50%"},[`tr > &-in-view${o}-range-hover:first-child::after,
      tr > &-in-view${o}-range-hover-end:first-child::after,
      &-in-view${o}-start${o}-range-hover-edge-start${o}-range-hover-edge-start-near-range::after,
      &-in-view${o}-range-hover-edge-start:not(${o}-range-hover-edge-start-near-range)::after,
      &-in-view${o}-range-hover-start::after`]:{insetInlineStart:(se-d)/2,borderInlineStart:`${L}px dashed ${K}`,borderStartStartRadius:L,borderEndStartRadius:L},[`tr > &-in-view${o}-range-hover:last-child::after,
      tr > &-in-view${o}-range-hover-start:last-child::after,
      &-in-view${o}-end${o}-range-hover-edge-end${o}-range-hover-edge-end-near-range::after,
      &-in-view${o}-range-hover-edge-end:not(${o}-range-hover-edge-end-near-range)::after,
      &-in-view${o}-range-hover-end::after`]:{insetInlineEnd:(se-d)/2,borderInlineEnd:`${L}px dashed ${K}`,borderStartEndRadius:L,borderEndEndRadius:L},"&-disabled":{color:te,pointerEvents:"none",[c]:{background:"transparent"},"&::before":{background:ne}},[`&-disabled${o}-today ${c}::before`]:{borderColor:te}}},hQ=e=>{const{componentCls:t,pickerCellInnerCls:o,pickerYearMonthCellWidth:c,pickerControlIconSize:d,pickerPanelCellWidth:y,paddingSM:w,paddingXS:i,paddingXXS:O,colorBgContainer:L,lineWidth:z,lineType:F,borderRadiusLG:N,colorPrimary:G,colorTextHeading:Y,colorSplit:K,pickerControlIconBorderWidth:J,colorIcon:X,pickerTextHeight:se,motionDurationMid:te,colorIconHover:ne,fontWeightStrong:ue,pickerPanelCellHeight:ge,pickerCellPaddingVertical:ee,colorTextDisabled:be,colorText:Ie,fontSize:Ee,pickerBasicCellHoverWithRangeColor:Re,motionDurationSlow:Qe,pickerPanelWithoutTimeCellHeight:et,pickerQuarterPanelContentHeight:We,colorLink:me,colorLinkActive:Oe,colorLinkHover:Fe,pickerDateHoverRangeBorderColor:Ke,borderRadiusSM:$e,colorTextLightSolid:pt,borderRadius:Ct,controlItemBgHover:Lt,pickerTimePanelColumnHeight:It,pickerTimePanelColumnWidth:_n,pickerTimePanelCellHeight:Ut,controlItemBgActive:ln,marginXXS:xn}=e,En=y*7+w*2+4,Nt=(En-i*2)/3-c-w;return{[t]:{"&-panel":{display:"inline-flex",flexDirection:"column",textAlign:"center",background:L,border:`${z}px ${F} ${K}`,borderRadius:N,outline:"none","&-focused":{borderColor:G},"&-rtl":{direction:"rtl",[`${t}-prev-icon,
              ${t}-super-prev-icon`]:{transform:"rotate(45deg)"},[`${t}-next-icon,
              ${t}-super-next-icon`]:{transform:"rotate(-135deg)"}}},"&-decade-panel,\n        &-year-panel,\n        &-quarter-panel,\n        &-month-panel,\n        &-week-panel,\n        &-date-panel,\n        &-time-panel":{display:"flex",flexDirection:"column",width:En},"&-header":{display:"flex",padding:`0 ${i}px`,color:Y,borderBottom:`${z}px ${F} ${K}`,"> *":{flex:"none"},button:{padding:0,color:X,lineHeight:`${se}px`,background:"transparent",border:0,cursor:"pointer",transition:`color ${te}`},"> button":{minWidth:"1.6em",fontSize:Ee,"&:hover":{color:ne}},"&-view":{flex:"auto",fontWeight:ue,lineHeight:`${se}px`,button:{color:"inherit",fontWeight:"inherit",verticalAlign:"top","&:not(:first-child)":{marginInlineStart:i},"&:hover":{color:G}}}},"&-prev-icon,\n        &-next-icon,\n        &-super-prev-icon,\n        &-super-next-icon":{position:"relative",display:"inline-block",width:d,height:d,"&::before":{position:"absolute",top:0,insetInlineStart:0,display:"inline-block",width:d,height:d,border:"0 solid currentcolor",borderBlockStartWidth:J,borderBlockEndWidth:0,borderInlineStartWidth:J,borderInlineEndWidth:0,content:'""'}},"&-super-prev-icon,\n        &-super-next-icon":{"&::after":{position:"absolute",top:Math.ceil(d/2),insetInlineStart:Math.ceil(d/2),display:"inline-block",width:d,height:d,border:"0 solid currentcolor",borderBlockStartWidth:J,borderBlockEndWidth:0,borderInlineStartWidth:J,borderInlineEndWidth:0,content:'""'}},"&-prev-icon,\n        &-super-prev-icon":{transform:"rotate(-45deg)"},"&-next-icon,\n        &-super-next-icon":{transform:"rotate(135deg)"},"&-content":{width:"100%",tableLayout:"fixed",borderCollapse:"collapse","th, td":{position:"relative",minWidth:ge,fontWeight:"normal"},th:{height:ge+ee*2,color:Ie,verticalAlign:"middle"}},"&-cell":re({padding:`${ee}px 0`,color:be,cursor:"pointer","&-in-view":{color:Ie}},dQ(e)),[`&-date-panel ${t}-cell-in-view${t}-cell-in-range${t}-cell-range-hover-start ${o},
        &-date-panel ${t}-cell-in-view${t}-cell-in-range${t}-cell-range-hover-end ${o}`]:{"&::after":{position:"absolute",top:0,bottom:0,zIndex:-1,background:Re,transition:`all ${Qe}`,content:'""'}},[`&-date-panel
        ${t}-cell-in-view${t}-cell-in-range${t}-cell-range-hover-start
        ${o}::after`]:{insetInlineEnd:-(y-ge)/2,insetInlineStart:0},[`&-date-panel ${t}-cell-in-view${t}-cell-in-range${t}-cell-range-hover-end ${o}::after`]:{insetInlineEnd:0,insetInlineStart:-(y-ge)/2},[`&-range-hover${t}-range-start::after`]:{insetInlineEnd:"50%"},"&-decade-panel,\n        &-year-panel,\n        &-quarter-panel,\n        &-month-panel":{[`${t}-content`]:{height:et*4},[o]:{padding:`0 ${i}px`}},"&-quarter-panel":{[`${t}-content`]:{height:We}},[`&-panel ${t}-footer`]:{borderTop:`${z}px ${F} ${K}`},"&-footer":{width:"min-content",minWidth:"100%",lineHeight:`${se-2*z}px`,textAlign:"center","&-extra":{padding:`0 ${w}`,lineHeight:`${se-2*z}px`,textAlign:"start","&:not(:last-child)":{borderBottom:`${z}px ${F} ${K}`}}},"&-now":{textAlign:"start"},"&-today-btn":{color:me,"&:hover":{color:Fe},"&:active":{color:Oe},[`&${t}-today-btn-disabled`]:{color:be,cursor:"not-allowed"}},"&-decade-panel":{[o]:{padding:`0 ${i/2}px`},[`${t}-cell::before`]:{display:"none"}},"&-year-panel,\n        &-quarter-panel,\n        &-month-panel":{[`${t}-body`]:{padding:`0 ${i}px`},[o]:{width:c},[`${t}-cell-range-hover-start::after`]:{insetInlineStart:Nt,borderInlineStart:`${z}px dashed ${Ke}`,borderStartStartRadius:$e,borderBottomStartRadius:$e,borderStartEndRadius:0,borderBottomEndRadius:0,[`${t}-panel-rtl &`]:{insetInlineEnd:Nt,borderInlineEnd:`${z}px dashed ${Ke}`,borderStartStartRadius:0,borderBottomStartRadius:0,borderStartEndRadius:$e,borderBottomEndRadius:$e}},[`${t}-cell-range-hover-end::after`]:{insetInlineEnd:Nt,borderInlineEnd:`${z}px dashed ${Ke}`,borderStartStartRadius:0,borderEndStartRadius:0,borderStartEndRadius:Ct,borderEndEndRadius:Ct,[`${t}-panel-rtl &`]:{insetInlineStart:Nt,borderInlineStart:`${z}px dashed ${Ke}`,borderStartStartRadius:Ct,borderEndStartRadius:Ct,borderStartEndRadius:0,borderEndEndRadius:0}}},"&-week-panel":{[`${t}-body`]:{padding:`${i}px ${w}px`},[`${t}-cell`]:{[`&:hover ${o},
            &-selected ${o},
            ${o}`]:{background:"transparent !important"}},"&-row":{td:{transition:`background ${te}`,"&:first-child":{borderStartStartRadius:$e,borderEndStartRadius:$e},"&:last-child":{borderStartEndRadius:$e,borderEndEndRadius:$e}},"&:hover td":{background:Lt},"&-selected td,\n            &-selected:hover td":{background:G,[`&${t}-cell-week`]:{color:new qi(pt).setAlpha(.5).toHexString()},[`&${t}-cell-today ${o}::before`]:{borderColor:pt},[o]:{color:pt}}}},"&-date-panel":{[`${t}-body`]:{padding:`${i}px ${w}px`},[`${t}-content`]:{width:y*7,th:{width:y}}},"&-datetime-panel":{display:"flex",[`${t}-time-panel`]:{borderInlineStart:`${z}px ${F} ${K}`},[`${t}-date-panel,
          ${t}-time-panel`]:{transition:`opacity ${Qe}`},"&-active":{[`${t}-date-panel,
            ${t}-time-panel`]:{opacity:.3,"&-active":{opacity:1}}}},"&-time-panel":{width:"auto",minWidth:"auto",direction:"ltr",[`${t}-content`]:{display:"flex",flex:"auto",height:It},"&-column":{flex:"1 0 auto",width:_n,margin:`${O}px 0`,padding:0,overflowY:"hidden",textAlign:"start",listStyle:"none",transition:`background ${te}`,overflowX:"hidden","&::after":{display:"block",height:It-Ut,content:'""'},"&:not(:first-child)":{borderInlineStart:`${z}px ${F} ${K}`},"&-active":{background:new qi(ln).setAlpha(.2).toHexString()},"&:hover":{overflowY:"auto"},"> li":{margin:0,padding:0,[`&${t}-time-panel-cell`]:{marginInline:xn,[`${t}-time-panel-cell-inner`]:{display:"block",width:_n-2*xn,height:Ut,margin:0,paddingBlock:0,paddingInlineEnd:0,paddingInlineStart:(_n-Ut)/2,color:Ie,lineHeight:`${Ut}px`,borderRadius:$e,cursor:"pointer",transition:`background ${te}`,"&:hover":{background:Lt}},"&-selected":{[`${t}-time-panel-cell-inner`]:{background:ln}},"&-disabled":{[`${t}-time-panel-cell-inner`]:{color:be,background:"transparent",cursor:"not-allowed"}}}}}},[`&-datetime-panel ${t}-time-panel-column:after`]:{height:It-Ut+O*2}}}},fQ=e=>{const{componentCls:o,controlHeightLG:c,controlHeightSM:d,colorPrimary:y,paddingXXS:w}=e;return{pickerCellCls:`${o}-cell`,pickerCellInnerCls:`${o}-cell-inner`,pickerTextHeight:c,pickerPanelCellWidth:d*1.5,pickerPanelCellHeight:d,pickerDateHoverRangeBorderColor:new qi(y).lighten(20).toHexString(),pickerBasicCellHoverWithRangeColor:new qi(y).lighten(35).toHexString(),pickerPanelWithoutTimeCellHeight:c*1.65,pickerYearMonthCellWidth:c*1.5,pickerTimePanelColumnHeight:28*8,pickerTimePanelColumnWidth:c*1.4,pickerTimePanelCellHeight:28,pickerQuarterPanelContentHeight:c*1.4,pickerCellPaddingVertical:w,pickerCellBorderGap:2,pickerControlIconSize:7,pickerControlIconBorderWidth:1.5}},pQ=e=>{const{calendarCls:t,componentCls:o,calendarFullBg:c,calendarFullPanelBg:d,calendarItemActiveBg:y}=e;return{[t]:re(re(re({},hQ(e)),Ei(e)),{background:c,"&-rtl":{direction:"rtl"},[`${t}-header`]:{display:"flex",justifyContent:"flex-end",padding:`${e.paddingSM}px 0`,[`${t}-year-select`]:{minWidth:e.yearControlWidth},[`${t}-month-select`]:{minWidth:e.monthControlWidth,marginInlineStart:e.marginXS},[`${t}-mode-switch`]:{marginInlineStart:e.marginXS}}}),[`${t} ${o}-panel`]:{background:d,border:0,borderTop:`${e.lineWidth}px ${e.lineType} ${e.colorSplit}`,borderRadius:0,[`${o}-month-panel, ${o}-date-panel`]:{width:"auto"},[`${o}-body`]:{padding:`${e.paddingXS}px 0`},[`${o}-content`]:{width:"100%"}},[`${t}-mini`]:{borderRadius:e.borderRadiusLG,[`${t}-header`]:{paddingInlineEnd:e.paddingXS,paddingInlineStart:e.paddingXS},[`${o}-panel`]:{borderRadius:`0 0 ${e.borderRadiusLG}px ${e.borderRadiusLG}px`},[`${o}-content`]:{height:e.miniContentHeight,th:{height:"auto",padding:0,lineHeight:`${e.weekHeight}px`}},[`${o}-cell::before`]:{pointerEvents:"none"}},[`${t}${t}-full`]:{[`${o}-panel`]:{display:"block",width:"100%",textAlign:"end",background:c,border:0,[`${o}-body`]:{"th, td":{padding:0},th:{height:"auto",paddingInlineEnd:e.paddingSM,paddingBottom:e.paddingXXS,lineHeight:`${e.weekHeight}px`}}},[`${o}-cell`]:{"&::before":{display:"none"},"&:hover":{[`${t}-date`]:{background:e.controlItemBgHover}},[`${t}-date-today::before`]:{display:"none"},[`&-in-view${o}-cell-selected`]:{[`${t}-date, ${t}-date-today`]:{background:y}},"&-selected, &-selected:hover":{[`${t}-date, ${t}-date-today`]:{[`${t}-date-value`]:{color:e.colorPrimary}}}},[`${t}-date`]:{display:"block",width:"auto",height:"auto",margin:`0 ${e.marginXS/2}px`,padding:`${e.paddingXS/2}px ${e.paddingXS}px 0`,border:0,borderTop:`${e.lineWidthBold}px ${e.lineType} ${e.colorSplit}`,borderRadius:0,transition:`background ${e.motionDurationSlow}`,"&-value":{lineHeight:`${e.dateValueHeight}px`,transition:`color ${e.motionDurationSlow}`},"&-content":{position:"static",width:"auto",height:e.dateContentHeight,overflowY:"auto",color:e.colorText,lineHeight:e.lineHeight,textAlign:"start"},"&-today":{borderColor:e.colorPrimary,[`${t}-date-value`]:{color:e.colorText}}}},[`@media only screen and (max-width: ${e.screenXS}px) `]:{[`${t}`]:{[`${t}-header`]:{display:"block",[`${t}-year-select`]:{width:"50%"},[`${t}-month-select`]:{width:`calc(50% - ${e.paddingXS}px)`},[`${t}-mode-switch`]:{width:"100%",marginTop:e.marginXS,marginInlineStart:0,"> label":{width:"50%",textAlign:"center"}}}}}}},mQ=Ui("Calendar",e=>{const t=`${e.componentCls}-calendar`,o=Wr(O4(e),fQ(e),{calendarCls:t,pickerCellInnerCls:`${e.componentCls}-cell-inner`,calendarFullBg:e.colorBgContainer,calendarFullPanelBg:e.colorBgContainer,calendarItemActiveBg:e.controlItemBgActive,dateValueHeight:e.controlHeightSM,weekHeight:e.controlHeightSM*.75,dateContentHeight:(e.fontSizeSM*e.lineHeightSM+e.marginXS)*3+e.lineWidth*2});return[pQ(o)]},{yearControlWidth:80,monthControlWidth:70,miniContentHeight:256});function gQ(e){function t(y,w){return y&&w&&e.getYear(y)===e.getYear(w)}function o(y,w){return t(y,w)&&e.getMonth(y)===e.getMonth(w)}function c(y,w){return o(y,w)&&e.getDate(y)===e.getDate(w)}const d=cn({name:"ACalendar",inheritAttrs:!1,props:{prefixCls:String,locale:{type:Object,default:void 0},validRange:{type:Array,default:void 0},disabledDate:{type:Function,default:void 0},dateFullCellRender:{type:Function,default:void 0},dateCellRender:{type:Function,default:void 0},monthFullCellRender:{type:Function,default:void 0},monthCellRender:{type:Function,default:void 0},headerRender:{type:Function,default:void 0},value:{type:[Object,String],default:void 0},defaultValue:{type:[Object,String],default:void 0},mode:{type:String,default:void 0},fullscreen:{type:Boolean,default:void 0},onChange:{type:Function,default:void 0},"onUpdate:value":{type:Function,default:void 0},onPanelChange:{type:Function,default:void 0},onSelect:{type:Function,default:void 0},valueFormat:{type:String,default:void 0}},slots:Object,setup(y,w){let{emit:i,slots:O,attrs:L}=w;const z=y,{prefixCls:F,direction:N}=Rr("picker",z),[G,Y]=mQ(F),K=He(()=>`${F.value}-calendar`),J=me=>z.valueFormat?e.toString(me,z.valueFormat):me,X=He(()=>z.value?z.valueFormat?e.toDate(z.value,z.valueFormat):z.value:z.value===""?void 0:z.value),se=He(()=>z.defaultValue?z.valueFormat?e.toDate(z.defaultValue,z.valueFormat):z.defaultValue:z.defaultValue===""?void 0:z.defaultValue),[te,ne]=oh(()=>X.value||e.getNow(),{defaultValue:se.value,value:X}),[ue,ge]=oh("month",{value:ra(z,"mode")}),ee=He(()=>ue.value==="year"?"month":"date"),be=He(()=>me=>{var Oe;return(z.validRange?e.isAfter(z.validRange[0],me)||e.isAfter(me,z.validRange[1]):!1)||!!(!((Oe=z.disabledDate)===null||Oe===void 0)&&Oe.call(z,me))}),Ie=(me,Oe)=>{i("panelChange",J(me),Oe)},Ee=me=>{if(ne(me),!c(me,te.value)){(ee.value==="date"&&!o(me,te.value)||ee.value==="month"&&!t(me,te.value))&&Ie(me,ue.value);const Oe=J(me);i("update:value",Oe),i("change",Oe)}},Re=me=>{ge(me),Ie(te.value,me)},Qe=(me,Oe)=>{Ee(me),i("select",J(me),{source:Oe})},et=He(()=>{const{locale:me}=z,Oe=re(re({},Xw),me);return Oe.lang=re(re({},Oe.lang),(me||{}).lang),Oe}),[We]=S_("Calendar",et);return()=>{const me=e.getNow(),{dateFullCellRender:Oe=O==null?void 0:O.dateFullCellRender,dateCellRender:Fe=O==null?void 0:O.dateCellRender,monthFullCellRender:Ke=O==null?void 0:O.monthFullCellRender,monthCellRender:$e=O==null?void 0:O.monthCellRender,headerRender:pt=O==null?void 0:O.headerRender,fullscreen:Ct=!0,validRange:Lt}=z,It=Ut=>{let{current:ln}=Ut;return Oe?Oe({current:ln}):le("div",{class:hn(`${F.value}-cell-inner`,`${K.value}-date`,{[`${K.value}-date-today`]:c(me,ln)})},[le("div",{class:`${K.value}-date-value`},[String(e.getDate(ln)).padStart(2,"0")]),le("div",{class:`${K.value}-date-content`},[Fe&&Fe({current:ln})])])},_n=(Ut,ln)=>{let{current:xn}=Ut;if(Ke)return Ke({current:xn});const En=ln.shortMonths||e.locale.getShortMonths(ln.locale);return le("div",{class:hn(`${F.value}-cell-inner`,`${K.value}-date`,{[`${K.value}-date-today`]:o(me,xn)})},[le("div",{class:`${K.value}-date-value`},[En[e.getMonth(xn)]]),le("div",{class:`${K.value}-date-content`},[$e&&$e({current:xn})])])};return G(le("div",it(it({},L),{},{class:hn(K.value,{[`${K.value}-full`]:Ct,[`${K.value}-mini`]:!Ct,[`${K.value}-rtl`]:N.value==="rtl"},L.class,Y.value)}),[pt?pt({value:te.value,type:ue.value,onChange:Ut=>{Qe(Ut,"customize")},onTypeChange:Re}):le(tQ,{prefixCls:K.value,value:te.value,generateConfig:e,mode:ue.value,fullscreen:Ct,locale:We.value.lang,validRange:Lt,onChange:Qe,onModeChange:Re},null),le(NJ,{value:te.value,prefixCls:F.value,locale:We.value.lang,generateConfig:e,dateRender:It,monthCellRender:Ut=>_n(Ut,We.value.lang),onSelect:Ut=>{Qe(Ut,ee.value)},mode:ee.value,picker:ee.value,disabledDate:be.value,hideHeader:!0},null)]))}}});return d.install=function(y){return y.component(d.name,d),y},d}const _Q=gQ(pJ),yQ=Pl(_Q),vQ=()=>({prefixCls:String,activeKey:Mo([Array,Number,String]),defaultActiveKey:Mo([Array,Number,String]),accordion:Cr(),destroyInactivePanel:Cr(),bordered:Cr(),expandIcon:Jr(),openAnimation:wt.object,expandIconPosition:Io(),collapsible:Io(),ghost:Cr(),onChange:Jr(),"onUpdate:activeKey":Jr()}),D4=()=>({openAnimation:wt.object,prefixCls:String,header:wt.any,headerClass:String,showArrow:Cr(),isActive:Cr(),destroyInactivePanel:Cr(),disabled:Cr(),accordion:Cr(),forceRender:Cr(),expandIcon:Jr(),extra:wt.any,panelKey:Mo(),collapsible:Io(),role:String,onItemClick:Jr()}),xQ=e=>{const{componentCls:t,collapseContentBg:o,padding:c,collapseContentPaddingHorizontal:d,collapseHeaderBg:y,collapseHeaderPadding:w,collapsePanelBorderRadius:i,lineWidth:O,lineType:L,colorBorder:z,colorText:F,colorTextHeading:N,colorTextDisabled:G,fontSize:Y,lineHeight:K,marginSM:J,paddingSM:X,motionDurationSlow:se,fontSizeIcon:te}=e,ne=`${O}px ${L} ${z}`;return{[t]:re(re({},Ei(e)),{backgroundColor:y,border:ne,borderBottom:0,borderRadius:`${i}px`,"&-rtl":{direction:"rtl"},[`& > ${t}-item`]:{borderBottom:ne,"&:last-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`0 0 ${i}px ${i}px`}},[`> ${t}-header`]:{position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:w,color:N,lineHeight:K,cursor:"pointer",transition:`all ${se}, visibility 0s`,[`> ${t}-header-text`]:{flex:"auto"},"&:focus":{outline:"none"},[`${t}-expand-icon`]:{height:Y*K,display:"flex",alignItems:"center",paddingInlineEnd:J},[`${t}-arrow`]:re(re({},fx()),{fontSize:te,svg:{transition:`transform ${se}`}}),[`${t}-header-text`]:{marginInlineEnd:"auto"}},[`${t}-header-collapsible-only`]:{cursor:"default",[`${t}-header-text`]:{flex:"none",cursor:"pointer"},[`${t}-expand-icon`]:{cursor:"pointer"}},[`${t}-icon-collapsible-only`]:{cursor:"default",[`${t}-expand-icon`]:{cursor:"pointer"}},[`&${t}-no-arrow`]:{[`> ${t}-header`]:{paddingInlineStart:X}}},[`${t}-content`]:{color:F,backgroundColor:o,borderTop:ne,[`& > ${t}-content-box`]:{padding:`${c}px ${d}px`},"&-hidden":{display:"none"}},[`${t}-item:last-child`]:{[`> ${t}-content`]:{borderRadius:`0 0 ${i}px ${i}px`}},[`& ${t}-item-disabled > ${t}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:G,cursor:"not-allowed"}},[`&${t}-icon-position-end`]:{[`& > ${t}-item`]:{[`> ${t}-header`]:{[`${t}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:J}}}}})}},bQ=e=>{const{componentCls:t}=e,o=`> ${t}-item > ${t}-header ${t}-arrow svg`;return{[`${t}-rtl`]:{[o]:{transform:"rotate(180deg)"}}}},wQ=e=>{const{componentCls:t,collapseHeaderBg:o,paddingXXS:c,colorBorder:d}=e;return{[`${t}-borderless`]:{backgroundColor:o,border:0,[`> ${t}-item`]:{borderBottom:`1px solid ${d}`},[`
        > ${t}-item:last-child,
        > ${t}-item:last-child ${t}-header
      `]:{borderRadius:0},[`> ${t}-item:last-child`]:{borderBottom:0},[`> ${t}-item > ${t}-content`]:{backgroundColor:"transparent",borderTop:0},[`> ${t}-item > ${t}-content > ${t}-content-box`]:{paddingTop:c}}}},SQ=e=>{const{componentCls:t,paddingSM:o}=e;return{[`${t}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${t}-item`]:{borderBottom:0,[`> ${t}-content`]:{backgroundColor:"transparent",border:0,[`> ${t}-content-box`]:{paddingBlock:o}}}}}},CQ=Ui("Collapse",e=>{const t=Wr(e,{collapseContentBg:e.colorBgContainer,collapseHeaderBg:e.colorFillAlter,collapseHeaderPadding:`${e.paddingSM}px ${e.padding}px`,collapsePanelBorderRadius:e.borderRadiusLG,collapseContentPaddingHorizontal:16});return[xQ(t),wQ(t),SQ(t),bQ(t),YL(t)]});function nO(e){let t=e;if(!Array.isArray(t)){const o=typeof t;t=o==="number"||o==="string"?[t]:[]}return t.map(o=>String(o))}const Zg=cn({compatConfig:{MODE:3},name:"ACollapse",inheritAttrs:!1,props:Wo(vQ(),{accordion:!1,destroyInactivePanel:!1,bordered:!0,expandIconPosition:"start"}),slots:Object,setup(e,t){let{attrs:o,slots:c,emit:d}=t;const y=tn(nO(t4([e.activeKey,e.defaultActiveKey])));On(()=>e.activeKey,()=>{y.value=nO(e.activeKey)},{deep:!0});const{prefixCls:w,direction:i,rootPrefixCls:O}=Rr("collapse",e),[L,z]=CQ(w),F=He(()=>{const{expandIconPosition:X}=e;return X!==void 0?X:i.value==="rtl"?"end":"start"}),N=X=>{const{expandIcon:se=c.expandIcon}=e,te=se?se(X):le(PC,{rotate:X.isActive?90:void 0},null);return le("div",{class:[`${w.value}-expand-icon`,z.value],onClick:()=>["header","icon"].includes(e.collapsible)&&Y(X.panelKey)},[Tc(Array.isArray(se)?te[0]:te)?xo(te,{class:`${w.value}-arrow`},!1):te])},G=X=>{e.activeKey===void 0&&(y.value=X);const se=e.accordion?X[0]:X;d("update:activeKey",se),d("change",se)},Y=X=>{let se=y.value;if(e.accordion)se=se[0]===X?[]:[X];else{se=[...se];const te=se.indexOf(X);te>-1?se.splice(te,1):se.push(X)}G(se)},K=(X,se)=>{var te,ne,ue;if(T2(X))return;const ge=y.value,{accordion:ee,destroyInactivePanel:be,collapsible:Ie,openAnimation:Ee}=e,Re=Ee||h4(`${O.value}-motion-collapse`),Qe=String((te=X.key)!==null&&te!==void 0?te:se),{header:et=(ue=(ne=X.children)===null||ne===void 0?void 0:ne.header)===null||ue===void 0?void 0:ue.call(ne),headerClass:We,collapsible:me,disabled:Oe}=X.props||{};let Fe=!1;ee?Fe=ge[0]===Qe:Fe=ge.indexOf(Qe)>-1;let Ke=me??Ie;(Oe||Oe==="")&&(Ke="disabled");const $e={key:Qe,panelKey:Qe,header:et,headerClass:We,isActive:Fe,prefixCls:w.value,destroyInactivePanel:be,openAnimation:Re,accordion:ee,onItemClick:Ke==="disabled"?null:Y,expandIcon:N,collapsible:Ke};return xo(X,$e)},J=()=>{var X;return vo((X=c.default)===null||X===void 0?void 0:X.call(c)).map(K)};return()=>{const{accordion:X,bordered:se,ghost:te}=e,ne=hn(w.value,{[`${w.value}-borderless`]:!se,[`${w.value}-icon-position-${F.value}`]:!0,[`${w.value}-rtl`]:i.value==="rtl",[`${w.value}-ghost`]:!!te,[o.class]:!!o.class},z.value);return L(le("div",it(it({class:ne},k6(o)),{},{style:o.style,role:X?"tablist":null}),[J()]))}}}),TQ=cn({compatConfig:{MODE:3},name:"PanelContent",props:D4(),setup(e,t){let{slots:o}=t;const c=Xt(!1);return Ii(()=>{(e.isActive||e.forceRender)&&(c.value=!0)}),()=>{var d;if(!c.value)return null;const{prefixCls:y,isActive:w,role:i}=e;return le("div",{class:hn(`${y}-content`,{[`${y}-content-active`]:w,[`${y}-content-inactive`]:!w}),role:i},[le("div",{class:`${y}-content-box`},[(d=o.default)===null||d===void 0?void 0:d.call(o)])])}}}),Uv=cn({compatConfig:{MODE:3},name:"ACollapsePanel",inheritAttrs:!1,props:Wo(D4(),{showArrow:!0,isActive:!1,onItemClick(){},headerClass:"",forceRender:!1}),slots:Object,setup(e,t){let{slots:o,emit:c,attrs:d}=t;F2(e.disabled===void 0,"Collapse.Panel",'`disabled` is deprecated. Please use `collapsible="disabled"` instead.');const{prefixCls:y}=Rr("collapse",e),w=()=>{c("itemClick",e.panelKey)},i=O=>{(O.key==="Enter"||O.keyCode===13||O.which===13)&&w()};return()=>{var O,L;const{header:z=(O=o.header)===null||O===void 0?void 0:O.call(o),headerClass:F,isActive:N,showArrow:G,destroyInactivePanel:Y,accordion:K,forceRender:J,openAnimation:X,expandIcon:se=o.expandIcon,extra:te=(L=o.extra)===null||L===void 0?void 0:L.call(o),collapsible:ne}=e,ue=ne==="disabled",ge=y.value,ee=hn(`${ge}-header`,{[F]:F,[`${ge}-header-collapsible-only`]:ne==="header",[`${ge}-icon-collapsible-only`]:ne==="icon"}),be=hn({[`${ge}-item`]:!0,[`${ge}-item-active`]:N,[`${ge}-item-disabled`]:ue,[`${ge}-no-arrow`]:!G,[`${d.class}`]:!!d.class});let Ie=le("i",{class:"arrow"},null);G&&typeof se=="function"&&(Ie=se(e));const Ee=Ns(le(TQ,{prefixCls:ge,isActive:N,forceRender:J,role:K?"tabpanel":null},{default:o.default}),[[bl,N]]),Re=re({appear:!1,css:!1},X);return le("div",it(it({},d),{},{class:be}),[le("div",{class:ee,onClick:()=>!["header","icon"].includes(ne)&&w(),role:K?"tab":"button",tabindex:ue?-1:0,"aria-expanded":N,onKeypress:i},[G&&Ie,le("span",{onClick:()=>ne==="header"&&w(),class:`${ge}-header-text`},[z]),te&&le("div",{class:`${ge}-extra`},[te])]),le(Al,Re,{default:()=>[!Y||N?Ee:null]})])}}});Zg.Panel=Uv;Zg.install=function(e){return e.component(Zg.name,Zg),e.component(Uv.name,Uv),e};const R4=()=>gs()&&window.document.documentElement;let By;const EQ=()=>{if(!R4())return!1;if(By!==void 0)return By;const e=document.createElement("div");return e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e),By=e.scrollHeight===1,document.body.removeChild(e),By},MQ=()=>{const e=Xt(!1);return Qr(()=>{e.value=EQ()}),e},z4=Symbol("rowContextKey"),IQ=e=>{li(z4,e)},AQ=()=>Zr(z4,{gutter:He(()=>{}),wrap:He(()=>{}),supportFlexGap:He(()=>{})}),PQ=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around ":{justifyContent:"space-around"},"&-space-evenly ":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},OQ=e=>{const{componentCls:t}=e;return{[t]:{position:"relative",maxWidth:"100%",minHeight:1}}},DQ=(e,t)=>{const{componentCls:o,gridColumns:c}=e,d={};for(let y=c;y>=0;y--)y===0?(d[`${o}${t}-${y}`]={display:"none"},d[`${o}-push-${y}`]={insetInlineStart:"auto"},d[`${o}-pull-${y}`]={insetInlineEnd:"auto"},d[`${o}${t}-push-${y}`]={insetInlineStart:"auto"},d[`${o}${t}-pull-${y}`]={insetInlineEnd:"auto"},d[`${o}${t}-offset-${y}`]={marginInlineEnd:0},d[`${o}${t}-order-${y}`]={order:0}):(d[`${o}${t}-${y}`]={display:"block",flex:`0 0 ${y/c*100}%`,maxWidth:`${y/c*100}%`},d[`${o}${t}-push-${y}`]={insetInlineStart:`${y/c*100}%`},d[`${o}${t}-pull-${y}`]={insetInlineEnd:`${y/c*100}%`},d[`${o}${t}-offset-${y}`]={marginInlineStart:`${y/c*100}%`},d[`${o}${t}-order-${y}`]={order:y});return d},zS=(e,t)=>DQ(e,t),RQ=(e,t,o)=>({[`@media (min-width: ${t}px)`]:re({},zS(e,o))}),zQ=Ui("Grid",e=>[PQ(e)]),LQ=Ui("Grid",e=>{const t=Wr(e,{gridColumns:24}),o={"-sm":t.screenSMMin,"-md":t.screenMDMin,"-lg":t.screenLGMin,"-xl":t.screenXLMin,"-xxl":t.screenXXLMin};return[OQ(t),zS(t,""),zS(t,"-xs"),Object.keys(o).map(c=>RQ(t,o[c],c)).reduce((c,d)=>re(re({},c),d),{})]}),$Q=()=>({align:Mo([String,Object]),justify:Mo([String,Object]),prefixCls:String,gutter:Mo([Number,Array,Object],0),wrap:{type:Boolean,default:void 0}}),L4=cn({compatConfig:{MODE:3},name:"ARow",inheritAttrs:!1,props:$Q(),setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d,direction:y}=Rr("row",e),[w,i]=zQ(d);let O;const L=JL(),z=tn({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),F=tn({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),N=te=>He(()=>{if(typeof e[te]=="string")return e[te];if(typeof e[te]!="object")return"";for(let ne=0;ne<Gf.length;ne++){const ue=Gf[ne];if(!F.value[ue])continue;const ge=e[te][ue];if(ge!==void 0)return ge}return""}),G=N("align"),Y=N("justify"),K=MQ();Qr(()=>{O=L.value.subscribe(te=>{F.value=te;const ne=e.gutter||0;(!Array.isArray(ne)&&typeof ne=="object"||Array.isArray(ne)&&(typeof ne[0]=="object"||typeof ne[1]=="object"))&&(z.value=te)})}),fi(()=>{L.value.unsubscribe(O)});const J=He(()=>{const te=[void 0,void 0],{gutter:ne=0}=e;return(Array.isArray(ne)?ne:[ne,void 0]).forEach((ge,ee)=>{if(typeof ge=="object")for(let be=0;be<Gf.length;be++){const Ie=Gf[be];if(z.value[Ie]&&ge[Ie]!==void 0){te[ee]=ge[Ie];break}}else te[ee]=ge}),te});IQ({gutter:J,supportFlexGap:K,wrap:He(()=>e.wrap)});const X=He(()=>hn(d.value,{[`${d.value}-no-wrap`]:e.wrap===!1,[`${d.value}-${Y.value}`]:Y.value,[`${d.value}-${G.value}`]:G.value,[`${d.value}-rtl`]:y.value==="rtl"},c.class,i.value)),se=He(()=>{const te=J.value,ne={},ue=te[0]!=null&&te[0]>0?`${te[0]/-2}px`:void 0,ge=te[1]!=null&&te[1]>0?`${te[1]/-2}px`:void 0;return ue&&(ne.marginLeft=ue,ne.marginRight=ue),K.value?ne.rowGap=`${te[1]}px`:ge&&(ne.marginTop=ge,ne.marginBottom=ge),ne});return()=>{var te;return w(le("div",it(it({},c),{},{class:X.value,style:re(re({},se.value),c.style)}),[(te=o.default)===null||te===void 0?void 0:te.call(o)]))}}});function eh(){return eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},eh.apply(this,arguments)}function FQ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,y_(e,t)}function LS(e){return LS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},LS(e)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},y_(e,t)}function BQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hv(e,t,o){return BQ()?hv=Reflect.construct.bind():hv=function(d,y,w){var i=[null];i.push.apply(i,y);var O=Function.bind.apply(d,i),L=new O;return w&&y_(L,w.prototype),L},hv.apply(null,arguments)}function kQ(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function $S(e){var t=typeof Map=="function"?new Map:void 0;return $S=function(c){if(c===null||!kQ(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(c))return t.get(c);t.set(c,d)}function d(){return hv(c,arguments,LS(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),y_(d,c)},$S(e)}var NQ=/%[sdj%]/g,VQ=function(){};function FS(e){if(!e||!e.length)return null;var t={};return e.forEach(function(o){var c=o.field;t[c]=t[c]||[],t[c].push(o)}),t}function Ba(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),c=1;c<t;c++)o[c-1]=arguments[c];var d=0,y=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var w=e.replace(NQ,function(i){if(i==="%%")return"%";if(d>=y)return i;switch(i){case"%s":return String(o[d++]);case"%d":return Number(o[d++]);case"%j":try{return JSON.stringify(o[d++])}catch{return"[Circular]"}break;default:return i}});return w}return e}function jQ(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function wo(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||jQ(t)&&typeof e=="string"&&!e)}function UQ(e,t,o){var c=[],d=0,y=e.length;function w(i){c.push.apply(c,i||[]),d++,d===y&&o(c)}e.forEach(function(i){t(i,w)})}function rO(e,t,o){var c=0,d=e.length;function y(w){if(w&&w.length){o(w);return}var i=c;c=c+1,i<d?t(e[i],y):o([])}y([])}function HQ(e){var t=[];return Object.keys(e).forEach(function(o){t.push.apply(t,e[o]||[])}),t}var iO=function(e){FQ(t,e);function t(o,c){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=o,d.fields=c,d}return t}($S(Error));function GQ(e,t,o,c,d){if(t.first){var y=new Promise(function(N,G){var Y=function(X){return c(X),X.length?G(new iO(X,FS(X))):N(d)},K=HQ(e);rO(K,o,Y)});return y.catch(function(N){return N}),y}var w=t.firstFields===!0?Object.keys(e):t.firstFields||[],i=Object.keys(e),O=i.length,L=0,z=[],F=new Promise(function(N,G){var Y=function(J){if(z.push.apply(z,J),L++,L===O)return c(z),z.length?G(new iO(z,FS(z))):N(d)};i.length||(c(z),N(d)),i.forEach(function(K){var J=e[K];w.indexOf(K)!==-1?rO(J,o,Y):UQ(J,o,Y)})});return F.catch(function(N){return N}),F}function WQ(e){return!!(e&&e.message!==void 0)}function qQ(e,t){for(var o=e,c=0;c<t.length;c++){if(o==null)return o;o=o[t[c]]}return o}function oO(e,t){return function(o){var c;return e.fullFields?c=qQ(t,e.fullFields):c=t[o.field||e.fullField],WQ(o)?(o.field=o.field||e.fullField,o.fieldValue=c,o):{message:typeof o=="function"?o():o,fieldValue:c,field:o.field||e.fullField}}}function aO(e,t){if(t){for(var o in t)if(t.hasOwnProperty(o)){var c=t[o];typeof c=="object"&&typeof e[o]=="object"?e[o]=eh({},e[o],c):e[o]=c}}return e}var $4=function(t,o,c,d,y,w){t.required&&(!c.hasOwnProperty(t.field)||wo(o,w||t.type))&&d.push(Ba(y.messages.required,t.fullField))},ZQ=function(t,o,c,d,y){(/^\s+$/.test(o)||o==="")&&d.push(Ba(y.messages.whitespace,t.fullField))},ky,YQ=function(){if(ky)return ky;var e="[a-fA-F\\d:]",t=function(ne){return ne&&ne.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",c="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+c+":){7}(?:"+c+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+c+":){6}(?:"+o+"|:"+c+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+c+":){5}(?::"+o+"|(?::"+c+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+c+":){4}(?:(?::"+c+"){0,1}:"+o+"|(?::"+c+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+c+":){3}(?:(?::"+c+"){0,2}:"+o+"|(?::"+c+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+c+":){2}(?:(?::"+c+"){0,3}:"+o+"|(?::"+c+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+c+":){1}(?:(?::"+c+"){0,4}:"+o+"|(?::"+c+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+c+"){0,5}:"+o+"|(?::"+c+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),y=new RegExp("(?:^"+o+"$)|(?:^"+d+"$)"),w=new RegExp("^"+o+"$"),i=new RegExp("^"+d+"$"),O=function(ne){return ne&&ne.exact?y:new RegExp("(?:"+t(ne)+o+t(ne)+")|(?:"+t(ne)+d+t(ne)+")","g")};O.v4=function(te){return te&&te.exact?w:new RegExp(""+t(te)+o+t(te),"g")},O.v6=function(te){return te&&te.exact?i:new RegExp(""+t(te)+d+t(te),"g")};var L="(?:(?:[a-z]+:)?//)",z="(?:\\S+(?::\\S*)?@)?",F=O.v4().source,N=O.v6().source,G="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",Y="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",K="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",J="(?::\\d{2,5})?",X='(?:[/?#][^\\s"]*)?',se="(?:"+L+"|www\\.)"+z+"(?:localhost|"+F+"|"+N+"|"+G+Y+K+")"+J+X;return ky=new RegExp("(?:^"+se+"$)","i"),ky},sO={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Og={integer:function(t){return Og.number(t)&&parseInt(t,10)===t},float:function(t){return Og.number(t)&&!Og.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!Og.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(sO.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(YQ())},hex:function(t){return typeof t=="string"&&!!t.match(sO.hex)}},XQ=function(t,o,c,d,y){if(t.required&&o===void 0){$4(t,o,c,d,y);return}var w=["integer","float","array","regexp","object","method","email","number","date","url","hex"],i=t.type;w.indexOf(i)>-1?Og[i](o)||d.push(Ba(y.messages.types[i],t.fullField,t.type)):i&&typeof o!==t.type&&d.push(Ba(y.messages.types[i],t.fullField,t.type))},KQ=function(t,o,c,d,y){var w=typeof t.len=="number",i=typeof t.min=="number",O=typeof t.max=="number",L=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,z=o,F=null,N=typeof o=="number",G=typeof o=="string",Y=Array.isArray(o);if(N?F="number":G?F="string":Y&&(F="array"),!F)return!1;Y&&(z=o.length),G&&(z=o.replace(L,"_").length),w?z!==t.len&&d.push(Ba(y.messages[F].len,t.fullField,t.len)):i&&!O&&z<t.min?d.push(Ba(y.messages[F].min,t.fullField,t.min)):O&&!i&&z>t.max?d.push(Ba(y.messages[F].max,t.fullField,t.max)):i&&O&&(z<t.min||z>t.max)&&d.push(Ba(y.messages[F].range,t.fullField,t.min,t.max))},Ff="enum",JQ=function(t,o,c,d,y){t[Ff]=Array.isArray(t[Ff])?t[Ff]:[],t[Ff].indexOf(o)===-1&&d.push(Ba(y.messages[Ff],t.fullField,t[Ff].join(", ")))},QQ=function(t,o,c,d,y){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(o)||d.push(Ba(y.messages.pattern.mismatch,t.fullField,o,t.pattern));else if(typeof t.pattern=="string"){var w=new RegExp(t.pattern);w.test(o)||d.push(Ba(y.messages.pattern.mismatch,t.fullField,o,t.pattern))}}},Fr={required:$4,whitespace:ZQ,type:XQ,range:KQ,enum:JQ,pattern:QQ},eee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o,"string")&&!t.required)return c();Fr.required(t,o,d,w,y,"string"),wo(o,"string")||(Fr.type(t,o,d,w,y),Fr.range(t,o,d,w,y),Fr.pattern(t,o,d,w,y),t.whitespace===!0&&Fr.whitespace(t,o,d,w,y))}c(w)},tee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&Fr.type(t,o,d,w,y)}c(w)},nee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(o===""&&(o=void 0),wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&(Fr.type(t,o,d,w,y),Fr.range(t,o,d,w,y))}c(w)},ree=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&Fr.type(t,o,d,w,y)}c(w)},iee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),wo(o)||Fr.type(t,o,d,w,y)}c(w)},oee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&(Fr.type(t,o,d,w,y),Fr.range(t,o,d,w,y))}c(w)},aee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&(Fr.type(t,o,d,w,y),Fr.range(t,o,d,w,y))}c(w)},see=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(o==null&&!t.required)return c();Fr.required(t,o,d,w,y,"array"),o!=null&&(Fr.type(t,o,d,w,y),Fr.range(t,o,d,w,y))}c(w)},lee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&Fr.type(t,o,d,w,y)}c(w)},cee="enum",uee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y),o!==void 0&&Fr[cee](t,o,d,w,y)}c(w)},dee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o,"string")&&!t.required)return c();Fr.required(t,o,d,w,y),wo(o,"string")||Fr.pattern(t,o,d,w,y)}c(w)},hee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o,"date")&&!t.required)return c();if(Fr.required(t,o,d,w,y),!wo(o,"date")){var O;o instanceof Date?O=o:O=new Date(o),Fr.type(t,O,d,w,y),O&&Fr.range(t,O.getTime(),d,w,y)}}c(w)},fee=function(t,o,c,d,y){var w=[],i=Array.isArray(o)?"array":typeof o;Fr.required(t,o,d,w,y,i),c(w)},Cw=function(t,o,c,d,y){var w=t.type,i=[],O=t.required||!t.required&&d.hasOwnProperty(t.field);if(O){if(wo(o,w)&&!t.required)return c();Fr.required(t,o,d,i,y,w),wo(o,w)||Fr.type(t,o,d,i,y)}c(i)},pee=function(t,o,c,d,y){var w=[],i=t.required||!t.required&&d.hasOwnProperty(t.field);if(i){if(wo(o)&&!t.required)return c();Fr.required(t,o,d,w,y)}c(w)},Yg={string:eee,method:tee,number:nee,boolean:ree,regexp:iee,integer:oee,float:aee,array:see,object:lee,enum:uee,pattern:dee,date:hee,url:Cw,hex:Cw,email:Cw,required:fee,any:pee};function BS(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var kS=BS(),D_=function(){function e(o){this.rules=null,this._messages=kS,this.define(o)}var t=e.prototype;return t.define=function(c){var d=this;if(!c)throw new Error("Cannot configure a schema with no rules");if(typeof c!="object"||Array.isArray(c))throw new Error("Rules must be an object");this.rules={},Object.keys(c).forEach(function(y){var w=c[y];d.rules[y]=Array.isArray(w)?w:[w]})},t.messages=function(c){return c&&(this._messages=aO(BS(),c)),this._messages},t.validate=function(c,d,y){var w=this;d===void 0&&(d={}),y===void 0&&(y=function(){});var i=c,O=d,L=y;if(typeof O=="function"&&(L=O,O={}),!this.rules||Object.keys(this.rules).length===0)return L&&L(null,i),Promise.resolve(i);function z(K){var J=[],X={};function se(ne){if(Array.isArray(ne)){var ue;J=(ue=J).concat.apply(ue,ne)}else J.push(ne)}for(var te=0;te<K.length;te++)se(K[te]);J.length?(X=FS(J),L(J,X)):L(null,i)}if(O.messages){var F=this.messages();F===kS&&(F=BS()),aO(F,O.messages),O.messages=F}else O.messages=this.messages();var N={},G=O.keys||Object.keys(this.rules);G.forEach(function(K){var J=w.rules[K],X=i[K];J.forEach(function(se){var te=se;typeof te.transform=="function"&&(i===c&&(i=eh({},i)),X=i[K]=te.transform(X)),typeof te=="function"?te={validator:te}:te=eh({},te),te.validator=w.getValidationMethod(te),te.validator&&(te.field=K,te.fullField=te.fullField||K,te.type=w.getType(te),N[K]=N[K]||[],N[K].push({rule:te,value:X,source:i,field:K}))})});var Y={};return GQ(N,O,function(K,J){var X=K.rule,se=(X.type==="object"||X.type==="array")&&(typeof X.fields=="object"||typeof X.defaultField=="object");se=se&&(X.required||!X.required&&K.value),X.field=K.field;function te(ge,ee){return eh({},ee,{fullField:X.fullField+"."+ge,fullFields:X.fullFields?[].concat(X.fullFields,[ge]):[ge]})}function ne(ge){ge===void 0&&(ge=[]);var ee=Array.isArray(ge)?ge:[ge];!O.suppressWarning&&ee.length&&e.warning("async-validator:",ee),ee.length&&X.message!==void 0&&(ee=[].concat(X.message));var be=ee.map(oO(X,i));if(O.first&&be.length)return Y[X.field]=1,J(be);if(!se)J(be);else{if(X.required&&!K.value)return X.message!==void 0?be=[].concat(X.message).map(oO(X,i)):O.error&&(be=[O.error(X,Ba(O.messages.required,X.field))]),J(be);var Ie={};X.defaultField&&Object.keys(K.value).map(function(Qe){Ie[Qe]=X.defaultField}),Ie=eh({},Ie,K.rule.fields);var Ee={};Object.keys(Ie).forEach(function(Qe){var et=Ie[Qe],We=Array.isArray(et)?et:[et];Ee[Qe]=We.map(te.bind(null,Qe))});var Re=new e(Ee);Re.messages(O.messages),K.rule.options&&(K.rule.options.messages=O.messages,K.rule.options.error=O.error),Re.validate(K.value,K.rule.options||O,function(Qe){var et=[];be&&be.length&&et.push.apply(et,be),Qe&&Qe.length&&et.push.apply(et,Qe),J(et.length?et:null)})}}var ue;if(X.asyncValidator)ue=X.asyncValidator(X,K.value,ne,K.source,O);else if(X.validator){try{ue=X.validator(X,K.value,ne,K.source,O)}catch(ge){console.error==null||console.error(ge),O.suppressValidatorError||setTimeout(function(){throw ge},0),ne(ge.message)}ue===!0?ne():ue===!1?ne(typeof X.message=="function"?X.message(X.fullField||X.field):X.message||(X.fullField||X.field)+" fails"):ue instanceof Array?ne(ue):ue instanceof Error&&ne(ue.message)}ue&&ue.then&&ue.then(function(){return ne()},function(ge){return ne(ge)})},function(K){z(K)},i)},t.getType=function(c){if(c.type===void 0&&c.pattern instanceof RegExp&&(c.type="pattern"),typeof c.validator!="function"&&c.type&&!Yg.hasOwnProperty(c.type))throw new Error(Ba("Unknown rule type %s",c.type));return c.type||"string"},t.getValidationMethod=function(c){if(typeof c.validator=="function")return c.validator;var d=Object.keys(c),y=d.indexOf("message");return y!==-1&&d.splice(y,1),d.length===1&&d[0]==="required"?Yg.required:Yg[this.getType(c)]||void 0},e}();D_.register=function(t,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");Yg[t]=o};D_.warning=VQ;D_.messages=kS;D_.validators=Yg;function Su(e){return e==null?[]:Array.isArray(e)?e:[e]}function F4(e,t){let o=e;for(let c=0;c<t.length;c+=1){if(o==null)return;o=o[t[c]]}return o}function B4(e,t,o,c){if(!t.length)return o;const[d,...y]=t;let w;return!e&&typeof d=="number"?w=[]:Array.isArray(e)?w=[...e]:w=re({},e),c&&o===void 0&&y.length===1?delete w[d][y[0]]:w[d]=B4(w[d],y,o,c),w}function mee(e,t,o){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.length&&c&&o===void 0&&!F4(e,t.slice(0,-1))?e:B4(e,t,o,c)}function NS(e){return Su(e)}function gee(e,t){return F4(e,t)}function _ee(e,t,o){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return mee(e,t,o,c)}function yee(e,t){return e&&e.some(o=>xee(o,t))}function lO(e){return typeof e=="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function k4(e,t){const o=Array.isArray(e)?[...e]:re({},e);return t&&Object.keys(t).forEach(c=>{const d=o[c],y=t[c],w=lO(d)&&lO(y);o[c]=w?k4(d,y||{}):y}),o}function vee(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),c=1;c<t;c++)o[c-1]=arguments[c];return o.reduce((d,y)=>k4(d,y),e)}function cO(e,t){let o={};return t.forEach(c=>{const d=gee(e,c);o=_ee(o,c,d)}),o}function xee(e,t){return!e||!t||e.length!==t.length?!1:e.every((o,c)=>t[c]===o)}const Da="'${name}' is not a valid ${type}",$x={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Da,method:Da,array:Da,object:Da,number:Da,date:Da,boolean:Da,integer:Da,float:Da,regexp:Da,email:Da,url:Da,hex:Da},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}};var Fx=function(e,t,o,c){function d(y){return y instanceof o?y:new o(function(w){w(y)})}return new(o||(o=Promise))(function(y,w){function i(z){try{L(c.next(z))}catch(F){w(F)}}function O(z){try{L(c.throw(z))}catch(F){w(F)}}function L(z){z.done?y(z.value):d(z.value).then(i,O)}L((c=c.apply(e,t||[])).next())})};const bee=D_;function wee(e,t){return e.replace(/\$\{\w+\}/g,o=>{const c=o.slice(2,-1);return t[c]})}function VS(e,t,o,c,d){return Fx(this,void 0,void 0,function*(){const y=re({},o);delete y.ruleIndex,delete y.trigger;let w=null;y&&y.type==="array"&&y.defaultField&&(w=y.defaultField,delete y.defaultField);const i=new bee({[e]:[y]}),O=vee({},$x,c.validateMessages);i.messages(O);let L=[];try{yield Promise.resolve(i.validate({[e]:t},re({},c)))}catch(N){N.errors?L=N.errors.map((G,Y)=>{let{message:K}=G;return Tc(K)?Va(K,{key:`error_${Y}`}):K}):(console.error(N),L=[O.default()])}if(!L.length&&w)return(yield Promise.all(t.map((G,Y)=>VS(`${e}.${Y}`,G,w,c,d)))).reduce((G,Y)=>[...G,...Y],[]);const z=re(re(re({},o),{name:e,enum:(o.enum||[]).join(", ")}),d);return L.map(N=>typeof N=="string"?wee(N,z):N)})}function N4(e,t,o,c,d,y){const w=e.join("."),i=o.map((L,z)=>{const F=L.validator,N=re(re({},L),{ruleIndex:z});return F&&(N.validator=(G,Y,K)=>{let J=!1;const se=F(G,Y,function(){for(var te=arguments.length,ne=new Array(te),ue=0;ue<te;ue++)ne[ue]=arguments[ue];Promise.resolve().then(()=>{J||K(...ne)})});J=se&&typeof se.then=="function"&&typeof se.catch=="function",J&&se.then(()=>{K()}).catch(te=>{K(te||" ")})}),N}).sort((L,z)=>{let{warningOnly:F,ruleIndex:N}=L,{warningOnly:G,ruleIndex:Y}=z;return!!F==!!G?N-Y:F?1:-1});let O;if(d===!0)O=new Promise((L,z)=>Fx(this,void 0,void 0,function*(){for(let F=0;F<i.length;F+=1){const N=i[F],G=yield VS(w,t,N,c,y);if(G.length){z([{errors:G,rule:N}]);return}}L([])}));else{const L=i.map(z=>VS(w,t,z,c,y).then(F=>({errors:F,rule:z})));O=(d?Cee(L):See(L)).then(z=>Promise.reject(z))}return O.catch(L=>L),O}function See(e){return Fx(this,void 0,void 0,function*(){return Promise.all(e).then(t=>[].concat(...t))})}function Cee(e){return Fx(this,void 0,void 0,function*(){let t=0;return new Promise(o=>{e.forEach(c=>{c.then(d=>{d.errors.length&&o([d]),t+=1,t===e.length&&o([])})})})})}const V4=Symbol("formContextKey"),j4=e=>{li(V4,e)},XC=()=>Zr(V4,{name:He(()=>{}),labelAlign:He(()=>"right"),vertical:He(()=>!1),addField:(e,t)=>{},removeField:e=>{},model:He(()=>{}),rules:He(()=>{}),colon:He(()=>{}),labelWrap:He(()=>{}),labelCol:He(()=>{}),requiredMark:He(()=>!1),validateTrigger:He(()=>{}),onValidate:()=>{},validateMessages:He(()=>$x)}),U4=Symbol("formItemPrefixContextKey"),Tee=e=>{li(U4,e)},Eee=()=>Zr(U4,{prefixCls:He(()=>"")});function Mee(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const Iee=()=>({span:[String,Number],order:[String,Number],offset:[String,Number],push:[String,Number],pull:[String,Number],xs:{type:[String,Number,Object],default:void 0},sm:{type:[String,Number,Object],default:void 0},md:{type:[String,Number,Object],default:void 0},lg:{type:[String,Number,Object],default:void 0},xl:{type:[String,Number,Object],default:void 0},xxl:{type:[String,Number,Object],default:void 0},prefixCls:String,flex:[String,Number]}),Aee=["xs","sm","md","lg","xl","xxl"],KC=cn({compatConfig:{MODE:3},name:"ACol",inheritAttrs:!1,props:Iee(),setup(e,t){let{slots:o,attrs:c}=t;const{gutter:d,supportFlexGap:y,wrap:w}=AQ(),{prefixCls:i,direction:O}=Rr("col",e),[L,z]=LQ(i),F=He(()=>{const{span:G,order:Y,offset:K,push:J,pull:X}=e,se=i.value;let te={};return Aee.forEach(ne=>{let ue={};const ge=e[ne];typeof ge=="number"?ue.span=ge:typeof ge=="object"&&(ue=ge||{}),te=re(re({},te),{[`${se}-${ne}-${ue.span}`]:ue.span!==void 0,[`${se}-${ne}-order-${ue.order}`]:ue.order||ue.order===0,[`${se}-${ne}-offset-${ue.offset}`]:ue.offset||ue.offset===0,[`${se}-${ne}-push-${ue.push}`]:ue.push||ue.push===0,[`${se}-${ne}-pull-${ue.pull}`]:ue.pull||ue.pull===0,[`${se}-rtl`]:O.value==="rtl"})}),hn(se,{[`${se}-${G}`]:G!==void 0,[`${se}-order-${Y}`]:Y,[`${se}-offset-${K}`]:K,[`${se}-push-${J}`]:J,[`${se}-pull-${X}`]:X},te,c.class,z.value)}),N=He(()=>{const{flex:G}=e,Y=d.value,K={};if(Y&&Y[0]>0){const J=`${Y[0]/2}px`;K.paddingLeft=J,K.paddingRight=J}if(Y&&Y[1]>0&&!y.value){const J=`${Y[1]/2}px`;K.paddingTop=J,K.paddingBottom=J}return G&&(K.flex=Mee(G),w.value===!1&&!K.minWidth&&(K.minWidth=0)),K});return()=>{var G;return L(le("div",it(it({},c),{},{class:F.value,style:[N.value,c.style]}),[(G=o.default)===null||G===void 0?void 0:G.call(o)]))}}});var Pee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};function uO(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){Oee(e,d,o[d])})}return e}function Oee(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var JC=function(t,o){var c=uO({},t,o.attrs);return le(Hi,uO({},c,{icon:Pee}),null)};JC.displayName="QuestionCircleOutlined";JC.inheritAttrs=!1;const QC=(e,t)=>{let{slots:o,emit:c,attrs:d}=t;var y,w,i,O,L;const{prefixCls:z,htmlFor:F,labelCol:N,labelAlign:G,colon:Y,required:K,requiredMark:J}=re(re({},e),d),[X]=S_("Form"),se=(y=e.label)!==null&&y!==void 0?y:(w=o.label)===null||w===void 0?void 0:w.call(o);if(!se)return null;const{vertical:te,labelAlign:ne,labelCol:ue,labelWrap:ge,colon:ee}=XC(),be=N||(ue==null?void 0:ue.value)||{},Ie=G||(ne==null?void 0:ne.value),Ee=`${z}-item-label`,Re=hn(Ee,Ie==="left"&&`${Ee}-left`,be.class,{[`${Ee}-wrap`]:!!ge.value});let Qe=se;const et=Y===!0||(ee==null?void 0:ee.value)!==!1&&Y!==!1;if(et&&!te.value&&typeof se=="string"&&se.trim()!==""&&(Qe=se.replace(/[:|]\s*$/,"")),e.tooltip||o.tooltip){const Oe=le("span",{class:`${z}-item-tooltip`},[le(MC,{title:e.tooltip},{default:()=>[le(JC,null,null)]})]);Qe=le(hr,null,[Qe,o.tooltip?(i=o.tooltip)===null||i===void 0?void 0:i.call(o,{class:`${z}-item-tooltip`}):Oe])}J==="optional"&&!K&&(Qe=le(hr,null,[Qe,le("span",{class:`${z}-item-optional`},[((O=X.value)===null||O===void 0?void 0:O.optional)||((L=Eu.Form)===null||L===void 0?void 0:L.optional)])]));const me=hn({[`${z}-item-required`]:K,[`${z}-item-required-mark-optional`]:J==="optional",[`${z}-item-no-colon`]:!et});return le(KC,it(it({},be),{},{class:Re}),{default:()=>[le("label",{for:F,class:me,title:typeof se=="string"?se:"",onClick:Oe=>c("click",Oe)},[Qe])]})};QC.displayName="FormItemLabel";QC.inheritAttrs=!1;const Dee=e=>{const{componentCls:t}=e,o=`${t}-show-help`,c=`${t}-show-help-item`;return{[o]:{transition:`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[c]:{overflow:"hidden",transition:`height ${e.motionDurationSlow} ${e.motionEaseInOut},
                     opacity ${e.motionDurationSlow} ${e.motionEaseInOut},
                     transform ${e.motionDurationSlow} ${e.motionEaseInOut} !important`,[`&${c}-appear, &${c}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${c}-leave-active`]:{transform:"translateY(-5px)"}}}}},Ree=e=>({legend:{display:"block",width:"100%",marginBottom:e.marginLG,padding:0,color:e.colorTextDescription,fontSize:e.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`},label:{fontSize:e.fontSize},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`},output:{display:"block",paddingTop:15,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight}}),dO=(e,t)=>{const{formItemCls:o}=e;return{[o]:{[`${o}-label > label`]:{height:t},[`${o}-control-input`]:{minHeight:t}}}},zee=e=>{const{componentCls:t}=e;return{[e.componentCls]:re(re(re({},Ei(e)),Ree(e)),{[`${t}-text`]:{display:"inline-block",paddingInlineEnd:e.paddingSM},"&-small":re({},dO(e,e.controlHeightSM)),"&-large":re({},dO(e,e.controlHeightLG))})}},Lee=e=>{const{formItemCls:t,iconCls:o,componentCls:c,rootPrefixCls:d}=e;return{[t]:re(re({},Ei(e)),{marginBottom:e.marginLG,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden.${d}-row`]:{display:"none"},"&-has-warning":{[`${t}-split`]:{color:e.colorError}},"&-has-error":{[`${t}-split`]:{color:e.colorWarning}},[`${t}-label`]:{display:"inline-block",flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:`${e.lineHeight} - 0.25em`,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:e.controlHeight,color:e.colorTextHeading,fontSize:e.fontSize,[`> ${o}`]:{fontSize:e.fontSize,verticalAlign:"top"},[`&${t}-required:not(${t}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:e.marginXXS,color:e.colorError,fontSize:e.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${c}-hide-required-mark &`]:{display:"none"}},[`${t}-optional`]:{display:"inline-block",marginInlineStart:e.marginXXS,color:e.colorTextDescription,[`${c}-hide-required-mark &`]:{display:"none"}},[`${t}-tooltip`]:{color:e.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:e.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:e.marginXXS/2,marginInlineEnd:e.marginXS},[`&${t}-no-colon::after`]:{content:'" "'}}},[`${t}-control`]:{display:"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${d}-col-'"]):not([class*="' ${d}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:e.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[t]:{"&-explain, &-extra":{clear:"both",color:e.colorTextDescription,fontSize:e.fontSize,lineHeight:e.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:e.controlHeightSM,transition:`color ${e.motionDurationMid} ${e.motionEaseOut}`},"&-explain":{"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning}}},[`&-with-help ${t}-explain`]:{height:"auto",opacity:1},[`${t}-feedback-icon`]:{fontSize:e.fontSize,textAlign:"center",visibility:"visible",animationName:xC,animationDuration:e.motionDurationMid,animationTimingFunction:e.motionEaseOutBack,pointerEvents:"none","&-success":{color:e.colorSuccess},"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning},"&-validating":{color:e.colorPrimary}}})}},$ee=e=>{const{componentCls:t,formItemCls:o,rootPrefixCls:c}=e;return{[`${t}-horizontal`]:{[`${o}-label`]:{flexGrow:0},[`${o}-control`]:{flex:"1 1 0",minWidth:0},[`${o}-label.${c}-col-24 + ${o}-control`]:{minWidth:"unset"}}}},Fee=e=>{const{componentCls:t,formItemCls:o}=e;return{[`${t}-inline`]:{display:"flex",flexWrap:"wrap",[o]:{flex:"none",flexWrap:"nowrap",marginInlineEnd:e.margin,marginBottom:0,"&-with-help":{marginBottom:e.marginLG},[`> ${o}-label,
        > ${o}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${o}-label`]:{flex:"none"},[`${t}-text`]:{display:"inline-block"},[`${o}-has-feedback`]:{display:"inline-block"}}}}},Vf=e=>({margin:0,padding:`0 0 ${e.paddingXS}px`,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{display:"none"}}}),Bee=e=>{const{componentCls:t,formItemCls:o}=e;return{[`${o} ${o}-label`]:Vf(e),[t]:{[o]:{flexWrap:"wrap",[`${o}-label,
          ${o}-control`]:{flex:"0 0 100%",maxWidth:"100%"}}}}},kee=e=>{const{componentCls:t,formItemCls:o,rootPrefixCls:c}=e;return{[`${t}-vertical`]:{[o]:{"&-row":{flexDirection:"column"},"&-label > label":{height:"auto"},[`${t}-item-control`]:{width:"100%"}}},[`${t}-vertical ${o}-label,
      .${c}-col-24${o}-label,
      .${c}-col-xl-24${o}-label`]:Vf(e),[`@media (max-width: ${e.screenXSMax}px)`]:[Bee(e),{[t]:{[`.${c}-col-xs-24${o}-label`]:Vf(e)}}],[`@media (max-width: ${e.screenSMMax}px)`]:{[t]:{[`.${c}-col-sm-24${o}-label`]:Vf(e)}},[`@media (max-width: ${e.screenMDMax}px)`]:{[t]:{[`.${c}-col-md-24${o}-label`]:Vf(e)}},[`@media (max-width: ${e.screenLGMax}px)`]:{[t]:{[`.${c}-col-lg-24${o}-label`]:Vf(e)}}}},eT=Ui("Form",(e,t)=>{let{rootPrefixCls:o}=t;const c=Wr(e,{formItemCls:`${e.componentCls}-item`,rootPrefixCls:o});return[zee(c),Lee(c),Dee(c),$ee(c),Fee(c),kee(c),YL(c),xC]}),Nee=cn({compatConfig:{MODE:3},name:"ErrorList",inheritAttrs:!1,props:["errors","help","onErrorVisibleChanged","helpStatus","warnings"],setup(e,t){let{attrs:o}=t;const{prefixCls:c,status:d}=Eee(),y=He(()=>`${c.value}-item-explain`),w=He(()=>!!(e.errors&&e.errors.length)),i=tn(d.value),[,O]=eT(c);return On([w,d],()=>{w.value&&(i.value=d.value)}),()=>{var L,z;const F=h4(`${c.value}-show-help-item`),N=Q2(`${c.value}-show-help-item`,F);return N.role="alert",N.class=[O.value,y.value,o.class,`${c.value}-show-help`],le(Al,it(it({},M_(`${c.value}-show-help`)),{},{onAfterEnter:()=>e.onErrorVisibleChanged(!0),onAfterLeave:()=>e.onErrorVisibleChanged(!1)}),{default:()=>[Ns(le(w2,it(it({},N),{},{tag:"div"}),{default:()=>[(z=e.errors)===null||z===void 0?void 0:z.map((G,Y)=>le("div",{key:Y,class:i.value?`${y.value}-${i.value}`:""},[G]))]}),[[bl,!!(!((L=e.errors)===null||L===void 0)&&L.length)]])]})}}}),Vee=cn({compatConfig:{MODE:3},slots:Object,inheritAttrs:!1,props:["prefixCls","errors","hasFeedback","onDomErrorVisibleChange","wrapperCol","help","extra","status","marginBottom","onErrorVisibleChanged"],setup(e,t){let{slots:o}=t;const c=XC(),{wrapperCol:d}=c,y=re({},c);return delete y.labelCol,delete y.wrapperCol,j4(y),Tee({prefixCls:He(()=>e.prefixCls),status:He(()=>e.status)}),()=>{var w,i,O;const{prefixCls:L,wrapperCol:z,marginBottom:F,onErrorVisibleChanged:N,help:G=(w=o.help)===null||w===void 0?void 0:w.call(o),errors:Y=ms((i=o.errors)===null||i===void 0?void 0:i.call(o)),extra:K=(O=o.extra)===null||O===void 0?void 0:O.call(o)}=e,J=`${L}-item`,X=z||(d==null?void 0:d.value)||{},se=hn(`${J}-control`,X.class);return le(KC,it(it({},X),{},{class:se}),{default:()=>{var te;return le(hr,null,[le("div",{class:`${J}-control-input`},[le("div",{class:`${J}-control-input-content`},[(te=o.default)===null||te===void 0?void 0:te.call(o)])]),F!==null||Y.length?le("div",{style:{display:"flex",flexWrap:"nowrap"}},[le(Nee,{errors:Y,help:G,class:`${J}-explain-connected`,onErrorVisibleChanged:N},null),!!F&&le("div",{style:{width:0,height:`${F}px`}},null)]):null,K?le("div",{class:`${J}-extra`},[K]):null])}})}}});function jee(e){const t=Xt(e.value.slice());let o=null;return Ii(()=>{clearTimeout(o),o=setTimeout(()=>{t.value=e.value},e.value.length?0:10)}),t}Tu("success","warning","error","validating","");const Uee={success:zu,warning:Lu,error:Ks,validating:xc};function Tw(e,t,o){let c=e;const d=t;let y=0;try{for(let w=d.length;y<w-1&&!(!c&&!o);++y){const i=d[y];if(i in c)c=c[i];else{if(o)throw Error("please transfer a valid name path to form item!");break}}if(o&&!c)throw Error("please transfer a valid name path to form item!")}catch{console.error("please transfer a valid name path to form item!")}return{o:c,k:d[y],v:c?c[d[y]]:void 0}}const Hee=()=>({htmlFor:String,prefixCls:String,label:wt.any,help:wt.any,extra:wt.any,labelCol:{type:Object},wrapperCol:{type:Object},hasFeedback:{type:Boolean,default:!1},colon:{type:Boolean,default:void 0},labelAlign:String,prop:{type:[String,Number,Array]},name:{type:[String,Number,Array]},rules:[Array,Object],autoLink:{type:Boolean,default:!0},required:{type:Boolean,default:void 0},validateFirst:{type:Boolean,default:void 0},validateStatus:wt.oneOf(Tu("","success","warning","error","validating")),validateTrigger:{type:[String,Array]},messageVariables:{type:Object},hidden:Boolean,noStyle:Boolean,tooltip:String});let Gee=0;const Wee="form_item",H4=cn({compatConfig:{MODE:3},name:"AFormItem",inheritAttrs:!1,__ANT_NEW_FORM_ITEM:!0,props:Hee(),slots:Object,setup(e,t){let{slots:o,attrs:c,expose:d}=t;e.prop;const y=`form-item-${++Gee}`,{prefixCls:w}=Rr("form",e),[i,O]=eT(w),L=Xt(),z=XC(),F=He(()=>e.name||e.prop),N=Xt([]),G=Xt(!1),Y=Xt(),K=He(()=>{const Ut=F.value;return NS(Ut)}),J=He(()=>{if(K.value.length){const Ut=z.name.value,ln=K.value.join("_");return Ut?`${Ut}_${ln}`:`${Wee}_${ln}`}else return}),X=()=>{const Ut=z.model.value;if(!(!Ut||!F.value))return Tw(Ut,K.value,!0).v},se=He(()=>X()),te=Xt(ev(se.value)),ne=He(()=>{let Ut=e.validateTrigger!==void 0?e.validateTrigger:z.validateTrigger.value;return Ut=Ut===void 0?"change":Ut,Su(Ut)}),ue=He(()=>{let Ut=z.rules.value;const ln=e.rules,xn=e.required!==void 0?{required:!!e.required,trigger:ne.value}:[],En=Tw(Ut,K.value);Ut=Ut?En.o[En.k]||En.v:[];const Nt=[].concat(ln||Ut||[]);return XZ(Nt,_e=>_e.required)?Nt:Nt.concat(xn)}),ge=He(()=>{const Ut=ue.value;let ln=!1;return Ut&&Ut.length&&Ut.every(xn=>xn.required?(ln=!0,!1):!0),ln||e.required}),ee=Xt();Ii(()=>{ee.value=e.validateStatus});const be=He(()=>{let Ut={};return typeof e.label=="string"?Ut.label=e.label:e.name&&(Ut.label=String(e.name)),e.messageVariables&&(Ut=re(re({},Ut),e.messageVariables)),Ut}),Ie=Ut=>{if(K.value.length===0)return;const{validateFirst:ln=!1}=e,{triggerName:xn}=Ut||{};let En=ue.value;if(xn&&(En=En.filter(_e=>{const{trigger:Ft}=_e;return!Ft&&!ne.value.length?!0:Su(Ft||ne.value).includes(xn)})),!En.length)return Promise.resolve();const Nt=N4(K.value,se.value,En,re({validateMessages:z.validateMessages.value},Ut),ln,be.value);return ee.value="validating",N.value=[],Nt.catch(_e=>_e).then(function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(ee.value==="validating"){const Ft=_e.filter(Ve=>Ve&&Ve.errors.length);ee.value=Ft.length?"error":"success",N.value=Ft.map(Ve=>Ve.errors),z.onValidate(F.value,!N.value.length,N.value.length?Ir(N.value[0]):null)}}),Nt},Ee=()=>{Ie({triggerName:"blur"})},Re=()=>{if(G.value){G.value=!1;return}Ie({triggerName:"change"})},Qe=()=>{ee.value=e.validateStatus,G.value=!1,N.value=[]},et=()=>{var Ut;ee.value=e.validateStatus,G.value=!0,N.value=[];const ln=z.model.value||{},xn=se.value,En=Tw(ln,K.value,!0);Array.isArray(xn)?En.o[En.k]=[].concat((Ut=te.value)!==null&&Ut!==void 0?Ut:[]):En.o[En.k]=te.value,si(()=>{G.value=!1})},We=He(()=>e.htmlFor===void 0?J.value:e.htmlFor),me=()=>{const Ut=We.value;if(!Ut||!Y.value)return;const ln=Y.value.$el.querySelector(`[id="${Ut}"]`);ln&&ln.focus&&ln.focus()};d({onFieldBlur:Ee,onFieldChange:Re,clearValidate:Qe,resetField:et}),aW({id:J,onFieldBlur:()=>{e.autoLink&&Ee()},onFieldChange:()=>{e.autoLink&&Re()},clearValidate:Qe},He(()=>!!(e.autoLink&&z.model.value&&F.value)));let Oe=!1;On(F,Ut=>{Ut?Oe||(Oe=!0,z.addField(y,{fieldValue:se,fieldId:J,fieldName:F,resetField:et,clearValidate:Qe,namePath:K,validateRules:Ie,rules:ue})):(Oe=!1,z.removeField(y))},{immediate:!0}),fi(()=>{z.removeField(y)});const Fe=jee(N),Ke=He(()=>e.validateStatus!==void 0?e.validateStatus:Fe.value.length?"error":ee.value),$e=He(()=>({[`${w.value}-item`]:!0,[O.value]:!0,[`${w.value}-item-has-feedback`]:Ke.value&&e.hasFeedback,[`${w.value}-item-has-success`]:Ke.value==="success",[`${w.value}-item-has-warning`]:Ke.value==="warning",[`${w.value}-item-has-error`]:Ke.value==="error",[`${w.value}-item-is-validating`]:Ke.value==="validating",[`${w.value}-item-hidden`]:e.hidden})),pt=no({});xs.useProvide(pt),Ii(()=>{let Ut;if(e.hasFeedback){const ln=Ke.value&&Uee[Ke.value];Ut=ln?le("span",{class:hn(`${w.value}-item-feedback-icon`,`${w.value}-item-feedback-icon-${Ke.value}`)},[le(ln,null,null)]):null}re(pt,{status:Ke.value,hasFeedback:e.hasFeedback,feedbackIcon:Ut,isFormItemInput:!0})});const Ct=Xt(null),Lt=Xt(!1),It=()=>{if(L.value){const Ut=getComputedStyle(L.value);Ct.value=parseInt(Ut.marginBottom,10)}};Qr(()=>{On(Lt,()=>{Lt.value&&It()},{flush:"post",immediate:!0})});const _n=Ut=>{Ut||(Ct.value=null)};return()=>{var Ut,ln;if(e.noStyle)return(Ut=o.default)===null||Ut===void 0?void 0:Ut.call(o);const xn=(ln=e.help)!==null&&ln!==void 0?ln:o.help?ms(o.help()):null,En=!!(xn!=null&&Array.isArray(xn)&&xn.length||Fe.value.length);return Lt.value=En,i(le("div",{class:[$e.value,En?`${w.value}-item-with-help`:"",c.class],ref:L},[le(L4,it(it({},c),{},{class:`${w.value}-item-row`,key:"row"}),{default:()=>{var Nt,_e;return le(hr,null,[le(QC,it(it({},e),{},{htmlFor:We.value,required:ge.value,requiredMark:z.requiredMark.value,prefixCls:w.value,onClick:me,label:e.label}),{label:o.label,tooltip:o.tooltip}),le(Vee,it(it({},e),{},{errors:xn!=null?Su(xn):Fe.value,marginBottom:Ct.value,prefixCls:w.value,status:Ke.value,ref:Y,help:xn,extra:(Nt=e.extra)!==null&&Nt!==void 0?Nt:(_e=o.extra)===null||_e===void 0?void 0:_e.call(o),onErrorVisibleChanged:_n}),{default:o.default})])}}),!!Ct.value&&le("div",{class:`${w.value}-margin-offset`,style:{marginBottom:`-${Ct.value}px`}},null)]))}}});function G4(e){let t=!1,o=e.length;const c=[];return e.length?new Promise((d,y)=>{e.forEach((w,i)=>{w.catch(O=>(t=!0,O)).then(O=>{o-=1,c[i]=O,!(o>0)&&(t&&y(c),d(c))})})}):Promise.resolve([])}function hO(e){let t=!1;return e&&e.length&&e.every(o=>o.required?(t=!0,!1):!0),t}function fO(e){return e==null?[]:Array.isArray(e)?e:[e]}function Ew(e,t,o){let c=e;t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");const d=t.split(".");let y=0;for(let w=d.length;y<w-1&&!(!c&&!o);++y){const i=d[y];if(i in c)c=c[i];else{if(o)throw new Error("please transfer a valid name path to validate!");break}}return{o:c,k:d[y],v:c?c[d[y]]:null,isValid:c&&d[y]in c}}function qee(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tn({}),o=arguments.length>2?arguments[2]:void 0;const c=ev(Ar(e)),d=no({}),y=Xt([]),w=te=>{re(Ar(e),re(re({},ev(c)),te)),si(()=>{Object.keys(d).forEach(ne=>{d[ne]={autoLink:!1,required:hO(Ar(t)[ne])}})})},i=function(){let te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ne=arguments.length>1?arguments[1]:void 0;return ne.length?te.filter(ue=>{const ge=fO(ue.trigger||"change");return eY(ge,ne).length}):te};let O=null;const L=function(te){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=arguments.length>2?arguments[2]:void 0;const ge=[],ee={};for(let Ee=0;Ee<te.length;Ee++){const Re=te[Ee],Qe=Ew(Ar(e),Re,ue);if(!Qe.isValid)continue;ee[Re]=Qe.v;const et=i(Ar(t)[Re],fO(ne&&ne.trigger));et.length&&ge.push(z(Re,Qe.v,et,ne||{}).then(()=>({name:Re,errors:[],warnings:[]})).catch(We=>{const me=[],Oe=[];return We.forEach(Fe=>{let{rule:{warningOnly:Ke},errors:$e}=Fe;Ke?Oe.push(...$e):me.push(...$e)}),me.length?Promise.reject({name:Re,errors:me,warnings:Oe}):{name:Re,errors:me,warnings:Oe}}))}const be=G4(ge);O=be;const Ie=be.then(()=>O===be?Promise.resolve(ee):Promise.reject([])).catch(Ee=>{const Re=Ee.filter(Qe=>Qe&&Qe.errors.length);return Re.length?Promise.reject({values:ee,errorFields:Re,outOfDate:O!==be}):Promise.resolve(ee)});return Ie.catch(Ee=>Ee),Ie},z=function(te,ne,ue){let ge=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const ee=N4([te],ne,ue,re({validateMessages:$x},ge),!!ge.validateFirst);return d[te]?(d[te].validateStatus="validating",ee.catch(be=>be).then(function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var Ie;if(d[te].validateStatus==="validating"){const Ee=be.filter(Re=>Re&&Re.errors.length);d[te].validateStatus=Ee.length?"error":"success",d[te].help=Ee.length?Ee.map(Re=>Re.errors):null,(Ie=o==null?void 0:o.onValidate)===null||Ie===void 0||Ie.call(o,te,!Ee.length,Ee.length?Ir(d[te].help[0]):null)}}),ee):ee.catch(be=>be)},F=(te,ne)=>{let ue=[],ge=!0;te?Array.isArray(te)?ue=te:ue=[te]:(ge=!1,ue=y.value);const ee=L(ue,ne||{},ge);return ee.catch(be=>be),ee},N=te=>{let ne=[];te?Array.isArray(te)?ne=te:ne=[te]:ne=y.value,ne.forEach(ue=>{d[ue]&&re(d[ue],{validateStatus:"",help:null})})},G=te=>{const ne={autoLink:!1},ue=[],ge=Array.isArray(te)?te:[te];for(let ee=0;ee<ge.length;ee++){const be=ge[ee];(be==null?void 0:be.validateStatus)==="error"&&(ne.validateStatus="error",be.help&&ue.push(be.help)),ne.required=ne.required||(be==null?void 0:be.required)}return ne.help=ue,ne};let Y=c,K=!0;const J=te=>{const ne=[];y.value.forEach(ue=>{const ge=Ew(te,ue,!1),ee=Ew(Y,ue,!1);(K&&(o==null?void 0:o.immediate)&&ge.isValid||!J2(ge.v,ee.v))&&ne.push(ue)}),F(ne,{trigger:"change"}),K=!1,Y=ev(Ir(te))},X=o==null?void 0:o.debounce;let se=!0;return On(t,()=>{y.value=t?Object.keys(Ar(t)):[],!se&&o&&o.validateOnRuleChange&&F(),se=!1},{deep:!0,immediate:!0}),On(y,()=>{const te={};y.value.forEach(ne=>{te[ne]=re({},d[ne],{autoLink:!1,required:hO(Ar(t)[ne])}),delete d[ne]});for(const ne in d)Object.prototype.hasOwnProperty.call(d,ne)&&delete d[ne];re(d,te)},{immediate:!0}),On(e,X&&X.wait?HZ(J,X.wait,dY(X,["wait"])):J,{immediate:o&&!!o.immediate,deep:!0}),{modelRef:e,rulesRef:t,initialModel:c,validateInfos:d,resetFields:w,validate:F,validateField:z,mergeValidateInfo:G,clearValidate:N}}const Zee=()=>({layout:wt.oneOf(Tu("horizontal","inline","vertical")),labelCol:oi(),wrapperCol:oi(),colon:Cr(),labelAlign:Io(),labelWrap:Cr(),prefixCls:String,requiredMark:Mo([String,Boolean]),hideRequiredMark:Cr(),model:wt.object,rules:oi(),validateMessages:oi(),validateOnRuleChange:Cr(),scrollToFirstError:La(),onSubmit:Jr(),name:String,validateTrigger:Mo([String,Array]),size:Io(),disabled:Cr(),onValuesChange:Jr(),onFieldsChange:Jr(),onFinish:Jr(),onFinishFailed:Jr(),onValidate:Jr()});function Yee(e,t){return J2(Su(e),Su(t))}const yu=cn({compatConfig:{MODE:3},name:"AForm",inheritAttrs:!1,props:Wo(Zee(),{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:H4,useForm:qee,setup(e,t){let{emit:o,slots:c,expose:d,attrs:y}=t;const{prefixCls:w,direction:i,form:O,size:L,disabled:z}=Rr("form",e),F=He(()=>e.requiredMark===""||e.requiredMark),N=He(()=>{var Fe;return F.value!==void 0?F.value:O&&((Fe=O.value)===null||Fe===void 0?void 0:Fe.requiredMark)!==void 0?O.value.requiredMark:!e.hideRequiredMark});xz(L),kR(z);const G=He(()=>{var Fe,Ke;return(Fe=e.colon)!==null&&Fe!==void 0?Fe:(Ke=O.value)===null||Ke===void 0?void 0:Ke.colon}),{validateMessages:Y}=fV(),K=He(()=>re(re(re({},$x),Y.value),e.validateMessages)),[J,X]=eT(w),se=He(()=>hn(w.value,{[`${w.value}-${e.layout}`]:!0,[`${w.value}-hide-required-mark`]:N.value===!1,[`${w.value}-rtl`]:i.value==="rtl",[`${w.value}-${L.value}`]:L.value},X.value)),te=tn(),ne={},ue=(Fe,Ke)=>{ne[Fe]=Ke},ge=Fe=>{delete ne[Fe]},ee=Fe=>{const Ke=!!Fe,$e=Ke?Su(Fe).map(NS):[];return Ke?Object.values(ne).filter(pt=>$e.findIndex(Ct=>Yee(Ct,pt.fieldName.value))>-1):Object.values(ne)},be=Fe=>{e.model&&ee(Fe).forEach(Ke=>{Ke.resetField()})},Ie=Fe=>{ee(Fe).forEach(Ke=>{Ke.clearValidate()})},Ee=Fe=>{const{scrollToFirstError:Ke}=e;if(o("finishFailed",Fe),Ke&&Fe.errorFields.length){let $e={};typeof Ke=="object"&&($e=Ke),Qe(Fe.errorFields[0].name,$e)}},Re=function(){return me(...arguments)},Qe=function(Fe){let Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const $e=ee(Fe?[Fe]:void 0);if($e.length){const pt=$e[0].fieldId.value,Ct=pt?document.getElementById(pt):null;Ct&&lj(Ct,re({scrollMode:"if-needed",block:"nearest"},Ke))}},et=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(Fe===!0){const Ke=[];return Object.values(ne).forEach($e=>{let{namePath:pt}=$e;Ke.push(pt.value)}),cO(e.model,Ke)}else return cO(e.model,Fe)},We=(Fe,Ke)=>{if(!e.model)return Promise.reject("Form `model` is required for validateFields to work.");const $e=!!Fe,pt=$e?Su(Fe).map(NS):[],Ct=[];Object.values(ne).forEach(_n=>{var Ut;if($e||pt.push(_n.namePath.value),!(!((Ut=_n.rules)===null||Ut===void 0)&&Ut.value.length))return;const ln=_n.namePath.value;if(!$e||yee(pt,ln)){const xn=_n.validateRules(re({validateMessages:K.value},Ke));Ct.push(xn.then(()=>({name:ln,errors:[],warnings:[]})).catch(En=>{const Nt=[],_e=[];return En.forEach(Ft=>{let{rule:{warningOnly:Ve},errors:Ye}=Ft;Ve?_e.push(...Ye):Nt.push(...Ye)}),Nt.length?Promise.reject({name:ln,errors:Nt,warnings:_e}):{name:ln,errors:Nt,warnings:_e}}))}});const Lt=G4(Ct);te.value=Lt;const It=Lt.then(()=>te.value===Lt?Promise.resolve(et(pt)):Promise.reject([])).catch(_n=>{const Ut=_n.filter(ln=>ln&&ln.errors.length);return Promise.reject({values:et(pt),errorFields:Ut,outOfDate:te.value!==Lt})});return It.catch(_n=>_n),It},me=function(){return We(...arguments)},Oe=Fe=>{Fe.preventDefault(),Fe.stopPropagation(),o("submit",Fe),e.model&&We().then($e=>{o("finish",$e)}).catch($e=>{Ee($e)})};return d({resetFields:be,clearValidate:Ie,validateFields:We,getFieldsValue:et,validate:Re,scrollToField:Qe}),j4({model:He(()=>e.model),name:He(()=>e.name),labelAlign:He(()=>e.labelAlign),labelCol:He(()=>e.labelCol),labelWrap:He(()=>e.labelWrap),wrapperCol:He(()=>e.wrapperCol),vertical:He(()=>e.layout==="vertical"),colon:G,requiredMark:N,validateTrigger:He(()=>e.validateTrigger),rules:He(()=>e.rules),addField:ue,removeField:ge,onValidate:(Fe,Ke,$e)=>{o("validate",Fe,Ke,$e)},validateMessages:K}),On(()=>e.rules,()=>{e.validateOnRuleChange&&We()}),()=>{var Fe;return J(le("form",it(it({},y),{},{onSubmit:Oe,class:[se.value,y.class]}),[(Fe=c.default)===null||Fe===void 0?void 0:Fe.call(c)]))}}});yu.useInjectFormItemContext=Ic;yu.ItemRest=SS;yu.install=function(e){return e.component(yu.name,yu),e.component(yu.Item.name,yu.Item),e.component(SS.name,SS),e};const Xee=new xr("antCheckboxEffect",{"0%":{transform:"scale(1)",opacity:.5},"100%":{transform:"scale(1.6)",opacity:0}}),Kee=e=>{const{checkboxCls:t}=e,o=`${t}-wrapper`;return[{[`${t}-group`]:re(re({},Ei(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[o]:re(re({},Ei(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${o}`]:{marginInlineStart:0},[`&${o}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[t]:re(re({},Ei(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",alignSelf:"center",[`${t}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${t}-inner`]:re({},px(e))},[`${t}-inner`]:{boxSizing:"border-box",position:"relative",top:0,insetInlineStart:0,display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"21.5%",display:"table",width:e.checkboxSize/14*5,height:e.checkboxSize/14*8,border:`${e.lineWidthBold}px solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[t]:{"&-indeterminate":{[`${t}-inner`]:{"&:after":{top:"50%",insetInlineStart:"50%",width:e.fontSizeLG/2,height:e.fontSizeLG/2,backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}}}}},{[`${o}:hover ${t}:after`]:{visibility:"visible"},[`
        ${o}:not(${o}-disabled),
        ${t}:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{borderColor:e.colorPrimary}},[`${o}:not(${o}-disabled)`]:{[`&:hover ${t}-checked:not(${t}-disabled) ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${t}-checked:not(${t}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${t}-checked`]:{[`${t}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}},"&:after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderRadius:e.borderRadiusSM,visibility:"hidden",border:`${e.lineWidthBold}px solid ${e.colorPrimary}`,animationName:Xee,animationDuration:e.motionDurationSlow,animationTimingFunction:"ease-in-out",animationFillMode:"backwards",content:'""',transition:`all ${e.motionDurationSlow}`}},[`
        ${o}-checked:not(${o}-disabled),
        ${t}-checked:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${t}:after`]:{borderColor:e.colorPrimaryHover}}},{[`${o}-disabled`]:{cursor:"not-allowed"},[`${t}-disabled`]:{[`&, ${t}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${t}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${t}-indeterminate ${t}-inner::after`]:{background:e.colorTextDisabled}}}]};function Jee(e,t){const o=Wr(t,{checkboxCls:`.${e}`,checkboxSize:t.controlInteractiveSize});return[Kee(o)]}const W4=Ui("Checkbox",(e,t)=>{let{prefixCls:o}=t;return[Jee(o,e)]}),Qee=()=>({name:String,prefixCls:String,options:op([]),disabled:Boolean,id:String}),ete=()=>re(re({},Qee()),{defaultValue:op(),value:op(),onChange:Jr(),"onUpdate:value":Jr()}),tte=()=>({prefixCls:String,defaultChecked:Cr(),checked:Cr(),disabled:Cr(),isGroup:Cr(),value:wt.any,name:String,id:String,indeterminate:Cr(),type:Io("checkbox"),autofocus:Cr(),onChange:Jr(),"onUpdate:checked":Jr(),onClick:Jr(),skipGroup:Cr(!1)}),nte=()=>re(re({},tte()),{indeterminate:Cr(!1)}),q4=Symbol("CheckboxGroupContext");var pO=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const ep=cn({compatConfig:{MODE:3},name:"ACheckbox",inheritAttrs:!1,__ANT_CHECKBOX:!0,props:nte(),setup(e,t){let{emit:o,attrs:c,slots:d,expose:y}=t;const w=Ic(),i=xs.useInject(),{prefixCls:O,direction:L,disabled:z}=Rr("checkbox",e),F=yc(),[N,G]=W4(O),Y=Zr(q4,void 0),K=Symbol("checkboxUniId"),J=He(()=>(Y==null?void 0:Y.disabled.value)||z.value);Ii(()=>{!e.skipGroup&&Y&&Y.registerValue(K,e.value)}),fi(()=>{Y&&Y.cancelValue(K)}),Qr(()=>{Ou(!!(e.checked!==void 0||Y||e.value===void 0))});const X=ue=>{const ge=ue.target.checked;o("update:checked",ge),o("change",ue),w.onFieldChange()},se=tn();return y({focus:()=>{var ue;(ue=se.value)===null||ue===void 0||ue.focus()},blur:()=>{var ue;(ue=se.value)===null||ue===void 0||ue.blur()}}),()=>{var ue;const ge=vo((ue=d.default)===null||ue===void 0?void 0:ue.call(d)),{indeterminate:ee,skipGroup:be,id:Ie=w.id.value}=e,Ee=pO(e,["indeterminate","skipGroup","id"]),{onMouseenter:Re,onMouseleave:Qe,onInput:et,class:We,style:me}=c,Oe=pO(c,["onMouseenter","onMouseleave","onInput","class","style"]),Fe=re(re(re(re({},Ee),{id:Ie,prefixCls:O.value}),Oe),{disabled:J.value});Y&&!be?(Fe.onChange=function(){for(var Ct=arguments.length,Lt=new Array(Ct),It=0;It<Ct;It++)Lt[It]=arguments[It];o("change",...Lt),Y.toggleOption({label:ge,value:e.value})},Fe.name=Y.name.value,Fe.checked=Y.mergedValue.value.includes(e.value),Fe.disabled=J.value||F.value,Fe.indeterminate=ee):Fe.onChange=X;const Ke=hn({[`${O.value}-wrapper`]:!0,[`${O.value}-rtl`]:L.value==="rtl",[`${O.value}-wrapper-checked`]:Fe.checked,[`${O.value}-wrapper-disabled`]:Fe.disabled,[`${O.value}-wrapper-in-form-item`]:i.isFormItemInput},We,G.value),$e=hn({[`${O.value}-indeterminate`]:ee},G.value);return N(le("label",{class:Ke,style:me,onMouseenter:Re,onMouseleave:Qe},[le(y4,it(it({"aria-checked":ee?"mixed":void 0},Fe),{},{class:$e,ref:se}),null),ge.length?le("span",null,[ge]):null]))}}}),Hv=cn({compatConfig:{MODE:3},name:"ACheckboxGroup",inheritAttrs:!1,props:ete(),setup(e,t){let{slots:o,attrs:c,emit:d,expose:y}=t;const w=Ic(),{prefixCls:i,direction:O}=Rr("checkbox",e),L=He(()=>`${i.value}-group`),[z,F]=W4(L),N=tn((e.value===void 0?e.defaultValue:e.value)||[]);On(()=>e.value,()=>{N.value=e.value||[]});const G=He(()=>e.options.map(ne=>typeof ne=="string"||typeof ne=="number"?{label:ne,value:ne}:ne)),Y=tn(Symbol()),K=tn(new Map),J=ne=>{K.value.delete(ne),Y.value=Symbol()},X=(ne,ue)=>{K.value.set(ne,ue),Y.value=Symbol()},se=tn(new Map);return On(Y,()=>{const ne=new Map;for(const ue of K.value.values())ne.set(ue,!0);se.value=ne}),li(q4,{cancelValue:J,registerValue:X,toggleOption:ne=>{const ue=N.value.indexOf(ne.value),ge=[...N.value];ue===-1?ge.push(ne.value):ge.splice(ue,1),e.value===void 0&&(N.value=ge);const ee=ge.filter(be=>se.value.has(be)).sort((be,Ie)=>{const Ee=G.value.findIndex(Qe=>Qe.value===be),Re=G.value.findIndex(Qe=>Qe.value===Ie);return Ee-Re});d("update:value",ee),d("change",ee),w.onFieldChange()},mergedValue:N,name:He(()=>e.name),disabled:He(()=>e.disabled)}),y({mergedValue:N}),()=>{var ne;const{id:ue=w.id.value}=e;let ge=null;return G.value&&G.value.length>0&&(ge=G.value.map(ee=>{var be;return le(ep,{prefixCls:i.value,key:ee.value.toString(),disabled:"disabled"in ee?ee.disabled:e.disabled,indeterminate:ee.indeterminate,value:ee.value,checked:N.value.indexOf(ee.value)!==-1,onChange:ee.onChange,class:`${L.value}-item`},{default:()=>[o.label!==void 0?(be=o.label)===null||be===void 0?void 0:be.call(o,ee):ee.label]})})),z(le("div",it(it({},c),{},{class:[L.value,{[`${L.value}-rtl`]:O.value==="rtl"},c.class,F.value],id:ue}),[ge||((ne=o.default)===null||ne===void 0?void 0:ne.call(o))]))}}});ep.Group=Hv;ep.install=function(e){return e.component(ep.name,ep),e.component(Hv.name,Hv),e};const rte=Pl(KC);let fv=re({},Eu.Modal);function ite(e){e?fv=re(re({},fv),e):fv=re({},Eu.Modal)}function ote(){return fv}const jS="internalMark",pv=cn({compatConfig:{MODE:3},name:"ALocaleProvider",props:{locale:{type:Object},ANT_MARK__:String},setup(e,t){let{slots:o}=t;Ou(e.ANT_MARK__===jS);const c=no({antLocale:re(re({},e.locale),{exist:!0}),ANT_MARK__:jS});return li("localeData",c),On(()=>e.locale,d=>{ite(d&&d.Modal),c.antLocale=re(re({},d),{exist:!0})},{immediate:!0}),()=>{var d;return(d=o.default)===null||d===void 0?void 0:d.call(o)}}});pv.install=function(e){return e.component(pv.name,pv),e};const ate=Pl(pv),Z4=cn({name:"Notice",inheritAttrs:!1,props:["prefixCls","duration","updateMark","noticeKey","closeIcon","closable","props","onClick","onClose","holder","visible"],setup(e,t){let{attrs:o,slots:c}=t,d,y=!1;const w=He(()=>e.duration===void 0?4.5:e.duration),i=()=>{w.value&&!y&&(d=setTimeout(()=>{L()},w.value*1e3))},O=()=>{d&&(clearTimeout(d),d=null)},L=F=>{F&&F.stopPropagation(),O();const{onClose:N,noticeKey:G}=e;N&&N(G)},z=()=>{O(),i()};return Qr(()=>{i()}),Cc(()=>{y=!0,O()}),On([w,()=>e.updateMark,()=>e.visible],(F,N)=>{let[G,Y,K]=F,[J,X,se]=N;(G!==J||Y!==X||K!==se&&se)&&z()},{flush:"post"}),()=>{var F,N;const{prefixCls:G,closable:Y,closeIcon:K=(F=c.closeIcon)===null||F===void 0?void 0:F.call(c),onClick:J,holder:X}=e,{class:se,style:te}=o,ne=`${G}-notice`,ue=Object.keys(o).reduce((ee,be)=>((be.startsWith("data-")||be.startsWith("aria-")||be==="role")&&(ee[be]=o[be]),ee),{}),ge=le("div",it({class:hn(ne,se,{[`${ne}-closable`]:Y}),style:te,onMouseenter:O,onMouseleave:i,onClick:J},ue),[le("div",{class:`${ne}-content`},[(N=c.default)===null||N===void 0?void 0:N.call(c)]),Y?le("a",{tabindex:0,onClick:L,class:`${ne}-close`},[K||le("span",{class:`${ne}-close-x`},null)]):null]);return X?le(BD,{to:X},{default:()=>ge}):ge}}});var ste=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};let mO=0;const lte=Date.now();function gO(){const e=mO;return mO+=1,`rcNotification_${lte}_${e}`}const Gv=cn({name:"Notification",inheritAttrs:!1,props:["prefixCls","transitionName","animation","maxCount","closeIcon","hashId"],setup(e,t){let{attrs:o,expose:c,slots:d}=t;const y=new Map,w=tn([]),i=He(()=>{const{prefixCls:z,animation:F="fade"}=e;let N=e.transitionName;return!N&&F&&(N=`${z}-${F}`),Q2(N)}),O=(z,F)=>{const N=z.key||gO(),G=re(re({},z),{key:N}),{maxCount:Y}=e,K=w.value.map(X=>X.notice.key).indexOf(N),J=w.value.concat();K!==-1?J.splice(K,1,{notice:G,holderCallback:F}):(Y&&w.value.length>=Y&&(G.key=J[0].notice.key,G.updateMark=gO(),G.userPassKey=N,J.shift()),J.push({notice:G,holderCallback:F})),w.value=J},L=z=>{w.value=Ir(w.value).filter(F=>{let{notice:{key:N,userPassKey:G}}=F;return(G||N)!==z})};return c({add:O,remove:L,notices:w}),()=>{var z;const{prefixCls:F,closeIcon:N=(z=d.closeIcon)===null||z===void 0?void 0:z.call(d,{prefixCls:F})}=e,G=w.value.map((K,J)=>{let{notice:X,holderCallback:se}=K;const te=J===w.value.length-1?X.updateMark:void 0,{key:ne,userPassKey:ue}=X,{content:ge}=X,ee=re(re(re({prefixCls:F,closeIcon:typeof N=="function"?N({prefixCls:F}):N},X),X.props),{key:ne,noticeKey:ue||ne,updateMark:te,onClose:be=>{var Ie;L(be),(Ie=X.onClose)===null||Ie===void 0||Ie.call(X)},onClick:X.onClick});return se?le("div",{key:ne,class:`${F}-hook-holder`,ref:be=>{typeof ne>"u"||(be?(y.set(ne,be),se(be,ee)):y.delete(ne))}},null):le(Z4,it(it({},ee),{},{class:hn(ee.class,e.hashId)}),{default:()=>[typeof ge=="function"?ge({prefixCls:F}):ge]})}),Y={[F]:1,[o.class]:!!o.class,[e.hashId]:!0};return le("div",{class:Y,style:o.style||{top:"65px",left:"50%"}},[le(w2,it({tag:"div"},i.value),{default:()=>[G]})])}}});Gv.newInstance=function(t,o){const c=t||{},{name:d="notification",getContainer:y,appContext:w,prefixCls:i,rootPrefixCls:O,transitionName:L,hasTransitionName:z,useStyle:F}=c,N=ste(c,["name","getContainer","appContext","prefixCls","rootPrefixCls","transitionName","hasTransitionName","useStyle"]),G=document.createElement("div");y?y().appendChild(G):document.body.appendChild(G);const K=le(cn({compatConfig:{MODE:3},name:"NotificationWrapper",setup(J,X){let{attrs:se}=X;const te=Xt(),ne=He(()=>zo.getPrefixCls(d,i)),[,ue]=F(ne);return Qr(()=>{o({notice(ge){var ee;(ee=te.value)===null||ee===void 0||ee.add(ge)},removeNotice(ge){var ee;(ee=te.value)===null||ee===void 0||ee.remove(ge)},destroy(){Cu(null,G),G.parentNode&&G.parentNode.removeChild(G)},component:te})}),()=>{const ge=zo,ee=ge.getRootPrefixCls(O,ne.value),be=z?L:`${ne.value}-${L}`;return le(sh,it(it({},ge),{},{prefixCls:ee}),{default:()=>[le(Gv,it(it({ref:te},se),{},{prefixCls:ne.value,transitionName:be,hashId:ue.value}),null)]})}}}),N);K.appContext=w||K.appContext,Cu(K,G)};let _O=0;const cte=Date.now();function yO(){const e=_O;return _O+=1,`rcNotification_${cte}_${e}`}const ute=cn({name:"HookNotification",inheritAttrs:!1,props:["prefixCls","transitionName","animation","maxCount","closeIcon","hashId","remove","notices","getStyles","getClassName","onAllRemoved","getContainer"],setup(e,t){let{attrs:o,slots:c}=t;const d=new Map,y=He(()=>e.notices),w=He(()=>{let z=e.transitionName;if(!z&&e.animation)switch(typeof e.animation){case"string":z=e.animation;break;case"function":z=e.animation().name;break;case"object":z=e.animation.name;break;default:z=`${e.prefixCls}-fade`;break}return Q2(z)}),i=z=>e.remove(z),O=tn({});On(y,()=>{const z={};Object.keys(O.value).forEach(F=>{z[F]=[]}),e.notices.forEach(F=>{const{placement:N="topRight"}=F.notice;N&&(z[N]=z[N]||[],z[N].push(F))}),O.value=z});const L=He(()=>Object.keys(O.value));return()=>{var z;const{prefixCls:F,closeIcon:N=(z=c.closeIcon)===null||z===void 0?void 0:z.call(c,{prefixCls:F})}=e,G=L.value.map(Y=>{var K,J;const X=O.value[Y],se=(K=e.getClassName)===null||K===void 0?void 0:K.call(e,Y),te=(J=e.getStyles)===null||J===void 0?void 0:J.call(e,Y),ne=X.map((ee,be)=>{let{notice:Ie,holderCallback:Ee}=ee;const Re=be===y.value.length-1?Ie.updateMark:void 0,{key:Qe,userPassKey:et}=Ie,{content:We}=Ie,me=re(re(re({prefixCls:F,closeIcon:typeof N=="function"?N({prefixCls:F}):N},Ie),Ie.props),{key:Qe,noticeKey:et||Qe,updateMark:Re,onClose:Oe=>{var Fe;i(Oe),(Fe=Ie.onClose)===null||Fe===void 0||Fe.call(Ie)},onClick:Ie.onClick});return Ee?le("div",{key:Qe,class:`${F}-hook-holder`,ref:Oe=>{typeof Qe>"u"||(Oe?(d.set(Qe,Oe),Ee(Oe,me)):d.delete(Qe))}},null):le(Z4,it(it({},me),{},{class:hn(me.class,e.hashId)}),{default:()=>[typeof We=="function"?We({prefixCls:F}):We]})}),ue={[F]:1,[`${F}-${Y}`]:1,[o.class]:!!o.class,[e.hashId]:!0,[se]:!!se};function ge(){var ee;X.length>0||(Reflect.deleteProperty(O.value,Y),(ee=e.onAllRemoved)===null||ee===void 0||ee.call(e))}return le("div",{key:Y,class:ue,style:o.style||te||{top:"65px",left:"50%"}},[le(w2,it(it({tag:"div"},w.value),{},{onAfterLeave:ge}),{default:()=>[ne]})])});return le(tL,{getContainer:e.getContainer},{default:()=>[G]})}}});var dte=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const hte=()=>document.body;let vO=0;function fte(){const e={};for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return o.forEach(d=>{d&&Object.keys(d).forEach(y=>{const w=d[y];w!==void 0&&(e[y]=w)})}),e}function Y4(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{getContainer:t=hte,motion:o,prefixCls:c,maxCount:d,getClassName:y,getStyles:w,onAllRemoved:i}=e,O=dte(e,["getContainer","motion","prefixCls","maxCount","getClassName","getStyles","onAllRemoved"]),L=Xt([]),z=Xt(),F=(X,se)=>{const te=X.key||yO(),ne=re(re({},X),{key:te}),ue=L.value.map(ee=>ee.notice.key).indexOf(te),ge=L.value.concat();ue!==-1?ge.splice(ue,1,{notice:ne,holderCallback:se}):(d&&L.value.length>=d&&(ne.key=ge[0].notice.key,ne.updateMark=yO(),ne.userPassKey=te,ge.shift()),ge.push({notice:ne,holderCallback:se})),L.value=ge},N=X=>{L.value=L.value.filter(se=>{let{notice:{key:te,userPassKey:ne}}=se;return(ne||te)!==X})},G=()=>{L.value=[]},Y=()=>le(ute,{ref:z,prefixCls:c,maxCount:d,notices:L.value,remove:N,getClassName:y,getStyles:w,animation:o,hashId:e.hashId,onAllRemoved:i,getContainer:t},null),K=Xt([]),J={open:X=>{const se=fte(O,X);(se.key===null||se.key===void 0)&&(se.key=`vc-notification-${vO}`,vO+=1),K.value=[...K.value,{type:"open",config:se}]},close:X=>{K.value=[...K.value,{type:"close",key:X}]},destroy:()=>{K.value=[...K.value,{type:"destroy"}]}};return On(K,()=>{K.value.length&&(K.value.forEach(X=>{switch(X.type){case"open":F(X.config);break;case"close":N(X.key);break;case"destroy":G();break}}),K.value=[])}),[J,Y]}const pte=e=>{const{componentCls:t,iconCls:o,boxShadowSecondary:c,colorBgElevated:d,colorSuccess:y,colorError:w,colorWarning:i,colorInfo:O,fontSizeLG:L,motionEaseInOutCirc:z,motionDurationSlow:F,marginXS:N,paddingXS:G,borderRadiusLG:Y,zIndexPopup:K,messageNoticeContentPadding:J}=e,X=new xr("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:G,transform:"translateY(0)",opacity:1}}),se=new xr("MessageMoveOut",{"0%":{maxHeight:e.height,padding:G,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}});return[{[t]:re(re({},Ei(e)),{position:"fixed",top:N,left:"50%",transform:"translateX(-50%)",width:"100%",pointerEvents:"none",zIndex:K,[`${t}-move-up`]:{animationFillMode:"forwards"},[`
        ${t}-move-up-appear,
        ${t}-move-up-enter
      `]:{animationName:X,animationDuration:F,animationPlayState:"paused",animationTimingFunction:z},[`
        ${t}-move-up-appear${t}-move-up-appear-active,
        ${t}-move-up-enter${t}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${t}-move-up-leave`]:{animationName:se,animationDuration:F,animationPlayState:"paused",animationTimingFunction:z},[`${t}-move-up-leave${t}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[`${t}-notice`]:{padding:G,textAlign:"center",[o]:{verticalAlign:"text-bottom",marginInlineEnd:N,fontSize:L},[`${t}-notice-content`]:{display:"inline-block",padding:J,background:d,borderRadius:Y,boxShadow:c,pointerEvents:"all"},[`${t}-success ${o}`]:{color:y},[`${t}-error ${o}`]:{color:w},[`${t}-warning ${o}`]:{color:i},[`
        ${t}-info ${o},
        ${t}-loading ${o}`]:{color:O}}},{[`${t}-notice-pure-panel`]:{padding:0,textAlign:"start"}}]},X4=Ui("Message",e=>{const t=Wr(e,{messageNoticeContentPadding:`${(e.controlHeightLG-e.fontSize*e.lineHeight)/2}px ${e.paddingSM}px`});return[pte(t)]},e=>({height:150,zIndexPopup:e.zIndexPopupBase+10})),mte={info:le(Sh,null,null),success:le(zu,null,null),error:le(Ks,null,null),warning:le(Lu,null,null),loading:le(xc,null,null)},gte=cn({name:"PureContent",inheritAttrs:!1,props:["prefixCls","type","icon"],setup(e,t){let{slots:o}=t;return()=>{var c;return le("div",{class:hn(`${e.prefixCls}-custom-content`,`${e.prefixCls}-${e.type}`)},[e.icon||mte[e.type],le("span",null,[(c=o.default)===null||c===void 0?void 0:c.call(o)])])}}});var _te=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const yte=8,vte=3,xte=cn({name:"Holder",inheritAttrs:!1,props:["top","prefixCls","getContainer","maxCount","duration","rtl","transitionName","onAllRemoved","animation","staticGetContainer"],setup(e,t){let{expose:o}=t;var c,d;const{getPrefixCls:y,getPopupContainer:w}=Rr("message",e),i=He(()=>y("message",e.prefixCls)),[,O]=X4(i),L=()=>{var K;const J=(K=e.top)!==null&&K!==void 0?K:yte;return{left:"50%",transform:"translateX(-50%)",top:typeof J=="number"?`${J}px`:J}},z=()=>hn(O.value,e.rtl?`${i.value}-rtl`:""),F=()=>{var K;return k2({prefixCls:i.value,animation:(K=e.animation)!==null&&K!==void 0?K:"move-up",transitionName:e.transitionName})},N=le("span",{class:`${i.value}-close-x`},[le(Ru,{class:`${i.value}-close-icon`},null)]),[G,Y]=Y4({getStyles:L,prefixCls:i.value,getClassName:z,motion:F,closable:!1,closeIcon:N,duration:(c=e.duration)!==null&&c!==void 0?c:vte,getContainer:(d=e.staticGetContainer)!==null&&d!==void 0?d:w.value,maxCount:e.maxCount,onAllRemoved:e.onAllRemoved});return o(re(re({},G),{prefixCls:i,hashId:O})),Y}});let xO=0;function bte(e){const t=Xt(null),o=Symbol("messageHolderKey"),c=O=>{var L;(L=t.value)===null||L===void 0||L.close(O)},d=O=>{if(!t.value){const ue=()=>{};return ue.then=()=>{},ue}const{open:L,prefixCls:z,hashId:F}=t.value,N=`${z}-notice`,{content:G,icon:Y,type:K,key:J,class:X,onClose:se}=O,te=_te(O,["content","icon","type","key","class","onClose"]);let ne=J;return ne==null&&(xO+=1,ne=`antd-message-${xO}`),N6(ue=>(L(re(re({},te),{key:ne,content:()=>le(gte,{prefixCls:z,type:K,icon:typeof Y=="function"?Y():Y},{default:()=>[typeof G=="function"?G():G]}),placement:"top",class:hn(K&&`${N}-${K}`,F,X),onClose:()=>{se==null||se(),ue()}})),()=>{c(ne)}))},w={open:d,destroy:O=>{var L;O!==void 0?c(O):(L=t.value)===null||L===void 0||L.destroy()}};return["info","success","warning","error","loading"].forEach(O=>{const L=(z,F,N)=>{let G;z&&typeof z=="object"&&"content"in z?G=z:G={content:z};let Y,K;typeof F=="function"?K=F:(Y=F,K=N);const J=re(re({onClose:K,duration:Y},G),{type:O});return d(J)};w[O]=L}),[w,()=>le(xte,it(it({key:o},e),{},{ref:t}),null)]}function wte(e){return bte(e)}let K4=3,J4,la,Ste=1,Q4="",e$="move-up",t$=!1,n$=()=>document.body,r$,i$=!1;function Cte(){return Ste++}function Tte(e){e.top!==void 0&&(J4=e.top,la=null),e.duration!==void 0&&(K4=e.duration),e.prefixCls!==void 0&&(Q4=e.prefixCls),e.getContainer!==void 0&&(n$=e.getContainer,la=null),e.transitionName!==void 0&&(e$=e.transitionName,la=null,t$=!0),e.maxCount!==void 0&&(r$=e.maxCount,la=null),e.rtl!==void 0&&(i$=e.rtl)}function Ete(e,t){if(la){t(la);return}Gv.newInstance({appContext:e.appContext,prefixCls:e.prefixCls||Q4,rootPrefixCls:e.rootPrefixCls,transitionName:e$,hasTransitionName:t$,style:{top:J4},getContainer:n$||e.getPopupContainer,maxCount:r$,name:"message",useStyle:X4},o=>{if(la){t(la);return}la=o,t(o)})}const o$={info:Sh,success:zu,error:Ks,warning:Lu,loading:xc},Mte=Object.keys(o$);function Ite(e){const t=e.duration!==void 0?e.duration:K4,o=e.key||Cte(),c=new Promise(y=>{const w=()=>(typeof e.onClose=="function"&&e.onClose(),y(!0));Ete(e,i=>{i.notice({key:o,duration:t,style:e.style||{},class:e.class,content:O=>{let{prefixCls:L}=O;const z=o$[e.type],F=z?le(z,null,null):"",N=hn(`${L}-custom-content`,{[`${L}-${e.type}`]:e.type,[`${L}-rtl`]:i$===!0});return le("div",{class:N},[typeof e.icon=="function"?e.icon():e.icon||F,le("span",null,[typeof e.content=="function"?e.content():e.content])])},onClose:w,onClick:e.onClick})})}),d=()=>{la&&la.removeNotice(o)};return d.then=(y,w)=>c.then(y,w),d.promise=c,d}function Ate(e){return Object.prototype.toString.call(e)==="[object Object]"&&!!e.content}const v_={open:Ite,config:Tte,destroy(e){if(la)if(e){const{removeNotice:t}=la;t(e)}else{const{destroy:t}=la;t(),la=null}}};function Pte(e,t){e[t]=(o,c,d)=>Ate(o)?e.open(re(re({},o),{type:t})):(typeof c=="function"&&(d=c,c=void 0),e.open({content:o,duration:c,type:t,onClose:d}))}Mte.forEach(e=>Pte(v_,e));v_.warn=v_.warning;v_.useMessage=wte;const Ote=e=>{const{componentCls:t,width:o,notificationMarginEdge:c}=e,d=new xr("antNotificationTopFadeIn",{"0%":{marginTop:"-100%",opacity:0},"100%":{marginTop:0,opacity:1}}),y=new xr("antNotificationBottomFadeIn",{"0%":{marginBottom:"-100%",opacity:0},"100%":{marginBottom:0,opacity:1}}),w=new xr("antNotificationLeftFadeIn",{"0%":{right:{_skip_check_:!0,value:o},opacity:0},"100%":{right:{_skip_check_:!0,value:0},opacity:1}});return{[`&${t}-top, &${t}-bottom`]:{marginInline:0},[`&${t}-top`]:{[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:d}},[`&${t}-bottom`]:{[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:y}},[`&${t}-topLeft, &${t}-bottomLeft`]:{marginInlineEnd:0,marginInlineStart:c,[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:w}}}},Dte=e=>{const{iconCls:t,componentCls:o,boxShadowSecondary:c,fontSizeLG:d,notificationMarginBottom:y,borderRadiusLG:w,colorSuccess:i,colorInfo:O,colorWarning:L,colorError:z,colorTextHeading:F,notificationBg:N,notificationPadding:G,notificationMarginEdge:Y,motionDurationMid:K,motionEaseInOut:J,fontSize:X,lineHeight:se,width:te,notificationIconSize:ne}=e,ue=`${o}-notice`,ge=new xr("antNotificationFadeIn",{"0%":{left:{_skip_check_:!0,value:te},opacity:0},"100%":{left:{_skip_check_:!0,value:0},opacity:1}}),ee=new xr("antNotificationFadeOut",{"0%":{maxHeight:e.animationMaxHeight,marginBottom:y,opacity:1},"100%":{maxHeight:0,marginBottom:0,paddingTop:0,paddingBottom:0,opacity:0}});return[{[o]:re(re(re(re({},Ei(e)),{position:"fixed",zIndex:e.zIndexPopup,marginInlineEnd:Y,[`${o}-hook-holder`]:{position:"relative"},[`&${o}-top, &${o}-bottom`]:{[`${o}-notice`]:{marginInline:"auto auto"}},[`&${o}-topLeft, &${o}-bottomLeft`]:{[`${o}-notice`]:{marginInlineEnd:"auto",marginInlineStart:0}},[`${o}-fade-enter, ${o}-fade-appear`]:{animationDuration:e.motionDurationMid,animationTimingFunction:J,animationFillMode:"both",opacity:0,animationPlayState:"paused"},[`${o}-fade-leave`]:{animationTimingFunction:J,animationFillMode:"both",animationDuration:K,animationPlayState:"paused"},[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:ge,animationPlayState:"running"},[`${o}-fade-leave${o}-fade-leave-active`]:{animationName:ee,animationPlayState:"running"}}),Ote(e)),{"&-rtl":{direction:"rtl",[`${o}-notice-btn`]:{float:"left"}}})},{[ue]:{position:"relative",width:te,maxWidth:`calc(100vw - ${Y*2}px)`,marginBottom:y,marginInlineStart:"auto",padding:G,overflow:"hidden",lineHeight:se,wordWrap:"break-word",background:N,borderRadius:w,boxShadow:c,[`${o}-close-icon`]:{fontSize:X,cursor:"pointer"},[`${ue}-message`]:{marginBottom:e.marginXS,color:F,fontSize:d,lineHeight:e.lineHeightLG},[`${ue}-description`]:{fontSize:X},[`&${ue}-closable ${ue}-message`]:{paddingInlineEnd:e.paddingLG},[`${ue}-with-icon ${ue}-message`]:{marginBottom:e.marginXS,marginInlineStart:e.marginSM+ne,fontSize:d},[`${ue}-with-icon ${ue}-description`]:{marginInlineStart:e.marginSM+ne,fontSize:X},[`${ue}-icon`]:{position:"absolute",fontSize:ne,lineHeight:0,[`&-success${t}`]:{color:i},[`&-info${t}`]:{color:O},[`&-warning${t}`]:{color:L},[`&-error${t}`]:{color:z}},[`${ue}-close`]:{position:"absolute",top:e.notificationPaddingVertical,insetInlineEnd:e.notificationPaddingHorizontal,color:e.colorIcon,outline:"none",width:e.notificationCloseButtonSize,height:e.notificationCloseButtonSize,borderRadius:e.borderRadiusSM,transition:`background-color ${e.motionDurationMid}, color ${e.motionDurationMid}`,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{color:e.colorIconHover,backgroundColor:e.wireframe?"transparent":e.colorFillContent}},[`${ue}-btn`]:{float:"right",marginTop:e.marginSM}}},{[`${ue}-pure-panel`]:{margin:0}}]},a$=Ui("Notification",e=>{const t=e.paddingMD,o=e.paddingLG,c=Wr(e,{notificationBg:e.colorBgElevated,notificationPaddingVertical:t,notificationPaddingHorizontal:o,notificationPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`,notificationMarginBottom:e.margin,notificationMarginEdge:e.marginLG,animationMaxHeight:150,notificationIconSize:e.fontSizeLG*e.lineHeightLG,notificationCloseButtonSize:e.controlHeightLG*.55});return[Dte(c)]},e=>({zIndexPopup:e.zIndexPopupBase+50,width:384}));function Rte(e,t){return le("span",{class:`${e}-close-x`},[le(Ru,{class:`${e}-close-icon`},null)])}le(Sh,null,null),le(zu,null,null),le(Ks,null,null),le(Lu,null,null),le(xc,null,null);const zte={success:zu,info:Sh,error:Ks,warning:Lu};function Lte(e){let{prefixCls:t,icon:o,type:c,message:d,description:y,btn:w}=e,i=null;if(o)i=le("span",{class:`${t}-icon`},[Uf(o)]);else if(c){const O=zte[c];i=le(O,{class:`${t}-icon ${t}-icon-${c}`},null)}return le("div",{class:hn({[`${t}-with-icon`]:i}),role:"alert"},[i,le("div",{class:`${t}-message`},[d]),le("div",{class:`${t}-description`},[y]),w&&le("div",{class:`${t}-btn`},[w])])}function s$(e,t,o){let c;switch(t=typeof t=="number"?`${t}px`:t,o=typeof o=="number"?`${o}px`:o,e){case"top":c={left:"50%",transform:"translateX(-50%)",right:"auto",top:t,bottom:"auto"};break;case"topLeft":c={left:0,top:t,bottom:"auto"};break;case"topRight":c={right:0,top:t,bottom:"auto"};break;case"bottom":c={left:"50%",transform:"translateX(-50%)",right:"auto",top:"auto",bottom:o};break;case"bottomLeft":c={left:0,top:"auto",bottom:o};break;default:c={right:0,top:"auto",bottom:o};break}return c}function $te(e){return{name:`${e}-fade`}}var Fte=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const bO=24,Bte=4.5,kte=cn({name:"Holder",inheritAttrs:!1,props:["prefixCls","class","type","icon","content","onAllRemoved"],setup(e,t){let{expose:o}=t;const{getPrefixCls:c,getPopupContainer:d}=Rr("notification",e),y=He(()=>e.prefixCls||c("notification")),w=N=>{var G,Y;return s$(N,(G=e.top)!==null&&G!==void 0?G:bO,(Y=e.bottom)!==null&&Y!==void 0?Y:bO)},[,i]=a$(y),O=()=>hn(i.value,{[`${y.value}-rtl`]:e.rtl}),L=()=>$te(y.value),[z,F]=Y4({prefixCls:y.value,getStyles:w,getClassName:O,motion:L,closable:!0,closeIcon:Rte(y.value),duration:Bte,getContainer:()=>{var N,G;return((N=e.getPopupContainer)===null||N===void 0?void 0:N.call(e))||((G=d.value)===null||G===void 0?void 0:G.call(d))||document.body},maxCount:e.maxCount,hashId:i.value,onAllRemoved:e.onAllRemoved});return o(re(re({},z),{prefixCls:y.value,hashId:i})),F}});function Nte(e){const t=Xt(null),o=Symbol("notificationHolderKey"),c=i=>{if(!t.value)return;const{open:O,prefixCls:L,hashId:z}=t.value,F=`${L}-notice`,{message:N,description:G,icon:Y,type:K,btn:J,class:X}=i,se=Fte(i,["message","description","icon","type","btn","class"]);return O(re(re({placement:"topRight"},se),{content:()=>le(Lte,{prefixCls:F,icon:typeof Y=="function"?Y():Y,type:K,message:typeof N=="function"?N():N,description:typeof G=="function"?G():G,btn:typeof J=="function"?J():J},null),class:hn(K&&`${F}-${K}`,z,X)}))},y={open:c,destroy:i=>{var O,L;i!==void 0?(O=t.value)===null||O===void 0||O.close(i):(L=t.value)===null||L===void 0||L.destroy()}};return["success","info","warning","error"].forEach(i=>{y[i]=O=>c(re(re({},O),{type:i}))}),[y,()=>le(kte,it(it({key:o},e),{},{ref:t}),null)]}function Vte(e){return Nte(e)}const Kd={};let l$=4.5,c$="24px",u$="24px",US="",d$="topRight",h$=()=>document.body,f$=null,HS=!1,p$;function jte(e){const{duration:t,placement:o,bottom:c,top:d,getContainer:y,closeIcon:w,prefixCls:i}=e;i!==void 0&&(US=i),t!==void 0&&(l$=t),o!==void 0&&(d$=o),c!==void 0&&(u$=typeof c=="number"?`${c}px`:c),d!==void 0&&(c$=typeof d=="number"?`${d}px`:d),y!==void 0&&(h$=y),w!==void 0&&(f$=w),e.rtl!==void 0&&(HS=e.rtl),e.maxCount!==void 0&&(p$=e.maxCount)}function Ute(e,t){let{prefixCls:o,placement:c=d$,getContainer:d=h$,top:y,bottom:w,closeIcon:i=f$,appContext:O}=e;const{getPrefixCls:L}=tne(),z=L("notification",o||US),F=`${z}-${c}-${HS}`,N=Kd[F];if(N){Promise.resolve(N).then(Y=>{t(Y)});return}const G=hn(`${z}-${c}`,{[`${z}-rtl`]:HS===!0});Gv.newInstance({name:"notification",prefixCls:o||US,useStyle:a$,class:G,style:s$(c,y??c$,w??u$),appContext:O,getContainer:d,closeIcon:Y=>{let{prefixCls:K}=Y;return le("span",{class:`${K}-close-x`},[Uf(i,{},le(Ru,{class:`${K}-close-icon`},null))])},maxCount:p$,hasTransitionName:!0},Y=>{Kd[F]=Y,t(Y)})}const Hte={success:SC,info:TC,error:EC,warning:CC};function Gte(e){const{icon:t,type:o,description:c,message:d,btn:y}=e,w=e.duration===void 0?l$:e.duration;Ute(e,i=>{i.notice({content:O=>{let{prefixCls:L}=O;const z=`${L}-notice`;let F=null;if(t)F=()=>le("span",{class:`${z}-icon`},[Uf(t)]);else if(o){const N=Hte[o];F=()=>le(N,{class:`${z}-icon ${z}-icon-${o}`},null)}return le("div",{class:F?`${z}-with-icon`:""},[F&&F(),le("div",{class:`${z}-message`},[!c&&F?le("span",{class:`${z}-message-single-line-auto-margin`},null):null,Uf(d)]),le("div",{class:`${z}-description`},[Uf(c)]),y?le("span",{class:`${z}-btn`},[Uf(y)]):null])},duration:w,closable:!0,onClose:e.onClose,onClick:e.onClick,key:e.key,style:e.style||{},class:e.class})})}const hp={open:Gte,close(e){Object.keys(Kd).forEach(t=>Promise.resolve(Kd[t]).then(o=>{o.removeNotice(e)}))},config:jte,destroy(){Object.keys(Kd).forEach(e=>{Promise.resolve(Kd[e]).then(t=>{t.destroy()}),delete Kd[e]})}},Wte=["success","info","warning","error"];Wte.forEach(e=>{hp[e]=t=>hp.open(re(re({},t),{type:e}))});hp.warn=hp.warning;hp.useNotification=Vte;const qte=`-ant-${Date.now()}-${Math.random()}`;function Zte(e,t){const o={},c=(w,i)=>{let O=w.clone();return O=(i==null?void 0:i(O))||O,O.toRgbString()},d=(w,i)=>{const O=new qi(w),L=fh(O.toRgbString());o[`${i}-color`]=c(O),o[`${i}-color-disabled`]=L[1],o[`${i}-color-hover`]=L[4],o[`${i}-color-active`]=L[6],o[`${i}-color-outline`]=O.clone().setAlpha(.2).toRgbString(),o[`${i}-color-deprecated-bg`]=L[0],o[`${i}-color-deprecated-border`]=L[2]};if(t.primaryColor){d(t.primaryColor,"primary");const w=new qi(t.primaryColor),i=fh(w.toRgbString());i.forEach((L,z)=>{o[`primary-${z+1}`]=L}),o["primary-color-deprecated-l-35"]=c(w,L=>L.lighten(35)),o["primary-color-deprecated-l-20"]=c(w,L=>L.lighten(20)),o["primary-color-deprecated-t-20"]=c(w,L=>L.tint(20)),o["primary-color-deprecated-t-50"]=c(w,L=>L.tint(50)),o["primary-color-deprecated-f-12"]=c(w,L=>L.setAlpha(L.getAlpha()*.12));const O=new qi(i[0]);o["primary-color-active-deprecated-f-30"]=c(O,L=>L.setAlpha(L.getAlpha()*.3)),o["primary-color-active-deprecated-d-02"]=c(O,L=>L.darken(2))}return t.successColor&&d(t.successColor,"success"),t.warningColor&&d(t.warningColor,"warning"),t.errorColor&&d(t.errorColor,"error"),t.infoColor&&d(t.infoColor,"info"),`
  :root {
    ${Object.keys(o).map(w=>`--${e}-${w}: ${o[w]};`).join(`
`)}
  }
  `.trim()}function Yte(e,t){const o=Zte(e,t);gs()&&l_(o,`${qte}-dynamic-theme`)}const Xte=e=>{const[t,o]=gp();return tS(He(()=>({theme:t.value,token:o.value,hashId:"",path:["ant-design-icons",e.value]})),()=>[{[`.${e.value}`]:re(re({},fx()),{[`.${e.value} .${e.value}-icon`]:{display:"block"}})}])};function Kte(e,t){const o=He(()=>(e==null?void 0:e.value)||{}),c=He(()=>o.value.inherit===!1||!(t!=null&&t.value)?mz:t.value);return He(()=>{if(!(e!=null&&e.value))return t==null?void 0:t.value;const y=re({},c.value.components);return Object.keys(e.value.components||{}).forEach(w=>{y[w]=re(re({},y[w]),e.value.components[w])}),re(re(re({},c.value),o.value),{token:re(re({},c.value.token),o.value.token),components:y})})}var Jte=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const Qte="ant";function tp(){return zo.prefixCls||Qte}function m$(){return zo.iconPrefixCls||M2}const tT=no({}),zo=no({});Ii(()=>{re(zo,tT),zo.prefixCls=tp(),zo.iconPrefixCls=m$(),zo.getPrefixCls=(e,t)=>t||(e?`${zo.prefixCls}-${e}`:zo.prefixCls),zo.getRootPrefixCls=()=>zo.prefixCls?zo.prefixCls:tp()});let Mw;const ene=e=>{Mw&&Mw(),Mw=Ii(()=>{re(tT,no(e)),re(zo,no(e))}),e.theme&&Yte(tp(),e.theme)},tne=()=>({getPrefixCls:(e,t)=>t||(e?`${tp()}-${e}`:tp()),getIconPrefixCls:m$,getRootPrefixCls:()=>zo.prefixCls?zo.prefixCls:tp()}),sh=cn({compatConfig:{MODE:3},name:"AConfigProvider",inheritAttrs:!1,props:pV(),setup(e,t){let{slots:o}=t;const c=A2(),d=(me,Oe)=>{const{prefixCls:Fe="ant"}=e;if(Oe)return Oe;const Ke=Fe||c.getPrefixCls("");return me?`${Ke}-${me}`:Ke},y=He(()=>e.iconPrefixCls||c.iconPrefixCls.value||M2),w=He(()=>y.value!==c.iconPrefixCls.value),i=He(()=>{var me;return e.csp||((me=c.csp)===null||me===void 0?void 0:me.value)}),O=Xte(y),L=Kte(He(()=>e.theme),He(()=>{var me;return(me=c.theme)===null||me===void 0?void 0:me.value})),z=me=>(e.renderEmpty||o.renderEmpty||c.renderEmpty||oj)(me),F=He(()=>{var me,Oe;return(me=e.autoInsertSpaceInButton)!==null&&me!==void 0?me:(Oe=c.autoInsertSpaceInButton)===null||Oe===void 0?void 0:Oe.value}),N=He(()=>{var me;return e.locale||((me=c.locale)===null||me===void 0?void 0:me.value)});On(N,()=>{tT.locale=N.value},{immediate:!0});const G=He(()=>{var me;return e.direction||((me=c.direction)===null||me===void 0?void 0:me.value)}),Y=He(()=>{var me,Oe;return(me=e.space)!==null&&me!==void 0?me:(Oe=c.space)===null||Oe===void 0?void 0:Oe.value}),K=He(()=>{var me,Oe;return(me=e.virtual)!==null&&me!==void 0?me:(Oe=c.virtual)===null||Oe===void 0?void 0:Oe.value}),J=He(()=>{var me,Oe;return(me=e.dropdownMatchSelectWidth)!==null&&me!==void 0?me:(Oe=c.dropdownMatchSelectWidth)===null||Oe===void 0?void 0:Oe.value}),X=He(()=>{var me;return e.getTargetContainer!==void 0?e.getTargetContainer:(me=c.getTargetContainer)===null||me===void 0?void 0:me.value}),se=He(()=>{var me;return e.getPopupContainer!==void 0?e.getPopupContainer:(me=c.getPopupContainer)===null||me===void 0?void 0:me.value}),te=He(()=>{var me;return e.pageHeader!==void 0?e.pageHeader:(me=c.pageHeader)===null||me===void 0?void 0:me.value}),ne=He(()=>{var me;return e.input!==void 0?e.input:(me=c.input)===null||me===void 0?void 0:me.value}),ue=He(()=>{var me;return e.pagination!==void 0?e.pagination:(me=c.pagination)===null||me===void 0?void 0:me.value}),ge=He(()=>{var me;return e.form!==void 0?e.form:(me=c.form)===null||me===void 0?void 0:me.value}),ee=He(()=>{var me;return e.select!==void 0?e.select:(me=c.select)===null||me===void 0?void 0:me.value}),be=He(()=>e.componentSize),Ie=He(()=>e.componentDisabled),Ee=He(()=>{var me,Oe;return(me=e.wave)!==null&&me!==void 0?me:(Oe=c.wave)===null||Oe===void 0?void 0:Oe.value}),Re={csp:i,autoInsertSpaceInButton:F,locale:N,direction:G,space:Y,virtual:K,dropdownMatchSelectWidth:J,getPrefixCls:d,iconPrefixCls:y,theme:He(()=>{var me,Oe;return(me=L.value)!==null&&me!==void 0?me:(Oe=c.theme)===null||Oe===void 0?void 0:Oe.value}),renderEmpty:z,getTargetContainer:X,getPopupContainer:se,pageHeader:te,input:ne,pagination:ue,form:ge,select:ee,componentSize:be,componentDisabled:Ie,transformCellText:He(()=>e.transformCellText),wave:Ee},Qe=He(()=>{const me=L.value||{},{algorithm:Oe,token:Fe}=me,Ke=Jte(me,["algorithm","token"]),$e=Oe&&(!Array.isArray(Oe)||Oe.length>0)?JR(Oe):void 0;return re(re({},Ke),{theme:$e,token:re(re({},hx),Fe)})}),et=He(()=>{var me,Oe;let Fe={};return N.value&&(Fe=((me=N.value.Form)===null||me===void 0?void 0:me.defaultValidateMessages)||((Oe=Eu.Form)===null||Oe===void 0?void 0:Oe.defaultValidateMessages)||{}),e.form&&e.form.validateMessages&&(Fe=re(re({},Fe),e.form.validateMessages)),Fe});mV(Re),hV({validateMessages:et}),xz(be),kR(Ie);const We=me=>{var Oe,Fe;let Ke=w.value?O((Oe=o.default)===null||Oe===void 0?void 0:Oe.call(o)):(Fe=o.default)===null||Fe===void 0?void 0:Fe.call(o);if(e.theme){const $e=function(){return Ke}();Ke=le(ej,{value:Qe.value},{default:()=>[$e]})}return le(ate,{locale:N.value||me,ANT_MARK__:jS},{default:()=>[Ke]})};return Ii(()=>{G.value&&(v_.config({rtl:G.value==="rtl"}),hp.config({rtl:G.value==="rtl"}))}),()=>le(VR,{children:(me,Oe,Fe)=>We(Fe)},null)}});sh.config=ene;sh.install=function(e){e.component(sh.name,sh)};const Ny=(e,t,o)=>{const c=$6(o);return{[`${e.componentCls}-${t}`]:{color:e[`color${o}`],background:e[`color${c}Bg`],borderColor:e[`color${c}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},nne=e=>Dv(e,(t,o)=>{let{textColor:c,lightBorderColor:d,lightColor:y,darkColor:w}=o;return{[`${e.componentCls}-${t}`]:{color:c,background:y,borderColor:d,"&-inverse":{color:e.colorTextLightSolid,background:w,borderColor:w},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),rne=e=>{const{paddingXXS:t,lineWidth:o,tagPaddingHorizontal:c,componentCls:d}=e,y=c-o,w=t-o;return{[d]:re(re({},Ei(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:y,fontSize:e.tagFontSize,lineHeight:`${e.tagLineHeight}px`,whiteSpace:"nowrap",background:e.tagDefaultBg,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",[`&${d}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.tagDefaultColor},[`${d}-close-icon`]:{marginInlineStart:w,color:e.colorTextDescription,fontSize:e.tagIconSize,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${d}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${d}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:y}}),[`${d}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},g$=Ui("Tag",e=>{const{fontSize:t,lineHeight:o,lineWidth:c,fontSizeIcon:d}=e,y=Math.round(t*o),w=e.fontSizeSM,i=y-c*2,O=e.colorFillAlter,L=e.colorText,z=Wr(e,{tagFontSize:w,tagLineHeight:i,tagDefaultBg:O,tagDefaultColor:L,tagIconSize:d-2*c,tagPaddingHorizontal:8,tagBorderlessBg:e.colorFillTertiary});return[rne(z),nne(z),Ny(z,"success","Success"),Ny(z,"processing","Info"),Ny(z,"error","Error"),Ny(z,"warning","Warning")]}),ine=()=>({prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}),GS=cn({compatConfig:{MODE:3},name:"ACheckableTag",inheritAttrs:!1,props:ine(),setup(e,t){let{slots:o,emit:c,attrs:d}=t;const{prefixCls:y}=Rr("tag",e),[w,i]=g$(y),O=z=>{const{checked:F}=e;c("update:checked",!F),c("change",!F),c("click",z)},L=He(()=>hn(y.value,i.value,{[`${y.value}-checkable`]:!0,[`${y.value}-checkable-checked`]:e.checked}));return()=>{var z;return w(le("span",it(it({},d),{},{class:[L.value,d.class],onClick:O}),[(z=o.default)===null||z===void 0?void 0:z.call(o)]))}}}),one=()=>({prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:wt.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},onClick:a_(),"onUpdate:visible":Function,icon:wt.any,bordered:{type:Boolean,default:!0}}),Xg=cn({compatConfig:{MODE:3},name:"ATag",inheritAttrs:!1,props:one(),slots:Object,setup(e,t){let{slots:o,emit:c,attrs:d}=t;const{prefixCls:y,direction:w}=Rr("tag",e),[i,O]=g$(y),L=Xt(!0);Ii(()=>{e.visible!==void 0&&(L.value=e.visible)});const z=Y=>{Y.stopPropagation(),c("update:visible",!1),c("close",Y),!Y.defaultPrevented&&e.visible===void 0&&(L.value=!1)},F=He(()=>Dx(e.color)||IX(e.color)),N=He(()=>hn(y.value,O.value,{[`${y.value}-${e.color}`]:F.value,[`${y.value}-has-color`]:e.color&&!F.value,[`${y.value}-hidden`]:!L.value,[`${y.value}-rtl`]:w.value==="rtl",[`${y.value}-borderless`]:!e.bordered})),G=Y=>{c("click",Y)};return()=>{var Y,K,J;const{icon:X=(Y=o.icon)===null||Y===void 0?void 0:Y.call(o),color:se,closeIcon:te=(K=o.closeIcon)===null||K===void 0?void 0:K.call(o),closable:ne=!1}=e,ue=()=>ne?te?le("span",{class:`${y.value}-close-icon`,onClick:z},[te]):le(Ru,{class:`${y.value}-close-icon`,onClick:z},null):null,ge={backgroundColor:se&&!F.value?se:void 0},ee=X||null,be=(J=o.default)===null||J===void 0?void 0:J.call(o),Ie=ee?le(hr,null,[ee,le("span",null,[be])]):be,Ee=e.onClick!==void 0,Re=le("span",it(it({},d),{},{onClick:G,class:[N.value,d.class],style:[ge,d.style]}),[Ie,ue()]);return i(Ee?le(a4,null,{default:()=>[Re]}):Re)}}});Xg.CheckableTag=GS;Xg.install=function(e){return e.component(Xg.name,Xg),e.component(GS.name,GS),e};function Vy(e){return e!=null}const Iw=e=>{const{itemPrefixCls:t,component:o,span:c,labelStyle:d,contentStyle:y,bordered:w,label:i,content:O,colon:L}=e,z=o;return w?le(z,{class:[{[`${t}-item-label`]:Vy(i),[`${t}-item-content`]:Vy(O)}],colSpan:c},{default:()=>[Vy(i)&&le("span",{style:d},[i]),Vy(O)&&le("span",{style:y},[O])]}):le(z,{class:[`${t}-item`],colSpan:c},{default:()=>[le("div",{class:`${t}-item-container`},[(i||i===0)&&le("span",{class:[`${t}-item-label`,{[`${t}-item-no-colon`]:!L}],style:d},[i]),(O||O===0)&&le("span",{class:`${t}-item-content`,style:y},[O])])]})},ane=e=>{const t=(L,z,F)=>{let{colon:N,prefixCls:G,bordered:Y}=z,{component:K,type:J,showLabel:X,showContent:se,labelStyle:te,contentStyle:ne}=F;return L.map((ue,ge)=>{var ee,be;const Ie=ue.props||{},{prefixCls:Ee=G,span:Re=1,labelStyle:Qe=Ie["label-style"],contentStyle:et=Ie["content-style"],label:We=(be=(ee=ue.children)===null||ee===void 0?void 0:ee.label)===null||be===void 0?void 0:be.call(ee)}=Ie,me=C2(ue),Oe=uV(ue),Fe=OR(ue),{key:Ke}=ue;return typeof K=="string"?le(Iw,{key:`${J}-${String(Ke)||ge}`,class:Oe,style:Fe,labelStyle:re(re({},te),Qe),contentStyle:re(re({},ne),et),span:Re,colon:N,component:K,itemPrefixCls:Ee,bordered:Y,label:X?We:null,content:se?me:null},null):[le(Iw,{key:`label-${String(Ke)||ge}`,class:Oe,style:re(re(re({},te),Fe),Qe),span:1,colon:N,component:K[0],itemPrefixCls:Ee,bordered:Y,label:We},null),le(Iw,{key:`content-${String(Ke)||ge}`,class:Oe,style:re(re(re({},ne),Fe),et),span:Re*2-1,component:K[1],itemPrefixCls:Ee,bordered:Y,content:me},null)]})},{prefixCls:o,vertical:c,row:d,index:y,bordered:w}=e,{labelStyle:i,contentStyle:O}=Zr(v$,{labelStyle:tn({}),contentStyle:tn({})});return c?le(hr,null,[le("tr",{key:`label-${y}`,class:`${o}-row`},[t(d,e,{component:"th",type:"label",showLabel:!0,labelStyle:i.value,contentStyle:O.value})]),le("tr",{key:`content-${y}`,class:`${o}-row`},[t(d,e,{component:"td",type:"content",showContent:!0,labelStyle:i.value,contentStyle:O.value})])]):le("tr",{key:y,class:`${o}-row`},[t(d,e,{component:w?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0,labelStyle:i.value,contentStyle:O.value})])},sne=e=>{const{componentCls:t,descriptionsSmallPadding:o,descriptionsDefaultPadding:c,descriptionsMiddlePadding:d,descriptionsBg:y}=e;return{[`&${t}-bordered`]:{[`${t}-view`]:{border:`${e.lineWidth}px ${e.lineType} ${e.colorSplit}`,"> table":{tableLayout:"auto",borderCollapse:"collapse"}},[`${t}-item-label, ${t}-item-content`]:{padding:c,borderInlineEnd:`${e.lineWidth}px ${e.lineType} ${e.colorSplit}`,"&:last-child":{borderInlineEnd:"none"}},[`${t}-item-label`]:{backgroundColor:y,"&::after":{display:"none"}},[`${t}-row`]:{borderBottom:`${e.lineWidth}px ${e.lineType} ${e.colorSplit}`,"&:last-child":{borderBottom:"none"}},[`&${t}-middle`]:{[`${t}-item-label, ${t}-item-content`]:{padding:d}},[`&${t}-small`]:{[`${t}-item-label, ${t}-item-content`]:{padding:o}}}}},lne=e=>{const{componentCls:t,descriptionsExtraColor:o,descriptionItemPaddingBottom:c,descriptionsItemLabelColonMarginRight:d,descriptionsItemLabelColonMarginLeft:y,descriptionsTitleMarginBottom:w}=e;return{[t]:re(re(re({},Ei(e)),sne(e)),{"&-rtl":{direction:"rtl"},[`${t}-header`]:{display:"flex",alignItems:"center",marginBottom:w},[`${t}-title`]:re(re({},Rv),{flex:"auto",color:e.colorText,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG}),[`${t}-extra`]:{marginInlineStart:"auto",color:o,fontSize:e.fontSize},[`${t}-view`]:{width:"100%",borderRadius:e.borderRadiusLG,table:{width:"100%",tableLayout:"fixed"}},[`${t}-row`]:{"> th, > td":{paddingBottom:c},"&:last-child":{borderBottom:"none"}},[`${t}-item-label`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"start","&::after":{content:'":"',position:"relative",top:-.5,marginInline:`${y}px ${d}px`},[`&${t}-item-no-colon::after`]:{content:'""'}},[`${t}-item-no-label`]:{"&::after":{margin:0,content:'""'}},[`${t}-item-content`]:{display:"table-cell",flex:1,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,wordBreak:"break-word",overflowWrap:"break-word"},[`${t}-item`]:{paddingBottom:0,verticalAlign:"top","&-container":{display:"flex",[`${t}-item-label`]:{display:"inline-flex",alignItems:"baseline"},[`${t}-item-content`]:{display:"inline-flex",alignItems:"baseline"}}},"&-middle":{[`${t}-row`]:{"> th, > td":{paddingBottom:e.paddingSM}}},"&-small":{[`${t}-row`]:{"> th, > td":{paddingBottom:e.paddingXS}}}})}},cne=Ui("Descriptions",e=>{const t=e.colorFillAlter,o=e.fontSizeSM*e.lineHeightSM,c=e.colorText,d=`${e.paddingXS}px ${e.padding}px`,y=`${e.padding}px ${e.paddingLG}px`,w=`${e.paddingSM}px ${e.paddingLG}px`,i=e.padding,O=e.marginXS,L=e.marginXXS/2,z=Wr(e,{descriptionsBg:t,descriptionsTitleMarginBottom:o,descriptionsExtraColor:c,descriptionItemPaddingBottom:i,descriptionsSmallPadding:d,descriptionsDefaultPadding:y,descriptionsMiddlePadding:w,descriptionsItemLabelColonMarginRight:O,descriptionsItemLabelColonMarginLeft:L});return[lne(z)]});wt.any;const une=()=>({prefixCls:String,label:wt.any,labelStyle:{type:Object,default:void 0},contentStyle:{type:Object,default:void 0},span:{type:Number,default:1}}),_$=cn({compatConfig:{MODE:3},name:"ADescriptionsItem",props:une(),setup(e,t){let{slots:o}=t;return()=>{var c;return(c=o.default)===null||c===void 0?void 0:c.call(o)}}}),y$={xxxl:3,xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function dne(e,t){if(typeof e=="number")return e;if(typeof e=="object")for(let o=0;o<Gf.length;o++){const c=Gf[o];if(t[c]&&e[c]!==void 0)return e[c]||y$[c]}return 3}function wO(e,t,o){let c=e;return(o===void 0||o>t)&&(c=xo(e,{span:t})),c}function hne(e,t){const o=vo(e),c=[];let d=[],y=t;return o.forEach((w,i)=>{var O;const L=(O=w.props)===null||O===void 0?void 0:O.span,z=L||1;if(i===o.length-1){d.push(wO(w,y,L)),c.push(d);return}z<y?(y-=z,d.push(w)):(d.push(wO(w,y,z)),c.push(d),y=t,d=[])}),c}const fne=()=>({prefixCls:String,bordered:{type:Boolean,default:void 0},size:{type:String,default:"default"},title:wt.any,extra:wt.any,column:{type:[Number,Object],default:()=>y$},layout:String,colon:{type:Boolean,default:void 0},labelStyle:{type:Object,default:void 0},contentStyle:{type:Object,default:void 0}}),v$=Symbol("descriptionsContext"),jf=cn({compatConfig:{MODE:3},name:"ADescriptions",inheritAttrs:!1,props:fne(),slots:Object,Item:_$,setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d,direction:y}=Rr("descriptions",e);let w;const i=tn({}),[O,L]=cne(d),z=JL();g2(()=>{w=z.value.subscribe(N=>{typeof e.column=="object"&&(i.value=N)})}),fi(()=>{z.value.unsubscribe(w)}),li(v$,{labelStyle:ra(e,"labelStyle"),contentStyle:ra(e,"contentStyle")});const F=He(()=>dne(e.column,i.value));return()=>{var N,G,Y;const{size:K,bordered:J=!1,layout:X="horizontal",colon:se=!0,title:te=(N=o.title)===null||N===void 0?void 0:N.call(o),extra:ne=(G=o.extra)===null||G===void 0?void 0:G.call(o)}=e,ue=(Y=o.default)===null||Y===void 0?void 0:Y.call(o),ge=hne(ue,F.value);return O(le("div",it(it({},c),{},{class:[d.value,{[`${d.value}-${K}`]:K!=="default",[`${d.value}-bordered`]:!!J,[`${d.value}-rtl`]:y.value==="rtl"},c.class,L.value]}),[(te||ne)&&le("div",{class:`${d.value}-header`},[te&&le("div",{class:`${d.value}-title`},[te]),ne&&le("div",{class:`${d.value}-extra`},[ne])]),le("div",{class:`${d.value}-view`},[le("table",null,[le("tbody",null,[ge.map((ee,be)=>le(ane,{key:be,index:be,colon:se,prefixCls:d.value,vertical:X==="vertical",bordered:J,row:ee},null))])])])]))}}});jf.install=function(e){return e.component(jf.name,jf),e.component(jf.Item.name,jf.Item),e};const pne=e=>{const{componentCls:t,sizePaddingEdgeHorizontal:o,colorSplit:c,lineWidth:d}=e;return{[t]:re(re({},Ei(e)),{borderBlockStart:`${d}px solid ${c}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",margin:`0 ${e.dividerVerticalGutterMargin}px`,verticalAlign:"middle",borderTop:0,borderInlineStart:`${d}px solid ${c}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${e.dividerHorizontalGutterMargin}px 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${e.dividerHorizontalWithTextGutterMargin}px 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${c}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${d}px solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-left`]:{"&::before":{width:"5%"},"&::after":{width:"95%"}},[`&-horizontal${t}-with-text-right`]:{"&::before":{width:"95%"},"&::after":{width:"5%"}},[`${t}-inner-text`]:{display:"inline-block",padding:"0 1em"},"&-dashed":{background:"none",borderColor:c,borderStyle:"dashed",borderWidth:`${d}px 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:d,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-left${t}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:o}},[`&-horizontal${t}-with-text-right${t}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:o}}})}},mne=Ui("Divider",e=>{const t=Wr(e,{dividerVerticalGutterMargin:e.marginXS,dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG});return[pne(t)]},{sizePaddingEdgeHorizontal:0}),gne=()=>({prefixCls:String,type:{type:String,default:"horizontal"},dashed:{type:Boolean,default:!1},orientation:{type:String,default:"center"},plain:{type:Boolean,default:!1},orientationMargin:[String,Number]}),_ne=cn({name:"ADivider",inheritAttrs:!1,compatConfig:{MODE:3},props:gne(),setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d,direction:y}=Rr("divider",e),[w,i]=mne(d),O=He(()=>e.orientation==="left"&&e.orientationMargin!=null),L=He(()=>e.orientation==="right"&&e.orientationMargin!=null),z=He(()=>{const{type:G,dashed:Y,plain:K}=e,J=d.value;return{[J]:!0,[i.value]:!!i.value,[`${J}-${G}`]:!0,[`${J}-dashed`]:!!Y,[`${J}-plain`]:!!K,[`${J}-rtl`]:y.value==="rtl",[`${J}-no-default-orientation-margin-left`]:O.value,[`${J}-no-default-orientation-margin-right`]:L.value}}),F=He(()=>{const G=typeof e.orientationMargin=="number"?`${e.orientationMargin}px`:e.orientationMargin;return re(re({},O.value&&{marginLeft:G}),L.value&&{marginRight:G})}),N=He(()=>e.orientation.length>0?"-"+e.orientation:e.orientation);return()=>{var G;const Y=vo((G=o.default)===null||G===void 0?void 0:G.call(o));return w(le("div",it(it({},c),{},{class:[z.value,Y.length?`${d.value}-with-text ${d.value}-with-text${N.value}`:"",c.class],role:"separator"}),[Y.length?le("span",{class:`${d.value}-inner-text`,style:F.value},[Y]):null]))}}}),yne=Pl(_ne),Kg=e=>e!=null&&(Array.isArray(e)?ms(e).length:!0);function nT(e){return Kg(e.prefix)||Kg(e.suffix)||Kg(e.allowClear)}function mv(e){return Kg(e.addonBefore)||Kg(e.addonAfter)}function WS(e){return typeof e>"u"||e===null?"":String(e)}function Jg(e,t,o,c){if(!o)return;const d=t;if(t.type==="click"){Object.defineProperty(d,"target",{writable:!0}),Object.defineProperty(d,"currentTarget",{writable:!0});const y=e.cloneNode(!0);d.target=y,d.currentTarget=y,y.value="",o(d);return}if(c!==void 0){Object.defineProperty(d,"target",{writable:!0}),Object.defineProperty(d,"currentTarget",{writable:!0}),d.target=e,d.currentTarget=e,e.value=c,o(d);return}o(d)}function x$(e,t){if(!e)return;e.focus(t);const{cursor:o}=t||{};if(o){const c=e.value.length;switch(o){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(c,c);break;default:e.setSelectionRange(0,c)}}}const vne=()=>({addonBefore:wt.any,addonAfter:wt.any,prefix:wt.any,suffix:wt.any,clearIcon:wt.any,affixWrapperClassName:String,groupClassName:String,wrapperClassName:String,inputClassName:String,allowClear:{type:Boolean,default:void 0}}),b$=()=>re(re({},vne()),{value:{type:[String,Number,Symbol],default:void 0},defaultValue:{type:[String,Number,Symbol],default:void 0},inputElement:wt.any,prefixCls:String,disabled:{type:Boolean,default:void 0},focused:{type:Boolean,default:void 0},triggerFocus:Function,readonly:{type:Boolean,default:void 0},handleReset:Function,hidden:{type:Boolean,default:void 0}}),w$=()=>re(re({},b$()),{id:String,placeholder:{type:[String,Number]},autocomplete:String,type:Io("text"),name:String,size:{type:String},autofocus:{type:Boolean,default:void 0},lazy:{type:Boolean,default:!0},maxlength:Number,loading:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},showCount:{type:[Boolean,Object]},htmlSize:Number,onPressEnter:Function,onKeydown:Function,onKeyup:Function,onFocus:Function,onBlur:Function,onChange:Function,onInput:Function,"onUpdate:value":Function,onCompositionstart:Function,onCompositionend:Function,valueModifiers:Object,hidden:{type:Boolean,default:void 0},status:String}),xne=cn({name:"BaseInput",inheritAttrs:!1,props:b$(),setup(e,t){let{slots:o,attrs:c}=t;const d=tn(),y=i=>{var O;if(!((O=d.value)===null||O===void 0)&&O.contains(i.target)){const{triggerFocus:L}=e;L==null||L()}},w=()=>{var i;const{allowClear:O,value:L,disabled:z,readonly:F,handleReset:N,suffix:G=o.suffix,prefixCls:Y}=e;if(!O)return null;const K=!z&&!F&&L,J=`${Y}-clear-icon`,X=((i=o.clearIcon)===null||i===void 0?void 0:i.call(o))||"*";return le("span",{onClick:N,onMousedown:se=>se.preventDefault(),class:hn({[`${J}-hidden`]:!K,[`${J}-has-suffix`]:!!G},J),role:"button",tabindex:-1},[X])};return()=>{var i,O;const{focused:L,value:z,disabled:F,allowClear:N,readonly:G,hidden:Y,prefixCls:K,prefix:J=(i=o.prefix)===null||i===void 0?void 0:i.call(o),suffix:X=(O=o.suffix)===null||O===void 0?void 0:O.call(o),addonAfter:se=o.addonAfter,addonBefore:te=o.addonBefore,inputElement:ne,affixWrapperClassName:ue,wrapperClassName:ge,groupClassName:ee}=e;let be=xo(ne,{value:z,hidden:Y});if(nT({prefix:J,suffix:X,allowClear:N})){const Ie=`${K}-affix-wrapper`,Ee=hn(Ie,{[`${Ie}-disabled`]:F,[`${Ie}-focused`]:L,[`${Ie}-readonly`]:G,[`${Ie}-input-with-clear-btn`]:X&&N&&z},!mv({addonAfter:se,addonBefore:te})&&c.class,ue),Re=(X||N)&&le("span",{class:`${K}-suffix`},[w(),X]);be=le("span",{class:Ee,style:c.style,hidden:!mv({addonAfter:se,addonBefore:te})&&Y,onMousedown:y,ref:d},[J&&le("span",{class:`${K}-prefix`},[J]),xo(ne,{style:null,value:z,hidden:null}),Re])}if(mv({addonAfter:se,addonBefore:te})){const Ie=`${K}-group`,Ee=`${Ie}-addon`,Re=hn(`${K}-wrapper`,Ie,ge),Qe=hn(`${K}-group-wrapper`,c.class,ee);return le("span",{class:Qe,style:c.style,hidden:Y},[le("span",{class:Re},[te&&le("span",{class:Ee},[te]),xo(be,{style:null,hidden:null}),se&&le("span",{class:Ee},[se])])])}return be}}});var bne=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const wne=cn({name:"VCInput",inheritAttrs:!1,props:w$(),setup(e,t){let{slots:o,attrs:c,expose:d,emit:y}=t;const w=Xt(e.value===void 0?e.defaultValue:e.value),i=Xt(!1),O=Xt(),L=Xt();On(()=>e.value,()=>{w.value=e.value}),On(()=>e.disabled,()=>{e.disabled&&(i.value=!1)});const z=ee=>{O.value&&x$(O.value.input,ee)},F=()=>{var ee;(ee=O.value.input)===null||ee===void 0||ee.blur()},N=(ee,be,Ie)=>{var Ee;(Ee=O.value.input)===null||Ee===void 0||Ee.setSelectionRange(ee,be,Ie)},G=()=>{var ee;(ee=O.value.input)===null||ee===void 0||ee.select()};d({focus:z,blur:F,input:He(()=>{var ee;return(ee=O.value.input)===null||ee===void 0?void 0:ee.input}),stateValue:w,setSelectionRange:N,select:G});const Y=ee=>{y("change",ee)},K=(ee,be)=>{w.value!==ee&&(e.value===void 0?w.value=ee:si(()=>{var Ie;O.value.input.value!==w.value&&((Ie=L.value)===null||Ie===void 0||Ie.$forceUpdate())}),si(()=>{be&&be()}))},J=ee=>{const{value:be}=ee.target;if(w.value===be)return;const Ie=ee.target.value;Jg(O.value.input,ee,Y),K(Ie)},X=ee=>{ee.keyCode===13&&y("pressEnter",ee),y("keydown",ee)},se=ee=>{i.value=!0,y("focus",ee)},te=ee=>{i.value=!1,y("blur",ee)},ne=ee=>{Jg(O.value.input,ee,Y),K("",()=>{z()})},ue=()=>{var ee,be;const{addonBefore:Ie=o.addonBefore,addonAfter:Ee=o.addonAfter,disabled:Re,valueModifiers:Qe={},htmlSize:et,autocomplete:We,prefixCls:me,inputClassName:Oe,prefix:Fe=(ee=o.prefix)===null||ee===void 0?void 0:ee.call(o),suffix:Ke=(be=o.suffix)===null||be===void 0?void 0:be.call(o),allowClear:$e,type:pt="text"}=e,Ct=co(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","size","bordered","htmlSize","lazy","showCount","valueModifiers","showCount","affixWrapperClassName","groupClassName","inputClassName","wrapperClassName"]),Lt=re(re(re({},Ct),c),{autocomplete:We,onChange:J,onInput:J,onFocus:se,onBlur:te,onKeydown:X,class:hn(me,{[`${me}-disabled`]:Re},Oe,!mv({addonAfter:Ee,addonBefore:Ie})&&!nT({prefix:Fe,suffix:Ke,allowClear:$e})&&c.class),ref:O,key:"ant-input",size:et,type:pt,lazy:e.lazy});return Qe.lazy&&delete Lt.onInput,Lt.autofocus||delete Lt.autofocus,le(tC,co(Lt,["size"]),null)},ge=()=>{var ee;const{maxlength:be,suffix:Ie=(ee=o.suffix)===null||ee===void 0?void 0:ee.call(o),showCount:Ee,prefixCls:Re}=e,Qe=Number(be)>0;if(Ie||Ee){const et=[...WS(w.value)].length,We=typeof Ee=="object"?Ee.formatter({count:et,maxlength:be}):`${et}${Qe?` / ${be}`:""}`;return le(hr,null,[!!Ee&&le("span",{class:hn(`${Re}-show-count-suffix`,{[`${Re}-show-count-has-suffix`]:!!Ie})},[We]),Ie])}return null};return Qr(()=>{}),()=>{const{prefixCls:ee,disabled:be}=e,Ie=bne(e,["prefixCls","disabled"]);return le(xne,it(it(it({},Ie),c),{},{ref:L,prefixCls:ee,inputElement:ue(),handleReset:ne,value:WS(w.value),focused:i.value,triggerFocus:z,suffix:ge(),disabled:be}),o)}}}),Bx=()=>co(w$(),["wrapperClassName","groupClassName","inputClassName","affixWrapperClassName"]),S$=()=>re(re({},co(Bx(),["prefix","addonBefore","addonAfter","suffix"])),{rows:Number,autosize:{type:[Boolean,Object],default:void 0},autoSize:{type:[Boolean,Object],default:void 0},onResize:{type:Function},onCompositionstart:a_(),onCompositionend:a_(),valueModifiers:Object});var Sne=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const yo=cn({compatConfig:{MODE:3},name:"AInput",inheritAttrs:!1,props:Bx(),setup(e,t){let{slots:o,attrs:c,expose:d,emit:y}=t;const w=tn(),i=Ic(),O=xs.useInject(),L=He(()=>Mx(O.status,e.status)),{direction:z,prefixCls:F,size:N,autocomplete:G}=Rr("input",e),{compactSize:Y,compactItemClassnames:K}=vC(F,z),J=He(()=>Y.value||N.value),[X,se]=YC(F),te=yc();d({focus:et=>{var We;(We=w.value)===null||We===void 0||We.focus(et)},blur:()=>{var et;(et=w.value)===null||et===void 0||et.blur()},input:w,setSelectionRange:(et,We,me)=>{var Oe;(Oe=w.value)===null||Oe===void 0||Oe.setSelectionRange(et,We,me)},select:()=>{var et;(et=w.value)===null||et===void 0||et.select()}});const be=tn([]),Ie=()=>{be.value.push(setTimeout(()=>{var et,We,me,Oe;!((et=w.value)===null||et===void 0)&&et.input&&((We=w.value)===null||We===void 0?void 0:We.input.getAttribute("type"))==="password"&&(!((me=w.value)===null||me===void 0)&&me.input.hasAttribute("value"))&&((Oe=w.value)===null||Oe===void 0||Oe.input.removeAttribute("value"))}))};Qr(()=>{Ie()}),_2(()=>{be.value.forEach(et=>clearTimeout(et))}),fi(()=>{be.value.forEach(et=>clearTimeout(et))});const Ee=et=>{Ie(),y("blur",et),i.onFieldBlur()},Re=et=>{Ie(),y("focus",et)},Qe=et=>{y("update:value",et.target.value),y("change",et),y("input",et),i.onFieldChange()};return()=>{var et,We,me,Oe,Fe,Ke;const{hasFeedback:$e,feedbackIcon:pt}=O,{allowClear:Ct,bordered:Lt=!0,prefix:It=(et=o.prefix)===null||et===void 0?void 0:et.call(o),suffix:_n=(We=o.suffix)===null||We===void 0?void 0:We.call(o),addonAfter:Ut=(me=o.addonAfter)===null||me===void 0?void 0:me.call(o),addonBefore:ln=(Oe=o.addonBefore)===null||Oe===void 0?void 0:Oe.call(o),id:xn=(Fe=i.id)===null||Fe===void 0?void 0:Fe.value}=e,En=Sne(e,["allowClear","bordered","prefix","suffix","addonAfter","addonBefore","id"]),Nt=($e||_n)&&le(hr,null,[_n,$e&&pt]),_e=F.value,Ft=nT({prefix:It,suffix:_n})||!!$e,Ve=o.clearIcon||(()=>le(Ks,null,null));return X(le(wne,it(it(it({},c),co(En,["onUpdate:value","onChange","onInput"])),{},{onChange:Qe,id:xn,disabled:(Ke=e.disabled)!==null&&Ke!==void 0?Ke:te.value,ref:w,prefixCls:_e,autocomplete:G.value,onBlur:Ee,onFocus:Re,prefix:It,suffix:Nt,allowClear:Ct,addonAfter:Ut&&le(f3,null,{default:()=>[le(JP,null,{default:()=>[Ut]})]}),addonBefore:ln&&le(f3,null,{default:()=>[le(JP,null,{default:()=>[ln]})]}),class:[c.class,K.value],inputClassName:hn({[`${_e}-sm`]:J.value==="small",[`${_e}-lg`]:J.value==="large",[`${_e}-rtl`]:z.value==="rtl",[`${_e}-borderless`]:!Lt},!Ft&&Qf(_e,L.value),se.value),affixWrapperClassName:hn({[`${_e}-affix-wrapper-sm`]:J.value==="small",[`${_e}-affix-wrapper-lg`]:J.value==="large",[`${_e}-affix-wrapper-rtl`]:z.value==="rtl",[`${_e}-affix-wrapper-borderless`]:!Lt},Qf(`${_e}-affix-wrapper`,L.value,$e),se.value),wrapperClassName:hn({[`${_e}-group-rtl`]:z.value==="rtl"},se.value),groupClassName:hn({[`${_e}-group-wrapper-sm`]:J.value==="small",[`${_e}-group-wrapper-lg`]:J.value==="large",[`${_e}-group-wrapper-rtl`]:z.value==="rtl"},Qf(`${_e}-group-wrapper`,L.value,$e),se.value)}),re(re({},o),{clearIcon:Ve})))}}}),Cne=cn({compatConfig:{MODE:3},name:"AInputGroup",inheritAttrs:!1,props:{prefixCls:String,size:{type:String},compact:{type:Boolean,default:void 0}},setup(e,t){let{slots:o,attrs:c}=t;const{prefixCls:d,direction:y,getPrefixCls:w}=Rr("input-group",e),i=xs.useInject();xs.useProvide(i,{isFormItemInput:!1});const O=He(()=>w("input")),[L,z]=YC(O),F=He(()=>{const N=d.value;return{[`${N}`]:!0,[z.value]:!0,[`${N}-lg`]:e.size==="large",[`${N}-sm`]:e.size==="small",[`${N}-compact`]:e.compact,[`${N}-rtl`]:y.value==="rtl"}});return()=>{var N;return L(le("span",it(it({},c),{},{class:hn(F.value,c.class)}),[(N=o.default)===null||N===void 0?void 0:N.call(o)]))}}});var Tne=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const Ene=cn({compatConfig:{MODE:3},name:"AInputSearch",inheritAttrs:!1,props:re(re({},Bx()),{inputPrefixCls:String,enterButton:wt.any,onSearch:{type:Function}}),setup(e,t){let{slots:o,attrs:c,expose:d,emit:y}=t;const w=Xt(),i=Xt(!1);d({focus:()=>{var ue;(ue=w.value)===null||ue===void 0||ue.focus()},blur:()=>{var ue;(ue=w.value)===null||ue===void 0||ue.blur()}});const z=ue=>{y("update:value",ue.target.value),ue&&ue.target&&ue.type==="click"&&y("search",ue.target.value,ue),y("change",ue)},F=ue=>{var ge;document.activeElement===((ge=w.value)===null||ge===void 0?void 0:ge.input)&&ue.preventDefault()},N=ue=>{var ge,ee;y("search",(ee=(ge=w.value)===null||ge===void 0?void 0:ge.input)===null||ee===void 0?void 0:ee.stateValue,ue)},G=ue=>{i.value||e.loading||N(ue)},Y=ue=>{i.value=!0,y("compositionstart",ue)},K=ue=>{i.value=!1,y("compositionend",ue)},{prefixCls:J,getPrefixCls:X,direction:se,size:te}=Rr("input-search",e),ne=He(()=>X("input",e.inputPrefixCls));return()=>{var ue,ge,ee,be;const{disabled:Ie,loading:Ee,addonAfter:Re=(ue=o.addonAfter)===null||ue===void 0?void 0:ue.call(o),suffix:Qe=(ge=o.suffix)===null||ge===void 0?void 0:ge.call(o)}=e,et=Tne(e,["disabled","loading","addonAfter","suffix"]);let{enterButton:We=(be=(ee=o.enterButton)===null||ee===void 0?void 0:ee.call(o))!==null&&be!==void 0?be:!1}=e;We=We||We==="";const me=typeof We=="boolean"?le(Ex,null,null):null,Oe=`${J.value}-button`,Fe=Array.isArray(We)?We[0]:We;let Ke;const $e=Fe.type&&zL(Fe.type)&&Fe.type.__ANT_BUTTON;if($e||Fe.tagName==="button")Ke=xo(Fe,re({onMousedown:F,onClick:N,key:"enterButton"},$e?{class:Oe,size:te.value}:{}),!1);else{const Ct=me&&!We;Ke=le(ps,{class:Oe,type:We?"primary":void 0,size:te.value,disabled:Ie,key:"enterButton",onMousedown:F,onClick:N,loading:Ee,icon:Ct?me:null},{default:()=>[Ct?null:me||We]})}Re&&(Ke=[Ke,Re]);const pt=hn(J.value,{[`${J.value}-rtl`]:se.value==="rtl",[`${J.value}-${te.value}`]:!!te.value,[`${J.value}-with-button`]:!!We},c.class);return le(yo,it(it(it({ref:w},co(et,["onUpdate:value","onSearch","enterButton"])),c),{},{onPressEnter:G,onCompositionstart:Y,onCompositionend:K,size:te.value,prefixCls:ne.value,addonAfter:Ke,suffix:Qe,onChange:z,class:pt,disabled:Ie}),o)}}}),SO=e=>e!=null&&(Array.isArray(e)?ms(e).length:!0);function Mne(e){return SO(e.addonBefore)||SO(e.addonAfter)}const Ine=["text","input"],Ane=cn({compatConfig:{MODE:3},name:"ClearableLabeledInput",inheritAttrs:!1,props:{prefixCls:String,inputType:wt.oneOf(Tu("text","input")),value:La(),defaultValue:La(),allowClear:{type:Boolean,default:void 0},element:La(),handleReset:Function,disabled:{type:Boolean,default:void 0},direction:{type:String},size:{type:String},suffix:La(),prefix:La(),addonBefore:La(),addonAfter:La(),readonly:{type:Boolean,default:void 0},focused:{type:Boolean,default:void 0},bordered:{type:Boolean,default:!0},triggerFocus:{type:Function},hidden:Boolean,status:String,hashId:String},setup(e,t){let{slots:o,attrs:c}=t;const d=xs.useInject(),y=i=>{const{value:O,disabled:L,readonly:z,handleReset:F,suffix:N=o.suffix}=e,G=!L&&!z&&O,Y=`${i}-clear-icon`;return le(Ks,{onClick:F,onMousedown:K=>K.preventDefault(),class:hn({[`${Y}-hidden`]:!G,[`${Y}-has-suffix`]:!!N},Y),role:"button"},null)},w=(i,O)=>{const{value:L,allowClear:z,direction:F,bordered:N,hidden:G,status:Y,addonAfter:K=o.addonAfter,addonBefore:J=o.addonBefore,hashId:X}=e,{status:se,hasFeedback:te}=d;if(!z)return xo(O,{value:L,disabled:e.disabled});const ne=hn(`${i}-affix-wrapper`,`${i}-affix-wrapper-textarea-with-clear-btn`,Qf(`${i}-affix-wrapper`,Mx(se,Y),te),{[`${i}-affix-wrapper-rtl`]:F==="rtl",[`${i}-affix-wrapper-borderless`]:!N,[`${c.class}`]:!Mne({addonAfter:K,addonBefore:J})&&c.class},X);return le("span",{class:ne,style:c.style,hidden:G},[xo(O,{style:null,value:L,disabled:e.disabled}),y(i)])};return()=>{var i;const{prefixCls:O,inputType:L,element:z=(i=o.element)===null||i===void 0?void 0:i.call(o)}=e;return L===Ine[0]?w(O,z):null}}}),Pne=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,One=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],Aw={};let us;function Dne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const o=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&Aw[o])return Aw[o];const c=window.getComputedStyle(e),d=c.getPropertyValue("box-sizing")||c.getPropertyValue("-moz-box-sizing")||c.getPropertyValue("-webkit-box-sizing"),y=parseFloat(c.getPropertyValue("padding-bottom"))+parseFloat(c.getPropertyValue("padding-top")),w=parseFloat(c.getPropertyValue("border-bottom-width"))+parseFloat(c.getPropertyValue("border-top-width")),O={sizingStyle:One.map(L=>`${L}:${c.getPropertyValue(L)}`).join(";"),paddingSize:y,borderSize:w,boxSizing:d};return t&&o&&(Aw[o]=O),O}function Rne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;us||(us=document.createElement("textarea"),us.setAttribute("tab-index","-1"),us.setAttribute("aria-hidden","true"),document.body.appendChild(us)),e.getAttribute("wrap")?us.setAttribute("wrap",e.getAttribute("wrap")):us.removeAttribute("wrap");const{paddingSize:d,borderSize:y,boxSizing:w,sizingStyle:i}=Dne(e,t);us.setAttribute("style",`${i};${Pne}`),us.value=e.value||e.placeholder||"";let O,L,z,F=us.scrollHeight;if(w==="border-box"?F+=y:w==="content-box"&&(F-=d),o!==null||c!==null){us.value=" ";const G=us.scrollHeight-d;o!==null&&(O=G*o,w==="border-box"&&(O=O+d+y),F=Math.max(O,F)),c!==null&&(L=G*c,w==="border-box"&&(L=L+d+y),z=F>L?"":"hidden",F=Math.min(L,F))}const N={height:`${F}px`,overflowY:z,resize:"none"};return O&&(N.minHeight=`${O}px`),L&&(N.maxHeight=`${L}px`),N}const Pw=0,Ow=1,Dw=2,zne=cn({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:S$(),setup(e,t){let{attrs:o,emit:c,expose:d}=t,y,w;const i=tn(),O=tn({}),L=tn(Dw);fi(()=>{qr.cancel(y),qr.cancel(w)});const z=()=>{try{if(i.value&&document.activeElement===i.value.input){const ge=i.value.getSelectionStart(),ee=i.value.getSelectionEnd(),be=i.value.getScrollTop();i.value.setSelectionRange(ge,ee),i.value.setScrollTop(be)}}catch{}},F=tn(),N=tn();Ii(()=>{const ge=e.autoSize||e.autosize;ge?(F.value=ge.minRows,N.value=ge.maxRows):(F.value=void 0,N.value=void 0)});const G=He(()=>!!(e.autoSize||e.autosize)),Y=()=>{L.value=Pw};On([()=>e.value,F,N,G],()=>{G.value&&Y()},{immediate:!0});const K=tn();On([L,i],()=>{if(i.value)if(L.value===Pw)L.value=Ow;else if(L.value===Ow){const ge=Rne(i.value.input,!1,F.value,N.value);L.value=Dw,K.value=ge}else z()},{immediate:!0,flush:"post"});const J=Ys(),X=tn(),se=()=>{qr.cancel(X.value)},te=ge=>{L.value===Dw&&(c("resize",ge),G.value&&(se(),X.value=qr(()=>{Y()})))};fi(()=>{se()}),d({resizeTextarea:()=>{Y()},textArea:He(()=>{var ge;return(ge=i.value)===null||ge===void 0?void 0:ge.input}),instance:J}),Ou(e.autosize===void 0);const ue=()=>{const{prefixCls:ge,disabled:ee}=e,be=co(e,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","maxlength","valueModifiers"]),Ie=hn(ge,o.class,{[`${ge}-disabled`]:ee}),Ee=G.value?K.value:null,Re=[o.style,O.value,Ee],Qe=re(re(re({},be),o),{style:Re,class:Ie});return(L.value===Pw||L.value===Ow)&&Re.push({overflowX:"hidden",overflowY:"hidden"}),Qe.autofocus||delete Qe.autofocus,Qe.rows===0&&delete Qe.rows,le(sx,{onResize:te,disabled:!G.value},{default:()=>[le(tC,it(it({},Qe),{},{ref:i,tag:"textarea"}),null)]})};return()=>ue()}});function C$(e,t){return[...e||""].slice(0,t).join("")}function CO(e,t,o,c){let d=o;return e?d=C$(o,c):[...t||""].length<o.length&&[...o||""].length>c&&(d=t),d}const Lne=cn({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:S$(),setup(e,t){let{attrs:o,expose:c,emit:d}=t;var y;const w=Ic(),i=xs.useInject(),O=He(()=>Mx(i.status,e.status)),L=Xt((y=e.value)!==null&&y!==void 0?y:e.defaultValue),z=Xt(),F=Xt(""),{prefixCls:N,size:G,direction:Y}=Rr("input",e),[K,J]=YC(N),X=yc(),se=He(()=>e.showCount===""||e.showCount||!1),te=He(()=>Number(e.maxlength)>0),ne=Xt(!1),ue=Xt(),ge=Xt(0),ee=$e=>{ne.value=!0,ue.value=F.value,ge.value=$e.currentTarget.selectionStart,d("compositionstart",$e)},be=$e=>{var pt;ne.value=!1;let Ct=$e.currentTarget.value;if(te.value){const Lt=ge.value>=e.maxlength+1||ge.value===((pt=ue.value)===null||pt===void 0?void 0:pt.length);Ct=CO(Lt,ue.value,Ct,e.maxlength)}Ct!==F.value&&(Qe(Ct),Jg($e.currentTarget,$e,me,Ct)),d("compositionend",$e)},Ie=Ys();On(()=>e.value,()=>{var $e;"value"in Ie.vnode.props,L.value=($e=e.value)!==null&&$e!==void 0?$e:""});const Ee=$e=>{var pt;x$((pt=z.value)===null||pt===void 0?void 0:pt.textArea,$e)},Re=()=>{var $e,pt;(pt=($e=z.value)===null||$e===void 0?void 0:$e.textArea)===null||pt===void 0||pt.blur()},Qe=($e,pt)=>{L.value!==$e&&(e.value===void 0?L.value=$e:si(()=>{var Ct,Lt,It;z.value.textArea.value!==F.value&&((It=(Ct=z.value)===null||Ct===void 0?void 0:(Lt=Ct.instance).update)===null||It===void 0||It.call(Lt))}),si(()=>{pt&&pt()}))},et=$e=>{$e.keyCode===13&&d("pressEnter",$e),d("keydown",$e)},We=$e=>{const{onBlur:pt}=e;pt==null||pt($e),w.onFieldBlur()},me=$e=>{d("update:value",$e.target.value),d("change",$e),d("input",$e),w.onFieldChange()},Oe=$e=>{Jg(z.value.textArea,$e,me),Qe("",()=>{Ee()})},Fe=$e=>{let pt=$e.target.value;if(L.value!==pt){if(te.value){const Ct=$e.target,Lt=Ct.selectionStart>=e.maxlength+1||Ct.selectionStart===pt.length||!Ct.selectionStart;pt=CO(Lt,F.value,pt,e.maxlength)}Jg($e.currentTarget,$e,me,pt),Qe(pt)}},Ke=()=>{var $e,pt;const{class:Ct}=o,{bordered:Lt=!0}=e,It=re(re(re({},co(e,["allowClear"])),o),{class:[{[`${N.value}-borderless`]:!Lt,[`${Ct}`]:Ct&&!se.value,[`${N.value}-sm`]:G.value==="small",[`${N.value}-lg`]:G.value==="large"},Qf(N.value,O.value),J.value],disabled:X.value,showCount:null,prefixCls:N.value,onInput:Fe,onChange:Fe,onBlur:We,onKeydown:et,onCompositionstart:ee,onCompositionend:be});return!(($e=e.valueModifiers)===null||$e===void 0)&&$e.lazy&&delete It.onInput,le(zne,it(it({},It),{},{id:(pt=It==null?void 0:It.id)!==null&&pt!==void 0?pt:w.id.value,ref:z,maxlength:e.maxlength,lazy:e.lazy}),null)};return c({focus:Ee,blur:Re,resizableTextArea:z}),Ii(()=>{let $e=WS(L.value);!ne.value&&te.value&&(e.value===null||e.value===void 0)&&($e=C$($e,e.maxlength)),F.value=$e}),()=>{var $e;const{maxlength:pt,bordered:Ct=!0,hidden:Lt}=e,{style:It,class:_n}=o,Ut=re(re(re({},e),o),{prefixCls:N.value,inputType:"text",handleReset:Oe,direction:Y.value,bordered:Ct,style:se.value?void 0:It,hashId:J.value,disabled:($e=e.disabled)!==null&&$e!==void 0?$e:X.value});let ln=le(Ane,it(it({},Ut),{},{value:F.value,status:e.status}),{element:Ke});if(se.value||i.hasFeedback){const xn=[...F.value].length;let En="";typeof se.value=="object"?En=se.value.formatter({value:F.value,count:xn,maxlength:pt}):En=`${xn}${te.value?` / ${pt}`:""}`,ln=le("div",{hidden:Lt,class:hn(`${N.value}-textarea`,{[`${N.value}-textarea-rtl`]:Y.value==="rtl",[`${N.value}-textarea-show-count`]:se.value,[`${N.value}-textarea-in-form-item`]:i.isFormItemInput},`${N.value}-textarea-show-count`,_n,J.value),style:It,"data-count":typeof En!="object"?En:void 0},[ln,i.hasFeedback&&le("span",{class:`${N.value}-textarea-suffix`},[i.feedbackIcon])])}return K(ln)}}});var $ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};function TO(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){Fne(e,d,o[d])})}return e}function Fne(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var rT=function(t,o){var c=TO({},t,o.attrs);return le(Hi,TO({},c,{icon:$ne}),null)};rT.displayName="EyeOutlined";rT.inheritAttrs=!1;var Bne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};function EO(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){kne(e,d,o[d])})}return e}function kne(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var iT=function(t,o){var c=EO({},t,o.attrs);return le(Hi,EO({},c,{icon:Bne}),null)};iT.displayName="EyeInvisibleOutlined";iT.inheritAttrs=!1;var Nne=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const Vne={click:"onClick",hover:"onMouseover"},jne=e=>le(e?rT:iT,null,null),Une=cn({compatConfig:{MODE:3},name:"AInputPassword",inheritAttrs:!1,props:re(re({},Bx()),{prefixCls:String,inputPrefixCls:String,action:{type:String,default:"click"},visibilityToggle:{type:Boolean,default:!0},visible:{type:Boolean,default:void 0},"onUpdate:visible":Function,iconRender:Function}),setup(e,t){let{slots:o,attrs:c,expose:d,emit:y}=t;const w=Xt(!1),i=()=>{const{disabled:J}=e;J||(w.value=!w.value,y("update:visible",w.value))};Ii(()=>{e.visible!==void 0&&(w.value=!!e.visible)});const O=Xt();d({focus:()=>{var J;(J=O.value)===null||J===void 0||J.focus()},blur:()=>{var J;(J=O.value)===null||J===void 0||J.blur()}});const F=J=>{const{action:X,iconRender:se=o.iconRender||jne}=e,te=Vne[X]||"",ne=se(w.value),ue={[te]:i,class:`${J}-icon`,key:"passwordIcon",onMousedown:ge=>{ge.preventDefault()},onMouseup:ge=>{ge.preventDefault()}};return xo(Tc(ne)?ne:le("span",null,[ne]),ue)},{prefixCls:N,getPrefixCls:G}=Rr("input-password",e),Y=He(()=>G("input",e.inputPrefixCls)),K=()=>{const{size:J,visibilityToggle:X}=e,se=Nne(e,["size","visibilityToggle"]),te=X&&F(N.value),ne=hn(N.value,c.class,{[`${N.value}-${J}`]:!!J}),ue=re(re(re({},co(se,["suffix","iconRender","action"])),c),{type:w.value?"text":"password",class:ne,prefixCls:Y.value,suffix:te});return J&&(ue.size=J),le(yo,it({ref:O},ue),o)};return()=>K()}});yo.Group=Cne;yo.Search=Ene;yo.TextArea=Lne;yo.Password=Une;yo.install=function(e){return e.component(yo.name,yo),e.component(yo.Group.name,yo.Group),e.component(yo.Search.name,yo.Search),e.component(yo.TextArea.name,yo.TextArea),e.component(yo.Password.name,yo.Password),e};function oT(){return{keyboard:{type:Boolean,default:void 0},mask:{type:Boolean,default:void 0},afterClose:Function,closable:{type:Boolean,default:void 0},maskClosable:{type:Boolean,default:void 0},visible:{type:Boolean,default:void 0},destroyOnClose:{type:Boolean,default:void 0},mousePosition:wt.shape({x:Number,y:Number}).loose,title:wt.any,footer:wt.any,transitionName:String,maskTransitionName:String,animation:wt.any,maskAnimation:wt.any,wrapStyle:{type:Object,default:void 0},bodyStyle:{type:Object,default:void 0},maskStyle:{type:Object,default:void 0},prefixCls:String,wrapClassName:String,rootClassName:String,width:[String,Number],height:[String,Number],zIndex:Number,bodyProps:wt.any,maskProps:wt.any,wrapProps:wt.any,getContainer:wt.any,dialogStyle:{type:Object,default:void 0},dialogClass:String,closeIcon:wt.any,forceRender:{type:Boolean,default:void 0},getOpenCount:Function,focusTriggerAfterClose:{type:Boolean,default:void 0},onClose:Function,modalRender:Function}}function MO(e,t,o){let c=t;return!c&&o&&(c=`${e}-${o}`),c}let IO=-1;function Hne(){return IO+=1,IO}function AO(e,t){let o=e[`page${t?"Y":"X"}Offset`];const c=`scroll${t?"Top":"Left"}`;if(typeof o!="number"){const d=e.document;o=d.documentElement[c],typeof o!="number"&&(o=d.body[c])}return o}function Gne(e){const t=e.getBoundingClientRect(),o={left:t.left,top:t.top},c=e.ownerDocument,d=c.defaultView||c.parentWindow;return o.left+=AO(d),o.top+=AO(d,!0),o}const Wne={width:0,height:0,overflow:"hidden",outline:"none"},qne={outline:"none"},Zne=cn({compatConfig:{MODE:3},name:"DialogContent",inheritAttrs:!1,props:re(re({},oT()),{motionName:String,ariaId:String,onVisibleChanged:Function,onMousedown:Function,onMouseup:Function}),setup(e,t){let{expose:o,slots:c,attrs:d}=t;const y=tn(),w=tn(),i=tn();o({focus:()=>{var N;(N=y.value)===null||N===void 0||N.focus({preventScroll:!0})},changeActive:N=>{const{activeElement:G}=document;N&&G===w.value?y.value.focus({preventScroll:!0}):!N&&G===y.value&&w.value.focus({preventScroll:!0})}});const O=tn(),L=He(()=>{const{width:N,height:G}=e,Y={};return N!==void 0&&(Y.width=typeof N=="number"?`${N}px`:N),G!==void 0&&(Y.height=typeof G=="number"?`${G}px`:G),O.value&&(Y.transformOrigin=O.value),Y}),z=()=>{si(()=>{if(i.value){const N=Gne(i.value);O.value=e.mousePosition?`${e.mousePosition.x-N.left}px ${e.mousePosition.y-N.top}px`:""}})},F=N=>{e.onVisibleChanged(N)};return()=>{var N,G,Y,K;const{prefixCls:J,footer:X=(N=c.footer)===null||N===void 0?void 0:N.call(c),title:se=(G=c.title)===null||G===void 0?void 0:G.call(c),ariaId:te,closable:ne,closeIcon:ue=(Y=c.closeIcon)===null||Y===void 0?void 0:Y.call(c),onClose:ge,bodyStyle:ee,bodyProps:be,onMousedown:Ie,onMouseup:Ee,visible:Re,modalRender:Qe=c.modalRender,destroyOnClose:et,motionName:We}=e;let me;X&&(me=le("div",{class:`${J}-footer`},[X]));let Oe;se&&(Oe=le("div",{class:`${J}-header`},[le("div",{class:`${J}-title`,id:te},[se])]));let Fe;ne&&(Fe=le("button",{type:"button",onClick:ge,"aria-label":"Close",class:`${J}-close`},[ue||le("span",{class:`${J}-close-x`},null)]));const Ke=le("div",{class:`${J}-content`},[Fe,Oe,le("div",it({class:`${J}-body`,style:ee},be),[(K=c.default)===null||K===void 0?void 0:K.call(c)]),me]),$e=M_(We);return le(Al,it(it({},$e),{},{onBeforeEnter:z,onAfterEnter:()=>F(!0),onAfterLeave:()=>F(!1)}),{default:()=>[Re||!et?Ns(le("div",it(it({},d),{},{ref:i,key:"dialog-element",role:"document",style:[L.value,d.style],class:[J,d.class],onMousedown:Ie,onMouseup:Ee}),[le("div",{tabindex:0,ref:y,style:qne},[Qe?Qe({originVNode:Ke}):Ke]),le("div",{tabindex:0,ref:w,style:Wne},null)]),[[bl,Re]]):null]})}}}),Yne=cn({compatConfig:{MODE:3},name:"DialogMask",props:{prefixCls:String,visible:Boolean,motionName:String,maskProps:Object},setup(e,t){return()=>{const{prefixCls:o,visible:c,maskProps:d,motionName:y}=e,w=M_(y);return le(Al,w,{default:()=>[Ns(le("div",it({class:`${o}-mask`},d),null),[[bl,c]])]})}}}),PO=cn({compatConfig:{MODE:3},name:"VcDialog",inheritAttrs:!1,props:Wo(re(re({},oT()),{getOpenCount:Function,scrollLocker:Object}),{mask:!0,visible:!1,keyboard:!0,closable:!0,maskClosable:!0,destroyOnClose:!1,prefixCls:"rc-dialog",getOpenCount:()=>null,focusTriggerAfterClose:!0}),setup(e,t){let{attrs:o,slots:c}=t;const d=Xt(),y=Xt(),w=Xt(),i=Xt(e.visible),O=Xt(`vcDialogTitle${Hne()}`),L=X=>{var se,te;if(X)_u(y.value,document.activeElement)||(d.value=document.activeElement,(se=w.value)===null||se===void 0||se.focus());else{const ne=i.value;if(i.value=!1,e.mask&&d.value&&e.focusTriggerAfterClose){try{d.value.focus({preventScroll:!0})}catch{}d.value=null}ne&&((te=e.afterClose)===null||te===void 0||te.call(e))}},z=X=>{var se;(se=e.onClose)===null||se===void 0||se.call(e,X)},F=Xt(!1),N=Xt(),G=()=>{clearTimeout(N.value),F.value=!0},Y=()=>{N.value=setTimeout(()=>{F.value=!1})},K=X=>{if(!e.maskClosable)return null;F.value?F.value=!1:y.value===X.target&&z(X)},J=X=>{if(e.keyboard&&X.keyCode===nn.ESC){X.stopPropagation(),z(X);return}e.visible&&X.keyCode===nn.TAB&&w.value.changeActive(!X.shiftKey)};return On(()=>e.visible,()=>{e.visible&&(i.value=!0)},{flush:"post"}),fi(()=>{var X;clearTimeout(N.value),(X=e.scrollLocker)===null||X===void 0||X.unLock()}),Ii(()=>{var X,se;(X=e.scrollLocker)===null||X===void 0||X.unLock(),i.value&&((se=e.scrollLocker)===null||se===void 0||se.lock())}),()=>{const{prefixCls:X,mask:se,visible:te,maskTransitionName:ne,maskAnimation:ue,zIndex:ge,wrapClassName:ee,rootClassName:be,wrapStyle:Ie,closable:Ee,maskProps:Re,maskStyle:Qe,transitionName:et,animation:We,wrapProps:me,title:Oe=c.title}=e,{style:Fe,class:Ke}=o;return le("div",it({class:[`${X}-root`,be]},Sx(e,{data:!0})),[le(Yne,{prefixCls:X,visible:se&&te,motionName:MO(X,ne,ue),style:re({zIndex:ge},Qe),maskProps:Re},null),le("div",it({tabIndex:-1,onKeydown:J,class:hn(`${X}-wrap`,ee),ref:y,onClick:K,role:"dialog","aria-labelledby":Oe?O.value:null,style:re(re({zIndex:ge},Ie),{display:i.value?null:"none"})},me),[le(Zne,it(it({},co(e,["scrollLocker"])),{},{style:Fe,class:Ke,onMousedown:G,onMouseup:Y,ref:w,closable:Ee,ariaId:O.value,prefixCls:X,visible:te,onClose:z,onVisibleChanged:L,motionName:MO(X,et,We)}),c)])])}}}),Xne=oT(),Kne=cn({compatConfig:{MODE:3},name:"DialogWrap",inheritAttrs:!1,props:Wo(Xne,{visible:!1}),setup(e,t){let{attrs:o,slots:c}=t;const d=tn(e.visible);return eC({},{inTriggerContext:!1}),On(()=>e.visible,()=>{e.visible&&(d.value=!0)},{flush:"post"}),()=>{const{visible:y,getContainer:w,forceRender:i,destroyOnClose:O=!1,afterClose:L}=e;let z=re(re(re({},e),o),{ref:"_component",key:"dialog"});return w===!1?le(PO,it(it({},z),{},{getOpenCount:()=>2}),c):!i&&O&&!d.value?null:le(nL,{autoLock:!0,visible:y,forceRender:i,getContainer:w},{default:F=>(z=re(re(re({},z),F),{afterClose:()=>{L==null||L(),d.value=!1}}),le(PO,z,c))})}}});function OO(e){return{position:e,top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0}}const Jne=e=>{const{componentCls:t}=e;return[{[`${t}-root`]:{[`${t}${e.antCls}-zoom-enter, ${t}${e.antCls}-zoom-appear`]:{transform:"none",opacity:0,animationDuration:e.motionDurationSlow,userSelect:"none"},[`${t}${e.antCls}-zoom-leave ${t}-content`]:{pointerEvents:"none"},[`${t}-mask`]:re(re({},OO("fixed")),{zIndex:e.zIndexPopupBase,height:"100%",backgroundColor:e.colorBgMask,[`${t}-hidden`]:{display:"none"}}),[`${t}-wrap`]:re(re({},OO("fixed")),{overflow:"auto",outline:0,WebkitOverflowScrolling:"touch"})}},{[`${t}-root`]:vY(e)}]},Qne=e=>{const{componentCls:t}=e;return[{[`${t}-root`]:{[`${t}-wrap`]:{zIndex:e.zIndexPopupBase,position:"fixed",inset:0,overflow:"auto",outline:0,WebkitOverflowScrolling:"touch"},[`${t}-wrap-rtl`]:{direction:"rtl"},[`${t}-centered`]:{textAlign:"center","&::before":{display:"inline-block",width:0,height:"100%",verticalAlign:"middle",content:'""'},[t]:{top:0,display:"inline-block",paddingBottom:0,textAlign:"start",verticalAlign:"middle"}},[`@media (max-width: ${e.screenSMMax})`]:{[t]:{maxWidth:"calc(100vw - 16px)",margin:`${e.marginXS} auto`},[`${t}-centered`]:{[t]:{flex:1}}}}},{[t]:re(re({},Ei(e)),{pointerEvents:"none",position:"relative",top:100,width:"auto",maxWidth:`calc(100vw - ${e.margin*2}px)`,margin:"0 auto",paddingBottom:e.paddingLG,[`${t}-title`]:{margin:0,color:e.modalHeadingColor,fontWeight:e.fontWeightStrong,fontSize:e.modalHeaderTitleFontSize,lineHeight:e.modalHeaderTitleLineHeight,wordWrap:"break-word"},[`${t}-content`]:{position:"relative",backgroundColor:e.modalContentBg,backgroundClip:"padding-box",border:0,borderRadius:e.borderRadiusLG,boxShadow:e.boxShadowSecondary,pointerEvents:"auto",padding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`},[`${t}-close`]:re({position:"absolute",top:(e.modalHeaderCloseSize-e.modalCloseBtnSize)/2,insetInlineEnd:(e.modalHeaderCloseSize-e.modalCloseBtnSize)/2,zIndex:e.zIndexPopupBase+10,padding:0,color:e.modalCloseColor,fontWeight:e.fontWeightStrong,lineHeight:1,textDecoration:"none",background:"transparent",borderRadius:e.borderRadiusSM,width:e.modalConfirmIconSize,height:e.modalConfirmIconSize,border:0,outline:0,cursor:"pointer",transition:`color ${e.motionDurationMid}, background-color ${e.motionDurationMid}`,"&-x":{display:"block",fontSize:e.fontSizeLG,fontStyle:"normal",lineHeight:`${e.modalCloseBtnSize}px`,textAlign:"center",textTransform:"none",textRendering:"auto"},"&:hover":{color:e.modalIconHoverColor,backgroundColor:e.wireframe?"transparent":e.colorFillContent,textDecoration:"none"},"&:active":{backgroundColor:e.wireframe?"transparent":e.colorFillContentHover}},fz(e)),[`${t}-header`]:{color:e.colorText,background:e.modalHeaderBg,borderRadius:`${e.borderRadiusLG}px ${e.borderRadiusLG}px 0 0`,marginBottom:e.marginXS},[`${t}-body`]:{fontSize:e.fontSize,lineHeight:e.lineHeight,wordWrap:"break-word"},[`${t}-footer`]:{textAlign:"end",background:e.modalFooterBg,marginTop:e.marginSM,[`${e.antCls}-btn + ${e.antCls}-btn:not(${e.antCls}-dropdown-trigger)`]:{marginBottom:0,marginInlineStart:e.marginXS}},[`${t}-open`]:{overflow:"hidden"}})},{[`${t}-pure-panel`]:{top:"auto",padding:0,display:"flex",flexDirection:"column",[`${t}-content,
          ${t}-body,
          ${t}-confirm-body-wrapper`]:{display:"flex",flexDirection:"column",flex:"auto"},[`${t}-confirm-body`]:{marginBottom:"auto"}}}]},ere=e=>{const{componentCls:t}=e,o=`${t}-confirm`;return{[o]:{"&-rtl":{direction:"rtl"},[`${e.antCls}-modal-header`]:{display:"none"},[`${o}-body-wrapper`]:re({},hz()),[`${o}-body`]:{display:"flex",flexWrap:"wrap",alignItems:"center",[`${o}-title`]:{flex:"0 0 100%",display:"block",overflow:"hidden",color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.modalHeaderTitleFontSize,lineHeight:e.modalHeaderTitleLineHeight,[`+ ${o}-content`]:{marginBlockStart:e.marginXS,flexBasis:"100%",maxWidth:`calc(100% - ${e.modalConfirmIconSize+e.marginSM}px)`}},[`${o}-content`]:{color:e.colorText,fontSize:e.fontSize},[`> ${e.iconCls}`]:{flex:"none",marginInlineEnd:e.marginSM,fontSize:e.modalConfirmIconSize,[`+ ${o}-title`]:{flex:1},[`+ ${o}-title + ${o}-content`]:{marginInlineStart:e.modalConfirmIconSize+e.marginSM}}},[`${o}-btns`]:{textAlign:"end",marginTop:e.marginSM,[`${e.antCls}-btn + ${e.antCls}-btn`]:{marginBottom:0,marginInlineStart:e.marginXS}}},[`${o}-error ${o}-body > ${e.iconCls}`]:{color:e.colorError},[`${o}-warning ${o}-body > ${e.iconCls},
        ${o}-confirm ${o}-body > ${e.iconCls}`]:{color:e.colorWarning},[`${o}-info ${o}-body > ${e.iconCls}`]:{color:e.colorInfo},[`${o}-success ${o}-body > ${e.iconCls}`]:{color:e.colorSuccess},[`${t}-zoom-leave ${t}-btns`]:{pointerEvents:"none"}}},tre=e=>{const{componentCls:t}=e;return{[`${t}-root`]:{[`${t}-wrap-rtl`]:{direction:"rtl",[`${t}-confirm-body`]:{direction:"rtl"}}}}},nre=e=>{const{componentCls:t,antCls:o}=e,c=`${t}-confirm`;return{[t]:{[`${t}-content`]:{padding:0},[`${t}-header`]:{padding:e.modalHeaderPadding,borderBottom:`${e.modalHeaderBorderWidth}px ${e.modalHeaderBorderStyle} ${e.modalHeaderBorderColorSplit}`,marginBottom:0},[`${t}-body`]:{padding:e.modalBodyPadding},[`${t}-footer`]:{padding:`${e.modalFooterPaddingVertical}px ${e.modalFooterPaddingHorizontal}px`,borderTop:`${e.modalFooterBorderWidth}px ${e.modalFooterBorderStyle} ${e.modalFooterBorderColorSplit}`,borderRadius:`0 0 ${e.borderRadiusLG}px ${e.borderRadiusLG}px`,marginTop:0}},[c]:{[`${o}-modal-body`]:{padding:`${e.padding*2}px ${e.padding*2}px ${e.paddingLG}px`},[`${c}-body`]:{[`> ${e.iconCls}`]:{marginInlineEnd:e.margin,[`+ ${c}-title + ${c}-content`]:{marginInlineStart:e.modalConfirmIconSize+e.margin}}},[`${c}-btns`]:{marginTop:e.marginLG}}}},rre=Ui("Modal",e=>{const t=e.padding,o=e.fontSizeHeading5,c=e.lineHeightHeading5,d=Wr(e,{modalBodyPadding:e.paddingLG,modalHeaderBg:e.colorBgElevated,modalHeaderPadding:`${t}px ${e.paddingLG}px`,modalHeaderBorderWidth:e.lineWidth,modalHeaderBorderStyle:e.lineType,modalHeaderTitleLineHeight:c,modalHeaderTitleFontSize:o,modalHeaderBorderColorSplit:e.colorSplit,modalHeaderCloseSize:c*o+t*2,modalContentBg:e.colorBgElevated,modalHeadingColor:e.colorTextHeading,modalCloseColor:e.colorTextDescription,modalFooterBg:"transparent",modalFooterBorderColorSplit:e.colorSplit,modalFooterBorderStyle:e.lineType,modalFooterPaddingVertical:e.paddingXS,modalFooterPaddingHorizontal:e.padding,modalFooterBorderWidth:e.lineWidth,modalConfirmTitleFontSize:e.fontSizeLG,modalIconHoverColor:e.colorIconHover,modalConfirmIconSize:e.fontSize*e.lineHeight,modalCloseBtnSize:e.controlHeightLG*.55});return[Qne(d),ere(d),tre(d),Jne(d),e.wireframe&&nre(d),bC(d,"zoom")]});var ire=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};let qS;const ore=e=>{qS={x:e.pageX,y:e.pageY},setTimeout(()=>qS=null,100)};R4()&&js(document.documentElement,"click",ore,!0);const are=()=>({prefixCls:String,visible:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},confirmLoading:{type:Boolean,default:void 0},title:wt.any,closable:{type:Boolean,default:void 0},closeIcon:wt.any,onOk:Function,onCancel:Function,"onUpdate:visible":Function,"onUpdate:open":Function,onChange:Function,afterClose:Function,centered:{type:Boolean,default:void 0},width:[String,Number],footer:wt.any,okText:wt.any,okType:String,cancelText:wt.any,icon:wt.any,maskClosable:{type:Boolean,default:void 0},forceRender:{type:Boolean,default:void 0},okButtonProps:oi(),cancelButtonProps:oi(),destroyOnClose:{type:Boolean,default:void 0},wrapClassName:String,maskTransitionName:String,transitionName:String,getContainer:{type:[String,Function,Boolean,Object],default:void 0},zIndex:Number,bodyStyle:oi(),maskStyle:oi(),mask:{type:Boolean,default:void 0},keyboard:{type:Boolean,default:void 0},wrapProps:Object,focusTriggerAfterClose:{type:Boolean,default:void 0},modalRender:Function,mousePosition:oi()}),va=cn({compatConfig:{MODE:3},name:"AModal",inheritAttrs:!1,props:Wo(are(),{width:520,confirmLoading:!1,okType:"primary"}),setup(e,t){let{emit:o,slots:c,attrs:d}=t;const[y]=S_("Modal"),{prefixCls:w,rootPrefixCls:i,direction:O,getPopupContainer:L}=Rr("modal",e),[z,F]=rre(w);Ou(e.visible===void 0);const N=K=>{o("update:visible",!1),o("update:open",!1),o("cancel",K),o("change",!1)},G=K=>{o("ok",K)},Y=()=>{var K,J;const{okText:X=(K=c.okText)===null||K===void 0?void 0:K.call(c),okType:se,cancelText:te=(J=c.cancelText)===null||J===void 0?void 0:J.call(c),confirmLoading:ne}=e;return le(hr,null,[le(ps,it({onClick:N},e.cancelButtonProps),{default:()=>[te||y.value.cancelText]}),le(ps,it(it({},s4(se)),{},{loading:ne,onClick:G},e.okButtonProps),{default:()=>[X||y.value.okText]})])};return()=>{var K,J;const{prefixCls:X,visible:se,open:te,wrapClassName:ne,centered:ue,getContainer:ge,closeIcon:ee=(K=c.closeIcon)===null||K===void 0?void 0:K.call(c),focusTriggerAfterClose:be=!0}=e,Ie=ire(e,["prefixCls","visible","open","wrapClassName","centered","getContainer","closeIcon","focusTriggerAfterClose"]),Ee=hn(ne,{[`${w.value}-centered`]:!!ue,[`${w.value}-wrap-rtl`]:O.value==="rtl"});return z(le(Kne,it(it(it({},Ie),d),{},{rootClassName:F.value,class:hn(F.value,d.class),getContainer:ge||(L==null?void 0:L.value),prefixCls:w.value,wrapClassName:Ee,visible:te??se,onClose:N,focusTriggerAfterClose:be,transitionName:gh(i.value,"zoom",e.transitionName),maskTransitionName:gh(i.value,"fade",e.maskTransitionName),mousePosition:(J=Ie.mousePosition)!==null&&J!==void 0?J:qS}),re(re({},c),{footer:c.footer||Y,closeIcon:()=>le("span",{class:`${w.value}-close-x`},[ee||le(Ru,{class:`${w.value}-close-icon`},null)])})))}}}),sre=()=>{const e=Xt(!1);return fi(()=>{e.value=!0}),e},lre={type:{type:String},actionFn:Function,close:Function,autofocus:Boolean,prefixCls:String,buttonProps:oi(),emitEvent:Boolean,quitOnNullishReturnValue:Boolean};function DO(e){return!!(e&&e.then)}const RO=cn({compatConfig:{MODE:3},name:"ActionButton",props:lre,setup(e,t){let{slots:o}=t;const c=Xt(!1),d=Xt(),y=Xt(!1);let w;const i=sre();Qr(()=>{e.autofocus&&(w=setTimeout(()=>{var F,N;return(N=(F=gc(d.value))===null||F===void 0?void 0:F.focus)===null||N===void 0?void 0:N.call(F)}))}),fi(()=>{clearTimeout(w)});const O=function(){for(var F,N=arguments.length,G=new Array(N),Y=0;Y<N;Y++)G[Y]=arguments[Y];(F=e.close)===null||F===void 0||F.call(e,...G)},L=F=>{DO(F)&&(y.value=!0,F.then(function(){i.value||(y.value=!1),O(...arguments),c.value=!1},N=>(i.value||(y.value=!1),c.value=!1,Promise.reject(N))))},z=F=>{const{actionFn:N}=e;if(c.value)return;if(c.value=!0,!N){O();return}let G;if(e.emitEvent){if(G=N(F),e.quitOnNullishReturnValue&&!DO(G)){c.value=!1,O(F);return}}else if(N.length)G=N(e.close),c.value=!1;else if(G=N(),!G){O();return}L(G)};return()=>{const{type:F,prefixCls:N,buttonProps:G}=e;return le(ps,it(it(it({},s4(F)),{},{onClick:z,loading:y.value,prefixCls:N},G),{},{ref:d}),o)}}});function Bf(e){return typeof e=="function"?e():e}const T$=cn({name:"ConfirmDialog",inheritAttrs:!1,props:["icon","onCancel","onOk","close","closable","zIndex","afterClose","visible","open","keyboard","centered","getContainer","maskStyle","okButtonProps","cancelButtonProps","okType","prefixCls","okCancel","width","mask","maskClosable","okText","cancelText","autoFocusButton","transitionName","maskTransitionName","type","title","content","direction","rootPrefixCls","bodyStyle","closeIcon","modalRender","focusTriggerAfterClose","wrapClassName","confirmPrefixCls","footer"],setup(e,t){let{attrs:o}=t;const[c]=S_("Modal");return()=>{const{icon:d,onCancel:y,onOk:w,close:i,okText:O,closable:L=!1,zIndex:z,afterClose:F,keyboard:N,centered:G,getContainer:Y,maskStyle:K,okButtonProps:J,cancelButtonProps:X,okCancel:se,width:te=416,mask:ne=!0,maskClosable:ue=!1,type:ge,open:ee,title:be,content:Ie,direction:Ee,closeIcon:Re,modalRender:Qe,focusTriggerAfterClose:et,rootPrefixCls:We,bodyStyle:me,wrapClassName:Oe,footer:Fe}=e;let Ke=d;if(!d&&d!==null)switch(ge){case"info":Ke=le(Sh,null,null);break;case"success":Ke=le(zu,null,null);break;case"error":Ke=le(Ks,null,null);break;default:Ke=le(Lu,null,null)}const $e=e.okType||"primary",pt=e.prefixCls||"ant-modal",Ct=`${pt}-confirm`,Lt=o.style||{},It=se??ge==="confirm",_n=e.autoFocusButton===null?!1:e.autoFocusButton||"ok",Ut=`${pt}-confirm`,ln=hn(Ut,`${Ut}-${e.type}`,{[`${Ut}-rtl`]:Ee==="rtl"},o.class),xn=c.value,En=It&&le(RO,{actionFn:y,close:i,autofocus:_n==="cancel",buttonProps:X,prefixCls:`${We}-btn`},{default:()=>[Bf(e.cancelText)||xn.cancelText]});return le(va,{prefixCls:pt,class:ln,wrapClassName:hn({[`${Ut}-centered`]:!!G},Oe),onCancel:Nt=>i==null?void 0:i({triggerCancel:!0},Nt),open:ee,title:"",footer:"",transitionName:gh(We,"zoom",e.transitionName),maskTransitionName:gh(We,"fade",e.maskTransitionName),mask:ne,maskClosable:ue,maskStyle:K,style:Lt,bodyStyle:me,width:te,zIndex:z,afterClose:F,keyboard:N,centered:G,getContainer:Y,closable:L,closeIcon:Re,modalRender:Qe,focusTriggerAfterClose:et},{default:()=>[le("div",{class:`${Ct}-body-wrapper`},[le("div",{class:`${Ct}-body`},[Bf(Ke),be===void 0?null:le("span",{class:`${Ct}-title`},[Bf(be)]),le("div",{class:`${Ct}-content`},[Bf(Ie)])]),Fe!==void 0?Bf(Fe):le("div",{class:`${Ct}-btns`},[En,le(RO,{type:$e,actionFn:w,close:i,autofocus:_n==="ok",buttonProps:J,prefixCls:`${We}-btn`},{default:()=>[Bf(O)||(It?xn.okText:xn.justOkText)]})])])]})}}}),th=[],R_=e=>{const t=document.createDocumentFragment();let o=re(re({},co(e,["parentContext","appContext"])),{close:y,open:!0}),c=null;function d(){c&&(Cu(null,t),c=null);for(var L=arguments.length,z=new Array(L),F=0;F<L;F++)z[F]=arguments[F];const N=z.some(G=>G&&G.triggerCancel);e.onCancel&&N&&e.onCancel(()=>{},...z.slice(1));for(let G=0;G<th.length;G++)if(th[G]===y){th.splice(G,1);break}}function y(){for(var L=arguments.length,z=new Array(L),F=0;F<L;F++)z[F]=arguments[F];o=re(re({},o),{open:!1,afterClose:()=>{typeof e.afterClose=="function"&&e.afterClose(),d.apply(this,z)}}),o.visible&&delete o.visible,w(o)}function w(L){typeof L=="function"?o=L(o):o=re(re({},o),L),c&&pU(c,o,t)}const i=L=>{const z=zo,F=z.prefixCls,N=L.prefixCls||`${F}-modal`,G=z.iconPrefixCls,Y=ote();return le(sh,it(it({},z),{},{prefixCls:F}),{default:()=>[le(T$,it(it({},L),{},{rootPrefixCls:F,prefixCls:N,iconPrefixCls:G,locale:Y,cancelText:L.cancelText||Y.cancelText}),null)]})};function O(L){const z=le(i,re({},L));return z.appContext=e.parentContext||e.appContext||z.appContext,Cu(z,t),z}return c=O(o),th.push(y),{destroy:y,update:w}};function E$(e){return re(re({},e),{type:"warning"})}function M$(e){return re(re({},e),{type:"info"})}function I$(e){return re(re({},e),{type:"success"})}function A$(e){return re(re({},e),{type:"error"})}function P$(e){return re(re({},e),{type:"confirm"})}const cre=()=>({config:Object,afterClose:Function,destroyAction:Function,open:Boolean}),ure=cn({name:"HookModal",inheritAttrs:!1,props:Wo(cre(),{config:{width:520,okType:"primary"}}),setup(e,t){let{expose:o}=t;var c;const d=He(()=>e.open),y=He(()=>e.config),{direction:w,getPrefixCls:i}=A2(),O=i("modal"),L=i(),z=()=>{var Y,K;e==null||e.afterClose(),(K=(Y=y.value).afterClose)===null||K===void 0||K.call(Y)},F=function(){e.destroyAction(...arguments)};o({destroy:F});const N=(c=y.value.okCancel)!==null&&c!==void 0?c:y.value.type==="confirm",[G]=S_("Modal",Eu.Modal);return()=>le(T$,it(it({prefixCls:O,rootPrefixCls:L},y.value),{},{close:F,open:d.value,afterClose:z,okText:y.value.okText||(N?G==null?void 0:G.value.okText:G==null?void 0:G.value.justOkText),direction:y.value.direction||w.value,cancelText:y.value.cancelText||(G==null?void 0:G.value.cancelText)}),null)}});let zO=0;const dre=cn({name:"ElementsHolder",inheritAttrs:!1,setup(e,t){let{expose:o}=t;const c=Xt([]);return o({addModal:y=>(c.value.push(y),c.value=c.value.slice(),()=>{c.value=c.value.filter(w=>w!==y)})}),()=>c.value.map(y=>y())}});function hre(){const e=Xt(null),t=Xt([]);On(t,()=>{t.value.length&&([...t.value].forEach(w=>{w()}),t.value=[])},{immediate:!0});const o=y=>function(i){var O;zO+=1;const L=Xt(!0),z=Xt(null),F=Xt(Ar(i)),N=Xt({});On(()=>i,te=>{J(re(re({},lo(te)?te.value:te),N.value))});const G=function(){L.value=!1;for(var te=arguments.length,ne=new Array(te),ue=0;ue<te;ue++)ne[ue]=arguments[ue];const ge=ne.some(ee=>ee&&ee.triggerCancel);F.value.onCancel&&ge&&F.value.onCancel(()=>{},...ne.slice(1))};let Y;const K=()=>le(ure,{key:`modal-${zO}`,config:y(F.value),ref:z,open:L.value,destroyAction:G,afterClose:()=>{Y==null||Y()}},null);Y=(O=e.value)===null||O===void 0?void 0:O.addModal(K),Y&&th.push(Y);const J=te=>{F.value=re(re({},F.value),te)};return{destroy:()=>{z.value?G():t.value=[...t.value,G]},update:te=>{N.value=te,z.value?J(te):t.value=[...t.value,()=>J(te)]}}},c=He(()=>({info:o(M$),success:o(I$),error:o(A$),warning:o(E$),confirm:o(P$)})),d=Symbol("modalHolderKey");return[c.value,()=>le(dre,{key:d,ref:e},null)]}function O$(e){return R_(E$(e))}va.useModal=hre;va.info=function(t){return R_(M$(t))};va.success=function(t){return R_(I$(t))};va.error=function(t){return R_(A$(t))};va.warning=O$;va.warn=O$;va.confirm=function(t){return R_(P$(t))};va.destroyAll=function(){for(;th.length;){const t=th.pop();t&&t()}};va.install=function(e){return e.component(va.name,va),e};const fre=Pl(L4),aT=(e,t)=>{let{attrs:o}=t;const{included:c,vertical:d,style:y,class:w}=o;let{length:i,offset:O,reverse:L}=o;i<0&&(L=!L,i=Math.abs(i),O=100-O);const z=d?{[L?"top":"bottom"]:`${O}%`,[L?"bottom":"top"]:"auto",height:`${i}%`}:{[L?"right":"left"]:`${O}%`,[L?"left":"right"]:"auto",width:`${i}%`},F=re(re({},y),z);return c?le("div",{class:w,style:F},null):null};aT.inheritAttrs=!1;const pre=(e,t,o,c,d,y)=>{const w=Object.keys(t).map(parseFloat).sort((i,O)=>i-O);if(o&&c)for(let i=d;i<=y;i+=c)w.indexOf(i)===-1&&w.push(i);return w},D$=(e,t)=>{let{attrs:o}=t;const{prefixCls:c,vertical:d,reverse:y,marks:w,dots:i,step:O,included:L,lowerBound:z,upperBound:F,max:N,min:G,dotStyle:Y,activeDotStyle:K}=o,J=N-G,X=pre(d,w,i,O,G,N).map(se=>{const te=`${Math.abs(se-G)/J*100}%`,ne=!L&&se===F||L&&se<=F&&se>=z;let ue=d?re(re({},Y),{[y?"top":"bottom"]:te}):re(re({},Y),{[y?"right":"left"]:te});ne&&(ue=re(re({},ue),K));const ge=hn({[`${c}-dot`]:!0,[`${c}-dot-active`]:ne,[`${c}-dot-reverse`]:y});return le("span",{class:ge,style:ue,key:se},null)});return le("div",{class:`${c}-step`},[X])};D$.inheritAttrs=!1;const R$=(e,t)=>{let{attrs:o,slots:c}=t;const{class:d,vertical:y,reverse:w,marks:i,included:O,upperBound:L,lowerBound:z,max:F,min:N,onClickLabel:G}=o,Y=Object.keys(i),K=c.mark,J=F-N,X=Y.map(parseFloat).sort((se,te)=>se-te).map(se=>{const te=typeof i[se]=="function"?i[se]():i[se],ne=typeof te=="object"&&!Tc(te);let ue=ne?te.label:te;if(!ue&&ue!==0)return null;K&&(ue=K({point:se,label:ue}));const ge=!O&&se===L||O&&se<=L&&se>=z,ee=hn({[`${d}-text`]:!0,[`${d}-text-active`]:ge}),be={marginBottom:"-50%",[w?"top":"bottom"]:`${(se-N)/J*100}%`},Ie={transform:`translateX(${w?"50%":"-50%"})`,msTransform:`translateX(${w?"50%":"-50%"})`,[w?"right":"left"]:`${(se-N)/J*100}%`},Ee=y?be:Ie,Re=ne?re(re({},Ee),te.style):Ee,Qe={[$o?"onTouchstartPassive":"onTouchstart"]:et=>G(et,se)};return le("span",it({class:ee,style:Re,key:se,onMousedown:et=>G(et,se)},Qe),[ue])});return le("div",{class:d},[X])};R$.inheritAttrs=!1;const z$=cn({compatConfig:{MODE:3},name:"Handle",inheritAttrs:!1,props:{prefixCls:String,vertical:{type:Boolean,default:void 0},offset:Number,disabled:{type:Boolean,default:void 0},min:Number,max:Number,value:Number,tabindex:wt.oneOfType([wt.number,wt.string]),reverse:{type:Boolean,default:void 0},ariaLabel:String,ariaLabelledBy:String,ariaValueTextFormatter:Function,onMouseenter:{type:Function},onMouseleave:{type:Function},onMousedown:{type:Function}},setup(e,t){let{attrs:o,emit:c,expose:d}=t;const y=Xt(!1),w=Xt(),i=()=>{document.activeElement===w.value&&(y.value=!0)},O=J=>{y.value=!1,c("blur",J)},L=()=>{y.value=!1},z=()=>{var J;(J=w.value)===null||J===void 0||J.focus()},F=()=>{var J;(J=w.value)===null||J===void 0||J.blur()},N=()=>{y.value=!0,z()},G=J=>{J.preventDefault(),z(),c("mousedown",J)};d({focus:z,blur:F,clickFocus:N,ref:w});let Y=null;Qr(()=>{Y=js(document,"mouseup",i)}),fi(()=>{Y==null||Y.remove()});const K=He(()=>{const{vertical:J,offset:X,reverse:se}=e;return J?{[se?"top":"bottom"]:`${X}%`,[se?"bottom":"top"]:"auto",transform:se?null:"translateY(+50%)"}:{[se?"right":"left"]:`${X}%`,[se?"left":"right"]:"auto",transform:`translateX(${se?"+":"-"}50%)`}});return()=>{const{prefixCls:J,disabled:X,min:se,max:te,value:ne,tabindex:ue,ariaLabel:ge,ariaLabelledBy:ee,ariaValueTextFormatter:be,onMouseenter:Ie,onMouseleave:Ee}=e,Re=hn(o.class,{[`${J}-handle-click-focused`]:y.value}),Qe={"aria-valuemin":se,"aria-valuemax":te,"aria-valuenow":ne,"aria-disabled":!!X},et=[o.style,K.value];let We=ue||0;(X||ue===null)&&(We=null);let me;be&&(me=be(ne));const Oe=re(re(re(re({},o),{role:"slider",tabindex:We}),Qe),{class:Re,onBlur:O,onKeydown:L,onMousedown:G,onMouseenter:Ie,onMouseleave:Ee,ref:w,style:et});return le("div",it(it({},Oe),{},{"aria-label":ge,"aria-labelledby":ee,"aria-valuetext":me}),null)}}});function Rw(e,t){try{return Object.keys(t).some(o=>e.target===t[o].ref)}catch{return!1}}function L$(e,t){let{min:o,max:c}=t;return e<o||e>c}function LO(e){return e.touches.length>1||e.type.toLowerCase()==="touchend"&&e.touches.length>0}function $O(e,t){let{marks:o,step:c,min:d,max:y}=t;const w=Object.keys(o).map(parseFloat);if(c!==null){const O=Math.pow(10,$$(c)),L=Math.floor((y*O-d*O)/(c*O)),z=Math.min((e-d)/c,L),F=Math.round(z)*c+d;w.push(F)}const i=w.map(O=>Math.abs(e-O));return w[i.indexOf(Math.min(...i))]}function $$(e){const t=e.toString();let o=0;return t.indexOf(".")>=0&&(o=t.length-t.indexOf(".")-1),o}function FO(e,t){let o=1;return window.visualViewport&&(o=+(window.visualViewport.width/document.body.getBoundingClientRect().width).toFixed(2)),(e?t.clientY:t.pageX)/o}function BO(e,t){let o=1;return window.visualViewport&&(o=+(window.visualViewport.width/document.body.getBoundingClientRect().width).toFixed(2)),(e?t.touches[0].clientY:t.touches[0].pageX)/o}function kO(e,t){const o=t.getBoundingClientRect();return e?o.top+o.height*.5:window.scrollX+o.left+o.width*.5}function sT(e,t){let{max:o,min:c}=t;return e<=c?c:e>=o?o:e}function F$(e,t){const{step:o}=t,c=isFinite($O(e,t))?$O(e,t):0;return o===null?c:parseFloat(c.toFixed($$(o)))}function fp(e){e.stopPropagation(),e.preventDefault()}function mre(e,t,o){const c={increase:(w,i)=>w+i,decrease:(w,i)=>w-i},d=c[e](Object.keys(o.marks).indexOf(JSON.stringify(t)),1),y=Object.keys(o.marks)[d];return o.step?c[e](t,o.step):Object.keys(o.marks).length&&o.marks[y]?o.marks[y]:t}function B$(e,t,o){const c="increase",d="decrease";let y=c;switch(e.keyCode){case nn.UP:y=t&&o?d:c;break;case nn.RIGHT:y=!t&&o?d:c;break;case nn.DOWN:y=t&&o?c:d;break;case nn.LEFT:y=!t&&o?c:d;break;case nn.END:return(w,i)=>i.max;case nn.HOME:return(w,i)=>i.min;case nn.PAGE_UP:return(w,i)=>w+i.step*2;case nn.PAGE_DOWN:return(w,i)=>w-i.step*2;default:return}return(w,i)=>mre(y,w,i)}var gre=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};function qd(){}function k$(e){const t={id:String,min:Number,max:Number,step:Number,marks:wt.object,included:{type:Boolean,default:void 0},prefixCls:String,disabled:{type:Boolean,default:void 0},handle:Function,dots:{type:Boolean,default:void 0},vertical:{type:Boolean,default:void 0},reverse:{type:Boolean,default:void 0},minimumTrackStyle:wt.object,maximumTrackStyle:wt.object,handleStyle:wt.oneOfType([wt.object,wt.arrayOf(wt.object)]),trackStyle:wt.oneOfType([wt.object,wt.arrayOf(wt.object)]),railStyle:wt.object,dotStyle:wt.object,activeDotStyle:wt.object,autofocus:{type:Boolean,default:void 0},draggableTrack:{type:Boolean,default:void 0}};return cn({compatConfig:{MODE:3},name:"CreateSlider",mixins:[wx,e],inheritAttrs:!1,props:Wo(t,{prefixCls:"rc-slider",min:0,max:100,step:1,marks:{},included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),emits:["change","blur","focus"],data(){return this.handlesRefs={},{}},mounted(){this.$nextTick(()=>{this.document=this.sliderRef&&this.sliderRef.ownerDocument;const{autofocus:o,disabled:c}=this;o&&!c&&this.focus()})},beforeUnmount(){this.$nextTick(()=>{this.removeDocumentEvents()})},methods:{defaultHandle(o){var{index:c,directives:d,className:y,style:w}=o,i=gre(o,["index","directives","className","style"]);if(delete i.dragging,i.value===null)return null;const O=re(re({},i),{class:y,style:w,key:c});return le(z$,O,null)},onDown(o,c){let d=c;const{draggableTrack:y,vertical:w}=this.$props,{bounds:i}=this.$data,O=y&&this.positionGetValue?this.positionGetValue(d)||[]:[],L=Rw(o,this.handlesRefs);if(this.dragTrack=y&&i.length>=2&&!L&&!O.map((z,F)=>{const N=F?!0:z>=i[F];return F===O.length-1?z<=i[F]:N}).some(z=>!z),this.dragTrack)this.dragOffset=d,this.startBounds=[...i];else{if(!L)this.dragOffset=0;else{const z=kO(w,o.target);this.dragOffset=d-z,d=z}this.onStart(d)}},onMouseDown(o){if(o.button!==0)return;this.removeDocumentEvents();const c=this.$props.vertical,d=FO(c,o);this.onDown(o,d),this.addDocumentMouseEvents()},onTouchStart(o){if(LO(o))return;const c=this.vertical,d=BO(c,o);this.onDown(o,d),this.addDocumentTouchEvents(),fp(o)},onFocus(o){const{vertical:c}=this;if(Rw(o,this.handlesRefs)&&!this.dragTrack){const d=kO(c,o.target);this.dragOffset=0,this.onStart(d),fp(o),this.$emit("focus",o)}},onBlur(o){this.dragTrack||this.onEnd(),this.$emit("blur",o)},onMouseUp(){this.handlesRefs[this.prevMovedHandleIndex]&&this.handlesRefs[this.prevMovedHandleIndex].clickFocus()},onMouseMove(o){if(!this.sliderRef){this.onEnd();return}const c=FO(this.vertical,o);this.onMove(o,c-this.dragOffset,this.dragTrack,this.startBounds)},onTouchMove(o){if(LO(o)||!this.sliderRef){this.onEnd();return}const c=BO(this.vertical,o);this.onMove(o,c-this.dragOffset,this.dragTrack,this.startBounds)},onKeyDown(o){this.sliderRef&&Rw(o,this.handlesRefs)&&this.onKeyboard(o)},onClickMarkLabel(o,c){o.stopPropagation(),this.onChange({sValue:c}),this.setState({sValue:c},()=>this.onEnd(!0))},getSliderStart(){const o=this.sliderRef,{vertical:c,reverse:d}=this,y=o.getBoundingClientRect();return c?d?y.bottom:y.top:window.scrollX+(d?y.right:y.left)},getSliderLength(){const o=this.sliderRef;if(!o)return 0;const c=o.getBoundingClientRect();return this.vertical?c.height:c.width},addDocumentTouchEvents(){this.onTouchMoveListener=js(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=js(this.document,"touchend",this.onEnd)},addDocumentMouseEvents(){this.onMouseMoveListener=js(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=js(this.document,"mouseup",this.onEnd)},removeDocumentEvents(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()},focus(){var o;this.$props.disabled||(o=this.handlesRefs[0])===null||o===void 0||o.focus()},blur(){this.$props.disabled||Object.keys(this.handlesRefs).forEach(o=>{var c,d;(d=(c=this.handlesRefs[o])===null||c===void 0?void 0:c.blur)===null||d===void 0||d.call(c)})},calcValue(o){const{vertical:c,min:d,max:y}=this,w=Math.abs(Math.max(o,0)/this.getSliderLength());return c?(1-w)*(y-d)+d:w*(y-d)+d},calcValueByPos(o){const d=(this.reverse?-1:1)*(o-this.getSliderStart());return this.trimAlignValue(this.calcValue(d))},calcOffset(o){const{min:c,max:d}=this,y=(o-c)/(d-c);return Math.max(0,y*100)},saveSlider(o){this.sliderRef=o},saveHandle(o,c){this.handlesRefs[o]=c}},render(){const{prefixCls:o,marks:c,dots:d,step:y,included:w,disabled:i,vertical:O,reverse:L,min:z,max:F,maximumTrackStyle:N,railStyle:G,dotStyle:Y,activeDotStyle:K,id:J}=this,{class:X,style:se}=this.$attrs,{tracks:te,handles:ne}=this.renderSlider(),ue=hn(o,X,{[`${o}-with-marks`]:Object.keys(c).length,[`${o}-disabled`]:i,[`${o}-vertical`]:O,[`${o}-horizontal`]:!O}),ge={vertical:O,marks:c,included:w,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:F,min:z,reverse:L,class:`${o}-mark`,onClickLabel:i?qd:this.onClickMarkLabel},ee={[$o?"onTouchstartPassive":"onTouchstart"]:i?qd:this.onTouchStart};return le("div",it(it({id:J,ref:this.saveSlider,tabindex:"-1",class:ue},ee),{},{onMousedown:i?qd:this.onMouseDown,onMouseup:i?qd:this.onMouseUp,onKeydown:i?qd:this.onKeyDown,onFocus:i?qd:this.onFocus,onBlur:i?qd:this.onBlur,style:se}),[le("div",{class:`${o}-rail`,style:re(re({},N),G)},null),te,le(D$,{prefixCls:o,vertical:O,reverse:L,marks:c,dots:d,step:y,included:w,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:F,min:z,dotStyle:Y,activeDotStyle:K},null),ne,le(R$,ge,{mark:this.$slots.mark}),C2(this)])}})}const _re=cn({compatConfig:{MODE:3},name:"Slider",mixins:[wx],inheritAttrs:!1,props:{defaultValue:Number,value:Number,disabled:{type:Boolean,default:void 0},autofocus:{type:Boolean,default:void 0},tabindex:wt.oneOfType([wt.number,wt.string]),reverse:{type:Boolean,default:void 0},min:Number,max:Number,ariaLabelForHandle:String,ariaLabelledByForHandle:String,ariaValueTextFormatterForHandle:String,startPoint:Number},emits:["beforeChange","afterChange","change"],data(){const e=this.defaultValue!==void 0?this.defaultValue:this.min,t=this.value!==void 0?this.value:e;return{sValue:this.trimAlignValue(t),dragging:!1}},watch:{value:{handler(e){this.setChangeValue(e)},deep:!0},min(){const{sValue:e}=this;this.setChangeValue(e)},max(){const{sValue:e}=this;this.setChangeValue(e)}},methods:{setChangeValue(e){const t=e!==void 0?e:this.sValue,o=this.trimAlignValue(t,this.$props);o!==this.sValue&&(this.setState({sValue:o}),L$(t,this.$props)&&this.$emit("change",o))},onChange(e){const t=!Av(this,"value"),o=e.sValue>this.max?re(re({},e),{sValue:this.max}):e;t&&this.setState(o);const c=o.sValue;this.$emit("change",c)},onStart(e){this.setState({dragging:!0});const{sValue:t}=this;this.$emit("beforeChange",t);const o=this.calcValueByPos(e);this.startValue=o,this.startPosition=e,o!==t&&(this.prevMovedHandleIndex=0,this.onChange({sValue:o}))},onEnd(e){const{dragging:t}=this;this.removeDocumentEvents(),(t||e)&&this.$emit("afterChange",this.sValue),this.setState({dragging:!1})},onMove(e,t){fp(e);const{sValue:o}=this,c=this.calcValueByPos(t);c!==o&&this.onChange({sValue:c})},onKeyboard(e){const{reverse:t,vertical:o}=this.$props,c=B$(e,o,t);if(c){fp(e);const{sValue:d}=this,y=c(d,this.$props),w=this.trimAlignValue(y);if(w===d)return;this.onChange({sValue:w}),this.$emit("afterChange",w),this.onEnd()}},getLowerBound(){const e=this.$props.startPoint||this.$props.min;return this.$data.sValue>e?e:this.$data.sValue},getUpperBound(){return this.$data.sValue<this.$props.startPoint?this.$props.startPoint:this.$data.sValue},trimAlignValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e===null)return null;const o=re(re({},this.$props),t),c=sT(e,o);return F$(c,o)},getTrack(e){let{prefixCls:t,reverse:o,vertical:c,included:d,minimumTrackStyle:y,mergedTrackStyle:w,length:i,offset:O}=e;return le(aT,{class:`${t}-track`,vertical:c,included:d,offset:O,reverse:o,length:i,style:re(re({},y),w)},null)},renderSlider(){const{prefixCls:e,vertical:t,included:o,disabled:c,minimumTrackStyle:d,trackStyle:y,handleStyle:w,tabindex:i,ariaLabelForHandle:O,ariaLabelledByForHandle:L,ariaValueTextFormatterForHandle:z,min:F,max:N,startPoint:G,reverse:Y,handle:K,defaultHandle:J}=this,X=K||J,{sValue:se,dragging:te}=this,ne=this.calcOffset(se),ue=X({class:`${e}-handle`,prefixCls:e,vertical:t,offset:ne,value:se,dragging:te,disabled:c,min:F,max:N,reverse:Y,index:0,tabindex:i,ariaLabel:O,ariaLabelledBy:L,ariaValueTextFormatter:z,style:w[0]||w,ref:be=>this.saveHandle(0,be),onFocus:this.onFocus,onBlur:this.onBlur}),ge=G!==void 0?this.calcOffset(G):0,ee=y[0]||y;return{tracks:this.getTrack({prefixCls:e,reverse:Y,vertical:t,included:o,offset:ge,minimumTrackStyle:d,mergedTrackStyle:ee,length:ne-ge}),handles:ue}}}}),yre=k$(_re),Eg=e=>{let{value:t,handle:o,bounds:c,props:d}=e;const{allowCross:y,pushable:w}=d,i=Number(w),O=sT(t,d);let L=O;return!y&&o!=null&&c!==void 0&&(o>0&&O<=c[o-1]+i&&(L=c[o-1]+i),o<c.length-1&&O>=c[o+1]-i&&(L=c[o+1]-i)),F$(L,d)},vre={defaultValue:wt.arrayOf(wt.number),value:wt.arrayOf(wt.number),count:Number,pushable:Aj(wt.oneOfType([wt.looseBool,wt.number])),allowCross:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},reverse:{type:Boolean,default:void 0},tabindex:wt.arrayOf(wt.number),prefixCls:String,min:Number,max:Number,autofocus:{type:Boolean,default:void 0},ariaLabelGroupForHandles:Array,ariaLabelledByGroupForHandles:Array,ariaValueTextFormatterGroupForHandles:Array,draggableTrack:{type:Boolean,default:void 0}},xre=cn({compatConfig:{MODE:3},name:"Range",mixins:[wx],inheritAttrs:!1,props:Wo(vre,{count:1,allowCross:!0,pushable:!1,tabindex:[],draggableTrack:!1,ariaLabelGroupForHandles:[],ariaLabelledByGroupForHandles:[],ariaValueTextFormatterGroupForHandles:[]}),emits:["beforeChange","afterChange","change"],displayName:"Range",data(){const{count:e,min:t,max:o}=this,c=Array(...Array(e+1)).map(()=>t),d=Av(this,"defaultValue")?this.defaultValue:c;let{value:y}=this;y===void 0&&(y=d);const w=y.map((O,L)=>Eg({value:O,handle:L,props:this.$props}));return{sHandle:null,recent:w[0]===o?0:w.length-1,bounds:w}},watch:{value:{handler(e){const{bounds:t}=this;this.setChangeValue(e||t)},deep:!0},min(){const{value:e}=this;this.setChangeValue(e||this.bounds)},max(){const{value:e}=this;this.setChangeValue(e||this.bounds)}},methods:{setChangeValue(e){const{bounds:t}=this;let o=e.map((c,d)=>Eg({value:c,handle:d,bounds:t,props:this.$props}));if(t.length===o.length){if(o.every((c,d)=>c===t[d]))return null}else o=e.map((c,d)=>Eg({value:c,handle:d,props:this.$props}));if(this.setState({bounds:o}),e.some(c=>L$(c,this.$props))){const c=e.map(d=>sT(d,this.$props));this.$emit("change",c)}},onChange(e){if(!Av(this,"value"))this.setState(e);else{const d={};["sHandle","recent"].forEach(y=>{e[y]!==void 0&&(d[y]=e[y])}),Object.keys(d).length&&this.setState(d)}const c=re(re({},this.$data),e).bounds;this.$emit("change",c)},positionGetValue(e){const t=this.getValue(),o=this.calcValueByPos(e),c=this.getClosestBound(o),d=this.getBoundNeedMoving(o,c),y=t[d];if(o===y)return null;const w=[...t];return w[d]=o,w},onStart(e){const{bounds:t}=this;this.$emit("beforeChange",t);const o=this.calcValueByPos(e);this.startValue=o,this.startPosition=e;const c=this.getClosestBound(o);this.prevMovedHandleIndex=this.getBoundNeedMoving(o,c),this.setState({sHandle:this.prevMovedHandleIndex,recent:this.prevMovedHandleIndex});const d=t[this.prevMovedHandleIndex];if(o===d)return;const y=[...t];y[this.prevMovedHandleIndex]=o,this.onChange({bounds:y})},onEnd(e){const{sHandle:t}=this;this.removeDocumentEvents(),t||(this.dragTrack=!1),(t!==null||e)&&this.$emit("afterChange",this.bounds),this.setState({sHandle:null})},onMove(e,t,o,c){fp(e);const{$data:d,$props:y}=this,w=y.max||100,i=y.min||0;if(o){let N=y.vertical?-t:t;N=y.reverse?-N:N;const G=w-Math.max(...c),Y=i-Math.min(...c),K=Math.min(Math.max(N/(this.getSliderLength()/100),Y),G),J=c.map(X=>Math.floor(Math.max(Math.min(X+K,w),i)));d.bounds.map((X,se)=>X===J[se]).some(X=>!X)&&this.onChange({bounds:J});return}const{bounds:O,sHandle:L}=this,z=this.calcValueByPos(t),F=O[L];z!==F&&this.moveTo(z)},onKeyboard(e){const{reverse:t,vertical:o}=this.$props,c=B$(e,o,t);if(c){fp(e);const{bounds:d,sHandle:y}=this,w=d[y===null?this.recent:y],i=c(w,this.$props),O=Eg({value:i,handle:y,bounds:d,props:this.$props});if(O===w)return;this.moveTo(O,!0)}},getClosestBound(e){const{bounds:t}=this;let o=0;for(let c=1;c<t.length-1;c+=1)e>=t[c]&&(o=c);return Math.abs(t[o+1]-e)<Math.abs(t[o]-e)&&(o+=1),o},getBoundNeedMoving(e,t){const{bounds:o,recent:c}=this;let d=t;const y=o[t+1]===o[t];return y&&o[c]===o[t]&&(d=c),y&&e!==o[t+1]&&(d=e<o[t+1]?t:t+1),d},getLowerBound(){return this.bounds[0]},getUpperBound(){const{bounds:e}=this;return e[e.length-1]},getPoints(){const{marks:e,step:t,min:o,max:c}=this,d=this.internalPointsCache;if(!d||d.marks!==e||d.step!==t){const y=re({},e);if(t!==null)for(let i=o;i<=c;i+=t)y[i]=i;const w=Object.keys(y).map(parseFloat);w.sort((i,O)=>i-O),this.internalPointsCache={marks:e,step:t,points:w}}return this.internalPointsCache.points},moveTo(e,t){const o=[...this.bounds],{sHandle:c,recent:d}=this,y=c===null?d:c;o[y]=e;let w=y;this.$props.pushable!==!1?this.pushSurroundingHandles(o,w):this.$props.allowCross&&(o.sort((i,O)=>i-O),w=o.indexOf(e)),this.onChange({recent:w,sHandle:w,bounds:o}),t&&(this.$emit("afterChange",o),this.setState({},()=>{this.handlesRefs[w].focus()}),this.onEnd())},pushSurroundingHandles(e,t){const o=e[t],{pushable:c}=this,d=Number(c);let y=0;if(e[t+1]-o<d&&(y=1),o-e[t-1]<d&&(y=-1),y===0)return;const w=t+y,i=y*(e[w]-o);this.pushHandle(e,w,y,d-i)||(e[t]=e[w]-y*d)},pushHandle(e,t,o,c){const d=e[t];let y=e[t];for(;o*(y-d)<c;){if(!this.pushHandleOnePoint(e,t,o))return e[t]=d,!1;y=e[t]}return!0},pushHandleOnePoint(e,t,o){const c=this.getPoints(),y=c.indexOf(e[t])+o;if(y>=c.length||y<0)return!1;const w=t+o,i=c[y],{pushable:O}=this,L=Number(O),z=o*(e[w]-i);return this.pushHandle(e,w,o,L-z)?(e[t]=i,!0):!1},trimAlignValue(e){const{sHandle:t,bounds:o}=this;return Eg({value:e,handle:t,bounds:o,props:this.$props})},ensureValueNotConflict(e,t,o){let{allowCross:c,pushable:d}=o;const y=this.$data||{},{bounds:w}=y;if(e=e===void 0?y.sHandle:e,d=Number(d),!c&&e!=null&&w!==void 0){if(e>0&&t<=w[e-1]+d)return w[e-1]+d;if(e<w.length-1&&t>=w[e+1]-d)return w[e+1]-d}return t},getTrack(e){let{bounds:t,prefixCls:o,reverse:c,vertical:d,included:y,offsets:w,trackStyle:i}=e;return t.slice(0,-1).map((O,L)=>{const z=L+1,F=hn({[`${o}-track`]:!0,[`${o}-track-${z}`]:!0});return le(aT,{class:F,vertical:d,reverse:c,included:y,offset:w[z-1],length:w[z]-w[z-1],style:i[L],key:z},null)})},renderSlider(){const{sHandle:e,bounds:t,prefixCls:o,vertical:c,included:d,disabled:y,min:w,max:i,reverse:O,handle:L,defaultHandle:z,trackStyle:F,handleStyle:N,tabindex:G,ariaLabelGroupForHandles:Y,ariaLabelledByGroupForHandles:K,ariaValueTextFormatterGroupForHandles:J}=this,X=L||z,se=t.map(ue=>this.calcOffset(ue)),te=`${o}-handle`,ne=t.map((ue,ge)=>{let ee=G[ge]||0;(y||G[ge]===null)&&(ee=null);const be=e===ge;return X({class:hn({[te]:!0,[`${te}-${ge+1}`]:!0,[`${te}-dragging`]:be}),prefixCls:o,vertical:c,dragging:be,offset:se[ge],value:ue,index:ge,tabindex:ee,min:w,max:i,reverse:O,disabled:y,style:N[ge],ref:Ie=>this.saveHandle(ge,Ie),onFocus:this.onFocus,onBlur:this.onBlur,ariaLabel:Y[ge],ariaLabelledBy:K[ge],ariaValueTextFormatter:J[ge]})});return{tracks:this.getTrack({bounds:t,prefixCls:o,reverse:O,vertical:c,included:d,offsets:se,trackStyle:F}),handles:ne}}}}),bre=k$(xre),wre=cn({compatConfig:{MODE:3},name:"SliderTooltip",inheritAttrs:!1,props:i4(),setup(e,t){let{attrs:o,slots:c}=t;const d=tn(null),y=tn(null);function w(){qr.cancel(y.value),y.value=null}function i(){y.value=qr(()=>{var L;(L=d.value)===null||L===void 0||L.forcePopupAlign(),y.value=null})}const O=()=>{w(),e.open&&i()};return On([()=>e.open,()=>e.title],()=>{O()},{flush:"post",immediate:!0}),WD(()=>{O()}),fi(()=>{w()}),()=>le(MC,it(it({ref:d},e),o),c)}}),Sre=e=>{const{componentCls:t,controlSize:o,dotSize:c,marginFull:d,marginPart:y,colorFillContentHover:w}=e;return{[t]:re(re({},Ei(e)),{position:"relative",height:o,margin:`${y}px ${d}px`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${d}px ${y}px`},[`${t}-rail`]:{position:"absolute",backgroundColor:e.colorFillTertiary,borderRadius:e.borderRadiusXS,transition:`background-color ${e.motionDurationMid}`},[`${t}-track`]:{position:"absolute",backgroundColor:e.colorPrimaryBorder,borderRadius:e.borderRadiusXS,transition:`background-color ${e.motionDurationMid}`},"&:hover":{[`${t}-rail`]:{backgroundColor:e.colorFillSecondary},[`${t}-track`]:{backgroundColor:e.colorPrimaryBorderHover},[`${t}-dot`]:{borderColor:w},[`${t}-handle::after`]:{boxShadow:`0 0 0 ${e.handleLineWidth}px ${e.colorPrimaryBorderHover}`},[`${t}-dot-active`]:{borderColor:e.colorPrimary}},[`${t}-handle`]:{position:"absolute",width:e.handleSize,height:e.handleSize,outline:"none",[`${t}-dragging`]:{zIndex:1},"&::before":{content:'""',position:"absolute",insetInlineStart:-e.handleLineWidth,insetBlockStart:-e.handleLineWidth,width:e.handleSize+e.handleLineWidth*2,height:e.handleSize+e.handleLineWidth*2,backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:e.handleSize,height:e.handleSize,backgroundColor:e.colorBgElevated,boxShadow:`0 0 0 ${e.handleLineWidth}px ${e.colorPrimaryBorder}`,borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${e.motionDurationMid},
            inset-block-start ${e.motionDurationMid},
            width ${e.motionDurationMid},
            height ${e.motionDurationMid},
            box-shadow ${e.motionDurationMid}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:-((e.handleSizeHover-e.handleSize)/2+e.handleLineWidthHover),insetBlockStart:-((e.handleSizeHover-e.handleSize)/2+e.handleLineWidthHover),width:e.handleSizeHover+e.handleLineWidthHover*2,height:e.handleSizeHover+e.handleLineWidthHover*2},"&::after":{boxShadow:`0 0 0 ${e.handleLineWidthHover}px ${e.colorPrimary}`,width:e.handleSizeHover,height:e.handleSizeHover,insetInlineStart:(e.handleSize-e.handleSizeHover)/2,insetBlockStart:(e.handleSize-e.handleSizeHover)/2}}},[`${t}-mark`]:{position:"absolute",fontSize:e.fontSize},[`${t}-mark-text`]:{position:"absolute",display:"inline-block",color:e.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:e.colorText}},[`${t}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${t}-dot`]:{position:"absolute",width:c,height:c,backgroundColor:e.colorBgElevated,border:`${e.handleLineWidth}px solid ${e.colorBorderSecondary}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,"&-active":{borderColor:e.colorPrimaryBorder}},[`&${t}-disabled`]:{cursor:"not-allowed",[`${t}-rail`]:{backgroundColor:`${e.colorFillSecondary} !important`},[`${t}-track`]:{backgroundColor:`${e.colorTextDisabled} !important`},[`
          ${t}-dot
        `]:{backgroundColor:e.colorBgElevated,borderColor:e.colorTextDisabled,boxShadow:"none",cursor:"not-allowed"},[`${t}-handle::after`]:{backgroundColor:e.colorBgElevated,cursor:"not-allowed",width:e.handleSize,height:e.handleSize,boxShadow:`0 0 0 ${e.handleLineWidth}px ${new qi(e.colorTextDisabled).onBackground(e.colorBgContainer).toHexString()}`,insetInlineStart:0,insetBlockStart:0},[`
          ${t}-mark-text,
          ${t}-dot
        `]:{cursor:"not-allowed !important"}}})}},N$=(e,t)=>{const{componentCls:o,railSize:c,handleSize:d,dotSize:y}=e,w=t?"paddingBlock":"paddingInline",i=t?"width":"height",O=t?"height":"width",L=t?"insetBlockStart":"insetInlineStart",z=t?"top":"insetInlineStart";return{[w]:c,[O]:c*3,[`${o}-rail`]:{[i]:"100%",[O]:c},[`${o}-track`]:{[O]:c},[`${o}-handle`]:{[L]:(c*3-d)/2},[`${o}-mark`]:{insetInlineStart:0,top:0,[z]:d,[i]:"100%"},[`${o}-step`]:{insetInlineStart:0,top:0,[z]:c,[i]:"100%",[O]:c},[`${o}-dot`]:{position:"absolute",[L]:(c-y)/2}}},Cre=e=>{const{componentCls:t,marginPartWithMark:o}=e;return{[`${t}-horizontal`]:re(re({},N$(e,!0)),{[`&${t}-with-marks`]:{marginBottom:o}})}},Tre=e=>{const{componentCls:t}=e;return{[`${t}-vertical`]:re(re({},N$(e,!1)),{height:"100%"})}},Ere=Ui("Slider",e=>{const t=Wr(e,{marginPart:(e.controlHeight-e.controlSize)/2,marginFull:e.controlSize/2,marginPartWithMark:e.controlHeightLG-e.controlSize});return[Sre(t),Cre(t),Tre(t)]},e=>{const o=e.controlHeightLG/4,c=e.controlHeightSM/2,d=e.lineWidth+1,y=e.lineWidth+1*3;return{controlSize:o,railSize:4,handleSize:o,handleSizeHover:c,dotSize:8,handleLineWidth:d,handleLineWidthHover:y}});var NO=function(e,t){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)t.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(o[c[d]]=e[c[d]]);return o};const Mre=e=>typeof e=="number"?e.toString():"",Ire=()=>({id:String,prefixCls:String,tooltipPrefixCls:String,range:Mo([Boolean,Object]),reverse:Cr(),min:Number,max:Number,step:Mo([Object,Number]),marks:oi(),dots:Cr(),value:Mo([Array,Number]),defaultValue:Mo([Array,Number]),included:Cr(),disabled:Cr(),vertical:Cr(),tipFormatter:Mo([Function,Object],()=>Mre),tooltipOpen:Cr(),tooltipVisible:Cr(),tooltipPlacement:Io(),getTooltipPopupContainer:Jr(),autofocus:Cr(),handleStyle:Mo([Array,Object]),trackStyle:Mo([Array,Object]),onChange:Jr(),onAfterChange:Jr(),onFocus:Jr(),onBlur:Jr(),"onUpdate:value":Jr()}),Are=cn({compatConfig:{MODE:3},name:"ASlider",inheritAttrs:!1,props:Ire(),slots:Object,setup(e,t){let{attrs:o,slots:c,emit:d,expose:y}=t;const{prefixCls:w,rootPrefixCls:i,direction:O,getPopupContainer:L,configProvider:z}=Rr("slider",e),[F,N]=Ere(w),G=Ic(),Y=tn(),K=tn({}),J=(ee,be)=>{K.value[ee]=be},X=He(()=>e.tooltipPlacement?e.tooltipPlacement:e.vertical?O.value==="rtl"?"left":"right":"top"),se=()=>{var ee;(ee=Y.value)===null||ee===void 0||ee.focus()},te=()=>{var ee;(ee=Y.value)===null||ee===void 0||ee.blur()},ne=ee=>{d("update:value",ee),d("change",ee),G.onFieldChange()},ue=ee=>{d("blur",ee)};y({focus:se,blur:te});const ge=ee=>{var{tooltipPrefixCls:be}=ee,Ie=ee.info,{value:Ee,dragging:Re,index:Qe}=Ie,et=NO(Ie,["value","dragging","index"]);const{tipFormatter:We,tooltipOpen:me=e.tooltipVisible,getTooltipPopupContainer:Oe}=e,Fe=We?K.value[Qe]||Re:!1,Ke=me||me===void 0&&Fe;return le(wre,{prefixCls:be,title:We?We(Ee):"",open:Ke,placement:X.value,transitionName:`${i.value}-zoom-down`,key:Qe,overlayClassName:`${w.value}-tooltip`,getPopupContainer:Oe||(L==null?void 0:L.value)},{default:()=>[le(z$,it(it({},et),{},{value:Ee,onMouseenter:()=>J(Qe,!0),onMouseleave:()=>J(Qe,!1)}),null)]})};return()=>{const{tooltipPrefixCls:ee,range:be,id:Ie=G.id.value}=e,Ee=NO(e,["tooltipPrefixCls","range","id"]),Re=z.getPrefixCls("tooltip",ee),Qe=hn(o.class,{[`${w.value}-rtl`]:O.value==="rtl"},N.value);O.value==="rtl"&&!Ee.vertical&&(Ee.reverse=!Ee.reverse);let et;return typeof be=="object"&&(et=be.draggableTrack),F(be?le(bre,it(it(it({},o),Ee),{},{step:Ee.step,draggableTrack:et,class:Qe,ref:Y,handle:We=>ge({tooltipPrefixCls:Re,prefixCls:w.value,info:We}),prefixCls:w.value,onChange:ne,onBlur:ue}),{mark:c.mark}):le(yre,it(it(it({},o),Ee),{},{id:Ie,step:Ee.step,class:Qe,ref:Y,handle:We=>ge({tooltipPrefixCls:Re,prefixCls:w.value,info:We}),prefixCls:w.value,onChange:ne,onBlur:ue}),{mark:c.mark}))}}}),Pre=Pl(Are);var Ore={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 158H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 424H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 212H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"align-right",theme:"outlined"};function VO(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),c.forEach(function(d){Dre(e,d,o[d])})}return e}function Dre(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var lT=function(t,o){var c=VO({},t,o.attrs);return le(Hi,VO({},c,{icon:Ore}),null)};lT.displayName="AlignRightOutlined";lT.inheritAttrs=!1;var gv={exports:{}},Rre=gv.exports,jO;function zre(){return jO||(jO=1,function(e,t){(function(o,c){e.exports=c()})(Rre,function(){var o,c,d;function y(i,O){if(!o)o=O;else if(!c)c=O;else{var L="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",z={};o(z),d=O(z),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}y(["exports"],function(i){function O(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var L,z={},F={};function N(){if(L)return F;L=1,Object.defineProperty(F,"__esModule",{value:!0}),F.setMatrixArrayType=function(m){F.ARRAY_TYPE=n=m},F.toRadian=function(m){return m*u},F.equals=function(m,h){return Math.abs(m-h)<=l*Math.max(1,Math.abs(m),Math.abs(h))},F.RANDOM=F.ARRAY_TYPE=F.EPSILON=void 0;var l=1e-6;F.EPSILON=l;var n=typeof Float32Array<"u"?Float32Array:Array;F.ARRAY_TYPE=n;var a=Math.random;F.RANDOM=a;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)}),F}var G,Y={};function K(){if(G)return Y;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}G=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},Y.clone=function(h){var g=new n.ARRAY_TYPE(4);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g},Y.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h},Y.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},Y.fromValues=function(h,g,b,T){var P=new n.ARRAY_TYPE(4);return P[0]=h,P[1]=g,P[2]=b,P[3]=T,P},Y.set=function(h,g,b,T,P){return h[0]=g,h[1]=b,h[2]=T,h[3]=P,h},Y.transpose=function(h,g){if(h===g){var b=g[1];h[1]=g[2],h[2]=b}else h[0]=g[0],h[1]=g[2],h[2]=g[1],h[3]=g[3];return h},Y.invert=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=b*v-P*T;return E?(h[0]=v*(E=1/E),h[1]=-T*E,h[2]=-P*E,h[3]=b*E,h):null},Y.adjoint=function(h,g){var b=g[0];return h[0]=g[3],h[1]=-g[1],h[2]=-g[2],h[3]=b,h},Y.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},Y.multiply=u,Y.rotate=function(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=Math.sin(b),C=Math.cos(b);return h[0]=T*C+v*A,h[1]=P*C+E*A,h[2]=T*-A+v*C,h[3]=P*-A+E*C,h},Y.scale=function(h,g,b){var T=g[1],P=g[2],v=g[3],E=b[0],A=b[1];return h[0]=g[0]*E,h[1]=T*E,h[2]=P*A,h[3]=v*A,h},Y.fromRotation=function(h,g){var b=Math.sin(g),T=Math.cos(g);return h[0]=T,h[1]=b,h[2]=-b,h[3]=T,h},Y.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h},Y.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},Y.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},Y.LDU=function(h,g,b,T){return h[2]=T[2]/T[0],b[0]=T[0],b[1]=T[1],b[3]=T[3]-h[2]*b[1],[h,g,b]},Y.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h},Y.subtract=m,Y.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]},Y.equals=function(h,g){var b=h[0],T=h[1],P=h[2],v=h[3],E=g[0],A=g[1],C=g[2],M=g[3];return Math.abs(b-E)<=n.EPSILON*Math.max(1,Math.abs(b),Math.abs(E))&&Math.abs(T-A)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(A))&&Math.abs(P-C)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(C))&&Math.abs(v-M)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))},Y.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h},Y.multiplyScalarAndAdd=function(h,g,b,T){return h[0]=g[0]+b[0]*T,h[1]=g[1]+b[1]*T,h[2]=g[2]+b[2]*T,h[3]=g[3]+b[3]*T,h},Y.sub=Y.mul=void 0;var n=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=a(void 0);if(b&&b.has(h))return b.get(h);var T={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=P?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(T,v,E):T[v]=h[v]}return T.default=h,b&&b.set(h,T),T}(N());function a(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(a=function(T){return T?b:g})(h)}function u(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=b[0],C=b[1],M=b[2],D=b[3];return h[0]=T*A+v*C,h[1]=P*A+E*C,h[2]=T*M+v*D,h[3]=P*M+E*D,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h}return Y.mul=u,Y.sub=m,Y}var J,X={};function se(){if(J)return X;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}J=1,Object.defineProperty(X,"__esModule",{value:!0}),X.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},X.clone=function(h){var g=new n.ARRAY_TYPE(6);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g},X.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h},X.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},X.fromValues=function(h,g,b,T,P,v){var E=new n.ARRAY_TYPE(6);return E[0]=h,E[1]=g,E[2]=b,E[3]=T,E[4]=P,E[5]=v,E},X.set=function(h,g,b,T,P,v,E){return h[0]=g,h[1]=b,h[2]=T,h[3]=P,h[4]=v,h[5]=E,h},X.invert=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=g[4],A=g[5],C=b*v-T*P;return C?(h[0]=v*(C=1/C),h[1]=-T*C,h[2]=-P*C,h[3]=b*C,h[4]=(P*A-v*E)*C,h[5]=(T*E-b*A)*C,h):null},X.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},X.multiply=u,X.rotate=function(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=Math.sin(b),D=Math.cos(b);return h[0]=T*D+v*M,h[1]=P*D+E*M,h[2]=T*-M+v*D,h[3]=P*-M+E*D,h[4]=A,h[5]=C,h},X.scale=function(h,g,b){var T=g[1],P=g[2],v=g[3],E=g[4],A=g[5],C=b[0],M=b[1];return h[0]=g[0]*C,h[1]=T*C,h[2]=P*M,h[3]=v*M,h[4]=E,h[5]=A,h},X.translate=function(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=b[0],D=b[1];return h[0]=T,h[1]=P,h[2]=v,h[3]=E,h[4]=T*M+v*D+A,h[5]=P*M+E*D+C,h},X.fromRotation=function(h,g){var b=Math.sin(g),T=Math.cos(g);return h[0]=T,h[1]=b,h[2]=-b,h[3]=T,h[4]=0,h[5]=0,h},X.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h[4]=0,h[5]=0,h},X.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=g[0],h[5]=g[1],h},X.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},X.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},X.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h[4]=g[4]+b[4],h[5]=g[5]+b[5],h},X.subtract=m,X.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h[4]=g[4]*b,h[5]=g[5]*b,h},X.multiplyScalarAndAdd=function(h,g,b,T){return h[0]=g[0]+b[0]*T,h[1]=g[1]+b[1]*T,h[2]=g[2]+b[2]*T,h[3]=g[3]+b[3]*T,h[4]=g[4]+b[4]*T,h[5]=g[5]+b[5]*T,h},X.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]},X.equals=function(h,g){var b=h[0],T=h[1],P=h[2],v=h[3],E=h[4],A=h[5],C=g[0],M=g[1],D=g[2],k=g[3],V=g[4],W=g[5];return Math.abs(b-C)<=n.EPSILON*Math.max(1,Math.abs(b),Math.abs(C))&&Math.abs(T-M)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(M))&&Math.abs(P-D)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(D))&&Math.abs(v-k)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(E-V)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(V))&&Math.abs(A-W)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(W))},X.sub=X.mul=void 0;var n=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=a(void 0);if(b&&b.has(h))return b.get(h);var T={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=P?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(T,v,E):T[v]=h[v]}return T.default=h,b&&b.set(h,T),T}(N());function a(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(a=function(T){return T?b:g})(h)}function u(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=b[0],D=b[1],k=b[2],V=b[3],W=b[4],Z=b[5];return h[0]=T*M+v*D,h[1]=P*M+E*D,h[2]=T*k+v*V,h[3]=P*k+E*V,h[4]=T*W+v*Z+A,h[5]=P*W+E*Z+C,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h[4]=g[4]-b[4],h[5]=g[5]-b[5],h}return X.mul=u,X.sub=m,X}var te,ne={};function ue(){if(te)return ne;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}te=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},ne.fromMat4=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[4],h[4]=g[5],h[5]=g[6],h[6]=g[8],h[7]=g[9],h[8]=g[10],h},ne.clone=function(h){var g=new n.ARRAY_TYPE(9);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g[6]=h[6],g[7]=h[7],g[8]=h[8],g},ne.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},ne.fromValues=function(h,g,b,T,P,v,E,A,C){var M=new n.ARRAY_TYPE(9);return M[0]=h,M[1]=g,M[2]=b,M[3]=T,M[4]=P,M[5]=v,M[6]=E,M[7]=A,M[8]=C,M},ne.set=function(h,g,b,T,P,v,E,A,C,M){return h[0]=g,h[1]=b,h[2]=T,h[3]=P,h[4]=v,h[5]=E,h[6]=A,h[7]=C,h[8]=M,h},ne.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ne.transpose=function(h,g){if(h===g){var b=g[1],T=g[2],P=g[5];h[1]=g[3],h[2]=g[6],h[3]=b,h[5]=g[7],h[6]=T,h[7]=P}else h[0]=g[0],h[1]=g[3],h[2]=g[6],h[3]=g[1],h[4]=g[4],h[5]=g[7],h[6]=g[2],h[7]=g[5],h[8]=g[8];return h},ne.invert=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=g[4],A=g[5],C=g[6],M=g[7],D=g[8],k=D*E-A*M,V=-D*v+A*C,W=M*v-E*C,Z=b*k+T*V+P*W;return Z?(h[0]=k*(Z=1/Z),h[1]=(-D*T+P*M)*Z,h[2]=(A*T-P*E)*Z,h[3]=V*Z,h[4]=(D*b-P*C)*Z,h[5]=(-A*b+P*v)*Z,h[6]=W*Z,h[7]=(-M*b+T*C)*Z,h[8]=(E*b-T*v)*Z,h):null},ne.adjoint=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=g[4],A=g[5],C=g[6],M=g[7],D=g[8];return h[0]=E*D-A*M,h[1]=P*M-T*D,h[2]=T*A-P*E,h[3]=A*C-v*D,h[4]=b*D-P*C,h[5]=P*v-b*A,h[6]=v*M-E*C,h[7]=T*C-b*M,h[8]=b*E-T*v,h},ne.determinant=function(h){var g=h[3],b=h[4],T=h[5],P=h[6],v=h[7],E=h[8];return h[0]*(E*b-T*v)+h[1]*(-E*g+T*P)+h[2]*(v*g-b*P)},ne.multiply=u,ne.translate=function(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=g[6],D=g[7],k=g[8],V=b[0],W=b[1];return h[0]=T,h[1]=P,h[2]=v,h[3]=E,h[4]=A,h[5]=C,h[6]=V*T+W*E+M,h[7]=V*P+W*A+D,h[8]=V*v+W*C+k,h},ne.rotate=function(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=g[6],D=g[7],k=g[8],V=Math.sin(b),W=Math.cos(b);return h[0]=W*T+V*E,h[1]=W*P+V*A,h[2]=W*v+V*C,h[3]=W*E-V*T,h[4]=W*A-V*P,h[5]=W*C-V*v,h[6]=M,h[7]=D,h[8]=k,h},ne.scale=function(h,g,b){var T=b[0],P=b[1];return h[0]=T*g[0],h[1]=T*g[1],h[2]=T*g[2],h[3]=P*g[3],h[4]=P*g[4],h[5]=P*g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},ne.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=g[0],h[7]=g[1],h[8]=1,h},ne.fromRotation=function(h,g){var b=Math.sin(g),T=Math.cos(g);return h[0]=T,h[1]=b,h[2]=0,h[3]=-b,h[4]=T,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ne.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=0,h[4]=g[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ne.fromMat2d=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=0,h[3]=g[2],h[4]=g[3],h[5]=0,h[6]=g[4],h[7]=g[5],h[8]=1,h},ne.fromQuat=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=b+b,A=T+T,C=P+P,M=b*E,D=T*E,k=T*A,V=P*E,W=P*A,Z=P*C,H=v*E,Q=v*A,oe=v*C;return h[0]=1-k-Z,h[3]=D-oe,h[6]=V+Q,h[1]=D+oe,h[4]=1-M-Z,h[7]=W-H,h[2]=V-Q,h[5]=W+H,h[8]=1-M-k,h},ne.normalFromMat4=function(h,g){var b=g[0],T=g[1],P=g[2],v=g[3],E=g[4],A=g[5],C=g[6],M=g[7],D=g[8],k=g[9],V=g[10],W=g[11],Z=g[12],H=g[13],Q=g[14],oe=g[15],fe=b*A-T*E,Se=b*C-P*E,we=b*M-v*E,xe=T*C-P*A,ke=T*M-v*A,Ce=P*M-v*C,Ne=D*H-k*Z,Ze=D*Q-V*Z,Ge=D*oe-W*Z,Je=k*Q-V*H,rt=k*oe-W*H,lt=V*oe-W*Q,nt=fe*lt-Se*rt+we*Je+xe*Ge-ke*Ze+Ce*Ne;return nt?(h[0]=(A*lt-C*rt+M*Je)*(nt=1/nt),h[1]=(C*Ge-E*lt-M*Ze)*nt,h[2]=(E*rt-A*Ge+M*Ne)*nt,h[3]=(P*rt-T*lt-v*Je)*nt,h[4]=(b*lt-P*Ge+v*Ze)*nt,h[5]=(T*Ge-b*rt-v*Ne)*nt,h[6]=(H*Ce-Q*ke+oe*xe)*nt,h[7]=(Q*we-Z*Ce-oe*Se)*nt,h[8]=(Z*ke-H*we+oe*fe)*nt,h):null},ne.projection=function(h,g,b){return h[0]=2/g,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/b,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},ne.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},ne.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},ne.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h[4]=g[4]+b[4],h[5]=g[5]+b[5],h[6]=g[6]+b[6],h[7]=g[7]+b[7],h[8]=g[8]+b[8],h},ne.subtract=m,ne.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h[4]=g[4]*b,h[5]=g[5]*b,h[6]=g[6]*b,h[7]=g[7]*b,h[8]=g[8]*b,h},ne.multiplyScalarAndAdd=function(h,g,b,T){return h[0]=g[0]+b[0]*T,h[1]=g[1]+b[1]*T,h[2]=g[2]+b[2]*T,h[3]=g[3]+b[3]*T,h[4]=g[4]+b[4]*T,h[5]=g[5]+b[5]*T,h[6]=g[6]+b[6]*T,h[7]=g[7]+b[7]*T,h[8]=g[8]+b[8]*T,h},ne.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]&&h[6]===g[6]&&h[7]===g[7]&&h[8]===g[8]},ne.equals=function(h,g){var b=h[0],T=h[1],P=h[2],v=h[3],E=h[4],A=h[5],C=h[6],M=h[7],D=h[8],k=g[0],V=g[1],W=g[2],Z=g[3],H=g[4],Q=g[5],oe=g[6],fe=g[7],Se=g[8];return Math.abs(b-k)<=n.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))&&Math.abs(T-V)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(V))&&Math.abs(P-W)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(W))&&Math.abs(v-Z)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(Z))&&Math.abs(E-H)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(H))&&Math.abs(A-Q)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(Q))&&Math.abs(C-oe)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(oe))&&Math.abs(M-fe)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(fe))&&Math.abs(D-Se)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(Se))},ne.sub=ne.mul=void 0;var n=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=a(void 0);if(b&&b.has(h))return b.get(h);var T={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var E=P?Object.getOwnPropertyDescriptor(h,v):null;E&&(E.get||E.set)?Object.defineProperty(T,v,E):T[v]=h[v]}return T.default=h,b&&b.set(h,T),T}(N());function a(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(a=function(T){return T?b:g})(h)}function u(h,g,b){var T=g[0],P=g[1],v=g[2],E=g[3],A=g[4],C=g[5],M=g[6],D=g[7],k=g[8],V=b[0],W=b[1],Z=b[2],H=b[3],Q=b[4],oe=b[5],fe=b[6],Se=b[7],we=b[8];return h[0]=V*T+W*E+Z*M,h[1]=V*P+W*A+Z*D,h[2]=V*v+W*C+Z*k,h[3]=H*T+Q*E+oe*M,h[4]=H*P+Q*A+oe*D,h[5]=H*v+Q*C+oe*k,h[6]=fe*T+Se*E+we*M,h[7]=fe*P+Se*A+we*D,h[8]=fe*v+Se*C+we*k,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h[4]=g[4]-b[4],h[5]=g[5]-b[5],h[6]=g[6]-b[6],h[7]=g[7]-b[7],h[8]=g[8]-b[8],h}return ne.mul=u,ne.sub=m,ne}var ge,ee={};function be(){if(ge)return ee;function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(v)}ge=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.create=function(){var v=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v},ee.clone=function(v){var E=new n.ARRAY_TYPE(16);return E[0]=v[0],E[1]=v[1],E[2]=v[2],E[3]=v[3],E[4]=v[4],E[5]=v[5],E[6]=v[6],E[7]=v[7],E[8]=v[8],E[9]=v[9],E[10]=v[10],E[11]=v[11],E[12]=v[12],E[13]=v[13],E[14]=v[14],E[15]=v[15],E},ee.copy=function(v,E){return v[0]=E[0],v[1]=E[1],v[2]=E[2],v[3]=E[3],v[4]=E[4],v[5]=E[5],v[6]=E[6],v[7]=E[7],v[8]=E[8],v[9]=E[9],v[10]=E[10],v[11]=E[11],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15],v},ee.fromValues=function(v,E,A,C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we){var xe=new n.ARRAY_TYPE(16);return xe[0]=v,xe[1]=E,xe[2]=A,xe[3]=C,xe[4]=M,xe[5]=D,xe[6]=k,xe[7]=V,xe[8]=W,xe[9]=Z,xe[10]=H,xe[11]=Q,xe[12]=oe,xe[13]=fe,xe[14]=Se,xe[15]=we,xe},ee.set=function(v,E,A,C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we,xe){return v[0]=E,v[1]=A,v[2]=C,v[3]=M,v[4]=D,v[5]=k,v[6]=V,v[7]=W,v[8]=Z,v[9]=H,v[10]=Q,v[11]=oe,v[12]=fe,v[13]=Se,v[14]=we,v[15]=xe,v},ee.identity=u,ee.transpose=function(v,E){if(v===E){var A=E[1],C=E[2],M=E[3],D=E[6],k=E[7],V=E[11];v[1]=E[4],v[2]=E[8],v[3]=E[12],v[4]=A,v[6]=E[9],v[7]=E[13],v[8]=C,v[9]=D,v[11]=E[14],v[12]=M,v[13]=k,v[14]=V}else v[0]=E[0],v[1]=E[4],v[2]=E[8],v[3]=E[12],v[4]=E[1],v[5]=E[5],v[6]=E[9],v[7]=E[13],v[8]=E[2],v[9]=E[6],v[10]=E[10],v[11]=E[14],v[12]=E[3],v[13]=E[7],v[14]=E[11],v[15]=E[15];return v},ee.invert=function(v,E){var A=E[0],C=E[1],M=E[2],D=E[3],k=E[4],V=E[5],W=E[6],Z=E[7],H=E[8],Q=E[9],oe=E[10],fe=E[11],Se=E[12],we=E[13],xe=E[14],ke=E[15],Ce=A*V-C*k,Ne=A*W-M*k,Ze=A*Z-D*k,Ge=C*W-M*V,Je=C*Z-D*V,rt=M*Z-D*W,lt=H*we-Q*Se,nt=H*xe-oe*Se,xt=H*ke-fe*Se,Dt=Q*xe-oe*we,vt=Q*ke-fe*we,Jt=oe*ke-fe*xe,Zt=Ce*Jt-Ne*vt+Ze*Dt+Ge*xt-Je*nt+rt*lt;return Zt?(v[0]=(V*Jt-W*vt+Z*Dt)*(Zt=1/Zt),v[1]=(M*vt-C*Jt-D*Dt)*Zt,v[2]=(we*rt-xe*Je+ke*Ge)*Zt,v[3]=(oe*Je-Q*rt-fe*Ge)*Zt,v[4]=(W*xt-k*Jt-Z*nt)*Zt,v[5]=(A*Jt-M*xt+D*nt)*Zt,v[6]=(xe*Ze-Se*rt-ke*Ne)*Zt,v[7]=(H*rt-oe*Ze+fe*Ne)*Zt,v[8]=(k*vt-V*xt+Z*lt)*Zt,v[9]=(C*xt-A*vt-D*lt)*Zt,v[10]=(Se*Je-we*Ze+ke*Ce)*Zt,v[11]=(Q*Ze-H*Je-fe*Ce)*Zt,v[12]=(V*nt-k*Dt-W*lt)*Zt,v[13]=(A*Dt-C*nt+M*lt)*Zt,v[14]=(we*Ne-Se*Ge-xe*Ce)*Zt,v[15]=(H*Ge-Q*Ne+oe*Ce)*Zt,v):null},ee.adjoint=function(v,E){var A=E[0],C=E[1],M=E[2],D=E[3],k=E[4],V=E[5],W=E[6],Z=E[7],H=E[8],Q=E[9],oe=E[10],fe=E[11],Se=E[12],we=E[13],xe=E[14],ke=E[15];return v[0]=V*(oe*ke-fe*xe)-Q*(W*ke-Z*xe)+we*(W*fe-Z*oe),v[1]=-(C*(oe*ke-fe*xe)-Q*(M*ke-D*xe)+we*(M*fe-D*oe)),v[2]=C*(W*ke-Z*xe)-V*(M*ke-D*xe)+we*(M*Z-D*W),v[3]=-(C*(W*fe-Z*oe)-V*(M*fe-D*oe)+Q*(M*Z-D*W)),v[4]=-(k*(oe*ke-fe*xe)-H*(W*ke-Z*xe)+Se*(W*fe-Z*oe)),v[5]=A*(oe*ke-fe*xe)-H*(M*ke-D*xe)+Se*(M*fe-D*oe),v[6]=-(A*(W*ke-Z*xe)-k*(M*ke-D*xe)+Se*(M*Z-D*W)),v[7]=A*(W*fe-Z*oe)-k*(M*fe-D*oe)+H*(M*Z-D*W),v[8]=k*(Q*ke-fe*we)-H*(V*ke-Z*we)+Se*(V*fe-Z*Q),v[9]=-(A*(Q*ke-fe*we)-H*(C*ke-D*we)+Se*(C*fe-D*Q)),v[10]=A*(V*ke-Z*we)-k*(C*ke-D*we)+Se*(C*Z-D*V),v[11]=-(A*(V*fe-Z*Q)-k*(C*fe-D*Q)+H*(C*Z-D*V)),v[12]=-(k*(Q*xe-oe*we)-H*(V*xe-W*we)+Se*(V*oe-W*Q)),v[13]=A*(Q*xe-oe*we)-H*(C*xe-M*we)+Se*(C*oe-M*Q),v[14]=-(A*(V*xe-W*we)-k*(C*xe-M*we)+Se*(C*W-M*V)),v[15]=A*(V*oe-W*Q)-k*(C*oe-M*Q)+H*(C*W-M*V),v},ee.determinant=function(v){var E=v[0],A=v[1],C=v[2],M=v[3],D=v[4],k=v[5],V=v[6],W=v[7],Z=v[8],H=v[9],Q=v[10],oe=v[11],fe=v[12],Se=v[13],we=v[14],xe=v[15];return(E*k-A*D)*(Q*xe-oe*we)-(E*V-C*D)*(H*xe-oe*Se)+(E*W-M*D)*(H*we-Q*Se)+(A*V-C*k)*(Z*xe-oe*fe)-(A*W-M*k)*(Z*we-Q*fe)+(C*W-M*V)*(Z*Se-H*fe)},ee.multiply=m,ee.translate=function(v,E,A){var C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we=A[0],xe=A[1],ke=A[2];return E===v?(v[12]=E[0]*we+E[4]*xe+E[8]*ke+E[12],v[13]=E[1]*we+E[5]*xe+E[9]*ke+E[13],v[14]=E[2]*we+E[6]*xe+E[10]*ke+E[14],v[15]=E[3]*we+E[7]*xe+E[11]*ke+E[15]):(M=E[1],D=E[2],k=E[3],V=E[4],W=E[5],Z=E[6],H=E[7],Q=E[8],oe=E[9],fe=E[10],Se=E[11],v[0]=C=E[0],v[1]=M,v[2]=D,v[3]=k,v[4]=V,v[5]=W,v[6]=Z,v[7]=H,v[8]=Q,v[9]=oe,v[10]=fe,v[11]=Se,v[12]=C*we+V*xe+Q*ke+E[12],v[13]=M*we+W*xe+oe*ke+E[13],v[14]=D*we+Z*xe+fe*ke+E[14],v[15]=k*we+H*xe+Se*ke+E[15]),v},ee.scale=function(v,E,A){var C=A[0],M=A[1],D=A[2];return v[0]=E[0]*C,v[1]=E[1]*C,v[2]=E[2]*C,v[3]=E[3]*C,v[4]=E[4]*M,v[5]=E[5]*M,v[6]=E[6]*M,v[7]=E[7]*M,v[8]=E[8]*D,v[9]=E[9]*D,v[10]=E[10]*D,v[11]=E[11]*D,v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15],v},ee.rotate=function(v,E,A,C){var M,D,k,V,W,Z,H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze,Ge,Je,rt,lt,nt,xt,Dt,vt=C[0],Jt=C[1],Zt=C[2],kt=Math.hypot(vt,Jt,Zt);return kt<n.EPSILON?null:(vt*=kt=1/kt,Jt*=kt,Zt*=kt,M=Math.sin(A),D=Math.cos(A),W=E[1],Z=E[2],H=E[3],oe=E[5],fe=E[6],Se=E[7],xe=E[9],ke=E[10],Ce=E[11],Ne=vt*vt*(k=1-D)+D,Je=vt*Jt*k-Zt*M,rt=Jt*Jt*k+D,lt=Zt*Jt*k+vt*M,nt=vt*Zt*k+Jt*M,xt=Jt*Zt*k-vt*M,Dt=Zt*Zt*k+D,v[0]=(V=E[0])*Ne+(Q=E[4])*(Ze=Jt*vt*k+Zt*M)+(we=E[8])*(Ge=Zt*vt*k-Jt*M),v[1]=W*Ne+oe*Ze+xe*Ge,v[2]=Z*Ne+fe*Ze+ke*Ge,v[3]=H*Ne+Se*Ze+Ce*Ge,v[4]=V*Je+Q*rt+we*lt,v[5]=W*Je+oe*rt+xe*lt,v[6]=Z*Je+fe*rt+ke*lt,v[7]=H*Je+Se*rt+Ce*lt,v[8]=V*nt+Q*xt+we*Dt,v[9]=W*nt+oe*xt+xe*Dt,v[10]=Z*nt+fe*xt+ke*Dt,v[11]=H*nt+Se*xt+Ce*Dt,E!==v&&(v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v)},ee.rotateX=function(v,E,A){var C=Math.sin(A),M=Math.cos(A),D=E[4],k=E[5],V=E[6],W=E[7],Z=E[8],H=E[9],Q=E[10],oe=E[11];return E!==v&&(v[0]=E[0],v[1]=E[1],v[2]=E[2],v[3]=E[3],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[4]=D*M+Z*C,v[5]=k*M+H*C,v[6]=V*M+Q*C,v[7]=W*M+oe*C,v[8]=Z*M-D*C,v[9]=H*M-k*C,v[10]=Q*M-V*C,v[11]=oe*M-W*C,v},ee.rotateY=function(v,E,A){var C=Math.sin(A),M=Math.cos(A),D=E[0],k=E[1],V=E[2],W=E[3],Z=E[8],H=E[9],Q=E[10],oe=E[11];return E!==v&&(v[4]=E[4],v[5]=E[5],v[6]=E[6],v[7]=E[7],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[0]=D*M-Z*C,v[1]=k*M-H*C,v[2]=V*M-Q*C,v[3]=W*M-oe*C,v[8]=D*C+Z*M,v[9]=k*C+H*M,v[10]=V*C+Q*M,v[11]=W*C+oe*M,v},ee.rotateZ=function(v,E,A){var C=Math.sin(A),M=Math.cos(A),D=E[0],k=E[1],V=E[2],W=E[3],Z=E[4],H=E[5],Q=E[6],oe=E[7];return E!==v&&(v[8]=E[8],v[9]=E[9],v[10]=E[10],v[11]=E[11],v[12]=E[12],v[13]=E[13],v[14]=E[14],v[15]=E[15]),v[0]=D*M+Z*C,v[1]=k*M+H*C,v[2]=V*M+Q*C,v[3]=W*M+oe*C,v[4]=Z*M-D*C,v[5]=H*M-k*C,v[6]=Q*M-V*C,v[7]=oe*M-W*C,v},ee.fromTranslation=function(v,E){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=E[0],v[13]=E[1],v[14]=E[2],v[15]=1,v},ee.fromScaling=function(v,E){return v[0]=E[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=E[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=E[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ee.fromRotation=function(v,E,A){var C,M,D,k=A[0],V=A[1],W=A[2],Z=Math.hypot(k,V,W);return Z<n.EPSILON?null:(k*=Z=1/Z,V*=Z,W*=Z,C=Math.sin(E),M=Math.cos(E),v[0]=k*k*(D=1-M)+M,v[1]=V*k*D+W*C,v[2]=W*k*D-V*C,v[3]=0,v[4]=k*V*D-W*C,v[5]=V*V*D+M,v[6]=W*V*D+k*C,v[7]=0,v[8]=k*W*D+V*C,v[9]=V*W*D-k*C,v[10]=W*W*D+M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)},ee.fromXRotation=function(v,E){var A=Math.sin(E),C=Math.cos(E);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=C,v[6]=A,v[7]=0,v[8]=0,v[9]=-A,v[10]=C,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ee.fromYRotation=function(v,E){var A=Math.sin(E),C=Math.cos(E);return v[0]=C,v[1]=0,v[2]=-A,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=A,v[9]=0,v[10]=C,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ee.fromZRotation=function(v,E){var A=Math.sin(E),C=Math.cos(E);return v[0]=C,v[1]=A,v[2]=0,v[3]=0,v[4]=-A,v[5]=C,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ee.fromRotationTranslation=h,ee.fromQuat2=function(v,E){var A=new n.ARRAY_TYPE(3),C=-E[0],M=-E[1],D=-E[2],k=E[3],V=E[4],W=E[5],Z=E[6],H=E[7],Q=C*C+M*M+D*D+k*k;return Q>0?(A[0]=2*(V*k+H*C+W*D-Z*M)/Q,A[1]=2*(W*k+H*M+Z*C-V*D)/Q,A[2]=2*(Z*k+H*D+V*M-W*C)/Q):(A[0]=2*(V*k+H*C+W*D-Z*M),A[1]=2*(W*k+H*M+Z*C-V*D),A[2]=2*(Z*k+H*D+V*M-W*C)),h(v,E,A),v},ee.getTranslation=function(v,E){return v[0]=E[12],v[1]=E[13],v[2]=E[14],v},ee.getScaling=g,ee.getRotation=function(v,E){var A=new n.ARRAY_TYPE(3);g(A,E);var C=1/A[0],M=1/A[1],D=1/A[2],k=E[0]*C,V=E[1]*M,W=E[2]*D,Z=E[4]*C,H=E[5]*M,Q=E[6]*D,oe=E[8]*C,fe=E[9]*M,Se=E[10]*D,we=k+H+Se,xe=0;return we>0?(xe=2*Math.sqrt(we+1),v[3]=.25*xe,v[0]=(Q-fe)/xe,v[1]=(oe-W)/xe,v[2]=(V-Z)/xe):k>H&&k>Se?(xe=2*Math.sqrt(1+k-H-Se),v[3]=(Q-fe)/xe,v[0]=.25*xe,v[1]=(V+Z)/xe,v[2]=(oe+W)/xe):H>Se?(xe=2*Math.sqrt(1+H-k-Se),v[3]=(oe-W)/xe,v[0]=(V+Z)/xe,v[1]=.25*xe,v[2]=(Q+fe)/xe):(xe=2*Math.sqrt(1+Se-k-H),v[3]=(V-Z)/xe,v[0]=(oe+W)/xe,v[1]=(Q+fe)/xe,v[2]=.25*xe),v},ee.fromRotationTranslationScale=function(v,E,A,C){var M=E[0],D=E[1],k=E[2],V=E[3],W=M+M,Z=D+D,H=k+k,Q=M*W,oe=M*Z,fe=M*H,Se=D*Z,we=D*H,xe=k*H,ke=V*W,Ce=V*Z,Ne=V*H,Ze=C[0],Ge=C[1],Je=C[2];return v[0]=(1-(Se+xe))*Ze,v[1]=(oe+Ne)*Ze,v[2]=(fe-Ce)*Ze,v[3]=0,v[4]=(oe-Ne)*Ge,v[5]=(1-(Q+xe))*Ge,v[6]=(we+ke)*Ge,v[7]=0,v[8]=(fe+Ce)*Je,v[9]=(we-ke)*Je,v[10]=(1-(Q+Se))*Je,v[11]=0,v[12]=A[0],v[13]=A[1],v[14]=A[2],v[15]=1,v},ee.fromRotationTranslationScaleOrigin=function(v,E,A,C,M){var D=E[0],k=E[1],V=E[2],W=E[3],Z=D+D,H=k+k,Q=V+V,oe=D*Z,fe=D*H,Se=D*Q,we=k*H,xe=k*Q,ke=V*Q,Ce=W*Z,Ne=W*H,Ze=W*Q,Ge=C[0],Je=C[1],rt=C[2],lt=M[0],nt=M[1],xt=M[2],Dt=(1-(we+ke))*Ge,vt=(fe+Ze)*Ge,Jt=(Se-Ne)*Ge,Zt=(fe-Ze)*Je,kt=(1-(oe+ke))*Je,Rt=(xe+Ce)*Je,mn=(Se+Ne)*rt,en=(xe-Ce)*rt,sn=(1-(oe+we))*rt;return v[0]=Dt,v[1]=vt,v[2]=Jt,v[3]=0,v[4]=Zt,v[5]=kt,v[6]=Rt,v[7]=0,v[8]=mn,v[9]=en,v[10]=sn,v[11]=0,v[12]=A[0]+lt-(Dt*lt+Zt*nt+mn*xt),v[13]=A[1]+nt-(vt*lt+kt*nt+en*xt),v[14]=A[2]+xt-(Jt*lt+Rt*nt+sn*xt),v[15]=1,v},ee.fromQuat=function(v,E){var A=E[0],C=E[1],M=E[2],D=E[3],k=A+A,V=C+C,W=M+M,Z=A*k,H=C*k,Q=C*V,oe=M*k,fe=M*V,Se=M*W,we=D*k,xe=D*V,ke=D*W;return v[0]=1-Q-Se,v[1]=H+ke,v[2]=oe-xe,v[3]=0,v[4]=H-ke,v[5]=1-Z-Se,v[6]=fe+we,v[7]=0,v[8]=oe+xe,v[9]=fe-we,v[10]=1-Z-Q,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},ee.frustum=function(v,E,A,C,M,D,k){var V=1/(A-E),W=1/(M-C),Z=1/(D-k);return v[0]=2*D*V,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=2*D*W,v[6]=0,v[7]=0,v[8]=(A+E)*V,v[9]=(M+C)*W,v[10]=(k+D)*Z,v[11]=-1,v[12]=0,v[13]=0,v[14]=k*D*2*Z,v[15]=0,v},ee.perspectiveNO=b,ee.perspectiveZO=function(v,E,A,C,M){var D,k=1/Math.tan(E/2);return v[0]=k/A,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=k,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=M*(D=1/(C-M)),v[14]=M*C*D):(v[10]=-1,v[14]=-C),v},ee.perspectiveFromFieldOfView=function(v,E,A,C){var M=Math.tan(E.upDegrees*Math.PI/180),D=Math.tan(E.downDegrees*Math.PI/180),k=Math.tan(E.leftDegrees*Math.PI/180),V=Math.tan(E.rightDegrees*Math.PI/180),W=2/(k+V),Z=2/(M+D);return v[0]=W,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=Z,v[6]=0,v[7]=0,v[8]=-(k-V)*W*.5,v[9]=(M-D)*Z*.5,v[10]=C/(A-C),v[11]=-1,v[12]=0,v[13]=0,v[14]=C*A/(A-C),v[15]=0,v},ee.orthoNO=T,ee.orthoZO=function(v,E,A,C,M,D,k){var V=1/(E-A),W=1/(C-M),Z=1/(D-k);return v[0]=-2*V,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*W,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=Z,v[11]=0,v[12]=(E+A)*V,v[13]=(M+C)*W,v[14]=D*Z,v[15]=1,v},ee.lookAt=function(v,E,A,C){var M,D,k,V,W,Z,H,Q,oe,fe,Se=E[0],we=E[1],xe=E[2],ke=C[0],Ce=C[1],Ne=C[2],Ze=A[0],Ge=A[1],Je=A[2];return Math.abs(Se-Ze)<n.EPSILON&&Math.abs(we-Ge)<n.EPSILON&&Math.abs(xe-Je)<n.EPSILON?u(v):(H=Se-Ze,Q=we-Ge,oe=xe-Je,M=Ce*(oe*=fe=1/Math.hypot(H,Q,oe))-Ne*(Q*=fe),D=Ne*(H*=fe)-ke*oe,k=ke*Q-Ce*H,(fe=Math.hypot(M,D,k))?(M*=fe=1/fe,D*=fe,k*=fe):(M=0,D=0,k=0),V=Q*k-oe*D,W=oe*M-H*k,Z=H*D-Q*M,(fe=Math.hypot(V,W,Z))?(V*=fe=1/fe,W*=fe,Z*=fe):(V=0,W=0,Z=0),v[0]=M,v[1]=V,v[2]=H,v[3]=0,v[4]=D,v[5]=W,v[6]=Q,v[7]=0,v[8]=k,v[9]=Z,v[10]=oe,v[11]=0,v[12]=-(M*Se+D*we+k*xe),v[13]=-(V*Se+W*we+Z*xe),v[14]=-(H*Se+Q*we+oe*xe),v[15]=1,v)},ee.targetTo=function(v,E,A,C){var M=E[0],D=E[1],k=E[2],V=C[0],W=C[1],Z=C[2],H=M-A[0],Q=D-A[1],oe=k-A[2],fe=H*H+Q*Q+oe*oe;fe>0&&(H*=fe=1/Math.sqrt(fe),Q*=fe,oe*=fe);var Se=W*oe-Z*Q,we=Z*H-V*oe,xe=V*Q-W*H;return(fe=Se*Se+we*we+xe*xe)>0&&(Se*=fe=1/Math.sqrt(fe),we*=fe,xe*=fe),v[0]=Se,v[1]=we,v[2]=xe,v[3]=0,v[4]=Q*xe-oe*we,v[5]=oe*Se-H*xe,v[6]=H*we-Q*Se,v[7]=0,v[8]=H,v[9]=Q,v[10]=oe,v[11]=0,v[12]=M,v[13]=D,v[14]=k,v[15]=1,v},ee.str=function(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"},ee.frob=function(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])},ee.add=function(v,E,A){return v[0]=E[0]+A[0],v[1]=E[1]+A[1],v[2]=E[2]+A[2],v[3]=E[3]+A[3],v[4]=E[4]+A[4],v[5]=E[5]+A[5],v[6]=E[6]+A[6],v[7]=E[7]+A[7],v[8]=E[8]+A[8],v[9]=E[9]+A[9],v[10]=E[10]+A[10],v[11]=E[11]+A[11],v[12]=E[12]+A[12],v[13]=E[13]+A[13],v[14]=E[14]+A[14],v[15]=E[15]+A[15],v},ee.subtract=P,ee.multiplyScalar=function(v,E,A){return v[0]=E[0]*A,v[1]=E[1]*A,v[2]=E[2]*A,v[3]=E[3]*A,v[4]=E[4]*A,v[5]=E[5]*A,v[6]=E[6]*A,v[7]=E[7]*A,v[8]=E[8]*A,v[9]=E[9]*A,v[10]=E[10]*A,v[11]=E[11]*A,v[12]=E[12]*A,v[13]=E[13]*A,v[14]=E[14]*A,v[15]=E[15]*A,v},ee.multiplyScalarAndAdd=function(v,E,A,C){return v[0]=E[0]+A[0]*C,v[1]=E[1]+A[1]*C,v[2]=E[2]+A[2]*C,v[3]=E[3]+A[3]*C,v[4]=E[4]+A[4]*C,v[5]=E[5]+A[5]*C,v[6]=E[6]+A[6]*C,v[7]=E[7]+A[7]*C,v[8]=E[8]+A[8]*C,v[9]=E[9]+A[9]*C,v[10]=E[10]+A[10]*C,v[11]=E[11]+A[11]*C,v[12]=E[12]+A[12]*C,v[13]=E[13]+A[13]*C,v[14]=E[14]+A[14]*C,v[15]=E[15]+A[15]*C,v},ee.exactEquals=function(v,E){return v[0]===E[0]&&v[1]===E[1]&&v[2]===E[2]&&v[3]===E[3]&&v[4]===E[4]&&v[5]===E[5]&&v[6]===E[6]&&v[7]===E[7]&&v[8]===E[8]&&v[9]===E[9]&&v[10]===E[10]&&v[11]===E[11]&&v[12]===E[12]&&v[13]===E[13]&&v[14]===E[14]&&v[15]===E[15]},ee.equals=function(v,E){var A=v[0],C=v[1],M=v[2],D=v[3],k=v[4],V=v[5],W=v[6],Z=v[7],H=v[8],Q=v[9],oe=v[10],fe=v[11],Se=v[12],we=v[13],xe=v[14],ke=v[15],Ce=E[0],Ne=E[1],Ze=E[2],Ge=E[3],Je=E[4],rt=E[5],lt=E[6],nt=E[7],xt=E[8],Dt=E[9],vt=E[10],Jt=E[11],Zt=E[12],kt=E[13],Rt=E[14],mn=E[15];return Math.abs(A-Ce)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(Ce))&&Math.abs(C-Ne)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(Ne))&&Math.abs(M-Ze)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(Ze))&&Math.abs(D-Ge)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ge))&&Math.abs(k-Je)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Je))&&Math.abs(V-rt)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(rt))&&Math.abs(W-lt)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(lt))&&Math.abs(Z-nt)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(nt))&&Math.abs(H-xt)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(xt))&&Math.abs(Q-Dt)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Dt))&&Math.abs(oe-vt)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(vt))&&Math.abs(fe-Jt)<=n.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Jt))&&Math.abs(Se-Zt)<=n.EPSILON*Math.max(1,Math.abs(Se),Math.abs(Zt))&&Math.abs(we-kt)<=n.EPSILON*Math.max(1,Math.abs(we),Math.abs(kt))&&Math.abs(xe-Rt)<=n.EPSILON*Math.max(1,Math.abs(xe),Math.abs(Rt))&&Math.abs(ke-mn)<=n.EPSILON*Math.max(1,Math.abs(ke),Math.abs(mn))},ee.sub=ee.mul=ee.ortho=ee.perspective=void 0;var n=function(v,E){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var A=a(void 0);if(A&&A.has(v))return A.get(v);var C={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in v)if(D!=="default"&&Object.prototype.hasOwnProperty.call(v,D)){var k=M?Object.getOwnPropertyDescriptor(v,D):null;k&&(k.get||k.set)?Object.defineProperty(C,D,k):C[D]=v[D]}return C.default=v,A&&A.set(v,C),C}(N());function a(v){if(typeof WeakMap!="function")return null;var E=new WeakMap,A=new WeakMap;return(a=function(C){return C?A:E})(v)}function u(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function m(v,E,A){var C=E[0],M=E[1],D=E[2],k=E[3],V=E[4],W=E[5],Z=E[6],H=E[7],Q=E[8],oe=E[9],fe=E[10],Se=E[11],we=E[12],xe=E[13],ke=E[14],Ce=E[15],Ne=A[0],Ze=A[1],Ge=A[2],Je=A[3];return v[0]=Ne*C+Ze*V+Ge*Q+Je*we,v[1]=Ne*M+Ze*W+Ge*oe+Je*xe,v[2]=Ne*D+Ze*Z+Ge*fe+Je*ke,v[3]=Ne*k+Ze*H+Ge*Se+Je*Ce,v[4]=(Ne=A[4])*C+(Ze=A[5])*V+(Ge=A[6])*Q+(Je=A[7])*we,v[5]=Ne*M+Ze*W+Ge*oe+Je*xe,v[6]=Ne*D+Ze*Z+Ge*fe+Je*ke,v[7]=Ne*k+Ze*H+Ge*Se+Je*Ce,v[8]=(Ne=A[8])*C+(Ze=A[9])*V+(Ge=A[10])*Q+(Je=A[11])*we,v[9]=Ne*M+Ze*W+Ge*oe+Je*xe,v[10]=Ne*D+Ze*Z+Ge*fe+Je*ke,v[11]=Ne*k+Ze*H+Ge*Se+Je*Ce,v[12]=(Ne=A[12])*C+(Ze=A[13])*V+(Ge=A[14])*Q+(Je=A[15])*we,v[13]=Ne*M+Ze*W+Ge*oe+Je*xe,v[14]=Ne*D+Ze*Z+Ge*fe+Je*ke,v[15]=Ne*k+Ze*H+Ge*Se+Je*Ce,v}function h(v,E,A){var C=E[0],M=E[1],D=E[2],k=E[3],V=C+C,W=M+M,Z=D+D,H=C*V,Q=C*W,oe=C*Z,fe=M*W,Se=M*Z,we=D*Z,xe=k*V,ke=k*W,Ce=k*Z;return v[0]=1-(fe+we),v[1]=Q+Ce,v[2]=oe-ke,v[3]=0,v[4]=Q-Ce,v[5]=1-(H+we),v[6]=Se+xe,v[7]=0,v[8]=oe+ke,v[9]=Se-xe,v[10]=1-(H+fe),v[11]=0,v[12]=A[0],v[13]=A[1],v[14]=A[2],v[15]=1,v}function g(v,E){var A=E[4],C=E[5],M=E[6],D=E[8],k=E[9],V=E[10];return v[0]=Math.hypot(E[0],E[1],E[2]),v[1]=Math.hypot(A,C,M),v[2]=Math.hypot(D,k,V),v}function b(v,E,A,C,M){var D,k=1/Math.tan(E/2);return v[0]=k/A,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=k,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=(M+C)*(D=1/(C-M)),v[14]=2*M*C*D):(v[10]=-1,v[14]=-2*C),v}function T(v,E,A,C,M,D,k){var V=1/(E-A),W=1/(C-M),Z=1/(D-k);return v[0]=-2*V,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*W,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*Z,v[11]=0,v[12]=(E+A)*V,v[13]=(M+C)*W,v[14]=(k+D)*Z,v[15]=1,v}function P(v,E,A){return v[0]=E[0]-A[0],v[1]=E[1]-A[1],v[2]=E[2]-A[2],v[3]=E[3]-A[3],v[4]=E[4]-A[4],v[5]=E[5]-A[5],v[6]=E[6]-A[6],v[7]=E[7]-A[7],v[8]=E[8]-A[8],v[9]=E[9]-A[9],v[10]=E[10]-A[10],v[11]=E[11]-A[11],v[12]=E[12]-A[12],v[13]=E[13]-A[13],v[14]=E[14]-A[14],v[15]=E[15]-A[15],v}return ee.perspective=b,ee.ortho=T,ee.mul=m,ee.sub=P,ee}var Ie,Ee={},Re={};function Qe(){if(Ie)return Re;function l(M){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},l(M)}Ie=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.create=u,Re.clone=function(M){var D=new n.ARRAY_TYPE(3);return D[0]=M[0],D[1]=M[1],D[2]=M[2],D},Re.length=m,Re.fromValues=function(M,D,k){var V=new n.ARRAY_TYPE(3);return V[0]=M,V[1]=D,V[2]=k,V},Re.copy=function(M,D){return M[0]=D[0],M[1]=D[1],M[2]=D[2],M},Re.set=function(M,D,k,V){return M[0]=D,M[1]=k,M[2]=V,M},Re.add=function(M,D,k){return M[0]=D[0]+k[0],M[1]=D[1]+k[1],M[2]=D[2]+k[2],M},Re.subtract=h,Re.multiply=g,Re.divide=b,Re.ceil=function(M,D){return M[0]=Math.ceil(D[0]),M[1]=Math.ceil(D[1]),M[2]=Math.ceil(D[2]),M},Re.floor=function(M,D){return M[0]=Math.floor(D[0]),M[1]=Math.floor(D[1]),M[2]=Math.floor(D[2]),M},Re.min=function(M,D,k){return M[0]=Math.min(D[0],k[0]),M[1]=Math.min(D[1],k[1]),M[2]=Math.min(D[2],k[2]),M},Re.max=function(M,D,k){return M[0]=Math.max(D[0],k[0]),M[1]=Math.max(D[1],k[1]),M[2]=Math.max(D[2],k[2]),M},Re.round=function(M,D){return M[0]=Math.round(D[0]),M[1]=Math.round(D[1]),M[2]=Math.round(D[2]),M},Re.scale=function(M,D,k){return M[0]=D[0]*k,M[1]=D[1]*k,M[2]=D[2]*k,M},Re.scaleAndAdd=function(M,D,k,V){return M[0]=D[0]+k[0]*V,M[1]=D[1]+k[1]*V,M[2]=D[2]+k[2]*V,M},Re.distance=T,Re.squaredDistance=P,Re.squaredLength=v,Re.negate=function(M,D){return M[0]=-D[0],M[1]=-D[1],M[2]=-D[2],M},Re.inverse=function(M,D){return M[0]=1/D[0],M[1]=1/D[1],M[2]=1/D[2],M},Re.normalize=function(M,D){var k=D[0],V=D[1],W=D[2],Z=k*k+V*V+W*W;return Z>0&&(Z=1/Math.sqrt(Z)),M[0]=D[0]*Z,M[1]=D[1]*Z,M[2]=D[2]*Z,M},Re.dot=E,Re.cross=function(M,D,k){var V=D[0],W=D[1],Z=D[2],H=k[0],Q=k[1],oe=k[2];return M[0]=W*oe-Z*Q,M[1]=Z*H-V*oe,M[2]=V*Q-W*H,M},Re.lerp=function(M,D,k,V){var W=D[0],Z=D[1],H=D[2];return M[0]=W+V*(k[0]-W),M[1]=Z+V*(k[1]-Z),M[2]=H+V*(k[2]-H),M},Re.hermite=function(M,D,k,V,W,Z){var H=Z*Z,Q=H*(2*Z-3)+1,oe=H*(Z-2)+Z,fe=H*(Z-1),Se=H*(3-2*Z);return M[0]=D[0]*Q+k[0]*oe+V[0]*fe+W[0]*Se,M[1]=D[1]*Q+k[1]*oe+V[1]*fe+W[1]*Se,M[2]=D[2]*Q+k[2]*oe+V[2]*fe+W[2]*Se,M},Re.bezier=function(M,D,k,V,W,Z){var H=1-Z,Q=H*H,oe=Z*Z,fe=Q*H,Se=3*Z*Q,we=3*oe*H,xe=oe*Z;return M[0]=D[0]*fe+k[0]*Se+V[0]*we+W[0]*xe,M[1]=D[1]*fe+k[1]*Se+V[1]*we+W[1]*xe,M[2]=D[2]*fe+k[2]*Se+V[2]*we+W[2]*xe,M},Re.random=function(M,D){D=D||1;var k=2*n.RANDOM()*Math.PI,V=2*n.RANDOM()-1,W=Math.sqrt(1-V*V)*D;return M[0]=Math.cos(k)*W,M[1]=Math.sin(k)*W,M[2]=V*D,M},Re.transformMat4=function(M,D,k){var V=D[0],W=D[1],Z=D[2],H=k[3]*V+k[7]*W+k[11]*Z+k[15];return M[0]=(k[0]*V+k[4]*W+k[8]*Z+k[12])/(H=H||1),M[1]=(k[1]*V+k[5]*W+k[9]*Z+k[13])/H,M[2]=(k[2]*V+k[6]*W+k[10]*Z+k[14])/H,M},Re.transformMat3=function(M,D,k){var V=D[0],W=D[1],Z=D[2];return M[0]=V*k[0]+W*k[3]+Z*k[6],M[1]=V*k[1]+W*k[4]+Z*k[7],M[2]=V*k[2]+W*k[5]+Z*k[8],M},Re.transformQuat=function(M,D,k){var V=k[0],W=k[1],Z=k[2],H=D[0],Q=D[1],oe=D[2],fe=W*oe-Z*Q,Se=Z*H-V*oe,we=V*Q-W*H,xe=W*we-Z*Se,ke=Z*fe-V*we,Ce=V*Se-W*fe,Ne=2*k[3];return Se*=Ne,we*=Ne,ke*=2,Ce*=2,M[0]=H+(fe*=Ne)+(xe*=2),M[1]=Q+Se+ke,M[2]=oe+we+Ce,M},Re.rotateX=function(M,D,k,V){var W=[],Z=[];return W[0]=D[0]-k[0],W[1]=D[1]-k[1],W[2]=D[2]-k[2],Z[0]=W[0],Z[1]=W[1]*Math.cos(V)-W[2]*Math.sin(V),Z[2]=W[1]*Math.sin(V)+W[2]*Math.cos(V),M[0]=Z[0]+k[0],M[1]=Z[1]+k[1],M[2]=Z[2]+k[2],M},Re.rotateY=function(M,D,k,V){var W=[],Z=[];return W[0]=D[0]-k[0],W[1]=D[1]-k[1],W[2]=D[2]-k[2],Z[0]=W[2]*Math.sin(V)+W[0]*Math.cos(V),Z[1]=W[1],Z[2]=W[2]*Math.cos(V)-W[0]*Math.sin(V),M[0]=Z[0]+k[0],M[1]=Z[1]+k[1],M[2]=Z[2]+k[2],M},Re.rotateZ=function(M,D,k,V){var W=[],Z=[];return W[0]=D[0]-k[0],W[1]=D[1]-k[1],W[2]=D[2]-k[2],Z[0]=W[0]*Math.cos(V)-W[1]*Math.sin(V),Z[1]=W[0]*Math.sin(V)+W[1]*Math.cos(V),Z[2]=W[2],M[0]=Z[0]+k[0],M[1]=Z[1]+k[1],M[2]=Z[2]+k[2],M},Re.angle=function(M,D){var k=M[0],V=M[1],W=M[2],Z=D[0],H=D[1],Q=D[2],oe=Math.sqrt(k*k+V*V+W*W)*Math.sqrt(Z*Z+H*H+Q*Q),fe=oe&&E(M,D)/oe;return Math.acos(Math.min(Math.max(fe,-1),1))},Re.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M},Re.str=function(M){return"vec3("+M[0]+", "+M[1]+", "+M[2]+")"},Re.exactEquals=function(M,D){return M[0]===D[0]&&M[1]===D[1]&&M[2]===D[2]},Re.equals=function(M,D){var k=M[0],V=M[1],W=M[2],Z=D[0],H=D[1],Q=D[2];return Math.abs(k-Z)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Z))&&Math.abs(V-H)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(H))&&Math.abs(W-Q)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Q))},Re.forEach=Re.sqrLen=Re.len=Re.sqrDist=Re.dist=Re.div=Re.mul=Re.sub=void 0;var n=function(M,D){if(M&&M.__esModule)return M;if(M===null||l(M)!=="object"&&typeof M!="function")return{default:M};var k=a(void 0);if(k&&k.has(M))return k.get(M);var V={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in M)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(M,Z)){var H=W?Object.getOwnPropertyDescriptor(M,Z):null;H&&(H.get||H.set)?Object.defineProperty(V,Z,H):V[Z]=M[Z]}return V.default=M,k&&k.set(M,V),V}(N());function a(M){if(typeof WeakMap!="function")return null;var D=new WeakMap,k=new WeakMap;return(a=function(V){return V?k:D})(M)}function u(){var M=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0),M}function m(M){return Math.hypot(M[0],M[1],M[2])}function h(M,D,k){return M[0]=D[0]-k[0],M[1]=D[1]-k[1],M[2]=D[2]-k[2],M}function g(M,D,k){return M[0]=D[0]*k[0],M[1]=D[1]*k[1],M[2]=D[2]*k[2],M}function b(M,D,k){return M[0]=D[0]/k[0],M[1]=D[1]/k[1],M[2]=D[2]/k[2],M}function T(M,D){return Math.hypot(D[0]-M[0],D[1]-M[1],D[2]-M[2])}function P(M,D){var k=D[0]-M[0],V=D[1]-M[1],W=D[2]-M[2];return k*k+V*V+W*W}function v(M){var D=M[0],k=M[1],V=M[2];return D*D+k*k+V*V}function E(M,D){return M[0]*D[0]+M[1]*D[1]+M[2]*D[2]}Re.sub=h,Re.mul=g,Re.div=b,Re.dist=T,Re.sqrDist=P,Re.len=m,Re.sqrLen=v;var A,C=(A=u(),function(M,D,k,V,W,Z){var H,Q;for(D||(D=3),k||(k=0),Q=V?Math.min(V*D+k,M.length):M.length,H=k;H<Q;H+=D)A[0]=M[H],A[1]=M[H+1],A[2]=M[H+2],W(A,A,Z),M[H]=A[0],M[H+1]=A[1],M[H+2]=A[2];return M});return Re.forEach=C,Re}var et,We,me={};function Oe(){if(et)return me;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(C)}et=1,Object.defineProperty(me,"__esModule",{value:!0}),me.create=u,me.clone=function(C){var M=new n.ARRAY_TYPE(4);return M[0]=C[0],M[1]=C[1],M[2]=C[2],M[3]=C[3],M},me.fromValues=function(C,M,D,k){var V=new n.ARRAY_TYPE(4);return V[0]=C,V[1]=M,V[2]=D,V[3]=k,V},me.copy=function(C,M){return C[0]=M[0],C[1]=M[1],C[2]=M[2],C[3]=M[3],C},me.set=function(C,M,D,k,V){return C[0]=M,C[1]=D,C[2]=k,C[3]=V,C},me.add=function(C,M,D){return C[0]=M[0]+D[0],C[1]=M[1]+D[1],C[2]=M[2]+D[2],C[3]=M[3]+D[3],C},me.subtract=m,me.multiply=h,me.divide=g,me.ceil=function(C,M){return C[0]=Math.ceil(M[0]),C[1]=Math.ceil(M[1]),C[2]=Math.ceil(M[2]),C[3]=Math.ceil(M[3]),C},me.floor=function(C,M){return C[0]=Math.floor(M[0]),C[1]=Math.floor(M[1]),C[2]=Math.floor(M[2]),C[3]=Math.floor(M[3]),C},me.min=function(C,M,D){return C[0]=Math.min(M[0],D[0]),C[1]=Math.min(M[1],D[1]),C[2]=Math.min(M[2],D[2]),C[3]=Math.min(M[3],D[3]),C},me.max=function(C,M,D){return C[0]=Math.max(M[0],D[0]),C[1]=Math.max(M[1],D[1]),C[2]=Math.max(M[2],D[2]),C[3]=Math.max(M[3],D[3]),C},me.round=function(C,M){return C[0]=Math.round(M[0]),C[1]=Math.round(M[1]),C[2]=Math.round(M[2]),C[3]=Math.round(M[3]),C},me.scale=function(C,M,D){return C[0]=M[0]*D,C[1]=M[1]*D,C[2]=M[2]*D,C[3]=M[3]*D,C},me.scaleAndAdd=function(C,M,D,k){return C[0]=M[0]+D[0]*k,C[1]=M[1]+D[1]*k,C[2]=M[2]+D[2]*k,C[3]=M[3]+D[3]*k,C},me.distance=b,me.squaredDistance=T,me.length=P,me.squaredLength=v,me.negate=function(C,M){return C[0]=-M[0],C[1]=-M[1],C[2]=-M[2],C[3]=-M[3],C},me.inverse=function(C,M){return C[0]=1/M[0],C[1]=1/M[1],C[2]=1/M[2],C[3]=1/M[3],C},me.normalize=function(C,M){var D=M[0],k=M[1],V=M[2],W=M[3],Z=D*D+k*k+V*V+W*W;return Z>0&&(Z=1/Math.sqrt(Z)),C[0]=D*Z,C[1]=k*Z,C[2]=V*Z,C[3]=W*Z,C},me.dot=function(C,M){return C[0]*M[0]+C[1]*M[1]+C[2]*M[2]+C[3]*M[3]},me.cross=function(C,M,D,k){var V=D[0]*k[1]-D[1]*k[0],W=D[0]*k[2]-D[2]*k[0],Z=D[0]*k[3]-D[3]*k[0],H=D[1]*k[2]-D[2]*k[1],Q=D[1]*k[3]-D[3]*k[1],oe=D[2]*k[3]-D[3]*k[2],fe=M[0],Se=M[1],we=M[2],xe=M[3];return C[0]=Se*oe-we*Q+xe*H,C[1]=-fe*oe+we*Z-xe*W,C[2]=fe*Q-Se*Z+xe*V,C[3]=-fe*H+Se*W-we*V,C},me.lerp=function(C,M,D,k){var V=M[0],W=M[1],Z=M[2],H=M[3];return C[0]=V+k*(D[0]-V),C[1]=W+k*(D[1]-W),C[2]=Z+k*(D[2]-Z),C[3]=H+k*(D[3]-H),C},me.random=function(C,M){var D,k,V,W,Z,H;M=M||1;do Z=(D=2*n.RANDOM()-1)*D+(k=2*n.RANDOM()-1)*k;while(Z>=1);do H=(V=2*n.RANDOM()-1)*V+(W=2*n.RANDOM()-1)*W;while(H>=1);var Q=Math.sqrt((1-Z)/H);return C[0]=M*D,C[1]=M*k,C[2]=M*V*Q,C[3]=M*W*Q,C},me.transformMat4=function(C,M,D){var k=M[0],V=M[1],W=M[2],Z=M[3];return C[0]=D[0]*k+D[4]*V+D[8]*W+D[12]*Z,C[1]=D[1]*k+D[5]*V+D[9]*W+D[13]*Z,C[2]=D[2]*k+D[6]*V+D[10]*W+D[14]*Z,C[3]=D[3]*k+D[7]*V+D[11]*W+D[15]*Z,C},me.transformQuat=function(C,M,D){var k=M[0],V=M[1],W=M[2],Z=D[0],H=D[1],Q=D[2],oe=D[3],fe=oe*k+H*W-Q*V,Se=oe*V+Q*k-Z*W,we=oe*W+Z*V-H*k,xe=-Z*k-H*V-Q*W;return C[0]=fe*oe+xe*-Z+Se*-Q-we*-H,C[1]=Se*oe+xe*-H+we*-Z-fe*-Q,C[2]=we*oe+xe*-Q+fe*-H-Se*-Z,C[3]=M[3],C},me.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},me.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},me.exactEquals=function(C,M){return C[0]===M[0]&&C[1]===M[1]&&C[2]===M[2]&&C[3]===M[3]},me.equals=function(C,M){var D=C[0],k=C[1],V=C[2],W=C[3],Z=M[0],H=M[1],Q=M[2],oe=M[3];return Math.abs(D-Z)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(Z))&&Math.abs(k-H)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(H))&&Math.abs(V-Q)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(Q))&&Math.abs(W-oe)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(oe))},me.forEach=me.sqrLen=me.len=me.sqrDist=me.dist=me.div=me.mul=me.sub=void 0;var n=function(C,M){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=a(void 0);if(D&&D.has(C))return D.get(C);var k={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in C)if(W!=="default"&&Object.prototype.hasOwnProperty.call(C,W)){var Z=V?Object.getOwnPropertyDescriptor(C,W):null;Z&&(Z.get||Z.set)?Object.defineProperty(k,W,Z):k[W]=C[W]}return k.default=C,D&&D.set(C,k),k}(N());function a(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,D=new WeakMap;return(a=function(k){return k?D:M})(C)}function u(){var C=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function m(C,M,D){return C[0]=M[0]-D[0],C[1]=M[1]-D[1],C[2]=M[2]-D[2],C[3]=M[3]-D[3],C}function h(C,M,D){return C[0]=M[0]*D[0],C[1]=M[1]*D[1],C[2]=M[2]*D[2],C[3]=M[3]*D[3],C}function g(C,M,D){return C[0]=M[0]/D[0],C[1]=M[1]/D[1],C[2]=M[2]/D[2],C[3]=M[3]/D[3],C}function b(C,M){return Math.hypot(M[0]-C[0],M[1]-C[1],M[2]-C[2],M[3]-C[3])}function T(C,M){var D=M[0]-C[0],k=M[1]-C[1],V=M[2]-C[2],W=M[3]-C[3];return D*D+k*k+V*V+W*W}function P(C){return Math.hypot(C[0],C[1],C[2],C[3])}function v(C){var M=C[0],D=C[1],k=C[2],V=C[3];return M*M+D*D+k*k+V*V}me.sub=m,me.mul=h,me.div=g,me.dist=b,me.sqrDist=T,me.len=P,me.sqrLen=v;var E,A=(E=u(),function(C,M,D,k,V,W){var Z,H;for(M||(M=4),D||(D=0),H=k?Math.min(k*M+D,C.length):C.length,Z=D;Z<H;Z+=M)E[0]=C[Z],E[1]=C[Z+1],E[2]=C[Z+2],E[3]=C[Z+3],V(E,E,W),C[Z]=E[0],C[Z+1]=E[1],C[Z+2]=E[2],C[Z+3]=E[3];return C});return me.forEach=A,me}function Fe(){if(We)return Ee;function l(Ce){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ne){return typeof Ne}:function(Ne){return Ne&&typeof Symbol=="function"&&Ne.constructor===Symbol&&Ne!==Symbol.prototype?"symbol":typeof Ne},l(Ce)}We=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.create=b,Ee.identity=function(Ce){return Ce[0]=0,Ce[1]=0,Ce[2]=0,Ce[3]=1,Ce},Ee.setAxisAngle=T,Ee.getAxisAngle=function(Ce,Ne){var Ze=2*Math.acos(Ne[3]),Ge=Math.sin(Ze/2);return Ge>n.EPSILON?(Ce[0]=Ne[0]/Ge,Ce[1]=Ne[1]/Ge,Ce[2]=Ne[2]/Ge):(Ce[0]=1,Ce[1]=0,Ce[2]=0),Ze},Ee.getAngle=function(Ce,Ne){var Ze=D(Ce,Ne);return Math.acos(2*Ze*Ze-1)},Ee.multiply=P,Ee.rotateX=function(Ce,Ne,Ze){Ze*=.5;var Ge=Ne[0],Je=Ne[1],rt=Ne[2],lt=Ne[3],nt=Math.sin(Ze),xt=Math.cos(Ze);return Ce[0]=Ge*xt+lt*nt,Ce[1]=Je*xt+rt*nt,Ce[2]=rt*xt-Je*nt,Ce[3]=lt*xt-Ge*nt,Ce},Ee.rotateY=function(Ce,Ne,Ze){Ze*=.5;var Ge=Ne[0],Je=Ne[1],rt=Ne[2],lt=Ne[3],nt=Math.sin(Ze),xt=Math.cos(Ze);return Ce[0]=Ge*xt-rt*nt,Ce[1]=Je*xt+lt*nt,Ce[2]=rt*xt+Ge*nt,Ce[3]=lt*xt-Je*nt,Ce},Ee.rotateZ=function(Ce,Ne,Ze){Ze*=.5;var Ge=Ne[0],Je=Ne[1],rt=Ne[2],lt=Ne[3],nt=Math.sin(Ze),xt=Math.cos(Ze);return Ce[0]=Ge*xt+Je*nt,Ce[1]=Je*xt-Ge*nt,Ce[2]=rt*xt+lt*nt,Ce[3]=lt*xt-rt*nt,Ce},Ee.calculateW=function(Ce,Ne){var Ze=Ne[0],Ge=Ne[1],Je=Ne[2];return Ce[0]=Ze,Ce[1]=Ge,Ce[2]=Je,Ce[3]=Math.sqrt(Math.abs(1-Ze*Ze-Ge*Ge-Je*Je)),Ce},Ee.exp=v,Ee.ln=E,Ee.pow=function(Ce,Ne,Ze){return E(Ce,Ne),M(Ce,Ce,Ze),v(Ce,Ce),Ce},Ee.slerp=A,Ee.random=function(Ce){var Ne=n.RANDOM(),Ze=n.RANDOM(),Ge=n.RANDOM(),Je=Math.sqrt(1-Ne),rt=Math.sqrt(Ne);return Ce[0]=Je*Math.sin(2*Math.PI*Ze),Ce[1]=Je*Math.cos(2*Math.PI*Ze),Ce[2]=rt*Math.sin(2*Math.PI*Ge),Ce[3]=rt*Math.cos(2*Math.PI*Ge),Ce},Ee.invert=function(Ce,Ne){var Ze=Ne[0],Ge=Ne[1],Je=Ne[2],rt=Ne[3],lt=Ze*Ze+Ge*Ge+Je*Je+rt*rt,nt=lt?1/lt:0;return Ce[0]=-Ze*nt,Ce[1]=-Ge*nt,Ce[2]=-Je*nt,Ce[3]=rt*nt,Ce},Ee.conjugate=function(Ce,Ne){return Ce[0]=-Ne[0],Ce[1]=-Ne[1],Ce[2]=-Ne[2],Ce[3]=Ne[3],Ce},Ee.fromMat3=C,Ee.fromEuler=function(Ce,Ne,Ze,Ge){var Je=.5*Math.PI/180;Ne*=Je,Ze*=Je,Ge*=Je;var rt=Math.sin(Ne),lt=Math.cos(Ne),nt=Math.sin(Ze),xt=Math.cos(Ze),Dt=Math.sin(Ge),vt=Math.cos(Ge);return Ce[0]=rt*xt*vt-lt*nt*Dt,Ce[1]=lt*nt*vt+rt*xt*Dt,Ce[2]=lt*xt*Dt-rt*nt*vt,Ce[3]=lt*xt*vt+rt*nt*Dt,Ce},Ee.str=function(Ce){return"quat("+Ce[0]+", "+Ce[1]+", "+Ce[2]+", "+Ce[3]+")"},Ee.setAxes=Ee.sqlerp=Ee.rotationTo=Ee.equals=Ee.exactEquals=Ee.normalize=Ee.sqrLen=Ee.squaredLength=Ee.len=Ee.length=Ee.lerp=Ee.dot=Ee.scale=Ee.mul=Ee.add=Ee.set=Ee.copy=Ee.fromValues=Ee.clone=void 0;var n=g(N()),a=g(ue()),u=g(Qe()),m=g(Oe());function h(Ce){if(typeof WeakMap!="function")return null;var Ne=new WeakMap,Ze=new WeakMap;return(h=function(Ge){return Ge?Ze:Ne})(Ce)}function g(Ce,Ne){if(Ce&&Ce.__esModule)return Ce;if(Ce===null||l(Ce)!=="object"&&typeof Ce!="function")return{default:Ce};var Ze=h(Ne);if(Ze&&Ze.has(Ce))return Ze.get(Ce);var Ge={},Je=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var rt in Ce)if(rt!=="default"&&Object.prototype.hasOwnProperty.call(Ce,rt)){var lt=Je?Object.getOwnPropertyDescriptor(Ce,rt):null;lt&&(lt.get||lt.set)?Object.defineProperty(Ge,rt,lt):Ge[rt]=Ce[rt]}return Ge.default=Ce,Ze&&Ze.set(Ce,Ge),Ge}function b(){var Ce=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Ce[0]=0,Ce[1]=0,Ce[2]=0),Ce[3]=1,Ce}function T(Ce,Ne,Ze){Ze*=.5;var Ge=Math.sin(Ze);return Ce[0]=Ge*Ne[0],Ce[1]=Ge*Ne[1],Ce[2]=Ge*Ne[2],Ce[3]=Math.cos(Ze),Ce}function P(Ce,Ne,Ze){var Ge=Ne[0],Je=Ne[1],rt=Ne[2],lt=Ne[3],nt=Ze[0],xt=Ze[1],Dt=Ze[2],vt=Ze[3];return Ce[0]=Ge*vt+lt*nt+Je*Dt-rt*xt,Ce[1]=Je*vt+lt*xt+rt*nt-Ge*Dt,Ce[2]=rt*vt+lt*Dt+Ge*xt-Je*nt,Ce[3]=lt*vt-Ge*nt-Je*xt-rt*Dt,Ce}function v(Ce,Ne){var Ze=Ne[0],Ge=Ne[1],Je=Ne[2],rt=Ne[3],lt=Math.sqrt(Ze*Ze+Ge*Ge+Je*Je),nt=Math.exp(rt),xt=lt>0?nt*Math.sin(lt)/lt:0;return Ce[0]=Ze*xt,Ce[1]=Ge*xt,Ce[2]=Je*xt,Ce[3]=nt*Math.cos(lt),Ce}function E(Ce,Ne){var Ze=Ne[0],Ge=Ne[1],Je=Ne[2],rt=Ne[3],lt=Math.sqrt(Ze*Ze+Ge*Ge+Je*Je),nt=lt>0?Math.atan2(lt,rt)/lt:0;return Ce[0]=Ze*nt,Ce[1]=Ge*nt,Ce[2]=Je*nt,Ce[3]=.5*Math.log(Ze*Ze+Ge*Ge+Je*Je+rt*rt),Ce}function A(Ce,Ne,Ze,Ge){var Je,rt,lt,nt,xt,Dt=Ne[0],vt=Ne[1],Jt=Ne[2],Zt=Ne[3],kt=Ze[0],Rt=Ze[1],mn=Ze[2],en=Ze[3];return(rt=Dt*kt+vt*Rt+Jt*mn+Zt*en)<0&&(rt=-rt,kt=-kt,Rt=-Rt,mn=-mn,en=-en),1-rt>n.EPSILON?(Je=Math.acos(rt),lt=Math.sin(Je),nt=Math.sin((1-Ge)*Je)/lt,xt=Math.sin(Ge*Je)/lt):(nt=1-Ge,xt=Ge),Ce[0]=nt*Dt+xt*kt,Ce[1]=nt*vt+xt*Rt,Ce[2]=nt*Jt+xt*mn,Ce[3]=nt*Zt+xt*en,Ce}function C(Ce,Ne){var Ze,Ge=Ne[0]+Ne[4]+Ne[8];if(Ge>0)Ze=Math.sqrt(Ge+1),Ce[3]=.5*Ze,Ce[0]=(Ne[5]-Ne[7])*(Ze=.5/Ze),Ce[1]=(Ne[6]-Ne[2])*Ze,Ce[2]=(Ne[1]-Ne[3])*Ze;else{var Je=0;Ne[4]>Ne[0]&&(Je=1),Ne[8]>Ne[3*Je+Je]&&(Je=2);var rt=(Je+1)%3,lt=(Je+2)%3;Ze=Math.sqrt(Ne[3*Je+Je]-Ne[3*rt+rt]-Ne[3*lt+lt]+1),Ce[Je]=.5*Ze,Ce[3]=(Ne[3*rt+lt]-Ne[3*lt+rt])*(Ze=.5/Ze),Ce[rt]=(Ne[3*rt+Je]+Ne[3*Je+rt])*Ze,Ce[lt]=(Ne[3*lt+Je]+Ne[3*Je+lt])*Ze}return Ce}Ee.clone=m.clone,Ee.fromValues=m.fromValues,Ee.copy=m.copy,Ee.set=m.set,Ee.add=m.add,Ee.mul=P;var M=m.scale;Ee.scale=M;var D=m.dot;Ee.dot=D,Ee.lerp=m.lerp;var k=m.length;Ee.length=k,Ee.len=k;var V=m.squaredLength;Ee.squaredLength=V,Ee.sqrLen=V;var W=m.normalize;Ee.normalize=W,Ee.exactEquals=m.exactEquals,Ee.equals=m.equals;var Z,H,Q,oe=(Z=u.create(),H=u.fromValues(1,0,0),Q=u.fromValues(0,1,0),function(Ce,Ne,Ze){var Ge=u.dot(Ne,Ze);return Ge<-.999999?(u.cross(Z,H,Ne),u.len(Z)<1e-6&&u.cross(Z,Q,Ne),u.normalize(Z,Z),T(Ce,Z,Math.PI),Ce):Ge>.999999?(Ce[0]=0,Ce[1]=0,Ce[2]=0,Ce[3]=1,Ce):(u.cross(Z,Ne,Ze),Ce[0]=Z[0],Ce[1]=Z[1],Ce[2]=Z[2],Ce[3]=1+Ge,W(Ce,Ce))});Ee.rotationTo=oe;var fe,Se,we=(fe=b(),Se=b(),function(Ce,Ne,Ze,Ge,Je,rt){return A(fe,Ne,Je,rt),A(Se,Ze,Ge,rt),A(Ce,fe,Se,2*rt*(1-rt)),Ce});Ee.sqlerp=we;var xe,ke=(xe=a.create(),function(Ce,Ne,Ze,Ge){return xe[0]=Ze[0],xe[3]=Ze[1],xe[6]=Ze[2],xe[1]=Ge[0],xe[4]=Ge[1],xe[7]=Ge[2],xe[2]=-Ne[0],xe[5]=-Ne[1],xe[8]=-Ne[2],W(Ce,C(Ce,xe))});return Ee.setAxes=ke,Ee}var Ke,$e={};function pt(){if(Ke)return $e;function l(A){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},l(A)}Ke=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.create=function(){var A=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[4]=0,A[5]=0,A[6]=0,A[7]=0),A[3]=1,A},$e.clone=function(A){var C=new n.ARRAY_TYPE(8);return C[0]=A[0],C[1]=A[1],C[2]=A[2],C[3]=A[3],C[4]=A[4],C[5]=A[5],C[6]=A[6],C[7]=A[7],C},$e.fromValues=function(A,C,M,D,k,V,W,Z){var H=new n.ARRAY_TYPE(8);return H[0]=A,H[1]=C,H[2]=M,H[3]=D,H[4]=k,H[5]=V,H[6]=W,H[7]=Z,H},$e.fromRotationTranslationValues=function(A,C,M,D,k,V,W){var Z=new n.ARRAY_TYPE(8);Z[0]=A,Z[1]=C,Z[2]=M,Z[3]=D;var H=.5*k,Q=.5*V,oe=.5*W;return Z[4]=H*D+Q*M-oe*C,Z[5]=Q*D+oe*A-H*M,Z[6]=oe*D+H*C-Q*A,Z[7]=-H*A-Q*C-oe*M,Z},$e.fromRotationTranslation=g,$e.fromTranslation=function(A,C){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=.5*C[0],A[5]=.5*C[1],A[6]=.5*C[2],A[7]=0,A},$e.fromRotation=function(A,C){return A[0]=C[0],A[1]=C[1],A[2]=C[2],A[3]=C[3],A[4]=0,A[5]=0,A[6]=0,A[7]=0,A},$e.fromMat4=function(A,C){var M=a.create();u.getRotation(M,C);var D=new n.ARRAY_TYPE(3);return u.getTranslation(D,C),g(A,M,D),A},$e.copy=b,$e.identity=function(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=0,A[5]=0,A[6]=0,A[7]=0,A},$e.set=function(A,C,M,D,k,V,W,Z,H){return A[0]=C,A[1]=M,A[2]=D,A[3]=k,A[4]=V,A[5]=W,A[6]=Z,A[7]=H,A},$e.getDual=function(A,C){return A[0]=C[4],A[1]=C[5],A[2]=C[6],A[3]=C[7],A},$e.setDual=function(A,C){return A[4]=C[0],A[5]=C[1],A[6]=C[2],A[7]=C[3],A},$e.getTranslation=function(A,C){var M=C[4],D=C[5],k=C[6],V=C[7],W=-C[0],Z=-C[1],H=-C[2],Q=C[3];return A[0]=2*(M*Q+V*W+D*H-k*Z),A[1]=2*(D*Q+V*Z+k*W-M*H),A[2]=2*(k*Q+V*H+M*Z-D*W),A},$e.translate=function(A,C,M){var D=C[0],k=C[1],V=C[2],W=C[3],Z=.5*M[0],H=.5*M[1],Q=.5*M[2],oe=C[4],fe=C[5],Se=C[6],we=C[7];return A[0]=D,A[1]=k,A[2]=V,A[3]=W,A[4]=W*Z+k*Q-V*H+oe,A[5]=W*H+V*Z-D*Q+fe,A[6]=W*Q+D*H-k*Z+Se,A[7]=-D*Z-k*H-V*Q+we,A},$e.rotateX=function(A,C,M){var D=-C[0],k=-C[1],V=-C[2],W=C[3],Z=C[4],H=C[5],Q=C[6],oe=C[7],fe=Z*W+oe*D+H*V-Q*k,Se=H*W+oe*k+Q*D-Z*V,we=Q*W+oe*V+Z*k-H*D,xe=oe*W-Z*D-H*k-Q*V;return a.rotateX(A,C,M),A[4]=fe*(W=A[3])+xe*(D=A[0])+Se*(V=A[2])-we*(k=A[1]),A[5]=Se*W+xe*k+we*D-fe*V,A[6]=we*W+xe*V+fe*k-Se*D,A[7]=xe*W-fe*D-Se*k-we*V,A},$e.rotateY=function(A,C,M){var D=-C[0],k=-C[1],V=-C[2],W=C[3],Z=C[4],H=C[5],Q=C[6],oe=C[7],fe=Z*W+oe*D+H*V-Q*k,Se=H*W+oe*k+Q*D-Z*V,we=Q*W+oe*V+Z*k-H*D,xe=oe*W-Z*D-H*k-Q*V;return a.rotateY(A,C,M),A[4]=fe*(W=A[3])+xe*(D=A[0])+Se*(V=A[2])-we*(k=A[1]),A[5]=Se*W+xe*k+we*D-fe*V,A[6]=we*W+xe*V+fe*k-Se*D,A[7]=xe*W-fe*D-Se*k-we*V,A},$e.rotateZ=function(A,C,M){var D=-C[0],k=-C[1],V=-C[2],W=C[3],Z=C[4],H=C[5],Q=C[6],oe=C[7],fe=Z*W+oe*D+H*V-Q*k,Se=H*W+oe*k+Q*D-Z*V,we=Q*W+oe*V+Z*k-H*D,xe=oe*W-Z*D-H*k-Q*V;return a.rotateZ(A,C,M),A[4]=fe*(W=A[3])+xe*(D=A[0])+Se*(V=A[2])-we*(k=A[1]),A[5]=Se*W+xe*k+we*D-fe*V,A[6]=we*W+xe*V+fe*k-Se*D,A[7]=xe*W-fe*D-Se*k-we*V,A},$e.rotateByQuatAppend=function(A,C,M){var D=M[0],k=M[1],V=M[2],W=M[3],Z=C[0],H=C[1],Q=C[2],oe=C[3];return A[0]=Z*W+oe*D+H*V-Q*k,A[1]=H*W+oe*k+Q*D-Z*V,A[2]=Q*W+oe*V+Z*k-H*D,A[3]=oe*W-Z*D-H*k-Q*V,A[4]=(Z=C[4])*W+(oe=C[7])*D+(H=C[5])*V-(Q=C[6])*k,A[5]=H*W+oe*k+Q*D-Z*V,A[6]=Q*W+oe*V+Z*k-H*D,A[7]=oe*W-Z*D-H*k-Q*V,A},$e.rotateByQuatPrepend=function(A,C,M){var D=C[0],k=C[1],V=C[2],W=C[3],Z=M[0],H=M[1],Q=M[2],oe=M[3];return A[0]=D*oe+W*Z+k*Q-V*H,A[1]=k*oe+W*H+V*Z-D*Q,A[2]=V*oe+W*Q+D*H-k*Z,A[3]=W*oe-D*Z-k*H-V*Q,A[4]=D*(oe=M[7])+W*(Z=M[4])+k*(Q=M[6])-V*(H=M[5]),A[5]=k*oe+W*H+V*Z-D*Q,A[6]=V*oe+W*Q+D*H-k*Z,A[7]=W*oe-D*Z-k*H-V*Q,A},$e.rotateAroundAxis=function(A,C,M,D){if(Math.abs(D)<n.EPSILON)return b(A,C);var k=Math.hypot(M[0],M[1],M[2]);D*=.5;var V=Math.sin(D),W=V*M[0]/k,Z=V*M[1]/k,H=V*M[2]/k,Q=Math.cos(D),oe=C[0],fe=C[1],Se=C[2],we=C[3];A[0]=oe*Q+we*W+fe*H-Se*Z,A[1]=fe*Q+we*Z+Se*W-oe*H,A[2]=Se*Q+we*H+oe*Z-fe*W,A[3]=we*Q-oe*W-fe*Z-Se*H;var xe=C[4],ke=C[5],Ce=C[6],Ne=C[7];return A[4]=xe*Q+Ne*W+ke*H-Ce*Z,A[5]=ke*Q+Ne*Z+Ce*W-xe*H,A[6]=Ce*Q+Ne*H+xe*Z-ke*W,A[7]=Ne*Q-xe*W-ke*Z-Ce*H,A},$e.add=function(A,C,M){return A[0]=C[0]+M[0],A[1]=C[1]+M[1],A[2]=C[2]+M[2],A[3]=C[3]+M[3],A[4]=C[4]+M[4],A[5]=C[5]+M[5],A[6]=C[6]+M[6],A[7]=C[7]+M[7],A},$e.multiply=T,$e.scale=function(A,C,M){return A[0]=C[0]*M,A[1]=C[1]*M,A[2]=C[2]*M,A[3]=C[3]*M,A[4]=C[4]*M,A[5]=C[5]*M,A[6]=C[6]*M,A[7]=C[7]*M,A},$e.lerp=function(A,C,M,D){var k=1-D;return P(C,M)<0&&(D=-D),A[0]=C[0]*k+M[0]*D,A[1]=C[1]*k+M[1]*D,A[2]=C[2]*k+M[2]*D,A[3]=C[3]*k+M[3]*D,A[4]=C[4]*k+M[4]*D,A[5]=C[5]*k+M[5]*D,A[6]=C[6]*k+M[6]*D,A[7]=C[7]*k+M[7]*D,A},$e.invert=function(A,C){var M=E(C);return A[0]=-C[0]/M,A[1]=-C[1]/M,A[2]=-C[2]/M,A[3]=C[3]/M,A[4]=-C[4]/M,A[5]=-C[5]/M,A[6]=-C[6]/M,A[7]=C[7]/M,A},$e.conjugate=function(A,C){return A[0]=-C[0],A[1]=-C[1],A[2]=-C[2],A[3]=C[3],A[4]=-C[4],A[5]=-C[5],A[6]=-C[6],A[7]=C[7],A},$e.normalize=function(A,C){var M=E(C);if(M>0){M=Math.sqrt(M);var D=C[0]/M,k=C[1]/M,V=C[2]/M,W=C[3]/M,Z=C[4],H=C[5],Q=C[6],oe=C[7],fe=D*Z+k*H+V*Q+W*oe;A[0]=D,A[1]=k,A[2]=V,A[3]=W,A[4]=(Z-D*fe)/M,A[5]=(H-k*fe)/M,A[6]=(Q-V*fe)/M,A[7]=(oe-W*fe)/M}return A},$e.str=function(A){return"quat2("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+", "+A[6]+", "+A[7]+")"},$e.exactEquals=function(A,C){return A[0]===C[0]&&A[1]===C[1]&&A[2]===C[2]&&A[3]===C[3]&&A[4]===C[4]&&A[5]===C[5]&&A[6]===C[6]&&A[7]===C[7]},$e.equals=function(A,C){var M=A[0],D=A[1],k=A[2],V=A[3],W=A[4],Z=A[5],H=A[6],Q=A[7],oe=C[0],fe=C[1],Se=C[2],we=C[3],xe=C[4],ke=C[5],Ce=C[6],Ne=C[7];return Math.abs(M-oe)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(oe))&&Math.abs(D-fe)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(fe))&&Math.abs(k-Se)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Se))&&Math.abs(V-we)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(we))&&Math.abs(W-xe)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(xe))&&Math.abs(Z-ke)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(ke))&&Math.abs(H-Ce)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Ce))&&Math.abs(Q-Ne)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Ne))},$e.sqrLen=$e.squaredLength=$e.len=$e.length=$e.dot=$e.mul=$e.setReal=$e.getReal=void 0;var n=h(N()),a=h(Fe()),u=h(be());function m(A){if(typeof WeakMap!="function")return null;var C=new WeakMap,M=new WeakMap;return(m=function(D){return D?M:C})(A)}function h(A,C){if(A&&A.__esModule)return A;if(A===null||l(A)!=="object"&&typeof A!="function")return{default:A};var M=m(C);if(M&&M.has(A))return M.get(A);var D={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in A)if(V!=="default"&&Object.prototype.hasOwnProperty.call(A,V)){var W=k?Object.getOwnPropertyDescriptor(A,V):null;W&&(W.get||W.set)?Object.defineProperty(D,V,W):D[V]=A[V]}return D.default=A,M&&M.set(A,D),D}function g(A,C,M){var D=.5*M[0],k=.5*M[1],V=.5*M[2],W=C[0],Z=C[1],H=C[2],Q=C[3];return A[0]=W,A[1]=Z,A[2]=H,A[3]=Q,A[4]=D*Q+k*H-V*Z,A[5]=k*Q+V*W-D*H,A[6]=V*Q+D*Z-k*W,A[7]=-D*W-k*Z-V*H,A}function b(A,C){return A[0]=C[0],A[1]=C[1],A[2]=C[2],A[3]=C[3],A[4]=C[4],A[5]=C[5],A[6]=C[6],A[7]=C[7],A}function T(A,C,M){var D=C[0],k=C[1],V=C[2],W=C[3],Z=M[4],H=M[5],Q=M[6],oe=M[7],fe=C[4],Se=C[5],we=C[6],xe=C[7],ke=M[0],Ce=M[1],Ne=M[2],Ze=M[3];return A[0]=D*Ze+W*ke+k*Ne-V*Ce,A[1]=k*Ze+W*Ce+V*ke-D*Ne,A[2]=V*Ze+W*Ne+D*Ce-k*ke,A[3]=W*Ze-D*ke-k*Ce-V*Ne,A[4]=D*oe+W*Z+k*Q-V*H+fe*Ze+xe*ke+Se*Ne-we*Ce,A[5]=k*oe+W*H+V*Z-D*Q+Se*Ze+xe*Ce+we*ke-fe*Ne,A[6]=V*oe+W*Q+D*H-k*Z+we*Ze+xe*Ne+fe*Ce-Se*ke,A[7]=W*oe-D*Z-k*H-V*Q+xe*Ze-fe*ke-Se*Ce-we*Ne,A}$e.getReal=a.copy,$e.setReal=a.copy,$e.mul=T;var P=a.dot;$e.dot=P;var v=a.length;$e.length=v,$e.len=v;var E=a.squaredLength;return $e.squaredLength=E,$e.sqrLen=E,$e}var Ct,Lt,It={};function _n(){if(Ct)return It;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(C)}Ct=1,Object.defineProperty(It,"__esModule",{value:!0}),It.create=u,It.clone=function(C){var M=new n.ARRAY_TYPE(2);return M[0]=C[0],M[1]=C[1],M},It.fromValues=function(C,M){var D=new n.ARRAY_TYPE(2);return D[0]=C,D[1]=M,D},It.copy=function(C,M){return C[0]=M[0],C[1]=M[1],C},It.set=function(C,M,D){return C[0]=M,C[1]=D,C},It.add=function(C,M,D){return C[0]=M[0]+D[0],C[1]=M[1]+D[1],C},It.subtract=m,It.multiply=h,It.divide=g,It.ceil=function(C,M){return C[0]=Math.ceil(M[0]),C[1]=Math.ceil(M[1]),C},It.floor=function(C,M){return C[0]=Math.floor(M[0]),C[1]=Math.floor(M[1]),C},It.min=function(C,M,D){return C[0]=Math.min(M[0],D[0]),C[1]=Math.min(M[1],D[1]),C},It.max=function(C,M,D){return C[0]=Math.max(M[0],D[0]),C[1]=Math.max(M[1],D[1]),C},It.round=function(C,M){return C[0]=Math.round(M[0]),C[1]=Math.round(M[1]),C},It.scale=function(C,M,D){return C[0]=M[0]*D,C[1]=M[1]*D,C},It.scaleAndAdd=function(C,M,D,k){return C[0]=M[0]+D[0]*k,C[1]=M[1]+D[1]*k,C},It.distance=b,It.squaredDistance=T,It.length=P,It.squaredLength=v,It.negate=function(C,M){return C[0]=-M[0],C[1]=-M[1],C},It.inverse=function(C,M){return C[0]=1/M[0],C[1]=1/M[1],C},It.normalize=function(C,M){var D=M[0],k=M[1],V=D*D+k*k;return V>0&&(V=1/Math.sqrt(V)),C[0]=M[0]*V,C[1]=M[1]*V,C},It.dot=function(C,M){return C[0]*M[0]+C[1]*M[1]},It.cross=function(C,M,D){var k=M[0]*D[1]-M[1]*D[0];return C[0]=C[1]=0,C[2]=k,C},It.lerp=function(C,M,D,k){var V=M[0],W=M[1];return C[0]=V+k*(D[0]-V),C[1]=W+k*(D[1]-W),C},It.random=function(C,M){M=M||1;var D=2*n.RANDOM()*Math.PI;return C[0]=Math.cos(D)*M,C[1]=Math.sin(D)*M,C},It.transformMat2=function(C,M,D){var k=M[0],V=M[1];return C[0]=D[0]*k+D[2]*V,C[1]=D[1]*k+D[3]*V,C},It.transformMat2d=function(C,M,D){var k=M[0],V=M[1];return C[0]=D[0]*k+D[2]*V+D[4],C[1]=D[1]*k+D[3]*V+D[5],C},It.transformMat3=function(C,M,D){var k=M[0],V=M[1];return C[0]=D[0]*k+D[3]*V+D[6],C[1]=D[1]*k+D[4]*V+D[7],C},It.transformMat4=function(C,M,D){var k=M[0],V=M[1];return C[0]=D[0]*k+D[4]*V+D[12],C[1]=D[1]*k+D[5]*V+D[13],C},It.rotate=function(C,M,D,k){var V=M[0]-D[0],W=M[1]-D[1],Z=Math.sin(k),H=Math.cos(k);return C[0]=V*H-W*Z+D[0],C[1]=V*Z+W*H+D[1],C},It.angle=function(C,M){var D=C[0],k=C[1],V=M[0],W=M[1],Z=Math.sqrt(D*D+k*k)*Math.sqrt(V*V+W*W);return Math.acos(Math.min(Math.max(Z&&(D*V+k*W)/Z,-1),1))},It.zero=function(C){return C[0]=0,C[1]=0,C},It.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},It.exactEquals=function(C,M){return C[0]===M[0]&&C[1]===M[1]},It.equals=function(C,M){var D=C[0],k=C[1],V=M[0],W=M[1];return Math.abs(D-V)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(k-W)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(W))},It.forEach=It.sqrLen=It.sqrDist=It.dist=It.div=It.mul=It.sub=It.len=void 0;var n=function(C,M){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=a(void 0);if(D&&D.has(C))return D.get(C);var k={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in C)if(W!=="default"&&Object.prototype.hasOwnProperty.call(C,W)){var Z=V?Object.getOwnPropertyDescriptor(C,W):null;Z&&(Z.get||Z.set)?Object.defineProperty(k,W,Z):k[W]=C[W]}return k.default=C,D&&D.set(C,k),k}(N());function a(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,D=new WeakMap;return(a=function(k){return k?D:M})(C)}function u(){var C=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function m(C,M,D){return C[0]=M[0]-D[0],C[1]=M[1]-D[1],C}function h(C,M,D){return C[0]=M[0]*D[0],C[1]=M[1]*D[1],C}function g(C,M,D){return C[0]=M[0]/D[0],C[1]=M[1]/D[1],C}function b(C,M){return Math.hypot(M[0]-C[0],M[1]-C[1])}function T(C,M){var D=M[0]-C[0],k=M[1]-C[1];return D*D+k*k}function P(C){return Math.hypot(C[0],C[1])}function v(C){var M=C[0],D=C[1];return M*M+D*D}It.len=P,It.sub=m,It.mul=h,It.div=g,It.dist=b,It.sqrDist=T,It.sqrLen=v;var E,A=(E=u(),function(C,M,D,k,V,W){var Z,H;for(M||(M=2),D||(D=0),H=k?Math.min(k*M+D,C.length):C.length,Z=D;Z<H;Z+=M)E[0]=C[Z],E[1]=C[Z+1],V(E,E,W),C[Z]=E[0],C[Z+1]=E[1];return C});return It.forEach=A,It}function Ut(){if(Lt)return z;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(C)}Lt=1,Object.defineProperty(z,"__esModule",{value:!0}),z.vec4=z.vec3=z.vec2=z.quat2=z.quat=z.mat4=z.mat3=z.mat2d=z.mat2=z.glMatrix=void 0;var n=A(N());z.glMatrix=n;var a=A(K());z.mat2=a;var u=A(se());z.mat2d=u;var m=A(ue());z.mat3=m;var h=A(be());z.mat4=h;var g=A(Fe());z.quat=g;var b=A(pt());z.quat2=b;var T=A(_n());z.vec2=T;var P=A(Qe());z.vec3=P;var v=A(Oe());function E(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,D=new WeakMap;return(E=function(k){return k?D:M})(C)}function A(C,M){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=E(M);if(D&&D.has(C))return D.get(C);var k={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in C)if(W!=="default"&&Object.prototype.hasOwnProperty.call(C,W)){var Z=V?Object.getOwnPropertyDescriptor(C,W):null;Z&&(Z.get||Z.set)?Object.defineProperty(k,W,Z):k[W]=C[W]}return k.default=C,D&&D.set(C,k),k}return z.vec4=v,z}var ln,xn,En,Nt,_e=Ut(),Ft=function(){if(xn)return ln;function l(n,a,u,m){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=u,this.p2y=m}return xn=1,ln=l,l.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,m=0;m<8;m++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<a)return u;var g=this.sampleCurveDerivativeX(u);if(Math.abs(g)<1e-6)break;u-=h/g}var b=0,T=1;for(u=n,m=0;m<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<a));m++)n>h?b=u:T=u,u=.5*(T-b)+b;return u},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},ln}(),Ve=O(Ft);function Ye(){if(Nt)return En;function l(n,a){this.x=n,this.y=a}return Nt=1,En=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,u=n.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),u=Math.sin(n),m=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=m,this},_rotateAround:function(n,a){var u=Math.cos(n),m=Math.sin(n),h=a.y+m*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-m*(this.y-a.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(n){return n instanceof l?n:Array.isArray(n)?new l(n[0],n[1]):n},En}var je=O(Ye());function Mt(l,n){if(Array.isArray(l)){if(!Array.isArray(n)||l.length!==n.length)return!1;for(let a=0;a<l.length;a++)if(!Mt(l[a],n[a]))return!1;return!0}if(typeof l=="object"&&l!==null&&n!==null){if(typeof n!="object"||Object.keys(l).length!==Object.keys(n).length)return!1;for(const a in l)if(!Mt(l[a],n[a]))return!1;return!0}return l===n}const Pt=Math.PI/180,qt=180/Math.PI;function zt(l){return l*Pt}function Kt(l){return l*qt}const an=[[0,0],[1,0],[1,1],[0,1]];function un(l){if(l<=0)return 0;if(l>=1)return 1;const n=l*l,a=n*l;return 4*(l<.5?a:3*(l-n)+a-.75)}function Nn(l,n,a,u){const m=new Ve(l,n,a,u);return function(h){return m.solve(h)}}const Sn=Nn(.25,.1,.25,1);function Qt(l,n,a){return Math.min(a,Math.max(n,l))}function Hn(l,n,a){return(a=Qt((a-l)/(n-l),0,1))*a*(3-2*a)}function tr(l,n,a){const u=a-n,m=((l-n)%u+u)%u+n;return m===n?a:m}function Pr(l,n,a){if(!l.length)return a(null,[]);let u=l.length;const m=new Array(l.length);let h=null;l.forEach((g,b)=>{n(g,(T,P)=>{T&&(h=T),m[b]=P,--u==0&&a(h,m)})})}function nr(l,...n){for(const a of n)for(const u in a)l[u]=a[u];return l}let pi=1;function xi(){return pi++}function Yi(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Xi(l,n){l.forEach(a=>{n[a]&&(n[a]=n[a].bind(n))})}function Ai(l,n){return l.indexOf(n,l.length-n.length)!==-1}function xa(l,n,a){const u={};for(const m in l)u[m]=n.call(this,l[m],m,l);return u}function Bi(l,n,a){const u={};for(const m in l)n.call(this,l[m],m,l)&&(u[m]=l[m]);return u}function ci(l){return Array.isArray(l)?l.map(ci):typeof l=="object"&&l?xa(l,ci):l}const ba={};function kn(l){ba[l]||(typeof console<"u"&&console.warn(l),ba[l]=!0)}function ca(l,n,a){return(a.y-l.y)*(n.x-l.x)>(n.y-l.y)*(a.x-l.x)}function Bu(l){let n=0;for(let a,u,m=0,h=l.length,g=h-1;m<h;g=m++)a=l[m],u=l[g],n+=(u.x-a.x)*(a.y+u.y);return n}function Ao([l,n,a]){const u=zt(n+90),m=zt(a);return{x:l*Math.cos(u)*Math.sin(m),y:l*Math.sin(u)*Math.sin(m),z:l*Math.cos(m),azimuthal:n,polar:a}}function Ua(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Dl(l){const n={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,m,h)=>{const g=m||h;return n[u]=!g||g.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n}let Rl=null;function zl(l,n){return[l[4*n],l[4*n+1],l[4*n+2],l[4*n+3]]}function ku(l,n,a,u){for(;n<a;){const m=n+a>>1;l[m]<u?n=m+1:a=m}return n}function Ha(l,n,a,u){for(;n<a;){const m=n+a>>1;l[m]<=u?n=m+1:a=m}return n}function Js(l){return l>0?1/(1.001-l):1+l}function Ll(l){return l>0?1-1/(1.001-l):-l}const ni={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ni.API_URL)return null;try{const l=new URL(ni.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function $l(l){return ni.API_URL_REGEX.test(l)}function Pc(l){return ni.API_SPRITE_REGEX.test(l)}let Fl,Gi,ua,mt,ae,pe;function ye(){return Fl==null&&(Fl=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Fl}const De={now:()=>mt!==void 0?mt:performance.now(),setNow(l){mt=l},restoreNow(){mt=void 0},frame(l){const n=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(l,n=0){const{width:a,height:u}=l;ae||(ae=document.createElement("canvas"));const m=ae.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(a>ae.width||u>ae.height)&&(ae.width=a,ae.height=u),m.clearRect(-n,-n,a+2*n,u+2*n),m.drawImage(l,0,0,a,u),m.getImageData(-n,-n,a+2*n,u+2*n)},resolveURL:l=>(Gi||(Gi=document.createElement("a")),Gi.href=l,Gi.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ua==null&&(ua=window.matchMedia("(prefers-reduced-motion: reduce)")),ua.matches)},hasCanvasFingerprintNoise(){if(pe!==void 0)return pe;if(!ye())return pe=!1,!1;const l=new OffscreenCanvas(85,1),n=l.getContext("2d",{willReadFrequently:!0});let a=0;for(let m=0;m<l.width;++m)n.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,n.fillRect(m,0,1,1);const u=n.getImageData(0,0,l.width,l.height);a=0;for(let m=0;m<u.data.length;++m)if(m%4!=3&&a++!==u.data[m])return pe=!0,!0;return pe=!1,!1}};function ze(l,n){const a=l.indexOf("?");if(a<0)return`${l}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(l.slice(a));for(const m in n)u.set(m,n[m]);return`${l.slice(0,a)}?${u.toString()}`}function qe(l,n={persistentParams:[]}){const a=l.indexOf("?");if(a<0)return l;const u=new URLSearchParams,m=new URLSearchParams(l.slice(a));for(const g of n.persistentParams){const b=m.get(g);b&&u.set(g,b)}const h=u.toString();return`${l.slice(0,a)}${h.length>0?`?${h}`:""}`}const at="mapbox-tiles";let Xe=500,ht=50;const dt=["language","worldview","jobid"];let ft,At;function jt(){try{return caches}catch{}}function Wt(){const l=jt();l&&ft==null&&(ft=l.open(at))}let bn=1/0;const In={supported:!1,testSupport:function(l){!Kn&&Mn&&(rr?ar(l):An=l)}};let An,Mn,Kn=!1,rr=!1;const Gn=typeof self<"u"?self:{};function ar(l){const n=l.createTexture();l.bindTexture(l.TEXTURE_2D,n);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Mn),l.isContextLost())return;In.supported=!0}catch{}l.deleteTexture(n),Kn=!0}Gn.document&&(Mn=Gn.document.createElement("img"),Mn.onload=function(){An&&ar(An),An=null,rr=!0},Mn.onerror=function(){Kn=!0,An=null},Mn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const fr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(fr);class bi extends Error{constructor(n,a,u){a===401&&$l(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ga=Ua()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Li=function(l,n){if(!(/^file:/.test(a=l.url)||/^file:/.test(Ga())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,m){const h=new AbortController,g=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Ga(),referrerPolicy:u.referrerPolicy,signal:h.signal});let b=!1,T=!1;const P=(v=g.url).indexOf("sku=")>0&&$l(v);var v;u.type==="json"&&g.headers.set("Accept","application/json");const E=(C,M,D)=>{if(T)return;if(C&&C.message!=="SecurityError"&&kn(C.toString()),M&&D)return A(M);const k=Date.now();fetch(g).then(V=>{if(V.ok){const W=P?V.clone():null;return A(V,W,k)}return m(new bi(V.statusText,V.status,u.url))}).catch(V=>{V.name!=="AbortError"&&m(new Error(`${V.message} ${u.url}`))})},A=(C,M,D)=>{(u.type==="arrayBuffer"?C.arrayBuffer():u.type==="json"?C.json():C.text()).then(k=>{T||(M&&D&&function(V,W,Z){if(Wt(),ft==null)return;const H=Dl(W.headers.get("Cache-Control")||"");if(H["no-store"])return;const Q={status:W.status,statusText:W.statusText,headers:new Headers};W.headers.forEach((Se,we)=>Q.headers.set(we,Se)),H["max-age"]&&Q.headers.set("Expires",new Date(Z+1e3*H["max-age"]).toUTCString());const oe=Q.headers.get("Expires");if(!oe||new Date(oe).getTime()-Z<42e4)return;let fe=qe(V.url,{persistentParams:dt});if(W.status===206){const Se=V.headers.get("Range");if(!Se)return;Q.status=200,fe=ze(fe,{range:Se})}(function(Se,we){if(At===void 0)try{new Response(new ReadableStream),At=!0}catch{At=!1}At?we(Se.body):Se.blob().then(we)})(W,Se=>{const we=new Response((xe=W.status)!==200&&xe!==404&&[101,103,204,205,304].includes(xe)?null:Se,Q);var xe;Wt(),ft!=null&&ft.then(ke=>ke.put(fe,we)).catch(ke=>kn(ke.message))})}(g,M,D),b=!0,m(null,k,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(k=>{T||m(new Error(k.message))})};return P?function(C,M){if(Wt(),ft==null)return M(null);ft.then(D=>{let k=qe(C.url,{persistentParams:dt});const V=C.headers.get("Range");V&&(k=ze(k,{range:V})),D.match(k).then(W=>{const Z=function(H){if(!H)return!1;const Q=new Date(H.headers.get("Expires")||0),oe=Dl(H.headers.get("Cache-Control")||"");return Q>Date.now()&&!oe["no-cache"]}(W);D.delete(k),Z&&D.put(k,W.clone()),M(null,W,Z)}).catch(M)}).catch(M)}(g,E):E(null,null),{cancel:()=>{T=!0,b||h.abort()}}}(l,n);if(Ua()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,n,void 0,!0)}var a;return function(u,m){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const g in u.headers)h.setRequestHeader(g,u.headers[g]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{m(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let g=h.response;if(u.type==="json")try{g=JSON.parse(h.response)}catch(b){return m(b)}m(null,g,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else m(new bi(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(l,n)},ki=function(l,n){return Li(nr(l,{type:"arrayBuffer"}),n)};function So(l){const n=document.createElement("a");return n.href=l,n.protocol===location.protocol&&n.host===location.host}const Nu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let bs,Vu;bs=[],Vu=0;const xp=function(l,n){if(In.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Vu>=ni.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:l,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return bs.push(h),h}Vu++;let a=!1;const u=()=>{if(!a)for(a=!0,Vu--;bs.length&&Vu<ni.MAX_PARALLEL_IMAGE_REQUESTS;){const h=bs.shift(),{requestParameters:g,callback:b,cancelled:T}=h;T||(h.cancel=xp(g,b).cancel)}},m=ki(l,(h,g,b,T)=>{u(),h?n(h):g&&(self.createImageBitmap?function(P,v){const E=new Blob([new Uint8Array(P)],{type:"image/png"});createImageBitmap(E).then(A=>{v(null,A)}).catch(A=>{v(new Error(`Could not load image because of ${A.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(P,v)=>n(P,v,b,T)):function(P,v){const E=new Image;E.onload=()=>{v(null,E),URL.revokeObjectURL(E.src),E.onload=null,requestAnimationFrame(()=>{E.src=Nu})},E.onerror=()=>v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const A=new Blob([new Uint8Array(P)],{type:"image/png"});E.src=P.byteLength?URL.createObjectURL(A):Nu}(g,(P,v)=>n(P,v,b,T)))});return{cancel:()=>{m.cancel(),u()}}};var z_,bp,wp,Co={exports:{}},wa={exports:{}},ws={exports:{}},Wa=function(){if(wp)return Co.exports;wp=1;var l=(z_||(z_=1,wa.exports=function(a,u){var m,h,g,b,T,P,v,E;for(h=a.length-(m=3&a.length),g=u,T=3432918353,P=461845907,E=0;E<h;)v=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24,++E,g=27492+(65535&(b=5*(65535&(g=(g^=v=(65535&(v=(v=(65535&v)*T+(((v>>>16)*T&65535)<<16)&4294967295)<<15|v>>>17))*P+(((v>>>16)*P&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(v=0,m){case 3:v^=(255&a.charCodeAt(E+2))<<16;case 2:v^=(255&a.charCodeAt(E+1))<<8;case 1:g^=v=(65535&(v=(v=(65535&(v^=255&a.charCodeAt(E)))*T+(((v>>>16)*T&65535)<<16)&4294967295)<<15|v>>>17))*P+(((v>>>16)*P&65535)<<16)&4294967295}return g^=a.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),wa.exports),n=(bp||(bp=1,ws.exports=function(a,u){for(var m,h=a.length,g=u^h,b=0;h>=4;)m=1540483477*(65535&(m=255&a.charCodeAt(b)|(255&a.charCodeAt(++b))<<8|(255&a.charCodeAt(++b))<<16|(255&a.charCodeAt(++b))<<24))+((1540483477*(m>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:g^=(255&a.charCodeAt(b+2))<<16;case 2:g^=(255&a.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&a.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),ws.exports);return Co.exports=l,Co.exports.murmur3=l,Co.exports.murmur2=n,Co.exports}(),Sa=O(Wa);class qa{constructor(n,...a){nr(this,a[0]||{}),this.type=n}}class Th extends qa{constructor(n,a={}){super("error",nr({error:n},a))}}function Sp(l,n,a){a[l]&&a[l].indexOf(n)!==-1||(a[l]=a[l]||[],a[l].push(n))}function Qs(l,n,a){if(a&&a[l]){const u=a[l].indexOf(n);u!==-1&&a[l].splice(u,1)}}class el{on(n,a){return this._listeners=this._listeners||{},Sp(n,a,this._listeners),this}off(n,a){return Qs(n,a,this._listeners),Qs(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Sp(n,a,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,a){const u=typeof n=="string"?new qa(n,a):n,m=u.type;if(this.listens(m)){u.target=this;const h=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const T of h)T.call(this,u);const g=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const T of g)Qs(m,T,this._oneTimeListeners),T.call(this,u);const b=this._eventedParent;b&&(nr(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(u))}else u instanceof Th&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var L_,Cp={},da=function(){if(L_)return Cp;L_=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function a(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(g=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:g>1?1:g;var g}function m(h,g,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?h+(g-h)*b*6:2*b<1?g:3*b<2?h+(g-h)*(2/3-b)*6:h}try{Cp.parseCSSColor=function(h){var g,b=h.replace(/ /g,"").toLowerCase();if(b in l)return l[b].slice();if(b[0]==="#")return b.length===4?(g=parseInt(b.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:b.length===7&&(g=parseInt(b.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var T=b.indexOf("("),P=b.indexOf(")");if(T!==-1&&P+1===b.length){var v=b.substr(0,T),E=b.substr(T+1,P-(T+1)).split(","),A=1;switch(v){case"rgba":if(E.length!==4)return null;A=u(E.pop());case"rgb":return E.length!==3?null:[a(E[0]),a(E[1]),a(E[2]),A];case"hsla":if(E.length!==4)return null;A=u(E.pop());case"hsl":if(E.length!==3)return null;var C=(parseFloat(E[0])%360+360)%360/360,M=u(E[1]),D=u(E[2]),k=D<=.5?D*(M+1):D+M-D*M,V=2*D-k;return[n(255*m(V,k,C+1/3)),n(255*m(V,k,C)),n(255*m(V,k,C-1/3)),A];default:return null}}return null}}catch{}return Cp}();class mr{constructor(n,a,u,m=1){this.r=n,this.g=a,this.b=u,this.a=m}static parse(n){if(!n)return;if(n instanceof mr)return n;if(typeof n!="string")return;const a=da.parseCSSColor(n);return a?new mr(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toStringPremultipliedAlpha(){const[n,a,u,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(a)},${Math.round(u)},${m})`}toString(){const[n,a,u,m]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*a)},${Math.round(255*u)},${m})`}toRenderColor(n){const{r:a,g:u,b:m,a:h}=this;return new Tp(n,a,u,m,h)}clone(){return new mr(this.r,this.g,this.b,this.a)}}class Tp{constructor(n,a,u,m,h){if(n){const g=n.image.height,b=g*g;a=h===0?0:a/h*(g-1),u=h===0?0:u/h*(g-1),m=h===0?0:m/h*(g-1);const T=Math.floor(a),P=Math.floor(u),v=Math.floor(m),E=Math.ceil(a),A=Math.ceil(u),C=Math.ceil(m),M=a-T,D=u-P,k=m-v,V=n.image.data,W=4*(T+P*b+v*g),Z=4*(T+P*b+C*g),H=4*(T+A*b+v*g),Q=4*(T+A*b+C*g),oe=4*(E+P*b+v*g),fe=4*(E+P*b+C*g),Se=4*(E+A*b+v*g),we=4*(E+A*b+C*g);if(W<0||we>=V.length)throw new Error("out of range");this.r=Pn(Pn(Pn(V[W],V[Z],k),Pn(V[H],V[Q],k),D),Pn(Pn(V[oe],V[fe],k),Pn(V[Se],V[we],k),D),M)/255*h,this.g=Pn(Pn(Pn(V[W+1],V[Z+1],k),Pn(V[H+1],V[Q+1],k),D),Pn(Pn(V[oe+1],V[fe+1],k),Pn(V[Se+1],V[we+1],k),D),M)/255*h,this.b=Pn(Pn(Pn(V[W+2],V[Z+2],k),Pn(V[H+2],V[Q+2],k),D),Pn(Pn(V[oe+2],V[fe+2],k),Pn(V[Se+2],V[we+2],k),D),M)/255*h,this.a=h}else this.r=a,this.g=u,this.b=m,this.a=h}toArray(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[255*n/m,255*a/m,255*u/m,m]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:a,b:u,a:m}=this,h=Math.min(Math.max(n/m,0),1),g=Math.min(Math.max(a/m,0),1),b=Math.min(Math.max(u/m,0),1),T=Math.min(h,g,b),P=Math.max(h,g,b),v=(T+P)/2;if(T===P)return[0,0,100*v,m];const E=P-T,A=v>.5?E/(2-P-T):E/(P+T);let C=0;return P===h?C=(g-b)/E+(g<b?6:0):P===g?C=(b-h)/E+2:P===b&&(C=(h-g)/E+4),C*=60,[Math.min(Math.max(C,0),360),Math.min(Math.max(100*A,0),100),Math.min(Math.max(100*v,0),100),m]}toArray01(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[n/m,a/m,u/m,m]}toArray01Scaled(n){const{r:a,g:u,b:m,a:h}=this;return h===0?[0,0,0]:[a/h*n,u/h*n,m/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:a,b:u,a:m}=this;return[n,a,u,m]}toArray01Linear(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(n/m,2.2),Math.pow(a/m,2.2),Math.pow(u/m,2.2),m]}}function Pn(l,n,a){return l*(1-a)+n*a}function $_(l,n,a){return l.map((u,m)=>Pn(u,n[m],a))}mr.black=new mr(0,0,0,1),mr.white=new mr(1,1,1,1),mr.transparent=new mr(0,0,0,0),mr.red=new mr(1,0,0,1),mr.blue=new mr(0,0,1,1);var Eh=Object.freeze({__proto__:null,array:$_,color:function(l,n,a){return new mr(Pn(l.r,n.r,a),Pn(l.g,n.g,a),Pn(l.b,n.b,a),Pn(l.a,n.a,a))},number:Pn});function Mh(l,...n){for(const a of n)for(const u in a)l[u]=a[u];return l}class qn extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class Ih{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[u,m]of a)this.bindings[u]=m}concat(n){return new Ih(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Bl={kind:"null"},pn={kind:"number"},wr={kind:"string"},ir={kind:"boolean"},uo={kind:"color"},Ss={kind:"object"},dr={kind:"value"},ju={kind:"collator"},Za={kind:"formatted"},Uu={kind:"resolvedImage"};function Ki(l,n){return{kind:"array",itemType:l,N:n}}function ui(l){if(l.kind==="array"){const n=ui(l.itemType);return typeof l.N=="number"?`array<${n}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${n}>`}return l.kind}const Ep=[Bl,pn,wr,ir,uo,Za,Ss,Ki(dr),Uu];function Po(l,n){if(n.kind==="error")return null;if(l.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Po(l.itemType,n.itemType))&&(typeof l.N!="number"||l.N===n.N))return null}else{if(l.kind===n.kind)return null;if(l.kind==="value"){for(const a of Ep)if(!Po(a,n))return null}}return`Expected ${ui(l)} but found ${ui(n)} instead.`}function Ah(l,n){return n.some(a=>a.kind===l.kind)}function Hu(l,n){return n.some(a=>a==="null"?l===null:a==="array"?Array.isArray(l):a==="object"?l&&!Array.isArray(l)&&typeof l=="object":a===typeof l)}class Ph{constructor(n,a,u){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gu{constructor(n,a,u,m,h){this.text=n.normalize?n.normalize():n,this.image=a,this.scale=u,this.fontStack=m,this.textColor=h}}class ho{constructor(n){this.sections=n}static fromString(n){return new ho([new Gu(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof ho?n:ho.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const a of this.sections){if(a.image){n.push(["image",a.image.namePrimary]);continue}n.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class Ya{constructor(n,a){if(this.id=n,this.options=a||{params:{}},this.options.transform){const{a:u,b:m,c:h,d:g,e:b,f:T}=this.options.transform;this.options.transform=new DOMMatrix([u,m,h,g,b,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const a=JSON.parse(n),{a:u,b:m,c:h,d:g,e:b,f:T}=a.options.transform;return new DOMMatrix([u,m,h,g,b,T]),new Ya(a.id,a.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a,b:u,c:m,d:h,e:g,f:b}=this.options.transform;return n.options.transform={a,b:u,c:m,d:h,e:g,f:b},JSON.stringify(n)}}class io{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Ya(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Ya(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?io.build(n):n}static build(n,a,u,m){return n?new io({namePrimary:n,nameSecondary:a,optionsPrimary:u,optionsSecondary:m,available:!1}):null}}function Mp(l,n,a,u){return typeof l=="number"&&l>=0&&l<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[l,n,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[l,n,a,u]:[l,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Cs(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof mr||l instanceof Ph||l instanceof ho||l instanceof io)return!0;if(Array.isArray(l)){for(const n of l)if(!Cs(n))return!1;return!0}if(typeof l=="object"){for(const n in l)if(!Cs(l[n]))return!1;return!0}return!1}function ri(l){if(l===null)return Bl;if(typeof l=="string")return wr;if(typeof l=="boolean")return ir;if(typeof l=="number")return pn;if(l instanceof mr)return uo;if(l instanceof Ph)return ju;if(l instanceof ho)return Za;if(l instanceof io)return Uu;if(Array.isArray(l)){const n=l.length;let a;for(const u of l){const m=ri(u);if(a){if(a===m)continue;a=dr;break}a=m}return Ki(a||dr,n)}return Ss}function ha(l){const n=typeof l;return l===null?"":n==="string"||n==="number"||n==="boolean"?String(l):l instanceof mr?l.toStringPremultipliedAlpha():l instanceof ho||l instanceof io?l.toString():JSON.stringify(l)}class Ji{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Cs(n[1]))return a.error("invalid value");const u=n[1];let m=ri(u);const h=a.expectedType;return m.kind!=="array"||m.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(m=h),new Ji(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof mr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ho?this.value.serialize():this.value}}class wi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Wu={string:wr,number:pn,boolean:ir,object:Ss};class Ca{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let u,m=1;const h=n[0];if(h==="array"){let b,T;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in Wu)||P==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);b=Wu[P],m++}else b=dr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=n[2],m++}u=Ki(b,T)}else u=Wu[h];const g=[];for(;m<n.length;m++){const b=a.parse(n[m],m,dr);if(!b)return null;g.push(b)}return new Ca(u,g)}evaluate(n){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(n);if(!Po(this.type,ri(u)))return u;if(a===this.args.length-1)throw new wi(`The expression ${JSON.stringify(this.args[a].serialize())} evaluated to ${ui(ri(u))} but was expected to be of type ${ui(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,a=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){a.push(u.kind);const m=n.N;(typeof m=="number"||this.args.length>1)&&a.push(m)}}return a.concat(this.args.map(u=>u.serialize()))}}class kl{constructor(n){this.type=Za,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");const m=[];let h=!1;for(let g=1;g<=n.length-1;++g){const b=n[g];if(h&&typeof b=="object"&&!Array.isArray(b)){h=!1;let T=null;if(b["font-scale"]&&(T=a.parseObjectValue(b["font-scale"],g,"font-scale",pn),!T))return null;let P=null;if(b["text-font"]&&(P=a.parseObjectValue(b["text-font"],g,"text-font",Ki(wr)),!P))return null;let v=null;if(b["text-color"]&&(v=a.parseObjectValue(b["text-color"],g,"text-color",uo),!v))return null;const E=m[m.length-1];E.scale=T,E.font=P,E.textColor=v}else{const T=a.parse(n[g],g,dr);if(!T)return null;const P=T.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,m.push({content:T,scale:null,font:null,textColor:null})}}return new kl(m)}evaluate(n){return new ho(this.sections.map(a=>{const u=a.content.evaluate(n);return ri(u)===Uu?new Gu("",u,null,null,null):new Gu(ha(u),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const a of this.sections){n.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),n.push(u)}return n}}class qu{constructor(n,a,u,m){this._imageWarnHistory={},this.type=Uu,this.inputPrimary=n,this.inputSecondary=a,this.inputPrimaryParams=u,this.inputSecondaryParams=m}static parse(n,a){if(n.length<2)return a.error("Expected two or more arguments.");let u=1;const m=[];function h(){if(u<n.length){const b=a.parse(n[u],u++,wr);return b?(m.push({image:b,options:void 0}),!0):(a.error(m.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function g(){if(u<n.length){if((b=n[u])===null||typeof b!="object"||Array.isArray(b))return!0;const T=n[u].params,P=a.concat(u);if(!T)return u++,!0;if(typeof T!="object"||T.constructor!==Object)return P.error('Image options "params" should be an object'),!1;const v={},E=P.concat(void 0,"params");for(const A in T){if(!A)return E.error("Image parameter name should be non-empty"),!1;const C=E.concat(void 0,A).parse(T[A],void 0,uo,void 0,{typeAnnotation:"coerce"});if(!C)return!1;v[A]=C}return m[m.length-1].options=v,u++,!0}var b;return!0}for(let b=0;b<2;b++)if(!h()||!g())return;return new qu(m[0].image,m[1]?m[1].image:void 0,m[0].options,m[1]?m[1].options:void 0)}evaluateParams(n,a){const u={};if(a){for(const m in a)if(a[m])try{const h=a[m].evaluate(n),g=`Ignoring image parameter "${m}" with semi-transparent color ${h.toString()}`;if(h.a!==1){this._imageWarnHistory[g]||(console.warn(g),this._imageWarnHistory[g]=!0);continue}u[m]=h}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(n){const a=io.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return a&&n.availableImages&&(a.available=n.availableImages.indexOf(a.namePrimary)>-1,a.nameSecondary&&a.available&&n.availableImages&&(a.available=n.availableImages.indexOf(a.nameSecondary)>-1)),a}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const a in this.inputPrimaryParams)this.inputPrimaryParams[a]&&n(this.inputPrimaryParams[a]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const a in this.inputSecondaryParams)this.inputSecondaryParams[a]&&n(this.inputSecondaryParams[a])}outputDefined(){return!1}serializeParams(n){const a={};if(n){for(const u in n)n[u]&&(a[u]=n[u].serialize());return{params:a}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function Ta(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const Ip={"to-boolean":ir,"to-color":uo,"to-number":pn,"to-string":wr};class Ts{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[0],m=[];let h=Bl;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const g=n[1].length;if(a.expectedType){if(a.expectedType.kind!=="array")return a.error(`Expected ${a.expectedType.kind} but found array.`);h=Ki(a.expectedType.itemType,g)}else{if(!(g>0&&Cs(n[1][0])))return null;h=Ki(ri(n[1][0]),g)}for(let b=0;b<g;b++){const T=n[1][b];let P;if(Ta(T)==="array")P=a.parse(T,void 0,h.itemType);else{const v=Ta(T);if(v!==h.itemType.kind)return a.error(`Expected ${h.itemType.kind} but found ${v}.`);P=a.registry.literal.parse(["literal",T===void 0?null:T],a)}if(!P)return null;m.push(P)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return a.error("Expected one argument.");h=Ip[u];for(let g=1;g<n.length;g++){const b=a.parse(n[g],g,dr);if(!b)return null;m.push(b)}}return new Ts(h,m)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let a,u;for(const m of this.args){if(a=m.evaluate(n),u=null,a instanceof mr)return a;if(typeof a=="string"){const h=n.parseColor(a);if(h)return h}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Mp(a[0],a[1],a[2],a[3]),!u))return new mr(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new wi(u||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const u of this.args){if(a=u.evaluate(n),a===null)return 0;const m=Number(a);if(!isNaN(m))return m}throw new wi(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?ho.fromString(ha(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?io.build(ha(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(a=>a.evaluate(n)):ha(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new kl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qu(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{n.push(a.serialize())}),n}}const kx=["Unknown","Point","LineString","Polygon"];class Ap{constructor(n,a){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=a}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?kx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-n[0])+this.featureDistanceData.bearing[1]*(m*a-n[1])}return 0}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=mr.parse(n)),a}getConfig(n){return this.options?this.options.get(n):null}}class Oo{constructor(n,a,u,m,h){this.name=n,this.type=a,this._evaluate=u,this.args=m,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const a=Oo.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,a){const u=n[0],m=Oo.definitions[u];if(!m)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(m)?m[0]:m.type,g=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=[];let T=null,P=-1;for(const[v,E]of g){if(Array.isArray(v)&&v.length!==n.length-1)continue;b.push(v),P++,T=new rd(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const A=[];let C=!1;for(let M=1;M<n.length;M++){const D=n[M],k=Array.isArray(v)?v[M-1]:v.type,V=T.parse(D,1+A.length,k);if(!V){C=!0;break}A.push(V)}if(!C)if(Array.isArray(v)&&v.length!==A.length)T.error(`Expected ${v.length} arguments, but found ${A.length} instead.`);else{for(let M=0;M<A.length;M++){const D=Array.isArray(v)?v[M]:v.type,k=A[M];T.concat(M+1).checkSubtype(D,k.type)}if(T.errors.length===0)return new Oo(u,h,E,A,P)}}if(b.length===1)a.errors.push(...T.errors);else{const v=(b.length?b:g.map(([A])=>A)).map(Pp).join(" | "),E=[];for(let A=1;A<n.length;A++){const C=a.parse(n[A],1+E.length);if(!C)return null;E.push(ui(C.type))}a.error(`Expected arguments of type ${v}, but found (${E.join(", ")}) instead.`)}return null}static register(n,a){Oo.definitions=a;for(const u in a)n[u]=Oo}}function Pp(l){return Array.isArray(l)?`(${l.map(ui).join(", ")})`:`(${ui(l.type)}...)`}class Oh{constructor(n,a,u){this.type=ju,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");const m=u["case-sensitive"]===void 0?a.parse(!1,1,ir):a.parseObjectValue(u["case-sensitive"],1,"case-sensitive",ir);if(!m)return null;const h=u["diacritic-sensitive"]===void 0?a.parse(!1,1,ir):a.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",ir);if(!h)return null;let g=null;return u.locale&&(g=a.parseObjectValue(u.locale,1,"locale",wr),!g)?null:new Oh(m,h,g)}evaluate(n){return new Ph(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function Zu(l,n,a=0,u=l.length-1,m=Nx){for(;u>a;){if(u-a>600){const T=u-a+1,P=n-a+1,v=Math.log(T),E=.5*Math.exp(2*v/3),A=.5*Math.sqrt(v*E*(T-E)/T)*(P-T/2<0?-1:1);Zu(l,n,Math.max(a,Math.floor(n-P*E/T+A)),Math.min(u,Math.floor(n+(T-P)*E/T+A)),m)}const h=l[n];let g=a,b=u;for(Yu(l,a,n),m(l[u],h)>0&&Yu(l,a,u);g<b;){for(Yu(l,g,b),g++,b--;m(l[g],h)<0;)g++;for(;m(l[b],h)>0;)b--}m(l[a],h)===0?Yu(l,a,b):(b++,Yu(l,b,u)),b<=n&&(a=b+1),n<=b&&(u=b-1)}}function Yu(l,n,a){const u=l[n];l[n]=l[a],l[a]=u}function Nx(l,n){return l<n?-1:l>n?1:0}function Vx(l){let n=0;for(let a,u,m=0,h=l.length,g=h-1;m<h;g=m++)a=l[m],u=l[g],n+=(u.x-a.x)*(a.y+u.y);return n}function Xu(l,n){l[0]=Math.min(l[0],n[0]),l[1]=Math.min(l[1],n[1]),l[2]=Math.max(l[2],n[0]),l[3]=Math.max(l[3],n[1])}function Ku(l,n){return!(l[0]<=n[0]||l[2]>=n[2]||l[1]<=n[1]||l[3]>=n[3])}function jx(l,n,a){const u=l[0]-n[0],m=l[1]-n[1],h=l[0]-a[0],g=l[1]-a[1];return u*g-h*m==0&&u*h<=0&&m*g<=0}function Oc(l,n,a=!1){let u=!1;for(let b=0,T=n.length;b<T;b++){const P=n[b];for(let v=0,E=P.length,A=E-1;v<E;A=v++){const C=P[A],M=P[v];if(jx(l,C,M))return a;(h=C)[1]>(m=l)[1]!=(g=M)[1]>m[1]&&m[0]<(g[0]-h[0])*(m[1]-h[1])/(g[1]-h[1])+h[0]&&(u=!u)}}var m,h,g;return u}function Op(l,n,a,u){const m=u[0]-a[0],h=u[1]-a[1],g=(l[0]-a[0])*h-m*(l[1]-a[1]),b=(n[0]-a[0])*h-m*(n[1]-a[1]);return g>0&&b<0||g<0&&b>0}function Es(l,n,a,u){return(m=[u[0]-a[0],u[1]-a[1]])[0]*(h=[n[0]-l[0],n[1]-l[1]])[1]-m[1]*h[0]!=0&&!(!Op(l,n,a,u)||!Op(a,u,l,n));var m,h}const tl=8192;function Ux(l,n){const a=(180+l[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(a*m*tl),Math.round(u*m*tl)]}function Dp(l,n){for(let a=0;a<n.length;a++)if(Oc(l,n[a]))return!0;return!1}function Hx(l,n,a){for(const u of a)for(let m=0,h=u.length,g=h-1;m<h;g=m++)if(Es(l,n,u[g],u[m]))return!0;return!1}function F_(l,n){for(let a=0;a<l.length;++a)if(!Oc(l[a],n))return!1;for(let a=0;a<l.length-1;++a)if(Hx(l[a],l[a+1],n))return!1;return!0}function Gx(l,n){for(let a=0;a<n.length;a++)if(F_(l,n[a]))return!0;return!1}function Rp(l,n,a){const u=[];for(let m=0;m<l.length;m++){const h=[];for(let g=0;g<l[m].length;g++){const b=Ux(l[m][g],a);Xu(n,b),h.push(b)}u.push(h)}return u}function Nl(l,n,a){const u=[];for(let m=0;m<l.length;m++){const h=Rp(l[m],n,a);u.push(h)}return u}function Wn(l,n,a,u){if(l[0]<a[0]||l[0]>a[2]){const m=.5*u;let h=l[0]-a[0]>m?-u:a[0]-l[0]>m?u:0;h===0&&(h=l[0]-a[2]>m?-u:a[2]-l[0]>m?u:0),l[0]+=h}Xu(n,l)}function Cn(l,n,a,u){const m=Math.pow(2,u.z)*tl,h=[u.x*tl,u.y*tl],g=[];if(!l)return g;for(const b of l)for(const T of b){const P=[T.x+h[0],T.y+h[1]];Wn(P,n,a,m),g.push(P)}return g}function Dh(l,n,a,u){const m=Math.pow(2,u.z)*tl,h=[u.x*tl,u.y*tl],g=[];if(!l)return g;for(const T of l){const P=[];for(const v of T){const E=[v.x+h[0],v.y+h[1]];Xu(n,E),P.push(E)}g.push(P)}if(n[2]-n[0]<=m/2){(b=n)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const T of g)for(const P of T)Wn(P,n,a,m)}var b;return g}class Rn{constructor(n,a){this.type=ir,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Cs(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let m=0;m<u.features.length;++m){const h=u.features[m].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Rn(u,u.features[m].geometry)}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Rn(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Rn(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=a.canonicalID();if(!g)return!1;if(u.type==="Polygon"){const b=Rp(u.coordinates,h,g),T=Cn(a.geometry(),m,h,g);if(!Ku(m,h))return!1;for(const P of T)if(!Oc(P,b))return!1}if(u.type==="MultiPolygon"){const b=Nl(u.coordinates,h,g),T=Cn(a.geometry(),m,h,g);if(!Ku(m,h))return!1;for(const P of T)if(!Dp(P,b))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=a.canonicalID();if(!g)return!1;if(u.type==="Polygon"){const b=Rp(u.coordinates,h,g),T=Dh(a.geometry(),m,h,g);if(!Ku(m,h))return!1;for(const P of T)if(!F_(P,b))return!1}if(u.type==="MultiPolygon"){const b=Nl(u.coordinates,h,g),T=Dh(a.geometry(),m,h,g);if(!Ku(m,h))return!1;for(const P of T)if(!Gx(P,b))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Dc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Rh=1/298.257223563,Ln=Rh*(2-Rh),Rc=Math.PI/180;class Vl{static fromTile(n,a,u){const m=Math.PI*(1-2*(n+.5)/Math.pow(2,a)),h=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/Rc;return new Vl(h,u)}static get units(){return Dc}constructor(n,a){if(n===void 0)throw new Error("No latitude given.");if(a&&!Dc[a])throw new Error(`Unknown unit ${a}. Use one of: ${Object.keys(Dc).join(", ")}`);const u=6378.137*Rc*(a?Dc[a]:1),m=Math.cos(n*Rc),h=1/(1-Ln*(1-m*m)),g=Math.sqrt(h);this.kx=u*g*m,this.ky=u*g*h*(1-Ln)}distance(n,a){const u=Do(n[0]-a[0])*this.kx,m=(n[1]-a[1])*this.ky;return Math.sqrt(u*u+m*m)}bearing(n,a){const u=Do(a[0]-n[0])*this.kx;return Math.atan2(u,(a[1]-n[1])*this.ky)/Rc}destination(n,a,u){const m=u*Rc;return this.offset(n,Math.sin(m)*a,Math.cos(m)*a)}offset(n,a,u){return[n[0]+a/this.kx,n[1]+u/this.ky]}lineDistance(n){let a=0;for(let u=0;u<n.length-1;u++)a+=this.distance(n[u],n[u+1]);return a}area(n){let a=0;for(let u=0;u<n.length;u++){const m=n[u];for(let h=0,g=m.length,b=g-1;h<g;b=h++)a+=Do(m[h][0]-m[b][0])*(m[h][1]+m[b][1])*(u?-1:1)}return Math.abs(a)/2*this.kx*this.ky}along(n,a){let u=0;if(a<=0)return n[0];for(let m=0;m<n.length-1;m++){const h=n[m],g=n[m+1],b=this.distance(h,g);if(u+=b,u>a)return zh(h,g,(a-(u-b))/b)}return n[n.length-1]}pointToSegmentDistance(n,a,u){let[m,h]=a,g=Do(u[0]-m)*this.kx,b=(u[1]-h)*this.ky;if(g!==0||b!==0){const T=(Do(n[0]-m)*this.kx*g+(n[1]-h)*this.ky*b)/(g*g+b*b);T>1?(m=u[0],h=u[1]):T>0&&(m+=g/this.kx*T,h+=b/this.ky*T)}return g=Do(n[0]-m)*this.kx,b=(n[1]-h)*this.ky,Math.sqrt(g*g+b*b)}pointOnLine(n,a){let u=1/0,m=n[0][0],h=n[0][1],g=0,b=0;for(let T=0;T<n.length-1;T++){let P=n[T][0],v=n[T][1],E=Do(n[T+1][0]-P)*this.kx,A=(n[T+1][1]-v)*this.ky,C=0;E===0&&A===0||(C=(Do(a[0]-P)*this.kx*E+(a[1]-v)*this.ky*A)/(E*E+A*A),C>1?(P=n[T+1][0],v=n[T+1][1]):C>0&&(P+=E/this.kx*C,v+=A/this.ky*C)),E=Do(a[0]-P)*this.kx,A=(a[1]-v)*this.ky;const M=E*E+A*A;M<u&&(u=M,m=P,h=v,g=T,b=C)}return{point:[m,h],index:g,t:Math.max(0,Math.min(1,b))}}lineSlice(n,a,u){let m=this.pointOnLine(u,n),h=this.pointOnLine(u,a);if(m.index>h.index||m.index===h.index&&m.t>h.t){const P=m;m=h,h=P}const g=[m.point],b=m.index+1,T=h.index;!zp(u[b],g[0])&&b<=T&&g.push(u[b]);for(let P=b+1;P<=T;P++)g.push(u[P]);return zp(u[T],h.point)||g.push(h.point),g}lineSliceAlong(n,a,u){let m=0;const h=[];for(let g=0;g<u.length-1;g++){const b=u[g],T=u[g+1],P=this.distance(b,T);if(m+=P,m>n&&h.length===0&&h.push(zh(b,T,(n-(m-P))/P)),m>=a)return h.push(zh(b,T,(a-(m-P))/P)),h;m>n&&h.push(T)}return h}bufferPoint(n,a){const u=a/this.ky,m=a/this.kx;return[n[0]-m,n[1]-u,n[0]+m,n[1]+u]}bufferBBox(n,a){const u=a/this.ky,m=a/this.kx;return[n[0]-m,n[1]-u,n[2]+m,n[3]+u]}insideBBox(n,a){return Do(n[0]-a[0])>=0&&Do(n[0]-a[2])<=0&&n[1]>=a[1]&&n[1]<=a[3]}}function zp(l,n){return l[0]===n[0]&&l[1]===n[1]}function zh(l,n,a){const u=Do(n[0]-l[0]);return[l[0]+u*a,l[1]+(n[1]-l[1])*a]}function Do(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class oo{constructor(n=[],a=(u,m)=>u<m?-1:u>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:u}=this,m=a[n];for(;n>0;){const h=n-1>>1,g=a[h];if(u(m,g)>=0)break;a[n]=g,n=h}a[n]=m}_down(n){const{data:a,compare:u}=this,m=this.length>>1,h=a[n];for(;n<m;){let g=1+(n<<1);const b=g+1;if(b<this.length&&u(a[b],a[g])<0&&(g=b),u(a[g],h)>=0)break;a[n]=a[g],n=g}a[n]=h}}var Yt=8192;function Lp(l,n){return n.dist-l.dist}const Lh=100,Ju=50;function nl(l){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==l.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==l[a])return!1;return!0}function Qi(l){return l[1]-l[0]+1}function Ms(l,n){const a=l[1]>=l[0]&&l[1]<n;return a||console.warn("Distance Expression: Index is out of range"),a}function $p(l,n){if(l[0]>l[1])return[null,null];const a=Qi(l);if(n){if(a===2)return[l,null];const u=Math.floor(a/2);return[[l[0],l[0]+u],[l[0]+u,l[1]]]}{if(a===1)return[l,null];const u=Math.floor(a/2)-1;return[[l[0],l[0]+u],[l[0]+u+1,l[1]]]}}function jl(l,n){const a=[1/0,1/0,-1/0,-1/0];if(!Ms(n,l.length))return a;for(let u=n[0];u<=n[1];++u)Xu(a,l[u]);return a}function Ul(l){const n=[1/0,1/0,-1/0,-1/0];for(let a=0;a<l.length;++a)for(let u=0;u<l[a].length;++u)Xu(n,l[a][u]);return n}function Hl(l,n,a){if(nl(l)||nl(n))return NaN;let u=0,m=0;return l[2]<n[0]&&(u=n[0]-l[2]),l[0]>n[2]&&(u=l[0]-n[2]),l[1]>n[3]&&(m=l[1]-n[3]),l[3]<n[1]&&(m=n[1]-l[3]),a.distance([0,0],[u,m])}function Fp(l){return 360*l-180}function Wx(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Bp(l,n){const a=Math.pow(2,n.z),u=(l.y/Yt+n.y)/a;return[Fp((l.x/Yt+n.x)/a),Wx(u)]}function qx(l,n){const a=[];for(let u=0;u<l.length;++u)a.push(Bp(l[u],n));return a}function B_(l,n,a){const u=a.pointOnLine(n,l).point;return a.distance(l,u)}function kp(l,n,a,u,m){const h=a.slice(u[0],u[1]+1);let g=1/0;for(let b=n[0];b<=n[1];++b)if((g=Math.min(g,B_(l[b],h,m)))===0)return 0;return g}function Np(l,n,a,u,m){const h=Math.min(m.pointToSegmentDistance(l,a,u),m.pointToSegmentDistance(n,a,u)),g=Math.min(m.pointToSegmentDistance(a,l,n),m.pointToSegmentDistance(u,l,n));return Math.min(h,g)}function Zx(l,n,a,u,m){if(!Ms(n,l.length)||!Ms(u,a.length))return NaN;let h=1/0;for(let g=n[0];g<n[1];++g)for(let b=u[0];b<u[1];++b){if(Es(l[g],l[g+1],a[b],a[b+1]))return 0;h=Math.min(h,Np(l[g],l[g+1],a[b],a[b+1],m))}return h}function k_(l,n,a,u,m){if(!Ms(n,l.length)||!Ms(u,a.length))return NaN;let h=1/0;for(let g=n[0];g<=n[1];++g)for(let b=u[0];b<=u[1];++b)if((h=Math.min(h,m.distance(l[g],a[b])))===0)return h;return h}function Gl(l,n,a){if(Oc(l,n,!0))return 0;let u=1/0;for(const m of n){const h=m.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[h-1]&&(u=Math.min(u,a.pointToSegmentDistance(l,m[h-1],m[0])))===0||(u=Math.min(u,B_(l,m,a)))===0)return u}return u}function Yx(l,n,a,u){if(!Ms(n,l.length))return NaN;for(let h=n[0];h<=n[1];++h)if(Oc(l[h],a,!0))return 0;let m=1/0;for(let h=n[0];h<n[1];++h)for(const g of a)for(let b=0,T=g.length,P=T-1;b<T;P=b++){if(Es(l[h],l[h+1],g[P],g[b]))return 0;m=Math.min(m,Np(l[h],l[h+1],g[P],g[b],u))}return m}function N_(l,n){for(const a of l)for(let u=0;u<=a.length-1;++u)if(Oc(a[u],n,!0))return!0;return!1}function Vp(l,n,a,u=1/0){const m=Ul(l),h=Ul(n);if(u!==1/0&&Hl(m,h,a)>=u)return u;if(Ku(m,h)){if(N_(l,n))return 0}else if(N_(n,l))return 0;let g=u;for(const b of l)for(let T=0,P=b.length,v=P-1;T<P;v=T++)for(const E of n)for(let A=0,C=E.length,M=C-1;A<C;M=A++){if(Es(b[v],b[T],E[M],E[A]))return 0;g=Math.min(g,Np(b[v],b[T],E[M],E[A],a))}return g}function Qu(l,n,a,u,m,h,g){if(h===null||g===null)return;const b=Hl(jl(u,h),jl(m,g),a);b<n&&l.push({dist:b,range1:h,range2:g})}function V_(l,n,a,u,m=1/0){let h=Math.min(u.distance(l[0],a[0][0]),m);if(h===0)return h;const g=new oo([{dist:0,range1:[0,l.length-1],range2:[0,0]}],Lp),b=n?Ju:Lh,T=Ul(a);for(;g.length;){const P=g.pop();if(P.dist>=h)continue;const v=P.range1;if(Qi(v)<=b){if(!Ms(v,l.length))return NaN;if(n){const E=Yx(l,v,a,u);if((h=Math.min(h,E))===0)return h}else for(let E=v[0];E<=v[1];++E){const A=Gl(l[E],a,u);if((h=Math.min(h,A))===0)return h}}else{const E=$p(v,n);if(E[0]!==null){const A=Hl(jl(l,E[0]),T,u);A<h&&g.push({dist:A,range1:E[0],range2:[0,0]})}if(E[1]!==null){const A=Hl(jl(l,E[1]),T,u);A<h&&g.push({dist:A,range1:E[1],range2:[0,0]})}}}return h}function fa(l,n,a,u,m,h=1/0){let g=Math.min(h,m.distance(l[0],a[0]));if(g===0)return g;const b=new oo([{dist:0,range1:[0,l.length-1],range2:[0,a.length-1]}],Lp),T=n?Ju:Lh,P=u?Ju:Lh;for(;b.length;){const v=b.pop();if(v.dist>=g)continue;const E=v.range1,A=v.range2;if(Qi(E)<=T&&Qi(A)<=P){if(!Ms(E,l.length)||!Ms(A,a.length))return NaN;if(n&&u?g=Math.min(g,Zx(l,E,a,A,m)):n||u?n&&!u?g=Math.min(g,kp(a,A,l,E,m)):!n&&u&&(g=Math.min(g,kp(l,E,a,A,m))):g=Math.min(g,k_(l,E,a,A,m)),g===0)return g}else{const C=$p(E,n),M=$p(A,u);Qu(b,g,m,l,a,C[0],M[0]),Qu(b,g,m,l,a,C[0],M[1]),Qu(b,g,m,l,a,C[1],M[0]),Qu(b,g,m,l,a,C[1],M[1])}}return g}function $h(l,n,a,u,m=1/0){let h=m;const g=jl(l,[0,l.length-1]);for(const b of a)if(!(h!==1/0&&Hl(g,jl(b,[0,b.length-1]),u)>=h)&&(h=Math.min(h,fa(l,n,b,!0,u,h)),h===0))return h;return h}function ed(l,n,a,u,m=1/0){let h=m;const g=jl(l,[0,l.length-1]);for(const b of a){if(h!==1/0&&Hl(g,Ul(b),u)>=h)continue;const T=V_(l,n,b,u,h);if(isNaN(T))return T;if((h=Math.min(h,T))===0)return h}return h}function Fh(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class rl{constructor(n,a){this.type=pn,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Cs(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let m=0;m<u.features.length;++m)if(Fh(u.features[m].geometry.type))return new rl(u,u.features[m].geometry)}else if(u.type==="Feature"){if(Fh(u.geometry.type))return new rl(u,u.geometry)}else if(Fh(u.type))return new rl(u,u)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const a=n.geometry(),u=n.canonicalID();if(a!=null&&u!=null){if(n.geometryType()==="Point")return function(m,h,g){const b=[];for(const P of m)for(const v of P)b.push(Bp(v,h));const T=new Vl(b[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?fa(b,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",T):g.type==="MultiLineString"?$h(b,!1,g.coordinates,T):g.type==="Polygon"||g.type==="MultiPolygon"?ed(b,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,T):null}(a,u,this.geometries);if(n.geometryType()==="LineString")return function(m,h,g){const b=[];for(const P of m){const v=[];for(const E of P)v.push(Bp(E,h));b.push(v)}const T=new Vl(b[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return $h(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,T);if(g.type==="MultiLineString"){let P=1/0;for(let v=0;v<g.coordinates.length;v++){const E=$h(g.coordinates[v],!0,b,T,P);if(isNaN(E))return E;if((P=Math.min(P,E))===0)return P}return P}if(g.type==="Polygon"||g.type==="MultiPolygon"){let P=1/0;for(let v=0;v<b.length;v++){const E=ed(b[v],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,T,P);if(isNaN(E))return E;if((P=Math.min(P,E))===0)return P}return P}return null}(a,u,this.geometries);if(n.geometryType()==="Polygon")return function(m,h,g){const b=[];for(const P of function(v,E){const A=v.length;if(A<=1)return[v];const C=[];let M,D;for(let k=0;k<A;k++){const V=Vx(v[k]);V!==0&&(v[k].area=Math.abs(V),D===void 0&&(D=V<0),D===V<0?(M&&C.push(M),M=[v[k]]):M.push(v[k]))}return M&&C.push(M),C}(m)){const v=[];for(let E=0;E<P.length;++E)v.push(qx(P[E],h));b.push(v)}const T=new Vl(b[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return ed(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,T);if(g.type==="MultiLineString"){let P=1/0;for(let v=0;v<g.coordinates.length;v++){const E=ed(g.coordinates[v],!0,b,T,P);if(isNaN(E))return E;if((P=Math.min(P,E))===0)return P}return P}return g.type==="Polygon"||g.type==="MultiPolygon"?function(P,v,E){let A=1/0;for(const C of P)for(const M of v){const D=Vp(C,M,E,A);if(isNaN(D))return D;if((A=Math.min(A,D))===0)return A}return A}(g.type==="Polygon"?[g.coordinates]:g.coordinates,b,T):null}(a,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Bh(l,n){switch(l){case"string":return ha(n);case"number":return+n;case"boolean":return!!n;case"color":return mr.parse(n);case"formatted":return ho.fromString(ha(n));case"resolvedImage":return io.build(ha(n))}return n}function jp(l,n,a,u){return u!==void 0&&(l=u*Math.round(l/u)),n!==void 0&&l<n&&(l=n),a!==void 0&&l>a&&(l=a),l}class Wl{constructor(n,a,u){this.type=n,this.key=a,this.scope=u}static parse(n,a){let u=a.expectedType;if(u==null&&(u=dr),n.length<2||n.length>3)return a.error("Invalid number of arguments for 'config' expression.");const m=a.parse(n[1],1);if(!(m instanceof Ji))return a.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=a.parse(n[2],2);return h instanceof Ji?new Wl(u,ha(m.value),ha(h.value)):a.error("Scope of 'config' expression must be a string literal.")}return new Wl(u,ha(m.value))}evaluate(n){const a=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(a);if(!u)return null;const{type:m,value:h,values:g,minValue:b,maxValue:T,stepValue:P}=u,v=u.default.evaluate(n);let E=v;if(h){const A=n.scope;n.scope=(A||"").split("").slice(1).join(""),E=h.evaluate(n),n.scope=A}return m&&(E=Bh(m,E)),E===void 0||b===void 0&&T===void 0&&P===void 0||(typeof E=="number"?E=jp(E,b,T,P):Array.isArray(E)&&(E=E.map(A=>typeof A=="number"?jp(A,b,T,P):A))),h!==void 0&&E!==void 0&&g&&!g.includes(E)&&(E=v,m&&(E=Bh(m,E))),(m&&m!==this.type||E!==void 0&&ri(E)!==this.type)&&(E=Bh(this.type.kind,E)),E}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function zc(l){if(l instanceof Oo&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Rn||l instanceof rl)return!1;let n=!0;return l.eachChild(a=>{n&&!zc(a)&&(n=!1)}),n}function td(l){if(l instanceof Oo&&l.name==="feature-state")return!1;let n=!0;return l.eachChild(a=>{n&&!td(a)&&(n=!1)}),n}function nd(l){if(l instanceof Wl)return new Set([l.key]);let n=new Set;return l.eachChild(a=>{n=new Set([...n,...nd(a)])}),n}function ql(l,n){if(l instanceof Oo&&n.indexOf(l.name)>=0)return!1;let a=!0;return l.eachChild(u=>{a&&!ql(u,n)&&(a=!1)}),a}class Zl{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const u=n[1];return a.scope.has(u)?new Zl(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Lc{constructor(n,a=[],u,m=new Ih,h=[],g,b){this.registry=n,this.path=a,this.key=a.map(T=>typeof T=="string"?`['${T}']`:`[${T}]`).join(""),this.scope=m,this.errors=h,this.expectedType=u,this._scope=g,this.options=b}parse(n,a,u,m,h={}){return a||u?this.concat(a,null,u,m)._parse(n,h):this._parse(n,h)}parseObjectValue(n,a,u,m,h,g={}){return this.concat(a,u,m,h)._parse(n,g)}_parse(n,a){function u(m,h,g){return g==="assert"?new Ca(h,[m]):g==="coerce"?new Ts(h,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(m){let h=m.parse(n,this);if(!h)return null;if(this.expectedType){const g=this.expectedType,b=h.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||b.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(g,b))return null}else h=u(h,g,a.typeAnnotation||"coerce");else h=u(h,g,a.typeAnnotation||"assert")}if(!(h instanceof Ji)&&h.type.kind!=="resolvedImage"&&kh(h)){const g=new Ap(this._scope,this.options);try{h=new Ji(h.type,h.evaluate(g))}catch(b){return this.error(b.message),null}}return h}return Ts.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,u,m){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof a=="string"?h.concat(a):h;const g=m?this.scope.concat(m):this.scope;return new Lc(this.registry,h,u||null,g,this.errors,this._scope,this.options)}error(n,...a){const u=`${this.key}${a.map(m=>`[${m}]`).join("")}`;this.errors.push(new qn(u,n))}checkSubtype(n,a){const u=Po(n,a);return u&&this.error(u),u}}var rd=Lc;function kh(l){if(l instanceof Zl)return kh(l.boundExpression);if(l instanceof Oo&&l.name==="error"||l instanceof Oh||l instanceof Rn||l instanceof rl||l instanceof Wl)return!1;const n=l instanceof Ts||l instanceof Ca;let a=!0;return l.eachChild(u=>{a=n?a&&kh(u):a&&u instanceof Ji}),!!a&&zc(l)&&ql(l,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function id(l,n){const a=l.length-1;let u,m,h=0,g=a,b=0;for(;h<=g;)if(b=Math.floor((h+g)/2),u=l[b],m=l[b+1],u<=n){if(b===a||n<m)return b;h=b+1}else{if(!(u>n))throw new wi("Input is not a number.");g=b-1}return 0}class $c{constructor(n,a,u){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[m,h]of u)this.labels.push(m),this.outputs.push(h)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(n[1],1,pn);if(!u)return null;const m=[];let h=null;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);for(let g=1;g<n.length;g+=2){const b=g===1?-1/0:n[g],T=n[g+1],P=g,v=g+1;if(typeof b!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(m.length&&m[m.length-1][0]>=b)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const E=a.parse(T,v,h);if(!E)return null;h=h||E.type,m.push([b,E])}return new $c(h,u,m)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=a[0])return u[0].evaluate(n);const h=a.length;return m>=a[h-1]?u[h-1].evaluate(n):u[id(a,m)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&n.push(this.labels[a]),n.push(this.outputs[a].serialize());return n}}const Yl=.95047,Qn=1.08883,j_=4/29,Fc=6/29,U_=3*Fc*Fc,H_=Fc*Fc*Fc,Xx=Math.PI/180,Ur=180/Math.PI;function Up(l){return l>H_?Math.pow(l,1/3):l/U_+j_}function Hp(l){return l>Fc?l*l*l:U_*(l-j_)}function Gp(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Wp(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function G_(l){const n=Wp(l.r),a=Wp(l.g),u=Wp(l.b),m=Up((.4124564*n+.3575761*a+.1804375*u)/Yl),h=Up((.2126729*n+.7151522*a+.072175*u)/1);return{l:116*h-16,a:500*(m-h),b:200*(h-Up((.0193339*n+.119192*a+.9503041*u)/Qn)),alpha:l.a}}function W_(l){let n=(l.l+16)/116,a=isNaN(l.a)?n:n+l.a/500,u=isNaN(l.b)?n:n-l.b/200;return n=1*Hp(n),a=Yl*Hp(a),u=Qn*Hp(u),new mr(Gp(3.2404542*a-1.5371385*n-.4985314*u),Gp(-.969266*a+1.8760108*n+.041556*u),Gp(.0556434*a-.2040259*n+1.0572252*u),l.alpha)}function Kx(l,n,a){const u=n-l;return l+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const od={forward:G_,reverse:W_,interpolate:function(l,n,a){return{l:Pn(l.l,n.l,a),a:Pn(l.a,n.a,a),b:Pn(l.b,n.b,a),alpha:Pn(l.alpha,n.alpha,a)}}},ad={forward:function(l){const{l:n,a,b:u}=G_(l),m=Math.atan2(u,a)*Ur;return{h:m<0?m+360:m,c:Math.sqrt(a*a+u*u),l:n,alpha:l.a}},reverse:function(l){const n=l.h*Xx,a=l.c;return W_({l:l.l,a:Math.cos(n)*a,b:Math.sin(n)*a,alpha:l.alpha})},interpolate:function(l,n,a){return{h:Kx(l.h,n.h,a),c:Pn(l.c,n.c,a),l:Pn(l.l,n.l,a),alpha:Pn(l.alpha,n.alpha,a)}}};var q_=Object.freeze({__proto__:null,hcl:ad,lab:od});class ko{constructor(n,a,u,m,h,g){this.type=n,this.operator=a,this.interpolation=u,this.input=m,this.dynamicStops=h,this.labels=[],this.outputs=[];for(const[b,T]of g)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(n,a,u,m){let h=0;if(n.name==="exponential")h=qp(a,n.base,u,m);else if(n.name==="linear")h=qp(a,1,u,m);else if(n.name==="cubic-bezier"){const g=n.controlPoints;h=new Ve(g[0],g[1],g[2],g[3]).solve(qp(a,1,u,m))}return h}static parse(n,a){let[u,m,h,...g]=n;if(!Array.isArray(m)||m.length===0)return a.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const P=m[1];if(typeof P!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:P}}else{if(m[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const P=m.slice(1);if(P.length!==4||P.some(v=>typeof v!="number"||v<0||v>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<3)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(h=a.parse(h,2,pn),!h)return null;const b=[];let T=null;if(u==="interpolate-hcl"||u==="interpolate-lab"?T=uo:a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType),n.length-1==3){const P=a.parse(g[0],3,dr);return P?new ko(T,u,m,h,P,b):null}for(let P=0;P<g.length;P+=2){const v=g[P],E=g[P+1],A=P+3,C=P+4;if(typeof v!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(b.length&&b[b.length-1][0]>=v)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',A);const M=a.parse(E,C,T);if(!M)return null;T=T||M.type,b.push([v,M])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new ko(T,u,m,h,null,b):a.error(`Type ${ui(T)} is not interpolatable.`)}evaluate(n){let a=this.labels,u=this.outputs;if(this.dynamicStops){const v=this.dynamicStops.evaluate(n);if(v.length%2!=0)throw new wi("Expected an even number of arguments.");a=[],u=[];for(let E=0;E<v.length;E+=2){const A=v[E],C=new Ji(pn,v[E+1]);if(typeof A!="number")throw new wi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(a.length&&a[a.length-1]>=A)throw new wi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');a.push(A),u.push(C)}if(a.length===0)throw new wi("Expected at least one input/output pair.")}if(a.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=a[0])return u[0].evaluate(n);const h=a.length;if(m>=a[h-1])return u[h-1].evaluate(n);const g=id(a,m),b=ko.interpolationFactor(this.interpolation,m,a[g],a[g+1]),T=u[g].evaluate(n),P=u[g+1].evaluate(n);return this.operator==="interpolate"?Eh[this.type.kind.toLowerCase()](T,P,b):this.operator==="interpolate-hcl"?ad.reverse(ad.interpolate(ad.forward(T),ad.forward(P),b)):od.reverse(od.interpolate(od.forward(T),od.forward(P),b))}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,n,this.input.serialize()];if(this.dynamicStops)a.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function qp(l,n,a,u){const m=u-a,h=l-a;return m===0?0:n===1?h/m:(Math.pow(n,h)-1)/(Math.pow(n,m)-1)}class Nh{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let u=null;const m=a.expectedType;m&&m.kind!=="value"&&(u=m);const h=[];for(const b of n.slice(1)){const T=a.parse(b,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,h.push(T)}const g=m&&h.some(b=>Po(m,b.type));return new Nh(g?dr:u,h)}evaluate(n){let a,u=null,m=0;for(const h of this.args){if(m++,u=h.evaluate(n),u&&u instanceof io&&!u.available&&(a||(a=u),u=null,m===this.args.length))return a;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class Vh{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const g=n[h];if(typeof g!="string")return a.error(`Expected string, but found ${typeof g} instead.`,h);if(/[^a-zA-Z0-9_]/.test(g))return a.error("Variable names must contain only alphanumeric characters or '_'.",h);const b=a.parse(n[h+1],h+1);if(!b)return null;u.push([g,b])}const m=a.parse(n[n.length-1],n.length-1,a.expectedType,u);return m?new Vh(u,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[a,u]of this.bindings)n.push(a,u.serialize());return n.push(this.result.serialize()),n}}class Zp{constructor(n,a,u){this.type=n,this.index=a,this.input=u}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,pn),m=a.parse(n[2],2,Ki(a.expectedType||dr));return u&&m?new Zp(m.type.itemType,u,m):null}evaluate(n){const a=this.index.evaluate(n),u=this.input.evaluate(n);if(a<0)throw new wi(`Array index out of bounds: ${a} < 0.`);if(a>u.length-1)throw new wi(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a===Math.floor(a))return u[a];const m=Math.floor(a),h=Math.ceil(a),g=u[m],b=u[h];if(typeof g!="number"||typeof b!="number")throw new wi(`Cannot interpolate between non-number values at index ${a}.`);const T=a-m;return g*(1-T)+b*T}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Yp{constructor(n,a){this.type=ir,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,dr),m=a.parse(n[2],2,dr);return u&&m?Ah(u.type,[ir,wr,pn,Bl,dr])?new Yp(u,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(u.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!Hu(a,["boolean","string","number","null"]))throw new wi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(ri(a))} instead.`);if(!Hu(u,["string","array"]))throw new wi(`Expected second argument to be of type array or string, but found ${ui(ri(u))} instead.`);return u.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class jh{constructor(n,a,u){this.type=pn,this.needle=n,this.haystack=a,this.fromIndex=u}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,dr),m=a.parse(n[2],2,dr);if(!u||!m)return null;if(!Ah(u.type,[ir,wr,pn,Bl,dr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,pn);return h?new jh(u,m,h):null}return new jh(u,m)}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!Hu(a,["boolean","string","number","null"]))throw new wi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(ri(a))} instead.`);if(!Hu(u,["string","array"]))throw new wi(`Expected second argument to be of type array or string, but found ${ui(ri(u))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(n);return u.indexOf(a,m)}return u.indexOf(a)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Xp{constructor(n,a,u,m,h,g){this.inputType=n,this.type=a,this.input=u,this.cases=m,this.outputs=h,this.otherwise=g}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let u,m;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);const h={},g=[];for(let P=2;P<n.length-1;P+=2){let v=n[P];const E=n[P+1];Array.isArray(v)||(v=[v]);const A=a.concat(P);if(v.length===0)return A.error("Expected at least one branch label.");for(const M of v){if(typeof M!="number"&&typeof M!="string")return A.error("Branch labels must be numbers or strings.");if(typeof M=="number"&&Math.abs(M)>Number.MAX_SAFE_INTEGER)return A.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof M=="number"&&Math.floor(M)!==M)return A.error("Numeric branch labels must be integer values.");if(u){if(A.checkSubtype(u,ri(M)))return null}else u=ri(M);if(h[String(M)]!==void 0)return A.error("Branch labels must be unique.");h[String(M)]=g.length}const C=a.parse(E,P,m);if(!C)return null;m=m||C.type,g.push(C)}const b=a.parse(n[1],1,dr);if(!b)return null;const T=a.parse(n[n.length-1],n.length-1,m);return T?b.type.kind!=="value"&&a.concat(1).checkSubtype(u,b.type)?null:new Xp(u,m,b,h,g,T):null}evaluate(n){const a=this.input.evaluate(n);return(ri(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],m={};for(const g of a){const b=m[this.cases[g]];b===void 0?(m[this.cases[g]]=u.length,u.push([this.cases[g],[g]])):u[b][1].push(g)}const h=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,b]of u)n.push(b.length===1?h(b[0]):b.map(h)),n.push(this.outputs[g].serialize());return n.push(this.otherwise.serialize()),n}}class Kp{constructor(n,a,u){this.type=n,this.branches=a,this.otherwise=u}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);const m=[];for(let g=1;g<n.length-1;g+=2){const b=a.parse(n[g],g,ir);if(!b)return null;const T=a.parse(n[g+1],g+1,u);if(!T)return null;m.push([b,T]),u=u||T.type}const h=a.parse(n[n.length-1],n.length-1,u);return h?new Kp(u,m,h):null}evaluate(n){for(const[a,u]of this.branches)if(a.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,u]of this.branches)n(a),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class Uh{constructor(n,a,u,m){this.type=n,this.input=a,this.beginIndex=u,this.endIndex=m}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,dr),m=a.parse(n[2],2,pn);if(!u||!m)return null;if(!Ah(u.type,[Ki(dr),wr,dr]))return a.error(`Expected first argument to be of type array or string, but found ${ui(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,pn);return h?new Uh(u.type,u,m,h):null}return new Uh(u.type,u,m)}evaluate(n){const a=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!Hu(a,["string","array"]))throw new wi(`Expected first argument to be of type array or string, but found ${ui(ri(a))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(n);return a.slice(u,m)}return a.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Z_(l,n){return l==="=="||l==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Y_(l,n,a,u){return u.compare(n,a)===0}function Bc(l,n,a){const u=l!=="=="&&l!=="!=";return class V${constructor(h,g,b){this.type=ir,this.lhs=h,this.rhs=g,this.collator=b,this.hasUntypedArgument=h.type.kind==="value"||g.type.kind==="value"}static parse(h,g){if(h.length!==3&&h.length!==4)return g.error("Expected two or three arguments.");const b=h[0];let T=g.parse(h[1],1,dr);if(!T)return null;if(!Z_(b,T.type))return g.concat(1).error(`"${b}" comparisons are not supported for type '${ui(T.type)}'.`);let P=g.parse(h[2],2,dr);if(!P)return null;if(!Z_(b,P.type))return g.concat(2).error(`"${b}" comparisons are not supported for type '${ui(P.type)}'.`);if(T.type.kind!==P.type.kind&&T.type.kind!=="value"&&P.type.kind!=="value")return g.error(`Cannot compare types '${ui(T.type)}' and '${ui(P.type)}'.`);u&&(T.type.kind==="value"&&P.type.kind!=="value"?T=new Ca(P.type,[T]):T.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ca(T.type,[P])));let v=null;if(h.length===4){if(T.type.kind!=="string"&&P.type.kind!=="string"&&T.type.kind!=="value"&&P.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(v=g.parse(h[3],3,ju),!v)return null}return new V$(T,P,v)}evaluate(h){const g=this.lhs.evaluate(h),b=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const T=ri(g),P=ri(b);if(T.kind!==P.kind||T.kind!=="string"&&T.kind!=="number")throw new wi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${T.kind}, ${P.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=ri(g),P=ri(b);if(T.kind!=="string"||P.kind!=="string")return n(h,g,b)}return this.collator?a(h,g,b,this.collator.evaluate(h)):n(h,g,b)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[l];return this.eachChild(g=>{h.push(g.serialize())}),h}}}const Jx=Bc("==",function(l,n,a){return n===a},Y_),Qx=Bc("!=",function(l,n,a){return n!==a},function(l,n,a,u){return!Y_(0,n,a,u)}),eb=Bc("<",function(l,n,a){return n<a},function(l,n,a,u){return u.compare(n,a)<0}),tb=Bc(">",function(l,n,a){return n>a},function(l,n,a,u){return u.compare(n,a)>0}),nb=Bc("<=",function(l,n,a){return n<=a},function(l,n,a,u){return u.compare(n,a)<=0}),rb=Bc(">=",function(l,n,a){return n>=a},function(l,n,a,u){return u.compare(n,a)>=0});class Jp{constructor(n,a,u,m,h,g){this.type=wr,this.number=n,this.locale=a,this.currency=u,this.unit=m,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const u=a.parse(n[1],1,pn);if(!u)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let h=null;if(m.locale&&(h=a.parseObjectValue(m.locale,2,"locale",wr),!h))return null;let g=null;if(m.currency&&(g=a.parseObjectValue(m.currency,2,"currency",wr),!g))return null;let b=null;if(m.unit&&(b=a.parseObjectValue(m.unit,2,"unit",wr),!b))return null;let T=null;if(m["min-fraction-digits"]&&(T=a.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",pn),!T))return null;let P=null;return m["max-fraction-digits"]&&(P=a.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",pn),!P)?null:new Jp(u,h,g,b,T,P)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Qp{constructor(n){this.type=pn,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=a.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${ui(u.type)} instead.`):new Qp(u):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string"||Array.isArray(a))return a.length;throw new wi(`Expected value to be of type string or array, but found ${ui(ri(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(a=>{n.push(a.serialize())}),n}}function Hh(l){return function(){l=1831565813+(l|=0)|0;let n=Math.imul(l^l>>>15,1|l);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const kc={"==":Jx,"!=":Qx,">":tb,"<":eb,">=":rb,"<=":nb,array:Ca,at:Zp,boolean:Ca,case:Kp,coalesce:Nh,collator:Oh,format:kl,image:qu,in:Yp,"index-of":jh,interpolate:ko,"interpolate-hcl":ko,"interpolate-lab":ko,length:Qp,let:Vh,literal:Ji,match:Xp,number:Ca,"number-format":Jp,object:Ca,slice:Uh,step:$c,string:Ca,"to-boolean":Ts,"to-color":Ts,"to-number":Ts,"to-string":Ts,var:Zl,within:Rn,distance:rl,config:Wl};function em(l,[n,a,u,m]){n=n.evaluate(l),a=a.evaluate(l),u=u.evaluate(l);const h=m?m.evaluate(l):1,g=Mp(n,a,u,h);if(g)throw new wi(g);return new mr(n/255*h,a/255*h,u/255*h,h)}function X_(l,[n,a,u,m]){n=n.evaluate(l),a=a.evaluate(l),u=u.evaluate(l);const h=m?m.evaluate(l):1,g=function(P,v,E,A){return typeof P=="number"&&P>=0&&P<=360?typeof v=="number"&&v>=0&&v<=100&&typeof E=="number"&&E>=0&&E<=100?A===void 0||typeof A=="number"&&A>=0&&A<=1?null:`Invalid hsla value [${[P,v,E,A].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof A=="number"?[P,v,E,A]:[P,v,E]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof A=="number"?[P,v,E,A]:[P,v,E]).join(", ")}]: 'h' must be between 0 and 360.`}(n,a,u,h);if(g)throw new wi(g);const b=`hsla(${n}, ${a}%, ${u}%, ${h})`,T=mr.parse(b);if(!T)throw new wi(`Failed to parse HSLA color: ${b}`);return T}function K_(l,n){return l in n}function tm(l,n){const a=n[l];return a===void 0?null:a}function il(l){return{type:l}}function nm(l){return{result:"success",value:l}}function qo(l){return{result:"error",value:l}}function Gh(l,n){return!!l&&!!l.parameters&&l.parameters.indexOf(n)>-1}function sd(l){return l["property-type"]==="data-driven"}function J_(l){return Gh(l.expression,"measure-light")}function Wh(l){return Gh(l.expression,"zoom")}function ld(l){return!!l.expression&&l.expression.interpolated}function rm(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function ib(l){return l}function im(l,n){const a=n.type==="color",u=l.stops&&typeof l.stops[0][0]=="object",m=u||!(u||l.property!==void 0),h=l.type||(ld(n)?"exponential":"interval");if(a&&((l=Mh({},l)).stops&&(l.stops=l.stops.map(P=>[P[0],mr.parse(P[1])])),l.default=mr.parse(l.default?l.default:n.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!q_[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let g,b,T;if(h==="exponential")g=Q_;else if(h==="interval")g=ab;else if(h==="categorical"){g=ob,b=Object.create(null);for(const P of l.stops)b[P[0]]=P[1];T=typeof l.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);g=e0}if(u){const P={},v=[];for(let C=0;C<l.stops.length;C++){const M=l.stops[C],D=M[0].zoom;P[D]===void 0&&(P[D]={zoom:D,type:l.type,property:l.property,default:l.default,stops:[]},v.push(D)),P[D].stops.push([M[0].value,M[1]])}const E=[];for(const C of v)E.push([P[C].zoom,im(P[C],n)]);const A={name:"linear"};return{kind:"composite",interpolationType:A,interpolationFactor:ko.interpolationFactor.bind(void 0,A),zoomStops:E.map(C=>C[0]),evaluate:({zoom:C},M)=>Q_({stops:E,base:l.base},n,C).evaluate(C,M)}}if(m){const P=h==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:ko.interpolationFactor.bind(void 0,P),zoomStops:l.stops.map(v=>v[0]),evaluate:({zoom:v})=>g(l,n,v,b,T)}}return{kind:"source",evaluate(P,v){const E=v&&v.properties?v.properties[l.property]:void 0;return E===void 0?Nc(l.default,n.default):g(l,n,E,b,T)}}}function Nc(l,n,a){return l!==void 0?l:n!==void 0?n:a!==void 0?a:void 0}function ob(l,n,a,u,m){return Nc(typeof a===m?u[a]:void 0,l.default,n.default)}function ab(l,n,a){if(Ta(a)!=="number")return Nc(l.default,n.default);const u=l.stops.length;if(u===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[u-1][0])return l.stops[u-1][1];const m=id(l.stops.map(h=>h[0]),a);return l.stops[m][1]}function Q_(l,n,a){const u=l.base!==void 0?l.base:1;if(Ta(a)!=="number")return Nc(l.default,n.default);const m=l.stops.length;if(m===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[m-1][0])return l.stops[m-1][1];const h=id(l.stops.map(v=>v[0]),a),g=function(v,E,A,C){const M=C-A,D=v-A;return M===0?0:E===1?D/M:(Math.pow(E,D)-1)/(Math.pow(E,M)-1)}(a,u,l.stops[h][0],l.stops[h+1][0]),b=l.stops[h][1],T=l.stops[h+1][1];let P=Eh[n.type]||ib;if(l.colorSpace&&l.colorSpace!=="rgb"){const v=q_[l.colorSpace];P=(E,A)=>v.reverse(v.interpolate(v.forward(E),v.forward(A),g))}return typeof b.evaluate=="function"?{evaluate(...v){const E=b.evaluate.apply(void 0,v),A=T.evaluate.apply(void 0,v);if(E!==void 0&&A!==void 0)return P(E,A,g)}}:P(b,T,g)}function e0(l,n,a){return n.type==="color"?a=mr.parse(a):n.type==="formatted"?a=ho.fromString(a.toString()):n.type==="resolvedImage"?a=io.build(a.toString()):Ta(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0),Nc(a,l.default,n.default)}Oo.register(kc,{error:[{kind:"error"},[wr],(l,[n])=>{throw new wi(n.evaluate(l))}],typeof:[wr,[dr],(l,[n])=>ui(ri(n.evaluate(l)))],"to-rgba":[Ki(pn,4),[uo],(l,[n])=>n.evaluate(l).toRenderColor(null).toArray()],"to-hsla":[Ki(pn,4),[uo],(l,[n])=>n.evaluate(l).toRenderColor(null).toHslaArray()],rgb:[uo,[pn,pn,pn],em],rgba:[uo,[pn,pn,pn,pn],em],hsl:[uo,[pn,pn,pn],X_],hsla:[uo,[pn,pn,pn,pn],X_],has:{type:ir,overloads:[[[wr],(l,[n])=>K_(n.evaluate(l),l.properties())],[[wr,Ss],(l,[n,a])=>K_(n.evaluate(l),a.evaluate(l))]]},get:{type:dr,overloads:[[[wr],(l,[n])=>tm(n.evaluate(l),l.properties())],[[wr,Ss],(l,[n,a])=>tm(n.evaluate(l),a.evaluate(l))]]},"feature-state":[dr,[wr],(l,[n])=>tm(n.evaluate(l),l.featureState||{})],properties:[Ss,[],l=>l.properties()],"geometry-type":[wr,[],l=>l.geometryType()],id:[dr,[],l=>l.id()],zoom:[pn,[],l=>l.globals.zoom],pitch:[pn,[],l=>l.globals.pitch||0],"distance-from-center":[pn,[],l=>l.distanceFromCenter()],"measure-light":[pn,[wr],(l,[n])=>l.measureLight(n.evaluate(l))],"heatmap-density":[pn,[],l=>l.globals.heatmapDensity||0],"line-progress":[pn,[],l=>l.globals.lineProgress||0],"raster-value":[pn,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[pn,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[pn,[],l=>l.globals.skyRadialProgress||0],accumulated:[dr,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[pn,il(pn),(l,n)=>{let a=0;for(const u of n)a+=u.evaluate(l);return a}],"*":[pn,il(pn),(l,n)=>{let a=1;for(const u of n)a*=u.evaluate(l);return a}],"-":{type:pn,overloads:[[[pn,pn],(l,[n,a])=>n.evaluate(l)-a.evaluate(l)],[[pn],(l,[n])=>-n.evaluate(l)]]},"/":[pn,[pn,pn],(l,[n,a])=>n.evaluate(l)/a.evaluate(l)],"%":[pn,[pn,pn],(l,[n,a])=>n.evaluate(l)%a.evaluate(l)],ln2:[pn,[],()=>Math.LN2],pi:[pn,[],()=>Math.PI],e:[pn,[],()=>Math.E],"^":[pn,[pn,pn],(l,[n,a])=>Math.pow(n.evaluate(l),a.evaluate(l))],sqrt:[pn,[pn],(l,[n])=>Math.sqrt(n.evaluate(l))],log10:[pn,[pn],(l,[n])=>Math.log(n.evaluate(l))/Math.LN10],ln:[pn,[pn],(l,[n])=>Math.log(n.evaluate(l))],log2:[pn,[pn],(l,[n])=>Math.log(n.evaluate(l))/Math.LN2],sin:[pn,[pn],(l,[n])=>Math.sin(n.evaluate(l))],cos:[pn,[pn],(l,[n])=>Math.cos(n.evaluate(l))],tan:[pn,[pn],(l,[n])=>Math.tan(n.evaluate(l))],asin:[pn,[pn],(l,[n])=>Math.asin(n.evaluate(l))],acos:[pn,[pn],(l,[n])=>Math.acos(n.evaluate(l))],atan:[pn,[pn],(l,[n])=>Math.atan(n.evaluate(l))],min:[pn,il(pn),(l,n)=>Math.min(...n.map(a=>a.evaluate(l)))],max:[pn,il(pn),(l,n)=>Math.max(...n.map(a=>a.evaluate(l)))],abs:[pn,[pn],(l,[n])=>Math.abs(n.evaluate(l))],round:[pn,[pn],(l,[n])=>{const a=n.evaluate(l);return a<0?-Math.round(-a):Math.round(a)}],floor:[pn,[pn],(l,[n])=>Math.floor(n.evaluate(l))],ceil:[pn,[pn],(l,[n])=>Math.ceil(n.evaluate(l))],"filter-==":[ir,[wr,dr],(l,[n,a])=>l.properties()[n.value]===a.value],"filter-id-==":[ir,[dr],(l,[n])=>l.id()===n.value],"filter-type-==":[ir,[wr],(l,[n])=>l.geometryType()===n.value],"filter-<":[ir,[wr,dr],(l,[n,a])=>{const u=l.properties()[n.value],m=a.value;return typeof u==typeof m&&u<m}],"filter-id-<":[ir,[dr],(l,[n])=>{const a=l.id(),u=n.value;return typeof a==typeof u&&a<u}],"filter->":[ir,[wr,dr],(l,[n,a])=>{const u=l.properties()[n.value],m=a.value;return typeof u==typeof m&&u>m}],"filter-id->":[ir,[dr],(l,[n])=>{const a=l.id(),u=n.value;return typeof a==typeof u&&a>u}],"filter-<=":[ir,[wr,dr],(l,[n,a])=>{const u=l.properties()[n.value],m=a.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[ir,[dr],(l,[n])=>{const a=l.id(),u=n.value;return typeof a==typeof u&&a<=u}],"filter->=":[ir,[wr,dr],(l,[n,a])=>{const u=l.properties()[n.value],m=a.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[ir,[dr],(l,[n])=>{const a=l.id(),u=n.value;return typeof a==typeof u&&a>=u}],"filter-has":[ir,[dr],(l,[n])=>n.value in l.properties()],"filter-has-id":[ir,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[ir,[Ki(wr)],(l,[n])=>n.value.indexOf(l.geometryType())>=0],"filter-id-in":[ir,[Ki(dr)],(l,[n])=>n.value.indexOf(l.id())>=0],"filter-in-small":[ir,[wr,Ki(dr)],(l,[n,a])=>a.value.indexOf(l.properties()[n.value])>=0],"filter-in-large":[ir,[wr,Ki(dr)],(l,[n,a])=>function(u,m,h,g){for(;h<=g;){const b=h+g>>1;if(m[b]===u)return!0;m[b]>u?g=b-1:h=b+1}return!1}(l.properties()[n.value],a.value,0,a.value.length-1)],all:{type:ir,overloads:[[[ir,ir],(l,[n,a])=>n.evaluate(l)&&a.evaluate(l)],[il(ir),(l,n)=>{for(const a of n)if(!a.evaluate(l))return!1;return!0}]]},any:{type:ir,overloads:[[[ir,ir],(l,[n,a])=>n.evaluate(l)||a.evaluate(l)],[il(ir),(l,n)=>{for(const a of n)if(a.evaluate(l))return!0;return!1}]]},"!":[ir,[ir],(l,[n])=>!n.evaluate(l)],"is-supported-script":[ir,[wr],(l,[n])=>{const a=l.globals&&l.globals.isSupportedScript;return!a||a(n.evaluate(l))}],upcase:[wr,[wr],(l,[n])=>n.evaluate(l).toUpperCase()],downcase:[wr,[wr],(l,[n])=>n.evaluate(l).toLowerCase()],concat:[wr,il(dr),(l,n)=>n.map(a=>ha(a.evaluate(l))).join("")],"resolved-locale":[wr,[ju],(l,[n])=>n.evaluate(l).resolvedLocale()],random:[pn,[pn,pn,dr],(l,n)=>{const[a,u,m]=n.map(g=>g.evaluate(l));if(a>u||a===u)return a;let h;if(typeof m=="string")h=function(g){let b=0;if(g.length===0)return b;for(let T=0;T<g.length;T++)b=(b<<5)-b+g.charCodeAt(T),b|=0;return b}(m);else{if(typeof m!="number")throw new wi(`Invalid seed input: ${m}`);h=m}return a+Hh(h)()*(u-a)}]});class qh{constructor(n,a,u,m){this.expression=n,this._warningHistory={},this._evaluator=new Ap(u,m),this._defaultValue=a?function(h){return h.type==="color"&&(rm(h.default)||Array.isArray(h.default))?new mr(0,0,0,0):h.type==="color"?mr.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this.configDependencies=nd(n)}evaluateWithoutErrorHandling(n,a,u,m,h,g,b,T){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(n,a,u,m,h,g,b,T){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=T||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new wi(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${P.message}`)),this._defaultValue}}}function Vc(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in kc}function jc(l,n,a,u){const m=new rd(kc,[],n?function(g){const b={color:uo,string:wr,number:pn,enum:wr,boolean:ir,formatted:Za,resolvedImage:Uu};return g.type==="array"?Ki(b[g.value]||dr,g.length):b[g.type]}(n):void 0,void 0,void 0,a,u),h=m.parse(l,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?nm(new qh(h,n,a,u)):qo(m.errors)}class Zh{constructor(n,a,u,m){this.kind=n,this._styleExpression=a,this.isLightConstant=u,this.isLineProgressConstant=m,this.isStateDependent=n!=="constant"&&!td(a.expression),this.configDependencies=nd(a.expression)}evaluateWithoutErrorHandling(n,a,u,m,h,g){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,m,h,g)}evaluate(n,a,u,m,h,g){return this._styleExpression.evaluate(n,a,u,m,h,g)}}class cd{constructor(n,a,u,m,h,g){this.kind=n,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!td(a.expression),this.isLightConstant=h,this.isLineProgressConstant=g,this.configDependencies=nd(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(n,a,u,m,h,g){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,m,h,g)}evaluate(n,a,u,m,h,g){return this._styleExpression.evaluate(n,a,u,m,h,g)}interpolationFactor(n,a,u){return this.interpolationType?ko.interpolationFactor(this.interpolationType,n,a,u):0}}function t0(l,n,a,u){if((l=jc(l,n,a,u)).result==="error")return l;const m=l.value.expression,h=zc(m);if(!h&&!sd(n))return qo([new qn("","data expressions not supported")]);const g=ql(m,["zoom","pitch","distance-from-center"]);if(!g&&!Wh(n))return qo([new qn("","zoom expressions not supported")]);const b=ql(m,["measure-light"]);if(!b&&!J_(n))return qo([new qn("","measure-light expression not supported")]);const T=ql(m,["line-progress"]);if(!T&&!function(E){return Gh(E.expression,"line-progress")}(n))return qo([new qn("","line-progress expression not supported")]);const P=n.expression&&n.expression.relaxZoomRestriction,v=dd(m);return v||g||P?v instanceof qn?qo([v]):v instanceof ko&&!ld(n)?qo([new qn("",'"interpolate" expressions cannot be used with this property')]):nm(v?new cd(h&&T?"camera":"composite",l.value,v.labels,v instanceof ko?v.interpolation:void 0,b,T):new Zh(h&&T?"constant":"source",l.value,b,T)):qo([new qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ud{constructor(n,a){this._parameters=n,this._specification=a,Mh(this,im(this._parameters,this._specification))}static deserialize(n){return new ud(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function dd(l){let n=null;if(l instanceof Vh)n=dd(l.result);else if(l instanceof Nh){for(const a of l.args)if(n=dd(a),n)break}else(l instanceof $c||l instanceof ko)&&l.input instanceof Oo&&l.input.name==="zoom"&&(n=l);return n instanceof qn||l.eachChild(a=>{const u=dd(a);u instanceof qn?n=u:n&&u&&n!==u&&(n=new qn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var om,n0,sb=function(){if(n0)return om;n0=1,om=n;var l=3;function n(a,u,m){var h=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var g=new Int32Array(this.arrayBuffer);a=g[0],this.d=(u=g[1])+2*(m=g[2]);for(var b=0;b<this.d*this.d;b++){var T=g[l+b],P=g[l+b+1];h.push(T===P?null:g.subarray(T,P))}var v=g[l+h.length+1];this.keys=g.subarray(g[l+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=u+2*m;for(var E=0;E<this.d*this.d;E++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=a,this.padding=m,this.scale=u/a,this.uid=0;var A=m/u*a;this.min=-A,this.max=a+A}return n.prototype.insert=function(a,u,m,h,g){this._forEachCell(u,m,h,g,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(h),this.bboxes.push(g)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(a,u,m,h,g,b){this.cells[g].push(b)},n.prototype.query=function(a,u,m,h,g){var b=this.min,T=this.max;if(a<=b&&u<=b&&T<=m&&T<=h&&!g)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(a,u,m,h,this._queryCell,P,{},g),P},n.prototype._queryCell=function(a,u,m,h,g,b,T,P){var v=this.cells[g];if(v!==null)for(var E=this.keys,A=this.bboxes,C=0;C<v.length;C++){var M=v[C];if(T[M]===void 0){var D=4*M;(P?P(A[D+0],A[D+1],A[D+2],A[D+3]):a<=A[D+2]&&u<=A[D+3]&&m>=A[D+0]&&h>=A[D+1])?(T[M]=!0,b.push(E[M])):T[M]=!1}}},n.prototype._forEachCell=function(a,u,m,h,g,b,T,P){for(var v=this._convertToCellCoord(a),E=this._convertToCellCoord(u),A=this._convertToCellCoord(m),C=this._convertToCellCoord(h),M=v;M<=A;M++)for(var D=E;D<=C;D++){var k=this.d*D+M;if((!P||P(this._convertFromCellCoord(M),this._convertFromCellCoord(D),this._convertFromCellCoord(M+1),this._convertFromCellCoord(D+1)))&&g.call(this,a,u,m,h,k,b,T,P))return}},n.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},n.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,u=l+this.cells.length+1+1,m=0,h=0;h<this.cells.length;h++)m+=this.cells[h].length;var g=new Int32Array(u+m+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var b=u,T=0;T<a.length;T++){var P=a[T];g[l+T]=b,g.set(P,b),b+=P.length}return g[l+a.length]=b,g.set(this.keys,b),g[l+a.length+1]=b+=this.keys.length,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer},om}(),Xl=O(sb);const Yh={};function fn(l,n,a={}){Object.defineProperty(l,"_classRegistryKey",{value:n,writable:!1}),Yh[n]={klass:l,omit:a.omit||[]}}fn(Object,"Object"),Xl.serialize=function(l,n){const a=l.toArrayBuffer();return n&&n.add(a),{buffer:a}},Xl.deserialize=function(l){return new Xl(l.buffer)},Object.defineProperty(Xl,"name",{value:"Grid"}),fn(Xl,"Grid"),typeof DOMMatrix<"u"&&fn(DOMMatrix,"DOMMatrix"),fn(mr,"Color"),fn(Error,"Error"),fn(ho,"Formatted"),fn(Gu,"FormattedSection"),fn(bi,"AJAXError"),fn(io,"ResolvedImage"),fn(ud,"StylePropertyFunction"),fn(qh,"StyleExpression",{omit:["_evaluator"]}),fn(Ya,"ImageIdWithOptions"),fn(cd,"ZoomDependentExpression"),fn(Zh,"ZoomConstantExpression"),fn(Oo,"CompoundExpression",{omit:["_evaluate"]});for(const l in kc)Yh[kc[l]._classRegistryKey]||fn(kc[l],`Expression${l}`);function am(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function sm(l){return self.ImageBitmap&&l instanceof ImageBitmap}function ol(l,n){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(am(l)||sm(l))return n&&n.add(l),l;if(ArrayBuffer.isView(l))return n&&n.add(l.buffer),l;if(l instanceof ImageData)return n&&n.add(l.data.buffer),l;if(Array.isArray(l)){const a=[];for(const u of l)a.push(ol(u,n));return a}if(l instanceof Map){const a={$name:"Map"};for(const[u,m]of l.entries())a[u]=ol(m);return a}if(l instanceof Set){const a={$name:"Set"};let u=0;for(const m of l.values())a[++u]=ol(m);return a}if(typeof l=="object"){const a=l.constructor,u=a._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const m=a.serialize?a.serialize(l,n):{};if(!a.serialize){for(const h in l)l.hasOwnProperty(h)&&(Yh[u].omit.indexOf(h)>=0||(m[h]=ol(l[h],n)));l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof l)}function Kl(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||am(l)||sm(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(Kl);if(typeof l=="object"){const n=l.$name||"Object";if(n==="Map"){const m=new Map;for(const h of Object.keys(l))h!=="$name"&&m.set(h,Kl(l[h]));return m}if(n==="Set"){const m=new Set;for(const h of Object.keys(l))h!=="$name"&&m.add(Kl(l[h]));return m}const{klass:a}=Yh[n];if(!a)throw new Error(`Can't deserialize unregistered class "${n}".`);if(a.deserialize)return a.deserialize(l);const u=Object.create(a.prototype);for(const m of Object.keys(l))m!=="$name"&&(u[m]=Kl(l[m]));return u}throw new Error("can't deserialize object of type "+typeof l)}const yn={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function lm(l){for(const n of l)if(Xh(n.charCodeAt(0)))return!0;return!1}function lb(l){for(const n of l)if(!cb(n.charCodeAt(0)))return!1;return!0}function cb(l){return!(yn.Arabic(l)||yn["Arabic Supplement"](l)||yn["Arabic Extended-A"](l)||yn["Arabic Presentation Forms-A"](l)||yn["Arabic Presentation Forms-B"](l))}function Xh(l){return!(l!==746&&l!==747&&(l<4352||!(yn["Bopomofo Extended"](l)||yn.Bopomofo(l)||yn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||yn["CJK Compatibility Ideographs"](l)||yn["CJK Compatibility"](l)||yn["CJK Radicals Supplement"](l)||yn["CJK Strokes"](l)||!(!yn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||yn["CJK Unified Ideographs Extension A"](l)||yn["CJK Unified Ideographs"](l)||yn["Enclosed CJK Letters and Months"](l)||yn["Hangul Compatibility Jamo"](l)||yn["Hangul Jamo Extended-A"](l)||yn["Hangul Jamo Extended-B"](l)||yn["Hangul Jamo"](l)||yn["Hangul Syllables"](l)||yn.Hiragana(l)||yn["Ideographic Description Characters"](l)||yn.Kanbun(l)||yn["Kangxi Radicals"](l)||yn["Katakana Phonetic Extensions"](l)||yn.Katakana(l)&&l!==12540||!(!yn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!yn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||yn["Unified Canadian Aboriginal Syllabics"](l)||yn["Unified Canadian Aboriginal Syllabics Extended"](l)||yn["Vertical Forms"](l)||yn["Yijing Hexagram Symbols"](l)||yn["Yi Syllables"](l)||yn["Yi Radicals"](l))))}function cm(l){return!(Xh(l)||function(n){return!!(yn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||yn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||yn["Letterlike Symbols"](n)||yn["Number Forms"](n)||yn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||yn["Control Pictures"](n)&&n!==9251||yn["Optical Character Recognition"](n)||yn["Enclosed Alphanumerics"](n)||yn["Geometric Shapes"](n)||yn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||yn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||yn["CJK Symbols and Punctuation"](n)||yn.Katakana(n)||yn["Private Use Area"](n)||yn["CJK Compatibility Forms"](n)||yn["Small Form Variants"](n)||yn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(l))}function um(l){return l>=1424&&l<=2303||yn["Arabic Presentation Forms-A"](l)||yn["Arabic Presentation Forms-B"](l)}function r0(l,n){return!(!n&&um(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||yn.Khmer(l))}function dm(l){for(const n of l)if(um(n.charCodeAt(0)))return!0;return!1}const hd="deferred",Kh="loading",hm="loaded";let Xa=null,No="unavailable",al=null;const fm=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(No="error"),Xa&&Xa(l)};function pm(){Uc.fire(new qa("pluginStateChange",{pluginStatus:No,pluginURL:al}))}const Uc=new el,Jh=function(){return No},fd=function(){if(No!==hd||!al)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");No=Kh,pm(),al&&ki({url:al},l=>{l?fm(l):(No=hm,pm())})},Zo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>No===hm||Zo.applyArabicShaping!=null,isLoading:()=>No===Kh,setState(l){No=l.pluginStatus,al=l.pluginURL},isParsed:()=>Zo.applyArabicShaping!=null&&Zo.processBidirectionalText!=null&&Zo.processStyledBidirectionalText!=null,getPluginURL:()=>al};class Br{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(a,u){for(const m of a)if(!r0(m.charCodeAt(0),u))return!1;return!0}(n,Zo.isLoaded())}}class Qh{constructor(n,a,u,m){this.property=n,this.value=a,this.expression=function(h,g,b,T){if(rm(h))return new ud(h,g);if(Vc(h)||Array.isArray(h)&&h.length>0){const P=t0(h,g,b,T);if(P.result==="error")throw new Error(P.value.map(v=>`${v.key}: ${v.message}`).join(", "));return P.value}{let P=h;return typeof h=="string"&&g.type==="color"&&(P=mr.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>P}}}(a===void 0?n.specification.default:a,n.specification,u,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,u){return this.property.possiblyEvaluate(this,n,a,u)}}class pd{constructor(n,a,u){this.property=n,this.value=new Qh(n,void 0,a,u)}transitioned(n,a){return new mm(this.property,this.value,a,nr({},n.transition,this.transition),n.now)}untransitioned(){return new mm(this.property,this.value,null,{},0)}}class ef{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return ci(this._values[n].value.value)}setValue(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new pd(this._values[n].property,this._scope,this._options)),this._values[n].value=new Qh(this._values[n].property,a===null?void 0:ci(a),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,a){a&&(this._options=a);const u=this._properties.properties;if(n)for(const m in n){const h=n[m];if(Ai(m,"-transition")){const g=m.slice(0,-11);u[g]&&this.setTransition(g,h)}else u.hasOwnProperty(m)&&this.setValue(m,h)}}getTransition(n){return ci(this._values[n].transition)}setTransition(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new pd(this._values[n].property)),this._values[n].transition=ci(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u);const m=this.getTransition(a);m!==void 0&&(n[`${a}-transition`]=m)}return n}transitioned(n,a){const u=new md(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(n,a._values[m]);return u}untransitioned(){const n=new md(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class mm{constructor(n,a,u,m,h){const g=m.delay||0,b=m.duration||0;h=h||0,this.property=n,this.value=a,this.begin=h+g,this.end=this.begin+b,n.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(n,a,u){const m=n.now||0,h=this.value.possiblyEvaluate(n,a,u),g=this.prior;if(g){if(m>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(m<this.begin)return g.possiblyEvaluate(n,a,u);{const b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(n,a,u),h,un(b))}}return h}}class md{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,u){const m=new Wc(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,a,u);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Hc{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return ci(this._values[n].value)}setValue(n,a){this._values[n]=new Qh(this._values[n].property,a===null?void 0:ci(a),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u)}return n}possiblyEvaluate(n,a,u){const m=new Wc(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,a,u);return m}}class Gc{constructor(n,a,u){this.property=n,this.value=a,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,u,m){return this.property.evaluate(this.value,this.parameters,n,a,u,m)}}class Wc{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Vt{constructor(n){this.specification=n}possiblyEvaluate(n,a){return n.expression.evaluate(a)}interpolate(n,a,u){const m=Eh[this.specification.type];return m?m(n,a,u):n}}class on{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,u,m){return new Gc(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},u,m)}:n.expression,a)}interpolate(n,a,u){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Gc(this,{kind:"constant",value:void 0},n.parameters);const m=Eh[this.specification.type];return m?new Gc(this,{kind:"constant",value:m(n.value.value,a.value.value,u)},n.parameters):n}evaluate(n,a,u,m,h,g){return n.kind==="constant"?n.value:n.evaluate(a,u,m,h,g)}}class qc{constructor(n){this.specification=n}possiblyEvaluate(n,a,u,m){return!!n.expression.evaluate(a,null,{},u,m)}interpolate(){return!1}}class Yr{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Br(0,{});for(const u in n){const m=n[u];m.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new Qh(m,void 0),g=this.defaultTransitionablePropertyValues[u]=new pd(m);this.defaultTransitioningPropertyValues[u]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(a)}}}fn(on,"DataDrivenProperty"),fn(Vt,"DataConstantProperty"),fn(qc,"ColorRampProperty");var ut=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function i0(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function tf(l){if(Array.isArray(l))return l.map(tf);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const n={};for(const a in l)n[a]=tf(l[a]);return n}return i0(l)}function gm(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const n of l.slice(1))if(!gm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function o0(l,n="",a=null,u="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gm(l)||(l=nf(l));const m=l;let h=!0;try{h=function(v){if(!Zc(v))return v;let E=tf(v);return s0(E),E=a0(E),E}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let g=null,b=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){b=ut[`filter_${u}`];const v=jc(h,b,n,a);if(v.result==="error")throw new Error(v.value.map(E=>`${E.key}: ${E.message}`).join(", "));g=(E,A,C)=>v.value.evaluate(E,A,{},C)}let T=null,P=null;if(h!==m){const v=jc(m,b,n,a);if(v.result==="error")throw new Error(v.value.map(E=>`${E.key}: ${E.message}`).join(", "));T=(E,A,C,M,D)=>v.value.evaluate(E,A,{},C,void 0,void 0,M,D),P=!zc(v.value.expression)}return{filter:g,dynamicFilter:T||void 0,needGeometry:l0(h),needFeature:!!P}}function a0(l){if(!Array.isArray(l))return l;const n=function(a){if(ub.has(a[0])){for(let u=1;u<a.length;u++)if(Zc(a[u]))return!0}return a}(l);return n===!0?n:n.map(a=>a0(a))}function s0(l){let n=!1;const a=[];if(l[0]==="case"){for(let u=1;u<l.length-1;u+=2)n=n||Zc(l[u]),a.push(l[u+1]);a.push(l[l.length-1])}else if(l[0]==="match"){n=n||Zc(l[1]);for(let u=2;u<l.length-1;u+=2)a.push(l[u+1]);a.push(l[l.length-1])}else if(l[0]==="step"){n=n||Zc(l[1]);for(let u=1;u<l.length-1;u+=2)a.push(l[u+1])}n&&(l.length=0,l.push("any",...a));for(let u=1;u<l.length;u++)s0(l[u])}function Zc(l){if(!Array.isArray(l))return!1;if((n=l[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let a=1;a<l.length;a++)if(Zc(l[a]))return!0;return!1}const ub=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function db(l,n){return l<n?-1:l>n?1:0}function l0(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let n=1;n<l.length;n++)if(l0(l[n]))return!0;return!1}function nf(l){if(!l)return!0;const n=l[0];return l.length<=1?n!=="any":n==="=="?sl(l[1],l[2],"=="):n==="!="?Jl(sl(l[1],l[2],"==")):n==="<"||n===">"||n==="<="||n===">="?sl(l[1],l[2],n):n==="any"?(a=l.slice(1),["any"].concat(a.map(nf))):n==="all"?["all"].concat(l.slice(1).map(nf)):n==="none"?["all"].concat(l.slice(1).map(nf).map(Jl)):n==="in"?_m(l[1],l.slice(2)):n==="!in"?Jl(_m(l[1],l.slice(2))):n==="has"?ym(l[1]):n!=="!has"||Jl(ym(l[1]));var a}function sl(l,n,a){switch(l){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,l,n]}}function _m(l,n){if(n.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",l,["literal",n.sort(db)]]:["filter-in-small",l,["literal",n]]}}function ym(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Jl(l){return["!",l]}const rf="";function Ka(l,n){return n?`${l}${rf}${n}`:l}const Is="-transition",c0=new Set(["fill","line","background","hillshade","raster"]);class Wi extends el{constructor(n,a,u,m,h){if(super(),this.id=n.id,this.fqid=Ka(this.id,u),this.type=n.type,this.scope=u,this.lut=m,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const g=jc(this.filter,ut[`filter_${n.type}`]);g.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...g.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),a.layout&&(this._unevaluatedLayout=new Hc(a.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),a.paint){this._transitionablePaint=new ef(a.paint,this.scope,h);for(const g in n.paint)this.setPaintProperty(g,n.paint[g]);for(const g in n.layout)this.setLayoutProperty(g,n.layout[g]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wc(a.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&c0.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a){if(this.type==="custom"&&n==="visibility")return void(this.visibility=a);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return Ai(n,Is)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a){const u=this._transitionablePaint,m=u._properties.properties;if(Ai(n,Is)){const E=n.slice(0,-11);return m[E]&&u.setTransition(E,a||void 0),!1}if(!m[n])return!1;const h=u._values[n],g=h.value.isDataDriven(),b=h.value;u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const T=u._values[n].value,P=T.isDataDriven(),v=Ai(n,"pattern")||n==="line-dasharray";return P||g||v||this._handleOverridablePaintPropertyUpdate(n,b,T)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,a,u){return null}_handleOverridablePaintPropertyUpdate(n,a,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){return Bi({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Gc&&sd(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=o0(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,a,u,m,h,g,b,T,P){}}const hb={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class gd{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function gr(l,n=1){let a=0,u=0;return{members:l.map(m=>{const h=hb[m.type].BYTES_PER_ELEMENT,g=a=u0(a,Math.max(n,h)),b=m.components||1;return u=Math.max(u,h),a+=h*b,{name:m.name,type:m.type,components:b,offset:g}}),size:u0(a,Math.max(u,n)),alignment:n}}function u0(l,n){return Math.ceil(l/n)*n}class As extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.int16[m+0]=a,this.int16[m+1]=u,n}}As.prototype.bytesPerElement=4,fn(As,"StructArrayLayout2i4");class Yc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.int16[h+0]=a,this.int16[h+1]=u,this.int16[h+2]=m,n}}Yc.prototype.bytesPerElement=6,fn(Yc,"StructArrayLayout3i6");class Ps extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const g=4*n;return this.int16[g+0]=a,this.int16[g+1]=u,this.int16[g+2]=m,this.int16[g+3]=h,n}}Ps.prototype.bytesPerElement=8,fn(Ps,"StructArrayLayout4i8");class of extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u,m,h)}emplace(n,a,u,m,h,g){const b=5*n;return this.int16[b+0]=a,this.int16[b+1]=u,this.int16[b+2]=m,this.int16[b+3]=h,this.int16[b+4]=g,n}}of.prototype.bytesPerElement=10,fn(of,"StructArrayLayout5i10");class _d extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,g,b)}emplace(n,a,u,m,h,g,b,T){const P=6*n,v=12*n,E=3*n;return this.int16[P+0]=a,this.int16[P+1]=u,this.uint8[v+4]=m,this.uint8[v+5]=h,this.uint8[v+6]=g,this.uint8[v+7]=b,this.float32[E+2]=T,n}}_d.prototype.bytesPerElement=12,fn(_d,"StructArrayLayout2i4ub1f12");class Ja extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.float32[h+0]=a,this.float32[h+1]=u,this.float32[h+2]=m,n}}Ja.prototype.bytesPerElement=12,fn(Ja,"StructArrayLayout3f12");class fo extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u,m,h)}emplace(n,a,u,m,h,g){const b=6*n,T=3*n;return this.uint16[b+0]=a,this.uint16[b+1]=u,this.uint16[b+2]=m,this.uint16[b+3]=h,this.float32[T+2]=g,n}}fo.prototype.bytesPerElement=12,fn(fo,"StructArrayLayout4ui1f12");class af extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const g=4*n;return this.uint16[g+0]=a,this.uint16[g+1]=u,this.uint16[g+2]=m,this.uint16[g+3]=h,n}}af.prototype.bytesPerElement=8,fn(af,"StructArrayLayout4ui8");class yd extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,n,a,u,m,h,g)}emplace(n,a,u,m,h,g,b){const T=6*n;return this.int16[T+0]=a,this.int16[T+1]=u,this.int16[T+2]=m,this.int16[T+3]=h,this.int16[T+4]=g,this.int16[T+5]=b,n}}yd.prototype.bytesPerElement=12,fn(yd,"StructArrayLayout6i12");class vm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E,A){const C=this.length;return this.resize(C+1),this.emplace(C,n,a,u,m,h,g,b,T,P,v,E,A)}emplace(n,a,u,m,h,g,b,T,P,v,E,A,C){const M=12*n;return this.int16[M+0]=a,this.int16[M+1]=u,this.int16[M+2]=m,this.int16[M+3]=h,this.uint16[M+4]=g,this.uint16[M+5]=b,this.uint16[M+6]=T,this.uint16[M+7]=P,this.int16[M+8]=v,this.int16[M+9]=E,this.int16[M+10]=A,this.int16[M+11]=C,n}}vm.prototype.bytesPerElement=24,fn(vm,"StructArrayLayout4i4ui4i24");class xm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,n,a,u,m,h,g)}emplace(n,a,u,m,h,g,b){const T=10*n,P=5*n;return this.int16[T+0]=a,this.int16[T+1]=u,this.int16[T+2]=m,this.float32[P+2]=h,this.float32[P+3]=g,this.float32[P+4]=b,n}}xm.prototype.bytesPerElement=20,fn(xm,"StructArrayLayout3i3f20");class Ql extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const g=4*n;return this.float32[g+0]=a,this.float32[g+1]=u,this.float32[g+2]=m,this.float32[g+3]=h,n}}Ql.prototype.bytesPerElement=16,fn(Ql,"StructArrayLayout4f16");class bm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}bm.prototype.bytesPerElement=4,fn(bm,"StructArrayLayout1ul4");class ll extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.uint16[m+0]=a,this.uint16[m+1]=u,n}}ll.prototype.bytesPerElement=4,fn(ll,"StructArrayLayout2ui4");class wm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E,A,C){const M=this.length;return this.resize(M+1),this.emplace(M,n,a,u,m,h,g,b,T,P,v,E,A,C)}emplace(n,a,u,m,h,g,b,T,P,v,E,A,C,M){const D=20*n,k=10*n;return this.int16[D+0]=a,this.int16[D+1]=u,this.int16[D+2]=m,this.int16[D+3]=h,this.int16[D+4]=g,this.float32[k+3]=b,this.float32[k+4]=T,this.float32[k+5]=P,this.float32[k+6]=v,this.int16[D+14]=E,this.uint32[k+8]=A,this.uint16[D+18]=C,this.uint16[D+19]=M,n}}wm.prototype.bytesPerElement=40,fn(wm,"StructArrayLayout5i4f1i1ul2ui40");class sf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,g,b)}emplace(n,a,u,m,h,g,b,T){const P=8*n;return this.int16[P+0]=a,this.int16[P+1]=u,this.int16[P+2]=m,this.int16[P+4]=h,this.int16[P+5]=g,this.int16[P+6]=b,this.int16[P+7]=T,n}}sf.prototype.bytesPerElement=16,fn(sf,"StructArrayLayout3i2i2i16");class Sm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u,m,h)}emplace(n,a,u,m,h,g){const b=4*n,T=8*n;return this.float32[b+0]=a,this.float32[b+1]=u,this.float32[b+2]=m,this.int16[T+6]=h,this.int16[T+7]=g,n}}Sm.prototype.bytesPerElement=16,fn(Sm,"StructArrayLayout2f1f2i16");class Cm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,n,a,u,m,h,g)}emplace(n,a,u,m,h,g,b){const T=20*n,P=5*n;return this.uint8[T+0]=a,this.uint8[T+1]=u,this.float32[P+1]=m,this.float32[P+2]=h,this.float32[P+3]=g,this.float32[P+4]=b,n}}Cm.prototype.bytesPerElement=20,fn(Cm,"StructArrayLayout2ub4f20");class eo extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.uint16[h+0]=a,this.uint16[h+1]=u,this.uint16[h+2]=m,n}}eo.prototype.bytesPerElement=6,fn(eo,"StructArrayLayout3ui6");class Tm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q){const oe=this.length;return this.resize(oe+1),this.emplace(oe,n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q)}emplace(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q,oe){const fe=30*n,Se=15*n,we=60*n;return this.int16[fe+0]=a,this.int16[fe+1]=u,this.int16[fe+2]=m,this.float32[Se+2]=h,this.float32[Se+3]=g,this.uint16[fe+8]=b,this.uint16[fe+9]=T,this.uint32[Se+5]=P,this.uint32[Se+6]=v,this.uint32[Se+7]=E,this.uint16[fe+16]=A,this.uint16[fe+17]=C,this.uint16[fe+18]=M,this.float32[Se+10]=D,this.float32[Se+11]=k,this.uint8[we+48]=V,this.uint8[we+49]=W,this.uint8[we+50]=Z,this.uint32[Se+13]=H,this.int16[fe+28]=Q,this.uint8[we+58]=oe,n}}Tm.prototype.bytesPerElement=60,fn(Tm,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Em extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze,Ge,Je){const rt=this.length;return this.resize(rt+1),this.emplace(rt,n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze,Ge,Je)}emplace(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V,W,Z,H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze,Ge,Je,rt){const lt=20*n,nt=40*n,xt=80*n;return this.float32[lt+0]=a,this.float32[lt+1]=u,this.int16[nt+4]=m,this.int16[nt+5]=h,this.int16[nt+6]=g,this.int16[nt+7]=b,this.int16[nt+8]=T,this.int16[nt+9]=P,this.int16[nt+10]=v,this.int16[nt+11]=E,this.int16[nt+12]=A,this.uint16[nt+13]=C,this.uint16[nt+14]=M,this.uint16[nt+15]=D,this.uint16[nt+16]=k,this.uint16[nt+17]=V,this.uint16[nt+18]=W,this.uint16[nt+19]=Z,this.uint16[nt+20]=H,this.uint16[nt+21]=Q,this.uint16[nt+22]=oe,this.uint16[nt+23]=fe,this.uint16[nt+24]=Se,this.uint16[nt+25]=we,this.uint16[nt+26]=xe,this.uint16[nt+27]=ke,this.uint32[lt+14]=Ce,this.float32[lt+15]=Ne,this.float32[lt+16]=Ze,this.float32[lt+17]=Ge,this.float32[lt+18]=Je,this.uint8[xt+76]=rt,n}}Em.prototype.bytesPerElement=80,fn(Em,"StructArrayLayout2f9i15ui1ul4f1ub80");class vd extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}vd.prototype.bytesPerElement=4,fn(vd,"StructArrayLayout1f4");class cl extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u,m,h)}emplace(n,a,u,m,h,g){const b=5*n;return this.float32[b+0]=a,this.float32[b+1]=u,this.float32[b+2]=m,this.float32[b+3]=h,this.float32[b+4]=g,n}}cl.prototype.bytesPerElement=20,fn(cl,"StructArrayLayout5f20");class lf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,g,b)}emplace(n,a,u,m,h,g,b,T){const P=7*n;return this.float32[P+0]=a,this.float32[P+1]=u,this.float32[P+2]=m,this.float32[P+3]=h,this.float32[P+4]=g,this.float32[P+5]=b,this.float32[P+6]=T,n}}lf.prototype.bytesPerElement=28,fn(lf,"StructArrayLayout7f28");class Qa extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,a,u,m,h,g,b,T,P,v,E)}emplace(n,a,u,m,h,g,b,T,P,v,E,A){const C=11*n;return this.float32[C+0]=a,this.float32[C+1]=u,this.float32[C+2]=m,this.float32[C+3]=h,this.float32[C+4]=g,this.float32[C+5]=b,this.float32[C+6]=T,this.float32[C+7]=P,this.float32[C+8]=v,this.float32[C+9]=E,this.float32[C+10]=A,n}}Qa.prototype.bytesPerElement=44,fn(Qa,"StructArrayLayout11f44");class cf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,m,h,g,b,T,P)}emplace(n,a,u,m,h,g,b,T,P,v){const E=9*n;return this.float32[E+0]=a,this.float32[E+1]=u,this.float32[E+2]=m,this.float32[E+3]=h,this.float32[E+4]=g,this.float32[E+5]=b,this.float32[E+6]=T,this.float32[E+7]=P,this.float32[E+8]=v,n}}cf.prototype.bytesPerElement=36,fn(cf,"StructArrayLayout9f36");class Xc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.float32[m+0]=a,this.float32[m+1]=u,n}}Xc.prototype.bytesPerElement=8,fn(Xc,"StructArrayLayout2f8");class Mm extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const g=6*n;return this.uint32[3*n+0]=a,this.uint16[g+2]=u,this.uint16[g+3]=m,this.uint16[g+4]=h,n}}Mm.prototype.bytesPerElement=12,fn(Mm,"StructArrayLayout1ul3ui12");class Im extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}Im.prototype.bytesPerElement=2,fn(Im,"StructArrayLayout1ui2");class xd extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k){const V=this.length;return this.resize(V+1),this.emplace(V,n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k)}emplace(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V){const W=16*n;return this.float32[W+0]=a,this.float32[W+1]=u,this.float32[W+2]=m,this.float32[W+3]=h,this.float32[W+4]=g,this.float32[W+5]=b,this.float32[W+6]=T,this.float32[W+7]=P,this.float32[W+8]=v,this.float32[W+9]=E,this.float32[W+10]=A,this.float32[W+11]=C,this.float32[W+12]=M,this.float32[W+13]=D,this.float32[W+14]=k,this.float32[W+15]=V,n}}xd.prototype.bytesPerElement=64,fn(xd,"StructArrayLayout16f64");class bd extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,g,b)}emplace(n,a,u,m,h,g,b,T){const P=10*n,v=5*n;return this.uint16[P+0]=a,this.uint16[P+1]=u,this.uint16[P+2]=m,this.uint16[P+3]=h,this.float32[v+2]=g,this.float32[v+3]=b,this.float32[v+4]=T,n}}bd.prototype.bytesPerElement=20,fn(bd,"StructArrayLayout4ui3f20");class Am extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.int16[1*n+0]=a,n}}Am.prototype.bytesPerElement=2,fn(Am,"StructArrayLayout1i2");class uf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint8[1*n+0]=a,n}}uf.prototype.bytesPerElement=1,fn(uf,"StructArrayLayout1ub1");class d0 extends gd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}d0.prototype.size=40;class Pm extends wm{get(n){return new d0(this,n)}}fn(Pm,"CollisionBoxArray");class wd extends gd{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}wd.prototype.size=60;class h0 extends Tm{get(n){return new wd(this,n)}}fn(h0,"PlacedSymbolArray");class f0 extends gd{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}f0.prototype.size=80;class p0 extends Em{get(n){return new f0(this,n)}}fn(p0,"SymbolInstanceArray");class m0 extends vd{getoffsetX(n){return this.float32[1*n+0]}}fn(m0,"GlyphOffsetArray");class g0 extends As{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}fn(g0,"SymbolLineVertexArray");class Sd extends gd{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Sd.prototype.size=12;class Cd extends Mm{get(n){return new Sd(this,n)}}fn(Cd,"FeatureIndexArray");class Vo extends ll{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}fn(Vo,"FillExtrusionCentroidArray");class Td extends gd{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Td.prototype.size=6;class _0 extends Yc{get(n){return new Td(this,n)}}fn(_0,"FillExtrusionWallArray");const fb=gr([{name:"a_pos",components:2,type:"Int16"}],4),pb=gr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class di{constructor(n=[]){this.segments=n}_prepareSegment(n,a,u,m){let h=this.segments[this.segments.length-1];return n>di.MAX_VERTEX_ARRAY_LENGTH&&kn(`Max vertices per segment is ${di.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>di.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==m)&&(h={vertexOffset:a,primitiveOffset:u,vertexLength:0,primitiveLength:0},m!==void 0&&(h.sortKey=m),this.segments.push(h)),h}prepareSegment(n,a,u,m){return this._prepareSegment(n,a.length,u.length,m)}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,u,m){return new di([{vertexOffset:n,primitiveOffset:a,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function df(l,n){return 256*(l=Qt(Math.floor(l),0,255))+Qt(Math.floor(n),0,255)}di.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,fn(di,"SegmentVector");const mb=gr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Om=gr([{name:"a_dash",components:4,type:"Uint16"}]);class Ed{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,a,u,m){this.ids.push(y0(n)),this.positions.push(a,u,m)}eachPosition(n,a){const u=y0(n);let m=0,h=this.ids.length-1;for(;m<h;){const g=m+h>>1;this.ids[g]>=u?h=g:m=g+1}for(;this.ids[m]===u;)a(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(n,a){const u=new Float64Array(n.ids),m=new Uint32Array(n.positions);return Md(u,m,0,u.length-1),a&&(a.add(u.buffer),a.add(m.buffer)),{ids:u,positions:m}}static deserialize(n){const a=new Ed;let u;a.ids=n.ids,a.positions=n.positions;for(const m of a.ids)m!==u&&a.uniqueIds.push(m),u=m;return a.indexed=!0,a}}function y0(l){const n=+l;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Sa(String(l))}function Md(l,n,a,u){for(;a<u;){const m=l[a+u>>1];let h=a-1,g=u+1;for(;;){do h++;while(l[h]<m);do g--;while(l[g]>m);if(h>=g)break;hf(l,h,g),hf(n,3*h,3*g),hf(n,3*h+1,3*g+1),hf(n,3*h+2,3*g+2)}g-a<u-g?(Md(l,n,a,g),a=g+1):(Md(l,n,g+1,u),u=g)}}function hf(l,n,a){const u=l[n];l[n]=l[a],l[a]=u}fn(Ed,"FeaturePositionMap");class es{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,a),this.initialized=!0),!!this.location}set(n,a,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Id extends es{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class mi extends es{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class pa extends es{constructor(n){super(n),this.current=[0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Kc extends es{constructor(n){super(n),this.current=[0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Ad extends es{constructor(n){super(n),this.current=[0,0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class v0 extends es{constructor(n){super(n),this.current=mr.transparent.toRenderColor(null)}set(n,a,u){this.fetchUniformLocation(n,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const x0=new Float32Array(16);class Pd extends es{constructor(n){super(n),this.current=x0}set(n,a,u){if(this.fetchUniformLocation(n,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const Dm=new Float32Array(9),gb=new Float32Array(4);class Rm extends es{constructor(n){super(n),this.current=gb}set(n,a,u){if(this.fetchUniformLocation(n,a)){for(let m=0;m<4;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function zm(l){return[df(255*l.r,255*l.g),df(255*l.b,255*l.a)]}class ec{constructor(n,a,u,m){this.value=n,this.uniformNames=a.map(h=>`u_${h}`),this.type=u,this.context=m}setUniform(n,a,u,m,h){const g=m.constantOr(this.value);a.set(n,h,g instanceof mr?g.toRenderColor(this.ignoreLut?null:this.context.lut):g)}getBinding(n,a){return this.type==="color"?new v0(n):new mi(n)}}class tc{constructor(n,a){this.uniformNames=a.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,a,u,m,h){const g=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;g&&a.set(n,h,g)}getBinding(n,a){return a==="u_pattern"||a==="u_dash"?new Ad(n):new mi(n)}}class Os{constructor(n,a,u,m){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,a,u,m,h,g,b){const T=this.paintVertexArray.length,P=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Br(0,{brightness:g}),a,{},h,m,b):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new Br(0,{brightness:g}),a,{},h,m,b)==="none"),this.paintVertexArray.resize(n),this._setPaintValue(T,n,P,this.context)}updatePaintArray(n,a,u,m,h,g,b){const T=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:b},u,m,void 0,h):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:b},u,m,void 0,h)==="none"),this._setPaintValue(n,a,T,this.context)}_setPaintValue(n,a,u,m){if(this.type==="color"){const h=zm(u.toRenderColor(this.ignoreLut?null:m.lut));for(let g=n;g<a;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=n;h<a;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ea{constructor(n,a,u,m,h,g){this.expression=n,this.uniformNames=a.map(b=>`u_${b}_t`),this.type=u,this.useIntegerZoom=m,this.context=h,this.maxValue=0,this.paintVertexAttributes=a.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,a,u,m,h,g,b){const T=this.expression.evaluate(new Br(this.context.zoom,{brightness:g}),a,{},h,m,b),P=this.expression.evaluate(new Br(this.context.zoom+1,{brightness:g}),a,{},h,m,b);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new Br(this.context.zoom,{brightness:g}),a,{},h,m,b)==="none");const v=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(v,n,T,P,this.context)}updatePaintArray(n,a,u,m,h,g,b){const T=this.expression.evaluate({zoom:this.context.zoom,brightness:b},u,m,void 0,h),P=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b},u,m,void 0,h);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:b},u,m,void 0,h)==="none"),this._setPaintValue(n,a,T,P,this.context)}_setPaintValue(n,a,u,m,h){if(this.type==="color"){const g=zm(u.toRenderColor(this.ignoreLut?null:h.lut)),b=zm(u.toRenderColor(this.ignoreLut?null:h.lut));for(let T=n;T<a;T++)this.paintVertexArray.emplace(T,g[0],g[1],b[0],b[1])}else{for(let g=n;g<a;g++)this.paintVertexArray.emplace(g,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a,u,m,h){const g=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=Qt(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);a.set(n,h,b)}getBinding(n,a){return new mi(n)}}class ul{constructor(n,a,u,m,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?Om:mb).members;for(let g=0;g<a.length;++g);this.paintVertexArray=new m}populatePaintArray(n,a,u,m){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(n,a,u,m,h,g,b){this._setPaintValues(n,a,u.patterns&&u.patterns[this.layerId],g)}_setPaintValues(n,a,u,m){if(!m||!u)return;const h=m[u];if(!h)return;const{tl:g,br:b,pixelRatio:T}=h;for(let P=n;P<a;P++)this.paintVertexArray.emplace(P,g[0],g[1],b[0],b[1],T)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nc{constructor(n,a,u=()=>!0){this.binders={},this._buffers=[],this.context=a;const m=[];for(const h in n.paint._values){const g=n.paint.get(h),b=n.paint.get(`${h}-use-theme`);if(h.endsWith("-use-theme")||!u(h)||!(g instanceof Gc&&sd(g.property.specification)))continue;const T=yb(h,n.type),P=g.value,v=g.property.specification.type,E=!!g.property.useIntegerZoom,A=h==="line-dasharray"||h.endsWith("pattern"),C=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||b&&b.value.kind!=="constant";if(P.kind!=="constant"||C)if(P.kind==="source"||C||A){const M=b0(h,v,"source");this.binders[h]=A?new ul(P,T,v,M,n.id):new Os(P,T,v,M),m.push(`/a_${h}`)}else{const M=b0(h,v,"composite");this.binders[h]=new Ea(P,T,v,E,a,M),m.push(`/z_${h}`)}else this.binders[h]=A?new tc(P.value,T):new ec(P.value,T,v,a),m.push(`/u_${h}`);b&&(this.binders[h].ignoreLut=b.constantOr("default")==="none",this.binders[h].lutExpression=b.value,this.binders[h].checkUseTheme=!0)}this.cacheKey=m.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof Os||a instanceof Ea?a.maxValue:0}populatePaintArrays(n,a,u,m,h,g,b){for(const T in this.binders){const P=this.binders[T];P.context=this.context,P instanceof Os||P instanceof Ea||P instanceof ul?P.populatePaintArray(n,a,u,m,h,g,b):P.lutExpression&&P instanceof ec&&P.lutExpression&&(P.lutExpression.kind==="composite"||P.lutExpression.kind==="source")&&(P.ignoreLut=P.lutExpression.evaluate(new Br(0,{brightness:g}),a,{},h,m,b)==="none")}}setConstantPatternPositions(n){for(const a in this.binders){const u=this.binders[a];u instanceof tc&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,a,u,m,h,g,b,T,P){let v=!1;const E=Object.keys(n),A=E.length!==0&&!T,C=A?E:a.uniqueIds;this.context.lut=h.lut;for(const M in this.binders){const D=this.binders[M];if(D.context=this.context,(D instanceof Os||D instanceof Ea||D instanceof ul)&&D.expression&&D.expression.kind&&D.expression.kind!=="constant"&&(D.expression.isStateDependent===!0||D.expression.isLightConstant===!1)){const k=h.paint.get(M);D.expression=k.value;for(const V of C){const W=n[V.toString()];a.eachPosition(V,(Z,H,Q)=>{const oe=m.feature(Z);D.updatePaintArray(H,Q,oe,W,g,b,P)})}if(!A)for(const V of u.uniqueIds){const W=n[V.toString()];u.eachPosition(V,(Z,H,Q)=>{const oe=m.feature(Z);D.updatePaintArray(H,Q,oe,W,g,b,P)})}v=!0}}return v}defines(){const n=[];for(const a in this.binders){const u=this.binders[a];(u instanceof ec||u instanceof tc)&&n.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Os||u instanceof Ea||u instanceof ul)for(let m=0;m<u.paintVertexAttributes.length;m++)n.push(u.paintVertexAttributes[m].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof ec||u instanceof tc||u instanceof Ea)for(const m of u.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const a=[];for(const u in this.binders){const m=this.binders[u];if(m instanceof ec||m instanceof tc||m instanceof Ea)for(const h of m.uniformNames)a.push({name:h,property:u,binding:m.getBinding(n,h)})}return a}setUniforms(n,a,u,m,h){for(const{name:g,property:b,binding:T}of u){if(this.binders[b].checkUseTheme&&this.binders[b]instanceof ec){const P=m.get(`${b}-use-theme`);P.isConstant()&&(this.binders[b].ignoreLut=P.constantOr("default")==="none")}this.binders[b].setUniform(n,T,h,m.get(b),g)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const a=this.binders[n];(a instanceof Os||a instanceof Ea||a instanceof ul)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(n){for(const a in this.binders){const u=this.binders[a];(u instanceof Os||u instanceof Ea||u instanceof ul)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof Os||a instanceof Ea||a instanceof ul)&&a.destroy()}}}class dl{constructor(n,a,u=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new nc(m,a,u);this.needsUpload=!1,this._featureMap=new Ed,this._featureMapWithoutIds=new Ed,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,a,u,m,h,g,b,T){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(n,a,m,h,g,b,T);a.id!==void 0?this._featureMap.add(a.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,u,m,h,g,b){for(const T of u)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,a,T,m,h,g,b||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const _b={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function yb(l,n){return _b[l]||[l.replace(`${n}-`,"").replace(/-/g,"_")]}const vb={"line-pattern":{source:fo,composite:fo},"fill-pattern":{source:fo,composite:fo},"fill-extrusion-pattern":{source:fo,composite:fo},"line-dasharray":{source:af,composite:af}},ff={color:{source:Xc,composite:Ql},number:{source:vd,composite:Xc}};function b0(l,n,a){const u=vb[l];return u&&u[a]||ff[n][a]}fn(ec,"ConstantBinder"),fn(tc,"PatternConstantBinder"),fn(Os,"SourceExpressionBinder"),fn(ul,"PatternCompositeBinder"),fn(Ea,"CompositeExpressionBinder"),fn(nc,"ProgramConfiguration",{omit:["_buffers"]}),fn(dl,"ProgramConfigurationSet");const To=Yt/Math.PI/2,Jc=5,w0=6,S0=16383,Qc=64,pf=[Qc,32,16],Yo=-To,Xo=To;function eu(l,n,a,u=To){return a=zt(a),[l*Math.sin(a)*u,-n*u,l*Math.cos(a)*u]}function rc(l,n,a){return eu(Math.cos(zt(l)),Math.sin(zt(l)),n,a)}const ic=63710088e-1,Lm=2*Math.PI*ic;class sr{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new sr(tr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,u=this.lat*a,m=n.lat*a,h=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((n.lng-this.lng)*a);return ic*Math.acos(Math.min(h,1))}toBounds(n=0){const a=360*n/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new hl({lng:this.lng-u,lat:this.lat-a},{lng:this.lng+u,lat:this.lat+a})}toEcef(n){return rc(this.lat,this.lng,To+n*To/ic)}static convert(n){if(n instanceof sr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new sr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new sr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class hl{constructor(n,a){if(n)if(a)this.setSouthWest(n).setNorthEast(a);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof sr?new sr(n.lng,n.lat):sr.convert(n),this}setSouthWest(n){return this._sw=n instanceof sr?new sr(n.lng,n.lat):sr.convert(n),this}extend(n){const a=this._sw,u=this._ne;let m,h;if(n instanceof sr)m=n,h=n;else{if(!(n instanceof hl))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(hl.convert(n)):this.extend(sr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(sr.convert(n)):this;if(m=n._sw,h=n._ne,!m||!h)return this}return a||u?(a.lng=Math.min(m.lng,a.lng),a.lat=Math.min(m.lat,a.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new sr(m.lng,m.lat),this._ne=new sr(h.lng,h.lat)),this}getCenter(){return new sr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new sr(this.getWest(),this.getNorth())}getSouthEast(){return new sr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:u}=sr.convert(n);let m=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&m}static convert(n){if(n)return n instanceof hl?n:new hl(n)}}const xb=0,bb=25.5;function mf(l){return Lm*Math.cos(l*Math.PI/180)}function ts(l){return(180+l)/360}function Ma(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Eo(l,n){return l/mf(n)}function jo(l){return 360*l-180}function to(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function C0(l,n){return l*mf(to(n))}const hi=85.051129;function $m(l){return Math.cos(zt(Qt(l,-hi,hi)))}function tu(l,n){const a=Qt(n,xb,bb),u=Math.pow(2,a);return $m(l)*Lm/(512*u)}function f(l){return 1/Math.cos(l*Math.PI/180)}function r(l,n=0){const a=Math.exp(Math.PI*(1-(l.y+n/Yt)/(1<<l.z)*2));return 80150034*a/(a*a+1)/Yt/(1<<l.z)}class s{constructor(n,a,u=0){this.x=+n,this.y=+a,this.z=+u}static fromLngLat(n,a=0){const u=sr.convert(n);return new s(ts(u.lng),Ma(u.lat),Eo(a,u.lat))}toLngLat(){return new sr(jo(this.x),to(this.y))}toAltitude(){return C0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Lm*f(to(this.y))}}function p(l,n,a,u,m,h,g,b,T){const P=(n+u)/2,v=(a+m)/2,E=new je(P,v);b(E),function(A,C,M,D,k,V){const W=M-k,Z=D-V;return Math.abs((D-C)*W-(M-A)*Z)/Math.hypot(W,Z)}(E.x,E.y,h.x,h.y,g.x,g.y)>=T?(p(l,n,a,P,v,h,E,b,T),p(l,P,v,u,m,E,g,b,T)):l.push(g)}function _(l,n,a){let u=l[0],m=u.x,h=u.y;n(u);const g=[u];for(let b=1;b<l.length;b++){const T=l[b],{x:P,y:v}=T;n(T),p(g,m,h,P,v,u,T,n,a),m=P,h=v,u=T}return g}function x(l,n,a,u){if(u(n,a)){const m=n.add(a)._mult(.5);x(l,n,m,u),x(l,m,a,u)}else l.push(a)}function S(l,n){let a=l[0];const u=[a];for(let m=1;m<l.length;m++){const h=l[m];x(u,a,h,n),a=h}return u}const I=Math.pow(2,14)-1,R=-I-1;function $(l,n){const a=Math.round(l.x*n),u=Math.round(l.y*n);return l.x=Qt(a,R,I),l.y=Qt(u,R,I),(a<l.x||a>l.x+1||u<l.y||u>l.y+1)&&kn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function B(l,n,a){const u=l.loadGeometry(),m=l.extent,h=Yt/m;if(n&&a&&a.projection.isReprojectedInTileSpace){const g=1<<n.z,{scale:b,x:T,y:P,projection:v}=a,E=A=>{const C=jo((n.x+A.x/m)/g),M=to((n.y+A.y/m)/g),D=v.project(C,M);A.x=(D.x*b-T)*m,A.y=(D.y*b-P)*m};for(let A=0;A<u.length;A++)if(l.type!==1)u[A]=_(u[A],E,1);else{const C=[];for(const M of u[A])M.x<0||M.x>=m||M.y<0||M.y>=m||(E(M),C.push(M));u[A]=C}}for(const g of u)for(const b of g)$(b,h);return u}function j(l,n){return{type:l.type,id:l.id,properties:l.properties,geometry:n?B(l):[]}}function U(l,n,a,u,m){l.emplaceBack(2*n+(u+1)/2,2*a+(m+1)/2)}function q(l,n,a){l.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class ce{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new As,this.indexArray=new eo,this.segments=new di,this.programConfigurations=new dl(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}updateFootprints(n,a){}populate(n,a,u,m){const h=this.layers[0],g=[];let b=null;h.type==="circle"&&(b=h.layout.get("circle-sort-key"));for(const{feature:P,id:v,index:E,sourceLayerIndex:A}of n){const C=this.layers[0]._featureFilter.needGeometry,M=j(P,C);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),M,u))continue;const D=b?b.evaluate(M,{},u):void 0,k={id:v,properties:P.properties,type:P.type,sourceLayerIndex:A,index:E,geometry:C?M.geometry:B(P,u,m),patterns:{},sortKey:D};g.push(k)}b&&g.sort((P,v)=>P.sortKey-v.sortKey);let T=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new yd,T=m.projection);for(const P of g){const{geometry:v,index:E,sourceLayerIndex:A}=P,C=n[E].feature;this.addFeature(P,v,E,a.availableImages,u,T,a.brightness),a.featureIndex.insert(C,v,E,A,this.index)}}update(n,a,u,m,h,g,b){this.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,fb.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,pb.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,a,u,m,h,g,b){for(const T of a)for(const P of T){const v=P.x,E=P.y;if(v<0||v>=Yt||E<0||E>=Yt)continue;if(g){const M=g.projectTilePoint(v,E,h),D=g.upVector(h,v,E),k=this.globeExtVertexArray;q(k,M,D),q(k,M,D),q(k,M,D),q(k,M,D)}const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),C=A.vertexLength;U(this.layoutVertexArray,v,E,-1,-1),U(this.layoutVertexArray,v,E,1,-1),U(this.layoutVertexArray,v,E,1,1),U(this.layoutVertexArray,v,E,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+2,C+3),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},m,h,b)}}function ie(l,n){for(let a=0;a<l.length;a++)if(Ae(n,l[a]))return!0;for(let a=0;a<n.length;a++)if(Ae(l,n[a]))return!0;return!!Me(l,n)}function he(l,n,a){return!!Ae(l,n)||!!Be(n,l,a)}function de(l,n){if(l.length===1)return Le(n,l[0]);for(let a=0;a<n.length;a++){const u=n[a];for(let m=0;m<u.length;m++)if(Ae(l,u[m]))return!0}for(let a=0;a<l.length;a++)if(Le(n,l[a]))return!0;for(let a=0;a<n.length;a++)if(Me(l,n[a]))return!0;return!1}function ve(l,n,a){if(l.length>1){if(Me(l,n))return!0;for(let u=0;u<n.length;u++)if(Be(n[u],l,a))return!0}for(let u=0;u<l.length;u++)if(Be(l[u],n,a))return!0;return!1}function Me(l,n){if(l.length===0||n.length===0)return!1;for(let a=0;a<l.length-1;a++){const u=l[a],m=l[a+1];for(let h=0;h<n.length-1;h++)if(Te(u,m,n[h],n[h+1]))return!0}return!1}function Te(l,n,a,u){return ca(l,a,u)!==ca(n,a,u)&&ca(l,n,a)!==ca(l,n,u)}function Be(l,n,a){const u=a*a;if(n.length===1)return l.distSqr(n[0])<u;for(let m=1;m<n.length;m++)if(Pe(l,n[m-1],n[m])<u)return!0;return!1}function Pe(l,n,a){const u=n.distSqr(a);if(u===0)return l.distSqr(n);const m=((l.x-n.x)*(a.x-n.x)+(l.y-n.y)*(a.y-n.y))/u;return l.distSqr(m<0?n:m>1?a:a.sub(n)._mult(m)._add(n))}function Le(l,n){let a,u,m,h=!1;for(let g=0;g<l.length;g++){a=l[g];for(let b=0,T=a.length-1;b<a.length;T=b++)u=a[b],m=a[T],u.y>n.y!=m.y>n.y&&n.x<(m.x-u.x)*(n.y-u.y)/(m.y-u.y)+u.x&&(h=!h)}return h}function Ae(l,n){let a=!1;for(let u=0,m=l.length-1;u<l.length;m=u++){const h=l[u],g=l[m];h.y>n.y!=g.y>n.y&&n.x<(g.x-h.x)*(n.y-h.y)/(g.y-h.y)+h.x&&(a=!a)}return a}function Ue(l,n,a,u,m){for(const g of l)if(n<=g.x&&a<=g.y&&u>=g.x&&m>=g.y)return!0;const h=[new je(n,a),new je(n,m),new je(u,m),new je(u,a)];if(l.length>2){for(const g of h)if(Ae(l,g))return!0}for(let g=0;g<l.length-1;g++)if(tt(l[g],l[g+1],h))return!0;return!1}function tt(l,n,a){const u=a[0],m=a[2];if(l.x<u.x&&n.x<u.x||l.x>m.x&&n.x>m.x||l.y<u.y&&n.y<u.y||l.y>m.y&&n.y>m.y)return!1;const h=ca(l,n,a[0]);return h!==ca(l,n,a[1])||h!==ca(l,n,a[2])||h!==ca(l,n,a[3])}function gt(l,n,a,u,m,h){let g=n.y-l.y,b=l.x-n.x;if(h=h||0){const T=g*g+b*b;if(T===0)return!0;const P=Math.sqrt(T);g/=P,b/=P}return!((a.x-l.x)*g+(a.y-l.y)*b-h<0||(u.x-l.x)*g+(u.y-l.y)*b-h<0||(m.x-l.x)*g+(m.y-l.y)*b-h<0)}function ct(l,n,a,u,m,h,g){return!(gt(l,n,u,m,h,g)||gt(n,a,u,m,h,g)||gt(a,l,u,m,h,g)||gt(u,m,l,n,a,g)||gt(m,h,l,n,a,g)||gt(h,u,l,n,a,g))}function St(l,n,a){const u=n.paint.get(l).value;return u.kind==="constant"?u.value:a.programConfigurations.get(n.id).getMaxValue(l)}function bt(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function st(l,n,a,u,m){if(!n[0]&&!n[1])return l;const h=je.convert(n)._mult(m);a==="viewport"&&h._rotate(-u);const g=[];for(let b=0;b<l.length;b++)g.push(l[b].sub(h));return g}function _t(l,n,a,u){const m=je.convert(l)._mult(u);return n==="viewport"&&m._rotate(-a),m}let $t,ot;fn(ce,"CircleBucket",{omit:["layers"]});var Et,yt={exports:{}},Gt=(Et||(Et=1,function(l,n){(function(a){function u(h,g,b){var T=m(256*h,256*(g=Math.pow(2,b)-g-1),b),P=m(256*(h+1),256*(g+1),b);return T[0]+","+T[1]+","+P[0]+","+P[1]}function m(h,g,b){var T=2*Math.PI*6378137/256/Math.pow(2,b);return[h*T-2*Math.PI*6378137/2,g*T-2*Math.PI*6378137/2]}a.getURL=function(h,g,b,T,P,v){return v=v||{},h+"?"+["bbox="+u(b,T,P),"format="+(v.format||"image/png"),"service="+(v.service||"WMS"),"version="+(v.version||"1.1.1"),"request="+(v.request||"GetMap"),"srs="+(v.srs||"EPSG:3857"),"width="+(v.width||256),"height="+(v.height||256),"layers="+g].join("&")},a.getTileBBox=u,a.getMercCoords=m,Object.defineProperty(a,"__esModule",{value:!0})})(n)}(0,yt.exports)),yt.exports);class Ot{constructor(n,a,u){this.z=n,this.x=a,this.y=u,this.key=Ht(0,n,n,a,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a){const u=Gt.getTileBBox(this.x,this.y,this.z),m=function(h,g,b){let T,P="";for(let v=h;v>0;v--)T=1<<v-1,P+=(g&T?1:0)+(b&T?2:0);return P}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tt{constructor(n,a){this.wrap=n,this.canonical=a,this.key=Ht(n,a.z,a.z,a.x,a.y)}}class Bt{constructor(n,a,u,m,h){this.overscaledZ=n,this.wrap=a,this.canonical=new Ot(u,+m,+h),this.key=a===0&&n===u?this.canonical.key:Ht(a,n,u,m,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const a=this.canonical.z-n;return n>this.canonical.z?new Bt(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bt(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a=!0){if(this.overscaledZ===n&&a)return this.key;if(n>this.canonical.z)return Ht(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Ht(this.wrap*+a,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new Bt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new Bt(a,this.wrap,a,u,m),new Bt(a,this.wrap,a,u+1,m),new Bt(a,this.wrap,a,u,m+1),new Bt(a,this.wrap,a,u+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Bt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Bt(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ht(l,n,a,u,m){const h=1<<Math.min(a,22);let g=h*(m%h)+u%h;return l&&a<22&&(g+=h*h*((l<0?-2*l-1:2*l)%(1<<2*(22-a)))),16*(32*g+a)+(n-a)}const rn=[l=>{let n=l.canonical.x-1,a=l.wrap;return n<0&&(n=(1<<l.canonical.z)-1,a--),new Bt(l.overscaledZ,a,l.canonical.z,n,l.canonical.y)},l=>{let n=l.canonical.x+1,a=l.wrap;return n===1<<l.canonical.z&&(n=0,a++),new Bt(l.overscaledZ,a,l.canonical.z,n,l.canonical.y)},l=>new Bt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Bt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];fn(Ot,"CanonicalTileID"),fn(Bt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const dn=gr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Dn}=dn,wn=gr([{name:"a_pos_3",components:3,type:"Int16"}]);var Tn=gr([{name:"a_pos",type:"Int16",components:2}]);class $n{constructor(n,a){this.pos=n,this.dir=a}intersectsPlane(n,a,u){const m=_e.vec3.dot(a,this.dir);if(Math.abs(m)<1e-6)return!1;const h=((n[0]-this.pos[0])*a[0]+(n[1]-this.pos[1])*a[1]+(n[2]-this.pos[2])*a[2])/m;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,a,u){if(_e.vec3.equals(this.pos,n)||a===0)return u[0]=u[1]=u[2]=0,!1;const[m,h,g]=this.dir,b=this.pos[0]-n[0],T=this.pos[1]-n[1],P=this.pos[2]-n[2],v=m*m+h*h+g*g,E=2*(b*m+T*h+P*g),A=E*E-4*v*(b*b+T*T+P*P-a*a);if(A<0){const C=Math.max(-E/2,0),M=b+m*C,D=T+h*C,k=P+g*C,V=Math.hypot(M,D,k);return u[0]=M*a/V,u[1]=D*a/V,u[2]=k*a/V,!1}{const C=(-E-Math.sqrt(A))/(2*v);if(C<0){const M=Math.hypot(b,T,P);return u[0]=b*a/M,u[1]=T*a/M,u[2]=P*a/M,!1}return u[0]=b+m*C,u[1]=T+h*C,u[2]=P+g*C,!0}}}class Jn{constructor(n,a,u,m,h){this.TL=n,this.TR=a,this.BR=u,this.BL=m,this.horizon=h}static fromInvProjectionMatrix(n,a,u){const m=[-1,1,1],h=[1,1,1],g=[1,-1,1],b=[-1,-1,1],T=_e.vec3.transformMat4(m,m,n),P=_e.vec3.transformMat4(h,h,n),v=_e.vec3.transformMat4(g,g,n),E=_e.vec3.transformMat4(b,b,n);return new Jn(T,P,v,E,a/u)}}function Tr(l,n,a){let u=1/0,m=-1/0;const h=[];for(const g of l){_e.vec3.sub(h,g,n);const b=_e.vec3.dot(h,a);u=Math.min(u,b),m=Math.max(m,b)}return[u,m]}function ei(l,n){let a=!0;for(let u=0;u<l.planes.length;u++){const m=l.planes[u];let h=0;for(let g=0;g<n.length;g++)h+=_e.vec3.dot(m,n[g])+m[3]>=0;if(h===0)return 0;h!==n.length&&(a=!1)}return a?2:1}function Nr(l,n){for(const a of l.projections){const u=Tr(n,l.points[0],a.axis);if(a.projection[1]<u[0]||a.projection[0]>u[1])return 0}return 1}function Bn(l,n){let a=0;const u=[0,0,0,0];for(let m=0;m<l.length;m++)u[0]=l[m][0],u[1]=l[m][1],u[2]=l[m][2],u[3]=1,_e.vec4.dot(u,n)>=0&&a++;return a}class or{constructor(n,a){this.points=n||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=vn.fromPoints(this.points),this.projections=[],this.frustumEdges=[_e.vec3.sub([],this.points[2],this.points[3]),_e.vec3.sub([],this.points[0],this.points[3]),_e.vec3.sub([],this.points[4],this.points[0]),_e.vec3.sub([],this.points[5],this.points[1]),_e.vec3.sub([],this.points[6],this.points[2]),_e.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const m=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:m,projection:Tr(this.points,this.points[0],m)}),this.projections.push({axis:h,projection:Tr(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,a,u,m){const h=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const v=_e.vec4.transformMat4([],P,n),E=1/v[3]/a*h;return _e.vec4.mul(v,v,[E,E,m?1/v[3]:E,E])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const v=_e.vec3.sub([],g[P[0]],g[P[1]]),E=_e.vec3.sub([],g[P[2]],g[P[1]]),A=_e.vec3.normalize([],_e.vec3.cross([],v,E)),C=-_e.vec3.dot(A,g[P[1]]);return A.concat(C)}),T=[];for(let P=0;P<g.length;P++)T.push([g[P][0],g[P][1],g[P][2]]);return new or(T,b)}intersectsPrecise(n,a,u){for(let m=0;m<a.length;m++)if(!Bn(n,a[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!Bn(n,this.planes[m]))return 0;for(const m of u)for(const h of this.frustumEdges){const g=_e.vec3.cross([],m,h),b=_e.vec3.length(g);if(b===0)continue;_e.vec3.scale(g,g,1/b);const T=Tr(this.points,this.points[0],g),P=Tr(n,this.points[0],g);if(T[0]>P[1]||P[0]>T[1])return 0}return 1}containsPoint(n){for(const a of this.planes){const u=a[3];if(_e.vec3.dot([a[0],a[1],a[2]],n)+u<0)return!1}return!0}}class vn{static fromPoints(n){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const m of n)_e.vec3.min(a,a,m),_e.vec3.max(u,u,m);return new vn(a,u)}static fromTileIdAndHeight(n,a,u){const m=1<<n.canonical.z,h=n.canonical.x,g=n.canonical.y;return new vn([h/m,g/m,a],[(h+1)/m,(g+1)/m,u])}static applyTransform(n,a){const u=n.getCorners();for(let m=0;m<u.length;++m)_e.vec3.transformMat4(u[m],u[m],a);return vn.fromPoints(u)}static applyTransformFast(n,a){const u=[a[12],a[13],a[14]],m=[...u];for(let h=0;h<3;h++)for(let g=0;g<3;g++){const b=a[4*g+h],T=b*n.min[g],P=b*n.max[g];u[h]+=Math.min(T,P),m[h]+=Math.max(T,P)}return new vn(u,m)}static projectAabbCorners(n,a){const u=n.getCorners();for(let m=0;m<u.length;++m)_e.vec3.transformMat4(u[m],u[m],a);return u}constructor(n,a){this.min=n,this.max=a,this.center=_e.vec3.scale([],_e.vec3.add([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],u=_e.vec3.clone(this.min),m=_e.vec3.clone(this.max);for(let h=0;h<a.length;h++)u[h]=a[h]?this.min[h]:this.center[h],m[h]=a[h]?this.center[h]:this.max[h];return m[2]=this.max[2],new vn(u,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,a=this.max;return[[n[0],n[1],n[2]],[a[0],n[1],n[2]],[a[0],a[1],n[2]],[n[0],a[1],n[2]],[n[0],n[1],a[2]],[a[0],n[1],a[2]],[a[0],a[1],a[2]],[n[0],a[1],a[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?ei(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?ei(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,a){return a||this.intersects(n)?Nr(n,this.getCorners()):0}intersectsPreciseFlat(n,a){return a||this.intersectsFlat(n)?Nr(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let a=0;a<3;++a)if(this.min[a]>n.max[a]||n.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n.min[a]),this.max[a]=Math.max(this.max[a],n.max[a])}encapsulatePoint(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n[a]),this.max[a]=Math.max(this.max[a],n[a])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Xn(l){return l*To/ic}fn(vn,"Aabb");const pr=[new vn([Yo,Yo,Yo],[Xo,Xo,Xo]),new vn([Yo,Yo,Yo],[0,0,Xo]),new vn([0,Yo,Yo],[Xo,0,Xo]),new vn([Yo,0,Yo],[0,Xo,Xo]),new vn([0,0,Yo],[Xo,Xo,Xo])];function _r(l,n,a,u=!0){const m=_e.vec3.scale([],l._camera.position,l.worldSize),h=[n,a,1,1];_e.vec4.transformMat4(h,h,l.pixelMatrixInverse),_e.vec4.scale(h,h,1/h[3]);const g=_e.vec3.sub([],h,m),b=_e.vec3.normalize([],g),T=l.globeMatrix,P=[T[12],T[13],T[14]],v=_e.vec3.sub([],P,m),E=_e.vec3.length(v),A=_e.vec3.normalize([],v),C=l.worldSize/(2*Math.PI),M=_e.vec3.dot(A,b),D=Math.asin(C/E);if(D<Math.acos(M)){if(!u)return null;const ke=[],Ce=[];_e.vec3.scale(ke,b,E/M),_e.vec3.normalize(Ce,_e.vec3.sub(Ce,ke,v)),_e.vec3.normalize(b,_e.vec3.add(b,v,_e.vec3.scale(b,Ce,Math.tan(D)*E)))}const k=[];new $n(m,b).closestPointOnSphere(P,C,k);const V=_e.vec3.normalize([],zl(T,0)),W=_e.vec3.normalize([],zl(T,1)),Z=_e.vec3.normalize([],zl(T,2)),H=_e.vec3.dot(V,k),Q=_e.vec3.dot(W,k),oe=_e.vec3.dot(Z,k),fe=Kt(Math.asin(-Q/C));let Se=Kt(Math.atan2(H,oe));Se=l.center.lng+function(ke,Ce){const Ne=(Ce-ke+180)%360-180;return Ne<-180?Ne+360:Ne}(l.center.lng,Se);const we=ts(Se),xe=Qt(Ma(fe),0,1);return new s(we,xe)}class Xr{constructor(n,a,u){this.a=_e.vec3.sub([],n,u),this.b=_e.vec3.sub([],a,u),this.center=u;const m=_e.vec3.normalize([],this.a),h=_e.vec3.normalize([],this.b);this.angle=Math.acos(_e.vec3.dot(m,h))}}function Ni(l,n){if(l.angle===0)return null;let a;return a=l.a[n]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[n]/l.a[n]/Math.sin(l.angle)-1/Math.tan(l.angle)),a<0||a>1?null:function(u,m,h,g){const b=Math.sin(h);return u*(Math.sin((1-g)*h)/b)+m*(Math.sin(g*h)/b)}(l.a[n],l.b[n],l.angle,Qt(a,0,1))+l.center[n]}function Pi(l){if(l.z<=1)return pr[l.z+2*l.y+l.x];const n=zr(Kr(l));return vn.fromPoints(n)}function Oi(l,n,a){return _e.vec3.scale(l,l,1-a),_e.vec3.scaleAndAdd(l,l,n,a)}function Ko(l,n,a){for(const u of l)_e.vec3.transformMat4(u,u,n),_e.vec3.scale(u,u,a)}function po(l,n,a,u){const m=n/l.worldSize,h=l.globeMatrix;if(a.z<=1){const we=Pi(a).getCorners();return Ko(we,h,m),vn.fromPoints(we)}const g=Kr(a,u),b=zr(g,To+Xn(l._tileCoverLift));Ko(b,h,m);const T=Number.MAX_VALUE,P=[-T,-T,-T],v=[T,T,T];if(g.contains(l.center)){for(const ke of b)_e.vec3.min(v,v,ke),_e.vec3.max(P,P,ke);P[2]=0;const we=l.point,xe=[we.x*m,we.y*m,0];return _e.vec3.min(v,v,xe),_e.vec3.max(P,P,xe),new vn(v,P)}if(l._tileCoverLift>0){for(const we of b)_e.vec3.min(v,v,we),_e.vec3.max(P,P,we);return new vn(v,P)}const E=[h[12]*m,h[13]*m,h[14]*m],A=g.getCenter(),C=Qt(l.center.lat,-hi,hi),M=Qt(A.lat,-hi,hi),D=ts(l.center.lng),k=Ma(C);let V=D-ts(A.lng);const W=k-Ma(M);V>.5?V-=1:V<-.5&&(V+=1);let Z=0;if(Math.abs(V)>Math.abs(W))Z=V>=0?1:3;else{Z=W>=0?0:2;const we=[h[4]*m,h[5]*m,h[6]*m],xe=-Math.sin(zt(W>=0?g.getSouth():g.getNorth()))*To;_e.vec3.scaleAndAdd(E,E,we,xe)}const H=b[Z],Q=b[(Z+1)%4],oe=new Xr(H,Q,E),fe=[Ni(oe,0)||H[0],Ni(oe,1)||H[1],Ni(oe,2)||H[2]],Se=Ro(l.zoom);if(Se>0){const we=function({x:ke,y:Ce,z:Ne},Ze,Ge,Je,rt){const lt=1/(1<<Ne);let nt=ke*lt,xt=nt+lt,Dt=Ce*lt,vt=Dt+lt,Jt=0;const Zt=(nt+xt)/2-Je;return Zt>.5?Jt=-1:Zt<-.5&&(Jt=1),nt=((nt+Jt)*Ze-(Je*=Ze))*Ge+Je,xt=((xt+Jt)*Ze-Je)*Ge+Je,Dt=(Dt*Ze-(rt*=Ze))*Ge+rt,vt=(vt*Ze-rt)*Ge+rt,[[nt,vt,0],[xt,vt,0],[xt,Dt,0],[nt,Dt,0]]}(a,n,l._pixelsPerMercatorPixel,D,k);for(let ke=0;ke<b.length;ke++)Oi(b[ke],we[ke],Se);const xe=_e.vec3.add([],we[Z],we[(Z+1)%4]);_e.vec3.scale(xe,xe,.5),Oi(fe,xe,Se)}for(const we of b)_e.vec3.min(v,v,we),_e.vec3.max(P,P,we);return v[2]=Math.min(H[2],Q[2]),_e.vec3.min(v,v,fe),_e.vec3.max(P,P,fe),new vn(v,P)}function Kr({x:l,y:n,z:a},u=!1){const m=1/(1<<a),h=new sr(jo(l*m),n===(1<<a)-1&&u?-90:to((n+1)*m)),g=new sr(jo((l+1)*m),n===0&&u?90:to(n*m));return new hl(h,g)}function zr(l,n=To){const a=zt(l.getNorth()),u=zt(l.getSouth()),m=Math.cos(a),h=Math.cos(u),g=Math.sin(a),b=Math.sin(u),T=l.getWest(),P=l.getEast();return[eu(h,b,T,n),eu(h,b,P,n),eu(m,g,P,n),eu(m,g,T,n)]}function Or(l,n,a,u){const m=1<<a.z,h=(l/Yt+a.x)/m;return rc(to((n/Yt+a.y)/m),jo(h),u)}function er({min:l,max:n}){return S0/Math.max(n[0]-l[0],n[1]-l[1],n[2]-l[2])}const gi=new Float64Array(16);function Vi(l){const n=er(l),a=_e.mat4.fromScaling(gi,[n,n,n]);return _e.mat4.translate(a,a,_e.vec3.negate([],l.min))}function Dr(l){const n=_e.mat4.fromTranslation(gi,l.min),a=1/er(l);return _e.mat4.scale(n,n,[a,a,a])}function mo(l){const n=Yt/(2*Math.PI);return l/(2*Math.PI)/n}function ma(l,n){return Yt/(512*Math.pow(2,l))*er(Pi(n))}function Uo(l,n,a,u,m){const h=mo(a),g=[l,n,-a/(2*Math.PI)],b=_e.mat4.identity(new Float64Array(16));return _e.mat4.translate(b,b,g),_e.mat4.scale(b,b,[h,h,h]),_e.mat4.rotateX(b,b,zt(-m)),_e.mat4.rotateY(b,b,zt(-u)),b}function Ro(l){return Hn(Jc,w0,l)}function ns(l,n){const a=rc(n.lat,n.lng),u=function(h){const g=rc(h._center.lat,h._center.lng),b=_e.vec3.fromValues(0,1,0);let T=_e.vec3.cross([],b,g);const P=_e.mat4.fromRotation([],-h.angle,g);T=_e.vec3.transformMat4(T,T,P),_e.mat4.fromRotation(P,-h._pitch,T);const v=_e.vec3.normalize([],g);return _e.vec3.scale(v,v,Xn(h.cameraToCenterDistance/h.pixelsPerMeter)),_e.vec3.transformMat4(v,v,P),_e.vec3.add([],g,v)}(l),m=_e.vec3.subtract([],u,a);return _e.vec3.angle(m,a)}function ga(l,n){return ns(l,n)>Math.PI/2*1.01}const Jo=zt(85),oc=Math.cos(Jo),rs=Math.sin(Jo),ac=_e.mat4.create(),nu=l=>{const n=[];return l.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function gf(l,n,a,u,m,h,g,b,T){if(h&&l.queryGeometry.isAboveHorizon)return!1;h&&(T*=l.pixelToTileUnitsFactor);const P=l.tileID.canonical,v=a.projection.upVectorScale(P,a.center.lat,a.worldSize).metersToTile;for(const E of n)for(const A of E){const C=A.add(b),M=m&&a.elevation?a.elevation.exaggeration()*m.getElevationAt(C.x,C.y,!0):0,D=a.projection.projectTilePoint(C.x,C.y,P);if(M>0){const Z=a.projection.upVector(P,C.x,C.y);D.x+=Z[0]*v*M,D.y+=Z[1]*v*M,D.z+=Z[2]*v*M}const k=h?C:Fm(D.x,D.y,D.z,u),V=h?l.tilespaceRays.map(Z=>rF(Z,M)):l.queryGeometry.screenGeometry,W=_e.vec4.transformMat4([],[D.x,D.y,D.z,1],u);if(!g&&h?T*=W[3]/a.cameraToCenterDistance:g&&!h&&(T*=a.cameraToCenterDistance/W[3]),h){const Z=to((A.y/Yt+P.y)/(1<<P.z));T/=a.projection.pixelsPerMeter(Z,1)/Eo(1,Z)}if(he(V,k,T))return!0}return!1}function Fm(l,n,a,u){const m=_e.vec4.transformMat4([],[l,n,a,1],u);return new je(m[0]/m[3],m[1]/m[3])}const hT=_e.vec3.fromValues(0,0,0),nF=_e.vec3.fromValues(0,0,1);function rF(l,n){const a=_e.vec3.create();return hT[2]=n,l.intersectsPlane(hT,nF,a),new je(a[0],a[1])}class fT extends ce{}let pT,mT,gT,_T;function yT(l,{width:n,height:a},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*a*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(n*a*u);return l.width=n,l.height=a,l.data=m,l}function vT(l,n,a){const{width:u,height:m}=n;u===l.width&&m===l.height||(wb(l,n,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,u),height:Math.min(l.height,m)},a,null),l.width=u,l.height=m,l.data=n.data)}function wb(l,n,a,u,m,h,g,b){if(m.width===0||m.height===0)return n;if(m.width>l.width||m.height>l.height||a.x>l.width-m.width||a.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||u.x>n.width-m.width||u.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const T=l.data,P=n.data,v=h===4&&b;for(let E=0;E<m.height;E++){const A=((a.y+E)*l.width+a.x)*h,C=((u.y+E)*n.width+u.x)*h;if(v)for(let M=0;M<m.width;M++){const D=A+M*h+3,k=C+M*h;P[k+0]=255,P[k+1]=255,P[k+2]=255,P[k+3]=T[D]}else if(g)for(let M=0;M<m.width;M++){const D=A+M*h,k=C+M*h,V=T[D+3],W=new mr(T[D+0]/255*V,T[D+1]/255*V,T[D+2]/255*V,V).toRenderColor(g).toArray();P[k+0]=W[0],P[k+1]=W[1],P[k+2]=W[2],P[k+3]=W[3]}else for(let M=0;M<m.width*h;M++)P[C+M]=T[A+M]}return n}fn(fT,"HeatmapBucket",{omit:["layers"]});class ru{constructor(n,a){yT(this,n,1,a)}resize(n){vT(this,new ru(n),1)}clone(){return new ru({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,m,h){wb(n,a,u,m,h,1,null)}}class ao{constructor(n,a){yT(this,n,4,a)}resize(n){vT(this,new ao(n),4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,m,h,g,b){wb(n,a,u,m,h,4,g,b)}}class xT{constructor(n,a){this.width=n.width,this.height=n.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}function Bm(l){const n={},a=l.resolution||256,u=l.clips?l.clips.length:1,m=l.image||new ao({width:a,height:u}),h=(g,b,T)=>{n[l.evaluationKey]=T;const P=l.expression.evaluate(n);P&&(m.data[g+b+0]=Math.floor(255*P.r/P.a),m.data[g+b+1]=Math.floor(255*P.g/P.a),m.data[g+b+2]=Math.floor(255*P.b/P.a),m.data[g+b+3]=Math.floor(255*P.a))};if(l.clips)for(let g=0,b=0;g<u;++g,b+=4*a)for(let T=0,P=0;T<a;T++,P+=4){const v=T/(a-1),{start:E,end:A}=l.clips[g];h(b,P,E*(1-v)+A*v)}else for(let g=0,b=0;g<a;g++,b+=4)h(0,b,g/(a-1));return m}fn(ru,"AlphaImage"),fn(ao,"RGBAImage");const iF=gr([{name:"a_pos",components:2,type:"Int16"}],4),{members:oF}=iF;function km(l,n,a=2){const u=n&&n.length,m=u?n[0]*a:l.length;let h=bT(l,0,m,a,!0);const g=[];if(!h||h.next===h.prev)return g;let b,T,P;if(u&&(h=function(v,E,A,C){const M=[];for(let D=0,k=E.length;D<k;D++){const V=bT(v,E[D]*C,D<k-1?E[D+1]*C:v.length,C,!1);V===V.next&&(V.steiner=!0),M.push(fF(V))}M.sort(uF);for(let D=0;D<M.length;D++)A=dF(M[D],A);return A}(l,n,h,a)),l.length>80*a){b=1/0,T=1/0;let v=-1/0,E=-1/0;for(let A=a;A<m;A+=a){const C=l[A],M=l[A+1];C<b&&(b=C),M<T&&(T=M),C>v&&(v=C),M>E&&(E=M)}P=Math.max(v-b,E-T),P=P!==0?32767/P:0}return Nm(h,g,a,b,T,P,0),g}function bT(l,n,a,u,m){let h;if(m===function(g,b,T,P){let v=0;for(let E=b,A=T-P;E<T;E+=P)v+=(g[A]-g[E])*(g[E+1]+g[A+1]),A=E;return v}(l,n,a,u)>0)for(let g=n;g<a;g+=u)h=CT(g/u|0,l[g],l[g+1],h);else for(let g=a-u;g>=n;g-=u)h=CT(g/u|0,l[g],l[g+1],h);return h&&T0(h,h.next)&&(jm(h),h=h.next),h}function Od(l,n){if(!l)return l;n||(n=l);let a,u=l;do if(a=!1,u.steiner||!T0(u,u.next)&&ji(u.prev,u,u.next)!==0)u=u.next;else{if(jm(u),u=n=u.prev,u===u.next)break;a=!0}while(a||u!==n);return n}function Nm(l,n,a,u,m,h,g){if(!l)return;!g&&h&&function(T,P,v,E){let A=T;do A.z===0&&(A.z=Sb(A.x,A.y,P,v,E)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next;while(A!==T);A.prevZ.nextZ=null,A.prevZ=null,function(C){let M,D=1;do{let k,V=C;C=null;let W=null;for(M=0;V;){M++;let Z=V,H=0;for(let oe=0;oe<D&&(H++,Z=Z.nextZ,Z);oe++);let Q=D;for(;H>0||Q>0&&Z;)H!==0&&(Q===0||!Z||V.z<=Z.z)?(k=V,V=V.nextZ,H--):(k=Z,Z=Z.nextZ,Q--),W?W.nextZ=k:C=k,k.prevZ=W,W=k;V=Z}W.nextZ=null,D*=2}while(M>1)}(A)}(l,u,m,h);let b=l;for(;l.prev!==l.next;){const T=l.prev,P=l.next;if(h?sF(l,u,m,h):aF(l))n.push(T.i,l.i,P.i),jm(l),l=P.next,b=P.next;else if((l=P)===b){g?g===1?Nm(l=lF(Od(l),n),n,a,u,m,h,2):g===2&&cF(l,n,a,u,m,h):Nm(Od(l),n,a,u,m,h,1);break}}}function aF(l){const n=l.prev,a=l,u=l.next;if(ji(n,a,u)>=0)return!1;const m=n.x,h=a.x,g=u.x,b=n.y,T=a.y,P=u.y,v=m<h?m<g?m:g:h<g?h:g,E=b<T?b<P?b:P:T<P?T:P,A=m>h?m>g?m:g:h>g?h:g,C=b>T?b>P?b:P:T>P?T:P;let M=u.next;for(;M!==n;){if(M.x>=v&&M.x<=A&&M.y>=E&&M.y<=C&&_f(m,b,h,T,g,P,M.x,M.y)&&ji(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function sF(l,n,a,u){const m=l.prev,h=l,g=l.next;if(ji(m,h,g)>=0)return!1;const b=m.x,T=h.x,P=g.x,v=m.y,E=h.y,A=g.y,C=b<T?b<P?b:P:T<P?T:P,M=v<E?v<A?v:A:E<A?E:A,D=b>T?b>P?b:P:T>P?T:P,k=v>E?v>A?v:A:E>A?E:A,V=Sb(C,M,n,a,u),W=Sb(D,k,n,a,u);let Z=l.prevZ,H=l.nextZ;for(;Z&&Z.z>=V&&H&&H.z<=W;){if(Z.x>=C&&Z.x<=D&&Z.y>=M&&Z.y<=k&&Z!==m&&Z!==g&&_f(b,v,T,E,P,A,Z.x,Z.y)&&ji(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,H.x>=C&&H.x<=D&&H.y>=M&&H.y<=k&&H!==m&&H!==g&&_f(b,v,T,E,P,A,H.x,H.y)&&ji(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;Z&&Z.z>=V;){if(Z.x>=C&&Z.x<=D&&Z.y>=M&&Z.y<=k&&Z!==m&&Z!==g&&_f(b,v,T,E,P,A,Z.x,Z.y)&&ji(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;H&&H.z<=W;){if(H.x>=C&&H.x<=D&&H.y>=M&&H.y<=k&&H!==m&&H!==g&&_f(b,v,T,E,P,A,H.x,H.y)&&ji(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function lF(l,n){let a=l;do{const u=a.prev,m=a.next.next;!T0(u,m)&&wT(u,a,a.next,m)&&Vm(u,m)&&Vm(m,u)&&(n.push(u.i,a.i,m.i),jm(a),jm(a.next),a=l=m),a=a.next}while(a!==l);return Od(a)}function cF(l,n,a,u,m,h){let g=l;do{let b=g.next.next;for(;b!==g.prev;){if(g.i!==b.i&&pF(g,b)){let T=ST(g,b);return g=Od(g,g.next),T=Od(T,T.next),Nm(g,n,a,u,m,h,0),void Nm(T,n,a,u,m,h,0)}b=b.next}g=g.next}while(g!==l)}function uF(l,n){return l.x-n.x}function dF(l,n){const a=function(m,h){let g=h;const b=m.x,T=m.y;let P,v=-1/0;do{if(T<=g.y&&T>=g.next.y&&g.next.y!==g.y){const D=g.x+(T-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(D<=b&&D>v&&(v=D,P=g.x<g.next.x?g:g.next,D===b))return P}g=g.next}while(g!==h);if(!P)return null;const E=P,A=P.x,C=P.y;let M=1/0;g=P;do{if(b>=g.x&&g.x>=A&&b!==g.x&&_f(T<C?b:v,T,A,C,T<C?v:b,T,g.x,g.y)){const D=Math.abs(T-g.y)/(b-g.x);Vm(g,m)&&(D<M||D===M&&(g.x>P.x||g.x===P.x&&hF(P,g)))&&(P=g,M=D)}g=g.next}while(g!==E);return P}(l,n);if(!a)return n;const u=ST(a,l);return Od(u,u.next),Od(a,a.next)}function hF(l,n){return ji(l.prev,l,n.prev)<0&&ji(n.next,l,l.next)<0}function Sb(l,n,a,u,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-a)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function fF(l){let n=l,a=l;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==l);return a}function _f(l,n,a,u,m,h,g,b){return(m-g)*(n-b)>=(l-g)*(h-b)&&(l-g)*(u-b)>=(a-g)*(n-b)&&(a-g)*(h-b)>=(m-g)*(u-b)}function pF(l,n){return l.next.i!==n.i&&l.prev.i!==n.i&&!function(a,u){let m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==u.i&&m.next.i!==u.i&&wT(m,m.next,a,u))return!0;m=m.next}while(m!==a);return!1}(l,n)&&(Vm(l,n)&&Vm(n,l)&&function(a,u){let m=a,h=!1;const g=(a.x+u.x)/2,b=(a.y+u.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&g<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(h=!h),m=m.next;while(m!==a);return h}(l,n)&&(ji(l.prev,l,n.prev)||ji(l,n.prev,n))||T0(l,n)&&ji(l.prev,l,l.next)>0&&ji(n.prev,n,n.next)>0)}function ji(l,n,a){return(n.y-l.y)*(a.x-n.x)-(n.x-l.x)*(a.y-n.y)}function T0(l,n){return l.x===n.x&&l.y===n.y}function wT(l,n,a,u){const m=M0(ji(l,n,a)),h=M0(ji(l,n,u)),g=M0(ji(a,u,l)),b=M0(ji(a,u,n));return m!==h&&g!==b||!(m!==0||!E0(l,a,n))||!(h!==0||!E0(l,u,n))||!(g!==0||!E0(a,l,u))||!(b!==0||!E0(a,n,u))}function E0(l,n,a){return n.x<=Math.max(l.x,a.x)&&n.x>=Math.min(l.x,a.x)&&n.y<=Math.max(l.y,a.y)&&n.y>=Math.min(l.y,a.y)}function M0(l){return l>0?1:l<0?-1:0}function Vm(l,n){return ji(l.prev,l,l.next)<0?ji(l,n,l.next)>=0&&ji(l,l.prev,n)>=0:ji(l,n,l.prev)<0||ji(l,l.next,n)<0}function ST(l,n){const a=Cb(l.i,l.x,l.y),u=Cb(n.i,n.x,n.y),m=l.next,h=n.prev;return l.next=n,n.prev=l,a.next=m,m.prev=a,u.next=a,a.prev=u,h.next=u,u.prev=h,u}function CT(l,n,a,u){const m=Cb(l,n,a);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function jm(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Cb(l,n,a){return{i:l,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function I0(l,n){const a=l.length;if(a<=1)return[l];const u=[];let m,h;for(let g=0;g<a;g++){const b=Bu(l[g]);b!==0&&(l[g].area=Math.abs(b),h===void 0&&(h=b<0),h===b<0?(m&&u.push(m),m=[l[g]]):m.push(l[g]))}if(m&&u.push(m),n>1)for(let g=0;g<u.length;g++)u[g].length<=n||(Zu(u[g],n,1,u[g].length-1,mF),u[g]=u[g].slice(0,n));return u}function mF(l,n){return n.area-l.area}function TT(l,n,a=1){if(!l)return null;const u=typeof l=="string"?l:l.getPrimary().id;n[u]||(n[u]=[]);const m=io.from(u).getPrimary().scaleSelf(a);return n[u].push(m),m.serialize()}function Tb(l,n,a,u){const m=u.patternDependencies;let h=!1;for(const g of n){const b=g.paint.get(`${l}-pattern`);b.isConstant()||(h=!0),TT(b.constantOr(null),m,a)&&(h=!0)}return h}function Eb(l,n,a,u,m,h){const g=h.patternDependencies;for(const b of n){const T=b.paint.get(`${l}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:u},a,{},h.availableImages);P=P&&P.name?P.name:P;const v=TT(P,g,m);v&&(a.patterns[b.id]=v)}}return a}class Mb{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new As,this.indexArray=new eo,this.indexArray2=new ll,this.programConfigurations=new dl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new di,this.segments2=new di,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=n.projection}updateFootprints(n,a){}populate(n,a,u,m){this.hasPattern=Tb("fill",this.layers,this.pixelRatio,a);const h=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:b,id:T,index:P,sourceLayerIndex:v}of n){const E=this.layers[0]._featureFilter.needGeometry,A=j(b,E);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),A,u))continue;const C=h?h.evaluate(A,{},u,a.availableImages):void 0,M={id:T,properties:b.properties,type:b.type,sourceLayerIndex:v,index:P,geometry:E?A.geometry:B(b,u,m),patterns:{},sortKey:C};g.push(M)}h&&g.sort((b,T)=>b.sortKey-T.sortKey);for(const b of g){const{geometry:T,index:P,sourceLayerIndex:v}=b;if(this.hasPattern){const E=Eb("fill",this.layers,b,this.zoom,this.pixelRatio,a);this.patternFeatures.push(E)}else this.addFeature(b,T,P,u,{},a.availableImages,a.brightness,a.elevationFeatures);a.featureIndex.insert(n[P].feature,T,P,v,this.index)}}update(n,a,u,m,h,g,b){this.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b)}addFeatures(n,a,u,m,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,a,u,m,g,n.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,oF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,u,m,h,g=[],b,T){for(const P of I0(a,500)){let v=0;for(const k of P)v+=k.length;const E=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),A=E.vertexLength,C=[],M=[];for(const k of P){if(k.length===0)continue;k!==P[0]&&M.push(C.length/2);const V=this.segments2.prepareSegment(k.length,this.layoutVertexArray,this.indexArray2),W=V.vertexLength;this.layoutVertexArray.emplaceBack(k[0].x,k[0].y),this.indexArray2.emplaceBack(W+k.length-1,W),C.push(k[0].x),C.push(k[0].y);for(let Z=1;Z<k.length;Z++)this.layoutVertexArray.emplaceBack(k[Z].x,k[Z].y),this.indexArray2.emplaceBack(W+Z-1,W+Z),C.push(k[Z].x),C.push(k[Z].y);V.vertexLength+=k.length,V.primitiveLength+=k.length}const D=km(C,M);for(let k=0;k<D.length;k+=3)this.indexArray.emplaceBack(A+D[k],A+D[k+1],A+D[k+2]);E.vertexLength+=v,E.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,g,m,b)}}let ET,MT,IT,AT;fn(Mb,"FillBucket",{omit:["layers","patternFeatures"]});class Ib{constructor(n,a,u,m){if(this.triangleCount=a.length/3,this.min=new je(0,0),this.max=new je(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,g]=[n[0].clone(),n[0].clone()];for(let E=1;E<n.length;++E){const A=n[E];h.x=Math.min(h.x,A.x),h.y=Math.min(h.y,A.y),g.x=Math.max(g.x,A.x),g.y=Math.max(g.y,A.y)}if(m){const E=Math.ceil(Math.max(g.x-h.x,g.y-h.y)/m);u=Math.max(u,E)}if(u===0)return;this.min=h,this.max=g;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const T=Math.max(b.x,b.y)/u;this.cellsX=Math.max(1,Math.ceil(b.x/T)),this.cellsY=Math.max(1,Math.ceil(b.y/T)),this.xScale=1/T,this.yScale=1/T;const P=[];for(let E=0;E<this.triangleCount;E++){const A=n[a[3*E+0]].sub(this.min),C=n[a[3*E+1]].sub(this.min),M=n[a[3*E+2]].sub(this.min),D=fl(Math.floor(Math.min(A.x,C.x,M.x)),this.xScale,this.cellsX),k=fl(Math.floor(Math.max(A.x,C.x,M.x)),this.xScale,this.cellsX),V=fl(Math.floor(Math.min(A.y,C.y,M.y)),this.yScale,this.cellsY),W=fl(Math.floor(Math.max(A.y,C.y,M.y)),this.yScale,this.cellsY),Z=new je(0,0),H=new je(0,0),Q=new je(0,0),oe=new je(0,0);for(let fe=V;fe<=W;++fe){Z.y=H.y=fe*T,Q.y=oe.y=(fe+1)*T;for(let Se=D;Se<=k;++Se)Z.x=Q.x=Se*T,H.x=oe.x=(Se+1)*T,(ct(A,C,M,Z,H,oe)||ct(A,C,M,Z,oe,Q))&&P.push({cellIdx:fe*this.cellsX+Se,triIdx:E})}}if(P.length===0)return;P.sort((E,A)=>E.cellIdx-A.cellIdx||E.triIdx-A.triIdx);let v=0;for(;v<P.length;){const E=P[v].cellIdx,A={start:this.payload.length,len:0};for(;v<P.length&&P[v].cellIdx===E;)++A.len,this.payload.push(P[v++].triIdx);this.cells[E]=A}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,a){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=fl(n.x-this.min.x,this.xScale,this.cellsX),m=fl(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[m*this.cellsX+u];if(h){this._lazyInitLookup();for(let g=0;g<h.len;g++){const b=this.payload[h.start+g],T=Math.floor(b/8),P=1<<b%8;if(!(this.lookup[T]&P)&&(this.lookup[T]|=P,a.push(b),a.length===this.triangleCount))return}}}query(n,a,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>a.x||n.y>this.max.y||this.min.y>a.y)return;this._lazyInitLookup();const m=fl(n.x-this.min.x,this.xScale,this.cellsX),h=fl(a.x-this.min.x,this.xScale,this.cellsX),g=fl(n.y-this.min.y,this.yScale,this.cellsY),b=fl(a.y-this.min.y,this.yScale,this.cellsY);for(let T=g;T<=b;T++)for(let P=m;P<=h;P++){const v=this.cells[T*this.cellsX+P];if(v)for(let E=0;E<v.len;E++){const A=this.payload[v.start+E],C=Math.floor(A/8),M=1<<A%8;if(!(this.lookup[C]&M)&&(this.lookup[C]|=M,u.push(A),u.length===this.triangleCount))return}}}}function fl(l,n,a){return Math.max(0,Math.min(a-1,Math.floor(l*n)))}fn(Ib,"TriangleGridIndex");class PT{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.footprints=[]}updateFootprints(n,a){for(const u of this.footprints)a.push({footprint:u,id:n})}populate(n,a,u,m){const h=[];for(const{feature:g,id:b,index:T,sourceLayerIndex:P}of n){const v=this.layers[0]._featureFilter.needGeometry,E=j(g,v);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),E,u))continue;const A={id:b,properties:g.properties,type:g.type,sourceLayerIndex:P,index:T,geometry:v?E.geometry:B(g,u,m),patterns:{}};h.push(A)}for(const g of h){const{geometry:b,index:T,sourceLayerIndex:P}=g;this.addFeature(g,b,T,u,{},a.availableImages,a.brightness),a.featureIndex.insert(n[T].feature,b,T,P,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,a,u,m,h,g,b){}destroy(){}addFeature(n,a,u,m,h,g=[],b){for(const T of I0(a,2)){const P=[],v=[],E=[],A=new je(1/0,1/0),C=new je(-1/0,-1/0);for(const k of T)if(k.length!==0){k!==T[0]&&E.push(v.length/2);for(let V=0;V<k.length;V++)v.push(k[V].x),v.push(k[V].y),P.push(k[V]),A.x=Math.min(A.x,k[V].x),A.y=Math.min(A.y,k[V].y),C.x=Math.max(C.x,k[V].x),C.y=Math.max(C.y,k[V].y)}const M=km(v,E),D=new Ib(P,M,8,256);this.footprints.push({vertices:P,indices:M,grid:D,min:A,max:C})}}}fn(PT,"ClipBucket",{omit:["layers"]});const gF=gr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),_F=gr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),yF=gr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),vF=gr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),xF=gr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),bF=gr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:wF}=gF;var Ab,OT,Pb,DT,Ob,RT,zT,A0={};function LT(){if(OT)return Ab;OT=1;var l=Ye();function n(m,h,g,b,T){this.properties={},this.extent=g,this.type=0,this._pbf=m,this._geometry=-1,this._keys=b,this._values=T,m.readFields(a,this,h)}function a(m,h,g){m==1?h.id=g.readVarint():m==2?function(b,T){for(var P=b.readVarint()+b.pos;b.pos<P;){var v=T._keys[b.readVarint()],E=T._values[b.readVarint()];T.properties[v]=E}}(g,h):m==3?h.type=g.readVarint():m==4&&(h._geometry=g.pos)}function u(m){for(var h,g,b=0,T=0,P=m.length,v=P-1;T<P;v=T++)b+=((g=m[v]).x-(h=m[T]).x)*(h.y+g.y);return b}return Ab=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,g=m.readVarint()+m.pos,b=1,T=0,P=0,v=0,E=[];m.pos<g;){if(T<=0){var A=m.readVarint();b=7&A,T=A>>3}if(T--,b===1||b===2)P+=m.readSVarint(),v+=m.readSVarint(),b===1&&(h&&E.push(h),h=[]),h.push(new l(P,v));else{if(b!==7)throw new Error("unknown command "+b);h&&h.push(h[0].clone())}}return h&&E.push(h),E},n.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,g=1,b=0,T=0,P=0,v=1/0,E=-1/0,A=1/0,C=-1/0;m.pos<h;){if(b<=0){var M=m.readVarint();g=7&M,b=M>>3}if(b--,g===1||g===2)(T+=m.readSVarint())<v&&(v=T),T>E&&(E=T),(P+=m.readSVarint())<A&&(A=P),P>C&&(C=P);else if(g!==7)throw new Error("unknown command "+g)}return[v,A,E,C]},n.prototype.toGeoJSON=function(m,h,g){var b,T,P=this.extent*Math.pow(2,g),v=this.extent*m,E=this.extent*h,A=this.loadGeometry(),C=n.types[this.type];function M(V){for(var W=0;W<V.length;W++){var Z=V[W];V[W]=[360*(Z.x+v)/P-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+E)/P)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(b=0;b<A.length;b++)D[b]=A[b][0];M(A=D);break;case 2:for(b=0;b<A.length;b++)M(A[b]);break;case 3:for(A=function(V){var W=V.length;if(W<=1)return[V];for(var Z,H,Q=[],oe=0;oe<W;oe++){var fe=u(V[oe]);fe!==0&&(H===void 0&&(H=fe<0),H===fe<0?(Z&&Q.push(Z),Z=[V[oe]]):Z.push(V[oe]))}return Z&&Q.push(Z),Q}(A),b=0;b<A.length;b++)for(T=0;T<A[b].length;T++)M(A[b][T])}A.length===1?A=A[0]:C="Multi"+C;var k={type:"Feature",geometry:{type:C,coordinates:A},properties:this.properties};return"id"in this&&(k.id=this.id),k},Ab}function $T(){if(DT)return Pb;DT=1;var l=LT();function n(u,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(a,this,m),this.length=this._features.length}function a(u,m,h){u===15?m.version=h.readVarint():u===1?m.name=h.readString():u===5?m.extent=h.readVarint():u===2?m._features.push(h.pos):u===3?m._keys.push(h.readString()):u===4&&m._values.push(function(g){for(var b=null,T=g.readVarint()+g.pos;g.pos<T;){var P=g.readVarint()>>3;b=P===1?g.readString():P===2?g.readFloat():P===3?g.readDouble():P===4?g.readVarint64():P===5?g.readVarint():P===6?g.readSVarint():P===7?g.readBoolean():null}return b}(h))}return Pb=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var m=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,m,this.extent,this._keys,this._values)},Pb}function FT(){return zT||(zT=1,A0.VectorTile=function(){if(RT)return Ob;RT=1;var l=$T();function n(a,u,m){if(a===3){var h=new l(m,m.readVarint()+m.pos);h.length&&(u[h.name]=h)}}return Ob=function(a,u){this.layers=a.readFields(n,{},u)},Ob}(),A0.VectorTileFeature=LT(),A0.VectorTileLayer=$T()),A0}var yf=FT();class Dd extends je{constructor(n,a,u){super(n,a),this.z=u}}class BT extends Dd{constructor(n,a,u,m){super(n,a,u),this.w=m}}function P0(l,n,a,u){const m=[],h=u===0?(g,b,T,P,v,E)=>{g.push(new je(E,T+(E-b)/(P-b)*(v-T)))}:(g,b,T,P,v,E)=>{g.push(new je(b+(E-T)/(v-T)*(P-b),E))};for(const g of l){const b=[];for(const T of g){if(T.length<=2)continue;const P=[];for(let A=0;A<T.length-1;A++){const C=T[A].x,M=T[A].y,D=T[A+1].x,k=T[A+1].y,V=u===0?C:M,W=u===0?D:k;V<n?W>n&&h(P,C,M,D,k,n):V>a?W<a&&h(P,C,M,D,k,a):P.push(T[A]),W<n&&V>=n&&h(P,C,M,D,k,n),W>a&&V<=a&&h(P,C,M,D,k,a)}let v=T[T.length-1];const E=u===0?v.x:v.y;E>=n&&E<=a&&P.push(v),P.length&&(v=P[P.length-1],P[0].x===v.x&&P[0].y===v.y||P.push(P[0]),b.push(P))}b.length&&m.push(b)}return m}function kT(l,n,a,u){const m=a==="x"?"y":"x",h=(u-l[a])/(n[a]-l[a]);l[m]=l[m]+(n[m]-l[m])*h,l[a]=u,l.hasOwnProperty("z")&&(l.z=Pn(l.z,n.z,h)),l.hasOwnProperty("w")&&(l.w=Pn(l.w,n.w,h))}function NT(l,n,a,u){const m=a,h=u;for(const g of["x","y"]){let b=l,T=n;b[g]>=T[g]&&(b=n,T=l),b[g]<m&&T[g]>m&&kT(b,T,g,m),b[g]<h&&T[g]>h&&kT(T,b,g,h)}}const O0=Number.MAX_SAFE_INTEGER;function VT(l,n,a,u){return l.order<n||l.order===O0||!(l.clipMask&a)||function(m,h){return h.length!==0&&h.find(g=>g===m)===void 0}(u,l.clipScope)}function D0(l,n){return l.x-n.x||l.y-n.y}function jT(l,n){return D0(l.min,n.min)===0&&D0(l.max,n.max)===0}function Db(l,n){return!(l.min.x>n.max.x||l.max.x<n.min.x||l.min.y>n.max.y||l.max.y<n.min.y)}function Rb(l,n){if(l.length!==n.length)return!1;for(let a=0;a<l.length;a++)if(l[a].sourceId!==n[a].sourceId||!jT(l[a],n[a])||l[a].order!==n[a].order||l[a].clipMask!==n[a].clipMask||!Mt(l[a].clipScope,n[a].clipScope))return!1;return!0}function UT(l,n,a){const u=1/Yt,m=1/(1<<a.canonical.z),h=(n.x*u+a.canonical.x)*m+a.wrap,g=(n.y*u+a.canonical.y)*m;return{min:new je((l.x*u+a.canonical.x)*m+a.wrap,(l.y*u+a.canonical.y)*m),max:new je(h,g)}}function SF(l,n,a){const u=1<<a.canonical.z,m=((n.x-a.wrap)*u-a.canonical.x)*Yt,h=(n.y*u-a.canonical.y)*Yt;return{min:new je(((l.x-a.wrap)*u-a.canonical.x)*Yt,(l.y*u-a.canonical.y)*Yt),max:new je(m,h)}}function HT(l,n,a,u,m,h,g){const b=l.indices,T=l.vertices,P=[];for(let v=u;v<u+m;v+=3){const E=n[a[v+0]+h],A=n[a[v+1]+h],C=n[a[v+2]+h],M=Math.min(E.x,A.x,C.x),D=Math.max(E.x,A.x,C.x),k=Math.min(E.y,A.y,C.y),V=Math.max(E.y,A.y,C.y);P.length=0,l.grid.query(new je(M,k),new je(D,V),P);for(let W=0;W<P.length;W++){const Z=P[W];if(ct(T[b[3*Z+0]],T[b[3*Z+1]],T[b[3*Z+2]],E,A,C,g))return!0}}return!1}function GT(l,n,a,u){if(!l||!a)return!1;let m=l.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(a.vertices.length<l.vertices.length)return GT(a,u,l,n);const h=n.canonical,g=u.canonical,b=Math.pow(2,g.z-h.z);m=l.vertices.map(T=>new je((T.x+h.x*Yt)*b-g.x*Yt,(T.y+h.y*Yt)*b-g.y*Yt))}return HT(a,m,l.indices,0,l.indices.length,0,0)}function WT(l,n,a,u){const m=Math.pow(2,u.z-a.z);return new je((l+a.x*Yt)*m-u.x*Yt,(n+a.y*Yt)*m-u.y*Yt)}function qT(l,n){const a=[];n.grid.queryPoint(l,a);const u=n.indices,m=n.vertices;for(let h=0;h<a.length;h++){const g=a[h];if(Ae([m[u[3*g+0]],m[u[3*g+1]],m[u[3*g+2]]],l))return!0}return!1}const zb=[new je(0,0),new je(Yt,0),new je(Yt,Yt),new je(0,Yt)];function ZT(l,n){const a=[];let u=[];if(!n||l.length<2)return[l];if(l.length===2)return tt(l[0],l[1],zb)?[l]:[];for(let m=0;m<l.length+2;m++){const h=l[m%l.length],g=l[(m+1)%l.length],b=tt(m===0?l[l.length-1]:l[(m-1)%l.length],h,zb),T=tt(h,g,zb),P=b||T;P&&u.push(h),P&&T||u.length>0&&(u.length>1&&a.push(u),u=[])}return u.length>1&&a.push(u),a}const Lb=yf.VectorTileFeature.types,CF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],TF=["fill-extrusion-flood-light-ground-radius"],EF=Math.pow(2,13),MF=Math.pow(2,15)-1,YT=new je(0,1),iu=2147483648;function Um(l,n,a,u,m,h,g,b){l.emplaceBack((n<<1)+g,(a<<1)+h,(Math.floor(u*EF)<<1)+m,Math.round(b))}function Hm(l,n,a){l.emplaceBack(n.x*Yt,n.y*Yt,a?1:0)}function R0(l,n,a,u,m,h){l.emplaceBack(n.x,n.y,(a.x<<1)+u,(a.y<<1)+m,h)}function Gm(l,n,a){l.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class XT{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class KT{constructor(){this.centroidXY=new je(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new je(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new je(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new je(this.max.x-this.min.x,this.max.y-this.min.y)}}class JT{constructor(){this.acc=new je(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,a){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=a.x,n.min.y=n.max.y=a.y)}appendEdge(n,a,u){this.accCount++,this.acc._add(a);let m=!!this.borders;a.x<n.min.x?(n.min.x=a.x,m=!0):a.x>n.max.x&&(n.max.x=a.x,m=!0),a.y<n.min.y?(n.min.y=a.y,m=!0):a.y>n.max.y&&(n.max.y=a.y,m=!0),((a.x===0||a.x===Yt)&&a.x===u.x)!=((a.y===0||a.y===Yt)&&a.y===u.y)&&this.processBorderOverlap(a,u),m&&this.checkBorderIntersection(a,u)}checkBorderIntersection(n,a){a.x<0!=n.x<0&&this.addBorderIntersection(0,Pn(a.y,n.y,(0-a.x)/(n.x-a.x))),a.x>Yt!=n.x>Yt&&this.addBorderIntersection(1,Pn(a.y,n.y,(Yt-a.x)/(n.x-a.x))),a.y<0!=n.y<0&&this.addBorderIntersection(2,Pn(a.x,n.x,(0-a.y)/(n.y-a.y))),a.y>Yt!=n.y>Yt&&this.addBorderIntersection(3,Pn(a.x,n.x,(Yt-a.y)/(n.y-a.y)))}addBorderIntersection(n,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(n,a){if(n.x===a.x){if(n.y===a.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new je(0,0):new je(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,a)=>n+ +(a[0]!==Number.MAX_VALUE),0):0}}function QT(l,n){const a=l.add(n)._unit(),u=Qt(l.x*a.x+l.y*a.y,-1,1);var m,h,g;return g=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(g)))/4*MF*((m=l).x*(h=n).y-m.y*h.x<0?-1:1)}const IF=[l=>l.x<0,l=>l.x>Yt,l=>l.y<0,l=>l.y>Yt];function AF(l,n,a,u){const m=[4];if(u===0)return m;a._mult(u);const h=l.sub(a),g=n.sub(a),b=[l,n,h,g];for(let T=0;T<4;T++)for(const P of b)if(IF[T](P)){m.push(T);break}return m}class eE{constructor(n){this.vertexArray=new of,this.indexArray=new eo,this.programConfigurations=new dl(n.layers,{zoom:n.zoom,lut:n.lut},a=>TF.includes(a)),this._segments=new di,this.hiddenByLandmarkVertexArray=new uf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new di}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,a,u,m=!1){const h=n.length;if(h>2){let g=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let T;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const P=n[0],v=n[1];T=QT(P.sub(n[h-1])._perp()._unit(),v.sub(P)._perp()._unit())}for(let P=0;P<h;P++){const v=P===h-1?0:P+1,E=n[P],A=n[v],C=n[v===h-1?0:v+1],M=A.sub(E)._perp()._unit(),D=QT(M,C.sub(A)._perp()._unit()),k=T,V=D;if($b(E,A,a)||m&&rE(E,a)&&rE(A,a)){T=D;continue}const W=b.vertexLength;R0(this.vertexArray,E,A,1,1,k),R0(this.vertexArray,E,A,1,0,k),R0(this.vertexArray,E,A,0,1,V),R0(this.vertexArray,E,A,0,0,V),b.vertexLength+=4;const Z=AF(E,A,M,u);for(const H of Z)this._segmentToGroundQuads[g].push({id:W,region:H}),this._segmentToRegionTriCounts[g][H]+=2,b.primitiveLength+=2;T=D}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),a=n.length;for(let u=0;u<a;u++)this._segmentToGroundQuads[u].sort((m,h)=>m.region-h.region);for(let u=0;u<a;u++){const m=this._segmentToGroundQuads[u],h=n[u],g=this._segmentToRegionTriCounts[u];g.reduce((T,P)=>T+P,0);let b=0;for(let T=0;T<=4;T++){const P=g[T];if(P!==0){let v=this.regionSegments[T];v||(v=this.regionSegments[T]=new di);const E={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+b,vertexLength:h.vertexLength,primitiveLength:P};v.get().push(E)}b+=P}for(let T=0;T<m.length;T++){const P=m[T].id;this.indexArray.emplaceBack(P,P+1,P+3),this.indexArray.emplaceBack(P,P+3,P+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,a,u,m,h,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,a,u,m,h,g)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,_F.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,a,u,m,h,g,b){this.hasData()&&this.programConfigurations.updatePaintArrays(n,a,u,m,h,g,b)}updateHiddenByLandmark(n){if(!this.hasData())return;const a=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&iu?1:0;for(let m=n.groundVertexArrayOffset;m<a;++m)this.hiddenByLandmarkVertexArray.emplace(m,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,xF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const a=this.regionSegments[n];a&&a.destroy()}}}}class z0{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new eo,this.footprintVertices=new As,this.footprintSegments=[],this.layoutVertexArray=new Ps,this.centroidVertexArray=new Vo,this.wallVertexArray=new _0,this.indexArray=new eo,this.programConfigurations=new dl(n.layers,{zoom:n.zoom,lut:n.lut},a=>CF.includes(a)),this.segments=new di,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new eE(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,a){}populate(n,a,u,m){this.features=[],this.hasPattern=Tb("fill-extrusion",this.layers,this.pixelRatio,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=r(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:g,index:b,sourceLayerIndex:T}of n){const P=this.layers[0]._featureFilter.needGeometry,v=j(h,P);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),v,u))continue;const E={id:g,sourceLayerIndex:T,index:b,geometry:P?v.geometry:B(h,u,m),properties:h.properties,type:h.type,patterns:{}},A=this.layoutVertexArray.length,C=Lb[E.type]==="Polygon";if(this.hasPattern)this.features.push(Eb("fill-extrusion",this.layers,E,this.zoom,this.pixelRatio,a));else if(this.wallMode)for(const M of E.geometry)for(const D of ZT(M,C))this.addFeature(E,[D],b,u,{},a.availableImages,m,a.brightness);else this.addFeature(E,E.geometry,b,u,{},a.availableImages,m,a.brightness);a.featureIndex.insert(h,E.geometry,b,T,this.index,A)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,a,u,m,h,g){for(const b of this.features){const T=Lb[b.type]==="Polygon",{geometry:P}=b;if(this.wallMode)for(const v of P)for(const E of ZT(v,T))this.addFeature(b,[E],b.index,a,u,m,h,g);else this.addFeature(b,P,b.index,a,u,m,h,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,a,u,m,h,g,b){this.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b),this.groundEffect.update(n,a,h,u,m,g,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,wF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,vF.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,bF.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,yF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,u,m,h,g,b,T){const P=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,v=[new je(0,0),new je(Yt,Yt)],E=b.projection,A=E.name==="globe",C=this.wallMode||Lb[n.type]==="Polygon",M=new JT;M.centroidDataIndex=this.centroidData.length;const D=new KT,k=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},m)<=0,V=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},m);let W;if(D.height=V,D.vertexArrayOffset=this.layoutVertexArray.length,D.groundVertexArrayOffset=this.groundEffect.vertexArray.length,A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new yd),this.wallMode){if(A)return void kn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(a.length!==1)return;W=function(xe){const ke=xe[0].x===xe[xe.length-1].x&&xe[0].y===xe[xe.length-1].y;(function(kt){let Rt=0;const mn=kt.length;for(let en=0;en<mn;en++)Rt+=(kt[(en+1)%mn].x-kt[en].x)*(kt[(en+1)%mn].y+kt[en].y);return Rt>=0})(xe)||(xe=xe.reverse());const Ne={geometry:[],joinNormals:[],indices:[]},Ze=[],Ge=[],Je=[];let rt=xe.length;for(;rt>=2&&xe[rt-1].equals(xe[rt-2]);)rt--;if(rt<(ke?3:2))return Ne;let lt,nt,xt,Dt,vt,Jt=0;for(;Jt<rt-1&&xe[Jt].equals(xe[Jt+1]);)Jt++;ke&&(lt=xe[rt-2],vt=xe[Jt].sub(lt)._unit()._perp());for(let kt=Jt;kt<rt;kt++){if(xt=kt===rt-1?ke?xe[Jt+1]:void 0:xe[kt+1],xt&&xe[kt].equals(xt))continue;vt&&(Dt=vt),lt&&(nt=lt),lt=xe[kt],vt=xt?xt.sub(lt)._unit()._perp():Dt,Dt=Dt||vt;let Rt=Dt.add(vt);Rt.x===0&&Rt.y===0||Rt._unit();const mn=Rt.x*vt.x+Rt.y*vt.y,en=mn!==0?1/mn:1/0,sn=Dt.x*vt.y-Dt.y*vt.x>0;let zn="miter";const Vn=2;zn==="miter"&&en>Vn&&(zn="bevel"),zn==="bevel"&&(en>100&&(zn="flipbevel"),en<Vn&&(zn="miter"));const jn=(Un,Zn,Yn,Lr)=>{const Mr=new je(Un.x,Un.y),Fn=new je(Un.x,Un.y);Mr.x+=Zn.x*Lr,Mr.y+=Zn.y*Lr,Fn.x-=Zn.x*Math.max(Yn,1),Fn.y-=Zn.y*Math.max(Yn,1),Je.push(Zn),Ze.push(Mr),Ge.push(Fn)};if(zn==="miter")Rt._mult(en),jn(lt,Rt,0,0);else if(zn==="flipbevel")Rt=vt.mult(-1),jn(lt,Rt,0,0),jn(lt,Rt.mult(-1),0,0);else{const Un=-Math.sqrt(en*en-1),Zn=sn?Un:0,Yn=sn?0:Un;nt&&jn(lt,Dt,Zn,Yn),xt&&jn(lt,vt,Zn,Yn)}}Ne.geometry=[...Ze,...Ge.reverse(),Ze[0]],Ne.joinNormals=[...Je,...Je.reverse(),Je[Je.length-1]];const Zt=Ne.geometry.length-1;for(let kt=0;kt<Zt/2;kt++)if(kt+1<Zt/2){let Rt=kt,mn=kt+1,en=Zt-1-kt,sn=Zt-2-kt;Rt=Rt===0?Zt-1:Rt-1,mn=mn===0?Zt-1:mn-1,en=en===0?Zt-1:en-1,sn=sn===0?Zt-1:sn-1,Ne.indices.push(en),Ne.indices.push(mn),Ne.indices.push(Rt),Ne.indices.push(en),Ne.indices.push(sn),Ne.indices.push(mn)}return Ne}(a[0]),a=[W.geometry]}const Z=(xe,ke)=>xe<(ke.length-1)/2||xe===ke.length-1,H=this.wallMode?[a]:I0(a,500);for(let xe=H.length-1;xe>=0;xe--){const ke=H[xe];(ke.length===0||(Q=ke[0]).every(Ce=>Ce.x<=0)||Q.every(Ce=>Ce.x>=Yt)||Q.every(Ce=>Ce.y<=0)||Q.every(Ce=>Ce.y>=Yt))&&H.splice(xe,1)}var Q;let oe;if(A)oe=sE(H,v,m);else{oe=[];for(const xe of H)oe.push({polygon:xe,bounds:v})}const fe=C?this.edgeRadius:0,Se=fe>0&&this.zoom<17,we=(xe,ke)=>{if(xe.length===0)return!1;const Ce=xe[xe.length-1];return ke.x===Ce.x&&ke.y===Ce.y};for(const{polygon:xe,bounds:ke}of oe){let Ce=0,Ne=0;for(const rt of xe)C&&!rt[0].equals(rt[rt.length-1])&&rt.push(rt[0]),Ne+=C?rt.length-1:rt.length;const Ze=this.segments.prepareSegment((C?5:4)*Ne,this.layoutVertexArray,this.indexArray);D.footprintSegIdx<0&&(D.footprintSegIdx=this.footprintSegments.length),D.polygonSegIdx<0&&(D.polygonSegIdx=this.polygonSegments.length);const Ge={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Je=new XT;if(Je.vertexOffset=this.footprintVertices.length,Je.indexOffset=3*this.footprintIndices.length,Je.ringIndices=[],C){const rt=[],lt=[];Ce=Ze.vertexLength;for(let xt=0;xt<xe.length;xt++){const Dt=xe[xt];Dt.length&&xt!==0&&lt.push(rt.length/2);const vt=[];let Jt,Zt;Jt=Dt[1].sub(Dt[0])._perp()._unit(),Je.ringIndices.push(Dt.length-1);for(let kt=1;kt<Dt.length;kt++){const Rt=Dt[kt],mn=Dt[kt===Dt.length-1?1:kt+1],en=Rt.clone();if(fe){Zt=mn.sub(Rt)._perp()._unit();const sn=Jt.add(Zt)._unit(),zn=fe*Math.min(4,1/(Jt.x*sn.x+Jt.y*sn.y));en.x+=zn*sn.x,en.y+=zn*sn.y,en.x=Math.round(en.x),en.y=Math.round(en.y),Jt=Zt}if(!k||fe!==0&&!Se||we(vt,en)||vt.push(en),Um(this.layoutVertexArray,en.x,en.y,0,0,1,1,0),this.wallMode){const sn=Z(kt,Dt);Hm(this.wallVertexArray,W.joinNormals[kt],!sn)}Ze.vertexLength++,this.footprintVertices.emplaceBack(Rt.x,Rt.y),rt.push(Rt.x,Rt.y),A&&Gm(this.layoutVertexExtArray,E.projectTilePoint(en.x,en.y,m),E.upVector(m,en.x,en.y))}k&&(fe===0||Se)&&(vt.length!==0&&we(vt,vt[0])&&vt.pop(),this.groundEffect.addData(vt,ke,P))}const nt=this.wallMode?W.indices:km(rt,lt);for(let xt=0;xt<nt.length;xt+=3)this.footprintIndices.emplaceBack(Je.vertexOffset+nt[xt+0],Je.vertexOffset+nt[xt+1],Je.vertexOffset+nt[xt+2]),this.indexArray.emplaceBack(Ce+nt[xt],Ce+nt[xt+2],Ce+nt[xt+1]),Ze.primitiveLength++;Je.indexCount+=nt.length,Je.vertexCount+=this.footprintVertices.length-Je.vertexOffset}for(let rt=0;rt<xe.length;rt++){const lt=xe[rt];M.startRing(D,lt[0]);let nt=lt.length>4&&iE(lt[lt.length-2],lt[0],lt[1]),xt=fe?PF(lt[lt.length-2],lt[0],lt[1],fe):0;const Dt=[];let vt,Jt,Zt;Jt=lt[1].sub(lt[0])._perp()._unit();let kt=!0;for(let Rt=1,mn=0;Rt<lt.length;Rt++){let en=lt[Rt-1],sn=lt[Rt];const zn=lt[Rt===lt.length-1?1:Rt+1];if(M.appendEdge(D,sn,en),$b(sn,en,ke)){fe&&(Jt=zn.sub(sn)._perp()._unit(),kt=!kt);continue}const Vn=sn.sub(en)._perp(),jn=Vn.x/(Math.abs(Vn.x)+Math.abs(Vn.y)),Un=Vn.y>0?1:0,Zn=en.dist(sn);if(mn+Zn>32768&&(mn=0),fe){Zt=zn.sub(sn)._perp()._unit();let Fn=nE(en,sn,zn,tE(Jt,Zt),fe);isNaN(Fn)&&(Fn=0);const Sr=sn.sub(en)._unit();en=en.add(Sr.mult(xt))._round(),sn=sn.add(Sr.mult(-Fn))._round(),xt=Fn,Jt=Zt,k&&this.zoom>=17&&(we(Dt,en)||Dt.push(en),we(Dt,sn)||Dt.push(sn))}const Yn=Ze.vertexLength,Lr=lt.length>4&&iE(en,sn,zn);let Mr=oE(mn,nt,kt);if(Um(this.layoutVertexArray,en.x,en.y,jn,Un,0,0,Mr),Um(this.layoutVertexArray,en.x,en.y,jn,Un,0,1,Mr),this.wallMode){const Fn=Z(Rt-1,lt),Sr=W.joinNormals[Rt-1];Hm(this.wallVertexArray,Sr,Fn),Hm(this.wallVertexArray,Sr,Fn)}if(mn+=Zn,Mr=oE(mn,Lr,!kt),nt=Lr,Um(this.layoutVertexArray,sn.x,sn.y,jn,Un,0,0,Mr),Um(this.layoutVertexArray,sn.x,sn.y,jn,Un,0,1,Mr),this.wallMode){const Fn=Z(Rt,lt),Sr=W.joinNormals[Rt];Hm(this.wallVertexArray,Sr,Fn),Hm(this.wallVertexArray,Sr,Fn)}if(Ze.vertexLength+=4,this.indexArray.emplaceBack(Yn+0,Yn+1,Yn+2),this.indexArray.emplaceBack(Yn+1,Yn+3,Yn+2),Ze.primitiveLength+=2,fe){const Fn=Ce+(Rt===1?lt.length-2:Rt-2),Sr=Rt===1?Ce:Fn+1;if(this.indexArray.emplaceBack(Yn+1,Fn,Yn+3),this.indexArray.emplaceBack(Fn,Sr,Yn+3),Ze.primitiveLength+=2,vt===void 0&&(vt=Yn),!$b(zn,lt[Rt],ke)){const Er=Rt===lt.length-1?vt:Ze.vertexLength;this.indexArray.emplaceBack(Yn+2,Yn+3,Er),this.indexArray.emplaceBack(Yn+3,Er+1,Er),this.indexArray.emplaceBack(Yn+3,Sr,Er+1),Ze.primitiveLength+=3}kt=!kt}if(A){const Fn=this.layoutVertexExtArray,Sr=E.projectTilePoint(en.x,en.y,m),Er=E.projectTilePoint(sn.x,sn.y,m),Hr=E.upVector(m,en.x,en.y),_i=E.upVector(m,sn.x,sn.y);Gm(Fn,Sr,Hr),Gm(Fn,Sr,Hr),Gm(Fn,Er,_i),Gm(Fn,Er,_i)}}C&&(Ce+=lt.length-1),k&&fe&&this.zoom>=17&&(Dt.length!==0&&we(Dt,Dt[0])&&Dt.pop(),this.groundEffect.addData(Dt,ke,P,fe>0))}this.footprintSegments.push(Je),Ge.triangleCount=this.indexArray.length-Ge.triangleArrayOffset,this.polygonSegments.push(Ge),++D.footprintSegLen,++D.polygonSegLen}if(D.vertexCount=this.layoutVertexArray.length-D.vertexArrayOffset,D.groundVertexCount=this.groundEffect.vertexArray.length-D.groundVertexArrayOffset,D.vertexCount!==0){if(D.centroidXY=M.borders?YT:this.encodeCentroid(M,D),this.centroidData.push(D),M.borders){this.featuresOnBorder.push(M);const xe=this.featuresOnBorder.length-1;for(let ke=0;ke<M.borders.length;ke++)M.borders[ke][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ke].push(xe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,g,m,T),this.groundEffect.addPaintPropertiesData(n,u,h,g,m,T),this.maxHeight=Math.max(this.maxHeight,V)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((a,u)=>this.featuresOnBorder[a].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let b=0;b<this.centroidData.length;b++){const T=this.centroidData[b],P=+(T.min.y+T.max.y>Yt),v=2*P+(+(T.min.x+T.max.x>Yt)^P);for(let E=0;E<T.polygonSegLen;E++){const A=T.polygonSegIdx+E;n.push({centroidIdx:b,subtile:v,polygonSegmentIdx:A,triangleSegmentIdx:this.polygonSegments[A].triangleSegIdx})}}const a=new eo;n.sort((b,T)=>b.triangleSegmentIdx===T.triangleSegmentIdx?b.subtile-T.subtile:b.triangleSegmentIdx-T.triangleSegmentIdx);let u=0,m=0,h=0;for(const b of n){if(b.triangleSegmentIdx!==u)break;h++}const g=n.length;for(;m!==n.length;){u=n[m].triangleSegmentIdx;let b=0,T=m,P=m;for(let v=T;v<h&&n[v].subtile===b;v++)P++;for(;T!==h;){const v=n[T];b=v.subtile;const E=this.centroidData[v.centroidIdx].min.clone(),A=this.centroidData[v.centroidIdx].max.clone(),C={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let M=T;M<P;M++){const D=n[M],k=this.polygonSegments[D.polygonSegmentIdx],V=this.centroidData[D.centroidIdx].min,W=this.centroidData[D.centroidIdx].max,Z=this.indexArray.uint16;for(let H=k.triangleArrayOffset;H<k.triangleArrayOffset+k.triangleCount;H++)a.emplaceBack(Z[3*H],Z[3*H+1],Z[3*H+2]);C.primitiveLength+=k.triangleCount,E.x=Math.min(E.x,V.x),E.y=Math.min(E.y,V.y),A.x=Math.max(A.x,W.x),A.y=Math.max(A.y,W.y)}C.primitiveLength>0&&this.triangleSubSegments.push({segment:C,min:E,max:A}),T=P;for(let M=T;M<h&&n[M].subtile===n[T].subtile;M++)P++}m=h;for(let v=m;v<g&&n[v].triangleSegmentIdx===n[m].triangleSegmentIdx;v++)h++}a._trim(),this.indexArray=a}getVisibleSegments(n,a,u){const m=new di;if(this.wallMode){for(const D of this.triangleSubSegments)m.segments.push(D.segment);return m}let h=0,g=0;const b=1<<n.canonical.z;if(a){const D=a.getMinMaxForTile(n);D&&(h=D.min,g=D.max)}g+=this.maxHeight;const T=n.toUnwrapped();let P;const v=[T.canonical.x/b+T.wrap,T.canonical.y/b],E=[(T.canonical.x+1)/b+T.wrap,(T.canonical.y+1)/b],A=(D,k,V)=>[D[0]*(1-V[0])+k[0]*V[0],D[1]*(1-V[1])+k[1]*V[1]],C=[],M=[];for(const D of this.triangleSubSegments){C[0]=D.min.x/Yt,C[1]=D.min.y/Yt,M[0]=D.max.x/Yt,M[1]=D.max.y/Yt;const k=A(v,E,C),V=A(v,E,M);if(new vn([k[0],k[1],h],[V[0],V[1],g]).intersectsPrecise(u)===0){P&&(m.segments.push(P),P=void 0);continue}const W=D.segment;P&&P.vertexOffset!==W.vertexOffset&&(m.segments.push(P),P=void 0),P?(P.vertexLength+=W.vertexLength,P.primitiveLength+=W.primitiveLength):P={vertexOffset:W.vertexOffset,primitiveLength:W.primitiveLength,vertexLength:W.vertexLength,primitiveOffset:W.primitiveOffset,sortKey:void 0,vaos:{}}}return P&&m.segments.push(P),m}encodeCentroid(n,a){const u=n.centroid(),m=a.span(),h=Math.min(7,Math.round(m.x*this.tileToMeter/10)),g=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new je(Qt(u.x,1,Yt-1)<<3|h,Qt(u.y,1,Yt-1)<<3|g)}encodeBorderCentroid(n){if(!n.borders)return new je(0,0);const a=n.borders,u=Number.MAX_VALUE;if(a[0][0]!==u||a[1][0]!==u){const m=a[0][0]!==u?0:1;return new je(6|(a[0][0]!==u?0:65528),(a[m][0]+a[m][1])/2<<3|6)}{const m=a[2][0]!==u?2:3;return new je((a[m][0]+a[m][1])/2<<3|6,6|(a[2][0]!==u?0:65528))}}showCentroid(n){const a=this.centroidData[n.centroidDataIndex];a.flags&=iu,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const a=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,m=n.flags&iu?YT:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==m.y||h!==m.x){for(let g=a;g<u;++g)this.centroidVertexArray.emplace(g,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,a,u){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const m=a.getReplacementRegionsForTile(n.toUnwrapped());if(Rb(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const h=[];for(const g of this.activeReplacements){if(g.order<u)continue;const b=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-n.canonical.z));for(const T of this.centroidData)if(!(T.flags&iu||g.min.x>T.max.x||T.min.x>g.max.x||g.min.y>T.max.y||T.min.y>g.max.y))for(let P=0;P<T.footprintSegLen;P++){const v=this.footprintSegments[T.footprintSegIdx+P];if(h.length=0,OF(this.footprintVertices,v.vertexOffset,v.vertexCount,g.footprintTileId.canonical,n.canonical,h),HT(g.footprint,h,this.footprintIndices.uint16,v.indexOffset,v.indexCount,-v.vertexOffset,-b)){T.flags|=iu;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,a,u){let m=!1;for(let h=0;h<u.footprintSegLen;h++){const g=this.footprintSegments[u.footprintSegIdx+h];let b=0;for(const T of g.ringIndices){for(let P=b,v=T+b-1;P<T+b;v=P++){const E=this.footprintVertices.int16[2*(P+g.vertexOffset)+0],A=this.footprintVertices.int16[2*(P+g.vertexOffset)+1],C=this.footprintVertices.int16[2*(v+g.vertexOffset)+1];A>a!=C>a&&n<(this.footprintVertices.int16[2*(v+g.vertexOffset)+0]-E)*(a-A)/(C-A)+E&&(m=!m)}b=T}}return m}getHeightAtTileCoord(n,a){let u=Number.NEGATIVE_INFINITY,m=!0;const h=4*(n+Yt)*Yt+(a+Yt);if(this.partLookup.hasOwnProperty(h)){const g=this.partLookup[h];return g?{height:g.height,hidden:!!(g.flags&iu)}:void 0}for(const g of this.centroidData)n>g.max.x||g.min.x>n||a>g.max.y||g.min.y>a||this.footprintContainsPoint(n,a,g)&&g&&g.height>u&&(u=g.height,this.partLookup[h]=g,m=!!(g.flags&iu));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:m};this.partLookup[h]=void 0}}function tE(l,n){const a=l.add(n)._unit();return l.x*a.x+l.y*a.y}function PF(l,n,a,u){const m=n.sub(l)._perp()._unit(),h=a.sub(n)._perp()._unit();return nE(l,n,a,tE(m,h),u)}function nE(l,n,a,u,m){const h=Math.sqrt(1-u*u);return Math.min(l.dist(n)/3,n.dist(a)/3,m*h/u)}function $b(l,n,a){return l.x<a[0].x&&n.x<a[0].x||l.x>a[1].x&&n.x>a[1].x||l.y<a[0].y&&n.y<a[0].y||l.y>a[1].y&&n.y>a[1].y}function rE(l,n){return l.x<n[0].x||l.x>n[1].x||l.y<n[0].y||l.y>n[1].y}function iE(l,n,a){if(l.x<0||l.x>=Yt||n.x<0||n.x>=Yt||a.x<0||a.x>=Yt)return!1;const u=a.sub(n),m=u.perp(),h=l.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&m.x*h.x+m.y*h.y<0}function oE(l,n,a){const u=n?2|l:-3&l;return a?1|u:-2&u}function aE(){const l=Math.PI/32,n=Math.tan(l),a=ic;return a*Math.sqrt(1+2*n*n)-a}function sE(l,n,a){const u=1<<a.z,m=jo(a.x/u),h=jo((a.x+1)/u),g=to(a.y/u),b=to((a.y+1)/u);return function(T,P,v,E,A=0,C){const M=[];if(!T.length||!v||!E)return M;const D=(oe,fe)=>{for(const Se of oe)M.push({polygon:Se,bounds:fe})},k=Math.ceil(Math.log2(v)),V=Math.ceil(Math.log2(E)),W=k-V,Z=[];for(let oe=0;oe<Math.abs(W);oe++)Z.push(W>0?0:1);for(let oe=0;oe<Math.min(k,V);oe++)Z.push(0),Z.push(1);let H=T;if(H=P0(H,P[0].y-A,P[1].y+A,1),H=P0(H,P[0].x-A,P[1].x+A,0),!H.length)return M;const Q=[];for(Z.length?Q.push({polygons:H,bounds:P,depth:0}):D(H,P);Q.length;){const oe=Q.pop(),fe=oe.depth,Se=Z[fe],we=oe.bounds[0],xe=oe.bounds[1],ke=Se===0?we.x:we.y,Ce=Se===0?xe.x:xe.y,Ne=C(Se,ke,Ce),Ze=P0(oe.polygons,ke-A,Ne+A,Se),Ge=P0(oe.polygons,Ne-A,Ce+A,Se);if(Ze.length){const Je=[we,new je(Se===0?Ne:xe.x,Se===1?Ne:xe.y)];Z.length>fe+1?Q.push({polygons:Ze,bounds:Je,depth:fe+1}):D(Ze,Je)}if(Ge.length){const Je=[new je(Se===0?Ne:we.x,Se===1?Ne:we.y),xe];Z.length>fe+1?Q.push({polygons:Ge,bounds:Je,depth:fe+1}):D(Ge,Je)}}return M}(l,n,Math.ceil((h-m)/11.25),Math.ceil((g-b)/11.25),1,(T,P,v)=>{if(T===0)return .5*(P+v);{const E=to((a.y+P/Yt)/u);return(Ma(.5*(to((a.y+v/Yt)/u)+E))*u-a.y)*Yt}})}function OF(l,n,a,u,m,h){const g=Math.pow(2,u.z-m.z);for(let b=0;b<a;b++){let T=l.int16[2*(b+n)+0],P=l.int16[2*(b+n)+1];T=(T+m.x*Yt)*g-u.x*Yt,P=(P+m.y*Yt)*g-u.y*Yt,h.push(new je(T,P))}}let lE,cE;function Wm(l,n){return l.x*n.x+l.y*n.y}function uE(l,n){if(l.length===1){let a=0;const u=n[a++];let m;for(;!m||u.equals(m);)if(m=n[a++],!m)return 1/0;for(;a<n.length;a++){const h=n[a],g=l[0],b=m.sub(u),T=h.sub(u),P=g.sub(u),v=Wm(b,b),E=Wm(b,T),A=Wm(T,T),C=Wm(P,b),M=Wm(P,T),D=v*A-E*E,k=(A*C-E*M)/D,V=(v*M-E*C)/D,W=u.z*(1-k-V)+m.z*k+h.z*V;if(isFinite(W))return W}return 1/0}{let a=1/0;for(const u of n)a=Math.min(a,u.z);return a}}function dE(l,n,a,u,m,h,g,b){const T=g*m.getElevationAt(l,n,!0,!0),P=h[0]!==0,v=P?h[1]===0?g*(h[0]/7-450):g*function(E,A,C){const M=Math.floor(A[0]/8),D=Math.floor(A[1]/8),k=10*(A[0]-8*M),V=10*(A[1]-8*D),W=E.getElevationAt(M,D,!0,!0),Z=E.getMeterToDEM(C),H=Math.floor(.5*(k*Z-1)),Q=Math.floor(.5*(V*Z-1)),oe=E.tileCoordToPixel(M,D),fe=2*H+1,Se=2*Q+1,we=function(Ge,Je,rt,lt,nt){return[Ge.getElevationAtPixel(Je,rt,!0),Ge.getElevationAtPixel(Je+nt,rt,!0),Ge.getElevationAtPixel(Je,rt+nt,!0),Ge.getElevationAtPixel(Je+lt,rt+nt,!0)]}(E,oe.x-H,oe.y-Q,fe,Se),xe=Math.abs(we[0]-we[1]),ke=Math.abs(we[2]-we[3]),Ce=Math.abs(we[0]-we[2])+Math.abs(we[1]-we[3]),Ne=Math.min(.25,.5*Z*(xe+ke)/fe),Ze=Math.min(.25,.5*Z*Ce/Se);return W+Math.max(Ne*k,Ze*V)}(m,h,b):T;return{base:T+(a===0?-1:a),top:P?Math.max(v+u,T+a+2):T+u}}fn(z0,"FillExtrusionBucket",{omit:["layers","features"]}),fn(KT,"PartData"),fn(XT,"FootprintSegment"),fn(JT,"BorderCentroidData"),fn(eE,"GroundEffect");const DF=gr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),RF=gr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:zF}=DF,LF=gr([{name:"a_packed",components:3,type:"Float32"}]),{members:$F}=LF,FF=gr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:BF}=FF;class hE{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.image=new ru({width:n,height:a}),this.positions={},this.uploaded=!1}getDash(n,a){const u=this.getKey(n,a);return this.positions[u]}trim(){const n=this.width,a=this.height=Yi(this.nextRow);this.image.resize({width:n,height:a})}getKey(n,a){return n.join(",")+a}getDashRanges(n,a,u){const m=[];let h=n.length%2==1?-n[n.length-1]*u:0,g=n[0]*u,b=!0;m.push({left:h,right:g,isDash:b,zeroLength:n[0]===0});let T=n[0];for(let P=1;P<n.length;P++){b=!b;const v=n[P];h=T*u,T+=v,g=T*u,m.push({left:h,right:g,isDash:b,zeroLength:v===0})}return m}addRoundDash(n,a,u){const m=a/2;for(let h=-u;h<=u;h++){const g=this.width*(this.nextRow+u+h);let b=0,T=n[b];for(let P=0;P<this.width;P++){P/T.right>1&&(T=n[++b]);const v=Math.abs(P-T.left),E=Math.abs(P-T.right),A=Math.min(v,E);let C;const M=h/u*(m+1);if(T.isDash){const D=m-Math.abs(M);C=Math.sqrt(A*A+D*D)}else C=m-Math.sqrt(A*A+M*M);this.image.data[g+P]=Math.max(0,Math.min(255,C+128))}}}addRegularDash(n,a){for(let T=n.length-1;T>=0;--T){const P=n[T],v=n[T+1];P.zeroLength?n.splice(T,1):v&&v.isDash===P.isDash&&(v.left=P.left,n.splice(T,1))}const u=n[0],m=n[n.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const h=this.width*this.nextRow;let g=0,b=n[g];for(let T=0;T<this.width;T++){T/b.right>1&&(b=n[++g]);const P=Math.abs(T-b.left),v=Math.abs(T-b.right),E=Math.min(P,v);this.image.data[h+T]=Math.max(0,Math.min(255,(b.isDash?E:-E)+a+128))}}addDash(n,a){const u=this.getKey(n,a);if(this.positions[u])return this.positions[u];const m=a==="round",h=m?7:0,g=2*h+1;if(this.nextRow+g>this.height)return kn("LineAtlas out of space"),null;n.length===0&&n.push(1);let b=0;for(let v=0;v<n.length;v++)n[v]<0&&(kn("Negative value is found in line dasharray, replacing values with 0"),n[v]=0),b+=n[v];if(b!==0){const v=this.width/b,E=this.getDashRanges(n,this.width,v);m?this.addRoundDash(E,v,h):this.addRegularDash(E,a==="square"?.5*v:0)}const T=this.nextRow+h;this.nextRow+=g;const P={tl:[T,h],br:[b,0]};return this.positions[u]=P,P}}fn(hE,"LineAtlas");const kF=yf.VectorTileFeature.types,NF=Math.cos(Math.PI/180*37.5),VF=Math.cos(Math.PI/180*5);class Fb{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new _d,this.layoutVertexArray2=new Ja,this.patternVertexArray=new Ja,this.indexArray=new eo,this.programConfigurations=new dl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new di,this.maxLineLength=0,this.zOffsetVertexArray=new Ja,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:Yt/64}updateFootprints(n,a){}populate(n,a,u,m){this.hasPattern=Tb("line",this.layers,this.pixelRatio,a);const h=this.layers[0].layout.get("line-sort-key");this.tileToMeter=r(u);const g=this.layers[0].layout.get("line-z-offset"),b=g.isConstant()&&!g.constantOr(0),T=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=T==="sea"||T==="ground"||!b&&T==="none",this.hasZOffset&&T==="none"&&kn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const P=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&P!==void 0;const v=[];for(const{feature:M,id:D,index:k,sourceLayerIndex:V}of n){const W=this.layers[0]._featureFilter.needGeometry,Z=j(M,W);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),Z,u))continue;const H=h?h.evaluate(Z,{},u):void 0,Q={id:D,properties:M.properties,type:M.type,sourceLayerIndex:V,index:k,geometry:W?Z.geometry:B(M,u,m),patterns:{},sortKey:H};v.push(Q)}h&&v.sort((M,D)=>M.sortKey-D.sortKey);const{lineAtlas:E,featureIndex:A}=a,C=this.addConstantDashes(E);for(const M of v){const{geometry:D,index:k,sourceLayerIndex:V}=M;if(C&&this.addFeatureDashes(M,E),this.hasPattern){const W=Eb("line",this.layers,M,this.zoom,this.pixelRatio,a);this.patternFeatures.push(W)}else this.addFeature(M,D,k,u,E.positions,a.availableImages,a.brightness);A.insert(n[k].feature,D,k,V,this.index)}}addConstantDashes(n){let a=!1;for(const u of this.layers){const m=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(m.kind!=="constant"||h.kind!=="constant")a=!0;else{const g=h.value,b=m.value;if(!b)continue;n.addDash(b,g)}}return a}addFeatureDashes(n,a){const u=this.zoom;for(const m of this.layers){const h=m.paint.get("line-dasharray").value,g=m.layout.get("line-cap").value;if(h.kind==="constant"&&g.kind==="constant")continue;let b,T;if(h.kind==="constant"){if(b=h.value,!b)continue}else b=h.evaluate({zoom:u},n);T=g.kind==="constant"?g.value:g.evaluate({zoom:u},n),a.addDash(b,T),n.patterns[m.id]=a.getKey(b,T)}}update(n,a,u,m,h,g,b){this.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b)}addFeatures(n,a,u,m,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,a,u,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,$F)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,BF)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,RF.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,zF),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,u,m,h,g,b){const T=this.layers[0].layout,P=T.get("line-join").evaluate(n,{}),v=T.get("line-cap").evaluate(n,{}),E=T.get("line-miter-limit"),A=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=T.get("line-z-offset").value;const C=this.layers[0].paint.get("line-width").value;C.kind!=="constant"&&C.isLineProgressConstant===!1&&(this.variableWidthValue=C);for(const M of a)this.addLine(M,n,m,P,v,E,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,g,m,b)}addLine(n,a,u,m,h,g,b){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const T=m==="none";if(this.patternJoinNone=this.hasPattern&&T,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Z=0;Z<n.length-1;Z++)this.totalDistance+=n[Z].dist(n[Z+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=kF[a.type]==="Polygon";let v=n.length;for(;v>=2&&n[v-1].equals(n[v-2]);)v--;let E=0;for(;E<v-1&&n[E].equals(n[E+1]);)E++;if(v<(P?3:2))return;m==="bevel"&&(g=1.05);const A=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let C,M,D,k,V,W;this.e1=this.e2=-1,P&&(C=n[v-2],V=n[E].sub(C)._unit()._perp());for(let Z=E;Z<v;Z++){if(D=Z===v-1?P?n[E+1]:void 0:n[Z+1],D&&n[Z].equals(D))continue;V&&(k=V),C&&(M=C),C=n[Z],W=this.evaluateLineProgressFeatures(M?M.dist(C):0),V=D?D.sub(C)._unit()._perp():k,k=k||V;const H=M&&D;let Q=H?m:P||T?"butt":h;const oe=k.x*V.x+k.y*V.y;if(T){const Ze=function(Ge){if(Ge.patternJoinNone){const Je=Ge.segmentPoints.length/2,rt=Ge.lineSoFar-Ge.segmentStart;for(let lt=0;lt<Je;++lt){const nt=Ge.segmentPoints[2*lt+1],xt=Math.round(Ge.segmentPoints[2*lt])+.5+.25*nt;Ge.patternVertexArray.emplaceBack(xt,rt,Ge.segmentStart),Ge.patternVertexArray.emplaceBack(xt,rt,Ge.segmentStart)}Ge.segmentPoints.length=0}Ge.e1=Ge.e2=-1};if(H&&oe<VF){this.updateDistance(M,C),this.addCurrentVertex(C,k,1,1,A,W),Ze(this),this.addCurrentVertex(C,V,-1,-1,A,W);continue}if(M){if(!D){this.updateDistance(M,C),this.addCurrentVertex(C,k,1,1,A,W),Ze(this);continue}Q="miter"}}let fe=k.add(V);fe.x===0&&fe.y===0||fe._unit();const Se=fe.x*V.x+fe.y*V.y,we=Se!==0?1/Se:1/0,xe=2*Math.sqrt(2-2*Se),ke=Se<NF&&M&&D,Ce=k.x*V.y-k.y*V.x>0,Ne=this.overscaling<=16?15*Yt/(512*this.overscaling):0;if(H&&Q==="round"){if(we<b)Q="miter";else if(we<=2){const Ze=Bb(C,-10,Yt+10);Q=this.hasZOffset&&(Ze||this.hasCrossSlope)?"miter":"fakeround"}}if(Q==="miter"&&we>g&&(Q="bevel"),Q==="bevel"&&(we>2&&(Q="flipbevel"),we<g&&(Q="miter")),M&&!(Q==="miter"&&ke)&&this.updateDistance(M,C),Q==="miter")if(ke){const Ze=C.dist(M);if(Ze>2*Ne){const Je=C.sub(C.sub(M)._mult(Ne/Ze)._round());this.updateDistance(M,Je),this.addCurrentVertex(Je,k,0,0,A,W),M=Je}this.updateDistance(M,C),fe._mult(we),this.addCurrentVertex(C,fe,0,0,A,W);const Ge=C.dist(D);if(Ge>2*Ne){const Je=C.add(D.sub(C)._mult(Ne/Ge)._round());this.updateDistance(C,Je),this.addCurrentVertex(Je,V,0,0,A,W),C=Je}}else fe._mult(we),this.addCurrentVertex(C,fe,0,0,A,W);else if(Q==="flipbevel"){if(we>100)fe=V.mult(-1);else{const Ze=we*k.add(V).mag()/k.sub(V).mag();fe._perp()._mult(Ze*(Ce?-1:1))}this.addCurrentVertex(C,fe,0,0,A,W),this.addCurrentVertex(C,fe.mult(-1),0,0,A,W)}else if(Q==="bevel"||Q==="fakeround"){W!=null&&M&&this.addCurrentVertex(C,k,-1,-1,A,W);const Ze=C.dist(M)<=2*Ne&&Q!=="bevel",Ge=fe.mult(Ce?1:-1);Ge._mult(we);const Je=V.mult(Ce?-1:1),rt=k.mult(Ce?-1:1),lt=this.evaluateLineProgressFeatures(this.distance);if(W==null&&(this.addHalfVertex(C,Ge.x,Ge.y,!1,!Ce,0,A,lt),Ze||this.addHalfVertex(C,Ge.x+2*rt.x,Ge.y+2*rt.y,!1,Ce,0,A,lt)),Q==="fakeround"){const nt=Math.round(180*xe/Math.PI/20);this.addHalfVertex(C,rt.x,rt.y,!1,Ce,0,A,lt);for(let xt=0;xt<nt;xt++){let Dt=xt/nt;if(Dt!==.5){const Jt=Dt-.5;Dt+=Dt*Jt*(Dt-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Jt*Jt+(.848013+oe*(.215638*oe-1.06021)))}const vt=Je.sub(rt)._mult(Dt)._add(rt)._unit();this.addHalfVertex(C,vt.x,vt.y,!1,Ce,0,A,lt)}this.addHalfVertex(C,Je.x,Je.y,!1,Ce,0,A,lt)}Ze||W!=null||this.addHalfVertex(C,Ge.x+2*Je.x,Ge.y+2*Je.y,!1,Ce,0,A,lt),W!=null&&D&&this.addCurrentVertex(C,V,1,1,A,W)}else Q==="butt"?this.addCurrentVertex(C,fe,0,0,A,W):Q==="square"?(M||this.addCurrentVertex(C,fe,-1,-1,A,W),this.addCurrentVertex(C,fe,0,0,A,W),M&&this.addCurrentVertex(C,fe,1,1,A,W)):Q==="round"&&(M&&(this.addCurrentVertex(C,k,0,0,A,W),this.addCurrentVertex(C,k,1,1,A,W,!0)),D&&(this.addCurrentVertex(C,V,-1,-1,A,W,!0),this.addCurrentVertex(C,V,0,0,A,W)))}}addVerticesTo(n,a,u,m,h,g,b,T,P,v){const E=(a.w-n.w)/this.tessellationStep|0;let A=0;const C=this.scaledDistance;if(E>1){this.lineSoFar=n.w;const D=(a.x-n.x)/E,k=(a.y-n.y)/E,V=(a.z-n.z)/E,W=(a.w-n.w)/E;for(let Z=1;Z<E;++Z){n.x+=D,n.y+=k,n.z+=V,this.lineSoFar+=W,A+=W;const H=this.evaluateLineProgressFeatures(this.prevDistance+A);this.scaledDistance=(this.prevDistance+A)/this.totalDistance,this.addHalfVertex(n,u,m,v,!1,b,P,H),this.addHalfVertex(n,h,g,v,!0,-T,P,H)}}this.lineSoFar=a.w,this.scaledDistance=C;const M=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(a,u,m,v,!1,b,P,M),this.addHalfVertex(a,h,g,v,!0,-T,P,M)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):kn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let a=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(a=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:a}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:a}:{zOffset:0,variableWidth:a}}addCurrentVertex(n,a,u,m,h,g,b=!1){const T=a.x+a.y*u,P=a.y-a.x*u,v=a.y*m-a.x,E=-a.y-a.x*m;if(g!=null){const A=this.hasZOffset,C=-10,M=Yt+10,D=g.zOffset,k=new BT(n.x,n.y,D,this.lineSoFar),V=!!A&&Bb(n,C,M),W=this.lineSoFar,Z=this.distance;if(this.currentVertex)if(V){const H=this.currentVertexIsOutside,Q=this.currentVertex,oe=new BT(n.x,n.y,D,this.lineSoFar);if(NT(Q,oe,C,M),!Bb(oe,C,M)){if(H){this.e1=this.e2=-1,this.distance-=Q.dist(k),this.lineSoFar=Q.w;const fe=this.evaluateLineProgressFeatures(Q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Q,T,P,b,!1,u,h,fe),this.addHalfVertex(Q,v,E,b,!0,-m,h,fe),this.prevDistance=this.distance}this.distance=this.prevDistance+Q.dist(oe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Q,oe,T,P,v,E,u,m,h,b),this.distance=Z,this.scaledDistance=this.distance/this.totalDistance}}else{const H=this.currentVertex;if(this.currentVertexIsOutside){NT(H,k,C,M),this.e1=this.e2=-1,this.distance-=H.dist(k),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=H.w;const Q=this.evaluateLineProgressFeatures(H.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(H,T,P,b,!1,u,h,Q),this.addHalfVertex(H,v,E,b,!0,-m,h,Q),this.prevDistance=this.distance,this.distance=Z,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(H,k,T,P,v,E,u,m,h,b)}else V||(this.addHalfVertex(n,T,P,b,!1,u,h,g),this.addHalfVertex(n,v,E,b,!0,-m,h,g));this.currentVertex=k,this.currentVertexIsOutside=V,this.lineSoFar=W}else this.addHalfVertex(n,T,P,b,!1,u,h,g),this.addHalfVertex(n,v,E,b,!0,-m,h,g)}addHalfVertex({x:n,y:a},u,m,h,g,b,T,P){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(a<<1)+(g?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const E=Pn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,E)}const v=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),T.primitiveLength++),g?this.e2=v:this.e1=v,P!=null&&this.zOffsetVertexArray.emplaceBack(P.zOffset,P.variableWidth,P.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,a){this.prevDistance=this.distance,this.distance+=n.dist(a),this.updateScaledDistance()}}function Bb(l,n,a){return l.x<n||l.x>a||l.y<n||l.y>a}let fE,pE;function mE(l,n,a){return n*(Yt/(l.tileSize*Math.pow(2,a-l.tileID.overscaledZ)))}fn(Fb,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const gE=(l,n,a)=>(1-a)*l+a*n;function _E(l,n){return 1/mE(l,1,n.tileZoom)}function yE(l,n,a,u){return l.translatePosMatrix(u||n.tileID.projMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const vE=l=>{const n=[];xE(l)&&n.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const a=l.paint.get("line-trim-offset");a[0]===0&&a[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=l.layout.get("line-join").constantOr("miter")==="none",m=!!l.paint.get("line-pattern").constantOr(1);return u&&m&&n.push("LINE_JOIN_NONE"),n};function xE(l){const n=l.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let kb;const bE=()=>kb||(kb={layout:fE||(fE=new Yr({"line-cap":new on(ut.layout_line["line-cap"]),"line-join":new on(ut.layout_line["line-join"]),"line-miter-limit":new Vt(ut.layout_line["line-miter-limit"]),"line-round-limit":new Vt(ut.layout_line["line-round-limit"]),"line-sort-key":new on(ut.layout_line["line-sort-key"]),"line-z-offset":new on(ut.layout_line["line-z-offset"]),"line-elevation-reference":new Vt(ut.layout_line["line-elevation-reference"]),"line-cross-slope":new Vt(ut.layout_line["line-cross-slope"]),visibility:new Vt(ut.layout_line.visibility),"line-width-unit":new Vt(ut.layout_line["line-width-unit"])})),paint:pE||(pE=new Yr({"line-opacity":new on(ut.paint_line["line-opacity"]),"line-color":new on(ut.paint_line["line-color"]),"line-translate":new Vt(ut.paint_line["line-translate"]),"line-translate-anchor":new Vt(ut.paint_line["line-translate-anchor"]),"line-width":new on(ut.paint_line["line-width"]),"line-gap-width":new on(ut.paint_line["line-gap-width"]),"line-offset":new on(ut.paint_line["line-offset"]),"line-blur":new on(ut.paint_line["line-blur"]),"line-dasharray":new on(ut.paint_line["line-dasharray"]),"line-pattern":new on(ut.paint_line["line-pattern"]),"line-gradient":new qc(ut.paint_line["line-gradient"]),"line-trim-offset":new Vt(ut.paint_line["line-trim-offset"]),"line-trim-fade-range":new Vt(ut.paint_line["line-trim-fade-range"]),"line-trim-color":new Vt(ut.paint_line["line-trim-color"]),"line-emissive-strength":new Vt(ut.paint_line["line-emissive-strength"]),"line-border-width":new on(ut.paint_line["line-border-width"]),"line-border-color":new on(ut.paint_line["line-border-color"]),"line-occlusion-opacity":new Vt(ut.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},kb);class jF extends on{possiblyEvaluate(n,a){return a=new Br(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,u,m){return a=nr({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,u,m)}}let qm;function wE(l,n){return n>0?n+2*l:l}const UF=gr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),HF=gr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),GF=gr([{name:"a_projected_pos",components:4,type:"Float32"}],4);gr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const WF=gr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),qF=gr([{name:"a_texb",components:2,type:"Uint16"}]),ZF=gr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),YF=gr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);gr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const SE=gr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),XF=gr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);gr([{name:"triangle",components:3,type:"Uint16"}]),gr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),gr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),gr([{type:"Float32",name:"offsetX"}]),gr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var go=24;const Ds=128;function Nb(l,n,a,u,m){if(l.kind==="camera")return l.maxSize;if(l.kind==="composite"){const h=n.possiblyEvaluate(new Br(l.maxZoom),a).evaluate(m,{},a),g=n.possiblyEvaluate(new Br(l.minZoom),a).evaluate(m,{},a);return Math.max(h,g)}return n.possiblyEvaluate(new Br(u)).evaluate(m,{},a)}function Vb(l,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Br(l+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=a;let h=0;for(;h<u.length&&u[h]<=l;)h++;h=Math.max(0,h-1);let g=h;for(;g<u.length&&u[g]<l+1;)g++;g=Math.min(u.length-1,g);const b=u[h],T=u[g];return a.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:T,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:T,minSize:a.evaluate(new Br(b)),maxSize:a.evaluate(new Br(T)),interpolationType:m}}}function L0(l,{uSize:n,uSizeT:a},{lowerSize:u,upperSize:m}){return l.kind==="source"?u/Ds:l.kind==="composite"?Pn(u/Ds,m/Ds,a):n}function vf(l,n,a=1){let u=0,m=0;if(l.kind==="constant")m=l.layoutSize*a;else if(l.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:b}=l,T=h?Qt(ko.interpolationFactor(h,n,g,b),0,1):0;l.kind==="camera"?m=Pn(l.minSize,l.maxSize,T)*a:u=T*a}return{uSizeT:u,uSize:m}}var KF=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ds,evaluateSizeForFeature:L0,evaluateSizeForZoom:vf,getRasterizedIconSize:Nb,getSizeData:Vb});function JF(l,n,a){return l.sections.forEach(u=>{u.text=function(m,h,g){const b=h.layout.get("text-transform").evaluate(g,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),Zo.applyArabicShaping&&(m=Zo.applyArabicShaping(m)),m}(u.text,n,a)}),l}const Zm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function QF(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function eB(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var CE,jb,TE,Ub={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function tB(){return CE||(CE=1,Ub.read=function(l,n,a,u,m){var h,g,b=8*m-u-1,T=(1<<b)-1,P=T>>1,v=-7,E=a?m-1:0,A=a?-1:1,C=l[n+E];for(E+=A,h=C&(1<<-v)-1,C>>=-v,v+=b;v>0;h=256*h+l[n+E],E+=A,v-=8);for(g=h&(1<<-v)-1,h>>=-v,v+=u;v>0;g=256*g+l[n+E],E+=A,v-=8);if(h===0)h=1-P;else{if(h===T)return g?NaN:1/0*(C?-1:1);g+=Math.pow(2,u),h-=P}return(C?-1:1)*g*Math.pow(2,h-u)},Ub.write=function(l,n,a,u,m,h){var g,b,T,P=8*h-m-1,v=(1<<P)-1,E=v>>1,A=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=u?0:h-1,M=u?1:-1,D=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(b=isNaN(n)?1:0,g=v):(g=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-g))<1&&(g--,T*=2),(n+=g+E>=1?A/T:A*Math.pow(2,1-E))*T>=2&&(g++,T/=2),g+E>=v?(b=0,g=v):g+E>=1?(b=(n*T-1)*Math.pow(2,m),g+=E):(b=n*Math.pow(2,E-1)*Math.pow(2,m),g=0));m>=8;l[a+C]=255&b,C+=M,b/=256,m-=8);for(g=g<<m|b,P+=m;P>0;l[a+C]=255&g,C+=M,g/=256,P-=8);l[a+C-M]|=128*D}),Ub}function EE(){if(TE)return jb;TE=1,jb=n;var l=tB();function n(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,u=1/a,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(H){return H.type===n.Bytes?H.readVarint()+H.pos:H.pos+1}function g(H,Q,oe){return oe?4294967296*Q+(H>>>0):4294967296*(Q>>>0)+(H>>>0)}function b(H,Q,oe){var fe=Q<=16383?1:Q<=2097151?2:Q<=268435455?3:Math.floor(Math.log(Q)/(7*Math.LN2));oe.realloc(fe);for(var Se=oe.pos-1;Se>=H;Se--)oe.buf[Se+fe]=oe.buf[Se]}function T(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeVarint(H[oe])}function P(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeSVarint(H[oe])}function v(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeFloat(H[oe])}function E(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeDouble(H[oe])}function A(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeBoolean(H[oe])}function C(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeFixed32(H[oe])}function M(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeSFixed32(H[oe])}function D(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeFixed64(H[oe])}function k(H,Q){for(var oe=0;oe<H.length;oe++)Q.writeSFixed64(H[oe])}function V(H,Q){return(H[Q]|H[Q+1]<<8|H[Q+2]<<16)+16777216*H[Q+3]}function W(H,Q,oe){H[oe]=Q,H[oe+1]=Q>>>8,H[oe+2]=Q>>>16,H[oe+3]=Q>>>24}function Z(H,Q){return(H[Q]|H[Q+1]<<8|H[Q+2]<<16)+(H[Q+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(H,Q,oe){for(oe=oe||this.length;this.pos<oe;){var fe=this.readVarint(),Se=fe>>3,we=this.pos;this.type=7&fe,H(Se,Q,this),this.pos===we&&this.skip(fe)}return Q},readMessage:function(H,Q){return this.readFields(H,Q,this.readVarint()+this.pos)},readFixed32:function(){var H=V(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=Z(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=V(this.buf,this.pos)+V(this.buf,this.pos+4)*a;return this.pos+=8,H},readSFixed64:function(){var H=V(this.buf,this.pos)+Z(this.buf,this.pos+4)*a;return this.pos+=8,H},readFloat:function(){var H=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var Q,oe,fe=this.buf;return Q=127&(oe=fe[this.pos++]),oe<128?Q:(Q|=(127&(oe=fe[this.pos++]))<<7,oe<128?Q:(Q|=(127&(oe=fe[this.pos++]))<<14,oe<128?Q:(Q|=(127&(oe=fe[this.pos++]))<<21,oe<128?Q:function(Se,we,xe){var ke,Ce,Ne=xe.buf;if(ke=(112&(Ce=Ne[xe.pos++]))>>4,Ce<128||(ke|=(127&(Ce=Ne[xe.pos++]))<<3,Ce<128)||(ke|=(127&(Ce=Ne[xe.pos++]))<<10,Ce<128)||(ke|=(127&(Ce=Ne[xe.pos++]))<<17,Ce<128)||(ke|=(127&(Ce=Ne[xe.pos++]))<<24,Ce<128)||(ke|=(1&(Ce=Ne[xe.pos++]))<<31,Ce<128))return g(Se,ke,we);throw new Error("Expected varint not more than 10 bytes")}(Q|=(15&(oe=fe[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,Q=this.pos;return this.pos=H,H-Q>=12&&m?function(oe,fe,Se){return m.decode(oe.subarray(fe,Se))}(this.buf,Q,H):function(oe,fe,Se){for(var we="",xe=fe;xe<Se;){var ke,Ce,Ne,Ze=oe[xe],Ge=null,Je=Ze>239?4:Ze>223?3:Ze>191?2:1;if(xe+Je>Se)break;Je===1?Ze<128&&(Ge=Ze):Je===2?(192&(ke=oe[xe+1]))==128&&(Ge=(31&Ze)<<6|63&ke)<=127&&(Ge=null):Je===3?(Ce=oe[xe+2],(192&(ke=oe[xe+1]))==128&&(192&Ce)==128&&((Ge=(15&Ze)<<12|(63&ke)<<6|63&Ce)<=2047||Ge>=55296&&Ge<=57343)&&(Ge=null)):Je===4&&(Ce=oe[xe+2],Ne=oe[xe+3],(192&(ke=oe[xe+1]))==128&&(192&Ce)==128&&(192&Ne)==128&&((Ge=(15&Ze)<<18|(63&ke)<<12|(63&Ce)<<6|63&Ne)<=65535||Ge>=1114112)&&(Ge=null)),Ge===null?(Ge=65533,Je=1):Ge>65535&&(Ge-=65536,we+=String.fromCharCode(Ge>>>10&1023|55296),Ge=56320|1023&Ge),we+=String.fromCharCode(Ge),xe+=Je}return we}(this.buf,Q,H)},readBytes:function(){var H=this.readVarint()+this.pos,Q=this.buf.subarray(this.pos,H);return this.pos=H,Q},readPackedVarint:function(H,Q){if(this.type!==n.Bytes)return H.push(this.readVarint(Q));var oe=h(this);for(H=H||[];this.pos<oe;)H.push(this.readVarint(Q));return H},readPackedSVarint:function(H){if(this.type!==n.Bytes)return H.push(this.readSVarint());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==n.Bytes)return H.push(this.readBoolean());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==n.Bytes)return H.push(this.readFloat());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==n.Bytes)return H.push(this.readDouble());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==n.Bytes)return H.push(this.readFixed32());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==n.Bytes)return H.push(this.readSFixed32());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==n.Bytes)return H.push(this.readFixed64());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==n.Bytes)return H.push(this.readSFixed64());var Q=h(this);for(H=H||[];this.pos<Q;)H.push(this.readSFixed64());return H},skip:function(H){var Q=7&H;if(Q===n.Varint)for(;this.buf[this.pos++]>127;);else if(Q===n.Bytes)this.pos=this.readVarint()+this.pos;else if(Q===n.Fixed32)this.pos+=4;else{if(Q!==n.Fixed64)throw new Error("Unimplemented type: "+Q);this.pos+=8}},writeTag:function(H,Q){this.writeVarint(H<<3|Q)},realloc:function(H){for(var Q=this.length||16;Q<this.pos+H;)Q*=2;if(Q!==this.length){var oe=new Uint8Array(Q);oe.set(this.buf),this.buf=oe,this.length=Q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),W(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),W(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),W(this.buf,-1&H,this.pos),W(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),W(this.buf,-1&H,this.pos),W(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(Q,oe){var fe,Se;if(Q>=0?(fe=Q%4294967296|0,Se=Q/4294967296|0):(Se=~(-Q/4294967296),4294967295^(fe=~(-Q%4294967296))?fe=fe+1|0:(fe=0,Se=Se+1|0)),Q>=18446744073709552e3||Q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");oe.realloc(10),function(we,xe,ke){ke.buf[ke.pos++]=127&we|128,we>>>=7,ke.buf[ke.pos++]=127&we|128,we>>>=7,ke.buf[ke.pos++]=127&we|128,we>>>=7,ke.buf[ke.pos++]=127&we|128,ke.buf[ke.pos]=127&(we>>>=7)}(fe,0,oe),function(we,xe){var ke=(7&we)<<4;xe.buf[xe.pos++]|=ke|((we>>>=3)?128:0),we&&(xe.buf[xe.pos++]=127&we|((we>>>=7)?128:0),we&&(xe.buf[xe.pos++]=127&we|((we>>>=7)?128:0),we&&(xe.buf[xe.pos++]=127&we|((we>>>=7)?128:0),we&&(xe.buf[xe.pos++]=127&we|((we>>>=7)?128:0),we&&(xe.buf[xe.pos++]=127&we)))))}(Se,oe)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var Q=this.pos;this.pos=function(fe,Se,we){for(var xe,ke,Ce=0;Ce<Se.length;Ce++){if((xe=Se.charCodeAt(Ce))>55295&&xe<57344){if(!ke){xe>56319||Ce+1===Se.length?(fe[we++]=239,fe[we++]=191,fe[we++]=189):ke=xe;continue}if(xe<56320){fe[we++]=239,fe[we++]=191,fe[we++]=189,ke=xe;continue}xe=ke-55296<<10|xe-56320|65536,ke=null}else ke&&(fe[we++]=239,fe[we++]=191,fe[we++]=189,ke=null);xe<128?fe[we++]=xe:(xe<2048?fe[we++]=xe>>6|192:(xe<65536?fe[we++]=xe>>12|224:(fe[we++]=xe>>18|240,fe[we++]=xe>>12&63|128),fe[we++]=xe>>6&63|128),fe[we++]=63&xe|128)}return we}(this.buf,H,this.pos);var oe=this.pos-Q;oe>=128&&b(Q,oe,this),this.pos=Q-1,this.writeVarint(oe),this.pos+=oe},writeFloat:function(H){this.realloc(4),l.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),l.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var Q=H.length;this.writeVarint(Q),this.realloc(Q);for(var oe=0;oe<Q;oe++)this.buf[this.pos++]=H[oe]},writeRawMessage:function(H,Q){this.pos++;var oe=this.pos;H(Q,this);var fe=this.pos-oe;fe>=128&&b(oe,fe,this),this.pos=oe-1,this.writeVarint(fe),this.pos+=fe},writeMessage:function(H,Q,oe){this.writeTag(H,n.Bytes),this.writeRawMessage(Q,oe)},writePackedVarint:function(H,Q){Q.length&&this.writeMessage(H,T,Q)},writePackedSVarint:function(H,Q){Q.length&&this.writeMessage(H,P,Q)},writePackedBoolean:function(H,Q){Q.length&&this.writeMessage(H,A,Q)},writePackedFloat:function(H,Q){Q.length&&this.writeMessage(H,v,Q)},writePackedDouble:function(H,Q){Q.length&&this.writeMessage(H,E,Q)},writePackedFixed32:function(H,Q){Q.length&&this.writeMessage(H,C,Q)},writePackedSFixed32:function(H,Q){Q.length&&this.writeMessage(H,M,Q)},writePackedFixed64:function(H,Q){Q.length&&this.writeMessage(H,D,Q)},writePackedSFixed64:function(H,Q){Q.length&&this.writeMessage(H,k,Q)},writeBytesField:function(H,Q){this.writeTag(H,n.Bytes),this.writeBytes(Q)},writeFixed32Field:function(H,Q){this.writeTag(H,n.Fixed32),this.writeFixed32(Q)},writeSFixed32Field:function(H,Q){this.writeTag(H,n.Fixed32),this.writeSFixed32(Q)},writeFixed64Field:function(H,Q){this.writeTag(H,n.Fixed64),this.writeFixed64(Q)},writeSFixed64Field:function(H,Q){this.writeTag(H,n.Fixed64),this.writeSFixed64(Q)},writeVarintField:function(H,Q){this.writeTag(H,n.Varint),this.writeVarint(Q)},writeSVarintField:function(H,Q){this.writeTag(H,n.Varint),this.writeSVarint(Q)},writeStringField:function(H,Q){this.writeTag(H,n.Bytes),this.writeString(Q)},writeFloatField:function(H,Q){this.writeTag(H,n.Fixed32),this.writeFloat(Q)},writeDoubleField:function(H,Q){this.writeTag(H,n.Fixed64),this.writeDouble(Q)},writeBooleanField:function(H,Q){this.writeVarintField(H,!!Q)}},jb}var $0=O(EE());const Hb=3;function nB(l,n,a){n.glyphs=[],l===1&&a.readMessage(rB,n)}function rB(l,n,a){if(l===3){const{id:u,bitmap:m,width:h,height:g,left:b,top:T,advance:P}=a.readMessage(iB,{});n.glyphs.push({id:u,bitmap:new ru({width:h+2*Hb,height:g+2*Hb},m),metrics:{width:h,height:g,left:b,top:T,advance:P}})}else l===4?n.ascender=a.readSVarint():l===5&&(n.descender=a.readSVarint())}function iB(l,n,a){l===1?n.id=a.readVarint():l===2?n.bitmap=a.readBytes():l===3?n.width=a.readVarint():l===4?n.height=a.readVarint():l===5?n.left=a.readSVarint():l===6?n.top=a.readSVarint():l===7&&(n.advance=a.readVarint())}const ME=Hb,Ia={horizontal:1,vertical:2,horizontalOnly:3};class Ym{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,a){const u=new Ym;return u.scale=n||1,u.fontStack=a,u}static forImage(n){const a=new Ym;return a.image=n,a}}class xf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const u=new xf;for(let m=0;m<n.sections.length;m++){const h=n.sections[m];h.image?u.addImageSection(h):u.addTextSection(h,a)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(a,u){let m="";for(let h=0;h<a.length;h++){const g=a.charCodeAt(h+1)||null,b=a.charCodeAt(h-1)||null;m+=!u&&(g&&cm(g)&&!Zm[a[h+1]]||b&&cm(b)&&!Zm[a[h-1]])||!Zm[a[h]]?a[h]:Zm[a[h]]}return m}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&F0[this.text.charCodeAt(u)];u++)n++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&F0[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const u=new xf;return u.text=this.text.substring(n,a),u.sectionIndex=this.sectionIndex.slice(n,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push(Ym.forText(n.scale,n.fontStack||a));const u=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(u)}addImageSection(n){const a=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!a)return void kn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Ym.forImage(a)),this.sectionIndex.push(this.sections.length-1)):kn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gb(l,n,a,u,m,h,g,b,T,P,v,E,A,C,M){const D=xf.fromFeature(l,m);E===Ia.vertical&&D.verticalizePunctuation(A);let k=[];const V=function(oe,fe,Se,we,xe,ke){if(!oe)return[];const Ce=[],Ne=function(rt,lt,nt,xt,Dt,vt){let Jt=0;for(let Zt=0;Zt<rt.length();Zt++){const kt=rt.getSection(Zt);Jt+=IE(rt.getCodePoint(Zt),kt,xt,Dt,lt,vt)}return Jt/Math.max(1,Math.ceil(Jt/nt))}(oe,fe,Se,we,xe,ke),Ze=oe.text.indexOf("")>=0;let Ge=0;for(let rt=0;rt<oe.length();rt++){const lt=oe.getSection(rt),nt=oe.getCodePoint(rt);if(F0[nt]||(Ge+=IE(nt,lt,we,xe,fe,ke)),rt<oe.length()-1){const xt=!((Je=nt)<11904||!(yn["Bopomofo Extended"](Je)||yn.Bopomofo(Je)||yn["CJK Compatibility Forms"](Je)||yn["CJK Compatibility Ideographs"](Je)||yn["CJK Compatibility"](Je)||yn["CJK Radicals Supplement"](Je)||yn["CJK Strokes"](Je)||yn["CJK Symbols and Punctuation"](Je)||yn["CJK Unified Ideographs Extension A"](Je)||yn["CJK Unified Ideographs"](Je)||yn["Enclosed CJK Letters and Months"](Je)||yn["Halfwidth and Fullwidth Forms"](Je)||yn.Hiragana(Je)||yn["Ideographic Description Characters"](Je)||yn["Kangxi Radicals"](Je)||yn["Katakana Phonetic Extensions"](Je)||yn.Katakana(Je)||yn["Vertical Forms"](Je)||yn["Yi Radicals"](Je)||yn["Yi Syllables"](Je)));(oB[nt]||xt||lt.image)&&Ce.push(PE(rt+1,Ge,Ne,Ce,aB(nt,oe.getCodePoint(rt+1),xt&&Ze),!1))}}var Je;return OE(PE(oe.length(),Ge,Ne,Ce,0,!0))}(D,P,h,n,u,C),{processBidirectionalText:W,processStyledBidirectionalText:Z}=Zo;if(W&&D.sections.length===1){const oe=W(D.toString(),V);for(const fe of oe){const Se=new xf;Se.text=fe,Se.sections=D.sections;for(let we=0;we<fe.length;we++)Se.sectionIndex.push(0);k.push(Se)}}else if(Z){const oe=Z(D.text,D.sectionIndex,V);for(const fe of oe){const Se=new xf;Se.text=fe[0],Se.sectionIndex=fe[1],Se.sections=D.sections,k.push(Se)}}else k=function(oe,fe){const Se=[],we=oe.text;let xe=0;for(const ke of fe)Se.push(oe.substring(xe,ke)),xe=ke;return xe<we.length&&Se.push(oe.substring(xe,we.length)),Se}(D,V);const H=[],Q={positionedLines:H,text:D.toString(),top:v[1],bottom:v[1],left:v[0],right:v[0],writingMode:E,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(oe,fe,Se,we,xe,ke,Ce,Ne,Ze,Ge,Je,rt){let lt=0,nt=0,xt=0;const Dt=Ne==="right"?1:Ne==="left"?0:.5;let vt=!1;for(const en of xe){const sn=en.getSections();for(const zn of sn){if(zn.image)continue;const Vn=fe[zn.fontStack];if(Vn&&(vt=Vn.ascender!==void 0&&Vn.descender!==void 0,!vt))break}if(!vt)break}let Jt=0;for(const en of xe){en.trim();const sn=en.getMaxScale(),zn=(sn-1)*go,Vn={positionedGlyphs:[],lineOffset:0};oe.positionedLines[Jt]=Vn;const jn=Vn.positionedGlyphs;let Un=0;if(!en.length()){nt+=ke,++Jt;continue}let Zn=0,Yn=0;for(let Mr=0;Mr<en.length();Mr++){const Fn=en.getSection(Mr),Sr=en.getSectionIndex(Mr),Er=en.getCodePoint(Mr);let Hr=Fn.scale,_i=null,Ri=null,yi=null,ii=go,Si=0;const $i=!(Ze===Ia.horizontal||!Je&&!Xh(Er)||Je&&(F0[Er]||(Zt=Er,yn.Arabic(Zt)||yn["Arabic Supplement"](Zt)||yn["Arabic Extended-A"](Zt)||yn["Arabic Presentation Forms-A"](Zt)||yn["Arabic Presentation Forms-B"](Zt))));if(Fn.image){const _o=we[Fn.image.serialize()];if(!_o)continue;yi=Fn.image.id,oe.iconsInText=oe.iconsInText||!0,Ri=_o.paddedRect;const Vr=_o.displaySize;Hr=Hr*go/rt,_i={width:Vr[0],height:Vr[1],left:0,top:-ME,advance:$i?Vr[1]:Vr[0],localGlyph:!1},Si=vt?-_i.height*Hr:sn*go-17-Vr[1]*Hr,ii=_i.advance;const Qo=($i?Vr[0]:Vr[1])*Hr-go*sn;Qo>0&&Qo>Un&&(Un=Qo)}else{const _o=Se[Fn.fontStack];if(!_o)continue;_o[Er]&&(Ri=_o[Er]);const Vr=fe[Fn.fontStack];if(!Vr)continue;const Qo=Vr.glyphs[Er];if(!Qo)continue;if(_i=Qo.metrics,ii=Er!==8203?go:0,vt){const Fs=Vr.ascender!==void 0?Math.abs(Vr.ascender):0,os=Vr.descender!==void 0?Math.abs(Vr.descender):0,as=(Fs+os)*Hr;Zn<as&&(Zn=as,Yn=(Fs-os)/2*Hr),Si=-Fs*Hr}else Si=(sn-Hr)*go-17}$i?(oe.verticalizable=!0,jn.push({glyph:Er,imageName:yi,x:lt,y:nt+Si,vertical:$i,scale:Hr,localGlyph:_i.localGlyph,fontStack:Fn.fontStack,sectionIndex:Sr,metrics:_i,rect:Ri}),lt+=ii*Hr+Ge):(jn.push({glyph:Er,imageName:yi,x:lt,y:nt+Si,vertical:$i,scale:Hr,localGlyph:_i.localGlyph,fontStack:Fn.fontStack,sectionIndex:Sr,metrics:_i,rect:Ri}),lt+=_i.advance*Hr+Ge)}jn.length!==0&&(xt=Math.max(lt-Ge,xt),vt?DE(jn,Dt,Un,Yn,ke*sn/2):DE(jn,Dt,Un,0,ke/2)),lt=0;const Lr=ke*sn+Un;Vn.lineOffset=Math.max(Un,zn),nt+=Lr,++Jt}var Zt;const kt=nt,{horizontalAlign:Rt,verticalAlign:mn}=Wb(Ce);(function(en,sn,zn,Vn,jn,Un){const Zn=(sn-zn)*jn,Yn=-Un*Vn;for(const Lr of en)for(const Mr of Lr.positionedGlyphs)Mr.x+=Zn,Mr.y+=Yn})(oe.positionedLines,Dt,Rt,mn,xt,kt),oe.top+=-mn*kt,oe.bottom=oe.top+kt,oe.left+=-Rt*xt,oe.right=oe.left+xt,oe.hasBaseline=vt}(Q,n,a,u,k,g,b,T,E,P,A,M),!function(oe){for(const fe of oe)if(fe.positionedGlyphs.length!==0)return!1;return!0}(H)&&Q}const F0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oB={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function IE(l,n,a,u,m,h){if(n.image){const g=u[n.image.serialize()];return g?g.displaySize[0]*n.scale*go/h+m:0}{const g=a[n.fontStack],b=g&&g.glyphs[l];return b?b.metrics.advance*n.scale+m:0}}function AE(l,n,a,u){const m=Math.pow(l-n,2);return u?l<n?m/2:2*m:m+Math.abs(a)*a}function aB(l,n,a){let u=0;return l===10&&(u-=1e4),a&&(u+=150),l!==40&&l!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function PE(l,n,a,u,m,h){let g=null,b=AE(n,a,m,h);for(const T of u){const P=AE(n-T.x,a,m,h)+T.badness;P<=b&&(g=T,b=P)}return{index:l,x:n,priorBreak:g,badness:b}}function OE(l){return l?OE(l.priorBreak).concat(l.index):[]}function Wb(l){let n=.5,a=.5;switch(l){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function DE(l,n,a,u,m){if(!(n||a||u||m))return;const h=l.length-1,g=l[h],b=(g.x+g.metrics.advance*g.scale)*n;for(let T=0;T<=h;T++)l[T].x-=b,l[T].y+=a+u+m}function sB(l,n,a,u){const{horizontalAlign:m,verticalAlign:h}=Wb(u),g=a[0]-l.displaySize[0]*m,b=a[1]-l.displaySize[1]*h;return{imagePrimary:l,imageSecondary:n,top:b,bottom:b+l.displaySize[1],left:g,right:g+l.displaySize[0]}}function RE(l,n,a,u,m,h){const g=l.imagePrimary;let b;if(g.content){const k=g.content,V=g.pixelRatio||1;b=[k[0]/V,k[1]/V,g.displaySize[0]-k[2]/V,g.displaySize[1]-k[3]/V]}const T=n.left*h,P=n.right*h;let v,E,A,C;a==="width"||a==="both"?(C=m[0]+T-u[3],E=m[0]+P+u[1]):(C=m[0]+(T+P-g.displaySize[0])/2,E=C+g.displaySize[0]);const M=n.top*h,D=n.bottom*h;return a==="height"||a==="both"?(v=m[1]+M-u[0],A=m[1]+D+u[2]):(v=m[1]+(M+D-g.displaySize[1])/2,A=v+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:v,right:E,bottom:A,left:C,collisionPadding:b}}class sc extends je{constructor(n,a,u,m,h){super(n,a),this.angle=m,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new sc(this.x,this.y,this.z,this.angle,this.segment)}}function zE(l,n,a,u,m){if(n.segment===void 0)return!0;let h=n,g=n.segment+1,b=0;for(;b>-a/2;){if(g--,g<0)return!1;b-=l[g].dist(h),h=l[g]}b+=l[g].dist(l[g+1]),g++;const T=[];let P=0;for(;b<a/2;){const v=l[g],E=l[g+1];if(!E)return!1;let A=l[g-1].angleTo(v)-v.angleTo(E);for(A=Math.abs((A+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:b,angleDelta:A}),P+=A;b-T[0].distance>u;)P-=T.shift().angleDelta;if(P>m)return!1;g++,b+=v.dist(E)}return!0}function LE(l){let n=0;for(let a=0;a<l.length-1;a++)n+=l[a].dist(l[a+1]);return n}function $E(l,n,a){return l?.6*n*a:0}function FE(l,n){return Math.max(l?l.right-l.left:0,n?n.right-n.left:0)}function lB(l,n,a,u,m,h){const g=$E(a,m,h),b=FE(a,u)*h;let T=0;const P=LE(l)/2;for(let v=0;v<l.length-1;v++){const E=l[v],A=l[v+1],C=E.dist(A);if(T+C>P){const M=(P-T)/C,D=Pn(E.x,A.x,M),k=Pn(E.y,A.y,M),V=new sc(D,k,0,A.angleTo(E),v);return!g||zE(l,V,b,g,n)?V:void 0}T+=C}}function cB(l,n,a,u,m,h,g,b,T){const P=$E(u,h,g),v=FE(u,m),E=v*g,A=l[0].x===0||l[0].x===T||l[0].y===0||l[0].y===T;return n-E<n/4&&(n=E+n/4),BE(l,A?n/2*b%n:(v/2+2*h)*g*b%n,n,P,a,E,A,!1,T)}function BE(l,n,a,u,m,h,g,b,T){const P=h/2,v=LE(l);let E=0,A=n-a,C=[];for(let M=0;M<l.length-1;M++){const D=l[M],k=l[M+1],V=D.dist(k),W=k.angleTo(D);for(;A+a<E+V;){A+=a;const Z=(A-E)/V,H=Pn(D.x,k.x,Z),Q=Pn(D.y,k.y,Z);if(H>=0&&H<T&&Q>=0&&Q<T&&A-P>=0&&A+P<=v){const oe=new sc(H,Q,0,W,M);u&&!zE(l,oe,h,u,m)||C.push(oe)}}E+=V}return b||C.length||g||(C=BE(l,E/2,a,u,m,h,g,!0,T)),C}function kE(l,n,a,u,m){const h=[];for(let g=0;g<l.length;g++){const b=l[g];let T;for(let P=0;P<b.length-1;P++){let v=b[P],E=b[P+1];v.x<n&&E.x<n||(v.x<n?v=new je(n,v.y+(n-v.x)/(E.x-v.x)*(E.y-v.y))._round():E.x<n&&(E=new je(n,v.y+(n-v.x)/(E.x-v.x)*(E.y-v.y))._round()),v.y<a&&E.y<a||(v.y<a?v=new je(v.x+(a-v.y)/(E.y-v.y)*(E.x-v.x),a)._round():E.y<a&&(E=new je(v.x+(a-v.y)/(E.y-v.y)*(E.x-v.x),a)._round()),v.x>=u&&E.x>=u||(v.x>=u?v=new je(u,v.y+(u-v.x)/(E.x-v.x)*(E.y-v.y))._round():E.x>=u&&(E=new je(u,v.y+(u-v.x)/(E.x-v.x)*(E.y-v.y))._round()),v.y>=m&&E.y>=m||(v.y>=m?v=new je(v.x+(m-v.y)/(E.y-v.y)*(E.x-v.x),m)._round():E.y>=m&&(E=new je(v.x+(m-v.y)/(E.y-v.y)*(E.x-v.x),m)._round()),T&&v.equals(T[T.length-1])||(T=[v],h.push(T)),T.push(E)))))}}return h}function NE(l){let n=0,a=0;for(const g of l)n+=g.w*g.h,a=Math.max(a,g.w);l.sort((g,b)=>b.h-g.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let m=0,h=0;for(const g of l)for(let b=u.length-1;b>=0;b--){const T=u[b];if(!(g.w>T.w||g.h>T.h)){if(g.x=T.x,g.y=T.y,h=Math.max(h,g.y+g.h),m=Math.max(m,g.x+g.w),g.w===T.w&&g.h===T.h){const P=u.pop();b<u.length&&(u[b]=P)}else g.h===T.h?(T.x+=g.w,T.w-=g.w):g.w===T.w?(T.y+=g.h,T.h-=g.h):(u.push({x:T.x+g.w,y:T.y,w:T.w-g.w,h:g.h}),T.y+=g.h,T.h-=g.h);break}}return{w:m,h,fill:n/(m*h)||0}}fn(sc,"Anchor");const Xm=1;class Km{static getImagePositionScale(n,a,u){return a&&n&&n.options&&n.options.transform?{x:n.options.transform.a,y:n.options.transform.d}:{x:u,y:u}}constructor(n,{pixelRatio:a,version:u,stretchX:m,stretchY:h,content:g,sdf:b,usvg:T},P,v){this.paddedRect=n,this.pixelRatio=a,this.stretchX=m,this.stretchY=h,this.content=g,this.version=u,this.padding=P,this.sdf=b,this.scale=Km.getImagePositionScale(v,T,a)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class VE{constructor(n,a,u){const m={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(n,m,Xm,g),this.addImages(a,h,2,g);const{w:b,h:T}=NE(g),P=new ao({width:b||1,height:T||1});for(const v in n){const E=n[v],A=m[v].paddedRect;ao.copy(E.data,P,{x:0,y:0},{x:A.x+Xm,y:A.y+Xm},E.data,u,E.sdf)}for(const v in a){const E=a[v],A=h[v].paddedRect;let C=h[v].padding;const M=A.x+C,D=A.y+C,k=E.data.width,V=E.data.height;C=C>1?C-1:C,ao.copy(E.data,P,{x:0,y:0},{x:M,y:D},E.data,u),ao.copy(E.data,P,{x:0,y:V-C},{x:M,y:D-C},{width:k,height:C},u),ao.copy(E.data,P,{x:0,y:0},{x:M,y:D+V},{width:k,height:C},u),ao.copy(E.data,P,{x:k-C,y:0},{x:M-C,y:D},{width:C,height:V},u),ao.copy(E.data,P,{x:0,y:0},{x:M+k,y:D},{width:C,height:V},u),ao.copy(E.data,P,{x:k-C,y:V-C},{x:M-C,y:D-C},{width:C,height:C},u),ao.copy(E.data,P,{x:0,y:V-C},{x:M+k,y:D-C},{width:C,height:C},u),ao.copy(E.data,P,{x:0,y:0},{x:M+k,y:D+V},{width:C,height:C},u),ao.copy(E.data,P,{x:k-C,y:0},{x:M-C,y:D+V},{width:C,height:C},u)}this.lut=u,this.image=P,this.iconPositions=m,this.patternPositions=h}addImages(n,a,u,m){for(const h in n){const g=n[h],b={x:0,y:0,w:g.data.width+2*u,h:g.data.height+2*u};m.push(b);const T=Ya.deserializeFromString(h);a[h]=new Km(b,g,u,T),g.hasRenderCallback&&this.haveRenderCallbacks.push(T.id)}}patchUpdatedImages(n,a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>n.hasImage(m,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const m in n.getUpdatedImages(u)){for(const h of Object.keys(this.iconPositions))Ya.deserializeId(h)===m&&this.patchUpdatedImage(this.iconPositions[h],n.getImage(m,u),a);for(const h of Object.keys(this.patternPositions))Ya.deserializeId(h)===m&&this.patchUpdatedImage(this.patternPositions[h],n.getImage(m,u),a)}}patchUpdatedImage(n,a,u){if(!n||!a||n.version===a.version)return;n.version=a.version;const[m,h]=n.tl,g=n.sdf;if(this.lut||g){const b={width:a.data.width,height:a.data.height},T=new ao(b);ao.copy(a.data,T,{x:0,y:0},{x:0,y:0},b,this.lut,g),u.update(T,{position:{x:m,y:h}})}else u.update(a.data,{position:{x:m,y:h}})}}fn(Km,"ImagePosition"),fn(VE,"ImageAtlas");const Jm=1e20;function jE(l,n,a,u,m,h,g,b,T){for(let P=n;P<n+u;P++)UE(l,a*h+P,h,m,g,b,T);for(let P=a;P<a+m;P++)UE(l,P*h+n,1,u,g,b,T)}function UE(l,n,a,u,m,h,g){h[0]=0,g[0]=-Jm,g[1]=Jm,m[0]=l[n];for(let b=1,T=0,P=0;b<u;b++){m[b]=l[n+b*a];const v=b*b;do{const E=h[T];P=(m[b]-m[E]+v-E*E)/(b-E)/2}while(P<=g[T]&&--T>-1);T++,h[T]=b,g[T]=P,g[T+1]=Jm}for(let b=0,T=0;b<u;b++){for(;g[T+1]<b;)T++;const P=h[T],v=b-P;l[n+b*a]=m[P]+v*v}}const Rs=2,qb={none:0,ideographs:1,all:2};class bf{constructor(n,a,u){this.requestManager=n,this.localGlyphMode=a,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,a){this.urls[a]=n}getGlyphs(n,a,u){const m=[],h=this.urls[a]||ni.GLYPHS_URL;for(const g in n)for(const b of n[g])m.push({stack:g,id:b});Pr(m,({stack:g,id:b},T)=>{let P=this.entries[g];P||(P=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=P.glyphs[b];if(v!==void 0)return void T(null,{stack:g,id:b,glyph:v});if(v=this._tinySDF(P,g,b),v)return P.glyphs[b]=v,void T(null,{stack:g,id:b,glyph:v});const E=Math.floor(b/256);if(256*E>65535)return kn("glyphs > 65535 not supported"),void T(null,{stack:g,id:b,glyph:v});if(P.ranges[E])return void T(null,{stack:g,id:b,glyph:v});let A=P.requests[E];A||(A=P.requests[E]=[],bf.loadGlyphRange(g,E,h,this.requestManager,(C,M)=>{if(M){P.ascender=M.ascender,P.descender=M.descender;for(const D in M.glyphs)this._doesCharSupportLocalGlyph(+D)||(P.glyphs[+D]=M.glyphs[+D]);P.ranges[E]=!0}for(const D of A)D(C,M);delete P.requests[E]})),A.push((C,M)=>{C?T(C):M&&T(null,{stack:g,id:b,glyph:M.glyphs[b]||null})})},(g,b)=>{if(g)u(g);else if(b){const T={};for(const{stack:P,id:v,glyph:E}of b)T[P]===void 0&&(T[P]={}),T[P].glyphs===void 0&&(T[P].glyphs={}),T[P].glyphs[v]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},T[P].ascender=this.entries[P].ascender,T[P].descender=this.entries[P].descender;u(null,T)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==qb.none&&(this.localGlyphMode===qb.all?!!this.localFontFamily:!!this.localFontFamily&&(yn["CJK Unified Ideographs"](n)||yn["Hangul Syllables"](n)||yn.Hiragana(n)||yn.Katakana(n)||yn["CJK Symbols and Punctuation"](n)||yn["CJK Unified Ideographs Extension A"](n)||yn["CJK Unified Ideographs Extension B"](n)||yn.Osage(n)))}_tinySDF(n,a,u){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let D="400";/bold/i.test(a)?D="900":/medium/i.test(a)?D="500":/light/i.test(a)&&(D="200"),h=n.tinySDF=new bf.TinySDF({fontFamily:m,fontWeight:D,fontSize:24*Rs,buffer:3*Rs,radius:8*Rs}),h.fontWeight=D}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const g=String.fromCodePoint(u),{data:b,width:T,height:P,glyphWidth:v,glyphHeight:E,glyphLeft:A,glyphTop:C,glyphAdvance:M}=h.draw(g);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new ru({width:T,height:P},b),metrics:{width:v/Rs,height:E/Rs,left:A/Rs,top:C/Rs-27,advance:M/Rs,localGlyph:!0}}}}bf.loadGlyphRange=function(l,n,a,u,m){const h=256*n,g=h+255,b=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",l).replace("{range}",`${h}-${g}`),fr.Glyphs);ki(b,(T,P)=>{if(T)m(T);else if(P){const v={},E=function(A){return new $0(A).readFields(nB,{})}(P);for(const A of E.glyphs)v[A.id]=A;m(null,{glyphs:v,ascender:E.ascender,descender:E.descender})}})},bf.TinySDF=class{constructor({fontSize:l=24,buffer:n=3,radius:a=8,cutoff:u=.25,fontFamily:m="sans-serif",fontWeight:h="normal",fontStyle:g="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=a;const b=this.size=l+4*n,T=this._createCanvas(b),P=this.ctx=T.getContext("2d",{willReadFrequently:!0});P.font=`${g} ${h} ${l}px ${m}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(l){const n=document.createElement("canvas");return n.width=n.height=l,n}draw(l){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:m,actualBoundingBoxRight:h}=this.ctx.measureText(l),g=Math.ceil(a),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-m))),T=Math.min(this.size-this.buffer,g+Math.ceil(u)),P=b+2*this.buffer,v=T+2*this.buffer,E=Math.max(P*v,0),A=new Uint8ClampedArray(E),C={data:A,width:P,height:v,glyphWidth:b,glyphHeight:T,glyphTop:g,glyphLeft:0,glyphAdvance:n};if(b===0||T===0)return C;const{ctx:M,buffer:D,gridInner:k,gridOuter:V}=this;M.clearRect(D,D,b,T),M.fillText(l,D,D+g);const W=M.getImageData(D,D,b,T);V.fill(Jm,0,E),k.fill(0,0,E);for(let Z=0;Z<T;Z++)for(let H=0;H<b;H++){const Q=W.data[4*(Z*b+H)+3]/255;if(Q===0)continue;const oe=(Z+D)*P+H+D;if(Q===1)V[oe]=0,k[oe]=Jm;else{const fe=.5-Q;V[oe]=fe>0?fe*fe:0,k[oe]=fe<0?fe*fe:0}}jE(V,0,0,P,v,P,this.f,this.v,this.z),jE(k,D,D,b,T,P,this.f,this.v,this.z);for(let Z=0;Z<E;Z++){const H=Math.sqrt(V[Z])-Math.sqrt(k[Z]);A[Z]=Math.round(255-255*(H/this.radius+this.cutoff))}return C}};const ou=Xm;function HE(l,n){return l+n[1]-n[0]}function GE(l,n,a,u,m=1){const h=[],g=l.imagePrimary,b=g.pixelRatio,T=g.paddedRect.w-2*ou,P=g.paddedRect.h-2*ou,v=(l.right-l.left)*m,E=(l.bottom-l.top)*m,A=g.stretchX||[[0,T]],C=g.stretchY||[[0,P]],M=A.reduce(HE,0),D=C.reduce(HE,0),k=T-M,V=P-D;let W=0,Z=M,H=0,Q=D,oe=0,fe=k,Se=0,we=V;if(g.content&&u){const ke=g.content;W=B0(A,0,ke[0]),H=B0(C,0,ke[1]),Z=B0(A,ke[0],ke[2]),Q=B0(C,ke[1],ke[3]),oe=ke[0]-W,Se=ke[1]-H,fe=ke[2]-ke[0]-Z,we=ke[3]-ke[1]-Q}const xe=(ke,Ce,Ne,Ze)=>{const Ge=k0(ke.stretch-W,Z,v,l.left*m),Je=N0(ke.fixed-oe,fe,ke.stretch,M),rt=k0(Ce.stretch-H,Q,E,l.top*m),lt=N0(Ce.fixed-Se,we,Ce.stretch,D),nt=k0(Ne.stretch-W,Z,v,l.left*m),xt=N0(Ne.fixed-oe,fe,Ne.stretch,M),Dt=k0(Ze.stretch-H,Q,E,l.top*m),vt=N0(Ze.fixed-Se,we,Ze.stretch,D),Jt=new je(Ge,rt),Zt=new je(nt,rt),kt=new je(nt,Dt),Rt=new je(Ge,Dt),mn=new je(Je/b,lt/b),en=new je(xt/b,vt/b),sn=n*Math.PI/180;if(sn){const Yn=Math.sin(sn),Lr=Math.cos(sn),Mr=[Lr,-Yn,Yn,Lr];Jt._matMult(Mr),Zt._matMult(Mr),Rt._matMult(Mr),kt._matMult(Mr)}const zn=ke.stretch+ke.fixed,Vn=Ne.stretch+Ne.fixed,jn=Ce.stretch+Ce.fixed,Un=Ze.stretch+Ze.fixed,Zn=l.imageSecondary;return{tl:Jt,tr:Zt,bl:Rt,br:kt,texPrimary:{x:g.paddedRect.x+ou+zn,y:g.paddedRect.y+ou+jn,w:Vn-zn,h:Un-jn},texSecondary:Zn?{x:Zn.paddedRect.x+ou+zn,y:Zn.paddedRect.y+ou+jn,w:Vn-zn,h:Un-jn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mn,pixelOffsetBR:en,minFontScaleX:fe/b/v,minFontScaleY:we/b/E,isSDF:a}};if(u&&(g.stretchX||g.stretchY)){const ke=WE(A,k,M),Ce=WE(C,V,D);for(let Ne=0;Ne<ke.length-1;Ne++){const Ze=ke[Ne],Ge=ke[Ne+1];for(let Je=0;Je<Ce.length-1;Je++)h.push(xe(Ze,Ce[Je],Ge,Ce[Je+1]))}}else h.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return h}function B0(l,n,a){let u=0;for(const m of l)u+=Math.max(n,Math.min(a,m[1]))-Math.max(n,Math.min(a,m[0]));return u}function WE(l,n,a){const u=[{fixed:-ou,stretch:0}];for(const[m,h]of l){const g=u[u.length-1];u.push({fixed:m-g.stretch,stretch:g.stretch}),u.push({fixed:m-g.stretch,stretch:g.stretch+(h-m)})}return u.push({fixed:n+ou,stretch:a}),u}function k0(l,n,a,u){return l/n*a+u}function N0(l,n,a,u){return l-n*a/u}function uB(l,n,a,u){const m=n+l.positionedLines[u].lineOffset;return u===0?a+m/2:a+(m+(n+l.positionedLines[u-1].lineOffset))/2}function dB(l,n=1,a=!1){let u=1/0,m=1/0,h=-1/0,g=-1/0;const b=l[0];for(let C=0;C<b.length;C++){const M=b[C];(!C||M.x<u)&&(u=M.x),(!C||M.y<m)&&(m=M.y),(!C||M.x>h)&&(h=M.x),(!C||M.y>g)&&(g=M.y)}const T=Math.min(h-u,g-m);let P=T/2;const v=new oo([],hB);if(T===0)return new je(u,m);for(let C=u;C<h;C+=T)for(let M=m;M<g;M+=T)v.push(new wf(C+P,M+P,P,l));let E=function(C){let M=0,D=0,k=0;const V=C[0];for(let W=0,Z=V.length,H=Z-1;W<Z;H=W++){const Q=V[W],oe=V[H],fe=Q.x*oe.y-oe.x*Q.y;D+=(Q.x+oe.x)*fe,k+=(Q.y+oe.y)*fe,M+=3*fe}return new wf(D/M,k/M,0,C)}(l),A=v.length;for(;v.length;){const C=v.pop();(C.d>E.d||!E.d)&&(E=C,a&&console.log("found best %d after %d probes",Math.round(1e4*C.d)/1e4,A)),C.max-E.d<=n||(P=C.h/2,v.push(new wf(C.p.x-P,C.p.y-P,P,l)),v.push(new wf(C.p.x+P,C.p.y-P,P,l)),v.push(new wf(C.p.x-P,C.p.y+P,P,l)),v.push(new wf(C.p.x+P,C.p.y+P,P,l)),A+=4)}return a&&(console.log(`num probes: ${A}`),console.log(`best distance: ${E.d}`)),E.p}function hB(l,n){return n.max-l.max}class wf{constructor(n,a,u,m){this.p=new je(n,a),this.h=u,this.d=function(h,g){let b=!1,T=1/0;for(let P=0;P<g.length;P++){const v=g[P];for(let E=0,A=v.length,C=A-1;E<A;C=E++){const M=v[E],D=v[C];M.y>h.y!=D.y>h.y&&h.x<(D.x-M.x)*(h.y-M.y)/(D.y-M.y)+M.x&&(b=!b),T=Math.min(T,Pe(h,M,D))}}return(b?1:-1)*Math.sqrt(T)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const Zb=Number.POSITIVE_INFINITY,fB=Math.sqrt(2);function qE(l,[n,a]){let u=0,m=0;if(a===Zb){n<0&&(n=0);const h=n/fB;switch(l){case"top-right":case"top-left":m=h-7;break;case"bottom-right":case"bottom-left":m=7-h;break;case"bottom":m=7-n;break;case"top":m=n-7}switch(l){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),a=Math.abs(a),l){case"top-right":case"top-left":case"top":m=a-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-a}switch(l){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,m]}function Yb(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pB(l,n,a,u,m,h,g,b,T,P,v,E,A,C,M){let D=h.textMaxSize.evaluate(n,{},E);D===void 0?D=g*h.textScaleFactor:D*=h.textScaleFactor;const k=l.layers[0].layout,V=k.get("icon-offset").evaluate(n,{},E),W=YE(a.horizontal)||a.vertical,Z=A.name==="globe",H=go,Q=g*h.textScaleFactor/H,oe=l.tilePixelRatio*D/H,fe=(Ge=l.overscaling,l.zoom>18&&Ge>2&&(Ge>>=1),Math.max(Yt/(512*Ge),1)*k.get("symbol-spacing")),Se=k.get("text-padding")*l.tilePixelRatio,we=k.get("icon-padding")*l.tilePixelRatio,xe=zt(k.get("text-max-angle")),ke=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",Ce=k.get("icon-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",Ne=k.get("symbol-placement"),Ze=fe/2;var Ge;const Je=k.get("icon-text-fit").evaluate(n,{},E),rt=k.get("icon-text-fit-padding").evaluate(n,{},E),lt=Je!=="none";let nt;l.hasAnyIconTextFit===!1&&lt&&(l.hasAnyIconTextFit=!0),u&&lt&&(l.allowVerticalPlacement&&a.vertical&&(nt=RE(u,a.vertical,Je,rt,V,Q)),W&&(u=RE(u,W,Je,rt,V,Q)));const xt=(Dt,vt,Jt)=>{if(vt.x<0||vt.x>=Yt||vt.y<0||vt.y>=Yt)return;let Zt=null;if(Z){const{x:kt,y:Rt,z:mn}=A.projectTilePoint(vt.x,vt.y,Jt);Zt={anchor:new sc(kt,Rt,mn,0,void 0),up:A.upVector(Jt,vt.x,vt.y)}}(function(kt,Rt,mn,en,sn,zn,Vn,jn,Un,Zn,Yn,Lr,Mr,Fn,Sr,Er,Hr,_i,Ri,yi,ii,Si,$i,_o,Vr,Qo,Fs){const os=kt.addToLineVertexArray(Rt,en);let as,Fd,uu,Bd,_g,AI,PI,OI=0,DI=0,RI=0,zI=0,P1=-1,O1=-1;const pl={};let LI=Sa("");const kd=mn?mn.anchor:Rt,D1=Un.layout.get("icon-text-fit").evaluate(ii,{},Vr)!=="none";let R1=0,z1=0;if(Un._unevaluatedLayout.getValue("text-radial-offset")===void 0?[R1,z1]=Un.layout.get("text-offset").evaluate(ii,{},Vr).map(Pa=>Pa*go):(R1=Un.layout.get("text-radial-offset").evaluate(ii,{},Vr)*go,z1=Zb),kt.allowVerticalPlacement&&sn.vertical){const Pa=sn.vertical;if(Sr)AI=Xb(Pa),jn&&(PI=Xb(jn));else{const ea=Un.layout.get("text-rotate").evaluate(ii,{},Vr)+90;uu=V0(Zn,kd,Rt,Yn,Lr,Mr,Pa,Fn,ea,Er),jn&&(Bd=V0(Zn,kd,Rt,Yn,Lr,Mr,jn,_i,ea))}}if(zn){const Pa=kt.iconSizeData,ea=Un.layout.get("icon-rotate").evaluate(ii,{},Vr),yg=GE(zn,ea,$i,D1,Si.iconScaleFactor),$1=jn?GE(jn,ea,$i,D1,Si.iconScaleFactor):void 0;Fd=V0(Zn,kd,Rt,Yn,Lr,Mr,zn,_i,ea,null),OI=4*yg.length;let Nd=null;Pa.kind==="source"?(Nd=[Ds*Un.layout.get("icon-size").evaluate(ii,{},Vr)*Si.iconScaleFactor],Nd[0]>au&&kn(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Qm}. Reduce your "icon-size".`)):Pa.kind==="composite"&&(Nd=[Ds*Si.compositeIconSizes[0].evaluate(ii,{},Vr)*Si.iconScaleFactor,Ds*Si.compositeIconSizes[1].evaluate(ii,{},Vr)*Si.iconScaleFactor],(Nd[0]>au||Nd[1]>au)&&kn(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Qm}. Reduce your "icon-size".`)),kt.addSymbols(kt.icon,yg,Nd,yi,Ri,ii,!1,mn,Rt,os.lineStartIndex,os.lineLength,-1,_o,Vr,Qo,Fs),P1=kt.icon.placedSymbolArray.length-1,$1&&(DI=4*$1.length,kt.addSymbols(kt.icon,$1,Nd,yi,Ri,ii,Ia.vertical,mn,Rt,os.lineStartIndex,os.lineLength,-1,_o,Vr,Qo,Fs),O1=kt.icon.placedSymbolArray.length-1)}for(const Pa in sn.horizontal){const ea=sn.horizontal[Pa];as||(LI=Sa(ea.text),Sr?_g=Xb(ea):as=V0(Zn,kd,Rt,Yn,Lr,Mr,ea,Fn,Un.layout.get("text-rotate").evaluate(ii,{},Vr),Er));const yg=ea.positionedLines.length===1;if(RI+=ZE(kt,mn,Rt,ea,Vn,Un,Sr,ii,Er,os,sn.vertical?Ia.horizontal:Ia.horizontalOnly,yg?Object.keys(sn.horizontal):[Pa],pl,P1,Si,_o,Vr,Qo),yg)break}sn.vertical&&(zI+=ZE(kt,mn,Rt,sn.vertical,Vn,Un,Sr,ii,Er,os,Ia.vertical,["vertical"],pl,O1,Si,_o,Vr,Qo));let du=-1;const L1=(Pa,ea)=>Pa?Math.max(Pa,ea):ea;du=L1(_g,du),du=L1(AI,du),du=L1(PI,du);const q5=du>-1?1:0;kt.glyphOffsetArray.length>=65535&&kn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ii.sortKey!==void 0&&kt.addToSortKeyRanges(kt.symbolInstances.length,ii.sortKey),kt.symbolInstances.emplaceBack(Rt.x,Rt.y,kd.x,kd.y,kd.z,pl.right>=0?pl.right:-1,pl.center>=0?pl.center:-1,pl.left>=0?pl.left:-1,pl.vertical>=0?pl.vertical:-1,P1,O1,LI,as!==void 0?as:kt.collisionBoxArray.length,as!==void 0?as+1:kt.collisionBoxArray.length,uu!==void 0?uu:kt.collisionBoxArray.length,uu!==void 0?uu+1:kt.collisionBoxArray.length,Fd!==void 0?Fd:kt.collisionBoxArray.length,Fd!==void 0?Fd+1:kt.collisionBoxArray.length,Bd||kt.collisionBoxArray.length,Bd?Bd+1:kt.collisionBoxArray.length,Yn,RI,zI,OI,DI,q5,0,R1,z1,du,0,D1?1:0)})(l,vt,Zt,Dt,a,u,m,nt,l.layers[0],l.collisionBoxArray,n.index,n.sourceLayerIndex,l.index,Se,ke,T,0,we,Ce,V,n,h,P,v,E,C,M)};if(Ne==="line")for(const Dt of kE(n.geometry,0,0,Yt,Yt)){const vt=cB(Dt,fe,xe,a.vertical||W,u,H,oe,l.overscaling,Yt);for(const Jt of vt)W&&mB(l,W.text,Ze,Jt)||xt(Dt,Jt,E)}else if(Ne==="line-center"){for(const Dt of n.geometry)if(Dt.length>1){const vt=lB(Dt,xe,a.vertical||W,u,H,oe);vt&&xt(Dt,vt,E)}}else if(n.type==="Polygon")for(const Dt of I0(n.geometry,0)){const vt=dB(Dt,16);xt(Dt[0],new sc(vt.x,vt.y,0,0,void 0),E)}else if(n.type==="LineString")for(const Dt of n.geometry)xt(Dt,new sc(Dt[0].x,Dt[0].y,0,0,void 0),E);else if(n.type==="Point")for(const Dt of n.geometry)for(const vt of Dt)xt([vt],new sc(vt.x,vt.y,0,0,void 0),E)}const Qm=255,au=Qm*Ds;function ZE(l,n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k,V){const W=function(Q,oe,fe,Se,we,xe,ke,Ce){const Ne=[];if(oe.positionedLines.length===0)return Ne;const Ze=Se.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,Ge=function(xt){const Dt=xt[0],vt=xt[1],Jt=Dt*vt;return Jt>0?[Dt,-vt]:Jt<0?[-Dt,vt]:Dt===0?[vt,Dt]:[vt,-Dt]}(fe);let Je=Math.abs(oe.top-oe.bottom);for(const xt of oe.positionedLines)Je-=xt.lineOffset;const rt=oe.positionedLines.length,lt=Je/rt;let nt=oe.top-fe[1];for(let xt=0;xt<rt;++xt){const Dt=oe.positionedLines[xt];nt=uB(oe,lt,nt,xt);for(const vt of Dt.positionedGlyphs){if(!vt.rect)continue;const Jt=vt.rect||{};let Zt=ME+1,kt=!0,Rt=1,mn=0;if(vt.imageName){const yi=ke[io.build(vt.imageName).getSerializedPrimary()];if(!yi)continue;if(yi.sdf){kn("SDF images are not supported in formatted text and will be ignored.");continue}kt=!1,Rt=yi.pixelRatio,Zt=Xm/Rt}const en=(we||Ce)&&vt.vertical,sn=vt.metrics.advance*vt.scale/2,zn=vt.metrics,Vn=vt.rect;if(Vn===null)continue;Ce&&oe.verticalizable&&(mn=vt.imageName?sn-vt.metrics.width*vt.scale/2:0);const jn=we?[vt.x+sn,vt.y]:[0,0];let Un=[0,0],Zn=[0,0],Yn=!1;we||(en?(Zn=[vt.x+sn+Ge[0],vt.y+Ge[1]-mn],Yn=!0):Un=[vt.x+sn+fe[0],vt.y+fe[1]-mn]);const Lr=Vn.w*vt.scale/(Rt*(vt.localGlyph?Rs:1)),Mr=Vn.h*vt.scale/(Rt*(vt.localGlyph?Rs:1));let Fn,Sr,Er,Hr;if(en){const yi=vt.y-nt,ii=new je(-sn,sn-yi),Si=-Math.PI/2,$i=new je(...Zn);Fn=new je(-sn+Un[0],Un[1]),Fn._rotateAround(Si,ii)._add($i),Fn.x+=-yi+sn,Fn.y-=(zn.left-Zt)*vt.scale;const _o=vt.imageName?zn.advance*vt.scale:go*vt.scale,Vr=String.fromCodePoint(vt.glyph);QF(Vr)?Fn.x+=(1-Zt)*vt.scale:eB(Vr)?Fn.x+=_o-zn.height*vt.scale+(-Zt-1)*vt.scale:Fn.x+=vt.imageName||zn.width+2*Zt===Vn.w&&zn.height+2*Zt===Vn.h?(_o-Mr)/2:(_o-(zn.height+2*Zt)*vt.scale)/2,Sr=new je(Fn.x,Fn.y-Lr),Er=new je(Fn.x+Mr,Fn.y),Hr=new je(Fn.x+Mr,Fn.y-Lr)}else{const yi=(zn.left-Zt)*vt.scale-sn+Un[0],ii=(-zn.top-Zt)*vt.scale+Un[1],Si=yi+Lr,$i=ii+Mr;Fn=new je(yi,ii),Sr=new je(Si,ii),Er=new je(yi,$i),Hr=new je(Si,$i)}if(Ze){let yi;yi=we?new je(0,0):Yn?new je(Ge[0],Ge[1]):new je(fe[0],fe[1]),Fn._rotateAround(Ze,yi),Sr._rotateAround(Ze,yi),Er._rotateAround(Ze,yi),Hr._rotateAround(Ze,yi)}const _i=new je(0,0),Ri=new je(0,0);Ne.push({tl:Fn,tr:Sr,bl:Er,br:Hr,texPrimary:Jt,texSecondary:void 0,writingMode:oe.writingMode,glyphOffset:jn,sectionIndex:vt.sectionIndex,isSDF:kt,pixelOffsetTL:_i,pixelOffsetBR:Ri,minFontScaleX:0,minFontScaleY:0})}}return Ne}(0,u,T,h,g,b,m,l.allowVerticalPlacement),Z=l.textSizeData;let H=null;Z.kind==="source"?(H=[Ds*h.layout.get("text-size").evaluate(b,{},k)*M.textScaleFactor],H[0]>au&&kn(`${l.layerIds[0]}: Value for "text-size" is >= ${Qm}. Reduce your "text-size".`)):Z.kind==="composite"&&(H=[Ds*M.compositeTextSizes[0].evaluate(b,{},k)*M.textScaleFactor,Ds*M.compositeTextSizes[1].evaluate(b,{},k)*M.textScaleFactor],(H[0]>au||H[1]>au)&&kn(`${l.layerIds[0]}: Value for "text-size" is >= ${Qm}. Reduce your "text-size".`)),l.addSymbols(l.text,W,H,T,g,b,v,n,a,P.lineStartIndex,P.lineLength,C,D,k,V,!1);for(const Q of E)A[Q]=l.text.placedSymbolArray.length-1;return 4*W.length}function YE(l){for(const n in l)return l[n];return null}function V0(l,n,a,u,m,h,g,b,T,P){let v=g.top,E=g.bottom,A=g.left,C=g.right;const M=g.collisionPadding;if(M&&(A-=M[0],v-=M[1],C+=M[2],E+=M[3]),T){const D=new je(A,v),k=new je(C,v),V=new je(A,E),W=new je(C,E),Z=zt(T);let H=new je(0,0);P&&(H=new je(P[0],P[1])),D._rotateAround(Z,H),k._rotateAround(Z,H),V._rotateAround(Z,H),W._rotateAround(Z,H),A=Math.min(D.x,k.x,V.x,W.x),C=Math.max(D.x,k.x,V.x,W.x),v=Math.min(D.y,k.y,V.y,W.y),E=Math.max(D.y,k.y,V.y,W.y)}return l.emplaceBack(n.x,n.y,n.z,a.x,a.y,A,v,C,E,b,u,m,h),l.length-1}function Xb(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const n=l.bottom-l.top;return n>0?Math.max(10,n):null}function mB(l,n,a,u){const m=l.compareText;if(n in m){const h=m[n];for(let g=h.length-1;g>=0;g--)if(u.dist(h[g])<a)return!0}else m[n]=[];return m[n].push(u),!1}function XE(l,n){const a=l.fovAboveCenter,u=l.elevation?l.elevation.getMinElevationBelowMSL()*n:0,m=(l._camera.position[2]*l.worldSize-u)/Math.cos(l._pitch),h=Math.sin(a)*m/Math.sin(Math.max(Math.PI/2-l._pitch-a,.01));let g=Math.sin(l._pitch)*h+m;const b=m*(1/l._horizonShift);if(!l.elevation||l.elevation.exaggeration()===0){let T=Math.max(l.zoom-17,0);l.isOrthographic&&(T/=10),g*=1+T}return Math.min(1.01*g,b)}function eg(l,n){if(!n.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:n};const a=Math.pow(2,-l.z),u=l.x*a,m=(l.x+1)*a,h=l.y*a,g=(l.y+1)*a,b=jo(u),T=jo(m),P=to(h),v=to(g),E=n.project(b,P),A=n.project(T,P),C=n.project(T,v),M=n.project(b,v);let D=Math.min(E.x,A.x,C.x,M.x),k=Math.min(E.y,A.y,C.y,M.y),V=Math.max(E.x,A.x,C.x,M.x),W=Math.max(E.y,A.y,C.y,M.y);const Z=a/16;function H(oe,fe,Se,we,xe,ke){const Ce=(Se+xe)/2,Ne=(we+ke)/2,Ze=n.project(jo(Ce),to(Ne)),Ge=Math.max(0,D-Ze.x,k-Ze.y,Ze.x-V,Ze.y-W);D=Math.min(D,Ze.x),V=Math.max(V,Ze.x),k=Math.min(k,Ze.y),W=Math.max(W,Ze.y),Ge>Z&&(H(oe,Ze,Se,we,Ce,Ne),H(Ze,fe,Ce,Ne,xe,ke))}H(E,A,u,h,m,h),H(A,C,m,h,m,g),H(C,M,m,g,u,g),H(M,E,u,g,u,h),D-=Z,k-=Z,V+=Z,W+=Z;const Q=1/Math.max(V-D,W-k);return{scale:Q,x:D*Q,y:k*Q,x2:V*Q,y2:W*Q,projection:n}}function KE(l,{x:n,y:a},u=0){return new je(((n-u)*l.scale-l.x)*Yt,(a*l.scale-l.y)*Yt)}const gB=_e.mat4.identity(new Float32Array(16));class su{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,a){return{x:0,y:0,z:0}}unproject(n,a){return new sr(0,0)}projectTilePoint(n,a,u){return{x:n,y:a,z:0}}locationPoint(n,a,u=!0){return n._coordinatePoint(n.locationCoordinate(a),u)}pixelsPerMeter(n,a){return Eo(1,n)*a}pixelSpaceConversion(n,a,u){return 1}farthestPixelDistance(n){return XE(n,n.pixelsPerMeter)}pointCoordinate(n,a,u,m){const h=n.horizonLineFromTop(!1),g=new je(a,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(g,m))}pointCoordinate3D(n,a,u){const m=new je(a,u);if(n.elevation)return n.elevation.pointCoordinate(m);{const h=this.pointCoordinate(n,m.x,m.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,a){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,a.x,a.y);const u=n.horizonLineFromTop();return a.y<u}createInversionMatrix(n,a){return gB}createTileMatrix(n,a,u){let m,h,g;const b=u.canonical,T=_e.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=eg(b,this);m=1,h=P.x+u.wrap*P.scale,g=P.y,_e.mat4.scale(T,T,[m/P.scale,m/P.scale,n.pixelsPerMeter/a])}else m=a/n.zoomScale(b.z),h=(b.x+Math.pow(2,b.z)*u.wrap)*m,g=b.y*m;return _e.mat4.translate(T,T,[h,g,0]),_e.mat4.scale(T,T,[m/Yt,m/Yt,1]),T}upVector(n,a,u){return[0,0,1]}upVectorScale(n,a,u){return{metersToTile:1}}}class _B extends su{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[a,u]=this.parallels=n.parallels||[29.5,45.5],m=Math.sin(zt(a));this.n=(m+Math.sin(zt(u)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(n,a){const{n:u,c:m,r0:h}=this,g=zt(n-this.center[0]),b=zt(a),T=Math.sqrt(m-2*u*Math.sin(b))/u;return{x:T*Math.sin(g*u),y:T*Math.cos(g*u)-h,z:0}}unproject(n,a){const{n:u,c:m,r0:h}=this,g=h+a;let b=Math.atan2(n,Math.abs(g))*Math.sign(g);g*u<0&&(b-=Math.PI*Math.sign(n)*Math.sign(g));const T=zt(this.center[0])*u;b=tr(b,-Math.PI-T,Math.PI-T);const P=Qt(Kt(b/u)+this.center[0],-180,180),v=Math.asin(Qt((m-(n*n+g*g)*u*u)/(2*u),-1,1)),E=Qt(Kt(v),-hi,hi);return new sr(P,E)}}const tg=1.340264,ng=-.081106,rg=893e-6,ig=.003796,j0=Math.sqrt(3)/2;class yB extends su{project(n,a){a=a/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(j0*Math.sin(a)),m=u*u,h=m*m*m;return{x:.5*(n*Math.cos(u)/(j0*(tg+3*ng*m+h*(7*rg+9*ig*m)))/Math.PI+.5),y:1-.5*(u*(tg+ng*m+h*(rg+ig*m))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,m=u*u,h=m*m*m;for(let v,E,A,C=0;C<12&&(E=u*(tg+ng*m+h*(rg+ig*m))-a,A=tg+3*ng*m+h*(7*rg+9*ig*m),v=E/A,u=Qt(u-v,-Math.PI/3,Math.PI/3),m=u*u,h=m*m*m,!(Math.abs(v)<1e-12));++C);const g=j0*n*(tg+3*ng*m+h*(7*rg+9*ig*m))/Math.cos(u),b=Math.asin(Math.sin(u)/j0),T=Qt(180*g/Math.PI,-180,180),P=Qt(180*b/Math.PI,-hi,hi);return new sr(T,P)}}class vB extends su{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){return{x:.5+n/360,y:.5-a/360,z:0}}unproject(n,a){const u=360*(n-.5),m=Qt(360*(.5-a),-hi,hi);return new sr(u,m)}}const Sf=Math.PI/2;function U0(l){return Math.tan((Sf+l)/2)}class xB extends su{constructor(n){super(n),this.center=n.center||[0,30];const[a,u]=this.parallels=n.parallels||[30,30];let m=zt(a),h=zt(u);this.southernCenter=m+h<0,this.southernCenter&&(m=-m,h=-h);const g=Math.cos(m),b=U0(m);this.n=m===h?Math.sin(m):Math.log(g/Math.cos(h))/Math.log(U0(h)/b),this.f=g*Math.pow(U0(m),this.n)/this.n}project(n,a){a=zt(a),this.southernCenter&&(a=-a),n=zt(n-this.center[0]);const u=1e-6,{n:m,f:h}=this;h>0?a<-Sf+u&&(a=-Sf+u):a>Sf-u&&(a=Sf-u);const g=h/Math.pow(U0(a),m);let b=g*Math.sin(m*n),T=h-g*Math.cos(m*n);return b=.5*(b/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:b,y:this.southernCenter?T:1-T,z:0}}unproject(n,a){n=(2*n-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f:m}=this,h=m-a,g=Math.sign(h),b=Math.sign(u)*Math.sqrt(n*n+h*h);let T=Math.atan2(n,Math.abs(h))*g;h*u<0&&(T-=Math.PI*Math.sign(n)*g);const P=Qt(Kt(T/u)+this.center[0],-180,180),v=Qt(Kt(2*Math.atan(Math.pow(m/b,1/u))-Sf),-hi,hi);return new sr(P,this.southernCenter?-v:v)}}class JE extends su{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,a){return{x:ts(n),y:Ma(a),z:0}}unproject(n,a){const u=jo(n),m=to(a);return new sr(u,m)}}const QE=zt(hi);class bB extends su{project(n,a){const u=(a=zt(a))*a,m=u*u;return{x:.5*((n=zt(n))*(.8707-.131979*u+m*(m*(.003971*u-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+m*(.028874*u-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,m=25,h=0,g=u*u;do{g=u*u;const P=g*g;h=(u*(1.007226+g*(.015085+P*(.028874*g-.044475-.005916*P)))-a)/(1.007226+g*(.045255+P*(.259866*g-.311325-.005916*11*P))),u=Qt(u-h,-QE,QE)}while(Math.abs(h)>1e-6&&--m>0);g=u*u;const b=Qt(Kt(n/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),T=Kt(u);return new sr(b,T)}}const eM=zt(hi);class wB extends su{project(n,a){a=zt(a),n=zt(n);const u=Math.cos(a),m=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),g=Math.sin(h)/h,b=.5*(n*m+2*u*Math.sin(n/2)/g)||0,T=.5*(a+Math.sin(a)/g)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(n,a){let u=n=(2*n-.5)*Math.PI,m=a=(2*(1-a)-1)*Math.PI,h=25;const g=1e-6;let b=0,T=0;do{const P=Math.cos(m),v=Math.sin(m),E=2*v*P,A=v*v,C=P*P,M=Math.cos(u/2),D=Math.sin(u/2),k=2*M*D,V=D*D,W=1-C*M*M,Z=W?1/W:0,H=W?Math.acos(P*M)*Math.sqrt(1/W):0,Q=.5*(2*H*P*D+2*u/Math.PI)-n,oe=.5*(H*v+m)-a,fe=.5*Z*(C*V+H*P*M*A)+1/Math.PI,Se=Z*(k*E/4-H*v*D),we=.125*Z*(E*D-H*v*C*k),xe=.5*Z*(A*M+H*V*P)+.5,ke=Se*we-xe*fe;b=(oe*Se-Q*xe)/ke,T=(Q*we-oe*fe)/ke,u=Qt(u-b,-Math.PI,Math.PI),m=Qt(m-T,-eM,eM)}while((Math.abs(b)>g||Math.abs(T)>g)&&--h>0);return new sr(Kt(u),Kt(m))}}class tM extends su{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(zt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){const{scale:u,cosPhi:m}=this;return{x:zt(n)*m*u+.5,y:-Math.sin(zt(a))/m*u+.5,z:0}}unproject(n,a){const{scale:u,cosPhi:m}=this,h=-(a-.5)/u,g=Qt(Kt((n-.5)/u)/m,-180,180),b=Math.asin(Qt(h*m,-1,1)),T=Qt(Kt(b),-hi,hi);return new sr(g,T)}}class SB extends JE{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,a,u){const m=Or(n,a,u),h=Vi(Pi(u));return _e.vec3.transformMat4(m,m,h),{x:m[0],y:m[1],z:m[2]}}locationPoint(n,a){const u=rc(a.lat,a.lng),m=_e.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(a),n._centerAltitude):n._centerAltitude,g=Eo(1,0)*Yt*h;_e.vec3.scaleAndAdd(u,u,m,g);const b=_e.mat4.identity(new Float64Array(16));return _e.mat4.multiply(b,n.pixelMatrix,n.globeMatrix),_e.vec3.transformMat4(u,u,b),new je(u[0],u[1])}pixelsPerMeter(n,a){return Eo(1,0)*a}pixelSpaceConversion(n,a,u){const m=Eo(1,n)*a,h=Pn(Eo(1,45)*a,m,u);return this.pixelsPerMeter(n,a)/h}createTileMatrix(n,a,u){const m=Dr(Pi(u.canonical));return _e.mat4.multiply(new Float64Array(16),n.globeMatrix,m)}createInversionMatrix(n,a){const{center:u}=n,m=Vi(Pi(a));return _e.mat4.rotateY(m,m,zt(u.lng)),_e.mat4.rotateX(m,m,zt(u.lat)),_e.mat4.scale(m,m,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(n,a,u,m){return _r(n,a,u,!0)||new s(0,0)}pointCoordinate3D(n,a,u){const m=this.pointCoordinate(n,a,u,0);return[m.x,m.y,m.z]}isPointAboveHorizon(n,a){return!_r(n,a.x,a.y,!1)}farthestPixelDistance(n){const a=function(m,h){const g=m.cameraToCenterDistance,b=m._centerAltitude*h,T=m._camera,P=m._camera.forward(),v=_e.vec3.add([],_e.vec3.scale([],P,-g),[0,0,b]),E=m.worldSize/(2*Math.PI),A=[0,0,-E],C=m.width/m.height,M=Math.tan(m.fovAboveCenter),D=_e.vec3.scale([],T.up(),M),k=_e.vec3.scale([],T.right(),M*C),V=_e.vec3.normalize([],_e.vec3.add([],_e.vec3.add([],P,D),k)),W=[];let Z;if(new $n(v,V).closestPointOnSphere(A,E,W)){const H=_e.vec3.add([],W,A),Q=_e.vec3.sub([],H,v);Z=Math.cos(m.fovAboveCenter)*_e.vec3.length(Q)}else{const H=_e.vec3.sub([],v,A),Q=_e.vec3.sub([],A,v);_e.vec3.normalize(Q,Q);const oe=_e.vec3.length(H)-E;Z=Math.sqrt(oe*(oe+2*E));const fe=Math.acos(Z/(E+oe))-Math.acos(_e.vec3.dot(P,Q));Z*=Math.cos(fe)}return 1.01*Z}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=Ro(n.zoom);if(u>0){const m=XE(n,Eo(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),g=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Pn(a,m+h*(1-Math.cos(g)),Math.pow(u,10))}return a}upVector(n,a,u){return Or(a,u,n,1)}upVectorScale(n){return{metersToTile:Xn(er(Pi(n)))}}}function nM(l){const n=l.parallels,a=!!n&&Math.abs(n[0]+n[1])<.01;switch(l.name){case"mercator":return new JE(l);case"equirectangular":return new vB(l);case"naturalEarth":return new bB(l);case"equalEarth":return new yB(l);case"winkelTripel":return new wB(l);case"albers":return a?new tM(l):new _B(l);case"lambertConformalConic":return a?new tM(l):new xB(l);case"globe":return new SB(l)}throw new Error(`Invalid projection name: ${l.name}`)}const CB=yf.VectorTileFeature.types,TB=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function H0(l,n,a,u,m,h,g,b,T,P,v,E,A){const C=b?Math.min(au,Math.round(b[0])):0,M=b?Math.min(au,Math.round(b[1])):0;l.emplaceBack(n,a,Math.round(32*u),Math.round(32*m),h,g,(C<<1)+(T?1:0),M,16*P,16*v,256*E,256*A)}function G0(l,n,a){l.emplaceBack(n,a)}function W0(l,n,a,u,m,h,g){l.emplaceBack(n,a,u,m,h,g)}function q0(l,n,a,u,m){l.emplaceBack(n,a,u,m),l.emplaceBack(n,a,u,m),l.emplaceBack(n,a,u,m),l.emplaceBack(n,a,u,m)}function EB(l){for(const n of l.sections)if(dm(n.text))return!0;return!1}class Kb{constructor(n){this.layoutVertexArray=new vm,this.indexArray=new eo,this.programConfigurations=n,this.segments=new di,this.dynamicLayoutVertexArray=new Ql,this.opacityVertexArray=new bm,this.placedSymbolArray=new h0,this.iconTransitioningVertexArray=new ll,this.globeExtVertexArray=new xm,this.zOffsetVertexArray=new vd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,a,u,m,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,UF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,GF.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,TB,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,qF.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,HF.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,WF.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}fn(Kb,"SymbolBuffers");class Jb{constructor(n,a,u){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new u,this.segments=new di,this.collisionVertexArray=new Cm,this.collisionVertexArrayExt=new Ql}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,ZF.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,YF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}fn(Jb,"CollisionBuffers");class Z0{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_e.mat4.identity([]),this.placementViewportMatrix=_e.mat4.identity([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vb(this.zoom,a["text-size"]),this.iconSizeData=Vb(this.zoom,a["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(g=>Ia[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Kb(new dl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new Kb(new dl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new m0,this.lineVertexArray=new g0,this.symbolInstances=new p0}calculateGlyphDependencies(n,a,u,m,h){for(const g of n){const b=g.codePointAt(0);if(b===void 0)break;if(a[b]=!0,m&&h&&b<=65535){const T=Zm[g];T&&(a[T.charCodeAt(0)]=!0)}}}updateFootprints(n,a){}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!Rb(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,a,u,m){const h=this.layers[0],g=h.layout,b=this.projection.name==="globe",T=g.get("text-font"),P=g.get("text-field"),v=g.get("icon-image"),[E,A]=g.get("icon-size-scale-range"),C=Qt(a.scaleFactor||1,E,A),M=(P.value.kind!=="constant"||P.value.value instanceof ho&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),D=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,k=g.get("symbol-sort-key");if(this.features=[],!M&&!D)return;const V=a.iconDependencies,W=a.glyphDependencies,Z=a.availableImages,H=new Br(this.zoom);for(const{feature:Q,id:oe,index:fe,sourceLayerIndex:Se}of n){const we=h._featureFilter.needGeometry,xe=j(Q,we);if(!h._featureFilter.filter(H,xe,u))continue;if(we||(xe.geometry=B(Q,u,m)),b&&Q.type!==1&&u.z<=5){const Ge=xe.geometry,Je=.98078528056,rt=(lt,nt)=>{const xt=Or(lt.x,lt.y,u,1),Dt=Or(nt.x,nt.y,u,1);return _e.vec3.dot(xt,Dt)<Je};for(let lt=0;lt<Ge.length;lt++)Ge[lt]=S(Ge[lt],rt)}let ke,Ce;if(M){const Ge=h.getValueAndResolveTokens("text-field",xe,u,Z),Je=ho.factory(Ge);EB(Je)&&(this.hasRTLText=!0),(!this.hasRTLText||Jh()==="unavailable"||this.hasRTLText&&Zo.isParsed())&&(ke=JF(Je,h,xe))}if(D){const Ge=h.getValueAndResolveTokens("icon-image",xe,u,Z);Ce=Ge instanceof io?Ge:io.build(Ge)}if(!ke&&!Ce)continue;const Ne=this.sortFeaturesByKey?k.evaluate(xe,{},u):void 0,Ze={id:oe,text:ke,icon:Ce,index:fe,sourceLayerIndex:Se,geometry:xe.geometry,properties:Q.properties,type:CB[Q.type],sortKey:Ne};if(this.features.push(Ze),Ce){const Ge=Nb(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,Ze)*C*this.pixelRatio,Je=Ce.getPrimary().scaleSelf(Ge);if(V[Je.id]=V[Je.id]||[],V[Je.id].push(Je),Ce.nameSecondary){const rt=Ce.getSecondary().scaleSelf(Ge);V[rt.id]=V[rt.id]||[],V[rt.id].push(rt)}}if(ke){const Ge=T.evaluate(xe,{},u).join(","),Je=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ia.vertical)>=0;for(const rt of ke.sections)if(rt.image){const lt=rt.image.getPrimary().scaleSelf(this.pixelRatio);V[lt.id]=V[lt.id]||[],V[lt.id].push(lt)}else{const lt=lm(ke.toString()),nt=rt.fontStack||Ge,xt=W[nt]=W[nt]||{};this.calculateGlyphDependencies(rt.text,xt,Je,this.allowVerticalPlacement,lt)}}}g.get("symbol-placement")==="line"&&(this.features=function(Q){const oe={},fe={},Se=[];let we=0;function xe(Ze){Se.push(Q[Ze]),we++}function ke(Ze,Ge,Je){const rt=fe[Ze];return delete fe[Ze],fe[Ge]=rt,Se[rt].geometry[0].pop(),Se[rt].geometry[0]=Se[rt].geometry[0].concat(Je[0]),rt}function Ce(Ze,Ge,Je){const rt=oe[Ge];return delete oe[Ge],oe[Ze]=rt,Se[rt].geometry[0].shift(),Se[rt].geometry[0]=Je[0].concat(Se[rt].geometry[0]),rt}function Ne(Ze,Ge,Je){const rt=Je?Ge[0][Ge[0].length-1]:Ge[0][0];return`${Ze}:${rt.x}:${rt.y}`}for(let Ze=0;Ze<Q.length;Ze++){const Ge=Q[Ze],Je=Ge.geometry,rt=Ge.text?Ge.text.toString():null;if(!rt){xe(Ze);continue}const lt=Ne(rt,Je),nt=Ne(rt,Je,!0);if(lt in fe&&nt in oe&&fe[lt]!==oe[nt]){const xt=Ce(lt,nt,Je),Dt=ke(lt,nt,Se[xt].geometry);delete oe[lt],delete fe[nt],fe[Ne(rt,Se[Dt].geometry,!0)]=Dt,Se[xt].geometry=null}else lt in fe?ke(lt,nt,Je):nt in oe?Ce(lt,nt,Je):(xe(Ze),oe[lt]=we-1,fe[nt]=we-1)}return Se.filter(Ze=>Ze.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,oe)=>Q.sortKey-oe.sortKey)}update(n,a,u,m,h,g,b){this.text.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b),this.icon.programConfigurations.updatePaintArrays(n,a,h,u,m,g,b)}updateZOffset(){const n=(h,g,b)=>{u+=g,u>h.length&&h.resize(u);for(let T=-g;T<0;T++)h.emplace(T+u,b)},a=(h,g,b)=>{m+=g,m>h.length&&h.resize(m);for(let T=-g;T<0;T++)h.emplace(T+m,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,m=0;for(let h=0;h<this.symbolInstances.length;h++){const g=this.symbolInstances.get(h),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:T,numIconVertices:P}=g,v=g.zOffset,E=P>0;if((b>0||T>0)&&(n(this.text.zOffsetVertexArray,b,v),n(this.text.zOffsetVertexArray,T,v)),E){const{placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:C}=g;A>=0&&a(this.icon.zOffsetVertexArray,P,v),C>=0&&a(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,v)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=nM(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:m,y:h}of a)this.lineVertexArray.emplaceBack(m,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,a,u,m,h,g,b,T,P,v,E,A,C,M,D,k){const V=n.indexArray,W=n.layoutVertexArray,Z=n.globeExtVertexArray,H=n.segments.prepareSegment(4*a.length,W,V,this.canOverlap?g.sortKey:void 0),Q=this.glyphOffsetArray.length,oe=H.vertexLength,fe=this.allowVerticalPlacement&&b===Ia.vertical?Math.PI/2:0,Se=g.text&&g.text.sections;for(let xe=0;xe<a.length;xe++){const{tl:ke,tr:Ce,bl:Ne,br:Ze,texPrimary:Ge,texSecondary:Je,pixelOffsetTL:rt,pixelOffsetBR:lt,minFontScaleX:nt,minFontScaleY:xt,glyphOffset:Dt,isSDF:vt,sectionIndex:Jt}=a[xe],Zt=H.vertexLength,kt=Dt[1];if(H0(W,P.x,P.y,ke.x,kt+ke.y,Ge.x,Ge.y,u,vt,rt.x,rt.y,nt,xt),H0(W,P.x,P.y,Ce.x,kt+Ce.y,Ge.x+Ge.w,Ge.y,u,vt,lt.x,rt.y,nt,xt),H0(W,P.x,P.y,Ne.x,kt+Ne.y,Ge.x,Ge.y+Ge.h,u,vt,rt.x,lt.y,nt,xt),H0(W,P.x,P.y,Ze.x,kt+Ze.y,Ge.x+Ge.w,Ge.y+Ge.h,u,vt,lt.x,lt.y,nt,xt),T){const{x:Rt,y:mn,z:en}=T.anchor,[sn,zn,Vn]=T.up;W0(Z,Rt,mn,en,sn,zn,Vn),W0(Z,Rt,mn,en,sn,zn,Vn),W0(Z,Rt,mn,en,sn,zn,Vn),W0(Z,Rt,mn,en,sn,zn,Vn),q0(n.dynamicLayoutVertexArray,Rt,mn,en,fe)}else q0(n.dynamicLayoutVertexArray,P.x,P.y,P.z,fe);if(k){const Rt=Je||Ge;G0(n.iconTransitioningVertexArray,Rt.x,Rt.y),G0(n.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y),G0(n.iconTransitioningVertexArray,Rt.x,Rt.y+Rt.h),G0(n.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y+Rt.h)}V.emplaceBack(Zt,Zt+1,Zt+2),V.emplaceBack(Zt+1,Zt+2,Zt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dt[0]),xe!==a.length-1&&Jt===a[xe+1].sectionIndex||n.programConfigurations.populatePaintArrays(W.length,g,g.index,{},C,M,D,Se&&Se[Jt])}const we=T?T.anchor:P;n.placedSymbolArray.emplaceBack(we.x,we.y,we.z,P.x,P.y,Q,this.glyphOffsetArray.length-Q,oe,v,E,P.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],b,0,!1,0,A,0)}_commitLayoutVertex(n,a,u,m,h,g,b){n.emplaceBack(a,u,m,h,g,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(n,a,u,m,h,g,b){const T=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),P=T.vertexLength,v=b.tileAnchorX,E=b.tileAnchorY;for(let C=0;C<4;C++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,a,n.padding,b.zOffset),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,E,new je(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,E,new je(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,E,new je(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,E,new je(n.x1,n.y2)),T.vertexLength+=4;const A=u.indexArray;A.emplaceBack(P,P+1),A.emplaceBack(P+1,P+2),A.emplaceBack(P+2,P+3),A.emplaceBack(P+3,P),T.primitiveLength+=4}_addTextDebugCollisionBoxes(n,a,u,m,h,g){for(let b=m;b<h;b++){const T=u.get(b),P=this.getSymbolInstanceTextSize(n,g,a,b);this._addCollisionDebugVertices(T,P,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(n,a,u,m,h,g){for(let b=m;b<h;b++){const T=u.get(b),P=this.getSymbolInstanceIconSize(n,a,g.placedIconSymbolIndex);this._addCollisionDebugVertices(T,P,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}generateCollisionDebugBuffers(n,a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jb(sf,SE.members,ll),this.iconCollisionBox=new Jb(sf,SE.members,ll);const m=vf(this.iconSizeData,n),h=vf(this.textSizeData,n,u);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(h,n,a,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(h,n,a,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(m,n,a,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(m,n,a,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(n,a,u,m){const h=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:m),g=L0(this.textSizeData,n,h)/go;return this.tilePixelRatio*g}getSymbolInstanceIconSize(n,a,u){const m=this.icon.placedSymbolArray.get(u),h=L0(this.iconSizeData,n,m);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,a,u,m){n.emplaceBack(a,-u,-u,m),n.emplaceBack(a,u,-u,m),n.emplaceBack(a,u,u,m),n.emplaceBack(a,-u,u,m)}_updateTextDebugCollisionBoxes(n,a,u,m,h,g,b){for(let T=m;T<h;T++){const P=u.get(T),v=this.getSymbolInstanceTextSize(n,g,a,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,P.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(n,a,u,m,h,g,b){for(let T=m;T<h;T++){const P=u.get(T),v=this.getSymbolInstanceIconSize(n,a,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,P.padding,g.zOffset)}}updateCollisionDebugBuffers(n,a,u,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=vf(this.iconSizeData,n,m),g=vf(this.textSizeData,n,u);for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(g,n,a,T.textBoxStartIndex,T.textBoxEndIndex,T,u),this._updateTextDebugCollisionBoxes(g,n,a,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,u),this._updateIconDebugCollisionBoxes(h,n,a,T.iconBoxStartIndex,T.iconBoxEndIndex,T,m),this._updateIconDebugCollisionBoxes(h,n,a,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,a,u,m,h,g,b,T,P){const v={};if(a<u){const{x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H,featureIndex:Q}=n.get(a);v.textBox={x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H},v.textFeatureIndex=Q}if(m<h){const{x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H,featureIndex:Q}=n.get(m);v.verticalTextBox={x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H},v.verticalTextFeatureIndex=Q}if(g<b){const{x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H,featureIndex:Q}=n.get(g);v.iconBox={x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H},v.iconFeatureIndex=Q}if(T<P){const{x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H,featureIndex:Q}=n.get(T);v.verticalIconBox={x1:E,y1:A,x2:C,y2:M,padding:D,projectedAnchorX:k,projectedAnchorY:V,projectedAnchorZ:W,tileAnchorX:Z,tileAnchorY:H},v.verticalIconFeatureIndex=Q}return v}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,a){const u=n.placedSymbolArray.get(a),m=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<m;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),u=Math.cos(n),m=[],h=[],g=[];for(let b=0;b<this.symbolInstances.length;++b){g.push(b);const T=this.symbolInstances.get(b);m.push(0|Math.round(a*T.tileAnchorX+u*T.tileAnchorY)),h.push(T.featureIndex)}return g.sort((b,T)=>m[b]-m[T]||h[T]-h[b]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:P}=u;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),h>=0&&h!==m&&this.addIndicesForPlacedSymbol(this.text,h),g>=0&&g!==h&&g!==m&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let rM,iM,Qb;fn(Z0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Z0.addDynamicAttributes=q0;class oM{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:Bl,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}fn(oM,"FormatSectionOverride",{omit:["defaultValue"]});const e1=()=>Qb||(Qb={layout:rM||(rM=new Yr({"symbol-placement":new Vt(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Vt(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vt(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new on(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vt(ut.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Vt(ut.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Vt(ut.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Vt(ut.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Vt(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vt(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vt(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new on(ut.layout_symbol["icon-size"]),"icon-size-scale-range":new Vt(ut.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new on(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new on(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new on(ut.layout_symbol["icon-image"]),"icon-rotate":new on(ut.layout_symbol["icon-rotate"]),"icon-padding":new Vt(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Vt(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new on(ut.layout_symbol["icon-offset"]),"icon-anchor":new on(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vt(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vt(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vt(ut.layout_symbol["text-rotation-alignment"]),"text-field":new on(ut.layout_symbol["text-field"]),"text-font":new on(ut.layout_symbol["text-font"]),"text-size":new on(ut.layout_symbol["text-size"]),"text-size-scale-range":new Vt(ut.layout_symbol["text-size-scale-range"]),"text-max-width":new on(ut.layout_symbol["text-max-width"]),"text-line-height":new on(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new on(ut.layout_symbol["text-letter-spacing"]),"text-justify":new on(ut.layout_symbol["text-justify"]),"text-radial-offset":new on(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vt(ut.layout_symbol["text-variable-anchor"]),"text-anchor":new on(ut.layout_symbol["text-anchor"]),"text-max-angle":new Vt(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Vt(ut.layout_symbol["text-writing-mode"]),"text-rotate":new on(ut.layout_symbol["text-rotate"]),"text-padding":new Vt(ut.layout_symbol["text-padding"]),"text-keep-upright":new Vt(ut.layout_symbol["text-keep-upright"]),"text-transform":new on(ut.layout_symbol["text-transform"]),"text-offset":new on(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Vt(ut.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Vt(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Vt(ut.layout_symbol["text-optional"]),visibility:new Vt(ut.layout_symbol.visibility)})),paint:iM||(iM=new Yr({"icon-opacity":new on(ut.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new on(ut.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new on(ut.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new on(ut.paint_symbol["text-emissive-strength"]),"icon-color":new on(ut.paint_symbol["icon-color"]),"icon-halo-color":new on(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new on(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new on(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Vt(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vt(ut.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new on(ut.paint_symbol["icon-image-cross-fade"]),"text-opacity":new on(ut.paint_symbol["text-opacity"]),"text-occlusion-opacity":new on(ut.paint_symbol["text-occlusion-opacity"]),"text-color":new on(ut.paint_symbol["text-color"],{runtimeType:uo,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new on(ut.paint_symbol["text-halo-color"]),"text-halo-width":new on(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new on(ut.paint_symbol["text-halo-blur"]),"text-translate":new Vt(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Vt(ut.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Vt(ut.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Vt(ut.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Vt(ut.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Vt(ut.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new on(ut.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},Qb);class Y0 extends Wi{constructor(n,a,u,m){super(n,e1(),a,u,m),this._colorAdjustmentMatrix=_e.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,a){super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const h of u)m.indexOf(h)<0&&m.push(h);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,a,u,m){return this._saturation===n&&this._contrast===a&&this._brightnessMin===u&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(h,g,b,T){h=Ll(h),g=Js(g);const P=_e.mat4.create(),v=h/3,E=1-2*v,A=[E,v,v,0,v,E,v,0,v,v,E,0,0,0,0,1],C=.5-.5*g,M=T-b;return _e.mat4.multiply(P,[M,0,0,0,0,M,0,0,0,0,M,0,b,b,b,1],[g,0,0,0,0,g,0,0,0,0,g,0,C,C,C,1]),_e.mat4.multiply(P,P,A),P}(n,a,u,m),this._saturation=n,this._contrast=a,this._brightnessMin=u,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,a,u,m){const h=this.layout.get(n).evaluate(a,{},u,m),g=this._unevaluatedLayout._values[n];return g.isDataDriven()||Vc(g.value)||!h?h:function(b,T){return T.replace(/{([^{}]+)}/g,(P,v)=>v in b?String(b[v]):"")}(a.properties,h)}createBucket(n){return new Z0(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of e1().paint.overridableProperties){if(!Y0.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),u=new oM(a),m=new qh(u,a.property.specification,this.scope,this.options);let h=null;h=a.value.kind==="constant"||a.value.kind==="source"?new Zh("source",m):new cd("composite",m,a.value.zoomStops,a.value._interpolationType),this.paint._values[n]=new Gc(a.property,h,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&Y0.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const u=n.get("text-field"),m=e1().paint.properties[a];let h=!1;const g=b=>{for(const T of b)if(m.overrides&&m.overrides.hasOverride(T))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ho)g(u.value.value.sections);else if(u.value.kind==="source"){const b=P=>{h||(P instanceof Ji&&ri(P.value)===Za?g(P.value.sections):P instanceof kl?g(P.sections):P.eachChild(b))},T=u.value;T._styleExpression&&b(T._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,a,u){return{config:new nc(this,{zoom:a,lut:u}),overrideFog:!1}}}let aM,sM,lM,cM;var t1=gr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function n1(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function r1(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class i1{constructor(n,a,u,m){this.context=n,this.format=u,this.useMipmap=m&&m.useMipmap,this.texture=n.gl.createTexture(),this.update(a,{premultiply:m&&m.premultiply})}update(n,a){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,m=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:g}=h,{x:b,y:T}=a&&a.position?a.position:{x:0,y:0},P=b+u,v=T+m;!this.size||this.size[0]===P&&this.size[1]===v||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!a||a.premultiply!==!1));const E=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&P>0&&v>0){const A=this.useMipmap?Math.floor(Math.log2(Math.max(P,v)))+1:1;g.texStorage2D(g.TEXTURE_2D,A,this.format,P,v),this.size=[P,v]}if(this.size)if(E)g.texSubImage2D(g.TEXTURE_2D,0,b,T,n1(this.format),r1(this.format),n);else{const A=n.data;A&&g.texSubImage2D(g.TEXTURE_2D,0,b,T,u,m,n1(this.format),r1(this.format),A)}this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(n,a,u=!1){const{context:m}=this,{gl:h}=m;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),a!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,a),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(n,a,u,m){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),this.magFilter=a),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?n===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),this.wrapS=u),m!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class X0{constructor(n,a){this.context=n,this.texture=a}bind(n,a){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),n!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,n),this.minFilter=n),a!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrapS=a)}}function K0(l,n,a,u,m,h,g,b){const T=[l,n,1,a,u,1,m,h,1],P=[g,b,1],v=_e.mat3.adjoint([],T),[E,A,C]=_e.vec3.transformMat3(P,P,v);return _e.mat3.multiply(T,T,[E,0,0,0,A,0,0,0,C])}function uM(l,n,a,u,m,h,g,b){const T=function(P,v,E,A,C,M,D,k){const V=K0(0,0,1,0,1,1,0,1),W=K0(P,v,E,A,C,M,D,k),Z=_e.mat3.adjoint([],V);return _e.mat3.multiply(W,W,Z)}(l,n,a,u,m,h,g,b);return[T[2]/T[8]/Yt,T[5]/T[8]/Yt]}function J0(l){return[l[0],Math.min(Math.max(l[1],-hi),hi)]}class dM extends el{constructor(n,a,u,m){super(),this.id=n,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=a,this._dirty=!1}load(n,a){if(this._loaded=a||!1,this.fire(new qa("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=xp(this.map._requestManager.transformRequest(this.url,fr.Image),(u,m)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Th(u)):m&&(this.image=m instanceof HTMLImageElement?De.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new X0(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new qa("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof X0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<a&&(a=h[1]);const m=(u+a)/2;if(m>hi?this.onNorthPole=!0:m<-hi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(s.fromLngLat);this.tileID=function(g){let b=1/0,T=1/0,P=-1/0,v=-1/0;for(const D of g)b=Math.min(b,D.x),T=Math.min(T,D.y),P=Math.max(P,D.x),v=Math.max(v,D.y);const E=Math.max(P-b,v-T),A=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),C=Math.pow(2,A);let M=Math.floor((b+P)/2*C);return M>1&&(M-=1),new Ot(A,M,Math.floor((T+v)/2*C))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new qa("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const V in this.tiles){const W=this.tiles[V];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=eg(new Ot(0,0,0),this.map.transform.projection),u=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(V){const W=V[1].x-V[0].x,Z=V[1].y-V[0].y,H=V[2].x-V[1].x,Q=V[2].y-V[1].y,oe=V[3].x-V[2].x,fe=V[3].y-V[2].y,Se=V[0].x-V[3].x,we=V[0].y-V[3].y,xe=W*Q-H*Z,ke=H*fe-oe*Q,Ce=oe*we-Se*fe,Ne=Se*Z-W*we;return xe>0&&ke>0&&Ce>0&&Ne>0||xe<0&&ke<0&&Ce<0&&Ne<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=eg(this.tileID,this.map.transform.projection),[h,g,b,T]=this.coordinates.map(V=>{const W=m.projection.project(V[0],V[1]);return KE(m,W)._round()});this.perspectiveTransform=uM(h.x,h.y,g.x,g.y,b.x,b.y,T.x,T.y);const P=this._boundsArray=new Ps;P.emplaceBack(h.x,h.y,0,0),P.emplaceBack(g.x,g.y,Yt,0),P.emplaceBack(T.x,T.y,0,Yt),P.emplaceBack(b.x,b.y,Yt,Yt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(P,t1.members),this.boundsSegments=di.simpleSegment(0,0,4,2);const v=[],E=[J0((A=this.coordinates)[0]),J0(A[1]),J0(A[2]),J0(A[3])];var A;const[C,M,D,k]=function(V){let W=V[0][0],Z=W,H=V[0][1],Q=H;for(let oe=1;oe<V.length;oe++)V[oe][0]<W?W=V[oe][0]:V[oe][0]>Z&&(Z=V[oe][0]),V[oe][1]<H?H=V[oe][1]:V[oe][1]>Q&&(Q=V[oe][1]);return[W,H,Z-W,Q-H]}(E);{const V=new Ps,[W,Z,H,Q]=function(rt){let lt=rt[0].x,nt=lt,xt=rt[0].y,Dt=xt;for(let vt=1;vt<rt.length;vt++)rt[vt].x<lt?lt=rt[vt].x:rt[vt].x>nt&&(nt=rt[vt].x),rt[vt].y<xt?xt=rt[vt].y:rt[vt].y>Dt&&(Dt=rt[vt].y);return[lt,xt,nt-lt,Dt-xt]}(u),oe=rt=>[(rt.x-W)/H,(rt.y-Z)/Q],[fe,Se,we,xe]=u.map(oe),ke=function(rt,lt,nt,xt,Dt,vt,Jt,Zt){const kt=K0(0,0,1,0,1,1,0,1),Rt=K0(rt,lt,nt,xt,Dt,vt,Jt,Zt),mn=_e.mat3.adjoint([],Rt);return _e.mat3.multiply(kt,kt,mn)}(fe[0],fe[1],Se[0],Se[1],we[0],we[1],xe[0],xe[1]);this.elevatedGlobePerspectiveTransform=uM(fe[0],fe[1],Se[0],Se[1],we[0],we[1],xe[0],xe[1]);const Ce=(rt,lt)=>{v.push(rt.lng);const nt=Math.round((rt.lng-C)/D*Yt),xt=Math.round((rt.lat-M)/k*Yt),Dt=oe(lt),vt=_e.vec3.transformMat3([],[Dt[0],Dt[1],1],ke),Jt=Math.round(vt[0]/vt[2]*Yt),Zt=Math.round(vt[1]/vt[2]*Yt);V.emplaceBack(nt,xt,Jt,Zt)},Ne=u[3].x-u[0].x,Ze=u[3].y-u[0].y,Ge=u[2].x-u[1].x,Je=u[2].y-u[1].y;for(let rt=0;rt<65;rt++){const lt=rt/64,nt=[u[0].x+lt*Ne,u[0].y+lt*Ze],xt=[u[1].x+lt*Ge,u[1].y+lt*Je],Dt=xt[0]-nt[0],vt=xt[1]-nt[1];for(let Jt=0;Jt<65;Jt++){const Zt=Jt/64,kt={x:nt[0]+Dt*Zt,y:nt[1]+vt*Zt,z:0};Ce(a.projection.unproject(kt.x,kt.y),kt)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(V,t1.members)}{this.maxLongitudeTriangleSize=0;let V=[],W=new eo;const Z=(H,Q,oe)=>{W.emplaceBack(H,Q,oe);const fe=v[H],Se=v[Q],we=v[oe],xe=Math.min(Math.min(fe,Se),we),ke=Math.max(Math.max(fe,Se),we)-xe;ke>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ke),V.push(xe+ke/2)};for(let H=0;H<64;H++)for(let Q=0;Q<64;Q++){const oe=65*H+Q,fe=oe+1,Se=oe+65,we=Se+1;Z(oe,Se,fe),Z(fe,Se,we)}[V,W]=function(H,Q){const oe=Array.from({length:H.length},(we,xe)=>xe);oe.sort((we,xe)=>H[we]-H[xe]);const fe=[],Se=new eo;for(let we=0;we<oe.length;we++){const xe=oe[we];fe.push(H[xe]);const ke=3*xe,Ce=ke+1;Se.emplaceBack(Q.uint16[ke],Q.uint16[Ce],Q.uint16[Ce+1])}return[fe,Se]}(V,W),this.elevatedGlobeTrianglesCenterLongitudes=V,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(W)}this.elevatedGlobeSegments=di.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,D/Yt,0,k/Yt,0,0,M,C,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const a=this.map.painter.context,u=a.gl;!this._dirty||this.texture instanceof X0||(this.texture?this.texture.update(this.image):(this.texture=new i1(a,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(a)}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let m=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const g=new di,b=(E,A)=>{g.segments.push({vertexOffset:0,primitiveOffset:E,vertexLength:a.segments[0].vertexLength,primitiveLength:A,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-m)<=T){const E=Ha(u,0,u.length,m+T);return E===u.length||b(E,ku(u,E+1,u.length,m+360-T)-E),g}m<u[0]&&(m+=360);const P=ku(u,0,u.length,m-T);if(P===u.length)return b(0,u.length),g;b(0,P-0);const v=Ha(u,P+1,u.length,m+T);return v!==u.length&&b(v,u.length-v),g}}const MB=(Math.pow(256,2)-1)/16907520;class hM extends Wi{constructor(n,a,u,m){super(n,{layout:lM||(lM=new Yr({visibility:new Vt(ut.layout_raster.visibility)})),paint:cM||(cM=new Yr({"raster-opacity":new Vt(ut.paint_raster["raster-opacity"]),"raster-color":new qc(ut.paint_raster["raster-color"]),"raster-color-mix":new Vt(ut.paint_raster["raster-color-mix"]),"raster-color-range":new Vt(ut.paint_raster["raster-color-range"]),"raster-hue-rotate":new Vt(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vt(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vt(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Vt(ut.paint_raster["raster-saturation"]),"raster-contrast":new Vt(ut.paint_raster["raster-contrast"]),"raster-resampling":new Vt(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Vt(ut.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Vt(ut.paint_raster["raster-emissive-strength"]),"raster-array-band":new Vt(ut.paint_raster["raster-array-band"]),"raster-elevation":new Vt(ut.paint_raster["raster-elevation"]),"raster-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},a,u,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof dM&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[u,m]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(m)||u===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=Bm({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,m])}}let fM,pM,mM,gM,_M;class yM extends Wi{constructor(n,a,u,m){super(n,{layout:fM||(fM=new Yr({visibility:new Vt(ut["layout_raster-particle"].visibility)})),paint:pM||(pM=new Yr({"raster-particle-array-band":new Vt(ut["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Vt(ut["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new qc(ut["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Vt(ut["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Vt(ut["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Vt(ut["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Vt(ut["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Vt(ut["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},a,u,m),this._updateColorRamp(),this.lastInvalidatedAt=De.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Bm({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=De.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class IB extends Wi{constructor(n,a){super(n,{},a,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function o1(l,n,a){const u=[0,0,1],m=_e.quat.identity([]);return _e.quat.rotateY(m,m,a?-zt(l)+Math.PI:zt(l)),_e.quat.rotateX(m,m,-zt(n)),_e.vec3.transformQuat(u,u,m),_e.vec3.normalize(u,u)}function vM(l,n){const a=Q0(l.projection,l.zoom,l.width,l.height),u=function(h,g,b,T,P){const v=new sr(b.lng-180*lu,b.lat),E=new sr(b.lng+180*lu,b.lat),A=h.project(v.lng,v.lat),C=h.project(E.lng,E.lat),M=-Math.atan2(C.y-A.y,C.x-A.x),D=s.fromLngLat(b);D.y=Qt(D.y,-1+lu,1-lu);const k=D.toLngLat(),V=h.project(k.lng,k.lat),W=s.fromLngLat(k);W.x+=lu;const Z=W.toLngLat(),H=h.project(Z.lng,Z.lat),Q=bM(H.x-V.x,H.y-V.y,M),oe=s.fromLngLat(k);oe.y+=lu;const fe=oe.toLngLat(),Se=h.project(fe.lng,fe.lat),we=bM(Se.x-V.x,Se.y-V.y,M),xe=Math.abs(Q.x)/Math.abs(we.y),ke=_e.mat4.identity([]);_e.mat4.rotateZ(ke,ke,-M*(1-(P?0:T)));const Ce=_e.mat4.identity([]);return _e.mat4.scale(Ce,Ce,[1,1-(1-xe)*T,1]),Ce[4]=-we.x/we.y*T,_e.mat4.rotateZ(Ce,Ce,M),_e.mat4.multiply(Ce,ke,Ce),Ce}(l.projection,0,l.center,a,n),m=xM(l);return _e.mat4.scale(u,u,[m,m,1]),u}function xM(l){const n=l.projection,a=Q0(l.projection,l.zoom,l.width,l.height),u=a1(n,l.center),m=a1(n,sr.convert(n.center));return Math.pow(2,u*a+(1-a)*m)}function Q0(l,n,a,u,m=1/0){const h=l.range;if(!h)return 0;const g=Math.min(m,Math.max(a,u)),b=Math.log(g/1024)/Math.LN2;return Hn(h[0]+b,h[1]+b,n)}const lu=1/4e4;function a1(l,n){const a=Qt(n.lat,-hi,hi),u=new sr(n.lng-180*lu,a),m=new sr(n.lng+180*lu,a),h=l.project(u.lng,a),g=l.project(m.lng,a),b=s.fromLngLat(u),T=s.fromLngLat(m),P=g.x-h.x,v=g.y-h.y,E=T.x-b.x,A=T.y-b.y,C=Math.sqrt((E*E+A*A)/(P*P+v*v));return Math.log(C)/Math.LN2}function bM(l,n,a){const u=Math.cos(a),m=Math.sin(a);return{x:l*u-n*m,y:l*m+n*u}}function wM(l,n,a){_e.mat4.identity(l),_e.mat4.rotateZ(l,l,zt(n[2])),_e.mat4.rotateX(l,l,zt(n[0])),_e.mat4.rotateY(l,l,zt(n[1])),_e.mat4.scale(l,l,a),_e.mat4.multiply(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function ey(l,n,a,u,m,h,g,b){const T=[a[0]-n[0],a[1]-n[1],0],P=[u[0]-n[0],u[1]-n[1],0];if(_e.vec3.length(T)<1e-12||_e.vec3.length(P)<1e-12)return _e.quat.identity(l);const v=_e.vec3.cross([],T,P);_e.vec3.normalize(v,v),_e.vec3.subtract(P,u,n),T[2]=(h-m)*b,P[2]=(g-m)*b;const E=T;return _e.vec3.cross(E,T,P),_e.vec3.normalize(E,E),_e.quat.rotationTo(l,v,E)}function s1(l,n,a=!1){const u=Ro(n.zoom),m=function(h,g,b){const T=g.worldSize,P=[h[12],h[13],h[14]],v=to(P[1]/T),E=jo(P[0]/T),A=_e.mat4.identity([]),C=Eo(1,v)*T,M=Eo(1,0)*T*tu(v,g.zoom),D=1/mo(T);let k=M*D;if(b){const H=Q0(g.projection,g.zoom,g.width,g.height,1024);k=D*g.projection.pixelSpaceConversion(g.center.lat,T,H)}const V=rc(v,E);_e.vec3.add(V,V,_e.vec3.scale([],_e.vec3.normalize([],V),C*k*P[2]));const W=function(H){const Q=[H[0],H[1],H[2]];let oe=[0,1,0];const fe=_e.vec3.cross([],oe,Q);return _e.vec3.cross(oe,Q,fe),_e.vec3.squaredLength(oe)===0&&(oe=[0,1,0],_e.vec3.cross(fe,Q,oe)),_e.vec3.normalize(fe,fe),_e.vec3.normalize(oe,oe),_e.vec3.normalize(Q,Q),[fe[0],fe[1],fe[2],0,oe[0],oe[1],oe[2],0,Q[0],Q[1],Q[2],0,H[0],H[1],H[2],1]}(V);_e.mat4.scale(A,A,[k,k,k*C]),_e.mat4.translate(A,A,[-P[0],-P[1],-P[2]]);const Z=_e.mat4.multiply([],g.globeMatrix,W);return _e.mat4.multiply(Z,Z,A),_e.mat4.multiply(Z,Z,h),Z}(l,n,a);if(u>0){const h=function(g,b){const T=b.worldSize,P=Eo(1,0)*T*tu(b.center.lat,b.zoom)/mo(T),v=Eo(1,b.center.lat)*T,E=_e.mat4.identity([]);return _e.mat4.rotateY(E,E,zt(b.center.lng)),_e.mat4.rotateX(E,E,zt(b.center.lat)),_e.mat4.translate(E,E,[0,0,To]),_e.mat4.scale(E,E,[P,P,P*v]),_e.mat4.translate(E,E,[b.point.x-.5*T,b.point.y-.5*T,0]),_e.mat4.multiply(E,E,g),_e.mat4.multiply(E,b.globeMatrix,E)}(l,n);return function(g,b,T){const P=(M,D,k)=>{const V=_e.vec3.length(M),W=_e.vec3.length(D),Z=Oi(M,D,k);return _e.vec3.scale(Z,Z,1/_e.vec3.length(Z)*Pn(V,W,k))},v=P([g[0],g[1],g[2]],[b[0],b[1],b[2]],T),E=P([g[4],g[5],g[6]],[b[4],b[5],b[6]],T),A=P([g[8],g[9],g[10]],[b[8],b[9],b[10]],T),C=Oi([g[12],g[13],g[14]],[b[12],b[13],b[14]],T);return[v[0],v[1],v[2],0,E[0],E[1],E[2],0,A[0],A[1],A[2],0,C[0],C[1],C[2],1]}(m,h,u)}return m}function SM(l,n,a,u){const m=vn.projectAabbCorners(u,a);let h=Number.MAX_VALUE,g=-1;for(let P=0;P<m.length;++P){const v=m[P];v[0]=(.5*v[0]+.5)*n.width,v[1]=(.5-.5*v[1])*n.height,v[2]<h&&(g=P,h=v[2])}const b=P=>new je(m[P][0],m[P][1]);let T;switch(g){case 0:case 6:T=[b(1),b(5),b(4),b(7),b(3),b(2),b(1)];break;case 1:case 7:T=[b(0),b(4),b(5),b(6),b(2),b(3),b(0)];break;case 3:case 5:T=[b(1),b(0),b(4),b(7),b(6),b(2),b(1)];break;default:T=[b(1),b(5),b(6),b(7),b(3),b(0),b(1)]}if(ie(l,T))return h}const AB=gr([{name:"a_pos_3f",components:3,type:"Float32"}]),PB=gr([{name:"a_color_3f",components:3,type:"Float32"}]),OB=gr([{name:"a_color_4f",components:4,type:"Float32"}]),DB=gr([{name:"a_uv_2f",components:2,type:"Float32"}]),RB=gr([{name:"a_normal_3f",components:3,type:"Float32"}]),zB=gr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),LB=gr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),CM={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class ty{constructor(n,a,u,m){this.message=(n?`${n}: `:"")+u,m&&(this.identifier=m),a!=null&&a.__line__&&(this.line=a.__line__)}}function TM(l,n){const a=l.indexOf("://")===-1;try{return new URL(l,a&&n?"http://example.com":void 0),!0}catch{return!1}}class EM{constructor(n,a){this.feature=n,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class MM{constructor(){this.instancedDataArray=new xd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class l1{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,a){}populate(n,a,u,m){this.tileToMeter=r(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:b,index:T,sourceLayerIndex:P}of n){const v=b??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),E=j(g,h);if(!this.layers[0]._featureFilter.filter(new Br(this.zoom),E,u))continue;const A={id:v,sourceLayerIndex:P,index:T,geometry:h?E.geometry:B(g,u,m),properties:g.properties,type:g.type,patterns:{}},C=this.addFeature(A,A.geometry,E);C&&a.featureIndex.insert(g,A.geometry,T,P,this.index,this.instancesPerModel[C].instancedDataArray.length,Yt/32)}this.lookup=null}update(n,a,u,m){for(const h in this.instancesPerModel){const g=this.instancesPerModel[h];for(const b in n)g.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(g.features[g.idToFeaturesIndex[b]],n[b],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];for(const m of u.features){const h=this.layers[0],g=m.feature,b=this.canonical,T=h.paint.get("model-rotation").evaluate(g,{},b),P=h.paint.get("model-scale").evaluate(g,{},b),v=h.paint.get("model-translation").evaluate(g,{},b);_e.vec3.exactEquals(m.rotation,T)&&_e.vec3.exactEquals(m.scale,P)&&_e.vec3.exactEquals(m.translation,v)||(this.evaluate(m,m.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,a,u,m){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(Rb(this.activeReplacements,h))return!1;this.activeReplacements=h;let g=!1;for(const b in this.instancesPerModel){const T=this.instancesPerModel[b],P=T.instancedDataArray;for(const v of T.features){const E=v.instancedDataOffset,A=v.instancedDataCount;for(let C=0;C<A;C++){const M=16*(C+E);let D=P.float32[M+0];const k=D>Yt;D=k?D-Yt:D;const V=Math.floor(D),W=P.float32[M+1];let Z=!1;for(const H of this.activeReplacements)if(!VT(H,u,CM.Model,m)&&!(H.min.x>V||V>H.max.x||H.min.y>W||W>H.max.y)&&(Z=qT(WT(V,W,n.canonical,H.footprintTileId.canonical),H.footprint),Z))break;P.float32[M]=Z?D+Yt:D,g=g||Z!==k}}}return g}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,zB.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const a of this.modelUris)n.removeModel(a,"")}addFeature(n,a,u){const m=this.layers[0],h=m.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return kn(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),h;TM(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new MM);const g=this.instancesPerModel[h],b=g.instancedDataArray,T=new EM(u,b.length);for(const P of a)for(const v of P){if(v.x<0||v.x>=Yt||v.y<0||v.y>=Yt)continue;const E=(this.lookupDim-1)/Yt,A=this.lookupDim*(v.y*E|0)+v.x*E|0;if(this.lookup){if(this.lookup[A]!==0)continue;this.lookup[A]=1}this.instanceCount++;const C=b.length;b.resize(C+1),g.instancesEvaluatedElevation.push(0),b.float32[16*C]=v.x,b.float32[16*C+1]=v.y}return T.instancedDataCount=g.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(n.id&&(g.idToFeaturesIndex[n.id]=g.features.length),g.features.push(T),this.evaluate(T,{},g,!1)),h}getModelUris(){return this.modelUris}evaluate(n,a,u,m){const h=this.layers[0],g=n.feature,b=this.canonical,T=n.rotation=h.paint.get("model-rotation").evaluate(g,a,b),P=n.scale=h.paint.get("model-scale").evaluate(g,a,b),v=n.translation=h.paint.get("model-translation").evaluate(g,a,b),E=h.paint.get("model-color").evaluate(g,a,b);E.a=h.paint.get("model-color-mix-intensity").evaluate(g,a,b);const A=[];this.maxVerticalOffset<v[2]&&(this.maxVerticalOffset=v[2]),this.maxScale=Math.max(Math.max(this.maxScale,P[0]),Math.max(P[1],P[2])),wM(A,T,P);const C=Math.round(100*E.a)+E.b/1.05;for(let M=0;M<n.instancedDataCount;++M){const D=n.instancedDataOffset+M,k=16*D,V=u.instancedDataArray.float32;let W=0;m&&(W=V[k+6]-u.instancesEvaluatedElevation[D]);const Z=0|V[k+1];V[k]=(0|V[k])+E.r/1.05,V[k+1]=Z+E.g/1.05,V[k+2]=C,V[k+3]=1/(b.z>10?this.tileToMeter:r(b,Z)),V[k+4]=v[0],V[k+5]=v[1],V[k+6]=v[2]+W,V[k+7]=A[0],V[k+8]=A[1],V[k+9]=A[2],V[k+10]=A[4],V[k+11]=A[5],V[k+12]=A[6],V[k+13]=A[8],V[k+14]=A[9],V[k+15]=A[10],u.instancesEvaluatedElevation[D]=v[2]}}}let IM,AM;fn(l1,"ModelBucket",{omit:["layers"]}),fn(MM,"PerModelAttributes"),fn(EM,"ModelFeature");const Rd=64,Cf={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function PM(l,n,a,u,m,h,g,b,T,P=!1){const v=a.zoom,E=a.project(u),A=tu(u.lat,v),C=1/A;_e.mat4.identity(l),_e.mat4.translate(l,l,[E.x+g[0]*C,E.y+g[1]*C,g[2]]);let M=1,D=1;const k=a.worldSize;if(P){if(a.projection.name==="mercator"){let H=0;a.elevation&&(H=a.elevation.getAtPointOrZero(new s(E.x/k,E.y/k),0));const Q=_e.vec4.transformMat4([],[E.x,E.y,H,1],a.projMatrix)[3]/a.cameraToCenterDistance;M=Q,D=Q*tu(a.center.lat,v)}else if(a.projection.name==="globe"){const H=s1(l,a),Q=_e.mat4.multiply([],a.projMatrix,H),oe=[0,0,0,1];_e.vec4.transformMat4(oe,oe,Q);const fe=oe[3]/a.cameraToCenterDistance,Se=Ro(v),we=a.projection.pixelsPerMeter(u.lat,k)*tu(u.lat,v),xe=a.projection.pixelsPerMeter(a.center.lat,k)*tu(a.center.lat,v);M=fe/Pn(we,$m(a.center.lat),Se),D=fe*A/we,M*=xe,D*=xe}}else M=C;_e.mat4.scale(l,l,[M,M,D]);const V=[...l],W=n.orientation,Z=[];if(wM(Z,[W[0]+m[0],W[1]+m[1],W[2]+m[2]],h),_e.mat4.multiply(l,V,Z),b&&a.elevation){let H=0;const Q=[];if(T&&a.elevation){H=function(Se,we,xe,ke,Ce){const Ne=we.elevation;if(!Ne)return 0;const Ze=vn.projectAabbCorners(xe,ke),Ge=Eo(1,Ce.lat)*we.worldSize,Je=function(mn,en){const sn=[0,0,1],zn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Vn of zn){const jn=mn[Vn.corners[0]],Un=mn[Vn.corners[1]],Zn=mn[Vn.corners[2]],Yn=[Un[0]-jn[0],Un[1]-jn[1],en*(Un[2]-jn[2])],Lr=_e.vec3.cross(Yn,Yn,[Zn[0]-jn[0],Zn[1]-jn[1],en*(Zn[2]-jn[2])]);_e.vec3.normalize(Lr,Lr),Vn.dotProductWithUp=_e.vec3.dot(Lr,sn)}return zn.sort((Vn,jn)=>Vn.dotProductWithUp-jn.dotProductWithUp),zn[0].corners}(Ze,Ge),rt=Ze[Je[0]],lt=Ze[Je[1]],nt=Ze[Je[2]],xt=Ze[Je[3]],Dt=Ne.getAtPointOrZero(new s(rt[0]/we.worldSize,rt[1]/we.worldSize),0),vt=Ne.getAtPointOrZero(new s(lt[0]/we.worldSize,lt[1]/we.worldSize),0),Jt=Ne.getAtPointOrZero(new s(nt[0]/we.worldSize,nt[1]/we.worldSize),0),Zt=Ne.getAtPointOrZero(new s(xt[0]/we.worldSize,xt[1]/we.worldSize),0),kt=(Dt+Zt)/2,Rt=(vt+Jt)/2;return kt>Rt?vt<Jt?ey(Se,lt,xt,rt,vt,Zt,Dt,Ge):ey(Se,nt,rt,xt,Jt,Dt,Zt,Ge):Dt<Zt?ey(Se,rt,lt,nt,Dt,vt,Jt,Ge):ey(Se,xt,nt,lt,Zt,Jt,vt,Ge),Math.max(kt,Rt)}(Q,a,n.aabb,l,u);const oe=_e.mat4.fromQuat([],Q),fe=_e.mat4.multiply([],oe,Z);_e.mat4.multiply(l,V,fe)}else H=a.elevation.getAtPointOrZero(new s(E.x/k,E.y/k),0);H!==0&&(l[14]+=H)}}function og(l,n,a=!1){l.uploaded||(l.gfxTexture=new i1(n,l.image,a?n.gl.R8:n.gl.RGBA8,{useMipmap:l.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function $B(l,n,a){l.indexBuffer=n.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=n.createVertexBuffer(l.vertexArray,AB.members,!1,!0),l.normalArray&&(l.normalBuffer=n.createVertexBuffer(l.normalArray,RB.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=n.createVertexBuffer(l.texcoordArray,DB.members,!1,!0)),l.colorArray&&(l.colorBuffer=n.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?PB:OB).members,!1,!0)),l.featureArray&&(l.pbrBuffer=n.createVertexBuffer(l.featureArray,LB.members,!0)),l.segments=di.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const u=l.material;u.pbrMetallicRoughness.baseColorTexture&&og(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&og(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&og(u.normalTexture,n),u.occlusionTexture&&og(u.occlusionTexture,n,a),u.emissionTexture&&og(u.emissionTexture,n)}function c1(l,n,a){if(l.meshes)for(const u of l.meshes)$B(u,n,a);if(l.children)for(const u of l.children)c1(u,n,a)}function ny(l){if(l.meshes)for(const n of l.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(l.children)for(const n of l.children)ny(n)}function u1(l){if(l.meshes)for(const a of l.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((n=a.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(l.children)for(const a of l.children)u1(a)}class Tf{constructor(n,a,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(n,a,u){const m=u||n.findDEMTileFor(a);if(!m||!m.dem)return;const h=m.dem,g=m.tileID,b=1<<a.canonical.z-g.canonical.z;return new Tf(m,h.dim/Yt/b,[(a.canonical.x/b-g.canonical.x)*h.dim,(a.canonical.y/b-g.canonical.y)*h.dim])}tileCoordToPixel(n,a){const u=a*this._scale+this._offset[1],m=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new je(m,h)}getElevationAt(n,a,u,m){const h=n*this._scale+this._offset[0],g=a*this._scale+this._offset[1],b=Math.floor(h),T=Math.floor(g),P=this._dem;return m=!!m,u?Pn(Pn(P.get(b,T,m),P.get(b,T+1,m),g-T),Pn(P.get(b+1,T,m),P.get(b+1,T+1,m),g-T),h-b):P.get(b,T,m)}getElevationAtPixel(n,a,u){return this._dem.get(n,a,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Eo(1,n)*this._dem.stride}}const d1=new Float32Array(262144),zd=new Uint8Array(262144);function OM(l){let n=0;if(l.meshes)for(const a of l.meshes)n=Math.max(n,a.aabb.max[2]);if(l.children)for(const a of l.children)n=Math.max(n,OM(a));return n}function DM(l,n,a){if(l.meshes)for(const u of l.meshes){if(u.aabb.min[0]===1/0)continue;const m=vn.applyTransform(u.aabb,l.matrix);a.insert(n,m.min[0],m.min[1],m.max[0],m.max[1])}if(l.children)for(const u of l.children)DM(u,n,a)}const RM=["","wall","door","roof","window","lamp","logo"];class zM{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:OM(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const a=new vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=vn.applyTransformFast(u.aabb,this.node.matrix),a.encapsulate(u.transformedAabb)),n++;this.aabb=a}return this.aabb}}class ry{constructor(n,a,u,m,h,g,b){this.id=u,this.layers=n,this.layerIds=this.layers.map(T=>T.fqid),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.modelTraits|=Cf.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=Cf.HasMapboxMeshFeatures),h&&(this.modelTraits|=Cf.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const T of a)this.nodesInfo.push(new zM(T)),DM(T,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,a){for(const u of this.getNodesInfo()){const m=u.node;m.footprint&&a.push({footprint:m.footprint,id:n})}}update(n){const a=Object.keys(n).length!==0;if(a&&!this.stateDependentLayers.length)return;const u=a?this.stateDependentLayers:this.layers;if(!Mt(n,this.states))for(const m of u)this.evaluate(m,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const u of a){const m=u.node;this.uploaded?this.updatePbrBuffer(m):c1(m,n,!0)}for(const u of a)ny(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let a=!1;if(!n.meshes)return a;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),a=!0);return a}needsReEvaluation(n,a,u){const m=n.transform.projectionOptions,h=n.style.getBrightness(),g=this.brightness!==h;if(!this.uploaded||this.dirty||m.name!==this.projection.name||ag(u.paint.get("model-color").value,g)||ag(u.paint.get("model-color-mix-intensity").value,g)||ag(u.paint.get("model-roughness").value,g)||ag(u.paint.get("model-emissive-strength").value,g)||ag(u.paint.get("model-height-based-emissive-strength-multiplier").value,g)){this.projection=m,this.brightness=h;const b=this.getNodesInfo();for(const T of b)T.state=null;return!0}return!1}evaluateScale(n,a){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),m=this.id.canonical;for(const h of u){const g=h.feature;h.evaluatedScale=a.paint.get("model-scale").evaluate(g,{},m)}}evaluate(n,a){const u=this.getNodesInfo();for(const m of u){if(!m.node.meshes)continue;const h=m.feature,g=a&&a[h.id];if(Mt(g,m.state))continue;m.state=structuredClone(g);const b=m.node.meshes&&m.node.meshes[0].featureData,T=m.evaluatedColor[2],P=m.evaluatedRMEA[2],v=this.id.canonical;if(m.hasTranslucentParts=!1,b){for(let E=0;E<RM.length;E++){const A=RM[E];A.length&&(h.properties.part=A);const C=n.paint.get("model-color").evaluate(h,g,v).toRenderColor(null),M=n.paint.get("model-color-mix-intensity").evaluate(h,g,v);m.evaluatedColor[E]=[C.r,C.g,C.b,M],m.evaluatedRMEA[E][0]=n.paint.get("model-roughness").evaluate(h,g,v),m.evaluatedRMEA[E][2]=n.paint.get("model-emissive-strength").evaluate(h,g,v),m.evaluatedRMEA[E][3]=C.a,m.emissionHeightBasedParams[E]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,g,v),!m.hasTranslucentParts&&C.a<1&&(m.hasTranslucentParts=!0)}delete h.properties.part,BB(m,T!==m.evaluatedColor[2]||P!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(h,g,v);m.evaluatedScale=n.paint.get("model-scale").evaluate(h,g,v),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,a,u,m){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const g=Tf.create(n,u,h);if(!g)return;this.modelTraits&Cf.HasMapboxMeshFeatures&&this.updateDEM(n,g,u,m);for(const b of this.getNodesInfo()){const T=b.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const P=T.footprint.vertices;let v=g.getElevationAt(P[0].x,P[0].y,!0,!0);for(let E=1;E<P.length;E++)v=Math.min(v,g.getElevationAt(P[E].x,P[E].y,!0,!0));T.elevation=v}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=a}}updateDEM(n,a,u,m){let h=a._dem._modifiedForSources[m];if(h===void 0&&(a._dem._modifiedForSources[m]=[],h=a._dem._modifiedForSources[m]),h.includes(u.canonical))return;const g=a._dem.dim;h.push(u.canonical);let b=!1;for(const T of this.getNodesInfo()){const P=T.node;if(!P.footprint||!P.footprint.grid)continue;const v=P.footprint.grid,E=a.tileCoordToPixel(v.min.x,v.min.y),A=a.tileCoordToPixel(v.max.x,v.max.y),C=Math.min(Math.min(g-A.y,E.x),Math.min(E.y,g-A.x));if(C<0)continue;const M=Qt(C,2,5);let D=Math.max(0,E.x-M),k=Math.max(0,E.y-M),V=Math.min(A.x+M,g-1),W=Math.min(A.y+M,g-1);for(let oe=k;oe<=W;++oe)for(let fe=D;fe<=V;++fe)zd[oe*g+fe]=255;let Z=0,H=0;for(let oe=0;oe<v.cellsY;++oe)for(let fe=0;fe<v.cellsX;++fe){if(!v.cells[oe*v.cellsX+fe])continue;const Se=a.tileCoordToPixel(v.min.x+fe/v.xScale,v.min.y+oe/v.yScale),we=a.tileCoordToPixel(v.min.x+(fe+1)/v.xScale,v.min.y+(oe+1)/v.yScale);for(let xe=Se.y;xe<=Math.min(we.y+1,g-1);++xe)for(let ke=Se.x;ke<=Math.min(we.x+1,g-1);++ke)zd[xe*g+ke]===255&&(zd[xe*g+ke]=0,Z+=a.getElevationAtPixel(ke,xe),H++)}const Q=Z/H;D=Math.max(1,E.x-M),k=Math.max(1,E.y-M),V=Math.min(A.x+M,g-2),W=Math.min(A.y+M,g-2),b=!0;for(let oe=k;oe<=W;++oe)for(let fe=D;fe<=V;++fe)zd[oe*g+fe]===0&&(d1[oe*g+fe]=a._dem.set(fe,oe,Q));for(let oe=1;oe<M;++oe){D=Math.max(1,E.x-oe),k=Math.max(1,E.y-oe),V=Math.min(A.x+oe,g-2),W=Math.min(A.y+oe,g-2);for(let fe=k;fe<=W;++fe)for(let Se=D;Se<=V;++Se){const we=fe*g+Se;if(zd[we]===255){let xe=0,ke=0,Ce=-1,Ne=-1;for(let Ze=-1;Ze<=1;++Ze)for(let Ge=-1;Ge<=1;++Ge){const Je=(fe+Ze)*g+Se+Ge;if(zd[Je]>=oe)continue;const rt=d1[Je],lt=Math.abs(rt);lt>ke&&(xe=rt,ke=lt,Ce=Ge,Ne=Ze)}if(ke>.1){const Ze=1-(oe+.5*Math.abs(Ce*Ne))/M;let Ge=a._dem.get(Se,fe)+xe*Ze;const Je=a._dem.get(Se+Ce,fe+Ne),rt=a._dem.get(Se-Ce,fe-Ne,!0);(Ge-Je)*(Ge-rt)>0&&(Ge=(Je+rt)/2),d1[we]=a._dem.set(Se,fe,Ge),zd[we]=oe}}}}}b&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=De.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const a of n)ny(a.node),u1(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped()),m=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const g=m[h].node;m[h].hiddenByReplacement=!!g.footprint&&!u.find(b=>b.footprint===g.footprint)}}getHeightAtTileCoord(n,a){const u=this.getNodesInfo(),m=[],h=[0,0,0],g=_e.mat4.identity([]);for(let b=0;b<this.nodesInfo.length;b++){const T=u[b],P=T.node.meshes[0],v=P.transformedAabb;if(n<v.min[0]||a<v.min[1]||n>v.max[0]||a>v.max[1])continue;if(T.node.hidden===!0)return{height:1/0,maxHeight:T.feature.properties.height,hidden:!1,verticalScale:T.evaluatedScale[2]};_e.mat4.invert(g,T.node.matrix),h[0]=n,h[1]=a,_e.vec3.transformMat4(h,h,g);const E=(h[0]-P.aabb.min[0])/(P.aabb.max[0]-P.aabb.min[0])*Rd|0,A=Math.min(63,(h[1]-P.aabb.min[1])/(P.aabb.max[1]-P.aabb.min[1])*Rd|0)*Rd+Math.min(63,E),C=P.heightmap[A];if(!(C<0&&T.node.footprint))return T.hiddenByReplacement?void 0:{height:C,maxHeight:T.feature.properties.height,hidden:!1,verticalScale:T.evaluatedScale[2]};if(T.node.footprint.grid.query(new je(n,a),new je(n,a),m),m.length>0)return{height:void 0,maxHeight:T.feature.properties.height,hidden:T.hiddenByReplacement,verticalScale:T.evaluatedScale[2]}}}}function ag(l,n){return!l.isLightConstant&&n}function FB(l,n,a,u,m,h,g,b){let T=(61440&n|(61440&n)>>4)>>8,P=(3840&n|(3840&n)>>4)>>4,v=240&n|(240&n)>>4;a[3]>0&&(T=Pn(T,255*a[0],a[3]),P=Pn(P,255*a[1],a[3]),v=Pn(v,255*a[2],a[3]));const E=T<<8|P,A=v<<8|Math.floor(255*u[3]),C=function(oe){const fe=Qt(oe,0,2);return Math.min(Math.round(.5*fe*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],M=Qt(m[0],0,1),D=Qt(m[1],0,1),k=Qt(m[2],0,1),V=Qt(m[3],0,1);let W,Z,H,Q;if(M!==D&&g!==h&&D!==M){const oe=g-h;Z=1/(oe*(D-M)),H=-(h+oe*M)/(oe*(D-M));const fe=Qt(m[4],-1,1);Q=Math.pow(10,fe),W=255*k<<8|255*V}else W=65535,Z=0,H=1,Q=1;if(l.emplaceBack(E,A,C,W,Z,H,Q),b){const oe=b.length;b.clear();for(let fe=0;fe<oe;fe++)b.emplaceBack(E,A,C,W,Z,H,Q)}}function BB(l,n,a){const u=l.node;let m=0;const h=a&Cf.HasMeshoptCompression;for(const g of u.meshes){if(u.lights&&u.lightMeshIndex===m||!g.featureData)continue;g.featureArray=new bd,g.featureArray.reserve(g.featureData.length);let b=n;for(const T of g.featureData){const P=h?65535&T:T>>16&65535,v=h?T>>16&65535:65535&T,E=(15&v)<8?15&v:0,A=l.evaluatedRMEA[E],C=l.evaluatedColor[E],M=l.emissionHeightBasedParams[E];let D;if(b&&E===2&&u.lights&&(D=new bd,D.resize(10*u.lights.length)),FB(g.featureArray,P,C,A,M,g.aabb.min[2],g.aabb.max[2],D),D&&b){b=!1;const k=u.meshes[u.lightMeshIndex];k.featureArray=D,k.featureArray._trim()}}g.featureArray._trim(),m++}}function LM(l,n,a,u){const m=1<<l.z;n.lat=to((u/Yt+l.y)/m),n.lng=jo((a/Yt+l.x)/m)}fn(ry,"Tiled3dModelBucket",{omit:["layers"]}),fn(zM,"Tiled3dModelFeature");const kB={circle:class extends Wi{constructor(l,n,a,u){super(l,{layout:$t||($t=new Yr({"circle-sort-key":new on(ut.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Vt(ut.layout_circle["circle-elevation-reference"]),visibility:new Vt(ut.layout_circle.visibility)})),paint:ot||(ot=new Yr({"circle-radius":new on(ut.paint_circle["circle-radius"]),"circle-color":new on(ut.paint_circle["circle-color"]),"circle-blur":new on(ut.paint_circle["circle-blur"]),"circle-opacity":new on(ut.paint_circle["circle-opacity"]),"circle-translate":new Vt(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Vt(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vt(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vt(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new on(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new on(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new on(ut.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Vt(ut.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u)}createBucket(l){return new ce(l)}queryRadius(l){const n=l;return St("circle-radius",this,n)+St("circle-stroke-width",this,n)+bt(this.paint.get("circle-translate"))}queryIntersectsFeature(l,n,a,u,m,h,g,b){const T=_t(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a);return gf(l,u,h,g,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,P)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,n,a){const u=nu(this);return{config:new nc(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}},heatmap:class extends Wi{createBucket(l){return new fT(l)}constructor(l,n,a,u){super(l,{layout:pT||(pT=new Yr({visibility:new Vt(ut.layout_heatmap.visibility)})),paint:mT||(mT=new Yr({"heatmap-radius":new on(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new on(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vt(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qc(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vt(ut.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Bm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return St("heatmap-radius",this,l)}queryIntersectsFeature(l,n,a,u,m,h,g,b){const T=this.paint.get("heatmap-radius").evaluate(n,a);return gf(l,u,h,g,b,!0,!0,new je(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,n,a){return l==="heatmap"?{config:new nc(this,{zoom:n,lut:a}),overrideFog:!1}:{}}},hillshade:class extends Wi{constructor(l,n,a,u){super(l,{layout:gT||(gT=new Yr({visibility:new Vt(ut.layout_hillshade.visibility)})),paint:_T||(_T=new Yr({"hillshade-illumination-direction":new Vt(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Vt(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vt(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vt(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vt(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vt(ut.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Vt(ut.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,n,a){return{overrideFog:!1}}},fill:class extends Wi{constructor(l,n,a,u){super(l,{layout:ET||(ET=new Yr({"fill-sort-key":new on(ut.layout_fill["fill-sort-key"]),visibility:new Vt(ut.layout_fill.visibility),"fill-elevation-reference":new Vt(ut.layout_fill["fill-elevation-reference"])})),paint:MT||(MT=new Yr({"fill-antialias":new Vt(ut.paint_fill["fill-antialias"]),"fill-opacity":new on(ut.paint_fill["fill-opacity"]),"fill-color":new on(ut.paint_fill["fill-color"]),"fill-outline-color":new on(ut.paint_fill["fill-outline-color"]),"fill-translate":new Vt(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Vt(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new on(ut.paint_fill["fill-pattern"]),"fill-emissive-strength":new Vt(ut.paint_fill["fill-emissive-strength"]),"fill-z-offset":new on(ut.paint_fill["fill-z-offset"]),"fill-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u)}getProgramIds(){const l=this.paint.get("fill-pattern"),n=l&&l.constantOr(1),a=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(l,n,a){return{config:new nc(this,{zoom:n,lut:a}),overrideFog:!1}}recalculate(l,n){super.recalculate(l,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new Mb(l)}queryRadius(){return bt(this.paint.get("fill-translate"))}queryIntersectsFeature(l,n,a,u,m,h){return!l.queryGeometry.isAboveHorizon&&de(st(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Wi{constructor(l,n,a,u){super(l,{layout:lE||(lE=new Yr({visibility:new Vt(ut["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Vt(ut["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:cE||(cE=new Yr({"fill-extrusion-opacity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new on(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new on(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new on(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new on(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new on(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new on(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new on(ut["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new on(ut["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new z0(l)}queryRadius(){return bt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,n,a,u,m,h,g,b,T){const P=_t(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),v=this.paint.get("fill-extrusion-height").evaluate(n,a),E=this.paint.get("fill-extrusion-base").evaluate(n,a),A=[0,0],C=b&&h.elevation,M=h.elevation?h.elevation.exaggeration():1,D=l.tile.getBucket(this);if(C&&D instanceof z0){const H=D.centroidVertexArray,Q=T+1;Q<H.length&&(A[0]=H.geta_centroid_pos0(Q),A[1]=H.geta_centroid_pos1(Q))}if(A[0]===0&&A[1]===1)return!1;h.projection.name==="globe"&&(u=sE([u],[new je(0,0),new je(Yt,Yt)],l.tileID.canonical).map(H=>H.polygon).flat());const k=C?b:null,[V,W]=function(H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze){return H.projection.name==="globe"?function(Ge,Je,rt,lt,nt,xt,Dt,vt,Jt,Zt,kt){const Rt=[],mn=[],en=Ge.projection.upVectorScale(kt,Ge.center.lat,Ge.worldSize).metersToTile,sn=[0,0,0,1],zn=[0,0,0,1],Vn=(Un,Zn,Yn,Lr)=>{Un[0]=Zn,Un[1]=Yn,Un[2]=Lr,Un[3]=1},jn=aE();rt>0&&(rt+=jn),lt+=jn;for(const Un of Je){const Zn=[],Yn=[];for(const Lr of Un){const Mr=Lr.x+nt.x,Fn=Lr.y+nt.y,Sr=Ge.projection.projectTilePoint(Mr,Fn,kt),Er=Ge.projection.upVector(kt,Lr.x,Lr.y);let Hr=rt,_i=lt;if(Dt){const Ri=dE(Mr,Fn,rt,lt,Dt,vt,Jt,Zt);Hr+=Ri.base,_i+=Ri.top}rt!==0?Vn(sn,Sr.x+Er[0]*en*Hr,Sr.y+Er[1]*en*Hr,Sr.z+Er[2]*en*Hr):Vn(sn,Sr.x,Sr.y,Sr.z),Vn(zn,Sr.x+Er[0]*en*_i,Sr.y+Er[1]*en*_i,Sr.z+Er[2]*en*_i),_e.vec3.transformMat4(sn,sn,xt),_e.vec3.transformMat4(zn,zn,xt),Zn.push(new Dd(sn[0],sn[1],sn[2])),Yn.push(new Dd(zn[0],zn[1],zn[2]))}Rt.push(Zn),mn.push(Yn)}return[Rt,mn]}(H,Q,oe,fe,Se,we,xe,ke,Ce,Ne,Ze):xe?function(Ge,Je,rt,lt,nt,xt,Dt,vt,Jt){const Zt=[],kt=[],Rt=[0,0,0,1];for(const mn of Ge){const en=[],sn=[];for(const zn of mn){const Vn=zn.x+lt.x,jn=zn.y+lt.y,Un=dE(Vn,jn,Je,rt,xt,Dt,vt,Jt);Rt[0]=Vn,Rt[1]=jn,Rt[2]=Un.base,Rt[3]=1,_e.vec4.transformMat4(Rt,Rt,nt),Rt[3]=Math.max(Rt[3],1e-5);const Zn=new Dd(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=Vn,Rt[1]=jn,Rt[2]=Un.top,Rt[3]=1,_e.vec4.transformMat4(Rt,Rt,nt),Rt[3]=Math.max(Rt[3],1e-5);const Yn=new Dd(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);en.push(Zn),sn.push(Yn)}Zt.push(en),kt.push(sn)}return[Zt,kt]}(Q,oe,fe,Se,we,xe,ke,Ce,Ne):function(Ge,Je,rt,lt,nt){const xt=[],Dt=[],vt=nt[8]*Je,Jt=nt[9]*Je,Zt=nt[10]*Je,kt=nt[11]*Je,Rt=nt[8]*rt,mn=nt[9]*rt,en=nt[10]*rt,sn=nt[11]*rt;for(const zn of Ge){const Vn=[],jn=[];for(const Un of zn){const Zn=Un.x+lt.x,Yn=Un.y+lt.y,Lr=nt[0]*Zn+nt[4]*Yn+nt[12],Mr=nt[1]*Zn+nt[5]*Yn+nt[13],Fn=nt[2]*Zn+nt[6]*Yn+nt[14],Sr=nt[3]*Zn+nt[7]*Yn+nt[15],Er=Lr+vt,Hr=Mr+Jt,_i=Fn+Zt,Ri=Math.max(Sr+kt,1e-5),yi=Lr+Rt,ii=Mr+mn,Si=Fn+en,$i=Math.max(Sr+sn,1e-5);Vn.push(new Dd(Er/Ri,Hr/Ri,_i/Ri)),jn.push(new Dd(yi/$i,ii/$i,Si/$i))}xt.push(Vn),Dt.push(jn)}return[xt,Dt]}(Q,oe,fe,Se,we)}(h,u,E,v,P,g,k,A,M,h.center.lat,l.tileID.canonical),Z=l.queryGeometry;return function(H,Q,oe){let fe=1/0;de(oe,Q)&&(fe=uE(oe,Q[0]));for(let Se=0;Se<Q.length;Se++){const we=Q[Se],xe=H[Se];for(let ke=0;ke<we.length-1;ke++){const Ce=we[ke],Ne=[Ce,we[ke+1],xe[ke+1],xe[ke],Ce];ie(oe,Ne)&&(fe=Math.min(fe,uE(oe,Ne)))}}return fe!==1/0&&fe}(V,W,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends Wi{constructor(l,n,a,u){const m=bE();super(l,m,n,a,u),m.layout&&(this.layout=new Wc(m.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof $c,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,n){super.recalculate(l,n),this.paint._values["line-floorwidth"]=(()=>{if(qm)return qm;const a=bE();return qm=new jF(a.paint.properties["line-width"].specification),qm.useIntegerZoom=!0,qm})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Fb(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,n,a){const u=vE(this);return{config:new nc(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}queryRadius(l){const n=l,a=wE(St("line-width",this,n),St("line-gap-width",this,n)),u=St("line-offset",this,n);return a/2+Math.abs(u)+bt(this.paint.get("line-translate"))}queryIntersectsFeature(l,n,a,u,m,h){if(l.queryGeometry.isAboveHorizon)return!1;const g=st(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),b=l.pixelToTileUnitsFactor/2*wE(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),T=this.paint.get("line-offset").evaluate(n,a);return T&&(u=function(P,v){const E=[],A=new je(0,0);for(let C=0;C<P.length;C++){const M=P[C],D=[];for(let k=0;k<M.length;k++){const V=M[k],W=M[k+1],Z=k===0?A:V.sub(M[k-1])._unit()._perp(),H=k===M.length-1?A:W.sub(V)._unit()._perp(),Q=Z._add(H)._unit();Q._mult(1/(Q.x*H.x+Q.y*H.y)),D.push(Q._mult(v)._add(V))}E.push(D)}return E}(u,T*l.pixelToTileUnitsFactor)),function(P,v,E){for(let A=0;A<v.length;A++){const C=v[A];if(P.length>=3){for(let M=0;M<C.length;M++)if(Ae(P,C[M]))return!0}if(ve(P,C,E))return!0}return!1}(g,u,b)}isTileClipped(){return!0}isDraped(l){return!this.hasElevatedBuckets}},symbol:Y0,background:class extends Wi{constructor(l,n,a,u){super(l,{layout:aM||(aM=new Yr({visibility:new Vt(ut.layout_background.visibility)})),paint:sM||(sM=new Yr({"background-pitch-alignment":new Vt(ut.paint_background["background-pitch-alignment"]),"background-color":new Vt(ut.paint_background["background-color"]),"background-pattern":new Vt(ut.paint_background["background-pattern"]),"background-opacity":new Vt(ut.paint_background["background-opacity"]),"background-emissive-strength":new Vt(ut.paint_background["background-emissive-strength"]),"background-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,n,a){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:hM,"raster-particle":yM,sky:class extends Wi{constructor(l,n,a,u){super(l,{layout:mM||(mM=new Yr({visibility:new Vt(ut.layout_sky.visibility)})),paint:gM||(gM=new Yr({"sky-type":new Vt(ut.paint_sky["sky-type"]),"sky-atmosphere-sun":new Vt(ut.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Vt(ut.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Vt(ut.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Vt(ut.paint_sky["sky-gradient-radius"]),"sky-gradient":new qc(ut.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Vt(ut.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Vt(ut.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Vt(ut.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Bm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(l,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),m=!u,h=l.style.light,g=h.properties.get("position");return m&&h.properties.get("anchor")==="viewport"&&kn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?o1(g.azimuthal,90-g.polar,n):o1(u[0],90-u[1],n)}const a=this.paint.get("sky-gradient-center");return o1(a[0],90-a[1],n)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends Wi{constructor(l,n,a,u){super(l,{paint:_M||(_M=new Yr({}))},n,null)}},model:class extends Wi{constructor(l,n,a,u){super(l,{layout:IM||(IM=new Yr({visibility:new Vt(ut.layout_model.visibility),"model-id":new on(ut.layout_model["model-id"])})),paint:AM||(AM=new Yr({"model-opacity":new on(ut.paint_model["model-opacity"]),"model-rotation":new on(ut.paint_model["model-rotation"]),"model-scale":new on(ut.paint_model["model-scale"]),"model-translation":new on(ut.paint_model["model-translation"]),"model-color":new on(ut.paint_model["model-color"]),"model-color-mix-intensity":new on(ut.paint_model["model-color-mix-intensity"]),"model-type":new Vt(ut.paint_model["model-type"]),"model-cast-shadows":new Vt(ut.paint_model["model-cast-shadows"]),"model-receive-shadows":new Vt(ut.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Vt(ut.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new on(ut.paint_model["model-emissive-strength"]),"model-roughness":new on(ut.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new on(ut.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Vt(ut.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Vt(ut.paint_model["model-front-cutoff"]),"model-color-use-theme":new on({type:"string",default:"default","property-type":"data-driven"})}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new l1(l)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof ry?Yt-1:0}queryIntersectsFeature(l,n,a,u,m,h){if(!this.modelManager)return!1;const g=this.modelManager,b=l.tile.getBucket(this);if(!(b&&b instanceof l1))return!1;for(const T in b.instancesPerModel){const P=b.instancesPerModel[T],v=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(P.idToFeaturesIndex.hasOwnProperty(v)){const E=P.features[P.idToFeaturesIndex[v]],A=g.getModel(T,this.scope);if(!A)return!1;let C=_e.mat4.create();const M=new sr(0,0),D=b.canonical;let k=Number.MAX_VALUE;for(let V=0;V<E.instancedDataCount;++V){const W=16*(E.instancedDataOffset+V),Z=P.instancedDataArray.float32,H=[Z[W+4],Z[W+5],Z[W+6]];LM(D,M,Z[W],0|Z[W+1]),PM(C,A,h,M,E.rotation,E.scale,H,!1,!1,!1),h.projection.name==="globe"&&(C=s1(C,h));const Q=_e.mat4.multiply([],h.projMatrix,C),oe=l.queryGeometry,fe=SM(oe.isPointQuery()?oe.screenBounds:oe.screenGeometry,h,Q,A.aabb);fe!=null&&(k=Math.min(fe,k))}return k!==Number.MAX_VALUE&&k}}return!1}_handleOverridablePaintPropertyUpdate(l,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const n=this._transitionablePaint._values[l];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof cd}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Wi{constructor(l,n,a,u){super(l,{layout:IT||(IT=new Yr({"clip-layer-types":new Vt(ut.layout_clip["clip-layer-types"]),"clip-layer-scope":new Vt(ut.layout_clip["clip-layer-scope"])})),paint:AT||(AT=new Yr({}))},n,a,u)}recalculate(l,n){super.recalculate(l,n)}createBucket(l){return new PT(l)}isTileClipped(){return!0}is3D(){return!0}}};class NB{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class VB{constructor(){this.tasks={},this.taskQueue=[],Xi(["process"],this),this.invoker=new NB(this.process),this.nextId=0}add(n,a){const u=this.nextId++,m=function({type:h,isSymbolTile:g,zoom:b}){return b=b||0,h==="message"?0:h!=="maybePrepare"||g?h!=="parseTile"||g?h==="parseTile"&&g?300-b:h==="maybePrepare"&&g?400-b:500:200-b:100-b}(a);if(m===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:a,priority:m,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const a=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let n=null,a=1/0;for(let m=0;m<this.taskQueue.length;m++){const h=this.tasks[this.taskQueue[m]];h.priority<a&&(a=h.priority,n=m)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class $M{constructor(n,a,u){this.target=n,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Xi(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new VB}send(n,a,u,m,h=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=g,this.callbacks[b]=u);const T=new Set;return this.target.postMessage({id:b,type:n,hasCallback:!!u,targetMapId:m,mustQueue:h,sourceMapId:this.mapId,data:ol(a,T)},T),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(n){const a=n.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m.cancel()}else if(a.mustQueue||Ua()){const m=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,a),m&&m.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,a)}processTask(n,a){if(delete this.cancelCallbacks[n],a.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(a.error?u(Kl(a.error)):u(null,Kl(a.data)))}else{const u=new Set,m=a.hasCallback?(g,b)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:g?ol(g):null,data:ol(b,u)},u)}:()=>{},h=Kl(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,h,m);else if(this.parent.getWorkerSource){const g=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,g[0],h.source,h.scope)[g[1]](h,m)}else m(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var sg={workerUrl:"",workerClass:null,workerParams:void 0};const h1="mapboxgl_preloaded_worker_pool";class Ld{constructor(){this.active={}}acquire(n,a=Ld.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<a;)this.workers.push(sg.workerClass!=null?new sg.workerClass:new self.Worker(sg.workerUrl,sg.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[h1]}numActive(){return Object.keys(this.active).length}}Ld.workerCount=2;class Ef{constructor(n,a,u="Worker",m=Ld.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=xi();const h=this.workerPool.acquire(this.id,m);for(let g=0;g<h.length;g++){const b=new Ef.Actor(h[g],a,this.id);b.name=`${u} ${g}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,a,u){Pr(this.actors,(m,h)=>{m.send(n,a,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let lg,f1;function iy(){return lg||(lg=new Ld),lg}Ef.Actor=$M;const p1=new mr(0,0,0);var m1=(l=>(l[l.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",l[l.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",l[l.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",l))(m1||{}),oy=(l=>(l[l.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",l[l.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",l[l.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",l[l.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",l))(oy||{}),cg=(l=>(l[l.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",l[l.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",l[l.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",l[l.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",l[l.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",l))(cg||{}),FM=(l=>(l[l.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",l[l.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",l[l.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",l))(FM||{}),Mf=(l=>(l[l.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",l[l.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",l[l.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",l[l.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",l[l.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",l[l.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",l))(Mf||{}),BM=(l=>(l[l.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",l[l.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",l[l.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",l))(BM||{});function jB(l,n,a){l===1&&n.icons.push(function(u,m){return function(h){if(h.usvg_tree.height||(h.usvg_tree.height=h.usvg_tree.width),!h.metadata)return h;const{metadata:g}=h;if(g.content_area){const{content_area:b}=g;b.top==null&&(b.top=b.left),b.width==null&&(b.width=h.usvg_tree.width),b.height==null&&(b.height=b.width)}return g.stretch_x&&g.stretch_x.length&&kM(g,"x"),g.stretch_y&&g.stretch_y.length&&kM(g,"y"),h}(u.readFields(UB,{name:void 0},m))}(a,a.readVarint()+a.pos))}function kM(l,n){const a=[],u=l[`stretch_${n}`];let m=null;for(let h=0;h<u.length;h++)m===null?m=a.length===0?u[0]:a[a.length-1][1]+u[h]:(a.push([m,m+u[h]]),m=null);l[`stretch_${n}_areas`]=a}function UB(l,n,a){l===1?n.name=a.readString():l===2?n.metadata=function(u,m){return u.readFields(HB,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},m)}(a,a.readVarint()+a.pos):l===3&&(n.usvg_tree=function(u,m){return u.readFields(qB,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},m)}(a,a.readVarint()+a.pos),n.data="usvg_tree")}function HB(l,n,a){l===1?n.stretch_x=a.readPackedVarint():l===2?n.stretch_y=a.readPackedVarint():l===3?n.content_area=function(u,m){return u.readFields(GB,{left:0},m)}(a,a.readVarint()+a.pos):l===4&&n.variables.push(function(u,m){return u.readFields(WB,{name:void 0},m)}(a,a.readVarint()+a.pos))}function GB(l,n,a){l===1?n.left=a.readVarint():l===2?n.width=a.readVarint():l===3?n.top=a.readVarint():l===4&&(n.height=a.readVarint())}function WB(l,n,a){l===1?n.name=a.readString():l===2&&(n.rgb_color=ly(a.readVarint()),n.value="rgb_color")}function qB(l,n,a){l===1?n.width=n.height=a.readVarint():l===2?n.height=a.readVarint():l===3?n.children.push(ay(a,a.readVarint()+a.pos)):l===4?n.linear_gradients.push(function(u,m){return u.readFields(e5,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},m)}(a,a.readVarint()+a.pos)):l===5?n.radial_gradients.push(function(u,m){return u.readFields(n5,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},m)}(a,a.readVarint()+a.pos)):l===7?n.clip_paths.push(function(u,m){return u.readFields(r5,{children:[]},m)}(a,a.readVarint()+a.pos)):l===8&&n.masks.push(function(u,m){const h=u.readFields(i5,{left:0,width:20,mask_type:1,children:[]},m);return h.height==null&&(h.height=h.width),h.top==null&&(h.top=h.left),h}(a,a.readVarint()+a.pos))}function ay(l,n){return l.readFields(ZB,{},n)}function ZB(l,n,a){l===1?(n.group=function(u,m){return u.readFields(YB,{opacity:255,children:[]},m)}(a,a.readVarint()+a.pos),n.node="group"):l===2&&(n.path=function(u,m){return u.readFields(KB,{paint_order:1,commands:[],step:1,diffs:[],rule:1},m)}(a,a.readVarint()+a.pos),n.node="path")}function YB(l,n,a){l===1?n.transform=sy(a,a.readVarint()+a.pos):l===2?n.opacity=a.readVarint():l===5?n.clip_path_idx=a.readVarint():l===6?n.mask_idx=a.readVarint():l===7&&n.children.push(ay(a,a.readVarint()+a.pos))}function sy(l,n){return l.readFields(XB,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function XB(l,n,a){l===1?n.sx=a.readFloat():l===2?n.ky=a.readFloat():l===3?n.kx=a.readFloat():l===4?n.sy=a.readFloat():l===5?n.tx=a.readFloat():l===6&&(n.ty=a.readFloat())}function KB(l,n,a){l===1?n.fill=function(u,m){return u.readFields(JB,{rgb_color:p1,paint:"rgb_color",opacity:255},m)}(a,a.readVarint()+a.pos):l===2?n.stroke=function(u,m){return u.readFields(QB,{rgb_color:p1,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},m)}(a,a.readVarint()+a.pos):l===3?n.paint_order=a.readVarint():l===5?a.readPackedVarint(n.commands):l===6?n.step=a.readFloat():l===7?a.readPackedSVarint(n.diffs):l===8&&(n.rule=a.readVarint())}function JB(l,n,a){l===1?(n.rgb_color=ly(a.readVarint()),n.paint="rgb_color"):l===2?(n.linear_gradient_idx=a.readVarint(),n.paint="linear_gradient_idx"):l===3?(n.radial_gradient_idx=a.readVarint(),n.paint="radial_gradient_idx"):l===5&&(n.opacity=a.readVarint())}function ly(l){return new mr((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function QB(l,n,a){l===1?(n.rgb_color=ly(a.readVarint()),n.paint="rgb_color"):l===2?(n.linear_gradient_idx=a.readVarint(),n.paint="linear_gradient_idx"):l===3?(n.radial_gradient_idx=a.readVarint(),n.paint="radial_gradient_idx"):l===5?a.readPackedFloat(n.dasharray):l===6?n.dashoffset=a.readFloat():l===7?n.miterlimit=a.readFloat():l===8?n.opacity=a.readVarint():l===9?n.width=a.readFloat():l===10?n.linecap=a.readVarint():l===11&&(n.linejoin=a.readVarint())}function e5(l,n,a){l===1?n.transform=sy(a,a.readVarint()+a.pos):l===2?n.spread_method=a.readVarint():l===3?n.stops.push(NM(a,a.readVarint()+a.pos)):l===4?n.x1=a.readFloat():l===5?n.y1=a.readFloat():l===6?n.x2=a.readFloat():l===7&&(n.y2=a.readFloat())}function NM(l,n){return l.readFields(t5,{offset:0,opacity:255,rgb_color:p1},n)}function t5(l,n,a){l===1?n.offset=a.readFloat():l===2?n.opacity=a.readVarint():l===3&&(n.rgb_color=ly(a.readVarint()))}function n5(l,n,a){l===1?n.transform=sy(a,a.readVarint()+a.pos):l===2?n.spread_method=a.readVarint():l===3?n.stops.push(NM(a,a.readVarint()+a.pos)):l===4?n.cx=a.readFloat():l===5?n.cy=a.readFloat():l===6?n.r=a.readFloat():l===7?n.fx=a.readFloat():l===8?n.fy=a.readFloat():l===9&&(n.fr=a.readFloat())}function r5(l,n,a){l===1?n.transform=sy(a,a.readVarint()+a.pos):l===2?n.clip_path_idx=a.readVarint():l===3&&n.children.push(ay(a,a.readVarint()+a.pos))}function i5(l,n,a){l===1?n.left=n.top=a.readFloat():l===2?n.width=n.height=a.readFloat():l===3?n.top=a.readFloat():l===4?n.height=a.readFloat():l===5?n.mask_type=a.readVarint():l===6?n.mask_idx=a.readVarint():l===7&&n.children.push(ay(a,a.readVarint()+a.pos))}class o5{static calculate(n,a){const u=new Map,m=new Map;if(Object.keys(n).length===0)return u;a.forEach(h=>{m.set(h.name,h.rgb_color||new mr(0,0,0))});for(const[h,g]of Object.entries(n))m.has(h)?u.set(m.get(h).toStringPremultipliedAlpha(),g):console.warn(`Ignoring unknown image variable "${h}"`);return u}}function If(l,n=255,a){const u=n/255,m=l.toStringPremultipliedAlpha(),h=a.has(m)?a.get(m).clone():l.clone();return h.a=u,h.toString()}function ug(l,n){if(!ye()){const a=document.createElement("canvas");return a.width=l,a.height=n,a}return new OffscreenCanvas(l,n)}function a5(l,n){const a=o5.calculate(n.params,l.metadata?l.metadata.variables:[]),u=l.usvg_tree,m=u.width,h=u.height,g=n.transform?n.transform:new DOMMatrix,b=Math.max(1,Math.round(m*g.a)),T=Math.max(1,Math.round(h*g.d)),P=new DOMMatrix([b/m,0,0,T/h,0,0]),v=ug(b,T).getContext("2d");return g1(v,P,u,u,a),v.getImageData(0,0,b,T)}function g1(l,n,a,u,m){for(const h of u.children)VM(l,n,a,h,m)}function VM(l,n,a,u,m){u.group?(l.save(),function(h,g,b,T,P){const v=T.mask_idx!=null?b.masks[T.mask_idx]:null,E=T.clip_path_idx!=null?b.clip_paths[T.clip_path_idx]:null;if(T.transform&&(g=cy(T.transform).preMultiplySelf(g)),!function(M,D,k){return M.opacity!==255||D||k}(T,E!=null,v!=null))return void g1(h,g,b,T,P);const A=ug(h.canvas.width,h.canvas.height),C=A.getContext("2d");g1(C,g,b,T,P),E&&ZM(C,g,b,E),v&&YM(C,g,b,v,P),h.globalAlpha=T.opacity/255,h.drawImage(A,0,0)}(l,n,a,u.group,m),l.restore()):u.path&&(l.save(),function(h,g,b,T,P){const v=XM(T);h.setTransform(g),T.paint_order===FM.PAINT_ORDER_FILL_AND_STROKE?(jM(h,b,T,v,P),HM(h,b,T,v,P)):(HM(h,b,T,v,P),jM(h,b,T,v,P))}(l,n,a,u.path,m),l.restore())}function jM(l,n,a,u,m){const h=a.fill;if(!h)return;const g=h.opacity/255;switch(h.paint){case"rgb_color":l.fillStyle=If(h.rgb_color,h.opacity,m);break;case"linear_gradient_idx":l.fillStyle=GM(l,n.linear_gradients[h.linear_gradient_idx],g,m);break;case"radial_gradient_idx":l.fillStyle=WM(l,n.radial_gradients[h.radial_gradient_idx],g,m)}l.fill(u,UM(a))}function UM(l){return l.rule===m1.PATH_RULE_NON_ZERO?"nonzero":l.rule===m1.PATH_RULE_EVEN_ODD?"evenodd":void 0}function HM(l,n,a,u,m){const h=a.stroke;if(!h)return;l.lineWidth=h.width,l.miterLimit=h.miterlimit,l.setLineDash(h.dasharray),l.lineDashOffset=h.dashoffset;const g=h.opacity/255;switch(h.paint){case"rgb_color":l.strokeStyle=If(h.rgb_color,h.opacity,m);break;case"linear_gradient_idx":l.strokeStyle=GM(l,n.linear_gradients[h.linear_gradient_idx],g,m);break;case"radial_gradient_idx":l.strokeStyle=WM(l,n.radial_gradients[h.radial_gradient_idx],g,m)}switch(h.linejoin){case cg.LINE_JOIN_MITER_CLIP:case cg.LINE_JOIN_MITER:l.lineJoin="miter";break;case cg.LINE_JOIN_ROUND:l.lineJoin="round";break;case cg.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(h.linecap){case oy.LINE_CAP_BUTT:l.lineCap="butt";break;case oy.LINE_CAP_ROUND:l.lineCap="round";break;case oy.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(u)}function GM(l,n,a,u){if(n.stops.length===1){const A=n.stops[0];return If(A.rgb_color,A.opacity*a,u)}const m=cy(n.transform),{x1:h,y1:g,x2:b,y2:T}=n,P=m.transformPoint(new DOMPoint(h,g)),v=m.transformPoint(new DOMPoint(b,T)),E=l.createLinearGradient(P.x,P.y,v.x,v.y);for(const A of n.stops)E.addColorStop(A.offset,If(A.rgb_color,A.opacity*a,u));return E}function WM(l,n,a,u){if(n.stops.length===1){const A=n.stops[0];return If(A.rgb_color,A.opacity*a,u)}const m=cy(n.transform),{fx:h,fy:g,cx:b,cy:T}=n,P=m.transformPoint(new DOMPoint(h,g)),v=m.transformPoint(new DOMPoint(b,T)),E=l.createRadialGradient(P.x,P.y,0,v.x,v.y,n.r*((m.a+m.d)/2));for(const A of n.stops)E.addColorStop(A.offset,If(A.rgb_color,A.opacity*a,u));return E}function qM(l,n,a,u){const m=u.transform?cy(u.transform).preMultiplySelf(n):n,h=ug(l.canvas.width,l.canvas.height),g=h.getContext("2d");for(const T of u.children)if(T.group)qM(g,m,a,T.group);else if(T.path){const P=T.path,v=new Path2D;v.addPath(XM(P),m),g.fill(v,UM(P))}const b=u.clip_path_idx!=null?a.clip_paths[u.clip_path_idx]:null;b&&ZM(g,m,a,b),l.globalCompositeOperation="source-over",l.drawImage(h,0,0)}function ZM(l,n,a,u){const m=ug(l.canvas.width,l.canvas.height);qM(m.getContext("2d"),n,a,u),l.globalCompositeOperation="destination-in",l.drawImage(m,0,0)}function YM(l,n,a,u,m){if(u.children.length===0)return;const h=u.mask_idx!=null?a.masks[u.mask_idx]:null;h&&YM(l,n,a,h,m);const g=l.canvas.width,b=l.canvas.height,T=ug(g,b),P=T.getContext("2d"),v=u.width,E=u.height,A=u.left,C=u.top,M=new Path2D,D=new Path2D;D.rect(A,C,v,E),M.addPath(D,n),P.clip(M);for(const W of u.children)VM(P,n,a,W,m);const k=P.getImageData(0,0,g,b),V=k.data;if(u.mask_type===BM.MASK_TYPE_LUMINANCE)for(let W=0;W<V.length;W+=4)V[W+3]=V[W+3]/255*(.2126*V[W]+.7152*V[W+1]+.0722*V[W+2]);P.putImageData(k,0,0),l.globalCompositeOperation="destination-in",l.drawImage(T,0,0)}function cy(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function XM(l){const n=new Path2D,a=l.step;let u=l.diffs[0]*a,m=l.diffs[1]*a;n.moveTo(u,m);for(let h=0,g=2;h<l.commands.length;h++)switch(l.commands[h]){case Mf.PATH_COMMAND_MOVE:u+=l.diffs[g++]*a,m+=l.diffs[g++]*a,n.moveTo(u,m);break;case Mf.PATH_COMMAND_LINE:u+=l.diffs[g++]*a,m+=l.diffs[g++]*a,n.lineTo(u,m);break;case Mf.PATH_COMMAND_QUAD:{const b=u+l.diffs[g++]*a,T=m+l.diffs[g++]*a;u=b+l.diffs[g++]*a,m=T+l.diffs[g++]*a,n.quadraticCurveTo(b,T,u,m);break}case Mf.PATH_COMMAND_CUBIC:{const b=u+l.diffs[g++]*a,T=m+l.diffs[g++]*a,P=b+l.diffs[g++]*a,v=T+l.diffs[g++]*a;u=P+l.diffs[g++]*a,m=v+l.diffs[g++]*a,n.bezierCurveTo(b,T,P,v,u,m);break}case Mf.PATH_COMMAND_CLOSE:n.closePath()}return n}class _1{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const a=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,a),a}put(n,a){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,a)}delete(n){this.cache.delete(n)}}class y1{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new ao(n,n.data)}getFromCache(n,a,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new _1(150)),this.cacheMap.get(u).get(Ka(n.serialize(),a))}setInCache(n,a,u,m){this.cacheDependenciesMap.has(m)||this.cacheDependenciesMap.set(m,new Map),this.cacheMap.has(m)||this.cacheMap.set(m,new _1(150));const h=this.cacheDependenciesMap.get(m);h.get(Ka(n.id,u))||h.set(Ka(n.id,u),new Set);const g=this.cacheMap.get(m),b=n.serialize();h.get(Ka(n.id,u)).add(b),g.put(Ka(n.serialize(),u),a)}removeImagesFromCacheByIds(n,a,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const m=this.cacheMap.get(u),h=this.cacheDependenciesMap.get(u);for(const g of n)if(h.has(Ka(g,a))){for(const b of h.get(Ka(g,a)))m.delete(b);h.delete(Ka(g,a))}}rasterize(n,a,u,m,h=a5){const g=this.getFromCache(n,u,m);if(g)return g.clone();const b=h(a.icon,n.options),T=y1._getImage(b);return this.setInCache(n,T,u,m),T.clone()}}class KM{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,a){const u=this.toIdx(n,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,a){return this.leaves[this.toIdx(n,a)]}toIdx(n,a){return a*this.size+n}}function JM(l,n,a,u){let m=0,h=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(u[g])<1e-15){if(a[g]<l[g]||a[g]>n[g])return null}else{const b=1/u[g];let T=(l[g]-a[g])*b,P=(n[g]-a[g])*b;if(T>P){const v=T;T=P,P=v}if(T>m&&(m=T),P<h&&(h=P),m>h)return null}return m}function QM(l,n,a,u,m,h,g,b,T,P,v){const E=u-l,A=m-n,C=h-a,M=g-l,D=b-n,k=T-a,V=v[1]*k-v[2]*D,W=v[2]*M-v[0]*k,Z=v[0]*D-v[1]*M,H=E*V+A*W+C*Z;if(Math.abs(H)<1e-15)return null;const Q=1/H,oe=P[0]-l,fe=P[1]-n,Se=P[2]-a,we=(oe*V+fe*W+Se*Z)*Q;if(we<0||we>1)return null;const xe=fe*C-Se*A,ke=Se*E-oe*C,Ce=oe*A-fe*E,Ne=(v[0]*xe+v[1]*ke+v[2]*Ce)*Q;return Ne<0||we+Ne>1?null:(M*xe+D*ke+k*Ce)*Q}function eI(l,n,a){return(l-n)/(a-n)}function tI(l,n,a,u,m,h,g,b,T){const P=1<<a,v=h-u,E=g-m,A=(l+1)/P*v+u,C=(n+0)/P*E+m,M=(n+1)/P*E+m;b[0]=(l+0)/P*v+u,b[1]=C,T[0]=A,T[1]=M}class nI{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(h){const g=Math.ceil(Math.log2(h.dim/8)),b=[];let T=Math.ceil(Math.pow(2,g));const P=1/T,v=(C,M,D,k,V)=>{const W=k?1:0,Z=(C+1)*D-W,H=M*D,Q=(M+1)*D-W;V[0]=C*D,V[1]=H,V[2]=Z,V[3]=Q};let E=new KM(T);const A=[];for(let C=0;C<T*T;C++){v(C%T,Math.floor(C/T),P,!1,A);const M=cu(A[0],A[1],h),D=cu(A[2],A[1],h),k=cu(A[2],A[3],h),V=cu(A[0],A[3],h);E.minimums.push(Math.min(M,D,k,V)),E.maximums.push(Math.max(M,D,k,V)),E.leaves.push(1)}for(b.push(E),T/=2;T>=1;T/=2){const C=b[b.length-1];E=new KM(T);for(let M=0;M<T*T;M++){v(M%T,Math.floor(M/T),2,!0,A);const D=C.getElevation(A[0],A[1]),k=C.getElevation(A[2],A[1]),V=C.getElevation(A[2],A[3]),W=C.getElevation(A[0],A[3]),Z=C.isLeaf(A[0],A[1]),H=C.isLeaf(A[2],A[1]),Q=C.isLeaf(A[2],A[3]),oe=C.isLeaf(A[0],A[3]),fe=Math.min(D.min,k.min,V.min,W.min),Se=Math.max(D.max,k.max,V.max,W.max),we=Z&&H&&Q&&oe;E.maximums.push(Se),E.minimums.push(fe),E.leaves.push(Se-fe<=5&&we?1:0)}b.push(E)}return b}(this.dem),u=a.length-1,m=a[u];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(n,a,u,m,h,g,b=1){return JM([n,a,-100],[u,m,this.maximums[0]*b],h,g)}raycast(n,a,u,m,h,g,b=1){if(!this.nodeCount)return null;const T=this.raycastRoot(n,a,u,m,h,g,b);if(T==null)return null;const P=[],v=[],E=[],A=[],C=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;C.length>0;){const{idx:M,t:D,nodex:k,nodey:V,depth:W}=C.pop();if(this.leaves[M]){tI(k,V,W,n,a,u,m,E,A);const H=1<<W,Q=(k+0)/H,oe=(k+1)/H,fe=(V+0)/H,Se=(V+1)/H,we=cu(Q,fe,this.dem)*b,xe=cu(oe,fe,this.dem)*b,ke=cu(oe,Se,this.dem)*b,Ce=cu(Q,Se,this.dem)*b,Ne=QM(E[0],E[1],we,A[0],E[1],xe,A[0],A[1],ke,h,g),Ze=QM(A[0],A[1],ke,E[0],A[1],Ce,E[0],E[1],we,h,g),Ge=Math.min(Ne!==null?Ne:Number.MAX_VALUE,Ze!==null?Ze:Number.MAX_VALUE);if(Ge!==Number.MAX_VALUE)return Ge;{const Je=_e.vec3.scaleAndAdd([],h,g,D);if(rI(we,xe,Ce,ke,eI(Je[0],E[0],A[0]),eI(Je[1],E[1],A[1]))>=Je[2])return D}continue}let Z=0;for(let H=0;H<this._siblingOffset.length;H++){tI((k<<1)+this._siblingOffset[H][0],(V<<1)+this._siblingOffset[H][1],W+1,n,a,u,m,E,A),E[2]=-100,A[2]=this.maximums[this.childOffsets[M]+H]*b;const Q=JM(E,A,h,g);if(Q!=null){const oe=Q;P[H]=oe;let fe=!1;for(let Se=0;Se<Z&&!fe;Se++)oe>=P[v[Se]]&&(v.splice(Se,0,H),fe=!0);fe||(v[Z]=H),Z++}}for(let H=0;H<Z;H++){const Q=v[H];C.push({idx:this.childOffsets[M]+Q,t:P[Q],nodex:(k<<1)+this._siblingOffset[Q][0],nodey:(V<<1)+this._siblingOffset[Q][1],depth:W+1})}}return null}_addNode(n,a,u){return this.minimums.push(n),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,a,u,m,h){if(n[m].isLeaf(a,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const g=m-1,b=n[g];let T=0,P=0;for(let v=0;v<this._siblingOffset.length;v++){const E=2*a+this._siblingOffset[v][0],A=2*u+this._siblingOffset[v][1],C=b.getElevation(E,A),M=b.isLeaf(E,A),D=this._addNode(C.min,C.max,M);M&&(T|=1<<v),P||(P=D)}for(let v=0;v<this._siblingOffset.length;v++)T&1<<v||this._construct(n,2*a+this._siblingOffset[v][0],2*u+this._siblingOffset[v][1],g,P+v)}}function rI(l,n,a,u,m,h){return Pn(Pn(l,a,h),Pn(n,u,h),m)}function cu(l,n,a){const u=a.dim,m=Qt(l*u-.5,0,u-1),h=Qt(n*u-.5,0,u-1),g=Math.floor(m),b=Math.floor(h),T=Math.min(g+1,u-1),P=Math.min(b+1,u-1);return rI(a.get(g,b),a.get(T,b),a.get(g,P),a.get(T,P),m-g,h-b)}const s5={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function l5(l,n,a){return(256*l*256+256*n+a)/10-1e4}function c5(l,n,a){return 256*l+n+a/256-32768}class uy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,a,u,m=!1){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void kn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const h=this.dim=a.height-2,g=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let T=0;T<h;T++)g[this._idx(-1,T)]=g[this._idx(0,T)],g[this._idx(h,T)]=g[this._idx(h-1,T)],g[this._idx(T,-1)]=g[this._idx(T,0)],g[this._idx(T,h)]=g[this._idx(T,h-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(h,-1)]=g[this._idx(h-1,0)],g[this._idx(-1,h)]=g[this._idx(0,h-1)],g[this._idx(h,h)]=g[this._idx(h-1,h-1)]}const b=u==="terrarium"?c5:l5;for(let T=0;T<g.length;++T){const P=4*T;this.floatView[T]=b(this.pixels[P],this.pixels[P+1],this.pixels[P+2])}this._timestamp=De.now()}_buildQuadTree(){this._tree=new nI(this)}get(n,a,u=!1){u&&(n=Qt(n,-1,this.dim),a=Qt(a,-1,this.dim));const m=this._idx(n,a);return this.floatView[m]}set(n,a,u){const m=this._idx(n,a),h=this.floatView[m];return this.floatView[m]=u,u-h}static getUnpackVector(n){return s5[n]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}static pack(n,a){const u=[0,0,0,0],m=uy.getUnpackVector(a);let h=Math.floor((n+m[3])/m[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new xT({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,a,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,h=a*this.dim+this.dim,g=u*this.dim,b=u*this.dim+this.dim;switch(a){case-1:m=h-1;break;case 1:h=m+1}switch(u){case-1:g=b-1;break;case 1:b=g+1}const T=-a*this.dim,P=-u*this.dim;for(let v=g;v<b;v++)for(let E=m;E<h;E++){const A=4*this._idx(E,v),C=4*this._idx(E+T,v+P);this.pixels[A+0]=n.pixels[C+0],this.pixels[A+1]=n.pixels[C+1],this.pixels[A+2]=n.pixels[C+2],this.pixels[A+3]=n.pixels[C+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function u5(l,n,a){l===1?n.headerLength=a.readFixed32():l===2?n.x=a.readVarint():l===3?n.y=a.readVarint():l===4?n.z=a.readVarint():l===5&&n.layers.push(function(u,m){return u.readFields(m5,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(a,a.readVarint()+a.pos))}function d5(l,n,a){l===1?(n.delta_filter=function(u,m){return u.readFields(h5,{blockSize:0},m)}(a,a.readVarint()+a.pos),n.filter="delta_filter"):l===2?(a.readVarint(),n.filter="zigzag_filter"):l===3?(a.readVarint(),n.filter="bitshuffle_filter"):l===4&&(a.readVarint(),n.filter="byteshuffle_filter")}function h5(l,n,a){l===1&&(n.blockSize=a.readVarint())}function f5(l,n,a){l===1?(a.readVarint(),n.codec="gzip_data"):l===2?(a.readVarint(),n.codec="jpeg_image"):l===3?(a.readVarint(),n.codec="webp_image"):l===4&&(a.readVarint(),n.codec="png_image")}function p5(l,n,a){let u=0,m=0;l===1?n.firstByte=a.readFixed64():l===2?n.lastByte=a.readFixed64():l===3?n.filters.push(function(h,g){return h.readFields(d5,{},g)}(a,a.readVarint()+a.pos)):l===4?n.codec=function(h,g){return h.readFields(f5,{},g)}(a,a.readVarint()+a.pos):l===5?m=a.readFloat():l===6?u=a.readFloat():l===7?n.bands.push(a.readString()):l===8?n.offset=a.readDouble():l===9&&(n.scale=a.readDouble()),n.offset===0&&(n.offset=m),n.scale===0&&(n.scale=u)}function m5(l,n,a){l===1?n.version=a.readVarint():l===2?n.name=a.readString():l===3?n.units=a.readString():l===4?n.tileSize=a.readVarint():l===5?n.buffer=a.readVarint():l===6?n.pixelFormat=a.readVarint():l===7&&n.dataIndex.push(function(u,m){return u.readFields(p5,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(a,a.readVarint()+a.pos))}function g5(l,n,a){if(l===2)(function(u,m,h){u.readFields(_5,h,m)})(a,a.readVarint()+a.pos,n);else if(l===3)throw new Error("Not implemented")}function _5(l,n,a){if(l===1){let u=0;const m=a.readVarint()+a.pos;for(;a.pos<m;)n[u++]=a.readVarint()}}function y5(l,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let a=n[3];for(let u=2;u>=1;u--){const m=u===1?1:0,h=u===2?1:0;for(let g=0;g<n[0];g++){const b=n[1]*g;for(let T=m;T<n[1];T++){const P=n[2]*(T+b);for(let v=h;v<n[2];v++){const E=n[3]*(v+P);for(let A=0;A<n[3];A++){const C=E+A;l[C]+=l[C-a]}}}}a*=n[u]}return l}function v5(l){for(let n=0,a=l.length;n<a;n++)l[n]=l[n]>>>1^-(1&l[n]);return l}function x5(l,n){switch(n){case"uint32":return l;case"uint16":for(let a=0;a<l.length;a+=2){const u=l[a],m=l[a+1];l[a]=(240&u)>>4|(61440&u)>>8|(240&m)<<4|61440&m,l[a+1]=15&u|(3840&u)>>4|(15&m)<<8|(3840&m)<<4}return l;case"uint8":for(let a=0;a<l.length;a+=4){const u=l[a],m=l[a+1],h=l[a+2],g=l[a+3];l[a+0]=(192&u)>>6|(192&m)>>4|(192&h)>>2|192&g,l[a+1]=(48&u)>>4|(48&m)>>2|48&h|(48&g)<<2,l[a+2]=(12&u)>>2|12&m|(12&h)<<2|(12&g)<<4,l[a+3]=3&u|(3&m)<<2|(3&h)<<4|(3&g)<<6}return l;default:throw new Error(`Invalid pixel format, "${n}"`)}}fn(uy,"DEMData"),fn(nI,"DemMinMaxQuadTree",{omit:["dem"]});var Aa=Uint8Array,dg=Uint16Array,b5=Int32Array,iI=new Aa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),oI=new Aa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),w5=new Aa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),aI=function(l,n){for(var a=new dg(31),u=0;u<31;++u)a[u]=n+=1<<l[u-1];var m=new b5(a[30]);for(u=1;u<30;++u)for(var h=a[u];h<a[u+1];++h)m[h]=h-a[u]<<5|u;return{b:a,r:m}},sI=aI(iI,2),lI=sI.b,S5=sI.r;lI[28]=258,S5[258]=28;for(var C5=aI(oI,0).b,cI=new dg(32768),Di=0;Di<32768;++Di){var Af=(43690&Di)>>1|(21845&Di)<<1;cI[Di]=((65280&(Af=(61680&(Af=(52428&Af)>>2|(13107&Af)<<2))>>4|(3855&Af)<<4))>>8|(255&Af)<<8)>>1}var hg=function(l,n,a){for(var u=l.length,m=0,h=new dg(n);m<u;++m)l[m]&&++h[l[m]-1];var g,b=new dg(n);for(m=1;m<n;++m)b[m]=b[m-1]+h[m-1]<<1;g=new dg(1<<n);var T=15-n;for(m=0;m<u;++m)if(l[m])for(var P=m<<4|l[m],v=n-l[m],E=b[l[m]-1]++<<v,A=E|(1<<v)-1;E<=A;++E)g[cI[E]>>T]=P;return g},fg=new Aa(288);for(Di=0;Di<144;++Di)fg[Di]=8;for(Di=144;Di<256;++Di)fg[Di]=9;for(Di=256;Di<280;++Di)fg[Di]=7;for(Di=280;Di<288;++Di)fg[Di]=8;var uI=new Aa(32);for(Di=0;Di<32;++Di)uI[Di]=5;var T5=hg(fg,9),E5=hg(uI,5),v1=function(l){for(var n=l[0],a=1;a<l.length;++a)l[a]>n&&(n=l[a]);return n},zs=function(l,n,a){var u=n/8|0;return(l[u]|l[u+1]<<8)>>(7&n)&a},x1=function(l,n){var a=n/8|0;return(l[a]|l[a+1]<<8|l[a+2]<<16)>>(7&n)},M5=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ls=function(l,n,a){var u=new Error(n||M5[l]);if(u.code=l,Error.captureStackTrace&&Error.captureStackTrace(u,Ls),!a)throw u;return u},I5=new Aa(0),A5=typeof TextDecoder<"u"&&new TextDecoder;try{A5.decode(I5,{stream:!0})}catch{}const P5={gzip_data:"gzip"};class is extends Error{constructor(n){super(n),this.name="MRTError"}}const O5={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},dI={uint32:1,uint16:2,uint8:4},D5={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let b1;class w1{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const a=this.layers[n];if(!a)throw new is(`Layer '${n}' not found`);return a}getHeaderLength(n){const a=new Uint8Array(n),u=new DataView(n);if(a[0]!==13)throw new is("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const a=new Uint8Array(n),u=this.getHeaderLength(n);if(a.length<u)throw new is(`Expected header with length >= ${u} but got buffer of length ${a.length}`);const m=function(h,g){return h.readFields(u5,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new b1(a.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new is(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const h of m.layers)this.layers[h.name]=new R5(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const a=[],u=this.getLayer(n.layerName);for(let m of n.blockIndices){const h=u.dataIndex[m],g=h.firstByte-n.firstByte,b=h.lastByte-n.firstByte;if(u._blocksInProgress.has(m))continue;const T={layerName:u.name,firstByte:g,lastByte:b,pixelFormat:u.pixelFormat,blockIndex:m,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(P=>P.filter)};u._blocksInProgress.add(m),a.push(T)}return new hI(a,()=>{a.forEach(m=>u._blocksInProgress.delete(m.blockIndex))},(m,h)=>{if(a.forEach(g=>u._blocksInProgress.delete(g.blockIndex)),m)throw m;h.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class R5{constructor({version:n,name:a,units:u,tileSize:m,pixelFormat:h,buffer:g,dataIndex:b},T){if(this.version=n,this.version!==1)throw new is(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=a,this.units=u,this.tileSize=m,this.buffer=g,this.pixelFormat=O5[h],this.dataIndex=b,this.bandShape=[m+2*g,m+2*g,dI[this.pixelFormat]],this._decodedBlocks=new _1(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return dI[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const a=n.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.put(a,n.data)}getBlockForBand(n){let a=0;switch(typeof n){case"string":for(const[u,m]of this.dataIndex.entries()){for(const[h,g]of m.bands.entries())if(g===n)return{bandIndex:a+h,blockIndex:u,blockBandIndex:h};a+=m.bands.length}break;case"number":for(const[u,m]of this.dataIndex.entries()){if(n>=a&&n<a+m.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-a};a+=m.bands.length}break;default:throw new is(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new is(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let a=1/0,u=-1/0;const m=[],h=new Set;for(const g of n){const{blockIndex:b}=this.getBlockForBand(g);if(b<0)throw new is(`Invalid band: ${JSON.stringify(g)}`);const T=this.dataIndex[b];m.includes(b)||m.push(b),h.add(b),a=Math.min(a,T.firstByte),u=Math.max(u,T.lastByte)}if(h.size>this.cacheSize)throw new is(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:a,lastByte:u,blockIndices:m}}hasBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0}hasDataForBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(n){const{blockIndex:a,blockBandIndex:u}=this.getBlockForBand(n),m=this._decodedBlocks.get(a.toString());if(!m)throw new is(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[a],g=this.bandShape.reduce((P,v)=>P*v,1),b=u*g,T=m.subarray(b,b+g);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}w1.setPbf=function(l){b1=l};class hI{constructor(n,a,u){this.tasks=n,this._onCancel=a,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,a){this._finalized||(this._onComplete(n,a),this._finalized=!0)}}w1.performDecoding=function(l,n){const a=new Uint8Array(l);return Promise.all(n.tasks.map(u=>{const{layerName:m,firstByte:h,lastByte:g,pixelFormat:b,blockShape:T,blockIndex:P,filters:v,codec:E}=u,A=a.subarray(h,g+1),C=new Uint32Array(T[0]*T[1]*T[2]);let M;if(E!=="gzip_data")throw new is(`Unhandled codec: ${E}`);return M=function(D,k){if(!globalThis.DecompressionStream&&k==="gzip_data")return Promise.resolve(((H=function(fe){fe[0]==31&&fe[1]==139&&fe[2]==8||Ls(6,"invalid gzip data");var Se=fe[3],we=10;4&Se&&(we+=2+(fe[10]|fe[11]<<8));for(var xe=(Se>>3&1)+(Se>>4&1);xe>0;xe-=!fe[we++]);return we+(2&Se)}(Z=D))+8>Z.length&&Ls(6,"invalid gzip data"),function(fe,Se,we,xe){var ke=fe.length;if(!ke||Se.f&&!Se.l)return we||new Aa(0);var Ce=!we,Ne=Ce||Se.i!=2,Ze=Se.i;Ce&&(we=new Aa(3*ke));var Ge,Je,rt=function(uu){var Bd=we.length;if(uu>Bd){var _g=new Aa(Math.max(2*Bd,uu));_g.set(we),we=_g}},lt=Se.f||0,nt=Se.p||0,xt=Se.b||0,Dt=Se.l,vt=Se.d,Jt=Se.m,Zt=Se.n,kt=8*ke;do{if(!Dt){lt=zs(fe,nt,1);var Rt=zs(fe,nt+1,3);if(nt+=3,!Rt){var mn=fe[(Fn=4+((nt+7)/8|0))-4]|fe[Fn-3]<<8,en=Fn+mn;if(en>ke){Ze&&Ls(0);break}Ne&&rt(xt+mn),we.set(fe.subarray(Fn,en),xt),Se.b=xt+=mn,Se.p=nt=8*en,Se.f=lt;continue}if(Rt==1)Dt=T5,vt=E5,Jt=9,Zt=5;else if(Rt==2){var sn=zs(fe,nt,31)+257,zn=zs(fe,nt+10,15)+4,Vn=sn+zs(fe,nt+5,31)+1;nt+=14;for(var jn=new Aa(Vn),Un=new Aa(19),Zn=0;Zn<zn;++Zn)Un[w5[Zn]]=zs(fe,nt+3*Zn,7);nt+=3*zn;var Yn=v1(Un),Lr=(1<<Yn)-1,Mr=hg(Un,Yn);for(Zn=0;Zn<Vn;){var Fn,Sr=Mr[zs(fe,nt,Lr)];if(nt+=15&Sr,(Fn=Sr>>4)<16)jn[Zn++]=Fn;else{var Er=0,Hr=0;for(Fn==16?(Hr=3+zs(fe,nt,3),nt+=2,Er=jn[Zn-1]):Fn==17?(Hr=3+zs(fe,nt,7),nt+=3):Fn==18&&(Hr=11+zs(fe,nt,127),nt+=7);Hr--;)jn[Zn++]=Er}}var _i=jn.subarray(0,sn),Ri=jn.subarray(sn);Jt=v1(_i),Zt=v1(Ri),Dt=hg(_i,Jt),vt=hg(Ri,Zt)}else Ls(1);if(nt>kt){Ze&&Ls(0);break}}Ne&&rt(xt+131072);for(var yi=(1<<Jt)-1,ii=(1<<Zt)-1,Si=nt;;Si=nt){var $i=(Er=Dt[x1(fe,nt)&yi])>>4;if((nt+=15&Er)>kt){Ze&&Ls(0);break}if(Er||Ls(2),$i<256)we[xt++]=$i;else{if($i==256){Si=nt,Dt=null;break}var _o=$i-254;$i>264&&(_o=zs(fe,nt,(1<<(Fs=iI[Zn=$i-257]))-1)+lI[Zn],nt+=Fs);var Vr=vt[x1(fe,nt)&ii],Qo=Vr>>4;if(Vr||Ls(3),nt+=15&Vr,Ri=C5[Qo],Qo>3){var Fs=oI[Qo];Ri+=x1(fe,nt)&(1<<Fs)-1,nt+=Fs}if(nt>kt){Ze&&Ls(0);break}Ne&&rt(xt+131072);var os=xt+_o;if(xt<Ri){var as=0-Ri,Fd=Math.min(Ri,os);for(as+xt<0&&Ls(3);xt<Fd;++xt)we[xt]=(void 0)[as+xt]}for(;xt<os;++xt)we[xt]=we[xt-Ri]}}Se.l=Dt,Se.p=Si,Se.b=xt,Se.f=lt,Dt&&(lt=1,Se.m=Jt,Se.d=vt,Se.n=Zt)}while(!lt);return xt!=we.length&&Ce?(Ge=we,((Je=xt)==null||Je>Ge.length)&&(Je=Ge.length),new Aa(Ge.subarray(0,Je))):we.subarray(0,xt)}(Z.subarray(H,-8),{i:2},new Aa(((V=Z)[(W=V.length)-4]|V[W-3]<<8|V[W-2]<<16|V[W-1]<<24)>>>0))));var V,W,Z,H;const Q=P5[k];if(!Q)throw new Error(`Unhandled codec: ${k}`);const oe=new globalThis.DecompressionStream(Q);return new Response(new Blob([D]).stream().pipeThrough(oe)).arrayBuffer().then(fe=>new Uint8Array(fe))}(A,E).then(D=>(function(k,V){k.readFields(g5,V)}(new b1(D),C),new D5[b](C.buffer))),M.then(D=>{for(let k=v.length-1;k>=0;k--)switch(v[k]){case"delta_filter":y5(D,T);break;case"zigzag_filter":v5(D);break;case"bitshuffle_filter":x5(D,b);break;default:throw new is(`Unhandled filter "${v[k]}"`)}return{layerName:m,blockIndex:P,data:D}}).catch(D=>{throw D})}))},fn(hI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let pg,S1,$s,Pf,C1,Of=null;function fI(){return Ua()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:S1||ni.DRACO_URL}function pI(){if(Ua()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Pf)return Pf;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Pf=WebAssembly.validate(l)?ni.MESHOPT_SIMD_URL:ni.MESHOPT_URL,Pf}const dy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},z5={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},mg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function mI(l,n,a){const u=a.json.bufferViews.length,m=a.buffers.length;n.bufferView=u,a.json.bufferViews[u]={buffer:m,byteLength:l.byteLength},a.buffers[m]=l}const T1="KHR_draco_mesh_compression";function L5(l,n){const a=l.extensions&&l.extensions[T1];if(!a)return;const u=new $s.Decoder,m=vI(n,a.bufferView),h=new $s.Mesh;if(!u.DecodeArrayToMesh(m,m.byteLength,h))throw new Error("Failed to decode Draco mesh");const g=n.json.accessors[l.indices],b=dy[g.componentType],T=g.count*b.BYTES_PER_ELEMENT,P=$s._malloc(T);b===Uint16Array?u.GetTrianglesUInt16Array(h,T,P):u.GetTrianglesUInt32Array(h,T,P),mI($s.memory.buffer.slice(P,P+T),g,n),$s._free(P);for(const v of Object.keys(a.attributes)){const E=u.GetAttributeByUniqueId(h,a.attributes[v]),A=n.json.accessors[l.attributes[v]],C=z5[A.componentType],M=A.count*mg[A.type]*dy[A.componentType].BYTES_PER_ELEMENT,D=$s._malloc(M);u.GetAttributeDataArrayForAllPoints(h,E,$s[C],M,D),mI($s.memory.buffer.slice(D,D+M),A,n),$s._free(D)}u.destroy(),h.destroy(),delete l.extensions[T1]}const hy="EXT_meshopt_compression";function $5(l,n){if(!l.extensions||!l.extensions[hy])return;const a=l.extensions[hy],u=new Uint8Array(n.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),m=new Uint8Array(a.count*a.byteStride);C1.decodeGltfBuffer(m,a.count,a.byteStride,u,a.mode,a.filter),l.buffer=n.buffers.length,l.byteOffset=0,n.buffers[l.buffer]=m.buffer,delete l.extensions[hy]}const gI=1179937895,_I=new TextDecoder("utf8");function yI(l,n){return new URL(l,n).href}function F5(l,n,a,u){return fetch(yI(l.uri,u)).then(m=>m.arrayBuffer()).then(m=>{n.buffers[a]=m})}function vI(l,n){const a=l.json.bufferViews[n];return new Uint8Array(l.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function B5(l,n,a,u){if(l.uri){const m=yI(l.uri,u);return fetch(m).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[a]=h})}if(l.bufferView!==void 0){const m=vI(n,l.bufferView),h=new Blob([m],{type:l.mimeType});return createImageBitmap(h).then(g=>{n.images[a]=g})}}function xI(l,n=0,a){const u={json:null,images:[],buffers:[]};if(new Uint32Array(l,n,1)[0]===gI){const v=new Uint32Array(l,n);let E=2;const A=(v[E++]>>2)-3,C=v[E++]>>2;if(E++,u.json=JSON.parse(_I.decode(v.subarray(E,E+C))),E+=C,E<A){const M=v[E++];E++;const D=n+(E<<2);u.buffers[0]=l.slice(D,D+M)}}else u.json=JSON.parse(_I.decode(new Uint8Array(l,n)));const{buffers:m,images:h,meshes:g,extensionsUsed:b,bufferViews:T}=u.json;let P=Promise.resolve();if(m){const v=[];for(let E=0;E<m.length;E++){const A=m[E];A.uri?v.push(F5(A,u,E,a)):u.buffers[E]||(u.buffers[E]=null)}P=Promise.all(v)}return P.then(()=>{const v=[],E=b&&b.includes(T1),A=b&&b.includes(hy);if(E&&v.push(function(){if(!$s)return pg??(pg=function(C){let M,D=null;function k(){M=new Uint8Array(D.buffer)}function V(){throw new Error("Unexpected Draco error.")}const W={a:{a:V,d:function(Z,H,Q){return M.copyWithin(Z,H,H+Q)},c:function(Z){const H=M.length,Q=Math.max(Z>>>0,Math.ceil(1.2*H)),oe=Math.ceil((Q-H)/65536);try{return D.grow(oe),k(),!0}catch{return!1}},b:V}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(C,W):C.then(Z=>Z.arrayBuffer()).then(Z=>WebAssembly.instantiate(Z,W))).then(Z=>{const{Rb:H,Qb:Q,P:oe,T:fe,X:Se,Ja:we,La:xe,Qa:ke,Va:Ce,Wa:Ne,eb:Ze,jb:Ge,f:Je,e:rt,yb:lt,zb:nt,Ab:xt,Bb:Dt,Db:vt,Gb:Jt}=Z.instance.exports;D=rt;const Zt=(()=>{let kt=0,Rt=0,mn=0,en=0;return sn=>{mn&&(H(en),H(kt),Rt+=mn,mn=kt=0),kt||(Rt+=128,kt=Q(Rt));const zn=sn.length+7&-8;let Vn=kt;zn>=Rt&&(mn=zn,Vn=en=Q(zn));for(let jn=0;jn<sn.length;jn++)M[Vn+jn]=sn[jn];return Vn}})();return k(),Je(),{memory:rt,_free:H,_malloc:Q,Mesh:class{constructor(){this.ptr=oe()}destroy(){fe(this.ptr)}},Decoder:class{constructor(){this.ptr=we()}destroy(){Ge(this.ptr)}DecodeArrayToMesh(kt,Rt,mn){const en=Zt(kt),sn=xe(this.ptr,en,Rt,mn.ptr);return!!Se(sn)}GetAttributeByUniqueId(kt,Rt){return{ptr:ke(this.ptr,kt.ptr,Rt)}}GetTrianglesUInt16Array(kt,Rt,mn){Ce(this.ptr,kt.ptr,Rt,mn)}GetTrianglesUInt32Array(kt,Rt,mn){Ne(this.ptr,kt.ptr,Rt,mn)}GetAttributeDataArrayForAllPoints(kt,Rt,mn,en,sn){Ze(this.ptr,kt.ptr,Rt.ptr,mn,en,sn)}},DT_INT8:lt(),DT_UINT8:nt(),DT_INT16:xt(),DT_UINT16:Dt(),DT_UINT32:vt(),DT_FLOAT32:Jt()}})}(fetch(fI())),pg.then(C=>{$s=C,pg=void 0}))}()),A&&v.push(function(){if(C1)return;const C=function(M){let D;const k=WebAssembly.instantiateStreaming(M,{}).then(Z=>{D=Z.instance,D.exports.__wasm_call_ctors()}),V={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},W={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:k,supported:!0,decodeGltfBuffer(Z,H,Q,oe,fe,Se){(function(we,xe,ke,Ce,Ne,Ze,Ge){const Je=we.exports.sbrk,rt=Ce+3&-4,lt=Je(rt*Ne),nt=Je(Ze.length),xt=new Uint8Array(we.exports.memory.buffer);xt.set(Ze,nt);const Dt=xe(lt,Ce,Ne,nt,Ze.length);if(Dt===0&&Ge&&Ge(lt,rt,Ne),ke.set(xt.subarray(lt,lt+Ce*Ne)),Je(lt-Je(0)),Dt!==0)throw new Error(`Malformed buffer data: ${Dt}`)})(D,D.exports[W[fe]],Z,H,Q,oe,D.exports[V[Se]])}}}(fetch(pI()));return C.ready.then(()=>{C1=C})}()),h)for(let C=0;C<h.length;C++)v.push(B5(h[C],u,C,a));return(v.length?Promise.all(v):Promise.resolve()).then(()=>{if(E&&g)for(const{primitives:C}of g)for(const M of C)L5(M,u);if(A&&g&&T)for(const C of T)$5(C,u);return u})})}function $d(l,n){const a=l.json.bufferViews[n.bufferView],u=dy[n.componentType];return new u(l.buffers[a.buffer],(n.byteOffset||0)+(a.byteOffset||0),n.count*(a.byteStride&&a.byteStride!==mg[n.type]*u.BYTES_PER_ELEMENT?a.byteStride/u.BYTES_PER_ELEMENT:mg[n.type]))}function E1(l,n,a,u){const m=dy[n.componentType],h=function(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),g=l.json.bufferViews[n.bufferView],b=g.byteStride?g.byteStride/m.BYTES_PER_ELEMENT:mg[n.type],T=a.float32,P=T.length/a.capacity;for(let v=0,E=0;v<n.count*b;v+=b,E+=P)for(let A=0;A<P;A++)T[E+A]=u[v+A]*h;a._trim()}function k5(l,n,a){const u=l.indices,m=l.attributes,h={};h.indexArray=new eo;const g=n.json.accessors[u],b=g.count/3;h.indexArray.reserve(b);const T=$d(n,g);for(let A=0;A<b;A++)h.indexArray.emplaceBack(T[3*A],T[3*A+1],T[3*A+2]);h.indexArray._trim(),h.vertexArray=new Ja;const P=n.json.accessors[m.POSITION];h.vertexArray.reserve(P.count);const v=$d(n,P);for(let A=0;A<P.count;A++)h.vertexArray.emplaceBack(v[3*A],v[3*A+1],v[3*A+2]);if(h.vertexArray._trim(),h.aabb=new vn(P.min,P.max),h.centroid=function(A,C){const M=[0,0,0],D=A.length;if(D>0){for(let k=0;k<D;k++){const V=3*A[k];M[0]+=C[V],M[1]+=C[V+1],M[2]+=C[V+2]}M[0]/=D,M[1]/=D,M[2]/=D}return M}(T,v),m.COLOR_0!==void 0){const A=n.json.accessors[m.COLOR_0],C=mg[A.type],M=$d(n,A);h.colorArray=C===3?new Ja:new Ql,h.colorArray.resize(A.count),E1(n,A,h.colorArray,M)}if(m.NORMAL!==void 0){h.normalArray=new Ja;const A=n.json.accessors[m.NORMAL];h.normalArray.resize(A.count);const C=$d(n,A);E1(n,A,h.normalArray,C)}if(m.TEXCOORD_0!==void 0&&a.length>0){h.texcoordArray=new Xc;const A=n.json.accessors[m.TEXCOORD_0];h.texcoordArray.resize(A.count);const C=$d(n,A);E1(n,A,h.texcoordArray,C)}if(m._FEATURE_ID_RGBA4444!==void 0){const A=n.json.accessors[m._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=$d(n,A))}m._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array($d(n,n.json.accessors[m._FEATURE_RGBA4444]).buffer));const E=l.material;return h.material=function(A,C){const{emissiveFactor:M=[0,0,0],alphaMode:D="OPAQUE",alphaCutoff:k=.5,normalTexture:V,occlusionTexture:W,emissiveTexture:Z,doubleSided:H}=A,{baseColorFactor:Q=[1,1,1,1],metallicFactor:oe=1,roughnessFactor:fe=1,baseColorTexture:Se,metallicRoughnessTexture:we}=A.pbrMetallicRoughness||{},xe=W?C[W.index]:void 0;if(W&&W.extensions&&W.extensions.KHR_texture_transform&&xe){const ke=W.extensions.KHR_texture_transform;xe.offsetScale=[ke.offset[0],ke.offset[1],ke.scale[0],ke.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new mr(...Q),metallicFactor:oe,roughnessFactor:fe,baseColorTexture:Se?C[Se.index]:void 0,metallicRoughnessTexture:we?C[we.index]:void 0},doubleSided:H,emissiveFactor:M,alphaMode:D,alphaCutoff:k,normalTexture:V?C[V.index]:void 0,occlusionTexture:xe,emissionTexture:Z?C[Z.index]:void 0,defined:A.defined===void 0}}(E!==void 0?n.json.materials[E]:{defined:!1},a),h}function bI(l,n,a){const{matrix:u,rotation:m,translation:h,scale:g,mesh:b,extras:T,children:P}=l,v={};if(v.matrix=u||_e.mat4.fromRotationTranslationScale([],m||[0,0,0,1],h||[0,0,0],g||[1,1,1]),b!==void 0){v.meshes=a[b];const E=v.anchor=[0,0];for(const A of v.meshes){const{min:C,max:M}=A.aabb;E[0]+=C[0]+M[0],E[1]+=C[1]+M[1]}E[0]=Math.floor(E[0]/v.meshes.length/2),E[1]=Math.floor(E[1]/v.meshes.length/2)}if(T&&(T.id&&(v.id=T.id),T.lights&&(v.lights=function(E){if(!E.length)return[];const A=function(V){const W=atob(V),Z=new Uint8Array(W.length);for(let H=0;H<W.length;H++)Z[H]=W.codePointAt(H);return Z}(E),C=[],M=A.length/24,D=new Uint16Array(A.buffer),k=new Float32Array(A.buffer);for(let V=0;V<M;V++){const W=D[2*V*6]/30,Z=D[2*V*6+1]/30,H=D[2*V*6+10]/100,Q=k[6*V+1],oe=k[6*V+2],fe=k[6*V+3],Se=k[6*V+4],we=fe-Q,xe=Se-oe,ke=Math.hypot(we,xe);C.push({pos:[Q+.5*we,oe+.5*xe,Z],normal:[xe/ke,-we/ke,0],width:ke,height:W,depth:H,points:[Q,oe,fe,Se]})}return C}(T.lights))),P){const E=[];for(const A of P)E.push(bI(n.json.nodes[A],n,a));v.children=E}return v}function N5(l){if(l.vertices.length===0||l.indices.length===0)return null;const n=new Ib(l.vertices,l.indices,8,256),[a,u]=[n.min.clone(),n.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:n,min:a,max:u}}function V5(l){if(!l.extras||!l.extras.ground)return null;const n=l.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const a=n[0];if(!a||!Array.isArray(a)||a.length===0)return null;const u=[];for(const g of a){if(!Array.isArray(g)||g.length!==2)continue;const b=g[0],T=g[1];typeof b=="number"&&typeof T=="number"&&u.push(new je(b,T))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let m=0;for(let g=0;g<u.length;g++){const b=u[g],T=u[(g+1)%u.length],P=u[(g+2)%u.length];m+=(b.x-T.x)*(P.y-T.y)-(P.x-T.x)*(b.y-T.y)}m>0&&u.reverse();const h=km(u.flatMap(g=>[g.x,g.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function j5(l,n){const a=[],u=[];let m=0;const h=[];for(const g of l){m=a.length;const b=g.vertexArray.float32,T=g.indexArray.uint16;for(let P=0;P<g.vertexArray.length;P++)h[0]=b[3*P+0],h[1]=b[3*P+1],h[2]=b[3*P+2],_e.vec3.transformMat4(h,h,n),a.push(new je(h[0],h[1]));for(let P=0;P<3*g.indexArray.length;P++)u.push(T[P]+m)}if(u.length%3!=0)return null;for(let g=0;g<u.length;g+=3){const b=a[u[g+0]],T=a[u[g+1]],P=a[u[g+2]];(b.x-T.x)*(P.y-T.y)-(P.x-T.x)*(b.y-T.y)>0&&([u[g+1],u[g+2]]=[u[g+2],u[g+1]])}return{vertices:a,indices:u}}function wI(l){const n=function(T,P){const v=[],E=WebGL2RenderingContext;if(T.json.textures)for(const A of T.json.textures){const C={magFilter:E.LINEAR,minFilter:E.NEAREST,wrapS:E.REPEAT,wrapT:E.REPEAT};A.sampler!==void 0&&Object.assign(C,T.json.samplers[A.sampler]),v.push({image:P[A.source],sampler:C,uploaded:!1})}return v}(l,l.images),a=function(T,P){const v=[];for(const E of T.json.meshes){const A=[];for(const C of E.primitives)A.push(k5(C,T,P));v.push(A)}return v}(l,n),{scenes:u,scene:m,nodes:h}=l.json,g=u?u[m||0].nodes:h,b=[];for(const T of g)b.push(bI(h[T],l,a));return function(T,P,v){const E={},A=new Set;for(let C=0;C<T.length;C++){const M=v[P[C]];if(!M.extras)continue;const D=M.extras["mapbox:footprint:version"],k=M.extras["mapbox:footprint:id"];(D||k)&&A.add(C),D==="1.0.0"&&k&&(E[k]=C)}for(let C=0;C<T.length;C++){if(A.has(C))continue;const M=T[C],D=v[P[C]];if(!D.extras)continue;let k=null;M.id in E&&(k=j5(T[E[M.id]].meshes,M.matrix)),k||(k=V5(D)),k&&(M.footprint=N5(k))}if(A.size>0){const C=Array.from(A.values()).sort((M,D)=>M-D);for(let M=C.length-1;M>=0;M--)T.splice(C[M],1)}}(b,g,l.json.nodes),b}function U5(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const n=l.vertexArray.float32,a=l.aabb.min[0]-1,u=l.aabb.min[1]-1,m=Rd/(l.aabb.max[0]-a+2),h=Rd/(l.aabb.max[1]-u+2);for(let g=0;g<n.length;g+=3){const b=n[g+2],T=(n[g+0]-a)*m|0,P=(n[g+1]-u)*h|0;b>l.heightmap[P*Rd+T]&&(l.heightmap[P*Rd+T]=b)}}function H5(l,n){const a={};a.indexArray=new eo,a.indexArray.reserve(4*l.length),a.vertexArray=new Ja,a.vertexArray.reserve(10*l.length),a.colorArray=new Ql,a.vertexArray.reserve(10*l.length);let u=0;for(const g of l){const b=Math.min(10,Math.max(4,1.3*g.height))*n,T=[-g.normal[1],g.normal[0],0],P=Math.min(.29,.1*g.width/g.depth),v=g.width-2*g.depth*n*(P+.01),E=_e.vec3.scaleAndAdd([],g.pos,T,v/2),A=_e.vec3.scaleAndAdd([],g.pos,T,-v/2),C=[E[0],E[1],E[2]+g.height],M=[A[0],A[1],A[2]+g.height],D=_e.vec3.scaleAndAdd([],g.normal,T,P);_e.vec3.scale(D,D,b);const k=_e.vec3.scaleAndAdd([],g.normal,T,-P);_e.vec3.scale(k,k,b),_e.vec3.add(D,E,D),_e.vec3.add(k,A,k),E[2]+=.1,A[2]+=.1,a.vertexArray.emplaceBack(D[0],D[1],D[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]),a.vertexArray.emplaceBack(E[0],E[1],E[2]),a.vertexArray.emplaceBack(A[0],A[1],A[2]),a.vertexArray.emplaceBack(C[0],C[1],C[2]),a.vertexArray.emplaceBack(M[0],M[1],M[2]),a.vertexArray.emplaceBack(E[0],E[1],E[2]),a.vertexArray.emplaceBack(A[0],A[1],A[2]),a.vertexArray.emplaceBack(D[0],D[1],D[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]);const V=v/b/2;a.colorArray.emplaceBack(-V-P,-1,V,.8),a.colorArray.emplaceBack(V+P,-1,V,.8),a.colorArray.emplaceBack(-V,0,V,1.3),a.colorArray.emplaceBack(V,0,V,1.3),a.colorArray.emplaceBack(V+P,-.8,V,.7),a.colorArray.emplaceBack(V+P,-.8,V,.7),a.colorArray.emplaceBack(0,0,V,1.3),a.colorArray.emplaceBack(0,0,V,1.3),a.colorArray.emplaceBack(V+P,-1.2,V,.8),a.colorArray.emplaceBack(V+P,-1.2,V,.8),a.indexArray.emplaceBack(6+u,4+u,8+u),a.indexArray.emplaceBack(7+u,9+u,5+u),a.indexArray.emplaceBack(0+u,1+u,2+u),a.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const m={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=mr.white,m.pbrMetallicRoughness=h,a.material=m,a.aabb=new vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}class SI{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const u=n[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const G5=["id","tile","layer","source","sourceLayer","state"];class Df{constructor(n,a,u,m,h){this.type="Feature",this._vectorTileFeature=n,this._z=a,this._x=u,this._y=m,this.properties=n.properties,this.id=h}clone(){const n=new Df(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const a of G5)this[a]!==void 0&&(n[a]=this[a]);return n}}class CI{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Xl(Yt,16,0),this.featureIndexArray=new Cd,this.promoteId=a,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,a,u,m,h,g=0,b=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,h,g);const P=this.grid;for(let v=0;v<a.length;v++){const E=a[v],A=[1/0,1/0,-1/0,-1/0];for(let C=0;C<E.length;C++){const M=E[C];A[0]=Math.min(A[0],M.x),A[1]=Math.min(A[1],M.y),A[2]=Math.max(A[2],M.x),A[3]=Math.max(A[3],M.y)}b!==0&&(A[0]-=b,A[1]-=b,A[2]+=b,A[3]+=b),A[0]<Yt&&A[1]<Yt&&A[2]>=0&&A[3]>=0&&P.insert(T,A[0],A[1],A[2],A[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new yf.VectorTile(new $0(this.rawTileData)).layers,this.sourceLayerCoder=new SI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,a){const{tilespaceGeometry:u,transform:m,tileTransform:h,pixelPosMatrix:g,availableImages:b}=a;this.loadVTLayers(),this.serializedLayersCache.clear();const T=u.bufferedTilespaceBounds,P=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(C,M,D,k)=>Ue(u.bufferedTilespaceGeometry,C,M,D,k));P.sort(W5);let v=null;m.elevation&&P.length>0&&(v=Tf.create(m.elevation,this.tileID));const E={};let A;for(let C=0;C<P.length;C++){const M=P[C];if(M===A)continue;A=M;const D=this.featureIndexArray.get(M);let k=null;this.is3DTile?this.loadMatchingModelFeature(E,D,n,u,m):this.loadMatchingFeature(E,D,n,b,(V,W,Z,H=0)=>(k||(k=B(V,this.tileID.canonical,h)),W.queryIntersectsFeature(u,V,Z,k,this.z,m,g,v,H)))}return E}loadMatchingFeature(n,a,u,m,h){const{featureIndex:g,bucketIndex:b,sourceLayerIndex:T,layoutVertexArrayOffset:P}=a,v=this.bucketLayerIDs[b],E=u.layers,A=Object.keys(E);if(A.length&&!function(V,W){for(let Z=0;Z<V.length;Z++)if(W.indexOf(V[Z])>=0)return!0;return!1}(A,v))return;const C=u.sourceCache,M=this.sourceLayerCoder.decode(T),D=this.vtLayers[M].feature(g),k=this.getId(D,M);for(let V=0;V<v.length;V++){const W=v[V];if(!E[W])continue;const{styleLayer:Z,targets:H}=E[W];let Q={};k!==void 0&&(Q=C.getFeatureState(Z.sourceLayer,k));const oe=!h||h(D,Z,Q,P);if(!oe)continue;const fe=new Df(D,this.z,this.x,this.y,k);fe.tile=this.tileID.canonical,fe.state=Q;let Se=this.serializedLayersCache.get(W);Se||(Se=Z.serialize(),Se.id=W,this.serializedLayersCache.set(W,Se)),fe.source=Se.source,fe.sourceLayer=Se["source-layer"],fe.layer=nr({},Se),fe.layer.paint=TI(Se.paint,Z.paint,D,Q,m),fe.layer.layout=TI(Se.layout,Z.layout,D,Q,m);let we=!1;for(const xe of H){this.updateFeatureProperties(fe,xe);const{filter:ke}=xe;if(ke){if(D.properties=fe.properties,ke.needGeometry){const Ce=j(D,!0);if(!ke.filter(new Br(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!ke.filter(new Br(this.tileID.overscaledZ),D))continue}we=!0,xe.targetId&&this.addFeatureVariant(fe,xe)}we&&this.appendToResult(n,W,g,fe,oe)}}loadMatchingModelFeature(n,a,u,m,h){const g=this.bucketLayerIDs[0][0],b=u.layers;if(!b[g])return;const{styleLayer:T,targets:P}=b[g];if(T.type!=="model")return;const v=m.tile,E=a.featureIndex,A=v.getBucket(T);if(!(A&&A instanceof ry))return;const C=function(Se,we,xe,ke){const Ce=Se.getNodesInfo()[we];if(Ce.hiddenByReplacement||!Ce.node.meshes)return;let Ne=Number.MAX_VALUE;const Ze=Ce.node,Ge=xe.tile,Je=ke.calculatePosMatrix(Ge.tileID.toUnwrapped(),ke.worldSize),rt=Ce.evaluatedScale;let lt=0;ke.elevation&&Ze.elevation&&(lt=Ze.elevation*ke.elevation.exaggeration()),_e.mat4.translate(Je,Je,[(Ze.anchor?Ze.anchor[0]:0)*(rt[0]-1),(Ze.anchor?Ze.anchor[1]:0)*(rt[1]-1),lt]),_e.mat4.scale(Je,Je,rt);const nt=xe.queryGeometry,xt=nt.isPointQuery()?nt.screenBounds:nt.screenGeometry,Dt=function(Jt){const Zt=_e.mat4.multiply([],Je,Jt.matrix);_e.mat4.multiply(Zt,ke.expandedFarZProjMatrix,Zt);for(let kt=0;kt<Jt.meshes.length;++kt){const Rt=Jt.meshes[kt];if(kt===Jt.lightMeshIndex)continue;const mn=SM(xt,ke,Zt,Rt.aabb);mn!=null&&(Ne=Math.min(mn,Ne))}if(Jt.children)for(const kt of Jt.children)Dt(kt)};if(Dt(Ze),Ne===Number.MAX_VALUE)return;const vt=new sr(0,0);return LM(Ge.tileID.canonical,vt,Ce.node.anchor[0],Ce.node.anchor[1]),{intersectionZ:Ne,position:vt,feature:Ce.feature}}(A,E,m,h);if(!C)return;const{z:M,x:D,y:k}=v.tileID.canonical,{feature:V,intersectionZ:W,position:Z}=C;let H={};V.id!==void 0&&(H=u.sourceCache.getFeatureState(T.sourceLayer,V.id));const Q=new Df({},M,D,k,V.id);Q.tile=this.tileID.canonical,Q.state=H,Q.properties=V.properties,Q.geometry={type:"Point",coordinates:[Z.lng,Z.lat]};let oe=this.serializedLayersCache.get(g);oe||(oe=T.serialize(),oe.id=g,this.serializedLayersCache.set(g,oe)),Q.source=oe.source,Q.sourceLayer=oe["source-layer"],Q.layer=nr({},oe);let fe=!1;for(const Se of P){this.updateFeatureProperties(Q,Se);const{filter:we}=Se;if(we){if(V.properties=Q.properties,we.needGeometry){if(!we.filter(new Br(this.tileID.overscaledZ),V,this.tileID.canonical))continue}else if(!we.filter(new Br(this.tileID.overscaledZ),V))continue}fe=!0,Se.targetId&&this.addFeatureVariant(Q,Se)}fe&&this.appendToResult(n,g,E,Q,W)}updateFeatureProperties(n,a,u){if(a.properties){const m={};for(const h in a.properties){const g=a.properties[h].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,u);g!=null&&(m[h]=g)}n.properties=m}}addFeatureVariant(n,a,u){const m={target:a.target,namespace:a.namespace,uniqueFeatureID:a.uniqueFeatureID};a.properties&&(m.properties=n.properties),n.variants=n.variants||{},n.variants[a.targetId]=n.variants[a.targetId]||[],n.variants[a.targetId].push(m)}appendToResult(n,a,u,m,h){let g=n[a];g===void 0&&(g=n[a]=[]),g.push({featureIndex:u,feature:m,intersectionZ:h})}lookupSymbolFeatures(n,a,u,m,h){const g={};this.loadVTLayers();for(const b of n)this.loadMatchingFeature(g,{bucketIndex:a,sourceLayerIndex:u,featureIndex:b,layoutVertexArrayOffset:0},m,h);return g}loadFeature(n){const{featureIndex:a,sourceLayerIndex:u}=n;this.loadVTLayers();const m=this.sourceLayerCoder.decode(u),h=this.vtFeatures[m];if(h[a])return h[a];const g=this.vtLayers[m].feature(a);return h[a]=g,g}hasLayer(n){for(const a of this.bucketLayerIDs)for(const u of a)if(n===u)return!0;return!1}getId(n,a){let u=n.id;if(this.promoteId){const m=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[a];if(m!=null)if(Array.isArray(m)){if(!this.promoteIdExpression){const h=jc(m);if(h.result!=="success"){const g=h.value.map(b=>`${b.key}: ${b.message}`).join(", ");return void kn(`Failed to create expression for promoteId: ${g}`)}this.promoteIdExpression=h.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Ap),u=this.promoteIdExpression.evaluate({zoom:0},n)}else u=n.properties[m];typeof u=="boolean"&&(u=Number(u))}return u}}function TI(l,n,a,u,m){return xa(l,(h,g)=>{const b=n instanceof Wc?n.get(g):null;return b&&b.evaluate?b.evaluate(a,u,m):b})}function W5(l,n){return n-l}fn(CI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const EI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class M1{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const h=EI[15&u];if(!h)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(n,2,1),[b]=new Uint32Array(n,4,1);return new M1(b,g,h,n)}constructor(n,a=64,u=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=EI.indexOf(this.ArrayType),g=2*n*this.ArrayType.BYTES_PER_ELEMENT,b=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-b%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+g+b+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=a,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return I1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:b}=this,T=[0,h.length-1,0],P=[];for(;T.length;){const v=T.pop()||0,E=T.pop()||0,A=T.pop()||0;if(E-A<=b){for(let k=A;k<=E;k++){const V=g[2*k],W=g[2*k+1];V>=n&&V<=u&&W>=a&&W<=m&&P.push(h[k])}continue}const C=A+E>>1,M=g[2*C],D=g[2*C+1];M>=n&&M<=u&&D>=a&&D<=m&&P.push(h[C]),(v===0?n<=M:a<=D)&&(T.push(A),T.push(C-1),T.push(1-v)),(v===0?u>=M:m>=D)&&(T.push(C+1),T.push(E),T.push(1-v))}return P}within(n,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:h,nodeSize:g}=this,b=[0,m.length-1,0],T=[],P=u*u;for(;b.length;){const v=b.pop()||0,E=b.pop()||0,A=b.pop()||0;if(E-A<=g){for(let k=A;k<=E;k++)II(h[2*k],h[2*k+1],n,a)<=P&&T.push(m[k]);continue}const C=A+E>>1,M=h[2*C],D=h[2*C+1];II(M,D,n,a)<=P&&T.push(m[C]),(v===0?n-u<=M:a-u<=D)&&(b.push(A),b.push(C-1),b.push(1-v)),(v===0?n+u>=M:a+u>=D)&&(b.push(C+1),b.push(E),b.push(1-v))}return T}}function I1(l,n,a,u,m,h){if(m-u<=a)return;const g=u+m>>1;MI(l,n,g,u,m,h),I1(l,n,a,u,g-1,1-h),I1(l,n,a,g+1,m,1-h)}function MI(l,n,a,u,m,h){for(;m>u;){if(m-u>600){const P=m-u+1,v=a-u+1,E=Math.log(P),A=.5*Math.exp(2*E/3),C=.5*Math.sqrt(E*A*(P-A)/P)*(v-P/2<0?-1:1);MI(l,n,a,Math.max(u,Math.floor(a-v*A/P+C)),Math.min(m,Math.floor(a+(P-v)*A/P+C)),h)}const g=n[2*a+h];let b=u,T=m;for(gg(l,n,u,a),n[2*m+h]>g&&gg(l,n,u,m);b<T;){for(gg(l,n,b,T),b++,T--;n[2*b+h]<g;)b++;for(;n[2*T+h]>g;)T--}n[2*u+h]===g?gg(l,n,u,T):(T++,gg(l,n,T,m)),T<=a&&(u=T+1),a<=T&&(m=T-1)}}function gg(l,n,a,u){A1(l,a,u),A1(n,2*a,2*u),A1(n,2*a+1,2*u+1)}function A1(l,n,a){const u=l[n];l[n]=l[a],l[a]=u}function II(l,n,a,u){const m=l-a,h=n-u;return m*m+h*h}i.$=gm,i.A=io,i.B=2,i.C=Km,i.D=Ef,i.E=el,i.F=NE,i.G=class extends ty{},i.H=Ta,i.I=y1,i.J=Mh,i.K=i0,i.L=ld,i.M=sd,i.N=Wh,i.O=Vc,i.P=je,i.Q=tf,i.R=fr,i.S=t0,i.T=i1,i.U=jc,i.V=ty,i.W=td,i.X=ql,i.Y=zc,i.Z=Oo,i._=da,i.a=function(l){return ni.API_CDN_URL_REGEX.test(l)},i.a$=Df,i.a0=rm,i.a1=J_,i.a2=function(l){const n=l.value;let a=[];if(!n)return a;const u=Ta(n);return u!=="string"?(a=a.concat([new ty(l.key,n,`string expected, "${u}" found`)]),a):(TM(n,!0)||(a=a.concat([new ty(l.key,n,`invalid url "${n}"`)])),a)},i.a3=ut,i.a4=ef,i.a5=Yr,i.a6=Vt,i.a7=class{constructor(l){this.specification=l}possiblyEvaluate(l,n){return Ao(l.expression.evaluate(n))}interpolate(l,n,a){return{x:Pn(l.x,n.x,a),y:Pn(l.y,n.y,a),z:Pn(l.z,n.z,a),azimuthal:Pn(l.azimuthal,n.azimuthal,a),polar:Pn(l.polar,n.polar,a)}}},i.a8=Br,i.a9=cd,i.aA=Ma,i.aB=class{constructor(l){this.entries={},this.scheduler=l}request(l,n,a,u){const m=this.entries[l]=this.entries[l]||{callbacks:[]};if(m.result){const[h,g]=m.result;return this.scheduler?this.scheduler.add(()=>{u(h,g)},n):u(h,g),()=>{}}return m.callbacks.push(u),m.cancel||(m.cancel=a((h,g)=>{m.result=[h,g];for(const b of m.callbacks)this.scheduler?this.scheduler.add(()=>{b(h,g)},n):b(h,g);setTimeout(()=>delete this.entries[l],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(h=>h!==u),m.callbacks.length||(m.cancel(),delete this.entries[l]))}}},i.aC=Ka,i.aD=function(l,n,a){const u=JSON.stringify(l.request);return l.data&&(this.deduped.entries[u]={result:[null,l.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},m=>{const h=ki(l.request,(g,b,T,P)=>{g?m(g):b&&m(null,{vectorTile:a?void 0:new yf.VectorTile(new $0(b)),rawData:b,cacheControl:T,expires:P})});return()=>{h.cancel(),m()}},n)},i.aE=function(l){bn++,bn>ht&&(l.getActor().send("enforceCacheSizeLimit",Xe),bn=0)},i.aF=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},i.aG=Bt,i.aH=hM,i.aI=yM,i.aJ=dM,i.aK=function(l,n){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(let u=0;u<l.length;u++){const m=document.createElement("source");So(l[u])||(a.crossOrigin="Anonymous"),m.src=l[u],a.appendChild(m)}return{cancel:()=>{}}},i.aL=X0,i.aM=function(l){return fetch(l).then(n=>n.arrayBuffer()).then(n=>xI(n,0,l))},i.aN=wI,i.aO=class{constructor(l,n,a,u){this.id=l,this.position=n!=null?new sr(n[0],n[1]):new sr(0,0),this.orientation=a??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,n){if(_e.mat4.multiply(l.matrix,n,l.matrix),l.meshes)for(const a of l.meshes){const u=vn.applyTransformFast(a.aabb,l.matrix);this.aabb.encapsulate(u)}if(l.children)for(const a of l.children)this._applyTransformations(a,l.matrix)}computeBoundsAndApplyParent(){const l=_e.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,l)}computeModelMatrix(l,n,a,u,m,h,g=!1){PM(this.matrix,this,l.transform,this.position,n,a,u,m,h,g)}upload(l){if(!this.uploaded){for(const n of this.nodes)c1(n,l);for(const n of this.nodes)ny(n);this.uploaded=!0}}destroy(){for(const l of this.nodes)u1(l)}},i.aP=Xi,i.aQ=eg,i.aR=jo,i.aS=to,i.aT=Ps,i.aU=eo,i.aV=xi,i.aW=Pm,i.aX=Z0,i.aY=function(){Zo.isLoading()||Zo.isLoaded()||Jh()!=="deferred"||fd()},i.aZ=o0,i.a_=j,i.aa=s,i.ab=_e,i.ac=Hn,i.ad=Wc,i.ae=Ro,i.af=Pn,i.ag=Yt,i.ah=$_,i.ai=zt,i.aj=mr,i.ak=class{constructor(l){this.specification=l}possiblyEvaluate(l,n){return function([a,u]){const m=Ao([1,a,u]);return{x:m.x,y:m.y,z:m.z}}(l.expression.evaluate(n))}interpolate(l,n,a){return{x:Pn(l.x,n.x,a),y:Pn(l.y,n.y,a),z:Pn(l.z,n.z,a)}}},i.al=function(l,n,a=0,u=!0){const m=new je(a,a),h=l.sub(m),g=n.add(m),b=[h,new je(g.x,h.y),g,new je(h.x,g.y)];return u&&b.push(h.clone()),b},i.am=function(l,n){const a=[];for(let u=0;u<l.length;u++){const m=tr(u-1,-1,l.length-1),h=tr(u+1,-1,l.length-1),g=l[u],b=l[h],T=l[m].sub(g).unit(),P=b.sub(g).unit(),v=P.angleWithSep(T.x,T.y),E=T.add(P).unit().mult(-1*n/Math.sin(v/2));a.push(g.add(E))}return a},i.an=KE,i.ao=Ue,i.ap=function(l,n,a=0){return _e.vec3.fromValues(((n.x-a)*l.scale-l.x)*Yt,(n.y*l.scale-l.y)*Yt,C0(n.z,n.y))},i.aq=$n,i.ar=mE,i.as=function(l){let n=1/0,a=1/0,u=-1/0,m=-1/0;for(const h of l)n=Math.min(n,h.x),a=Math.min(a,h.y),u=Math.max(u,h.x),m=Math.max(m,h.y);return{min:new je(n,a),max:new je(u,m)}},i.at=ts,i.au=Ae,i.av=_,i.aw=Qt,i.ax=To,i.ay=function(l,n){const a={};for(let u=0;u<n.length;u++){const m=n[u];m in l&&(a[m]=l[m])}return a},i.az=hl,i.b=function(l){return ni.API_FONTS_REGEX.test(l)},i.b$=Q0,i.b0=Dl,i.b1=Fb,i.b2=Mb,i.b3=B,i.b4=As,i.b5=Im,i.b6=Tn,i.b7=di,i.b8=km,i.b9=t1,i.bA=qT,i.bB=Yb,i.bC=qE,i.bD=Wb,i.bE=M1,i.bF=tr,i.bG=zl,i.bH=Eo,i.bI=function(l,n,a){l[4*n+0]=a[0],l[4*n+1]=a[1],l[4*n+2]=a[2],l[4*n+3]=a[3]},i.bJ=Pd,i.bK=pa,i.bL=Kc,i.bM=mi,i.bN=Id,i.bO=sr,i.bP=nM,i.bQ=Tt,i.bR=or,i.bS=xM,i.bT=Ot,i.bU=po,i.bV=function(l,n,a,u,m,h,g,b,T){if(T.name==="globe")return po(l,n,new Ot(a,u,m),!1);const P=eg({z:a,x:u,y:m},T);return new vn([(h+P.x/P.scale)*n,n*(P.y/P.scale),g],[(h+P.x2/P.scale)*n,n*(P.y2/P.scale),b])},i.bW=function(l,n,a){let u=0;for(let m=0;m<2;++m)l[m]>0&&(u+=(l[m]-0)*(l[m]-0)),n[m]<0&&(u+=(0-n[m])*(0-n[m]));return u},i.bX=hi,i.bY=w0,i.bZ=function(l){const n=_e.mat4.identity(new Float64Array(16));_e.mat4.multiply(n,l.pixelMatrix,l.globeMatrix);const a=[0,Yo,0],u=[0,Xo,0];return _e.vec3.transformMat4(a,a,n),_e.vec3.transformMat4(u,u,n),[a[0]>0&&a[0]<=l.width&&a[1]>0&&a[1]<=l.height&&!ga(l,new sr(l.center.lat,90)),u[0]>0&&u[0]<=l.width&&u[1]>0&&u[1]<=l.height&&!ga(l,new sr(l.center.lat,-90))]},i.b_=function(l,n){const{scale:a}=l.tileTransform,u=a*Yt/(l.tileSize*Math.pow(2,n.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return _e.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},i.ba=function(l,n){const a=Ro(n.zoom);if(a===0)return Pi(l);const u=Kr(l),m=zr(u),h=ts(u.getWest())*n.worldSize,g=ts(u.getEast())*n.worldSize,b=Ma(u.getNorth())*n.worldSize,T=Ma(u.getSouth())*n.worldSize,P=[h,b,0],v=[g,b,0],E=[h,T,0],A=[g,T,0],C=_e.mat4.invert([],n.globeMatrix);return _e.vec3.transformMat4(P,P,C),_e.vec3.transformMat4(v,v,C),_e.vec3.transformMat4(E,E,C),_e.vec3.transformMat4(A,A,C),m[0]=Oi(m[0],E,a),m[1]=Oi(m[1],A,a),m[2]=Oi(m[2],v,a),m[3]=Oi(m[3],P,a),vn.fromPoints(m)},i.bb=Vi,i.bc=Or,i.bd=Oi,i.be=Yc,i.bf=wn,i.bg=w1,i.bh=$0,i.bi=ki,i.bj=function(l){const n=[];for(const a in l)n.push(l[a]);return n},i.bk=function(l,n){const a=[];for(const u in l)u in n||a.push(u);return a},i.bl=Pr,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=Mt,i.bo=function(l,n){const{x:a,y:u}=l.point,m=Uo(a,u,l.worldSize/l._pixelsPerMercatorPixel,0,0);return _e.mat4.multiply(m,m,Dr(Pi(n)))},i.bp=vf,i.bq=Ia,i.br=L0,i.bs=function(l,n,a,u,m){const h=5*n+2;l.float32[h+0]=a,l.float32[h+1]=u,l.float32[h+2]=m},i.bt=q0,i.bu=kE,i.bv=ie,i.bw=go,i.bx=VT,i.by=CM,i.bz=WT,i.c=Pc,i.c$=(l,n,a,u,m,h,g,b)=>{const T=l.transform,P=T.pitch<15?gE(.07,.7,Qt((14-T.zoom)/5,0,1)):.07,v=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:yE(l,n,a,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:m,u_width_scale:h,u_floor_width_scale:g,u_image:0,u_tile_units_to_pixels:_E(n,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toRenderColor(v?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:P,u_tile_to_meter:r(n.tileID.canonical,0)}},i.c0=vM,i.c1=function(l){const n=vM(l,!0);return _e.mat2.invert([],[n[0],n[1],n[4],n[5]])},i.c2=Jn,i.c3=function(l){const{x:n,y:a}=l.point,{lng:u,lat:m}=l._center;return Uo(n,a,l.worldSize,u,m)},i.c4=Kt,i.c5=Ht,i.c6=Jc,i.c7=function(l){const n=Math.round((l+45+360)%360/90)%4;return an[n]},i.c8=45,i.c9=mf,i.cA=class extends es{constructor(l){super(l),this.current=Dm}set(l,n,a){if(this.fetchUniformLocation(l,n)){for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},i.cB=un,i.cC=function(l,n,a){const u=Ro(a.zoom),m=l.style.map._antialias,h=l.terrain&&l.terrain.exaggeration()>0;return u===0&&!m&&!h},i.cD=function(l){const n=l.pixelsPerMeter,a=n/Eo(1,l.center.lat),u=_e.mat4.identity(new Float64Array(16));return _e.mat4.translate(u,u,[l.point.x,l.point.y,0]),_e.mat4.scale(u,u,[a,a,n]),Float32Array.from(u)},i.cE=Kr,i.cF=function(l){const n=hi-5;l=Qt(l,-n,n)/n*90;const a=Math.pow(Math.abs(Math.sin(zt(l))),3);return Math.round(a*(pf.length-1))},i.cG=function(l,n,a,u){const m=n.getNorth(),h=n.getSouth(),g=n.getWest(),b=n.getEast(),T=1<<l.z,P=b-g,v=m-h,E=P/Qc,A=-v/pf[a],C=[0,E,0,A,0,0,m,g,0];if(l.z>0){const M=180/u;_e.mat3.multiply(C,C,[M/P+1,0,0,0,M/v+1,0,-.5*M/E,.5*M/A,1])}return C[2]=T,C[5]=l.x,C[8]=l.y,C},i.cH=Pi,i.cI=function(l,n,a){const u=_e.mat4.identity(new Float64Array(16)),m=(n/(1<<l)-.5)*Math.PI*2;return _e.mat4.rotateY(u,a.globeMatrix,m),Float32Array.from(u)},i.cJ=class{isDataAvailableAtPoint(l){const n=this._source();if(this.isUsingMockSource()||!n||l.y<0||l.y>1)return!1;const a=n.getSource().maxzoom,u=1<<a,m=Math.floor(l.x),h=Math.floor((l.x-m)*u),g=Math.floor(l.y*u),b=this.findDEMTileFor(new Bt(a,m,a,h,g));return!(!b||!b.dem)}getAtPointOrZero(l,n=0){return this.getAtPoint(l,n)||0}getAtPoint(l,n,a=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||l.y<0||l.y>1)return n;const m=u.getSource().maxzoom,h=1<<m,g=Math.floor(l.x),b=l.x-g,T=new Bt(m,g,m,Math.floor(b*h),Math.floor(l.y*h)),P=this.findDEMTileFor(T);if(!P||!P.dem)return n;const v=P.dem,E=1<<P.tileID.canonical.z,A=(b*E-P.tileID.canonical.x)*v.dim,C=(l.y*E-P.tileID.canonical.y)*v.dim,M=Math.floor(A),D=Math.floor(C);return(a?this.exaggeration():1)*Pn(Pn(v.get(M,D),v.get(M,D+1),C-D),Pn(v.get(M+1,D),v.get(M+1,D+1),C-D),A-M)}getAtTileOffset(l,n,a){const u=1<<l.canonical.z;return this.getAtPointOrZero(new s(l.wrap+(l.canonical.x+n/Yt)/u,(l.canonical.y+a/Yt)/u))}getAtTileOffsetFunc(l,n,a,u){return m=>{const h=this.getAtTileOffset(l,m.x,m.y),g=u.upVector(l.canonical,m.x,m.y),b=u.upVectorScale(l.canonical,n,a).metersToTile;return _e.vec3.scale(g,g,h*b),g}}getForTilePoints(l,n,a,u){if(this.isUsingMockSource())return!1;const m=Tf.create(this,l,u);return!!m&&(n.forEach(h=>{h[2]=this.exaggeration()*m.getElevationAt(h[0],h[1],a)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(l);if(!n||!n.dem)return null;const a=n.dem.tree,u=n.tileID,m=1<<l.canonical.z-u.canonical.z;let h=l.canonical.x/m-u.canonical.x,g=l.canonical.y/m-u.canonical.y,b=0;for(let T=0;T<l.canonical.z-u.canonical.z&&!a.leaves[b];T++){h*=2,g*=2;const P=2*Math.floor(g)+Math.floor(h);b=a.childOffsets[b]+P,h%=1,g%=1}return{min:this.exaggeration()*a.minimums[b],max:this.exaggeration()*a.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,n,a){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let n=!1,a=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const m of l){const h=this.getMinMaxForTile(m.tileID);h&&(a=Math.min(a,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:a,max:u}:null}},i.cK=xT,i.cL=Xn,i.cM=function(l,n){return[Math.pow(l[0],2.2)*n,Math.pow(l[1],2.2)*n,Math.pow(l[2],2.2)*n]},i.cN=ma,i.cO=Ll,i.cP=Js,i.cQ=256,i.cR=function(l,n){const a=[0,0,0],u=Vi(Pi(n.canonical));return _e.vec3.transformMat4(a,a,u),_e.vec3.transformMat4(a,a,l),a},i.cS=l=>({u_camera_to_center_distance:new mi(l),u_extrude_scale:new Rm(l),u_device_pixel_ratio:new mi(l),u_matrix:new Pd(l),u_inv_rot_matrix:new Pd(l),u_merc_center:new pa(l),u_tile_id:new Kc(l),u_zoom_transition:new mi(l),u_up_dir:new Kc(l),u_emissive_strength:new mi(l)}),i.cT=l=>({u_matrix:new Pd(l),u_pixels_to_tile_units:new Rm(l),u_device_pixel_ratio:new mi(l),u_width_scale:new mi(l),u_floor_width_scale:new mi(l),u_units_to_pixels:new pa(l),u_dash_image:new Id(l),u_gradient_image:new Id(l),u_image_height:new mi(l),u_texsize:new pa(l),u_tile_units_to_pixels:new mi(l),u_alpha_discard_threshold:new mi(l),u_trim_offset:new pa(l),u_trim_fade_range:new pa(l),u_trim_color:new Ad(l),u_emissive_strength:new mi(l),u_zbias_factor:new mi(l),u_tile_to_meter:new mi(l)}),i.cU=l=>({u_matrix:new Pd(l),u_texsize:new pa(l),u_pixels_to_tile_units:new Rm(l),u_device_pixel_ratio:new mi(l),u_width_scale:new mi(l),u_floor_width_scale:new mi(l),u_image:new Id(l),u_units_to_pixels:new pa(l),u_tile_units_to_pixels:new mi(l),u_alpha_discard_threshold:new mi(l),u_trim_offset:new pa(l),u_trim_fade_range:new pa(l),u_trim_color:new Ad(l),u_emissive_strength:new mi(l),u_zbias_factor:new mi(l),u_tile_to_meter:new mi(l)}),i.cV=Sm,i.cW=XF,i.cX=KF,i.cY=nu,i.cZ=(l,n,a,u,m,h)=>{const g=l.transform,b=g.projection.name==="globe";let T;if(h.paint.get("circle-pitch-alignment")==="map")if(b){const v=ma(g.zoom,n.canonical)*g._pixelsPerMercatorPixel;T=Float32Array.from([v,0,0,v])}else T=g.calculatePixelsToTileUnitsMatrix(a);else T=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const P={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(g.projection),u_matrix:l.translatePosMatrix(n.projMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:De.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:ac,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(b){P.u_inv_rot_matrix=u,P.u_merc_center=m,P.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],P.u_zoom_transition=Ro(g.zoom);const v=m[0]*Yt,E=m[1]*Yt;P.u_up_dir=g.projection.upVector(new Ot(0,0,0),v,E)}return P},i.c_=vE,i.ca=Ad,i.cb=function(l,n,a){const u=Math.sqrt(l*l+n*n+a*a),m=u>0?Math.acos(a/u)*qt:0;let h=l!==0||n!==0?Math.atan2(-n,-l)*qt+90:0;return h<0&&(h+=360),[u,h,m]},i.cc=r,i.cd=vn,i.ce=Ao,i.cf=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},i.cg=function(l,n){return l.readFields(jB,{icons:[]},n)},i.ch=function(l){return l({pluginStatus:No,pluginURL:al}),Uc.on("pluginStateChange",l),l},i.ci=iy,i.cj=bf,i.ck=qb,i.cl=Ga,i.cm=fm,i.cn=qe,i.co=Sa,i.cp=ci,i.cq=function(l){const n=l.indexOf(rf);return n>=0?l.slice(0,n):l},i.cr=function(l){return l.indexOf(rf)>=0},i.cs=function(l){const n=l.indexOf(rf);return n>=0?l.slice(n+1):""},i.ct=function(l){const n=[],a=l.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),l.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},i.cu=function(l,n,a,u){return l.type==="custom"?new IB(l,n):new kB[l.type](l,n,a,u)},i.cv=Bi,i.cw=class extends Df{constructor(l,n){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state=Object.assign({},l.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},i.cx=Uc,i.cy=Li,i.cz=v0,i.d=function(l){return ni.API_TILEJSON_REGEX.test(l)},i.d$=CI,i.d0=(l,n,a,u,m,h,g,b,T)=>{const P=l.transform,v=P.calculatePixelsToTileUnitsMatrix(n),E=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none",A=P.pitch<15?gE(.07,.7,Qt((14-P.zoom)/5,0,1)):.07;return{u_matrix:yE(l,n,a,u),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_width_scale:g,u_floor_width_scale:b,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:xE(a)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:_E(n,l.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toRenderColor(E?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:A,u_tile_to_meter:r(n.tileID.canonical,0)}},i.d1=Yi,i.d2=Bm,i.d3=aE,i.d4=rn,i.d5=z0,i.d6=iu,i.d7=450,i.d8=7,i.d9=MB,i.dA=Sn,i.dB=f,i.dC=rc,i.dD=function([l,n,a]){const u=Math.hypot(l,n,a),m=Math.atan2(l,a),h=.5*Math.PI-Math.acos(-n/u);return new sr(Kt(m),Kt(h))},i.dE=a1,i.dF=function(l){const n=l.navigator?l.navigator.userAgent:null;return!!function(a){if(Rl==null){const u=a.navigator?a.navigator.userAgent:null;Rl=!!a.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Rl}(l)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(l,n){Xe=l,ht=n},i.dH=ga,i.dI=ns,i.dJ=function(l){const n=[0,0,0],a=_e.mat4.identity(new Float64Array(16));return _e.mat4.multiply(a,l.pixelMatrix,l.globeMatrix),_e.vec3.transformMat4(n,n,a),new je(n[0],n[1])},i.dK=function(l,n,a=!1){if(No===hd||No===Kh||No===hm)throw new Error("setRTLTextPlugin cannot be called multiple times.");al=De.resolveURL(l),No=hd,Xa=n,pm(),a||fd()},i.dL=Jh,i.dM=function(){iy().acquire(h1)},i.dN=function(){const l=lg;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(h1),lg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=Ld,i.dP=function(l){const n=jt();if(!n)return;const a=n.delete(at);l&&a.catch(l).then(()=>l())},i.dQ=sg,i.dR=fI,i.dS=function(l){S1=De.resolveURL(l),Of||(Of=new Ef(iy(),new el)),Of.broadcast("setDracoUrl",S1)},i.dT=pI,i.dU=function(l){Pf=De.resolveURL(l),Of||(Of=new Ef(iy(),new el)),Of.broadcast("setMeshoptUrl",Pf)},i.dV=fn,i.dW=ru,i.dX=Rs,i.dY=yf,i.dZ=class{constructor(l,n){this.pos=l,this.dir=n}intersectsPlane(l,n,a){const u=_e.vec2.dot(n,this.dir);if(Math.abs(u)<1e-6)return!1;const m=((l[0]-this.pos[0])*n[0]+(l[1]-this.pos[1])*n[1])/u;return a[0]=this.pos[0]+this.dir[0]*m,a[1]=this.pos[1]+this.dir[1]*m,!0}},i.d_=SI,i.da=gr,i.db=Am,i.dc=256,i.dd=Dr,i.de=Ja,i.df=cl,i.dg=lf,i.dh=function(l,n,a,u,m){return Qt((l-n)/(a-n)*(m-u)+u,u,m)},i.di=Hh,i.dj=tu,i.dk=class{constructor(l,n,a,u){this.context=l,this.format=u,this.size=a,this.texture=l.gl.createTexture();const[m,h,g]=this.size,{gl:b}=l;b.bindTexture(b.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),b.texImage3D(b.TEXTURE_3D,0,this.format,m,h,g,0,n1(this.format),r1(this.format),n.data)}bind(l,n){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_3D,this.texture),l!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,l),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,l),this.minFilter=l),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},i.dl=s1,i.dm=[1,1,1],i.dn=Tf,i.dp=Cf,i.dq=ll,i.dr=Xc,i.ds=ic,i.dt=cf,i.du=Qa,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new je(1/0,1/0),max:new je(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,n=!1){const a=UT(new je(0,0),new je(Yt,Yt),l),u=[];if(n&&!Db(a,this._globalClipBounds))return u;for(const m of this._activeRegions){if(m.hiddenByOverlap||!Db(a,m))continue;const h=SF(m.min,m.max,l);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return u}setSources(l){this._setSources(l.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const a=[];for(const u of n.cache.getVisibleCoordinates()){const m=n.cache.getTile(u).buckets[n.layer];m&&m.updateFootprints(u.toUnwrapped(),a)}return a},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(l){const n=l.getFootprints();if(n.length===0)return;const a=l.getOrder(),u=l.getClipMask(),m=l.getClipScope();for(const h of n){if(!h.footprint)continue;const g=UT(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:a,clipMask:u,clipScope:m})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,a)=>n.priority-a.priority||D0(n.min,a.min)||D0(n.max,a.max)||n.order-a.order||n.clipMask-a.clipMask||function(u,m){const h=(g,b)=>g+b;return u.length-m.length||u.reduce(h,"").localeCompare(m.reduce(h,""))}(n.clipScope,a.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let n=0;for(;!l&&n!==this._activeRegions.length;){const a=this._activeRegions[n],u=this._prevRegions[n];l=a.priority!==u.priority||!jT(a,u)||a.order!==u.order||a.clipMask!==u.clipMask||!Mt(a.clipScope,u.clipScope),++n}}if(l){++this._updateTime;for(const a of this._activeRegions)a.order!==O0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,a.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,a.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,a.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,a.max.y));const n=a=>{const u=this._activeRegions;if(a>=u.length)return a;const m=u[a].priority;for(;a<u.length&&u[a].priority===m;)++a;return a};if(this._sourceIds.length>1){let a=0,u=n(a);for(;a!==u;){let m=a;const h=a;for(;m!==u;){const g=this._activeRegions[m];g.hiddenByOverlap=!1;for(let b=0;b<h;b++){const T=this._activeRegions[b];if(!T.hiddenByOverlap&&g.order===O0&&Db(g,T)&&(g.hiddenByOverlap=GT(g.footprint,g.tileId,T.footprint,T.tileId),g.hiddenByOverlap))break}++m}a=u,u=n(a)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=l.length-1;n>=0;n--)this._addSource(l[n]);this._computeReplacement()}},i.dw=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,n){const a=new As,u=new eo,m=[],h=l+1+2,g=n[0]+1,b=n[0]+1+(1+n.length),T=(P,v,E)=>{let A=P===h-1?P-2:P===0?P:P-1;return A+=E?24575:0,[A,v]};for(let P=0;P<h;++P)a.emplaceBack(...T(P,0,!0));for(let P=0;P<g;++P)for(let v=0;v<h;++v)a.emplaceBack(...T(v,P,(v===0||v===h-1)&&!0));for(let P=0;P<n.length;++P){const v=n[P];for(let E=0;E<h;++E)a.emplaceBack(...T(E,v,!0))}for(let P=0;P<n.length;++P){const v=u.length,E=n[P]+1+2,A=new eo;for(let D=0;D<E-1;D++){const k=D===E-2,V=k?h*(b-n.length+P-D):h;for(let W=0;W<h-1;W++){const Z=D*h+W;D===0||k||W===0||W===h-2?(A.emplaceBack(Z+1,Z,Z+V),A.emplaceBack(Z+V,Z+V+1,Z+1)):(u.emplaceBack(Z+1,Z,Z+V),u.emplaceBack(Z+V,Z+V+1,Z+1))}}const C=di.simpleSegment(0,v,a.length,u.length-v);for(let D=0;D<A.uint16.length;D+=3)u.emplaceBack(A.uint16[D],A.uint16[D+1],A.uint16[D+2]);const M=di.simpleSegment(0,v,a.length,u.length-v);m.push({withoutSkirts:C,withSkirts:M})}return{vertices:a,indices:u,segments:m}}_createGrid(l){const n=this._fillGridMeshWithLods(Qc,pf);this._gridSegments=n.segments,this._gridBuffer=l.createVertexBuffer(n.vertices,Tn.members),this._gridIndexBuffer=l.createIndexBuffer(n.indices,!0)}_createPoles(l){const n=new eo;for(let g=0;g<=Qc;g++)n.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=l.createIndexBuffer(n,!0);const a=new cl,u=new cl,m=new cl,h=new cl;this._poleSegments=[];for(let g=0,b=0;g<Jc;g++){const T=360/(1<<g);a.emplaceBack(0,-To,0,.5,0),u.emplaceBack(0,-To,0,.5,1),m.emplaceBack(0,-To,0,.5,.5),h.emplaceBack(0,-To,0,.5,.5);for(let P=0;P<=Qc;P++){let v=P/Qc,E=0;const A=Pn(0,T,v),[C,M,D]=eu(oc,rs,A,To);a.emplaceBack(C,M,D,v,E),u.emplaceBack(C,M,D,v,1-E);const k=zt(A);v=.5+.5*Math.sin(k),E=.5+.5*Math.cos(k),m.emplaceBack(C,M,D,v,E),h.emplaceBack(C,M,D,v,1-E)}this._poleSegments.push(di.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(a,Dn,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(u,Dn,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(m,Dn,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(h,Dn,!1)}getGridBuffers(l,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},i.dx=O0,i.dy=Nn,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=ni,i.e0=hE,i.e1=xa,i.e2=Ya,i.e3=VE,i.e4=function(l,n,a,u,m,h,g,b,T,P,v=1,E,A){l.createArrays(),l.tilePixelRatio=Yt/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const C=l.layers[0].layout,M=l.layers[0]._unevaluatedLayout._values,D={};D.scaleFactor=v,D.textSizeScaleRange=C.get("text-size-scale-range"),D.iconSizeScaleRange=C.get("icon-size-scale-range");const[k,V]=D.textSizeScaleRange,[W,Z]=D.iconSizeScaleRange;if(D.textScaleFactor=Qt(D.scaleFactor,k,V),D.iconScaleFactor=Qt(D.scaleFactor,W,Z),l.textSizeData.kind==="composite"){const{minZoom:fe,maxZoom:Se}=l.textSizeData;D.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Br(fe),b),M["text-size"].possiblyEvaluate(new Br(Se),b)]}if(l.iconSizeData.kind==="composite"){const{minZoom:fe,maxZoom:Se}=l.iconSizeData;D.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Br(fe),b),M["icon-size"].possiblyEvaluate(new Br(Se),b)]}D.layoutTextSize=M["text-size"].possiblyEvaluate(new Br(T+1),b),D.layoutIconSize=M["icon-size"].possiblyEvaluate(new Br(T+1),b),D.textMaxSize=M["text-size"].possiblyEvaluate(new Br(18),b);const H=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point",Q=C.get("text-size");let oe=!1;for(const fe of l.features)if(fe.icon&&fe.icon.nameSecondary){oe=!0;break}for(const fe of l.features){const Se=C.get("text-font").evaluate(fe,{},b).join(","),we=Q.evaluate(fe,{},b)*D.textScaleFactor,xe=D.layoutTextSize.evaluate(fe,{},b)*D.textScaleFactor,ke=(D.layoutIconSize.evaluate(fe,{},b),{horizontal:{},vertical:void 0}),Ce=fe.text;let Ne,Ze=[0,0];if(Ce){const rt=Ce.toString(),lt=C.get("text-letter-spacing").evaluate(fe,{},b)*go,nt=C.get("text-line-height").evaluate(fe,{},b)*go,xt=lb(rt)?lt:0,Dt=C.get("text-anchor").evaluate(fe,{},b),vt=C.get("text-variable-anchor");if(!vt){const mn=C.get("text-radial-offset").evaluate(fe,{},b);Ze=mn?qE(Dt,[mn*go,Zb]):C.get("text-offset").evaluate(fe,{},b).map(en=>en*go)}let Jt=H?"center":C.get("text-justify").evaluate(fe,{},b);const Zt=C.get("symbol-placement")==="point",kt=Zt?C.get("text-max-width").evaluate(fe,{},b)*go:1/0,Rt=mn=>{l.allowVerticalPlacement&&lm(rt)&&(ke.vertical=Gb(Ce,n,a,m,Se,kt,nt,Dt,mn,xt,Ze,Ia.vertical,!0,xe,we))};if(!H&&vt){const mn=Jt==="auto"?vt.map(sn=>Yb(sn)):[Jt];let en=!1;for(let sn=0;sn<mn.length;sn++){const zn=mn[sn];if(!ke.horizontal[zn])if(en)ke.horizontal[zn]=ke.horizontal[0];else{const Vn=Gb(Ce,n,a,m,Se,kt,nt,"center",zn,xt,Ze,Ia.horizontal,!1,xe,we);Vn&&(ke.horizontal[zn]=Vn,en=Vn.positionedLines.length===1)}}Rt("left")}else{if(Jt==="auto"&&(Jt=Yb(Dt)),Zt||C.get("text-writing-mode").indexOf("horizontal")>=0||!lm(rt)){const mn=Gb(Ce,n,a,m,Se,kt,nt,Dt,Jt,xt,Ze,Ia.horizontal,!1,xe,we);mn&&(ke.horizontal[Jt]=mn)}Rt(Zt?"left":Jt)}}let Ge=!1;if(fe.icon&&fe.icon.namePrimary){const rt=Nb(l.iconSizeData,M["icon-size"],b,l.zoom,fe)*D.iconScaleFactor*E,lt=fe.icon.getPrimary().scaleSelf(rt).serialize(),nt=u[lt];nt&&(Ne=sB(m[lt],fe.icon.nameSecondary?m[fe.icon.getSecondary().scaleSelf(rt).serialize()]:void 0,C.get("icon-offset").evaluate(fe,{},b),C.get("icon-anchor").evaluate(fe,{},b)),Ge=nt.sdf,l.sdfIcons===void 0?l.sdfIcons=nt.sdf:l.sdfIcons!==nt.sdf&&kn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(nt.pixelRatio!==l.pixelRatio||C.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const Je=YE(ke.horizontal)||ke.vertical;l.iconsInText||(l.iconsInText=!!Je&&Je.iconsInText),(Je||Ne)&&pB(l,fe,ke,Ne,u,D,xe,0,Ze,Ge,g,b,P,A,oe)}h&&l.generateCollisionDebugBuffers(T,l.collisionBoxArray,D.textScaleFactor)},i.e5=uy,i.e6=Ye,i.e7=FT,i.e8=EE,i.e9=O,i.ea=function(l){let n=0;if(new Uint32Array(l,0,1)[0]!==gI){const a=new Uint32Array(l,0,7),[,,u,m,h,g]=a;n=a.byteLength+m+h+g+h,(u!==l.byteLength||n>=l.byteLength)&&kn("Invalid b3dm header information.")}return xI(l,n)},i.eb=function(l,n){const a=wI(l);for(const u of a){for(const m of u.meshes)U5(m);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(H5(u.lights,n)))}return a},i.ec=ry,i.ed=$M,i.ee=Zo,i.ef=function(l){Wt(),ft!=null&&ft.then(n=>{n.keys().then(a=>{for(let u=0;u<a.length-l;u++)n.delete(a[u])})})},i.f=function(l){return l.indexOf("mapbox:")===0},i.g=function(l,n){return Li(nr(l,{method:"GET"}),n)},i.h=$l,i.i=function(l){return ni.API_STYLE_REGEX.test(l)&&!Pc(l)},i.j=function(l){return decodeURIComponent(atob(l).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(n,a)=>String.fromCharCode(+("0x"+a))))},i.l=nr,i.m=In,i.n=function(l,n){return Li(nr(l,{type:"json"}),n)},i.o=xp,i.p=function(l,n){return Li(nr(l,{method:"POST"}),n)},i.q=De,i.r=ao,i.s=function(l){try{const n=self[l];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=ye,i.u=function(){return function l(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},i.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},i.w=kn,i.x=function(){return f1||(f1=new Ld),f1},i.y=Th,i.z=qa}),y(["./shared"],function(i){function O(mt){const ae=mt?mt.url.toString():void 0;return ae?performance.getEntriesByName(ae):[]}function L(mt){if(typeof mt=="number"||typeof mt=="boolean"||typeof mt=="string"||mt==null)return JSON.stringify(mt);if(Array.isArray(mt)){let pe="[";for(const ye of mt)pe+=`${L(ye)},`;return`${pe}]`}let ae="{";for(const pe of Object.keys(mt).sort())ae+=`${pe}:${L(mt[pe])},`;return`${ae}}`}function z(mt){let ae="";for(const pe of i.bm)(mt.type!=="model"||pe!=="minzoom"&&pe!=="maxzoom")&&(ae+=`/${L(mt[pe])}`);return ae}class F{constructor(ae){this.keyCache={},this._layers={},this._layerConfigs={},ae&&this.replace(ae)}replace(ae,pe){this._layerConfigs={},this._layers={},this.update(ae,[],pe)}update(ae,pe,ye){this._options=ye;for(const ze of ae)this._layerConfigs[ze.id]=ze,(this._layers[ze.id]=i.cu(ze,this.scope,null,this._options)).compileFilter(ye),this.keyCache[ze.id]&&delete this.keyCache[ze.id];for(const ze of pe)delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze];this.familiesBySource={};const De=function(ze,qe){const at={};for(let ht=0;ht<ze.length;ht++){const dt=ze[ht];let ft=qe&&qe[dt.id];!ft&&(ft=z(dt),dt.type==="line"&&dt.paint)&&function jt(Wt){return typeof Wt=="string"&&Wt==="line-progress"||(Array.isArray(Wt)?Wt.some(jt):!(!Wt||typeof Wt!="object")&&Object.values(Wt).some(jt))}(dt.paint["line-width"])&&(ft+=`/${L(dt.paint["line-width"])}`),qe&&(qe[dt.id]=ft);let At=at[ft];At||(At=at[ft]=[]),At.push(dt)}const Xe=[];for(const ht in at)Xe.push(at[ht]);return Xe}(i.bj(this._layerConfigs),this.keyCache);for(const ze of De){const qe=ze.map(At=>this._layers[At.id]),at=qe[0];if(at.visibility==="none")continue;const Xe=at.source||"";let ht=this.familiesBySource[Xe];ht||(ht=this.familiesBySource[Xe]={});const dt=at.sourceLayer||"_geojsonTileLayer";let ft=ht[dt];ft||(ft=ht[dt]=[]),ft.push(qe)}}}const N=1*i.dX;class G{constructor(ae){const pe={},ye=[];for(const at in ae){const Xe=ae[at],ht=pe[at]={};for(const dt in Xe.glyphs){const ft=Xe.glyphs[+dt];if(!ft||ft.bitmap.width===0||ft.bitmap.height===0)continue;const At=ft.metrics.localGlyph?N:1,jt={x:0,y:0,w:ft.bitmap.width+2*At,h:ft.bitmap.height+2*At};ye.push(jt),ht[dt]=jt}}const{w:De,h:ze}=i.F(ye),qe=new i.dW({width:De||1,height:ze||1});for(const at in ae){const Xe=ae[at];for(const ht in Xe.glyphs){const dt=Xe.glyphs[+ht];if(!dt||dt.bitmap.width===0||dt.bitmap.height===0)continue;const ft=pe[at][ht],At=dt.metrics.localGlyph?N:1;i.dW.copy(dt.bitmap,qe,{x:0,y:0},{x:ft.x+At,y:ft.y+At},dt.bitmap)}}this.image=qe,this.positions=pe}}i.dV(G,"GlyphAtlas");const Y="3d_elevation_id",K="hd_road_elevation";class J{constructor(){this._valid=!1}reset(ae){return this.feature=ae,this._valid=!0,this._geometry=ae.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ae,pe){return this._valid&&ae(pe(this._geometry)),this}require(ae,pe,ye){return this.get(ae,!0,pe,ye)}optional(ae,pe,ye){return this.get(ae,!1,pe,ye)}success(){return this._valid}get(ae,pe,ye,De){const ze=this.feature.properties.hasOwnProperty(ae)?+this.feature.properties[ae]:void 0;return this._valid&&ze!==void 0?ye(De?De(ze):ze):pe&&(this._valid=!1),this}}class X{constructor(ae,pe){this.featureFunc=ae,this.vertexFunc=pe}parseFeature(ae,pe,ye){return this.featureFunc(ae,pe,ye)}parseVertex(ae,pe,ye){return this.vertexFunc(ae,pe,ye)}}const se=new X((mt,ae,pe)=>mt.reset(ae).require(Y,ye=>{pe.id=ye}).optional("fixed_height_relative",ye=>{pe.constantHeight=ye},ne.decodeRelativeHeight).geometry(ye=>{pe.bounds=ye},ne.computeBounds).success(),(mt,ae,pe)=>mt.reset(ae).require(Y,ye=>{pe.id=ye}).require("elevation_idx",ye=>{pe.idx=ye}).require("extent",ye=>{pe.extent=ye}).require("height_relative",ye=>{pe.height=ye},ne.decodeRelativeHeight).geometry(ye=>{pe.position=ye},ne.getPoint).success()),te=new X((mt,ae,pe)=>mt.reset(ae).require(Y,ye=>{pe.id=ye}).optional("fixed_height",ye=>{pe.constantHeight=ye},ne.decodeMetricHeight).geometry(ye=>{pe.bounds=ye},ne.computeBounds).success(),(mt,ae,pe)=>mt.reset(ae).require(Y,ye=>{pe.id=ye}).require("elevation_idx",ye=>{pe.idx=ye}).require("extent",ye=>{pe.extent=ye}).require("height",ye=>{pe.height=ye},ne.decodeMetricHeight).geometry(ye=>{pe.position=ye},ne.getPoint).success());class ne{static computeBounds(ae){const pe=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),ye=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const De of ae[0])pe.x>De.x&&(pe.x=De.x),pe.y>De.y&&(pe.y=De.y),ye.x<De.x&&(ye.x=De.x),ye.y<De.y&&(ye.y=De.y);return{min:pe,max:ye}}static getPoint(ae){return i.ab.vec2.fromValues(ae[0][0].x,ae[0][0].y)}static decodeRelativeHeight(ae){return 1e-4*ae*5}static decodeMetricHeight(ae){return 1e-4*ae}static parse(ae){const pe=[],ye=[],De=ae.length,ze=new J;for(let at=0;at<De;at++){const Xe=ae.feature(at),ht=Xe.properties.hasOwnProperty("version")?String(Xe.properties.version):void 0,dt=(qe=ht)?qe==="1.0.1"?te:void 0:se;if(dt===void 0){i.w(`Unknown elevation feature version number ${ht||"(unknown)"}`);continue}const ft=Xe.properties.hasOwnProperty("type")?Xe.properties.type:void 0;if(ft){if(i.dY.VectorTileFeature.types[Xe.type]==="Point"&&ft==="curve_point"){const At={};dt.parseVertex(ze,Xe,At)&&pe.push(At)}else if(i.dY.VectorTileFeature.types[Xe.type]==="Polygon"&&ft==="curve_meta"){const At={};dt.parseFeature(ze,Xe,At)&&ye.push(At)}}}var qe;return{vertices:pe,features:ye}}}class ue{constructor(ae,pe,ye,De,ze,qe){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ae,this.heightRange={min:ye,max:ye},this.safeArea=pe,this.constantHeight=ye,this.constantHeight==null&&(this.constantHeight!=null||De.length!==0)){this.vertices=De,this.edges=ze,this.edges=this.edges.filter(at=>at.a<this.vertices.length&&at.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[at.a].position,this.vertices[at.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const at of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,at.height),this.heightRange.max=Math.max(this.heightRange.max,at.height);for(const at of this.edges){const Xe=this.vertices[at.a].position,ht=this.vertices[at.b].position,dt=i.ab.vec2.subtract(i.ab.vec2.create(),ht,Xe),ft=i.ab.vec2.length(dt),At=i.ab.vec2.scale(i.ab.vec2.create(),dt,1/ft);this.edgeProps.push({vec:dt,dir:At,len:ft});const jt=this.vertexProps[at.a].dir,Wt=this.vertexProps[at.b].dir;i.ab.vec2.add(jt,jt,At),i.ab.vec2.add(Wt,Wt,At)}for(const at of this.vertexProps)at.dir[0]===0&&at.dir[1]===0||i.ab.vec2.normalize(at.dir,at.dir);this.tessellate(qe)}}pointElevation(ae){if(this.constantHeight!=null)return this.constantHeight;const pe=this.getClosestEdge(ae);if(pe==null)return 0;const[ye,De]=pe;return(1-(ze=De))*this.vertices[this.edges[ye].a].height+ze*this.vertices[this.edges[ye].b].height;var ze}getClosestEdge(ae){if(this.edges.length===0)return;let pe=0,ye=Number.POSITIVE_INFINITY,De=0;const ze=i.ab.vec2.fromValues(ae.x,ae.y);for(let qe=0;qe<this.edges.length;qe++){const at=this.edges[qe],Xe=this.edgeProps[qe].dir,ht=new i.dZ(ze,this.edgeProps[qe].dir),dt=this.vertices[at.a].position,ft=this.vertices[at.b].position,At=i.ab.vec2.create(),jt=i.ab.vec2.create(),Wt=ht.intersectsPlane(dt,this.vertexProps[at.a].dir,At),bn=ht.intersectsPlane(ft,this.vertexProps[at.b].dir,jt);if(!Wt||!bn)continue;const In=i.ab.vec2.subtract(i.ab.vec2.create(),jt,At),An=i.ab.vec2.subtract(i.ab.vec2.create(),ze,At),Mn=i.ab.vec2.dot(In,In),Kn=Mn>0?i.ab.vec2.dot(An,In)/Mn:0,rr=i.aw(Kn,0,1),Gn=Math.abs((Kn-rr)*this.edgeProps[qe].len),ar=i.ab.vec2.subtract(i.ab.vec2.create(),ze,dt),fr=Gn+Math.abs(i.ab.vec2.dot(ar,i.ab.vec2.fromValues(Xe[1],-Xe[0])));fr<ye&&(pe=qe,ye=fr,De=rr)}return[pe,De]}tessellate(ae){for(let pe=this.edges.length-1;pe>=0;--pe){const ye=this.edges[pe].a,De=this.edges[pe].b,{position:ze,height:qe,extent:at}=this.vertices[ye],{position:Xe,height:ht,extent:dt}=this.vertices[De],ft=this.vertexProps[ye].dir,At=this.vertexProps[De].dir,jt=i.ab.vec3.fromValues(ze[0]/ae,ze[1]/ae,qe),Wt=i.ab.vec3.fromValues(Xe[0]/ae,Xe[1]/ae,ht),bn=i.ab.vec3.fromValues(ft[1],-ft[0],0);i.ab.vec3.scale(bn,bn,at);const In=i.ab.vec3.fromValues(At[1],-At[0],0);if(i.ab.vec3.scale(In,In,dt),this.distSqLines(i.ab.vec3.fromValues(jt[0]+.5*bn[0],jt[1]+.5*bn[1],jt[2]+.5*bn[2]),i.ab.vec3.fromValues(Wt[0]-.5*In[0],Wt[1]-.5*In[1],Wt[2]-.5*In[2]),i.ab.vec3.fromValues(jt[0]-.5*bn[0],jt[1]-.5*bn[1],jt[2]-.5*bn[2]),i.ab.vec3.fromValues(Wt[0]+.5*In[0],Wt[1]+.5*In[1],Wt[2]+.5*In[2]))<=.05*.05)continue;const An=this.vertices.length,Mn=i.ab.vec2.add(i.ab.vec2.create(),ze,Xe);this.vertices.push({position:i.ab.vec2.scale(Mn,Mn,.5),height:.5*(qe+ht),extent:.5*(at+dt)});const Kn=i.ab.vec2.add(i.ab.vec2.create(),ft,At);this.vertexProps.push({dir:i.ab.vec2.normalize(Kn,Kn)}),this.edges.splice(pe,1),this.edgeProps.splice(pe,1),this.edges.push({a:ye,b:An}),this.edges.push({a:An,b:De});const rr=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[An].position,ze),Gn=i.ab.vec2.length(rr),ar={vec:rr,dir:i.ab.vec2.scale(i.ab.vec2.create(),rr,1/Gn),len:Gn};this.edgeProps.push(ar),this.edgeProps.push(ar)}}distSqLines(ae,pe,ye,De){const ze=i.ab.vec3.subtract(i.ab.vec3.create(),pe,ae),qe=i.ab.vec3.subtract(i.ab.vec3.create(),De,ye),at=i.ab.vec3.subtract(i.ab.vec3.create(),ae,ye),Xe=i.ab.vec3.dot(ze,ze),ht=i.ab.vec3.dot(ze,qe),dt=i.ab.vec3.dot(ze,at),ft=i.ab.vec3.dot(qe,qe),At=i.ab.vec3.dot(qe,at),jt=Xe*ft-ht*ht;if(jt===0){const Mn=i.ab.vec3.dot(at,qe)/i.ab.vec3.dot(qe,qe),Kn=i.ab.vec3.lerp(i.ab.vec3.create(),ye,De,Mn);return i.ab.vec3.squaredDistance(Kn,ae)}const Wt=(ht*At-dt*ft)/jt,bn=(Xe*At-ht*dt)/jt,In=i.ab.vec3.lerp(i.ab.vec3.create(),ae,pe,Wt),An=i.ab.vec3.lerp(i.ab.vec3.create(),ye,De,bn);return i.ab.vec3.squaredDistance(In,An)}}class ge{static parseFrom(ae,pe){const ye=ne.parse(ae);if(!ye)return[];let{vertices:De,features:ze}=ye;const qe=1/i.cc(pe);ze.sort((dt,ft)=>dt.id-ft.id),De.sort((dt,ft)=>dt.id-ft.id||dt.idx-ft.idx),De=De.filter((dt,ft,At)=>ft===At.findIndex(jt=>jt.id===dt.id&&jt.idx===dt.idx));const at=new Array;let Xe=0;const ht=De.length;for(const dt of ze){if(dt.constantHeight){at.push(new ue(dt.id,dt.bounds,dt.constantHeight));continue}for(;Xe!==ht&&De[Xe].id<dt.id;)Xe++;if(Xe===ht||De[Xe].id!==dt.id)continue;const ft=new Array,At=new Array,jt=Xe;for(;Xe!==ht&&De[Xe].id===dt.id;){const Wt=De[Xe];if(ft.push({position:Wt.position,height:Wt.height,extent:Wt.extent}),Xe!==jt&&De[Xe-1].idx===Wt.idx-1){const bn=Xe-jt;At.push({a:bn-1,b:bn})}Xe++}at.push(new ue(dt.id,dt.bounds,void 0,ft,At,qe))}return at}}i.dV(ue,"ElevationFeature");class ee{constructor(ae){this.tileID=new i.aG(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.lut=ae.lut,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.scope=ae.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.request&&ae.request.collectResourceTiming,this.promoteId=ae.promoteId,this.isSymbolTile=ae.isSymbolTile,this.tileTransform=i.aQ(ae.tileID.canonical,ae.projection),this.projection=ae.projection,this.worldview=ae.worldview,this.localizableLayerIds=ae.localizableLayerIds,this.brightness=ae.brightness,this.extraShadowCaster=!!ae.extraShadowCaster,this.tessellationStep=ae.tessellationStep,this.scaleFactor=ae.scaleFactor}parse(ae,pe,ye,De,ze){this.status="parsing",this.data=ae,this.collisionBoxArray=new i.aW;const qe=new i.d_(Object.keys(ae.layers).sort()),at=new i.d$(this.tileID,this.promoteId);at.bucketLayerIDs=[];const Xe={},ht=new i.e0(256,256),dt={featureIndex:at,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:ht,availableImages:ye,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ft=pe.familiesBySource[this.source];for(const Mn in ft){const Kn=ae.layers[Mn];if(!Kn)continue;let rr=!1,Gn=!1,ar=!1;for(const Li of ft[Mn])Li[0].type==="symbol"?rr=!0:Gn=!0,Li[0].is3D()&&Li[0].type!=="model"&&(ar=!0);if(this.extraShadowCaster&&!ar||this.isSymbolTile===!0&&!rr||this.isSymbolTile===!1&&!Gn)continue;Kn.version===1&&i.w(`Vector tile source "${this.source}" layer "${Mn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fr=qe.encode(Mn),bi=[];let Ga=!1;for(let Li=0,ki=0;Li<Kn.length;Li++){const So=Kn.feature(Li),Nu=at.getId(So,Mn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Mn)){const bs=So.properties?So.properties.worldview:null;if(this.worldview&&typeof bs=="string")if(bs==="all")So.properties.$localized=!0;else{if(!bs.split(",").includes(this.worldview))continue;So.properties.$localized=!0,So.properties.worldview=this.worldview}}!Ga&&So.properties&&So.properties.hasOwnProperty(Y)&&(Ga=!0),bi.push({feature:So,id:Nu,index:ki,sourceLayerIndex:fr}),ki++}Ga&&ae.layers.hasOwnProperty(K)&&(dt.elevationFeatures=ge.parseFrom(ae.layers[K],this.canonical));for(const Li of ft[Mn]){const ki=Li[0];(!this.extraShadowCaster||ki.is3D()&&ki.type!=="model")&&(this.isSymbolTile!==void 0&&ki.type==="symbol"!==this.isSymbolTile||ki.minzoom&&this.zoom<Math.floor(ki.minzoom)||ki.maxzoom&&this.zoom>=ki.maxzoom||ki.visibility!=="none"&&(be(Li,this.zoom,dt.brightness,ye),(Xe[ki.id]=ki.createBucket({index:at.bucketLayerIDs.length,layers:Li,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(bi,dt,this.tileID.canonical,this.tileTransform),at.bucketLayerIDs.push(Li.map(So=>i.aC(So.id,So.scope)))))}}let At,jt,Wt,bn;ht.trim();const In={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},An=()=>{if(At)return this.status="done",ze(At);if(this.extraShadowCaster)this.status="done",ze(null,{buckets:i.bj(Xe).filter(Mn=>!Mn.isEmpty()),featureIndex:at,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:dt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(jt&&Wt&&bn){const Mn=new G(jt),Kn=new i.e3(Wt,bn,this.lut);for(const rr in Xe){const Gn=Xe[rr];Gn instanceof i.aX?(be(Gn.layers,this.zoom,dt.brightness,ye),i.e4(Gn,jt,Mn.positions,Wt,Kn.iconPositions,this.showCollisionBoxes,ye,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Gn.hasPattern&&(Gn instanceof i.b1||Gn instanceof i.b2||Gn instanceof i.d5)&&(be(Gn.layers,this.zoom,dt.brightness,ye),Gn.addFeatures(dt,this.tileID.canonical,Kn.patternPositions,ye,this.tileTransform,this.brightness))}this.status="done",ze(null,{buckets:i.bj(Xe).filter(rr=>!rr.isEmpty()),featureIndex:at,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Mn.image,lineAtlas:ht,imageAtlas:Kn,brightness:dt.brightness})}};if(!this.extraShadowCaster){const Mn=i.e1(dt.glyphDependencies,Gn=>Object.keys(Gn).map(Number));Object.keys(Mn).length?De.send("getGlyphs",{uid:this.uid,stacks:Mn,scope:this.scope},(Gn,ar)=>{At||(At=Gn,jt=ar,An())},void 0,!1,In):jt={};const Kn=Object.keys(dt.iconDependencies);Kn.length?De.send("getImages",{icons:Kn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Gn,ar)=>{if(At)return;At=Gn;const fr={};Object.values(ar).some(bi=>bi.usvg)?this.rasterize(De,fr,ar,dt.iconDependencies,()=>{Wt=fr,An()}):(this.fillImageMap(fr,dt.iconDependencies,ar),Wt=fr,An())},void 0,!1,In):Wt={};const rr=Object.keys(dt.patternDependencies);rr.length?De.send("getImages",{icons:rr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Gn,ar)=>{if(!At){At=Gn;const fr={};Object.values(ar).some(bi=>bi.usvg)?this.rasterize(De,fr,ar,dt.patternDependencies,()=>{bn=fr,An()}):(this.fillImageMap(fr,dt.patternDependencies,ar),bn=fr,An())}},void 0,!1,In):bn={}}An()}fillImageMap(ae,pe,ye){for(const De in ye){const ze=pe[De]||[];for(const qe of ze)ye[qe.id].usvg||(ae[qe.serialize()]=ye[qe.id])}}getImageTaskQueue(ae,pe,ye){const De={};for(const ze in pe){const qe=ye[ze]||[];for(const at of qe){const Xe=at.serialize();pe[at.id].usvg?De[Xe]||(De[Xe]=at):ae[Xe]=pe[at.id]}}return De}rasterize(ae,pe,ye,De,ze){const qe=this.getImageTaskQueue(pe,ye,De);this.rasterizeTask=ae.send("rasterizeImages",{scope:this.scope,imageTasks:qe},(at,Xe)=>{if(!at)for(const ht in Xe){const{id:dt}=i.e2.deserializeFromString(ht);pe[ht]=Object.assign({},ye[dt],{data:Xe[ht]})}ze()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function be(mt,ae,pe,ye){const De=new i.a8(ae,{brightness:pe});for(const ze of mt)ze.recalculate(De,ye)}class Ie extends i.E{constructor(ae,pe,ye,De,ze,qe){super(),this.actor=ae,this.layerIndex=pe,this.availableImages=ye,this.loadVectorData=ze||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ae.scheduler),this.isSpriteLoaded=De,this.scheduler=ae.scheduler,this.brightness=qe}loadTile(ae,pe){const ye=ae.uid,De=ae&&ae.request,ze=De&&De.collectResourceTiming,qe=this.loading[ye]=new ee(ae);qe.abort=this.loadVectorData(ae,(at,Xe)=>{const ht=!this.loading[ye];if(delete this.loading[ye],qe.cancelRasterize(),ht||at||!Xe)return qe.status="done",ht||(this.loaded[ye]=qe),pe(at);const dt=Xe.rawData,ft={};Xe.expires&&(ft.expires=Xe.expires),Xe.cacheControl&&(ft.cacheControl=Xe.cacheControl),qe.vectorTile=Xe.vectorTile||new i.dY.VectorTile(new i.bh(dt));const At=()=>{qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.actor,(jt,Wt)=>{if(jt||!Wt)return pe(jt);const bn={};if(ze){const In=O(De);In.length>0&&(bn.resourceTiming=JSON.parse(JSON.stringify(In)))}pe(null,i.l({rawTileData:dt.slice(0)},Wt,ft,bn))})};this.isSpriteLoaded?At():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(At,{type:"parseTile",isSymbolTile:ae.isSymbolTile,zoom:ae.tileZoom}):At()}),this.loaded=this.loaded||{},this.loaded[ye]=qe})}reloadTile(ae,pe){const ye=this.loaded,De=ae.uid;if(ye&&ye[De]){const ze=ye[De];ze.scaleFactor=ae.scaleFactor,ze.showCollisionBoxes=ae.showCollisionBoxes,ze.projection=ae.projection,ze.brightness=ae.brightness,ze.tileTransform=i.aQ(ae.tileID.canonical,ae.projection),ze.extraShadowCaster=ae.extraShadowCaster,ze.lut=ae.lut;const qe=(at,Xe)=>{const ht=ze.reloadCallback;ht&&(delete ze.reloadCallback,ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,ht)),pe(at,Xe)};ze.status==="parsing"?ze.reloadCallback=qe:ze.status==="done"&&(ze.vectorTile?ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,qe):qe())}else pe(null,void 0)}abortTile(ae,pe){const ye=ae.uid,De=this.loading[ye];De&&(De.abort&&De.abort(),delete this.loading[ye]),pe()}removeTile(ae,pe){const ye=this.loaded,De=ae.uid;ye&&ye[De]&&delete ye[De],pe()}}class Ee{loadTile(ae,pe){const{uid:ye,encoding:De,rawImageData:ze,padding:qe}=ae,at=ImageBitmap&&ze instanceof ImageBitmap?this.getImageData(ze,qe):ze;pe(null,new i.e5(ye,at,De,qe<1))}getImageData(ae,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ae.width,ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ae.width,this.offscreenCanvas.height=ae.height,this.offscreenCanvasContext.drawImage(ae,0,0,ae.width,ae.height);const ye=this.offscreenCanvasContext.getImageData(-pe,-pe,ae.width+2*pe,ae.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}i.bg.setPbf(i.bh);class Re{decodeRasterArray({task:ae,buffer:pe},ye){i.bg.performDecoding(pe,ae).then(De=>{ye(null,De)},De=>{ye(De)})}}const Qe=i.dY.VectorTileFeature.prototype.toGeoJSON;class et{constructor(ae){this._feature=ae,this.extent=i.ag,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const pe of this._feature.geometry)ae.push([new i.P(pe[0],pe[1])]);return ae}{const ae=[];for(const pe of this._feature.geometry){const ye=[];for(const De of pe)ye.push(new i.P(De[0],De[1]));ae.push(ye)}return ae}}toGeoJSON(ae,pe,ye){return Qe.call(this,ae,pe,ye)}}class We{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ae.length,this._features=ae}feature(ae){return new et(this._features[ae])}}const me=64/4096,Oe=128;class Fe{constructor(){this.features=new Map}clear(){this.features.clear()}load(ae=[],pe){for(const ye of ae){const De=ye.id;if(De==null)continue;let ze=this.features.get(De);ze&&this.updateCache(ze,pe),ye.geometry?(ze=$e(ye),this.updateCache(ze,pe),this.features.set(De,ze)):this.features.delete(De),this.updateCache(ze,pe)}}updateCache(ae,pe){for(const{canonical:ye,uid:De}of Object.values(pe)){const{z:ze,x:qe,y:at}=ye;Ke(ae,Math.pow(2,ze),qe,at)&&delete pe[De]}}getTile(ae,pe,ye){const De=Math.pow(2,ae),ze=[];for(const qe of this.features.values())Ke(qe,De,pe,ye)&&ze.push(It(qe,De,pe,ye));return{features:ze}}getFeatures(){return[...this.features.values()]}}function Ke({minX:mt,minY:ae,maxX:pe,maxY:ye},De,ze,qe){return mt<(ze+1+me)/De&&ae<(qe+1+me)/De&&pe>(ze-me)/De&&ye>(qe-me)/De}function $e(mt){const{id:ae,geometry:pe,properties:ye}=mt;if(!pe)return;if(pe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:De,coordinates:ze}=pe,qe={id:ae,type:1,geometry:[],tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},at=qe.geometry;if(De==="Point")pt(ze,at,qe);else if(De==="MultiPoint")for(const Xe of ze)pt(Xe,at,qe);else if(De==="LineString")qe.type=2,Ct(ze,at,qe);else if(De==="MultiLineString")qe.type=2,Lt(ze,at,qe);else if(De==="Polygon")qe.type=3,Lt(ze,at,qe,!0);else{if(De!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");qe.type=3;for(const Xe of ze)Lt(Xe,at,qe,!0)}return qe}function pt([mt,ae],pe,ye){const De=i.at(mt);let ze=i.aA(ae);ze=ze<0?0:ze>1?1:ze,pe.push(De,ze),ye.minX=Math.min(ye.minX,De),ye.minY=Math.min(ye.minY,ze),ye.maxX=Math.max(ye.maxX,De),ye.maxY=Math.max(ye.maxY,ze)}function Ct(mt,ae,pe,ye=!1,De=!1){const ze=[];for(const qe of mt)pt(qe,ze,pe);ae.push(ze),ye&&function(qe,at){let Xe=0;for(let ht=0,dt=qe.length,ft=dt-2;ht<dt;ft=ht,ht+=2)Xe+=(qe[ht]-qe[ft])*(qe[ht+1]+qe[ft+1]);if(Xe>0===at)for(let ht=0,dt=qe.length;ht<dt/2;ht+=2){const ft=qe[ht],At=qe[ht+1];qe[ht]=qe[dt-2-ht],qe[ht+1]=qe[dt-1-ht],qe[dt-2-ht]=ft,qe[dt-1-ht]=At}}(ze,De)}function Lt(mt,ae,pe,ye=!1){for(let De=0;De<mt.length;De++)Ct(mt[De],ae,pe,ye,De===0)}function It(mt,ae,pe,ye){const{id:De,type:ze,geometry:qe,tags:at}=mt,Xe=[];if(ze===1)(function(ht,dt,ft,At,jt){for(let Wt=0;Wt<ht.length;Wt+=2){const bn=Math.round(i.ag*(ht[Wt+0]*dt-ft)),In=Math.round(i.ag*(ht[Wt+1]*dt-At));jt.push([bn,In])}})(qe,ae,pe,ye,Xe);else for(const ht of qe)_n(ht,ae,pe,ye,Xe);return{id:De,type:ze,geometry:Xe,tags:at}}function _n(mt,ae,pe,ye,De){const ze=-Oe,qe=i.ag+Oe;let at;for(let Xe=0;Xe<mt.length-2;Xe+=2){let ht=Math.round(i.ag*(mt[Xe+0]*ae-pe)),dt=Math.round(i.ag*(mt[Xe+1]*ae-ye)),ft=Math.round(i.ag*(mt[Xe+2]*ae-pe)),At=Math.round(i.ag*(mt[Xe+3]*ae-ye));const jt=ft-ht,Wt=At-dt;ht<ze&&ft<ze||(ht<ze?(dt+=Math.round(Wt*((ze-ht)/jt)),ht=ze):ft<ze&&(At=dt+Math.round(Wt*((ze-ht)/jt)),ft=ze),dt<ze&&At<ze||(dt<ze?(ht+=Math.round(jt*((ze-dt)/Wt)),dt=ze):At<ze&&(ft=ht+Math.round(jt*((ze-dt)/Wt)),At=ze),ht>=qe&&ft>=qe||(ht>=qe?(dt+=Math.round(Wt*((qe-ht)/jt)),ht=qe):ft>=qe&&(At=dt+Math.round(Wt*((qe-ht)/jt)),ft=qe),dt>=qe&&At>=qe||(dt>=qe?(ht+=Math.round(jt*((qe-dt)/Wt)),dt=qe):At>=qe&&(ft=ht+Math.round(jt*((qe-dt)/Wt)),At=qe),at&&ht===at[at.length-1][0]&&dt===at[at.length-1][1]||(at=[[ht,dt]],De.push(at)),at.push([ft,At])))))}}var Ut,ln,xn,En={exports:{}},Nt=function(){if(xn)return En.exports;xn=1;var mt=i.e8(),ae=function(){if(ln)return Ut;ln=1;var dt=i.e6(),ft=i.e7().VectorTileFeature;function At(Wt,bn){this.options=bn||{},this.features=Wt,this.length=Wt.length}function jt(Wt,bn){this.id=typeof Wt.id=="number"?Wt.id:void 0,this.type=Wt.type,this.rawGeometry=Wt.type===1?[Wt.geometry]:Wt.geometry,this.properties=Wt.tags,this.extent=bn||4096}return Ut=At,At.prototype.feature=function(Wt){return new jt(this.features[Wt],this.options.extent)},jt.prototype.loadGeometry=function(){var Wt=this.rawGeometry;this.geometry=[];for(var bn=0;bn<Wt.length;bn++){for(var In=Wt[bn],An=[],Mn=0;Mn<In.length;Mn++)An.push(new dt(In[Mn][0],In[Mn][1]));this.geometry.push(An)}return this.geometry},jt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Wt=this.geometry,bn=1/0,In=-1/0,An=1/0,Mn=-1/0,Kn=0;Kn<Wt.length;Kn++)for(var rr=Wt[Kn],Gn=0;Gn<rr.length;Gn++){var ar=rr[Gn];bn=Math.min(bn,ar.x),In=Math.max(In,ar.x),An=Math.min(An,ar.y),Mn=Math.max(Mn,ar.y)}return[bn,An,In,Mn]},jt.prototype.toGeoJSON=ft.prototype.toGeoJSON,Ut}();function pe(dt){var ft=new mt;return function(At,jt){for(var Wt in At.layers)jt.writeMessage(3,ye,At.layers[Wt])}(dt,ft),ft.finish()}function ye(dt,ft){var At;ft.writeVarintField(15,dt.version||1),ft.writeStringField(1,dt.name||""),ft.writeVarintField(5,dt.extent||4096);var jt={keys:[],values:[],keycache:{},valuecache:{}};for(At=0;At<dt.length;At++)jt.feature=dt.feature(At),ft.writeMessage(2,De,jt);var Wt=jt.keys;for(At=0;At<Wt.length;At++)ft.writeStringField(3,Wt[At]);var bn=jt.values;for(At=0;At<bn.length;At++)ft.writeMessage(4,ht,bn[At])}function De(dt,ft){var At=dt.feature;At.id!==void 0&&ft.writeVarintField(1,At.id),ft.writeMessage(2,ze,dt),ft.writeVarintField(3,At.type),ft.writeMessage(4,Xe,At)}function ze(dt,ft){var At=dt.feature,jt=dt.keys,Wt=dt.values,bn=dt.keycache,In=dt.valuecache;for(var An in At.properties){var Mn=At.properties[An],Kn=bn[An];if(Mn!==null){Kn===void 0&&(jt.push(An),bn[An]=Kn=jt.length-1),ft.writeVarint(Kn);var rr=typeof Mn;rr!=="string"&&rr!=="boolean"&&rr!=="number"&&(Mn=JSON.stringify(Mn));var Gn=rr+":"+Mn,ar=In[Gn];ar===void 0&&(Wt.push(Mn),In[Gn]=ar=Wt.length-1),ft.writeVarint(ar)}}}function qe(dt,ft){return(ft<<3)+(7&dt)}function at(dt){return dt<<1^dt>>31}function Xe(dt,ft){for(var At=dt.loadGeometry(),jt=dt.type,Wt=0,bn=0,In=At.length,An=0;An<In;An++){var Mn=At[An],Kn=1;jt===1&&(Kn=Mn.length),ft.writeVarint(qe(1,Kn));for(var rr=jt===3?Mn.length-1:Mn.length,Gn=0;Gn<rr;Gn++){Gn===1&&jt!==1&&ft.writeVarint(qe(2,rr-1));var ar=Mn[Gn].x-Wt,fr=Mn[Gn].y-bn;ft.writeVarint(at(ar)),ft.writeVarint(at(fr)),Wt+=ar,bn+=fr}jt===3&&ft.writeVarint(qe(7,1))}}function ht(dt,ft){var At=typeof dt;At==="string"?ft.writeStringField(1,dt):At==="boolean"?ft.writeBooleanField(7,dt):At==="number"&&(dt%1!=0?ft.writeDoubleField(3,dt):dt<0?ft.writeSVarintField(6,dt):ft.writeVarintField(5,dt))}return En.exports=pe,En.exports.fromVectorTileJs=pe,En.exports.fromGeojsonVt=function(dt,ft){ft=ft||{};var At={};for(var jt in dt)At[jt]=new ae(dt[jt].features,ft),At[jt].name=jt,At[jt].version=ft.version,At[jt].extent=ft.extent;return pe({layers:At})},En.exports.GeoJSONWrapper=ae,En.exports}(),_e=i.e9(Nt);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:mt=>mt},Ve=Math.fround||(Ye=new Float32Array(1),mt=>(Ye[0]=+mt,Ye[0]));var Ye;const je=3,Mt=5,Pt=6;class qt{constructor(ae){this.options=Object.assign(Object.create(Ft),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:pe,minZoom:ye,maxZoom:De}=this.options;pe&&console.time("total time");const ze=`prepare ${ae.length} points`;pe&&console.time(ze),this.points=ae;const qe=[];for(let Xe=0;Xe<ae.length;Xe++){const ht=ae[Xe];if(!ht.geometry)continue;const[dt,ft]=ht.geometry.coordinates,At=Ve(an(dt)),jt=Ve(un(ft));qe.push(At,jt,1/0,Xe,-1,1),this.options.reduce&&qe.push(0)}let at=this.trees[De+1]=this._createTree(qe);pe&&console.timeEnd(ze);for(let Xe=De;Xe>=ye;Xe--){const ht=+Date.now();at=this.trees[Xe]=this._createTree(this._cluster(at,Xe)),pe&&console.log("z%d: %d clusters in %dms",Xe,at.numItems,+Date.now()-ht)}return pe&&console.timeEnd("total time"),this}getClusters(ae,pe){let ye=((ae[0]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,ae[1]));let ze=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)ye=-180,ze=180;else if(ye>ze){const ft=this.getClusters([ye,De,180,qe],pe),At=this.getClusters([-180,De,ze,qe],pe);return ft.concat(At)}const at=this.trees[this._limitZoom(pe)],Xe=at.range(an(ye),un(qe),an(ze),un(De)),ht=at.data,dt=[];for(const ft of Xe){const At=this.stride*ft;dt.push(ht[At+Mt]>1?zt(ht,At,this.clusterProps):this.points[ht[At+je]])}return dt}getChildren(ae){const pe=this._getOriginId(ae),ye=this._getOriginZoom(ae),De="No cluster with the specified id.",ze=this.trees[ye];if(!ze)throw new Error(De);const qe=ze.data;if(pe*this.stride>=qe.length)throw new Error(De);const at=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Xe=ze.within(qe[pe*this.stride],qe[pe*this.stride+1],at),ht=[];for(const dt of Xe){const ft=dt*this.stride;qe[ft+4]===ae&&ht.push(qe[ft+Mt]>1?zt(qe,ft,this.clusterProps):this.points[qe[ft+je]])}if(ht.length===0)throw new Error(De);return ht}getLeaves(ae,pe,ye){const De=[];return this._appendLeaves(De,ae,pe=pe||10,ye=ye||0,0),De}getTile(ae,pe,ye){const De=this.trees[this._limitZoom(ae)],ze=Math.pow(2,ae),{extent:qe,radius:at}=this.options,Xe=at/qe,ht=(ye-Xe)/ze,dt=(ye+1+Xe)/ze,ft={features:[]};return this._addTileFeatures(De.range((pe-Xe)/ze,ht,(pe+1+Xe)/ze,dt),De.data,pe,ye,ze,ft),pe===0&&this._addTileFeatures(De.range(1-Xe/ze,ht,1,dt),De.data,ze,ye,ze,ft),pe===ze-1&&this._addTileFeatures(De.range(0,ht,Xe/ze,dt),De.data,-1,ye,ze,ft),ft.features.length?ft:null}getClusterExpansionZoom(ae){let pe=this._getOriginZoom(ae)-1;for(;pe<=this.options.maxZoom;){const ye=this.getChildren(ae);if(pe++,ye.length!==1)break;ae=ye[0].properties.cluster_id}return pe}_appendLeaves(ae,pe,ye,De,ze){const qe=this.getChildren(pe);for(const at of qe){const Xe=at.properties;if(Xe&&Xe.cluster?ze+Xe.point_count<=De?ze+=Xe.point_count:ze=this._appendLeaves(ae,Xe.cluster_id,ye,De,ze):ze<De?ze++:ae.push(at),ae.length===ye)break}return ze}_createTree(ae){const pe=new i.bE(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<ae.length;ye+=this.stride)pe.add(ae[ye],ae[ye+1]);return pe.finish(),pe.data=ae,pe}_addTileFeatures(ae,pe,ye,De,ze,qe){for(const at of ae){const Xe=at*this.stride,ht=pe[Xe+Mt]>1;let dt,ft,At;if(ht)dt=Kt(pe,Xe,this.clusterProps),ft=pe[Xe],At=pe[Xe+1];else{const bn=this.points[pe[Xe+je]];dt=bn.properties;const[In,An]=bn.geometry.coordinates;ft=an(In),At=un(An)}const jt={type:1,geometry:[[Math.round(this.options.extent*(ft*ze-ye)),Math.round(this.options.extent*(At*ze-De))]],tags:dt};let Wt;Wt=ht||this.options.generateId?pe[Xe+je]:this.points[pe[Xe+je]].id,Wt!==void 0&&(jt.id=Wt),qe.features.push(jt)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,pe){const{radius:ye,extent:De,reduce:ze,minPoints:qe}=this.options,at=ye/(De*Math.pow(2,pe)),Xe=ae.data,ht=[],dt=this.stride;for(let ft=0;ft<Xe.length;ft+=dt){if(Xe[ft+2]<=pe)continue;Xe[ft+2]=pe;const At=Xe[ft],jt=Xe[ft+1],Wt=ae.within(Xe[ft],Xe[ft+1],at),bn=Xe[ft+Mt];let In=bn;for(const An of Wt){const Mn=An*dt;Xe[Mn+2]>pe&&(In+=Xe[Mn+Mt])}if(In>bn&&In>=qe){let An,Mn=At*bn,Kn=jt*bn,rr=-1;const Gn=(ft/dt<<5)+(pe+1)+this.points.length;for(const ar of Wt){const fr=ar*dt;if(Xe[fr+2]<=pe)continue;Xe[fr+2]=pe;const bi=Xe[fr+Mt];Mn+=Xe[fr]*bi,Kn+=Xe[fr+1]*bi,Xe[fr+4]=Gn,ze&&(An||(An=this._map(Xe,ft,!0),rr=this.clusterProps.length,this.clusterProps.push(An)),ze(An,this._map(Xe,fr)))}Xe[ft+4]=Gn,ht.push(Mn/In,Kn/In,1/0,Gn,-1,In),ze&&ht.push(rr)}else{for(let An=0;An<dt;An++)ht.push(Xe[ft+An]);if(In>1)for(const An of Wt){const Mn=An*dt;if(!(Xe[Mn+2]<=pe)){Xe[Mn+2]=pe;for(let Kn=0;Kn<dt;Kn++)ht.push(Xe[Mn+Kn])}}}}return ht}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,pe,ye){if(ae[pe+Mt]>1){const qe=this.clusterProps[ae[pe+Pt]];return ye?Object.assign({},qe):qe}const De=this.points[ae[pe+je]].properties,ze=this.options.map(De);return ye&&ze===De?Object.assign({},ze):ze}}function zt(mt,ae,pe){return{type:"Feature",id:mt[ae+je],properties:Kt(mt,ae,pe),geometry:{type:"Point",coordinates:[(ye=mt[ae],360*(ye-.5)),Nn(mt[ae+1])]}};var ye}function Kt(mt,ae,pe){const ye=mt[ae+Mt],De=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,ze=mt[ae+Pt],qe=ze===-1?{}:Object.assign({},pe[ze]);return Object.assign(qe,{cluster:!0,cluster_id:mt[ae+je],point_count:ye,point_count_abbreviated:De})}function an(mt){return mt/360+.5}function un(mt){const ae=Math.sin(mt*Math.PI/180),pe=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return pe<0?0:pe>1?1:pe}function Nn(mt){const ae=(180-360*mt)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Sn(mt,ae,pe,ye){let De=ye;const ze=ae+(pe-ae>>1);let qe,at=pe-ae;const Xe=mt[ae],ht=mt[ae+1],dt=mt[pe],ft=mt[pe+1];for(let At=ae+3;At<pe;At+=3){const jt=Qt(mt[At],mt[At+1],Xe,ht,dt,ft);if(jt>De)qe=At,De=jt;else if(jt===De){const Wt=Math.abs(At-ze);Wt<at&&(qe=At,at=Wt)}}De>ye&&(qe-ae>3&&Sn(mt,ae,qe,ye),mt[qe+2]=De,pe-qe>3&&Sn(mt,qe,pe,ye))}function Qt(mt,ae,pe,ye,De,ze){let qe=De-pe,at=ze-ye;if(qe!==0||at!==0){const Xe=((mt-pe)*qe+(ae-ye)*at)/(qe*qe+at*at);Xe>1?(pe=De,ye=ze):Xe>0&&(pe+=qe*Xe,ye+=at*Xe)}return qe=mt-pe,at=ae-ye,qe*qe+at*at}function Hn(mt,ae,pe,ye){const De={id:mt??null,type:ae,geometry:pe,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")tr(De,pe);else if(ae==="Polygon")tr(De,pe[0]);else if(ae==="MultiLineString")for(const ze of pe)tr(De,ze);else if(ae==="MultiPolygon")for(const ze of pe)tr(De,ze[0]);return De}function tr(mt,ae){for(let pe=0;pe<ae.length;pe+=3)mt.minX=Math.min(mt.minX,ae[pe]),mt.minY=Math.min(mt.minY,ae[pe+1]),mt.maxX=Math.max(mt.maxX,ae[pe]),mt.maxY=Math.max(mt.maxY,ae[pe+1])}function Pr(mt,ae,pe,ye){if(!ae.geometry)return;const De=ae.geometry.coordinates;if(De&&De.length===0)return;const ze=ae.geometry.type,qe=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2);let at=[],Xe=ae.id;if(pe.promoteId?Xe=ae.properties[pe.promoteId]:pe.generateId&&(Xe=ye||0),ze==="Point")nr(De,at);else if(ze==="MultiPoint")for(const ht of De)nr(ht,at);else if(ze==="LineString")pi(De,at,qe,!1);else if(ze==="MultiLineString"){if(pe.lineMetrics){for(const ht of De)at=[],pi(ht,at,qe,!1),mt.push(Hn(Xe,"LineString",at,ae.properties));return}xi(De,at,qe,!1)}else if(ze==="Polygon")xi(De,at,qe,!0);else{if(ze!=="MultiPolygon"){if(ze==="GeometryCollection"){for(const ht of ae.geometry.geometries)Pr(mt,{id:Xe,geometry:ht,properties:ae.properties},pe,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ht of De){const dt=[];xi(ht,dt,qe,!0),at.push(dt)}}mt.push(Hn(Xe,ze,at,ae.properties))}function nr(mt,ae){ae.push(Yi(mt[0]),Xi(mt[1]),0)}function pi(mt,ae,pe,ye){let De,ze,qe=0;for(let Xe=0;Xe<mt.length;Xe++){const ht=Yi(mt[Xe][0]),dt=Xi(mt[Xe][1]);ae.push(ht,dt,0),Xe>0&&(qe+=ye?(De*dt-ht*ze)/2:Math.sqrt(Math.pow(ht-De,2)+Math.pow(dt-ze,2))),De=ht,ze=dt}const at=ae.length-3;ae[2]=1,Sn(ae,0,at,pe),ae[at+2]=1,ae.size=Math.abs(qe),ae.start=0,ae.end=ae.size}function xi(mt,ae,pe,ye){for(let De=0;De<mt.length;De++){const ze=[];pi(mt[De],ze,pe,ye),ae.push(ze)}}function Yi(mt){return mt/360+.5}function Xi(mt){const ae=Math.sin(mt*Math.PI/180),pe=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return pe<0?0:pe>1?1:pe}function Ai(mt,ae,pe,ye,De,ze,qe,at){if(ye/=ae,ze>=(pe/=ae)&&qe<ye)return mt;if(qe<pe||ze>=ye)return null;const Xe=[];for(const ht of mt){const dt=ht.geometry;let ft=ht.type;const At=De===0?ht.minX:ht.minY,jt=De===0?ht.maxX:ht.maxY;if(At>=pe&&jt<ye){Xe.push(ht);continue}if(jt<pe||At>=ye)continue;let Wt=[];if(ft==="Point"||ft==="MultiPoint")xa(dt,Wt,pe,ye,De);else if(ft==="LineString")Bi(dt,Wt,pe,ye,De,!1,at.lineMetrics);else if(ft==="MultiLineString")ba(dt,Wt,pe,ye,De,!1);else if(ft==="Polygon")ba(dt,Wt,pe,ye,De,!0);else if(ft==="MultiPolygon")for(const bn of dt){const In=[];ba(bn,In,pe,ye,De,!0),In.length&&Wt.push(In)}if(Wt.length){if(at.lineMetrics&&ft==="LineString"){for(const bn of Wt)Xe.push(Hn(ht.id,ft,bn,ht.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(Wt.length===1?(ft="LineString",Wt=Wt[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=Wt.length===3?"Point":"MultiPoint"),Xe.push(Hn(ht.id,ft,Wt,ht.tags))}}return Xe.length?Xe:null}function xa(mt,ae,pe,ye,De){for(let ze=0;ze<mt.length;ze+=3){const qe=mt[ze+De];qe>=pe&&qe<=ye&&kn(ae,mt[ze],mt[ze+1],mt[ze+2])}}function Bi(mt,ae,pe,ye,De,ze,qe){let at=ci(mt);const Xe=De===0?ca:Bu;let ht,dt,ft=mt.start;for(let In=0;In<mt.length-3;In+=3){const An=mt[In],Mn=mt[In+1],Kn=mt[In+2],rr=mt[In+3],Gn=mt[In+4],ar=De===0?An:Mn,fr=De===0?rr:Gn;let bi=!1;qe&&(ht=Math.sqrt(Math.pow(An-rr,2)+Math.pow(Mn-Gn,2))),ar<pe?fr>pe&&(dt=Xe(at,An,Mn,rr,Gn,pe),qe&&(at.start=ft+ht*dt)):ar>ye?fr<ye&&(dt=Xe(at,An,Mn,rr,Gn,ye),qe&&(at.start=ft+ht*dt)):kn(at,An,Mn,Kn),fr<pe&&ar>=pe&&(dt=Xe(at,An,Mn,rr,Gn,pe),bi=!0),fr>ye&&ar<=ye&&(dt=Xe(at,An,Mn,rr,Gn,ye),bi=!0),!ze&&bi&&(qe&&(at.end=ft+ht*dt),ae.push(at),at=ci(mt)),qe&&(ft+=ht)}let At=mt.length-3;const jt=mt[At],Wt=mt[At+1],bn=De===0?jt:Wt;bn>=pe&&bn<=ye&&kn(at,jt,Wt,mt[At+2]),At=at.length-3,ze&&At>=3&&(at[At]!==at[0]||at[At+1]!==at[1])&&kn(at,at[0],at[1],at[2]),at.length&&ae.push(at)}function ci(mt){const ae=[];return ae.size=mt.size,ae.start=mt.start,ae.end=mt.end,ae}function ba(mt,ae,pe,ye,De,ze){for(const qe of mt)Bi(qe,ae,pe,ye,De,ze,!1)}function kn(mt,ae,pe,ye){mt.push(ae,pe,ye)}function ca(mt,ae,pe,ye,De,ze){const qe=(ze-ae)/(ye-ae);return kn(mt,ze,pe+(De-pe)*qe,1),qe}function Bu(mt,ae,pe,ye,De,ze){const qe=(ze-pe)/(De-pe);return kn(mt,ae+(ye-ae)*qe,ze,1),qe}function Ao(mt,ae){const pe=[];for(let ye=0;ye<mt.length;ye++){const De=mt[ye],ze=De.type;let qe;if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")qe=Ua(De.geometry,ae);else if(ze==="MultiLineString"||ze==="Polygon"){qe=[];for(const at of De.geometry)qe.push(Ua(at,ae))}else if(ze==="MultiPolygon"){qe=[];for(const at of De.geometry){const Xe=[];for(const ht of at)Xe.push(Ua(ht,ae));qe.push(Xe)}}pe.push(Hn(De.id,ze,qe,De.tags))}return pe}function Ua(mt,ae){const pe=[];pe.size=mt.size,mt.start!==void 0&&(pe.start=mt.start,pe.end=mt.end);for(let ye=0;ye<mt.length;ye+=3)pe.push(mt[ye]+ae,mt[ye+1],mt[ye+2]);return pe}function Dl(mt,ae){if(mt.transformed)return mt;const pe=1<<mt.z,ye=mt.x,De=mt.y;for(const ze of mt.features){const qe=ze.geometry,at=ze.type;if(ze.geometry=[],at===1)for(let Xe=0;Xe<qe.length;Xe+=2)ze.geometry.push(Rl(qe[Xe],qe[Xe+1],ae,pe,ye,De));else for(let Xe=0;Xe<qe.length;Xe++){const ht=[];for(let dt=0;dt<qe[Xe].length;dt+=2)ht.push(Rl(qe[Xe][dt],qe[Xe][dt+1],ae,pe,ye,De));ze.geometry.push(ht)}}return mt.transformed=!0,mt}function Rl(mt,ae,pe,ye,De,ze){return[Math.round(pe*(mt*ye-De)),Math.round(pe*(ae*ye-ze))]}function zl(mt,ae,pe,ye,De){const ze=ae===De.maxZoom?0:De.tolerance/((1<<ae)*De.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:mt.length,source:null,x:pe,y:ye,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const at of mt)ku(qe,at,ze,De);return qe}function ku(mt,ae,pe,ye){const De=ae.geometry,ze=ae.type,qe=[];if(mt.minX=Math.min(mt.minX,ae.minX),mt.minY=Math.min(mt.minY,ae.minY),mt.maxX=Math.max(mt.maxX,ae.maxX),mt.maxY=Math.max(mt.maxY,ae.maxY),ze==="Point"||ze==="MultiPoint")for(let at=0;at<De.length;at+=3)qe.push(De[at],De[at+1]),mt.numPoints++,mt.numSimplified++;else if(ze==="LineString")Ha(qe,De,mt,pe,!1,!1);else if(ze==="MultiLineString"||ze==="Polygon")for(let at=0;at<De.length;at++)Ha(qe,De[at],mt,pe,ze==="Polygon",at===0);else if(ze==="MultiPolygon")for(let at=0;at<De.length;at++){const Xe=De[at];for(let ht=0;ht<Xe.length;ht++)Ha(qe,Xe[ht],mt,pe,!0,ht===0)}if(qe.length){let at=ae.tags||null;if(ze==="LineString"&&ye.lineMetrics){at={};for(const ht in ae.tags)at[ht]=ae.tags[ht];at.mapbox_clip_start=De.start/De.size,at.mapbox_clip_end=De.end/De.size}const Xe={geometry:qe,type:ze==="Polygon"||ze==="MultiPolygon"?3:ze==="LineString"||ze==="MultiLineString"?2:1,tags:at};ae.id!==null&&(Xe.id=ae.id),mt.features.push(Xe)}}function Ha(mt,ae,pe,ye,De,ze){const qe=ye*ye;if(ye>0&&ae.size<(De?qe:ye))return void(pe.numPoints+=ae.length/3);const at=[];for(let Xe=0;Xe<ae.length;Xe+=3)(ye===0||ae[Xe+2]>qe)&&(pe.numSimplified++,at.push(ae[Xe],ae[Xe+1])),pe.numPoints++;De&&function(Xe,ht){let dt=0;for(let ft=0,At=Xe.length,jt=At-2;ft<At;jt=ft,ft+=2)dt+=(Xe[ft]-Xe[jt])*(Xe[ft+1]+Xe[jt+1]);if(dt>0===ht)for(let ft=0,At=Xe.length;ft<At/2;ft+=2){const jt=Xe[ft],Wt=Xe[ft+1];Xe[ft]=Xe[At-2-ft],Xe[ft+1]=Xe[At-1-ft],Xe[At-2-ft]=jt,Xe[At-1-ft]=Wt}}(at,ze),mt.push(at)}const Js={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ll{constructor(ae,pe){const ye=(pe=this.options=function(ze,qe){for(const at in qe)ze[at]=qe[at];return ze}(Object.create(Js),pe)).debug;if(ye&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");let De=function(ze,qe){const at=[];if(ze.type==="FeatureCollection")for(let Xe=0;Xe<ze.features.length;Xe++)Pr(at,ze.features[Xe],qe,Xe);else Pr(at,ze.type==="Feature"?ze:{geometry:ze},qe);return at}(ae,pe);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),De=function(ze,qe){const at=qe.buffer/qe.extent;let Xe=ze;const ht=Ai(ze,1,-1-at,at,0,-1,2,qe),dt=Ai(ze,1,1-at,2+at,0,-1,2,qe);return(ht||dt)&&(Xe=Ai(ze,1,-at,1+at,0,-1,2,qe)||[],ht&&(Xe=Ao(ht,1).concat(Xe)),dt&&(Xe=Xe.concat(Ao(dt,-1)))),Xe}(De,pe),De.length&&this.splitTile(De,0,0,0),ye&&(De.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,pe,ye,De,ze,qe,at){const Xe=[ae,pe,ye,De],ht=this.options,dt=ht.debug;for(;Xe.length;){De=Xe.pop(),ye=Xe.pop(),pe=Xe.pop(),ae=Xe.pop();const ft=1<<pe,At=ni(pe,ye,De);let jt=this.tiles[At];if(!jt&&(dt>1&&console.time("creation"),jt=this.tiles[At]=zl(ae,pe,ye,De,ht),this.tileCoords.push({z:pe,x:ye,y:De}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,ye,De,jt.numFeatures,jt.numPoints,jt.numSimplified),console.timeEnd("creation"));const bi=`z${pe}`;this.stats[bi]=(this.stats[bi]||0)+1,this.total++}if(jt.source=ae,ze==null){if(pe===ht.indexMaxZoom||jt.numPoints<=ht.indexMaxPoints)continue}else{if(pe===ht.maxZoom||pe===ze)continue;if(ze!=null){const bi=ze-pe;if(ye!==qe>>bi||De!==at>>bi)continue}}if(jt.source=null,ae.length===0)continue;dt>1&&console.time("clipping");const Wt=.5*ht.buffer/ht.extent,bn=.5-Wt,In=.5+Wt,An=1+Wt;let Mn=null,Kn=null,rr=null,Gn=null,ar=Ai(ae,ft,ye-Wt,ye+In,0,jt.minX,jt.maxX,ht),fr=Ai(ae,ft,ye+bn,ye+An,0,jt.minX,jt.maxX,ht);ae=null,ar&&(Mn=Ai(ar,ft,De-Wt,De+In,1,jt.minY,jt.maxY,ht),Kn=Ai(ar,ft,De+bn,De+An,1,jt.minY,jt.maxY,ht),ar=null),fr&&(rr=Ai(fr,ft,De-Wt,De+In,1,jt.minY,jt.maxY,ht),Gn=Ai(fr,ft,De+bn,De+An,1,jt.minY,jt.maxY,ht),fr=null),dt>1&&console.timeEnd("clipping"),Xe.push(Mn||[],pe+1,2*ye,2*De),Xe.push(Kn||[],pe+1,2*ye,2*De+1),Xe.push(rr||[],pe+1,2*ye+1,2*De),Xe.push(Gn||[],pe+1,2*ye+1,2*De+1)}}getTile(ae,pe,ye){ae=+ae,pe=+pe,ye=+ye;const De=this.options,{extent:ze,debug:qe}=De;if(ae<0||ae>24)return null;const at=1<<ae,Xe=ni(ae,pe=pe+at&at-1,ye);if(this.tiles[Xe])return Dl(this.tiles[Xe],ze);qe>1&&console.log("drilling down to z%d-%d-%d",ae,pe,ye);let ht,dt=ae,ft=pe,At=ye;for(;!ht&&dt>0;)dt--,ft>>=1,At>>=1,ht=this.tiles[ni(dt,ft,At)];return ht&&ht.source?(qe>1&&(console.log("found parent tile z%d-%d-%d",dt,ft,At),console.time("drilling down")),this.splitTile(ht.source,dt,ft,At,ae,pe,ye),qe>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Dl(this.tiles[Xe],ze):null):null}}function ni(mt,ae,pe){return 32*((1<<mt)*pe+ae)+mt}function $l(mt,ae){const pe=mt.tileID.canonical;if(!this._geoJSONIndex)return void ae(null,null);const ye=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!ye)return void ae(null,null);const De=new We(ye.features);let ze=_e(De);ze.byteOffset===0&&ze.byteLength===ze.buffer.byteLength||(ze=new Uint8Array(ze)),ae(null,{vectorTile:De,rawData:ze.buffer})}class Pc extends Ie{constructor(ae,pe,ye,De,ze,qe){super(ae,pe,ye,De,$l,qe),ze&&(this.loadGeoJSON=ze),this._dynamicIndex=new Fe}loadData(ae,pe){const ye=ae&&ae.request,De=ye&&ye.collectResourceTiming;this.loadGeoJSON(ae,(ze,qe)=>{if(ze||!qe)return pe(ze);if(typeof qe!="object")return pe(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));{try{if(ae.filter){const Xe=i.U(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Xe.result==="error")throw new Error(Xe.value.map(ht=>`${ht.key}: ${ht.message}`).join(", "));qe.features=qe.features.filter(ht=>Xe.value.evaluate({zoom:0},ht))}ae.dynamic?(qe.type==="Feature"&&(qe={type:"FeatureCollection",features:[qe]}),ae.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(qe.features,this.loaded),ae.cluster&&(qe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ae.cluster?new qt(function({superclusterOptions:Xe,clusterProperties:ht}){if(!ht||!Xe)return Xe;const dt={},ft={},At={accumulated:null,zoom:0},jt={properties:null},Wt=Object.keys(ht);for(const bn of Wt){const[In,An]=ht[bn],Mn=i.U(An),Kn=i.U(typeof In=="string"?[In,["accumulated"],["get",bn]]:In);dt[bn]=Mn.value,ft[bn]=Kn.value}return Xe.map=bn=>{jt.properties=bn;const In={};for(const An of Wt)In[An]=dt[An].evaluate(At,jt);return In},Xe.reduce=(bn,In)=>{jt.properties=In;for(const An of Wt)At.accumulated=bn[An],bn[An]=ft[An].evaluate(At,jt)},Xe}(ae)).load(qe.features):ae.dynamic?this._dynamicIndex:function(Xe,ht){return new Ll(Xe,ht)}(qe,ae.geojsonVtOptions)}catch(Xe){return pe(Xe)}const at={};if(De){const Xe=O(ye);Xe&&(at.resourceTiming={},at.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Xe)))}pe(null,at)}})}reloadTile(ae,pe){const ye=this.loaded;return ye&&ye[ae.uid]?ae.partial?pe(null,void 0):super.reloadTile(ae,pe):this.loadTile(ae,pe)}loadGeoJSON(ae,pe){if(ae.request)i.n(ae.request,pe);else{if(typeof ae.data!="string")return pe(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(ae.data))}catch{return pe(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ae,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId))}catch(ye){pe(ye)}}getClusterChildren(ae,pe){try{pe(null,this._geoJSONIndex.getChildren(ae.clusterId))}catch(ye){pe(ye)}}getClusterLeaves(ae,pe){try{pe(null,this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset))}catch(ye){pe(ye)}}}class Fl{constructor(ae,pe){this.tileID=new i.aG(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ae.projection,this.brightness=pe}parse(ae,pe,ye,De){this.status="parsing";const ze=new i.aG(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),qe=[],at=pe.familiesBySource[ye.source],Xe=new i.d$(ze,ye.promoteId);return Xe.bucketLayerIDs=[],Xe.is3DTile=!0,i.ea(ae).then(ht=>{if(!ht)return De(new Error("Could not parse tile"));const dt=i.eb(ht,1/i.cc(ye.tileID.canonical)),ft=ht.json.extensionsUsed&&ht.json.extensionsUsed.includes("MAPBOX_mesh_features")||ht.json.asset.extras&&ht.json.asset.extras.MAPBOX_mesh_features,At=ht.json.extensionsUsed&&ht.json.extensionsUsed.includes("EXT_meshopt_compression"),jt=new i.a8(this.zoom,{brightness:this.brightness});for(const Wt in at)for(const bn of at[Wt]){const In=bn[0];Xe.bucketLayerIDs.push(bn.map(Mn=>i.aC(Mn.id,Mn.scope))),In.recalculate(jt,[]);const An=new i.ec(bn,dt,ze,ft,At,this.brightness,Xe);ft||(An.needsUpload=!0),qe.push(An),An.evaluate(In)}this.status="done",De(null,{buckets:qe,featureIndex:Xe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(ht=>De(new Error(ht.message)))}}class Gi{constructor(ae,pe,ye,De,ze,qe){this.actor=ae,this.layerIndex=pe,this.availableImages=ye,this.brightness=qe,this.loading={},this.loaded={}}loadTile(ae,pe){const ye=ae.uid,De=this.loading[ye]=new Fl(ae,this.brightness);i.bi(ae.request,(ze,qe)=>{const at=!this.loading[ye];return delete this.loading[ye],at||ze?(De.status="done",at||(this.loaded[ye]=De),pe(ze)):qe&&qe.byteLength!==0?void De.parse(qe,this.layerIndex,ae,(Xe,ht)=>{De.status="done",this.loaded=this.loaded||{},this.loaded[ye]=De,Xe||!ht?pe(Xe):pe(null,ht)}):(De.status="done",this.loaded[ye]=De,pe())})}reloadTile(ae,pe){const ye=this.loaded,De=ae.uid;if(ye&&ye[De]){const ze=ye[De];ze.projection=ae.projection,ze.brightness=ae.brightness;const qe=(at,Xe)=>{ze.reloadCallback&&(delete ze.reloadCallback,this.loadTile(ae,pe)),pe(at,Xe)};ze.status==="parsing"?ze.reloadCallback=qe:ze.status==="done"&&this.loadTile(ae,pe)}}abortTile(ae,pe){const ye=ae.uid;this.loading[ye]&&delete this.loading[ye],pe()}removeTile(ae,pe){const ye=this.loaded,De=ae.uid;ye&&ye[De]&&delete ye[De],pe()}}class ua{constructor(ae){this.self=ae,this.actor=new i.ed(ae,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Ie,geojson:Pc,"batched-model":Gi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,ye)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=ye},this.self.registerRTLTextPlugin=pe=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=pe.applyArabicShaping,i.ee.processBidirectionalText=pe.processBidirectionalText,i.ee.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(ae,pe,ye){delete this.layerIndexes[ae],delete this.availableImages[ae],delete this.workerSources[ae],delete this.demWorkerSources[ae],delete this.rasterArrayWorkerSource,ye()}checkIfReady(ae,pe,ye){ye()}setReferrer(ae,pe){this.referrer=pe}spriteLoaded(ae,{scope:pe,isLoaded:ye}){if(this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={}),this.isSpriteLoaded[ae][pe]=ye,this.workerSources[ae]&&this.workerSources[ae][pe])for(const De in this.workerSources[ae][pe]){const ze=this.workerSources[ae][pe][De];for(const qe in ze){const at=ze[qe];at instanceof Ie&&(at.isSpriteLoaded=ye,at.fire(new i.z("isSpriteLoaded")))}}}setImages(ae,{scope:pe,images:ye},De){if(this.availableImages[ae]||(this.availableImages[ae]={}),this.availableImages[ae][pe]=ye,this.workerSources[ae]&&this.workerSources[ae][pe]){for(const ze in this.workerSources[ae][pe]){const qe=this.workerSources[ae][pe][ze];for(const at in qe)qe[at].availableImages=ye}De()}else De()}setProjection(ae,pe){this.projections[ae]=i.bP(pe)}setBrightness(ae,pe,ye){this.brightness=pe,ye()}setLayers(ae,pe,ye){this.getLayerIndex(ae,pe.scope).replace(pe.layers,pe.options),ye()}updateLayers(ae,pe,ye){this.getLayerIndex(ae,pe.scope).update(pe.layers,pe.removedIds,pe.options),ye()}loadTile(ae,pe,ye){pe.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,pe.type,pe.source,pe.scope).loadTile(pe,ye)}loadDEMTile(ae,pe,ye){this.getDEMWorkerSource(ae,pe.source,pe.scope).loadTile(pe,ye)}decodeRasterArray(ae,pe,ye){this.getRasterArrayWorkerSource().decodeRasterArray(pe,ye)}reloadTile(ae,pe,ye){pe.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,pe.type,pe.source,pe.scope).reloadTile(pe,ye)}abortTile(ae,pe,ye){this.getWorkerSource(ae,pe.type,pe.source,pe.scope).abortTile(pe,ye)}removeTile(ae,pe,ye){this.getWorkerSource(ae,pe.type,pe.source,pe.scope).removeTile(pe,ye)}removeSource(ae,pe,ye){if(!(this.workerSources[ae]&&this.workerSources[ae][pe.scope]&&this.workerSources[ae][pe.scope][pe.type]&&this.workerSources[ae][pe.scope][pe.type][pe.source]))return;const De=this.workerSources[ae][pe.scope][pe.type][pe.source];delete this.workerSources[ae][pe.scope][pe.type][pe.source],De.removeSource!==void 0?De.removeSource(pe,ye):ye()}loadWorkerSource(ae,pe,ye){try{this.self.importScripts(pe.url),ye()}catch(De){ye(De.toString())}}syncRTLPluginState(ae,pe,ye){try{i.ee.setState(pe);const De=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&De!=null){this.self.importScripts(De);const ze=i.ee.isParsed();ye(ze?void 0:new Error(`RTL Text Plugin failed to import scripts from ${De}`),ze)}}catch(De){ye(De.toString())}}setDracoUrl(ae,pe){this.dracoUrl=pe}getAvailableImages(ae,pe){this.availableImages[ae]||(this.availableImages[ae]={});let ye=this.availableImages[ae][pe];return ye||(ye=[]),ye}getLayerIndex(ae,pe){this.layerIndexes[ae]||(this.layerIndexes[ae]={});let ye=this.layerIndexes[ae][pe];return ye||(ye=this.layerIndexes[ae][pe]=new F,ye.scope=pe),ye}getWorkerSource(ae,pe,ye,De){return this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][De]||(this.workerSources[ae][De]={}),this.workerSources[ae][De][pe]||(this.workerSources[ae][De][pe]={}),this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={}),this.workerSources[ae][De][pe][ye]||(this.workerSources[ae][De][pe][ye]=new this.workerSourceTypes[pe]({send:(ze,qe,at,Xe,ht,dt)=>{this.actor.send(ze,qe,at,ae,ht,dt)},scheduler:this.actor.scheduler},this.getLayerIndex(ae,De),this.getAvailableImages(ae,De),this.isSpriteLoaded[ae][De],void 0,this.brightness)),this.workerSources[ae][De][pe][ye]}rasterizeImages(ae,pe,ye){const{imageTasks:De,scope:ze}=pe,qe={};for(const at in De){const{image:Xe,imageIdWithOptions:ht}=De[at];qe[at]=this.imageRasterizer.rasterize(ht,Xe,ze,ae)}ye(void 0,qe)}removeRasterizedImages(ae,pe,ye){const{imageIds:De,scope:ze}=pe;this.imageRasterizer.removeImagesFromCacheByIds(De,ze,ae),ye()}getDEMWorkerSource(ae,pe,ye){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][ye]||(this.demWorkerSources[ae][ye]={}),this.demWorkerSources[ae][ye][pe]||(this.demWorkerSources[ae][ye][pe]=new Ee),this.demWorkerSources[ae][ye][pe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Re),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ae,pe){i.ef(pe)}getWorkerPerformanceMetrics(ae,pe,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ua(self)),ua}),y(["./shared"],function(i){var O="3.10.0";const L={create:"create",load:"load",fullLoad:"fullLoad"},z={mark(f){performance.mark(f)},measure(f,r,s){performance.measure(f,r,s)}};function F(f){const r=f.name.split("?")[0];return i.a(r)&&r.includes("mapbox-gl.js")?"javascript":i.a(r)&&r.includes("mapbox-gl.css")?"css":i.b(r)?"fontRange":i.c(r)?"sprite":i.i(r)?"style":i.d(r)?"tilejson":"other"}var N,G={},Y=function(){if(N)return G;function f(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,S,I=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(I);try{S=new Worker(R),x=!0}catch{x=!1}return S&&S.terminate(),URL.revokeObjectURL(R),x}()?function(){var x=document.createElement("canvas");x.width=x.height=1;var S=x.getContext("2d");if(!S)return!1;var I=S.getImageData(0,0,1,1);return I&&I.width===x.width}()?(s[_=p&&p.failIfMajorPerformanceCaveat]===void 0&&(s[_]=function(x){var S,I=function(R){var $=document.createElement("canvas"),B=Object.create(f.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=R,$.getContext("webgl2",B)}(x);if(!I)return!1;try{S=I.createShader(I.VERTEX_SHADER)}catch{return!1}return!(!S||I.isContextLost())&&(I.shaderSource(S,"void main() {}"),I.compileShader(S),I.getShaderParameter(S,I.COMPILE_STATUS)===!0)}(_)),s[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var _}N=1,G.supported=f,G.notSupportedReason=r;var s={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},G}();function K(f,r,s){const p=document.createElement(f);return r!=null&&(p.className=r),s&&s.appendChild(p),p}function J(f,r,s){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const _ of Object.keys(r))p.setAttributeNS(null,_,String(r[_]));return s&&s.appendChild(p),p}const X=typeof document<"u"?document.documentElement&&document.documentElement.style:null,se=X&&X.userSelect!==void 0?"userSelect":"WebkitUserSelect";let te;function ne(){X&&se&&(te=X[se],X[se]="none")}function ue(){X&&se&&(X[se]=te)}function ge(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",ge,!0)}function ee(){window.addEventListener("click",ge,!0),window.setTimeout(()=>{window.removeEventListener("click",ge,!0)},0)}function be(f,r){const s=f.getBoundingClientRect();return Re(f,s,r)}function Ie(f,r){const s=f.getBoundingClientRect(),p=[];for(let _=0;_<r.length;_++)p.push(Re(f,s,r[_]));return p}function Ee(f){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&f.button===2&&f.ctrlKey?0:f.button}function Re(f,r,s){const p=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new i.P((s.clientX-r.left)*p,(s.clientY-r.top)*p)}const Qe="01",et="NO_ACCESS_TOKEN";class We{constructor(r,s,p){this._transformRequestFn=r,this._customAccessToken=s,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let s="";for(let p=0;p<10;p++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Qe,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}}normalizeStyleURL(r,s){if(!i.f(r))return r;const p=Oe(r);return p.params.push(`sdk=js-${O}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeGlyphsURL(r,s){if(!i.f(r))return r;const p=Oe(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeModelURL(r,s){if(!i.f(r))return r;const p=Oe(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeSourceURL(r,s,p,_){if(!i.f(r))return r;const x=Oe(r);return x.path=`/v4/${x.authority}.json`,x.params.push("secure"),p&&x.params.push(`language=${p}`),_&&x.params.push(`worldview=${_}`),this._makeAPIURL(x,this._customAccessToken||s)}normalizeIconsetURL(r,s){const p=Oe(r);return i.f(r)?(p.path=`/styles/v1${p.path}/iconset.pbf`,this._makeAPIURL(p,this._customAccessToken||s)):Fe(p)}normalizeSpriteURL(r,s,p,_){const x=Oe(r);return i.f(r)?(x.path=`/styles/v1${x.path}/sprite${s}${p}`,this._makeAPIURL(x,this._customAccessToken||_)):(x.path+=`${s}${p}`,Fe(x))}normalizeTileURL(r,s,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!i.f(r))return r;const _=Oe(r);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||p&&_.authority!=="raster"&&p===512?"@2x":""}${i.m.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${i.e.RASTER_URL_PREFIX}${_.path}`:_.authority==="rasterarrays"?_.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${_.path}`:_.authority==="3dtiles"?_.path=`/${i.e.TILES3D_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${i.e.TILE_URL_VERSION}${_.path}`);const x=this._customAccessToken||function(S){for(const I of S){const R=I.match(/^access_token=(.*)$/);if(R)return R[1]}return null}(_.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&x&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,x)}canonicalizeTileURL(r,s){const p=Oe(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let _="mapbox://";p.path.match(/^\/raster\/v1\//)?_+=`raster/${p.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?_+=`rasterarrays/${p.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:_+=`tiles/${p.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let x=p.params;return s&&(x=x.filter(S=>!S.match(/^access_token=/))),x.length&&(_+=`?${x.join("&")}`),_}canonicalizeTileset(r,s){const p=!!s&&i.f(s),_=[];for(const x of r.tiles||[])i.h(x)?_.push(this.canonicalizeTileURL(x,p)):_.push(x);return _}_makeAPIURL(r,s){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",_=Oe(i.e.API_URL);if(r.protocol=_.protocol,r.authority=_.authority,r.protocol==="http"){const x=r.params.indexOf("secure");x>=0&&r.params.splice(x,1)}if(_.path!=="/"&&(r.path=`${_.path}${r.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Fe(r);if(s=s||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(x=>x.indexOf("access_token")===-1),r.params.push(`access_token=${s||""}`),Fe(r)}}const me=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Oe(f){const r=f.match(me);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Fe(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const Ke="mapbox.eventData";function $e(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(i.j(r[1]))}catch{return null}}class pt{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const s=$e(i.e.ACCESS_TOKEN);let p="";return p=s&&s.u?i.k(s.u):i.e.ACCESS_TOKEN||"",r?`${Ke}.${r}:${p}`:`${Ke}:${p}`}fetchEventData(){const r=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const _=localStorage.getItem(s);_&&(this.eventData=JSON.parse(_));const x=localStorage.getItem(p);x&&(this.anonId=x)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const r=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid"),_=this.anonId;if(r&&_)try{localStorage.setItem(p,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,s,p,_){if(!i.e.EVENTS_URL)return;const x=Oe(i.e.EVENTS_URL);x.params.push(`access_token=${_||i.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(r).toISOString()},I=s?i.l(S,s):S,R={url:Fe(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=i.p(R,$=>{this.pendingRequest=null,p($),this.saveEventData(),this.processRequests(_)})}queueRequest(r,s){this.queue.push(r),this.processRequests(s)}}const Ct=new class extends pt{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(s=>i.f(s)||i.h(s))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=$e(i.e.ACCESS_TOKEN),s=r?r.u:i.e.ACCESS_TOKEN;let p=s!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),p=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),S=new Date(_),I=(_-this.eventData.lastSuccess)/864e5;p=p||I>=1||I<-1||x.getDate()!==S.getDate()}else p=!0;p?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:Qe,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=_,this.eventData.tokenU=s)},f):this.processRequests()}},Lt=Ct.postTurnstileEvent.bind(Ct),It=new class extends pt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,s,p){this.skuToken=r,this.errorCb=p,i.e.EVENTS_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},s):this.errorCb(new Error(et)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:Qe,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},_n=It.postMapLoadEvent.bind(It),Ut=new class extends pt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=i.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:s,style:p,importedStyles:_}=r;if(!i.e.EVENTS_URL||!f&&!i.e.ACCESS_TOKEN)return;const x=this.getMapInstanceId(s),S={mapInstanceId:x,eventId:this.getEventId(x),style:p};_.length&&(S.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:S},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:s}=this.queue.shift();this.postEvent(r,s,()=>{},f)}},ln=Ut.postStyleLoadEvent.bind(Ut),xn=new class extends pt{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){i.e.EVENTS_URL&&(f||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:s}=this.queue.shift(),p=function(_){const x=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),I=function(q){const ce={};if(q){for(const ie in q)if(ie!=="other")for(const he of q[ie]){const de=`${ie}ResolveRangeMin`,ve=`${ie}ResolveRangeMax`,Me=`${ie}RequestCount`,Te=`${ie}RequestCachedCount`;ce[de]=Math.min(ce[de]||1/0,he.startTime),ce[ve]=Math.max(ce[ve]||-1/0,he.responseEnd);const Be=Pe=>{ce[Pe]===void 0&&(ce[Pe]=0),++ce[Pe]};he.transferSize!==void 0&&he.transferSize===0&&Be(Te),Be(Me)}}return ce}(function(q,ce){const ie={};if(q)for(const he of q){const de=ce(he);ie[de]===void 0&&(ie[de]=[]),ie[de].push(he)}return ie}(x,F)),R=window.devicePixelRatio,$=navigator.connection||navigator.mozConnection||navigator.webkitConnection,B=$?$.effectiveType:void 0,j={counters:[],metadata:[],attributes:[]},U=(q,ce,ie)=>{ie!=null&&q.push({name:ce,value:ie.toString()})};for(const q in I)U(j.counters,q,I[q]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(U(j.counters,"interactionRangeMin",_.interactionRange[0]),U(j.counters,"interactionRangeMax",_.interactionRange[1])),S)for(const q of Object.keys(L)){const ce=L[q],ie=S.find(he=>he.name===ce);ie&&U(j.counters,ce,ie.startTime)}return U(j.counters,"visibilityHidden",_.visibilityHidden),U(j.attributes,"style",function(q){if(q)for(const ce of q){const ie=ce.name.split("?")[0];if(i.i(ie)){const he=ie.split("/").slice(-2);if(he.length===2)return`mapbox://styles/${he[0]}/${he[1]}`}}}(x)),U(j.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),U(j.attributes,"fogEnabled",_.fogEnabled?"true":"false"),U(j.attributes,"projection",_.projection),U(j.attributes,"zoom",_.zoom),U(j.metadata,"devicePixelRatio",R),U(j.metadata,"connectionEffectiveType",B),U(j.metadata,"navigatorUserAgent",navigator.userAgent),U(j.metadata,"screenWidth",window.screen.width),U(j.metadata,"screenHeight",window.screen.height),U(j.metadata,"windowWidth",window.innerWidth),U(j.metadata,"windowHeight",window.innerHeight),U(j.metadata,"mapWidth",_.width/R),U(j.metadata,"mapHeight",_.height/R),U(j.metadata,"webglRenderer",_.renderer),U(j.metadata,"webglVendor",_.vendor),U(j.metadata,"sdkVersion",O),U(j.metadata,"sdkIdentifier","mapbox-gl-js"),j}(s);for(const _ of p.metadata);for(const _ of p.counters);for(const _ of p.attributes);this.postEvent(r,p,()=>{},f)}},En=xn.postPerformanceEvent.bind(xn),Nt=new class extends pt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,s,p){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const _=Oe(i.e.API_URL+i.e.SESSION_PATH);_.params.push(`sku=${r||""}`),_.params.push(`access_token=${p||i.e.ACCESS_TOKEN||""}`);const x={url:Fe(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(x,S=>{this.pendingRequest=null,s(S),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,r,s,p){this.skuToken=r,this.errorCb=p,i.e.SESSION_PATH&&i.e.API_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},s):this.errorCb(new Error(et)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||this.getSession(s,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},_e=Nt.getSessionAPI.bind(Nt),Ft=new Set;function Ve(f,r){r?Ft.add(f):Ft.delete(f)}class Ye{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,s){this._updatedSourceCaches[r]=s,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const s=r.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(r.id),this.setDirty()}removeLayer(r){const s=r.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][r.id]=r,this._updatedLayers[s].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const s in this._updatedLayers)r[s]=r[s]||{},r[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)r[s]=r[s]||{},r[s].removedIds=Object.keys(this._removedLayers[s]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function je(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Mt extends i.E{constructor(r){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=r,r!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new i.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,s){if(this.loaded[s]!==r&&(this.loaded[s]=r,r)){for(const{ids:p,callback:_}of this.requestors)this._notify(p,s,_);this.requestors=[]}}hasImage(r,s){return!!this.getImage(r,s)}getImage(r,s){return this.images[s][r]}addImage(r,s,p){this._validate(r,p)&&(this.images[s][r]=p)}_validate(r,s){let p=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(s.content,s)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,s){if(!r)return!0;let p=0;for(const _ of r){if(_[0]<p||_[1]<_[0]||s<_[1])return!1;p=_[1]}return!0}_validateContent(r,s){return r?r.length!==4||!s.usvg&&(r[0]<0||s.data.width<r[0]||r[1]<0||s.data.height<r[1]||r[2]<0||s.data.width<r[2]||r[3]<0||s.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,s,p){p.version=this.images[s][r].version+1,this.images[s][r]=p,this.updatedImages[s][r]=!0,this.removeFromImageRasterizerCache(r,s)}removeFromImageRasterizerCache(r,s){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:s}):this.imageRasterizer.removeImagesFromCacheByIds([r],s))}removeImage(r,s){const p=this.images[s][r];delete this.images[s][r],delete this.patterns[s][r],this.removeFromImageRasterizerCache(r,s),p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,s,p){let _=!0;const x=!!this.loaded[s];if(!x)for(const S of r)this.images[s][S]||(_=!1);x||_?this._notify(r,s,p):this.requestors.push({ids:r,scope:s,callback:p})}rasterizeImages({scope:r,imageTasks:s},p){const _={};for(const x in s){const S=s[x],I=this.getImage(S.id,r);I&&(_[x]={image:I,imageIdWithOptions:S})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:_,scope:r},p):this.rasterizeImagesInMainThread({imageTasks:_,scope:r},p)}rasterizeImagesInMainThread(r,s){const{imageTasks:p,scope:_}=r,x={};for(const S in p){const{image:I,imageIdWithOptions:R}=p[S];x[S]=this.imageRasterizer.rasterize(R,I,_,"")}s(void 0,x)}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,s,p){const _={};for(const x of r){this.images[s][x]||this.fire(new i.z("styleimagemissing",{id:x}));const S=this.images[s][x];S?_[x]={data:S.usvg?null:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,usvg:S.usvg,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:i.w(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,_)}getPixelSize(r){const{width:s,height:p}=this.atlasImage[r];return{width:s,height:p}}getPattern(r,s,p){const _=this.patterns[s][r],x=this.getImage(r,s);if(!x)return null;if(_&&_.position.version===x.version)return _.position;if(_)_.position.version=x.version;else{x.usvg&&!x.data&&(x.data=this.imageRasterizer.rasterize(i.A.from(r).getPrimary(),x,s,""));const S={w:x.data.width+2*i.B,h:x.data.height+2*i.B,x:0,y:0},I=new i.C(S,x,i.B);this.patterns[s][r]={bin:S,position:I}}return this._updatePatternAtlas(s,p),this.patterns[s][r].position}bind(r,s){const p=r.gl;let _=this.atlasTexture[s];_?this.dirty&&(_.update(this.atlasImage[s]),this.dirty=!1):(_=new i.T(r,this.atlasImage[s],p.RGBA8),this.atlasTexture[s]=_),_.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,s){const p=[];for(const I in this.patterns[r])p.push(this.patterns[r][I].bin);const{w:_,h:x}=i.F(p),S=this.atlasImage[r];S.resize({width:_||1,height:x||1});for(const I in this.patterns[r]){const{bin:R,position:$}=this.patterns[r][I];let B=$.padding;const j=R.x+B,U=R.y+B,q=this.images[r][I].data,ce=q.width,ie=q.height;B=B>1?B-1:B,i.r.copy(q,S,{x:0,y:0},{x:j,y:U},{width:ce,height:ie},s),i.r.copy(q,S,{x:0,y:ie-B},{x:j,y:U-B},{width:ce,height:B},s),i.r.copy(q,S,{x:0,y:0},{x:j,y:U+ie},{width:ce,height:B},s),i.r.copy(q,S,{x:ce-B,y:0},{x:j-B,y:U},{width:B,height:ie},s),i.r.copy(q,S,{x:0,y:0},{x:j+ce,y:U},{width:B,height:ie},s),i.r.copy(q,S,{x:ce-B,y:ie-B},{x:j-B,y:U-B},{width:B,height:B},s),i.r.copy(q,S,{x:0,y:ie-B},{x:j+ce,y:U-B},{width:B,height:B},s),i.r.copy(q,S,{x:0,y:0},{x:j+ce,y:U+ie},{width:B,height:B},s),i.r.copy(q,S,{x:ce-B,y:0},{x:j-B,y:U+ie},{width:B,height:B},s)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,s){for(const p of r){if(this.callbackDispatchedThisFrame[s][p])continue;this.callbackDispatchedThisFrame[s][p]=!0;const _=this.images[s][p];je(_)&&this.updateImage(p,s,_)}}}function Pt(f){const r=f.key,s=f.value,p=f.valueSpec||{},_=f.objectElementValidators||{},x=f.style,S=f.styleSpec;let I=[];const R=i.H(s);if(R!=="object")return[new i.V(r,s,`object expected, ${R} found`)];for(const $ in s){const B=$.split(".")[0];let j;_[B]?j=_[B]:p[B]?j=kn:_["*"]?j=_["*"]:p["*"]&&(j=kn),j?I=I.concat(j({key:(r&&`${r}.`)+$,value:s[$],valueSpec:p[B]||p["*"],style:x,styleSpec:S,object:s,objectKey:$},s)):I.push(new i.G(r,s[$],`unknown property "${$}"`))}for(const $ in p)_[$]||p[$].required&&p[$].default===void 0&&s[$]===void 0&&I.push(new i.V(r,s,`missing required property "${$}"`));return I}function qt(f){const r=f.value,s=f.valueSpec,p=f.style,_=f.styleSpec,x=f.key,S=f.arrayElementValidator||kn;if(i.H(r)!=="array")return[new i.V(x,r,`array expected, ${i.H(r)} found`)];if(s.length&&r.length!==s.length)return[new i.V(x,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new i.V(x,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let I={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};_.$version<7&&(I.function=s.function),i.H(s.value)==="object"&&(I=s.value);let R=[];for(let $=0;$<r.length;$++)R=R.concat(S({array:r,arrayIndex:$,value:r[$],valueSpec:I,style:p,styleSpec:_,key:`${x}[${$}]`},!0));return R}function zt(f){const r=f.key,s=f.value,p=f.valueSpec;let _=i.H(s);if(_==="number"&&s!=s&&(_="NaN"),_!=="number")return[new i.V(r,s,`number expected, ${_} found`)];if("minimum"in p){let x=p.minimum;if(i.H(p.minimum)==="array"&&(x=p.minimum[f.arrayIndex]),s<x)return[new i.V(r,s,`${s} is less than the minimum value ${x}`)]}if("maximum"in p){let x=p.maximum;if(i.H(p.maximum)==="array"&&(x=p.maximum[f.arrayIndex]),s>x)return[new i.V(r,s,`${s} is greater than the maximum value ${x}`)]}return[]}function Kt(f){const r=f.valueSpec,s=i.K(f.value.type);let p,_,x,S={};const I=s!=="categorical"&&f.value.property===void 0,R=!I,$=i.H(f.value.stops)==="array"&&i.H(f.value.stops[0])==="array"&&i.H(f.value.stops[0][0])==="object",B=Pt({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(q){if(s==="identity")return[new i.V(q.key,q.value,'identity function may not have a "stops" property')];let ce=[];const ie=q.value;return ce=ce.concat(qt({key:q.key,value:ie,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:j})),i.H(ie)==="array"&&ie.length===0&&ce.push(new i.V(q.key,ie,"array must have at least one stop")),ce},default:function(q){return kn({key:q.key,value:q.value,valueSpec:r,style:q.style,styleSpec:q.styleSpec})}}});return s==="identity"&&I&&B.push(new i.V(f.key,f.value,'missing required property "property"')),s==="identity"||f.value.stops||B.push(new i.V(f.key,f.value,'missing required property "stops"')),s==="exponential"&&f.valueSpec.expression&&!i.L(f.valueSpec)&&B.push(new i.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(R&&!i.M(f.valueSpec)?B.push(new i.V(f.key,f.value,"property functions not supported")):I&&!i.N(f.valueSpec)&&B.push(new i.V(f.key,f.value,"zoom functions not supported"))),s!=="categorical"&&!$||f.value.property!==void 0||B.push(new i.V(f.key,f.value,'"property" property is required')),B;function j(q){let ce=[];const ie=q.value,he=q.key;if(i.H(ie)!=="array")return[new i.V(he,ie,`array expected, ${i.H(ie)} found`)];if(ie.length!==2)return[new i.V(he,ie,`array length 2 expected, length ${ie.length} found`)];if($){if(i.H(ie[0])!=="object")return[new i.V(he,ie,`object expected, ${i.H(ie[0])} found`)];if(ie[0].zoom===void 0)return[new i.V(he,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new i.V(he,ie,"object stop key must have value")];const de=i.K(ie[0].zoom);if(typeof de!="number")return[new i.V(he,ie[0].zoom,"stop zoom values must be numbers")];if(x&&x>de)return[new i.V(he,ie[0].zoom,"stop zoom values must appear in ascending order")];de!==x&&(x=de,_=void 0,S={}),ce=ce.concat(Pt({key:`${he}[0]`,value:ie[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:zt,value:U}}))}else ce=ce.concat(U({key:`${he}[0]`,value:ie[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},ie));return i.O(i.Q(ie[1]))?ce.concat([new i.V(`${he}[1]`,ie[1],"expressions are not allowed in function stops.")]):ce.concat(kn({key:`${he}[1]`,value:ie[1],valueSpec:r,style:q.style,styleSpec:q.styleSpec}))}function U(q,ce){const ie=i.H(q.value),he=i.K(q.value),de=q.value!==null?q.value:ce;if(p){if(ie!==p)return[new i.V(q.key,de,`${ie} stop domain type must match previous stop domain type ${p}`)]}else p=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean"&&typeof he!="number"&&typeof he!="string"&&typeof he!="boolean")return[new i.V(q.key,de,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&s!=="categorical"){let ve=`number expected, ${ie} found`;return i.M(r)&&s===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(q.key,de,ve)]}return s!=="categorical"||ie!=="number"||typeof he=="number"&&isFinite(he)&&Math.floor(he)===he?s!=="categorical"&&ie==="number"&&typeof he=="number"&&typeof _=="number"&&_!==void 0&&he<_?[new i.V(q.key,de,"stop domain values must appear in ascending order")]:(_=he,s==="categorical"&&he in S?[new i.V(q.key,de,"stop domain values must be unique")]:(S[he]=!0,[])):[new i.V(q.key,de,`integer expected, found ${String(he)}`)]}}function an(f){const r=(f.expressionContext==="property"?i.S:i.U)(i.Q(f.value),f.valueSpec);if(r.result==="error")return r.value.map(p=>new i.V(`${f.key}${p.key}`,f.value,p.message));const s=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!s.outputDefined())return[new i.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!i.W(s))return[new i.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return un(s,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!i.X(s,["zoom","feature-state"]))return[new i.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!i.Y(s))return[new i.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function un(f,r){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const _ of r.valueSpec.expression.parameters)s.delete(_);if(s.size===0)return[];const p=[];return f instanceof i.Z&&s.has(f.name)?[new i.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(_=>{p.push(...un(_,r))}),p)}function Nn(f){const r=f.key,s=f.value,p=f.valueSpec,_=[];return Array.isArray(p.values)?p.values.indexOf(i.K(s))===-1&&_.push(new i.V(r,s,`expected one of [${p.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(p.values).indexOf(i.K(s))===-1&&_.push(new i.V(r,s,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(s)} found`)),_}function Sn(f){return i.$(i.Q(f.value))?an(i.J({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):Qt(f)}function Qt(f){const r=f.value,s=f.key;if(i.H(r)!=="array")return[new i.V(s,r,`array expected, ${i.H(r)} found`)];const p=f.styleSpec;let _,x=[];if(r.length<1)return[new i.V(s,r,"filter array must have at least 1 element")];switch(x=x.concat(Nn({key:`${s}[0]`,value:r[0],valueSpec:p.filter_operator,style:f.style,styleSpec:f.styleSpec})),i.K(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.K(r[1])==="$type"&&x.push(new i.V(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&x.push(new i.V(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(_=i.H(r[1]),_!=="string"&&x.push(new i.V(`${s}[1]`,r[1],`string expected, ${_} found`)));for(let S=2;S<r.length;S++)_=i.H(r[S]),i.K(r[1])==="$type"?x=x.concat(Nn({key:`${s}[${S}]`,value:r[S],valueSpec:p.geometry_type,style:f.style,styleSpec:f.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&x.push(new i.V(`${s}[${S}]`,r[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<r.length;S++)x=x.concat(Qt({key:`${s}[${S}]`,value:r[S],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":_=i.H(r[1]),r.length!==2?x.push(new i.V(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):_!=="string"&&x.push(new i.V(`${s}[1]`,r[1],`string expected, ${_} found`))}return x}function Hn(f,r){const s=f.key,p=f.style,_=f.layer,x=f.styleSpec,S=f.value,I=f.objectKey,R=x[`${r}_${f.layerType}`];if(!R)return[];const $=I.match(/^(.*)-use-theme$/);if(r==="paint"&&$&&R[$[1]])return i.O(S)?[].concat(kn({key:f.key,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:p,styleSpec:x,expressionContext:"property",propertyType:r,propertyKey:I})):kn({key:s,value:S,valueSpec:{type:"string"},style:p,styleSpec:x});const B=I.match(/^(.*)-transition$/);if(r==="paint"&&B&&R[B[1]]&&R[B[1]].transition)return kn({key:s,value:S,valueSpec:x.transition,style:p,styleSpec:x});const j=f.valueSpec||R[I];if(!j)return[new i.G(s,S,`unknown property "${I}"`)];let U;if(i.H(S)==="string"&&i.M(j)&&!j.tokens&&(U=/^{([^}]+)}$/.exec(S))){const ce=`\`{ "type": "identity", "property": ${U?JSON.stringify(U[1]):'"_"'} }\``;return[new i.V(s,S,`"${I}" does not support interpolation syntax
Use an identity property function instead: ${ce}.`)]}const q=[];if(f.layerType==="symbol")I!=="text-field"||!p||p.glyphs||p.imports||q.push(new i.V(s,S,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&i.a0(i.Q(S))&&i.K(S.type)==="identity"&&q.push(new i.V(s,S,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&_&&_.layout&&_.layout.hasOwnProperty("model-id")&&i.M(j)&&(i.a1(j)||i.N(j))){const ce=i.S(i.Q(S),j),ie=ce.value.expression||ce.value._styleExpression.expression;ie&&!i.X(ie,["measure-light"])&&(I==="model-emissive-strength"&&i.Y(ie)&&i.W(ie)||q.push(new i.V(s,S,`${I} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return q.concat(kn({key:f.key,value:S,valueSpec:j,style:p,styleSpec:x,expressionContext:"property",propertyType:r,propertyKey:I}))}function tr(f){return Hn(f,"paint")}function Pr(f){return Hn(f,"layout")}function nr(f){let r=[];const s=f.value,p=f.key,_=f.style,x=f.styleSpec;s.type||s.ref||r.push(new i.V(p,s,'either "type" or "ref" is required'));let S=i.K(s.type);const I=i.K(s.ref);if(s.id){const R=i.K(s.id);for(let $=0;$<f.arrayIndex;$++){const B=_.layers[$];i.K(B.id)===R&&r.push(new i.V(p,s.id,`duplicate layer id "${s.id}", previously used at line ${B.id.__line__}`))}}if("ref"in s){let R;["type","source","source-layer","filter","layout"].forEach($=>{$ in s&&r.push(new i.V(p,s[$],`"${$}" is prohibited for ref layers`))}),_.layers.forEach($=>{i.K($.id)===I&&(R=$)}),R?R.ref?r.push(new i.V(p,s.ref,"ref cannot reference another ref layer")):S=i.K(R.type):typeof I=="string"&&r.push(new i.V(p,s.ref,`ref layer "${I}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(s.source){const R=_.sources&&_.sources[s.source],$=R&&i.K(R.type);R?$==="vector"&&S==="raster"?r.push(new i.V(p,s.source,`layer "${s.id}" requires a raster source`)):$==="raster"&&S!=="raster"?r.push(new i.V(p,s.source,`layer "${s.id}" requires a vector source`)):$!=="vector"||s["source-layer"]?$==="raster-dem"&&S!=="hillshade"?r.push(new i.V(p,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):$!=="raster-array"||["raster","raster-particle"].includes(S)?S!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||$==="geojson"&&R.lineMetrics?S==="raster-particle"&&$!=="raster-array"&&r.push(new i.V(p,s.source,`layer "${s.id}" requires a 'raster-array' source.`)):r.push(new i.V(p,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new i.V(p,s.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new i.V(p,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new i.V(p,s.source,`source "${s.source}" not found`))}else r.push(new i.V(p,s,'missing required property "source"'));return r=r.concat(Pt({key:p,value:s,valueSpec:x.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>kn({key:`${p}.type`,value:s.type,valueSpec:x.layer.type,style:f.style,styleSpec:f.styleSpec,object:s,objectKey:"type"}),filter:R=>Sn(i.J({layerType:S},R)),layout:R=>Pt({layer:s,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":$=>Pr(i.J({layerType:S},$))}}),paint:R=>Pt({layer:s,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":$=>tr(i.J({layerType:S,layer:s},$))}})}})),r}function pi(f){const r=f.value,s=f.key,p=i.H(r);return p!=="string"?[new i.V(s,r,`string expected, ${p} found`)]:[]}const xi={promoteId:function f({key:r,value:s}){if(i.H(s)==="string")return pi({key:r,value:s});if(Array.isArray(s)){const p=[],_=i.Q(s),x=i.U(_);return x.result==="error"&&x.value.forEach(S=>{p.push(new i.V(`${r}${S.key}`,null,`${S.message}`))}),i.X(x.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||p.push(new i.V(`${r}`,null,"promoteId expression should be only feature dependent")),p}{const p=[];for(const _ in s)p.push(...f({key:`${r}.${_}`,value:s[_]}));return p}}};function Yi(f){const r=f.value,s=f.key,p=f.styleSpec,_=f.style;if(!r.type)return[new i.V(s,r,'"type" is required')];const x=i.K(r.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(x)&&(r.url||r.tiles||S.push(new i.G(s,r,'Either "url" or "tiles" is required.'))),x){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(Pt({key:s,value:r,valueSpec:p[`source_${x.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:xi})),S;case"geojson":if(S=Pt({key:s,value:r,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:xi}),r.cluster)for(const I in r.clusterProperties){const[R,$]=r.clusterProperties[I],B=typeof R=="string"?[R,["accumulated"],["get",I]]:R;S.push(...an({key:`${s}.${I}.map`,value:$,expressionContext:"cluster-map"})),S.push(...an({key:`${s}.${I}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return S;case"video":return Pt({key:s,value:r,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return Pt({key:s,value:r,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new i.V(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nn({key:`${s}.type`,value:r.type,valueSpec:{values:Xi(p)},style:_,styleSpec:p})}}function Xi(f){return f.source.reduce((r,s)=>{const p=f[s];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function Ai(f){const r=f.value,s=f.styleSpec,p=s.light,_=f.style;let x=[];const S=i.H(r);if(r===void 0)return x;if(S!=="object")return x=x.concat([new i.V("light",r,`object expected, ${S} found`)]),x;for(const I in r){const R=I.match(/^(.*)-transition$/),$=I.match(/^(.*)-use-theme$/);x=x.concat($&&p[$[1]]?kn({key:I,value:r[I],valueSpec:{type:"string"},style:_,styleSpec:s}):R&&p[R[1]]&&p[R[1]].transition?kn({key:I,value:r[I],valueSpec:s.transition,style:_,styleSpec:s}):p[I]?kn({key:I,value:r[I],valueSpec:p[I],style:_,styleSpec:s}):[new i.V(I,r[I],`unknown property "${I}"`)])}return x}function xa(f){const r=f.value;let s=[];if(!r)return s;const p=i.H(r);if(p!=="object")return s=s.concat([new i.V("light-3d",r,`object expected, ${p} found`)]),s;const _=f.styleSpec,x=_["light-3d"],S=f.key,I=f.style,R=f.style.lights;for(const j of["type","id"])if(!(j in r))return s=s.concat([new i.V("light-3d",r,`missing property ${j} on light`)]),s;if(r.type&&R)for(let j=0;j<f.arrayIndex;j++){const U=i.K(r.type),q=R[j];i.K(q.type)===U&&s.push(new i.V(S,r.id,`duplicate light type "${r.type}", previously defined at line ${q.id.__line__}`))}const $=`properties_light_${r.type}`;if(!($ in _))return s=s.concat([new i.V("light-3d",r,`Invalid light type ${r.type}`)]),s;const B=_[$];for(const j in r)if(j==="properties"){const U=r[j],q=i.H(U);if(q!=="object")return s=s.concat([new i.V("properties",U,`object expected, ${q} found`)]),s;for(const ce in U)s=s.concat(B[ce]?kn({key:ce,value:U[ce],valueSpec:B[ce],style:I,styleSpec:_}):[new i.G(f.key,U[ce],`unknown property "${ce}"`)])}else{const U=j.match(/^(.*)-transition$/),q=j.match(/^(.*)-use-theme$/);s=s.concat(q&&x[q[1]]?kn({key:j,value:r[j],valueSpec:{type:"string"},style:I,styleSpec:_}):U&&x[U[1]]&&x[U[1]].transition?kn({key:j,value:r[j],valueSpec:_.transition,style:I,styleSpec:_}):x[j]?kn({key:j,value:r[j],valueSpec:x[j],style:I,styleSpec:_}):[new i.G(j,r[j],`unknown property "${j}"`)])}return s}function Bi(f){const r=f.value,s=f.key,p=f.style,_=f.styleSpec,x=_.terrain;let S=[];const I=i.H(r);if(r===void 0||I==="null")return S;if(I!=="object")return S=S.concat([new i.V("terrain",r,`object expected, ${I} found`)]),S;for(const R in r){const $=R.match(/^(.*)-transition$/),B=R.match(/^(.*)-use-theme$/);S=S.concat(B&&x[B[1]]?kn({key:R,value:r[R],valueSpec:{type:"string"},style:p,styleSpec:_}):$&&x[$[1]]&&x[$[1]].transition?kn({key:R,value:r[R],valueSpec:_.transition,style:p,styleSpec:_}):x[R]?kn({key:R,value:r[R],valueSpec:x[R],style:p,styleSpec:_}):[new i.G(R,r[R],`unknown property "${R}"`)])}if(r.source){const R=p.sources&&p.sources[r.source],$=R&&i.K(R.type);R?$!=="raster-dem"&&S.push(new i.V(s,r.source,`terrain cannot be used with a source of type ${String($)}, it only be used with a "raster-dem" source type`)):S.push(new i.V(s,r.source,`source "${r.source}" not found`))}else S.push(new i.V(s,r,'terrain is missing required property "source"'));return S}function ci(f){const r=f.value,s=f.style,p=f.styleSpec,_=p.fog;let x=[];const S=i.H(r);if(r===void 0)return x;if(S!=="object")return x=x.concat([new i.V("fog",r,`object expected, ${S} found`)]),x;for(const I in r){const R=I.match(/^(.*)-transition$/),$=I.match(/^(.*)-use-theme$/);x=x.concat($&&_[$[1]]?kn({key:I,value:r[I],valueSpec:{type:"string"},style:s,styleSpec:p}):R&&_[R[1]]&&_[R[1]].transition?kn({key:I,value:r[I],valueSpec:p.transition,style:s,styleSpec:p}):_[I]?kn({key:I,value:r[I],valueSpec:_[I],style:s,styleSpec:p}):[new i.G(I,r[I],`unknown property "${I}"`)])}return x}const ba={"*":()=>[],array:qt,boolean:function(f){const r=f.value,s=f.key,p=i.H(r);return p!=="boolean"?[new i.V(s,r,`boolean expected, ${p} found`)]:[]},number:zt,color:function(f){const r=f.key,s=f.value,p=i.H(s);return p!=="string"?[new i.V(r,s,`color expected, ${p} found`)]:i._.parseCSSColor(s)===null?[new i.V(r,s,`color expected, "${s}" found`)]:[]},enum:Nn,filter:Sn,function:Kt,layer:nr,object:Pt,source:Yi,model:i.a2,light:Ai,"light-3d":xa,terrain:Bi,fog:ci,string:pi,formatted:function(f){return pi(f).length===0?[]:an(f)},resolvedImage:function(f){return pi(f).length===0?[]:an(f)},projection:function(f){const r=f.value,s=f.styleSpec,p=s.projection,_=f.style;let x=[];const S=i.H(r);if(S==="object")for(const I in r)x=x.concat(kn({key:I,value:r[I],valueSpec:p[I],style:_,styleSpec:s}));else S!=="string"&&(x=x.concat([new i.V("projection",r,`object or string expected, ${S} found`)]));return x},import:function(f){const{value:r,styleSpec:s}=f,{data:p,..._}=r;Object.defineProperty(_,"__line__",{value:r.__line__,enumerable:!1});let x=Pt(i.J({},f,{value:_,valueSpec:s.import}));return i.K(_.id)===""&&x.push(new i.V(`${f.key}.id`,_,"import id can't be an empty string")),p&&(x=x.concat(Bu(p,s,{key:`${f.key}.data`}))),x}};function kn(f,r=!1){const s=f.value,p=f.valueSpec,_=f.styleSpec;if(p.expression&&i.a0(i.K(s)))return Kt(f);if(p.expression&&i.O(i.Q(s)))return an(f);if(p.type&&ba[p.type]){const x=ba[p.type](f);return r===!0&&x.length>0&&i.H(f.value)==="array"?an(f):x}return Pt(i.J({},f,{valueSpec:p.type?_[p.type]:p}))}function ca(f){const r=f.value,s=f.key,p=pi(f);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new i.V(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new i.V(s,r,'"glyphs" url must include a "{range}" token'))),p}function Bu(f,r=i.a3,s={}){return kn({key:s.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:ca,"*":()=>[]}})}function Ao(f,r=i.a3){return Gi(Bu(f,r))}const Ua=f=>Gi(Yi(f)),Dl=f=>Gi(Ai(f)),Rl=f=>Gi(xa(f)),zl=f=>Gi(Bi(f)),ku=f=>Gi(ci(f)),Ha=f=>Gi(function(r){const s=r.value,p=r.style,_=r.styleSpec,x=_.snow;let S=[];const I=i.H(s);if(s===void 0)return S;if(I!=="object")return S=S.concat([new i.V("snow",s,`object expected, ${I} found`)]),S;for(const R in s){const $=R.match(/^(.*)-transition$/);S=S.concat($&&x[$[1]]&&x[$[1]].transition?kn({key:R,value:s[R],valueSpec:_.transition,style:p,styleSpec:_}):x[R]?kn({key:R,value:s[R],valueSpec:x[R],style:p,styleSpec:_}):[new i.G(R,s[R],`unknown property "${R}"`)])}return S}(f)),Js=f=>Gi(function(r){const s=r.value,p=r.style,_=r.styleSpec,x=_.rain;let S=[];const I=i.H(s);if(s===void 0)return S;if(I!=="object")return S=S.concat([new i.V("rain",s,`object expected, ${I} found`)]),S;for(const R in s){const $=R.match(/^(.*)-transition$/);S=S.concat($&&x[$[1]]&&x[$[1]].transition?kn({key:R,value:s[R],valueSpec:_.transition,style:p,styleSpec:_}):x[R]?kn({key:R,value:s[R],valueSpec:x[R],style:p,styleSpec:_}):[new i.G(R,s[R],`unknown property "${R}"`)])}return S}(f)),Ll=f=>Gi(nr(f)),ni=f=>Gi(Sn(f)),$l=f=>Gi(tr(f)),Pc=f=>Gi(Pr(f)),Fl=f=>Gi(i.a2(f));function Gi(f){return f.slice().sort((r,s)=>r.line&&s.line?r.line-s.line:0)}function ua(f,r){let s=!1;if(r&&r.length)for(const p of r)p instanceof i.G?i.w(p.message):(f.fire(new i.y(new Error(p.message))),s=!0);return s}let mt;class ae extends i.E{constructor(r,s="flat"){super(),this._transitionable=new i.a4(mt||(mt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(r,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s,p={}){this._validate(Dl,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=s)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,p){return(!p||p.validate!==!1)&&ua(this,r.call(Ao,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let pe=class extends i.E{constructor(f,r,s,p){super(),this.scope=s,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),s,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new i.a8(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const r=f.value.expression;if(!r)return null;let s=-1,p=-1,_=1;for(const x of r.zoomStops)_=r.evaluate(new i.a8(x)),_>.01?(s=x,p=-1):p=x;return _<.01&&s>0&&p>s?[s,p]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof i.a9}};const ye=45,De=65,ze=.05;function qe(f,r,s,p){const _=i.ac(ye,De,s),[x,S]=at(f,p);let I=1-Math.min(1,Math.exp((r-x)/(S-x)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*_*f.alpha}function at(f,r){const s=.5/Math.tan(.5*r);return[f.range[0]+s,f.range[1]+s]}function Xe(f,r,s,p,_){const x=i.ab.vec3.transformMat4([],[r,s,p],_.mercatorFogMatrix);return qe(f,i.ab.vec3.length(x),_.pitch,_._fov)}function ht(f,r,s,p,_,x,S){const I=[[s,p,0],[_,p,0],[_,x,0],[s,x,0]];let R=Number.MAX_VALUE,$=-Number.MAX_VALUE;for(const B of I){const j=i.ab.vec3.transformMat4([],B,r),U=i.ab.vec3.length(j);R=Math.min(R,U),$=Math.max($,U)}return[qe(f,R,S.pitch,S._fov),qe(f,$,S.pitch,S._fov)]}class dt extends i.E{constructor(r,s,p,_){super();const x=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(x,p,new Map(_)),this.set(r,_),this._transitioning=this._transitionable.untransitioned(),this._transform=s,this.properties=new i.ad(x),this.scope=p}get state(){const r=this._transform,s=r.projection.name==="globe",p=i.ae(r.zoom),_=this.properties.get("range"),x=[.5,3];return{range:s?[i.af(x[0],_[0],p),i.af(x[1],_[1],p)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,s,p={}){if(this._validate(ku,r,p))return;const _=i.l({},r);for(const x of Object.keys(i.a3.fog))_[x]===void 0&&(_[x]=i.a3.fog[x].default);this._options=_,this._transitionable.setTransitionOrValue(this._options,s)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(ye,De,r))*s.a}getOpacityAtLatLng(r,s){return this._transform.projection.supportsFog?function(p,_,x){const S=i.aa.fromLngLat(_),I=x.elevation?x.elevation.getAtPointOrZero(S):0;return Xe(p,S.x,S.y,I,x)}(this.state,r,s):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(r.toUnwrapped());return ht(this.state,s,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(r,s,p,_,x){return this._transform.projection.supportsFog?ht(this.state,r,s,p,_,x,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?at(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const p of s){const _=r.points[p];let x;if(_[2]>=0)x=_;else{const S=r.points[p-4];x=i.ah(S,_,S[2]/(S[2]-_[2]))}if(Xe(this.state,x[0],x[1],0,this._transform)>=ze)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,p){return(!p||p.validate!==!1)&&ua(this,r.call(Ao,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let ft,At,jt,Wt,bn=class extends i.E{constructor(f,r,s,p){super();const _=ft||(ft=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(_,s,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(_),this.scope=s}get state(){const f=this.properties.get("opacity"),r=this.properties.get("color"),s=this.properties.get("direction"),p=i.ai(s[0]),_=-Math.max(i.ai(s[1]),.01),x=[Math.cos(p)*Math.cos(_),Math.sin(p)*Math.cos(_),Math.sin(_)],S=this.properties.get("vignette"),I=this.properties.get("vignette-color");return I.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*f),direction:x,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:I}}get(){return this._transitionable.serialize()}set(f,r,s={}){if(this._validate(Ha,f,s))return;const p=i.l({},f);for(const _ of Object.keys(i.a3.snow))p[_]===void 0&&(p[_]=i.a3.snow[_].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,r,s){return(!s||s.validate!==!1)&&ua(this,f.call(Ao,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},In=class extends i.E{constructor(f,r,s,p){super();const _=At||(At=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(_,s,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(_),this.scope=s}get state(){const f=this.properties.get("opacity"),r=this.properties.get("color"),s=this.properties.get("direction"),p=i.ai(s[0]),_=-Math.max(i.ai(s[1]),.01),x=[Math.cos(p)*Math.cos(_),Math.sin(p)*Math.cos(_),Math.sin(_)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*f),direction:x,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(f,r,s={}){if(this._validate(Js,f,s))return;const p=i.l({},f);for(const _ of Object.keys(i.a3.rain))p[_]===void 0&&(p[_]=i.a3.rain[_].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,r,s){return(!s||s.validate!==!1)&&ua(this,f.call(Ao,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class An extends i.E{constructor(r,s,p,_){super(),this.scope=p,this._options=r,this.properties=new i.ad(s),this._transitionable=new i.a4(s,p,new Map(_)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,s){this._options=r,this._transitionable.setTransitionOrValue(r.properties,s)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Mn{constructor(r,s,p,_){this.screenBounds=r,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(r,s){let p,_;if(r instanceof i.P||typeof r[0]=="number"){const x=i.P.convert(r);p=[x],_=s.isPointAboveHorizon(x)}else{const x=i.P.convert(r[0]),S=i.P.convert(r[1]);p=[x,S],_=i.al(x,S).every(I=>s.isPointAboveHorizon(I))}return new Mn(p,s.getCameraPoint(),_,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],_=i.al(s,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<p.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?_[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(_[3]=this.cameraPoint)),i.am(_,r)}bufferedCameraGeometryGlobe(r){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],_=i.al(s,p,r),x=this.cameraPoint.clone();switch(3*((x.y>s.y)+(x.y>p.y))+((x.x>s.x)+(x.x>p.x))){case 0:_[0]=x,_[4]=x.clone();break;case 1:_.splice(1,0,x);break;case 2:_[1]=x;break;case 3:_.splice(4,0,x);break;case 5:_.splice(2,0,x);break;case 6:_[3]=x;break;case 7:_.splice(3,0,x);break;case 8:_[2]=x}return _}containsTile(r,s,p,_=0){const x=r.queryPadding/s._pixelsPerMercatorPixel+1,S=p?this._bufferedCameraMercator(x,s):this._bufferedScreenMercator(x,s);let I=r.tileID.wrap+(S.unwrapped?_:0);const R=S.polygon.map(he=>i.an(r.tileTransform,he,I));if(!i.ao(R,0,0,i.ag,i.ag))return;I=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const $=this.screenGeometryMercator.polygon.map(he=>i.ap(r.tileTransform,he,I)),B=$.map(he=>new i.P(he[0],he[1])),j=s.getFreeCameraOptions().position||new i.aa(0,0,0),U=i.ap(r.tileTransform,j,I),q=$.map(he=>{const de=i.ab.vec3.sub(he,he,U);return i.ab.vec3.normalize(de,de),new i.aq(U,de)}),ce=i.ar(r,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:q,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:(ie=i.as(R),ie.min.x=i.aw(ie.min.x,0,i.ag),ie.min.y=i.aw(ie.min.y,0,i.ag),ie.max.x=i.aw(ie.max.x,0,i.ag),ie.max.y=i.aw(ie.max.y,0,i.ag),ie),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ce};var ie}_bufferedScreenMercator(r,s){const p=Gn(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let _;return _=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),s):{polygon:this.bufferedScreenGeometry(r).map(x=>s.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[p]=_,_}}_bufferedCameraMercator(r,s){const p=Gn(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let _;return _=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),s):{polygon:this.bufferedCameraGeometry(r).map(x=>s.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[p]=_,_}}_projectAndResample(r,s){const p=function(x,S){const I=i.ab.mat4.multiply([],S.pixelMatrix,S.globeMatrix),R=[0,-i.ax,0,1],$=[0,i.ax,0,1],B=[0,0,0,1];i.ab.vec4.transformMat4(R,R,I),i.ab.vec4.transformMat4($,$,I),i.ab.vec4.transformMat4(B,B,I);const j=new i.P(R[0]/R[3],R[1]/R[3]),U=new i.P($[0]/$[3],$[1]/$[3]),q=i.au(x,j)&&R[3]<B[3],ce=i.au(x,U)&&$[3]<B[3];if(!q&&!ce)return null;const ie=function(Le,Ae,Ue){for(let tt=1;tt<Le.length;tt++){const gt=rr(Ae.pointCoordinate3D(Le[tt-1]).x),ct=rr(Ae.pointCoordinate3D(Le[tt]).x);if(Ue<0){if(gt<ct)return{idx:tt,t:-gt/(ct-1-gt)}}else if(ct<gt)return{idx:tt,t:(1-gt)/(ct+1-gt)}}return null}(x,S,q?-1:1);if(!ie)return null;const{idx:he,t:de}=ie;let ve=he>1?Kn(x.slice(0,he),S):[],Me=he<x.length?Kn(x.slice(he),S):[];ve=ve.map(Le=>new i.P(rr(Le.x),Le.y)),Me=Me.map(Le=>new i.P(rr(Le.x),Le.y));const Te=[...ve];Te.length===0&&Te.push(Me[Me.length-1]);const Be=i.af(Te[Te.length-1].y,(Me.length===0?ve[0]:Me[0]).y,de);let Pe;return Pe=q?[new i.P(0,Be),new i.P(0,0),new i.P(1,0),new i.P(1,Be)]:[new i.P(1,Be),new i.P(1,1),new i.P(0,1),new i.P(0,Be)],Te.push(...Pe),Me.length===0?Te.push(ve[0]):Te.push(...Me),{polygon:Te.map(Le=>new i.aa(Le.x,Le.y)),unwrapped:!1}}(r,s);if(p)return p;const _=function(x,S){let I=!1,R=-1/0,$=0;for(let j=0;j<x.length-1;j++)x[j].x>R&&(R=x[j].x,$=j);for(let j=0;j<x.length-1;j++){const U=($+j)%(x.length-1),q=x[U],ce=x[U+1];Math.abs(q.x-ce.x)>.5&&(q.x<ce.x?(q.x+=1,U===0&&(x[x.length-1].x+=1)):(ce.x+=1,U+1===x.length-1&&(x[0].x+=1)),I=!0)}const B=i.at(S.center.lng);return I&&B<Math.abs(B-1)&&x.forEach(j=>{j.x-=1}),{polygon:x,unwrapped:I}}(Kn(r,s).map(x=>new i.P(rr(x.x),x.y)),s);return{polygon:_.polygon.map(x=>new i.aa(x.x,x.y)),unwrapped:_.unwrapped}}}function Kn(f,r){return i.av(f,s=>{const p=r.pointCoordinate3D(s);s.x=p.x,s.y=p.y},1/256)}function rr(f){return f<0?1+f%1:f%1}function Gn(f){return 100*f|0}function ar(f,r,s,p,_){const x=function(I,R){if(I)return _(I);if(R){if(f.url&&R.tiles&&f.tiles&&delete f.tiles,R.variants){if(!Array.isArray(R.variants))return _(new Error("variants must be an array"));for(const B of R.variants){if(B==null||typeof B!="object"||B.constructor!==Object)return _(new Error("variant must be an object"));if(!Array.isArray(B.capabilities))return _(new Error("capabilities must be an array"));if(B.capabilities.length===1&&B.capabilities[0]==="meshopt"){R=i.l(R,B);break}}}const $=i.ay(i.l({},R,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);$.tiles=r.canonicalizeTileset($,f.url),_(null,$)}},S=function(I,R,$){if(!I)return null;if(!R&&!$)return I;$=$||I.worldview_default;const B=Object.values(I.language||{});if(B.length===0)return null;const j=Object.values(I.worldview||{});if(j.length===0)return null;const U=B.every(ce=>ce===R),q=j.every(ce=>ce===$);return U&&q?I:R in(I.language_options||{})||$ in(I.worldview_options||{})?null:I.language_options&&I.worldview_options?I:null}(f.data,s,p);return S?i.q.frame(()=>x(null,S)):f.url?i.n(r.transformRequest(r.normalizeSourceURL(f.url,null,s,p),i.R.Source),x):i.q.frame(()=>{const{data:I,...R}=f;x(null,R)})}class fr{constructor(r,s,p){this.bounds=i.az.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),p=Math.floor(i.at(this.bounds.getWest())*s),_=Math.floor(i.aA(this.bounds.getNorth())*s),x=Math.ceil(i.at(this.bounds.getEast())*s),S=Math.ceil(i.aA(this.bounds.getSouth())*s);return r.x>=p&&r.x<x&&r.y>=_&&r.y<S}}class bi extends i.E{constructor(r,s,p,_){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(s,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new i.aB}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=ar(this._options,this.map._requestManager,s,p,(_,x)=>{if(this._tileJSONRequest=null,this._loaded=!0,_)s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new i.y(_));else if(x){if(i.l(this,x),this.hasWorldviews=!!x.worldview_options,x.worldview_default&&(this.worldviewDefault=x.worldview_default),x.vector_layers){this.vectorLayers=x.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of x.vector_layers)this.vectorLayerIds.push(S.id),x.worldview&&x.worldview[S.source]&&this.localizableLayerIds.add(S.id)}x.bounds&&(this.tileBounds=new fr(x.bounds,this.minzoom,this.maxzoom)),Lt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}r&&r(_)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(r,s){const p=r.tileID.canonical.url(this.tiles,this.scheme),_=this.map._requestManager.normalizeTileURL(p),x=this.map._requestManager.transformRequest(_,i.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,I=S?{image:S.image.clone()}:null,R={request:x,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:I,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(p)&&(R.worldview=this.map.getWorldview()||this.worldviewDefault,R.localizableLayerIds=this.localizableLayerIds),R.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=s:r.request=r.actor.send("reloadTile",R,$.bind(this));else if(r.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",R,$.bind(this),void 0,!0);else{const B=i.aD.call({deduped:this._deduped},R,(j,U)=>{j||!U?$.call(this,j):(R.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},r.actor&&r.actor.send("loadTile",R,$.bind(this),void 0,!0))},!0);r.request={cancel:B}}function $(B,j){return delete r.request,r.aborted?s(null):B&&B.status!==404?s(B):(j&&j.resourceTiming&&(r.resourceTiming=j.resourceTiming),this.map._refreshExpiredTiles&&j&&r.setExpiryData(j),r.loadVectorData(j,this.map.painter),i.aE(this.dispatcher),s(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,s){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ga extends i.E{constructor(r,s,p,_){super(),this.id=r,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},s),i.l(this,i.ay(s,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=ar(this._options,this.map._requestManager,null,null,(s,p)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new i.y(s)):p&&(i.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(_=>_.id)),p.bounds&&(this.tileBounds=new fr(p.bounds,this.minzoom,this.maxzoom)),Lt(p.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),r&&r(s)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,s){const p=i.q.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=i.o(this.map._requestManager.transformRequest(_,i.R.Tile),(x,S,I,R)=>(delete r.request,r.aborted?(r.state="unloaded",s(null)):x?(r.state="errored",s(x)):S?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:R}),r.setTexture(S,this.map.painter),r.state="loaded",i.aE(this.dispatcher),void s(null)):s(null)))}abortTile(r,s){r.request&&(r.request.cancel(),delete r.request),s&&s()}unloadTile(r,s){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),s&&s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Li extends Ga{constructor(r,s,p,_){super(r,s,p,_),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},s)}triggerRepaint(r){const s=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);s&&s.enabled&&p&&s._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,s){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),_=this.map._requestManager.transformRequest(p,i.R.Tile);r.requestParams=_,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(x,S,I,R)=>{if(delete r.request,r.aborted)return r.state="unloaded",s(null);if(x)return x.code===20?void 0:(r.state="errored",s(x));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:R}),r.state="empty",s(null)})}unloadTile(r,s){const p=r.texture;p&&p instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,s,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(s,p,(_,x)=>{if(_)return r.state="errored",this.fire(new i.y(_)),void this.triggerRepaint(r);x&&(r.setTexture(x,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const s=this.rasterLayers.find(({id:x})=>x===r),p=s&&s.fields,_=p&&p.bands&&p.bands;return _?_[0]:0}getTextureDescriptor(r,s,p){if(!r)return;const _=s.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!_)return;let x=null;s instanceof i.aH?x=s.paint.get("raster-array-band"):s instanceof i.aI&&(x=s.paint.get("raster-particle-array-band"));const S=x||this.getInitialBand(_);if(S!=null)if(r.textureDescriptor){if(!r.updateNeeded(_,S)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,_,S)}}const ki={vector:bi,raster:Ga,"raster-dem":class extends Ga{constructor(f,r,s,p){super(f,r,s,p),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const s=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(_,x){_&&(f.state="errored",r(_)),x&&(f.dem=x,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=i.o(this.map._requestManager.transformRequest(s,i.R.Tile),(function(_,x,S,I){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(_)f.state="errored",r(_);else if(x){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:S,expires:I});const R=ImageBitmap&&x instanceof ImageBitmap&&i.t(),$=1-(x.width-i.aF(x.width))/2;$<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const B=R?x:i.q.getImageData(x,$),j={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:B,encoding:this.encoding,padding:$};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",j,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,s=Math.pow(2,r.z),p=(r.x-1+s)%s,_=r.x===0?f.wrap-1:f.wrap,x=(r.x+1+s)%s,S=r.x+1===s?f.wrap+1:f.wrap,I={};return I[new i.aG(f.overscaledZ,_,r.z,p,r.y).key]={backfilled:!1},I[new i.aG(f.overscaledZ,S,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(I[new i.aG(f.overscaledZ,_,r.z,p,r.y-1).key]={backfilled:!1},I[new i.aG(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},I[new i.aG(f.overscaledZ,S,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<s&&(I[new i.aG(f.overscaledZ,_,r.z,p,r.y+1).key]={backfilled:!1},I[new i.aG(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},I[new i.aG(f.overscaledZ,S,r.z,x,r.y+1).key]={backfilled:!1}),I}},"raster-array":Li,geojson:class extends i.E{constructor(f,r,s,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(p),this._data=r.data,this._options=i.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const _=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*_,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*_,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.ag,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*_,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const s of this._data.features)r.set(s.id,s);for(const s of f.features)r.set(s.id,s);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,s,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:s},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const r=i.l({append:f},this.workerOptions);r.scope=this.scope;const s=this._data;typeof s=="string"?(r.request=this.map._requestManager.transformRequest(i.q.resolveURL(s),i.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,_)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new i.y(p));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new i.z("data",x)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const f=i.aC(this.id,this.scope);this.map.style.clearSource(f),this._updateWorkerData()}loadTile(f,r){const s=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,_=p?{image:p.image.clone()}:null,x=this._partialReload,S={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:_,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:x};f.request=this.actor.send(s,S,(I,R)=>x&&!R?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):I?r(I):(f.loadVectorData(R,this.map.painter,s==="reloadTile"),r(null))),void 0,s==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(f,r,s,p){super(f,r,s,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aK(this.urls,(r,s)=>{this._loaded=!0,r?this.fire(new i.y(r)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(f,r,s,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const s=this._options.models[r],p=i.aM(this.map._requestManager.transformRequest(s.uri,i.R.Model).url).then(_=>{if(!_)return;const x=i.aN(_),S=new i.aO(r,s.position,s.orientation,x);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(_=>{this.fire(new i.y(new Error(`Could not load model ${r} from ${s.uri}: ${_.message}`)))});f.push(p)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new i.y(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(f,r,s,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest();const f=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(f))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(f){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map.getWorldview();this._tileJSONRequest=ar(this._options,this.map._requestManager,r,s,(p,_)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new i.y(p))):_&&(i.l(this,_),_.bounds&&(this.tileBounds=new fr(_.bounds,this.minzoom,this.maxzoom)),Lt(_.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const s=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(s,i.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const x=Object.values(f.buckets);for(const S of x)S.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,_.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,_.bind(this),void 0,!0);function _(x,S){return f.aborted?r(null):x&&x.status!==404?r(x):(this.map._refreshExpiredTiles&&S&&f.setExpiryData(S),f.loadModelData(S,this.map.painter),f.state="loaded",void r(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(f,r,s,p){super(f,r,s,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(x=>typeof x!="number"))||this.fire(new i.y(new i.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends i.E{constructor(f,r,s,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new fr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:s,z:p}=f.canonical;return this._implementation.hasTile({x:r,y:s,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:s,y:p,z:_}=f.tileID.canonical,x=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:s,y:p,z:_},{signal:x.signal})).then((function(S){return delete f.request,f.aborted?(f.state="unloaded",r(null)):S===void 0?(f.state="errored",r(null)):S===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(I){return I instanceof ImageData||I instanceof HTMLCanvasElement||I instanceof ImageBitmap||I instanceof HTMLImageElement}(S)?(this.loadTileData(f,S),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.code!==20&&(f.state="errored",r(S))}),f.request.cancel=()=>x.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof i.T?(f.destroy(!0),f.texture&&f.texture instanceof i.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:s,y:p,z:_}=f.tileID.canonical;this._implementation.unloadTile({x:s,y:p,z:_})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=i.aC(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},So=function(f,r,s,p){const _=new ki[r.type](f,r,s,p);if(_.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${_.id}`);return i.aP(["load","abort","unload","serialize","prepare"],_),_};function Nu(f,r,s=""){return`${s}:${r.id||""}:${r.layer.id}:${function(p){if("layerId"in p)return`layer:${p.layerId}`;{const{featuresetId:_,importId:x}=p;return`featureset:${_}${x?`:import:${x}`:""}`}}(f.target)}`}function bs(f,r,s,p=""){if(f.uniqueFeatureID){const _=Nu(f,r,p);if(s.has(_))return!0;s.add(_)}return!1}function Vu(f,r,s,p,_=!1){const x=r.sourceCache.transform,S=r.sourceCache.tilesIn(f,r.has3DLayers,_);S.sort(bp);const I=[];for(const R of S){const $=R.tile.queryRenderedFeatures(r,R,s,p,x,_);Object.keys($).length&&I.push({wrappedTileID:R.tile.tileID.wrapped().key,queryResults:$})}return I.length===0?{}:function(R){const $={},B={};for(const j of R){const U=j.queryResults,q=j.wrappedTileID,ce=B[q]=B[q]||{};for(const ie in U){const he=U[ie],de=ce[ie]=ce[ie]||{},ve=$[ie]=$[ie]||[];for(const Me of he)de[Me.featureIndex]||(de[Me.featureIndex]=!0,ve.push(Me))}}return $}(I)}function xp(f,r,s,p,_){const x={},S=p.queryRenderedSymbols(f),I=[];for(const R of Object.keys(S).map(Number))I.push(_[R]);I.sort(bp);for(const R of I){const $=R.featureIndex.lookupSymbolFeatures(S[R.bucketInstanceId],R.bucketIndex,R.sourceLayerIndex,r,s);for(const B in $){const j=x[B]=x[B]||[],U=$[B];U.sort((q,ce)=>{const ie=R.featureSortOrder;if(ie){const he=ie.indexOf(q.featureIndex);return ie.indexOf(ce.featureIndex)-he}return ce.featureIndex-q.featureIndex});for(const q of U)j.push(q)}}return x}function z_(f,r){const s=f.getRenderableIds().map(x=>f.getTileByID(x)),p=[],_={};for(let x=0;x<s.length;x++){const S=s[x],I=S.tileID.canonical.key;_[I]||(_[I]=!0,S.querySourceFeatures(p,r))}return p}function bp(f,r){const s=f.tileID,p=r.tileID;return s.overscaledZ-p.overscaledZ||s.canonical.y-p.canonical.y||s.wrap-p.wrap||s.canonical.x-p.canonical.x}function wp(f,r){const s={};if(!r)return s;for(const p of f){const _=p.layerIds.map(x=>r.getLayer(x)).filter(Boolean);if(_.length!==0){p.layers=_,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(x=>_.filter(S=>S.id===x)[0]));for(const x of _)s[x.fqid]=p}}return s}const Co=32,wa=33,ws=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,s=0,p=0,_=0,x=0,S=0,I=0;for(1&r?_=x=S=Co:s=p=I=Co;(r>>=1)>1;){const $=s+_>>1,B=p+x>>1;1&r?(_=s,x=p,s=S,p=I):(s=_,p=x,_=S,x=I),S=$,I=B}const R=4*f;ws[R+0]=s,ws[R+1]=p,ws[R+2]=_,ws[R+3]=x}const Wa=new Uint16Array(2178),Sa=new Uint8Array(1089),qa=new Uint16Array(1089);function Th(f){return f===0?-.03125:f===32?.03125:0}const Sp={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class Qs{constructor(r,s,p,_,x){this.tileID=r,this.uid=i.aV(),this.uses=0,this.tileSize=s,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,_&&_.style&&(this._lastUpdatedBrightness=_.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(r){const s=r+this.timeAdded;s<i.q.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,s,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=wp(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof i.aX){if(this.hasSymbolBuckets=!0,!p)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof i.aX&&x.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const _ in this.buckets){const x=this.buckets[_],S=s.style.getOwnLayer(_);if(!S)continue;const I=S.queryRadius(x);this.queryPadding=Math.max(this.queryPadding,I)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,s,p){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,wp(r.buckets,s.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const _ in this.buckets){const x=this.buckets[_];x.uploadPending()&&x.upload(r)}const s=r.gl,p=this.imageAtlas;if(p&&!p.uploaded){const _=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new i.T(r,p.image,s.RGBA8,{useMipmap:_}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(r,s,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const _=s.style.getBrightness();(this._lastUpdatedBrightness||_)&&(this._lastUpdatedBrightness&&_&&Math.abs(this._lastUpdatedBrightness-_)<.001||(this.updateBuckets(s,this._lastUpdatedBrightness!==_),this._lastUpdatedBrightness=_))}queryRenderedFeatures(r,s,p,_,x,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const I=function(R,$){const B=i.ab.mat4.fromScaling([],[.5*R.width,.5*-R.height,1]);return i.ab.mat4.translate(B,B,[1,-1,0]),i.ab.mat4.multiply(B,B,R.calculateProjMatrix($.toUnwrapped())),Float32Array.from(B)}(x,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:s,pixelPosMatrix:I,transform:_,availableImages:p,tileTransform:this.tileTransform})}querySourceFeatures(r,s){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),x=s?s.sourceLayer:"",S=_._geojsonTileLayer||_[x];if(!S)return;const I=i.aZ(s&&s.filter),{z:R,x:$,y:B}=this.tileID.canonical,j={z:R,x:$,y:B};for(let U=0;U<S.length;U++){const q=S.feature(U);if(I.needGeometry){const he=i.a_(q,!0);if(!I.filter(new i.a8(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!I.filter(new i.a8(this.tileID.overscaledZ),q))continue;const ce=p.getId(q,x),ie=new i.a$(q,R,$,B,ce);ie.tile=j,r.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const p=i.b0(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(s)if(this.expirationTime<s)_=!0;else{const x=this.expirationTime-s;x?this.expirationTime=p+Math.max(x,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,s){if(!this.latestFeatureIndex||!r.style)return;const p=this.latestFeatureIndex.loadVTLayers(),_=r.style.listImages(),x=r.style.getBrightness();for(const S in this.buckets){if(!r.style.hasLayer(S))continue;const I=this.buckets[S],R=I.layers[0],$=R.sourceLayer||"_geojsonTileLayer",B=p[$],j=r.style.getLayerSourceCache(R);let U={};j&&(U=j._state.getState($,void 0));const q=this.imageAtlas&&this.imageAtlas.patternPositions||{},ce=Object.keys(U).length>0&&!s;ce&&!I.stateDependentLayers.length&&!s||I.update(U,B,_,q,ce?I.stateDependentLayers:I.layers,s,x),(I instanceof i.b1||I instanceof i.b2)&&r._terrain&&r._terrain.enabled&&j&&I.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(j.id,this.tileID);const ie=r&&r.style&&r.style.getOwnLayer(S);ie&&(this.queryPadding=Math.max(this.queryPadding,ie.queryRadius(I)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.q.now()+r}setTexture(r,s){const p=s.context,_=p.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r):(this.texture=new i.T(p,r,_.RGBA8,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(r,s){const p={};for(const _ of s)p[_]=!0;this.dependencies[r]=p}hasDependency(r,s){for(const p of r){const _=this.dependencies[p];if(_){for(const x of s)if(_[x])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const p=i.b3(Sp,this.tileID.canonical,this.tileTransform)[0],_=new i.b4,x=new i.b5;for(let S=0;S<p.length;S++){const{x:I,y:R}=p[S];_.emplaceBack(I,R),x.emplaceBack(S)}x.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(x),this._tileDebugBuffer=r.createVertexBuffer(_,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,_.length,x.length)}_makeTileBoundsBuffers(r,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const p=i.b3(Sp,this.tileID.canonical,this.tileTransform)[0];let _,x;if(this.isRaster){const S=function(I,R){const $=i.aQ(I,R),B=Math.pow(2,I.z);for(let he=0;he<wa;he++)for(let de=0;de<wa;de++){const ve=i.aR((I.x+(de+Th(de))/Co)/B),Me=i.aS((I.y+(he+Th(he))/Co)/B),Te=R.project(ve,Me),Be=he*wa+de;Wa[2*Be+0]=Math.round((Te.x*$.scale-$.x)*i.ag),Wa[2*Be+1]=Math.round((Te.y*$.scale-$.y)*i.ag)}Sa.fill(0),qa.fill(0);for(let he=2045;he>=0;he--){const de=4*he,ve=ws[de+0],Me=ws[de+1],Te=ws[de+2],Be=ws[de+3],Pe=ve+Te>>1,Le=Me+Be>>1,Ae=Pe+Le-Me,Ue=Le+ve-Pe,tt=Me*wa+ve,gt=Be*wa+Te,ct=Le*wa+Pe,St=Math.hypot((Wa[2*tt+0]+Wa[2*gt+0])/2-Wa[2*ct+0],(Wa[2*tt+1]+Wa[2*gt+1])/2-Wa[2*ct+1])>=16;Sa[ct]=Sa[ct]||(St?1:0),he<1022&&(Sa[ct]=Sa[ct]||Sa[(Me+Ue>>1)*wa+(ve+Ae>>1)]||Sa[(Be+Ue>>1)*wa+(Te+Ae>>1)])}const j=new i.aT,U=new i.aU;let q=0;function ce(he,de){const ve=de*wa+he;return qa[ve]===0&&(j.emplaceBack(Wa[2*ve+0],Wa[2*ve+1],he*i.ag/Co,de*i.ag/Co),qa[ve]=++q),qa[ve]-1}function ie(he,de,ve,Me,Te,Be){const Pe=he+ve>>1,Le=de+Me>>1;if(Math.abs(he-Te)+Math.abs(de-Be)>1&&Sa[Le*wa+Pe])ie(Te,Be,he,de,Pe,Le),ie(ve,Me,Te,Be,Pe,Le);else{const Ae=ce(he,de),Ue=ce(ve,Me),tt=ce(Te,Be);U.emplaceBack(Ae,Ue,tt)}}return ie(0,0,Co,Co,Co,0),ie(Co,Co,0,0,0,Co),{vertices:j,indices:U}}(this.tileID.canonical,s);_=S.vertices,x=S.indices}else{_=new i.aT,x=new i.aU;for(const{x:I,y:R}of p)_.emplaceBack(I,R,0,0);const S=i.b8(_.int16,void 0,4);for(let I=0;I<S.length;I+=3)x.emplaceBack(S[I],S[I+1],S[I+2])}this._tileBoundsBuffer=r.createVertexBuffer(_,i.b9.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(x),this._tileBoundsSegments=i.b7.simpleSegment(0,0,_.length,x.length)}_makeGlobeTileDebugBuffers(r,s){const p=s.projection;if(!p||p.name!=="globe"||s.freezeTileCoverage)return;const _=this.tileID.canonical,x=i.ba(_,s),S=i.bb(x),I=i.ae(s.zoom);let R;I>0&&(R=i.ab.mat4.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,_,s,S,R,I),this._makeGlobeTileDebugTextBuffer(r,_,s,S,R,I)}_globePoint(r,s,p,_,x,S,I){let R=i.bc(r,s,p);if(S){const $=1<<p.z,B=i.at(_.center.lng),j=i.aA(_.center.lat),U=(p.x+.5)/$-B;let q=0;U>.5?q=-1:U<-.5&&(q=1);let ce=(r/i.ag+p.x)/$+q,ie=(s/i.ag+p.y)/$;ce=(ce-B)*_._pixelsPerMercatorPixel+B,ie=(ie-j)*_._pixelsPerMercatorPixel+j;const he=[ce*_.worldSize,ie*_.worldSize,0];i.ab.vec3.transformMat4(he,he,S),R=i.bd(R,he,I)}return i.ab.vec3.transformMat4(R,R,x)}_makeGlobeTileDebugBorderBuffer(r,s,p,_,x,S){const I=new i.b4,R=new i.b5,$=new i.be,B=(U,q,ce,ie,he)=>{const de=(ce-U)/(he-1),ve=(ie-q)/(he-1),Me=I.length;for(let Te=0;Te<he;Te++){const Be=U+Te*de,Pe=q+Te*ve;I.emplaceBack(Be,Pe);const Le=this._globePoint(Be,Pe,s,p,_,x,S);$.emplaceBack(Le[0],Le[1],Le[2]),R.emplaceBack(Me+Te)}},j=i.ag;B(0,0,j,0,16),B(j,0,j,j,16),B(j,j,0,j,16),B(0,j,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(R),this._tileDebugBuffer=r.createVertexBuffer(I,i.b6.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer($,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,I.length,R.length)}_makeGlobeTileDebugTextBuffer(r,s,p,_,x,S){const I=i.ag/4,R=new i.b4,$=new i.aU,B=new i.be,j=25;$.reserve(32),R.reserve(j),B.reserve(j);const U=(q,ce)=>j*q+ce;for(let q=0;q<j;q++){const ce=q*I;for(let ie=0;ie<j;ie++){const he=ie*I;R.emplaceBack(he,ce);const de=this._globePoint(he,ce,s,p,_,x,S);B.emplaceBack(de[0],de[1],de[2])}}for(let q=0;q<4;q++)for(let ce=0;ce<4;ce++){const ie=U(q,ce),he=U(q,ce+1),de=U(q+1,ce),ve=U(q+1,ce+1);$.emplaceBack(ie,he,de),$.emplaceBack(de,he,ve)}this._tileDebugTextIndexBuffer=r.createIndexBuffer($),this._tileDebugTextBuffer=r.createVertexBuffer(R,i.b6.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(B,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,j,32)}destroy(r=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class el extends Qs{constructor(r,s,p,_,x){super(r,s,p,_,x),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,s){const p=s.context,_=p.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{premultiply:!1}):this.texture=new i.T(p,r,_.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,s){const p=this._mrt=new i.bg(30),_=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.bi(_,(x,S,I,R)=>{if(x)s(x);else try{const $=p.getHeaderLength(S);if($>r)return void(this.request=this.fetchHeader($,s));p.parseHeader(S),this._isHeaderLoaded=!0;let B=0;for(const j of Object.values(p.layers))B=Math.max(B,j.dataIndex[j.dataIndex.length-1].last_byte);S.byteLength>=B&&(this.entireBuffer=S),s(null,this.entireBuffer||S,I,R)}catch($){s($)}}),this.request}fetchBand(r,s,p){const _=this._mrt;if(!this._isHeaderLoaded||!_)return void p(new Error("Tile header is not ready"));const x=this.actor;if(!x)return void p(new Error("Can't fetch tile band without an actor"));let S;const I=(j,U)=>{S.complete(j,U),j?p(j):(this.updateTextureDescriptor(r,s),p(null,this.textureDescriptor&&this.textureDescriptor.img))},R=(j,U)=>{if(j)return p(j);const q=x.send("decodeRasterArray",{buffer:U,task:S},I,void 0,!0);this._workQueue.push(()=>{q&&q.cancel(),S.cancel()})},$=_.getLayer(r);if(!$)return void p(new Error(`Unknown sourceLayer "${r}"`));if($.hasDataForBand(s))return this.updateTextureDescriptor(r,s),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const B=$.getDataRange([s]);if(S=_.createDecodingTask(B),!S||S.tasks.length)if(this.flushQueues(),this.entireBuffer)R(null,this.entireBuffer.slice(B.firstByte,B.lastByte+1));else{const j=Object.assign({},this.requestParams,{headers:{Range:`bytes=${B.firstByte}-${B.lastByte}`}}),U=i.bi(j,R);this._fetchQueue.push(()=>{U.cancel(),S.cancel()})}else p(null)}updateNeeded(r,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,s){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(s)||!p.hasDataForBand(s))return;const{bytes:_,tileSize:x,buffer:S,offset:I,scale:R}=p.getBandView(s),$=x+2*S,B={data:_,width:$,height:$},j=this.texture;j&&j instanceof i.T&&j.update(B,{premultiply:!1}),this.textureDescriptor={layer:r,band:s,img:B,buffer:S,offset:I,tileSize:x,format:p.pixelFormat,mix:[R,256*R,65536*R,16777216*R]}}}class L_{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,p){const _=r.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const x={value:s,timeout:void 0};if(p!==void 0&&(x.timeout=setTimeout(()=>{this.remove(r,x)},p)),this.data[_].push(x),this.order.push(_),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const p=r.wrapped().key,_=s===void 0?0:this.data[p].indexOf(s),x=this.data[p][_];return this.data[p].splice(_,1),x.timeout&&clearTimeout(x.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const p in this.data)for(const _ of this.data[p])r(_.value)||s.push(_);for(const p of s)this.remove(p.value.tileID,p)}}class Cp{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,p){const _=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][_]=this.stateChanges[r][_]||{},i.l(this.stateChanges[r][_],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const x in this.state[r])x!==_&&(this.deletedStates[r][x]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][_]===null){this.deletedStates[r][_]={};for(const x in this.state[r][_])p[x]||(this.deletedStates[r][_][x]=null)}else for(const x in p)this.deletedStates[r]&&this.deletedStates[r][_]&&this.deletedStates[r][_][x]===null&&delete this.deletedStates[r][_][x]}removeFeatureState(r,s,p){if(this.deletedStates[r]===null)return;const _=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&s!==void 0)this.deletedStates[r][_]!==null&&(this.deletedStates[r][_]=this.deletedStates[r][_]||{},this.deletedStates[r][_][p]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][_])for(p in this.deletedStates[r][_]={},this.stateChanges[r][_])this.deletedStates[r][_][p]=null;else this.deletedStates[r][_]=null;else this.deletedStates[r]=null}getState(r,s){const p=this.state[r]||{},_=this.stateChanges[r]||{},x=this.deletedStates[r];if(x===null)return{};if(s!==void 0){const I=String(s),R=i.l({},p[I],_[I]);if(x){const $=x[s];if($===null)return{};for(const B in $)delete R[B]}return R}const S=i.l({},p,_);if(x)for(const I in x)delete S[I];return S}initializeTileState(r,s){r.refreshFeatureState(s)}coalesceChanges(r,s){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const x={};for(const S in this.stateChanges[_])this.state[_][S]||(this.state[_][S]={}),i.l(this.state[_][S],this.stateChanges[_][S]),x[S]=this.state[_][S];p[_]=x}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const x={};if(this.deletedStates[_]===null)for(const S in this.state[_])x[S]={},this.state[_][S]={};else for(const S in this.deletedStates[_]){if(this.deletedStates[_][S]===null)this.state[_][S]={};else if(this.state[_][S])for(const I of Object.keys(this.deletedStates[_][S]))delete this.state[_][S][I];x[S]=this.state[_][S]}p[_]=p[_]||{},i.l(p[_],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in r)r[_].refreshFeatureState(s)}}class da extends i.E{constructor(r,s,p){super(),this.id=r,this._onlySymbols=p,s.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new L_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Cp,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,s){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const p=this._tiles[s];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(r=>r.tileID).sort(mr).map(r=>r.key)}getRenderableIds(r,s){const p=[];for(const _ in this._tiles)this._isIdRenderable(+_,r,s)&&p.push(this._tiles[_]);return r?p.sort((_,x)=>{const S=_.tileID,I=x.tileID,R=new i.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),$=new i.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-I.overscaledZ||$.y-R.y||$.x-R.x}).map(_=>_.tileID.key):p.map(_=>_.tileID).sort(mr).map(_=>_.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,s){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=s),this._loadTile(p,this._tileLoaded.bind(this,p,r,s)))}_tileLoaded(r,s,p,_){if(_)if(r.state="errored",_.status!==404)this._source.fire(new i.y(_,{tile:r}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const s=this.getRenderableIds();for(let _=0;_<s.length;_++){const x=s[_];if(r.neighboringTiles&&r.neighboringTiles[x]){const S=this.getTileByID(x);p(r,S),p(S,r)}}function p(_,x){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let S=x.tileID.canonical.x-_.tileID.canonical.x;const I=x.tileID.canonical.y-_.tileID.canonical.y,R=Math.pow(2,_.tileID.canonical.z),$=x.tileID.key;S===0&&I===0||Math.abs(I)>1||(Math.abs(S)>1&&(Math.abs(S+R)===1?S+=R:Math.abs(S-R)===1&&(S-=R)),x.dem&&_.dem&&(_.dem.backfillBorder(x.dem,S,I),_.neighboringTiles&&_.neighboringTiles[$]&&(_.neighboringTiles[$].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,p,_){for(const x in this._tiles){let S=this._tiles[x];if(_[x]||!S.hasData()||S.tileID.overscaledZ<=s||S.tileID.overscaledZ>p)continue;let I=S.tileID;for(;S&&S.tileID.overscaledZ>s+1;){const $=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[$.key],S&&S.hasData()&&(I=$)}let R=I;for(;R.overscaledZ>s;)if(R=R.scaledTo(R.overscaledZ-1),r[R.key]){_[I.key]=I;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=s?p:null}for(let p=r.overscaledZ-1;p>=s;p--){const _=r.scaledTo(p),x=this._getLoadedTile(_);if(x)return x}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,s){s=s||this._source.tileSize;const p=Math.ceil(r.width/s)+1,_=Math.ceil(r.height/s)+1,x=Math.floor(p*_*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,x):x,I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(I)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const p={};for(const _ in this._tiles){const x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+s),p[x.tileID.key]=x}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(r,s,p,_){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const x=this._source.type==="batched-model";let S,I=this._source.maxzoom;const R=this.map&&this.map.painter?this.map.painter._terrain:null;if(R&&R.sourceCache===this&&R.attenuationRange()){const j=R.attenuationRange()[0],U=Math.floor(j)-Math.log2(R.getDemUpscale());I>U&&(I=U)}if(this.used||this.usedForTerrain){if(this._source.tileID)S=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new i.aG(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y));else if(this.tileCoverLift!==0){const j=r.clone();j.tileCoverLift=this.tileCoverLift,S=j.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.minzoom<=1&&r.projection.name==="globe"&&(S.push(new i.aG(1,0,1,0,0)),S.push(new i.aG(1,0,1,1,0)),S.push(new i.aG(1,0,1,0,1)),S.push(new i.aG(1,0,1,1,1)))}else if(S=r.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.hasTile){const j=this._source.hasTile.bind(this._source);S=S.filter(U=>j(U))}}else S=[];if(S.length>0&&this.castsShadows&&_&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Tp(this._source.type)){const j=r.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),U=Math.min(j,this._source.maxzoom);if(x){const q=r.extendTileCover(S,U);for(const ce of q)S.push(ce)}else{const q=r.extendTileCover(S,U,_);for(const ce of q)this._shadowCasterTiles[ce.key]=!0,S.push(ce)}}const $=this._updateRetainedTiles(S);if(Tp(this._source.type)&&S.length!==0){const j={},U={},q=Object.keys($);for(const ie of q){const he=$[ie],de=this._tiles[ie];if(!de||de.fadeEndTime&&de.fadeEndTime<=i.q.now())continue;const ve=this.findLoadedParent(he,Math.max(he.overscaledZ-da.maxOverzooming,this._source.minzoom));ve&&(this._addTile(ve.tileID),j[ve.tileID.key]=ve.tileID),U[ie]=he}const ce=S[S.length-1].overscaledZ;for(const ie in this._tiles){const he=this._tiles[ie];if($[ie]||!he.hasData())continue;let de=he.tileID;for(;de.overscaledZ>ce;){de=de.scaledTo(de.overscaledZ-1);const ve=this._tiles[de.key];if(ve&&ve.hasData()&&U[de.key]){$[ie]=he.tileID;break}}}for(const ie in j)$[ie]||(this._coveredTiles[ie]=!0,$[ie]=j[ie])}for(const j in $)this._tiles[j].clearFadeHold();const B=i.bk(this._tiles,$);for(const j of B){const U=this._tiles[j];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(+j)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const s={};if(r.length===0)return s;const p={},_=r.reduce(($,B)=>Math.min($,B.overscaledZ),1/0),x=r[0].overscaledZ,S=Math.max(x-da.maxOverzooming,this._source.minzoom),I=Math.max(x+da.maxUnderzooming,this._source.minzoom),R={};for(const $ of r){const B=this._addTile($);s[$.key]=$,B.hasData()||_<this._source.maxzoom&&(R[$.key]=$)}this._retainLoadedChildren(R,_,I,s);for(const $ of r){let B=this._tiles[$.key];if(B.hasData())continue;if($.canonical.z>=this._source.maxzoom){const U=$.children(this._source.maxzoom)[0],q=this.getTile(U);if(q&&q.hasData()){s[U.key]=U;continue}}else{const U=$.children(this._source.maxzoom);if(s[U[0].key]&&s[U[1].key]&&s[U[2].key]&&s[U[3].key])continue}let j=B.wasRequested();for(let U=$.overscaledZ-1;U>=S;--U){const q=$.scaledTo(U);if(p[q.key]||(p[q.key]=!0,B=this.getTile(q),!B&&j&&(B=this._addTile(q)),B&&(s[q.key]=q,j=B.wasRequested(),B.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let p,_=this._tiles[r].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}s.push(_.key);const x=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(x),p)break;_=x}for(const x of s)this._loadedParentTiles[x]=p}}_addTile(r){let s=this._tiles[r.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const p=!!s;if(!p){const _=this.map?this.map.painter:null,x=this._source.tileSize*r.overscaleFactor();s=this._source.type==="raster-array"?new el(r,x,this.transform.tileZoom,_,this._isRaster):new Qs(r,x,this.transform.tileZoom,_,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))}return s?(s.uses++,this._tiles[r.key]=s,p||this._source.fire(new i.z("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=s.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,s,p){const _=[],x=this.transform;if(!x)return _;const S=x.projection.name==="globe",I=i.at(x.center.lng);for(const R in this._tiles){const $=this._tiles[R];if(p&&$.clearQueryDebugViz(),$.holdingForFade())continue;let B;if(S){const j=$.tileID.canonical;if(j.z===0){const U=[Math.abs(i.aw(I,...Pn(j,-1))-I),Math.abs(i.aw(I,...Pn(j,1))-I)];B=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(i.aw(I,...Pn(j,-1))-I),Math.abs(i.aw(I,...Pn(j,0))-I),Math.abs(i.aw(I,...Pn(j,1))-I)];B=[U.indexOf(Math.min(...U))-1]}}else B=[0];for(const j of B){const U=r.containsTile($,x,s,j);U&&_.push(U)}}return _}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,s){const p=this.getRenderableIds(r,s).map(x=>this._tiles[x].tileID),_=this.transform.projection.name==="globe";for(const x of p)x.projMatrix=this.transform.calculateProjMatrix(x.toUnwrapped()),x.expandedProjMatrix=_?this.transform.calculateProjMatrix(x.toUnwrapped(),!1,!0):x.projMatrix;return p}sortCoordinatesByDistance(r){const s=r.slice(),p=this.transform._camera.position,_=this.transform._camera.forward(),x={};for(const S of s){const I=1/(1<<S.canonical.z);x[S.key]=((S.canonical.x+.5)*I+S.wrap-p[0])*_[0]+((S.canonical.y+.5)*I-p[1])*_[1]-p[2]*_[2]}return s.sort((S,I)=>x[S.key]-x[I.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(Tp(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(r,s,p){this._state.updateState(r=r||"_geojsonTileLayer",s,p)}removeFeatureState(r,s,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,p)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,p){const _=this._tiles[r];_&&_.setDependencies(s,p)}reloadTilesForDependencies(r,s){for(const p in this._tiles)this._tiles[p].hasDependency(r,s)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,s))}_preloadTiles(r,s){if(!this._sourceLoaded){const R=()=>{this._sourceLoaded&&(this._source.off("data",R),this._preloadTiles(r,s))};return void this._source.on("data",R)}const p=new Map,_=Array.isArray(r)?r:[r],x=this.map.painter.terrain,S=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const R of _){const $=R.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const B of $)p.set(B.key,B);this.usedForTerrain&&R.updateElevation(!1)}const I=Array.from(p.values());i.bl(I,(R,$)=>{const B=new Qs(R,this._source.tileSize*R.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(B,j=>{this._source.type==="raster-dem"&&B.dem&&this._backfillDEM(B),$(j,B)})},s)}}function mr(f,r){const s=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||p-s||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function Tp(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Pn(f,r){const s=1<<f.z;return[f.x/s+r,(f.x+1)/s+r]}da.maxOverzooming=10,da.maxUnderzooming=3;class $_{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,s=!1;for(const p in this.style._mergedLayers){const _=this.style._mergedLayers[p];if(_.type==="fill-extrusion")this.layers.push({layer:_,visible:r,visibilityChanged:s});else if(_.type==="model"){const x=this.style.getLayerSource(_);x&&x.type==="batched-model"&&this.layers.push({layer:_,visible:r,visibilityChanged:s})}}}onNewFrame(r){this.layersGotHidden=!1;for(const s of this.layers){const p=s.layer;let _=!1;p.type==="fill-extrusion"?_=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(_=!p.isHidden(r)&&p.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!_&&s.visible,s.visible=_}}updateZOffset(r,s){this.currentBuildingBuckets=[];for(const _ of this.layers){const x=_.layer,S=this.style.getLayerSourceCache(x);let I=1;x.type==="fill-extrusion"&&(I=_.visible?x.paint.get("fill-extrusion-vertical-scale"):0);let R=S?S.getTile(s):null;if(!R&&S&&s.canonical.z>S.getSource().minzoom){let $=s.scaledTo(Math.min(S.getSource().maxzoom,s.overscaledZ-1));for(;$.overscaledZ>=S.getSource().minzoom&&(R=S.getTile($),!R&&$.overscaledZ!==0);)$=$.scaledTo($.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:R?R.getBucket(x):null,tileID:R?R.tileID:s,verticalScale:I})}r.hasAnyZOffset=!1;let p=!1;for(let _=0;_<r.symbolInstances.length;_++){const x=r.symbolInstances.get(_),S=x.zOffset,I=this._getHeightAtTileOffset(s,x.tileAnchorX,x.tileAnchorY);x.zOffset=I!==Number.NEGATIVE_INFINITY?I:S,p||S===x.zOffset||(p=!0),r.hasAnyZOffset||x.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,s,p,_){let x=s,S=p;if(r.canonical.z!==_.canonical.z){const I=_.canonical,R=1/(1<<r.canonical.z-I.z);x=(s+r.canonical.x*i.ag)*R-I.x*i.ag|0,S=(p+r.canonical.y*i.ag)*R-I.y*i.ag|0}return{tileX:x,tileY:S}}_getHeightAtTileOffset(r,s,p){let _,x;for(let S=0;S<this.layers.length;++S){if(this.layers[S].layer.type!=="fill-extrusion")continue;const{bucket:I,tileID:R,verticalScale:$}=this.currentBuildingBuckets[S];if(!I)continue;const{tileX:B,tileY:j}=this._mapCoordToOverlappingTile(r,s,p,R),U=I.getHeightAtTileCoord(B,j);U&&U.height!==void 0&&(U.hidden?_=U.height:x=Math.max(U.height*$,x||0))}if(x!==void 0)return x;for(let S=0;S<this.layers.length;++S){const I=this.layers[S];if(I.layer.type!=="model"||!I.visible)continue;const{bucket:R,tileID:$}=this.currentBuildingBuckets[S];if(!R)continue;const{tileX:B,tileY:j}=this._mapCoordToOverlappingTile(r,s,p,$),U=R.getHeightAtTileCoord(B,j);if(U&&!U.hidden)return U.height===void 0&&_!==void 0?Math.min(U.maxHeight,_)*U.verticalScale:U.height?U.height*U.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Eh(f,r){const s={};for(const p in f)p!=="ref"&&(s[p]=f[p]);return i.bm.forEach(p=>{p in r&&(s[p]=r[p])}),s}function Mh(f){f=f.slice();const r=Object.create(null);for(let s=0;s<f.length;s++)r[f[s].id]=f[s];for(let s=0;s<f.length;s++)"ref"in f[s]&&(f[s]=Eh(f[s],r[f[s].ref]));return f}const qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Ih(f,r,s){s.push({command:qn.addSource,args:[f,r[f]]})}function Bl(f,r,s){r.push({command:qn.removeSource,args:[f]}),s[f]=!0}function pn(f,r,s,p){Bl(f,s,p),Ih(f,r,s)}function wr(f,r,s){let p;for(p in f[s])if(f[s].hasOwnProperty(p)&&p!=="data"&&!i.bn(f[s][p],r[s][p]))return!1;for(p in r[s])if(r[s].hasOwnProperty(p)&&p!=="data"&&!i.bn(f[s][p],r[s][p]))return!1;return!0}function ir(f,r,s,p,_,x){let S;for(S in r=r||{},f=f||{})f.hasOwnProperty(S)&&(i.bn(f[S],r[S])||s.push({command:x,args:[p,S,r[S],_]}));for(S in r)r.hasOwnProperty(S)&&!f.hasOwnProperty(S)&&(i.bn(f[S],r[S])||s.push({command:x,args:[p,S,r[S],_]}))}function uo(f){return f.id}function Ss(f,r){return f[r.id]=r,f}class dr{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aw(r,0,1);let s=1,p=this._distances[s];const _=r*this.paddedLength+this.padding;for(;p<_&&s<this._distances.length;)p=this._distances[++s];const x=s-1,S=this._distances[x],I=p-S,R=I>0?(_-S)/I:0;return this.points[x].mult(1-R).add(this.points[s].mult(R))}}class ju{constructor(r,s,p){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(s/p);for(let S=0;S<this.xCellCount*this.yCellCount;S++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,p,_,x){this._forEachCell(s,p,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(r,s,p,_){this._forEachCell(s-_,p-_,s+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(p),this.circles.push(_)}_insertBoxCell(r,s,p,_,x,S){this.boxCells[x].push(S)}_insertCircleCell(r,s,p,_,x,S){this.circleCells[x].push(S)}_query(r,s,p,_,x,S){if(p<0||r>this.width||_<0||s>this.height)return!x&&[];const I=[];if(r<=0&&s<=0&&this.width<=p&&this.height<=_){if(x)return!0;for(let R=0;R<this.boxKeys.length;R++)I.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const $=this.circles[3*R],B=this.circles[3*R+1],j=this.circles[3*R+2];I.push({key:this.circleKeys[R],x1:$-j,y1:B-j,x2:$+j,y2:B+j})}return S?I.filter(S):I}return this._forEachCell(r,s,p,_,this._queryCell,I,{hitTest:x,seenUids:{box:{},circle:{}}},S),x?I.length>0:I}_queryCircle(r,s,p,_,x){const S=r-p,I=r+p,R=s-p,$=s+p;if(I<0||S>this.width||$<0||R>this.height)return!_&&[];const B=[];return this._forEachCell(S,R,I,$,this._queryCellCircle,B,{hitTest:_,circle:{x:r,y:s,radius:p},seenUids:{box:{},circle:{}}},x),_?B.length>0:B}query(r,s,p,_,x){return this._query(r,s,p,_,!1,x)}hitTest(r,s,p,_,x){return this._query(r,s,p,_,!0,x)}hitTestCircle(r,s,p,_){return this._queryCircle(r,s,p,!0,_)}_queryCell(r,s,p,_,x,S,I,R){const $=I.seenUids,B=this.boxCells[x];if(B!==null){const U=this.bboxes;for(const q of B)if(!$.box[q]){$.box[q]=!0;const ce=4*q;if(r<=U[ce+2]&&s<=U[ce+3]&&p>=U[ce+0]&&_>=U[ce+1]&&(!R||R(this.boxKeys[q]))){if(I.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[q],x1:U[ce],y1:U[ce+1],x2:U[ce+2],y2:U[ce+3]})}}}const j=this.circleCells[x];if(j!==null){const U=this.circles;for(const q of j)if(!$.circle[q]){$.circle[q]=!0;const ce=3*q;if(this._circleAndRectCollide(U[ce],U[ce+1],U[ce+2],r,s,p,_)&&(!R||R(this.circleKeys[q]))){if(I.hitTest)return S.push(!0),!0;{const ie=U[ce],he=U[ce+1],de=U[ce+2];S.push({key:this.circleKeys[q],x1:ie-de,y1:he-de,x2:ie+de,y2:he+de})}}}}}_queryCellCircle(r,s,p,_,x,S,I,R){const $=I.circle,B=I.seenUids,j=this.boxCells[x];if(j!==null){const q=this.bboxes;for(const ce of j)if(!B.box[ce]){B.box[ce]=!0;const ie=4*ce;if(this._circleAndRectCollide($.x,$.y,$.radius,q[ie+0],q[ie+1],q[ie+2],q[ie+3])&&(!R||R(this.boxKeys[ce])))return S.push(!0),!0}}const U=this.circleCells[x];if(U!==null){const q=this.circles;for(const ce of U)if(!B.circle[ce]){B.circle[ce]=!0;const ie=3*ce;if(this._circlesCollide(q[ie],q[ie+1],q[ie+2],$.x,$.y,$.radius)&&(!R||R(this.circleKeys[ce])))return S.push(!0),!0}}}_forEachCell(r,s,p,_,x,S,I,R){const $=this._convertToXCellCoord(r),B=this._convertToYCellCoord(s),j=this._convertToXCellCoord(p),U=this._convertToYCellCoord(_);for(let q=$;q<=j;q++)for(let ce=B;ce<=U;ce++)if(x.call(this,r,s,p,_,this.xCellCount*ce+q,S,I,R))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,p,_,x,S){const I=_-r,R=x-s,$=p+S;return $*$>I*I+R*R}_circleAndRectCollide(r,s,p,_,x,S,I){const R=(S-_)/2,$=Math.abs(r-(_+R));if($>R+p)return!1;const B=(I-x)/2,j=Math.abs(s-(x+B));if(j>B+p)return!1;if($<=R||j<=B)return!0;const U=$-R,q=j-B;return U*U+q*q<=p*p}}const Za={unknown:0,flipRequired:1,flipNotRequired:2},Uu=Math.tan(85*Math.PI/180);function Ki(f,r,s,p,_,x,S){const I=i.ab.mat4.create();if(s)if(x.name==="globe"){const R=i.bo(_,r);i.ab.mat4.multiply(I,I,R)}else{const R=i.ab.mat2.invert([],S);I[0]=R[0],I[1]=R[1],I[4]=R[2],I[5]=R[3],p||i.ab.mat4.rotateZ(I,I,_.angle)}else i.ab.mat4.multiply(I,_.labelPlaneMatrix,f);return I}function ui(f,r,s,p,_,x,S){const I=Ki(f,r,s,p,_,x,S);return x.name==="globe"&&s||(I[2]=I[6]=I[10]=I[14]=0),I}function Ep(f,r,s,p,_,x,S){if(s){if(x.name==="globe"){const I=Ki(f,r,s,p,_,x,S);return i.ab.mat4.invert(I,I),i.ab.mat4.multiply(I,f,I),I}{const I=i.ab.mat4.clone(f),R=i.ab.mat4.identity([]);return R[0]=S[0],R[1]=S[1],R[4]=S[2],R[5]=S[3],i.ab.mat4.multiply(I,I,R),p||i.ab.mat4.rotateZ(I,I,-_.angle),I}}return _.glCoordMatrix}function Po(f,r,s,p){const _=[f,r,s,1];s?i.ab.vec4.transformMat4(_,_,p):ha(_,_,p);const x=_[3];return _[0]/=x,_[1]/=x,_[2]/=x,_}function Ah(f,r){return Math.min(.5+f/r*.5,1.5)}function Hu(f,r){const s=f[0]/f[3],p=f[1]/f[3];return s>=-r[0]&&s<=r[0]&&p>=-r[1]&&p<=r[1]}function Ph(f,r,s,p,_,x,S,I,R,$){const B=s.transform,j=p?f.textSizeData:f.iconSizeData,U=i.bp(j,s.transform.zoom),q=B.projection.name==="globe",ce=[256/s.width*2+1,256/s.height*2+1],ie=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ie.clear();let he=null;q&&(he=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const de=f.lineVertexArray,ve=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,Me=s.transform.width/s.transform.height;let Te,Be=!1;for(let Pe=0;Pe<ve.length;Pe++){const Le=ve.get(Pe),{numGlyphs:Ae,writingMode:Ue}=Le;if(Ue!==i.bq.vertical||Be||Te===i.bq.horizontal||(Be=!0),Te=Ue,(Le.hidden||Ue===i.bq.vertical)&&!Be){ri(Ae,ie);continue}Be=!1;const tt=new i.P(Le.tileAnchorX,Le.tileAnchorY);let{x:gt,y:ct,z:St}=B.projection.projectTilePoint(tt.x,tt.y,$.canonical);if(R){const[Tt,Bt,Ht]=R(tt);gt+=Tt,ct+=Bt,St+=Ht}const bt=[gt,ct,St,1];if(i.ab.vec4.transformMat4(bt,bt,r),!Hu(bt,ce)){ri(Ae,ie);continue}const st=bt[3],_t=Ah(s.transform.getCameraToCenterDistance(B.projection),st),$t=i.br(j,U,Le),ot=S?$t/_t:$t*_t,Et=Po(gt,ct,St,_);if(Et[3]<=0){ri(Ae,ie);continue}let yt={};const Gt=S?null:R,Ot=Ya(Le,ot,!1,I,r,_,x,f.glyphOffsetArray,de,ie,he,Et,tt,yt,Me,Gt,B.projection,$,S);Be=Ot.useVertical,Gt&&Ot.needsFlipping&&(yt={}),(Ot.notEnoughRoom||Be||Ot.needsFlipping&&Ya(Le,ot,!0,I,r,_,x,f.glyphOffsetArray,de,ie,he,Et,tt,yt,Me,Gt,B.projection,$,S).notEnoughRoom)&&ri(Ae,ie)}p?(f.text.dynamicLayoutVertexBuffer.updateData(ie),he&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(he)):(f.icon.dynamicLayoutVertexBuffer.updateData(ie),he&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(he))}function Gu(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie){const{lineStartIndex:he,glyphStartIndex:de,segment:ve}=I,Me=de+I.numGlyphs,Te=he+I.lineLength,Be=r.getoffsetX(de),Pe=r.getoffsetX(Me-1),Le=Cs(f*Be,s,p,_,x,S,ve,he,Te,R,$,B,j,U,!0,q,ce,ie);if(!Le)return null;const Ae=Cs(f*Pe,s,p,_,x,S,ve,he,Te,R,$,B,j,U,!0,q,ce,ie);return Ae?{first:Le,last:Ae}:null}function ho(f,r,s,p){return f===i.bq.horizontal&&Math.abs(p)>Math.abs(s)?{useVertical:!0}:f===i.bq.vertical?p>0?{needsFlipping:!0}:null:r!==Za.unknown&&function(_,x){return _===0||Math.abs(x/_)>Uu}(s,p)?r===Za.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function Ya(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de,ve){const Me=r/24,Te=f.lineOffsetX*Me,Be=f.lineOffsetY*Me,{lineStartIndex:Pe,glyphStartIndex:Le,numGlyphs:Ae,segment:Ue,writingMode:tt,flipState:gt}=f,ct=Pe+f.lineLength,St=bt=>{if(B){const[ot,Et,yt]=bt.up,Gt=$.length;i.bs(B,Gt+0,ot,Et,yt),i.bs(B,Gt+1,ot,Et,yt),i.bs(B,Gt+2,ot,Et,yt),i.bs(B,Gt+3,ot,Et,yt)}const[st,_t,$t]=bt.point;i.bt($,st,_t,$t,bt.angle)};if(Ae>1){const bt=Gu(Me,I,Te,Be,s,j,U,f,R,x,q,ie,!1,he,de,ve);if(!bt)return{notEnoughRoom:!0};if(p&&!s){let[st,_t,$t]=bt.first.point,[ot,Et,yt]=bt.last.point;[st,_t]=Po(st,_t,$t,S),[ot,Et]=Po(ot,Et,yt,S);const Gt=ho(tt,gt,(ot-st)*ce,Et-_t);if(f.flipState=Gt&&Gt.needsFlipping?Za.flipRequired:Za.flipNotRequired,Gt)return Gt}St(bt.first);for(let st=Le+1;st<Le+Ae-1;st++){const _t=Cs(Me*I.getoffsetX(st),Te,Be,s,j,U,Ue,Pe,ct,R,x,q,ie,!1,!1,he,de,ve);if(!_t)return $.length-=4*(st-Le),{notEnoughRoom:!0};St(_t)}St(bt.last)}else{if(p&&!s){const st=Po(U.x,U.y,0,_),_t=Pe+Ue+1,$t=new i.P(R.getx(_t),R.gety(_t)),ot=Po($t.x,$t.y,0,_),Et=ot[3]>0?ot:Mp(U,$t,st,1,_,void 0,he,de.canonical),yt=ho(tt,gt,(Et[0]-st[0])*ce,Et[1]-st[1]);if(f.flipState=yt&&yt.needsFlipping?Za.flipRequired:Za.flipNotRequired,yt)return yt}const bt=Cs(Me*I.getoffsetX(Le),Te,Be,s,j,U,Ue,Pe,ct,R,x,q,ie,!1,!1,he,de,ve);if(!bt)return{notEnoughRoom:!0};St(bt)}return{}}function io(f,r,s,p,_){const{x,y:S,z:I}=p.projectTilePoint(f.x,f.y,r);if(!_)return Po(x,S,I,s);const[R,$,B]=_(f);return Po(x+R,S+$,I+B,s)}function Mp(f,r,s,p,_,x,S,I){const R=io(f.sub(r)._unit()._add(f),I,_,S,x);return i.ab.vec3.sub(R,s,R),i.ab.vec3.normalize(R,R),i.ab.vec3.scaleAndAdd(R,s,R,p)}function Cs(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de){const ve=p?f-r:f+r;let Me=ve>0?1:-1,Te=0;p&&(Me*=-1,Te=Math.PI),Me<0&&(Te+=Math.PI);let Be=I+S+(Me>0?0:1)|0,Pe=_,Le=_,Ae=0,Ue=0;const tt=Math.abs(ve),gt=[],ct=[];let St=x,bt=St;const st=()=>Mp(bt,St,Le,tt-Ae+1,B,U,ie,he.canonical);for(;Ae+Ue<=tt;){if(Be+=Me,Be<I||Be>=R)return null;if(Le=Pe,bt=St,gt.push(Le),q&&ct.push(bt),St=new i.P($.getx(Be),$.gety(Be)),Pe=j[Be],!Pe){const Bt=io(St,he.canonical,B,ie,U);Pe=Bt[3]>0?j[Be]=Bt:st()}Ae+=Ue,Ue=i.ab.vec3.distance(Le,Pe)}ce&&U&&(j[Be]&&(Pe=st(),Ue=i.ab.vec3.distance(Le,Pe)),j[Be]=Pe);const _t=(tt-Ae)/Ue,$t=St.sub(bt)._mult(_t)._add(bt),ot=i.ab.vec3.sub([],Pe,Le),Et=i.ab.vec3.scaleAndAdd([],Le,ot,_t);let yt=[0,0,1],Gt=ot[0],Ot=ot[1];if(de&&(yt=ie.upVector(he.canonical,$t.x,$t.y),yt[0]!==0||yt[1]!==0||yt[2]!==1)){const Bt=[yt[2],0,-yt[0]],Ht=i.ab.vec3.cross([],yt,Bt);i.ab.vec3.normalize(Bt,Bt),i.ab.vec3.normalize(Ht,Ht),Gt=i.ab.vec3.dot(ot,Bt),Ot=i.ab.vec3.dot(ot,Ht)}if(s){const Bt=i.ab.vec3.cross([],yt,ot);i.ab.vec3.normalize(Bt,Bt),i.ab.vec3.scaleAndAdd(Et,Et,Bt,s*Me)}const Tt=Te+Math.atan2(Ot,Gt);return gt.push(Et),q&&ct.push($t),{point:Et,angle:Tt,path:gt,tilePath:ct,up:yt}}function ri(f,r){const s=r.length,p=s+4*f;r.resize(p),r.float32.fill(-1/0,4*s,4*p)}function ha(f,r,s){const p=r[0],_=r[1];return f[0]=s[0]*p+s[4]*_+s[12],f[1]=s[1]*p+s[5]*_+s[13],f[3]=s[3]*p+s[7]*_+s[15],f}const Ji=100;class wi{constructor(r,s,p=new ju(r.width+200,r.height+200,25),_=new ju(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=_,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ji,this.screenBottomBoundary=r.height+Ji,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=s}placeCollisionBox(r,s,p,_,x,S,I,R){let $=p.projectedAnchorX,B=p.projectedAnchorY,j=p.projectedAnchorZ;const U=p.elevation,q=p.tileID,ce=r.getProjection();if(U&&q){const[Pe,Le,Ae]=ce.upVector(q.canonical,p.tileAnchorX,p.tileAnchorY),Ue=ce.upVectorScale(q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;$+=Pe*U*Ue,B+=Le*U*Ue,j+=Ae*U*Ue}const ie=this.projectAndGetPerspectiveRatio(I,$,B,j,p.tileID,ce.name==="globe"||!!U||this.transform.pitch>0,ce),he=S*ie.perspectiveRatio,de=(p.x1*s+_.x-p.padding)*he+ie.point.x,ve=(p.y1*s+_.y-p.padding)*he+ie.point.y,Me=(p.x2*s+_.x+p.padding)*he+ie.point.x,Te=(p.y2*s+_.y+p.padding)*he+ie.point.y,Be=ie.perspectiveRatio<=.55||ie.occluded;return!this.isInsideGrid(de,ve,Me,Te)||!x&&this.grid.hitTest(de,ve,Me,Te,R)||Be?{box:[],offscreen:!1,occluded:ie.occluded}:{box:[de,ve,Me,Te],offscreen:this.isOffscreen(de,ve,Me,Te),occluded:!1}}placeCollisionCircles(r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie){const he=[],de=this.transform.elevation,ve=r.getProjection(),Me=de?de.getAtTileOffsetFunc(ie,this.transform.center.lat,this.transform.worldSize,ve):null,Te=new i.P(p.tileAnchorX,p.tileAnchorY);let{x:Be,y:Pe,z:Le}=ve.projectTilePoint(Te.x,Te.y,ie.canonical);if(Me){const[$t,ot,Et]=Me(Te);Be+=$t,Pe+=ot,Le+=Et}const Ae=ve.name==="globe",Ue=this.projectAndGetPerspectiveRatio(I,Be,Pe,Le,ie,Ae||!!de||this.transform.pitch>0,ve),{perspectiveRatio:tt}=Ue,gt=(j?S/tt:S*tt)/i.bw,ct=Po(Be,Pe,Le,R),St=Ue.signedDistanceFromCamera>0?Gu(gt,x,p.lineOffsetX*gt,p.lineOffsetY*gt,!1,ct,Te,p,_,R,{},de&&!j?Me:null,j&&!!de,ve,ie,j):null;let bt=!1,st=!1,_t=!0;if(St&&!Ue.occluded){const $t=.5*q*tt+ce,ot=new i.P(-100,-100),Et=new i.P(this.screenRightBoundary,this.screenBottomBoundary),yt=new dr,{first:Gt,last:Ot}=St,Tt=Gt.path.length;let Bt=[];for(let dn=Tt-1;dn>=1;dn--)Bt.push(Gt.path[dn]);for(let dn=1;dn<Ot.path.length;dn++)Bt.push(Ot.path[dn]);const Ht=2.5*$t;$&&(Bt=Bt.map(([dn,Dn,wn],Tn)=>(Me&&!Ae&&(wn=Me(Tn<Tt-1?Gt.tilePath[Tt-1-Tn]:Ot.tilePath[Tn-Tt+2])[2]),Po(dn,Dn,wn,$))),Bt.some(dn=>dn[3]<=0)&&(Bt=[]));let rn=[];if(Bt.length>0){let dn=1/0,Dn=-1/0,wn=1/0,Tn=-1/0;for(const $n of Bt)dn=Math.min(dn,$n[0]),wn=Math.min(wn,$n[1]),Dn=Math.max(Dn,$n[0]),Tn=Math.max(Tn,$n[1]);Dn>=ot.x&&dn<=Et.x&&Tn>=ot.y&&wn<=Et.y&&(rn=[Bt.map($n=>new i.P($n[0],$n[1]))],(dn<ot.x||Dn>Et.x||wn<ot.y||Tn>Et.y)&&(rn=i.bu(rn,ot.x,ot.y,Et.x,Et.y)))}for(const dn of rn){yt.reset(dn,.25*$t);let Dn=0;Dn=yt.length<=.5*$t?1:Math.ceil(yt.paddedLength/Ht)+1;for(let wn=0;wn<Dn;wn++){const Tn=wn/Math.max(Dn-1,1),$n=yt.lerp(Tn),Jn=$n.x+Ji,Tr=$n.y+Ji;he.push(Jn,Tr,$t,0);const ei=Jn-$t,Nr=Tr-$t,Bn=Jn+$t,or=Tr+$t;if(_t=_t&&this.isOffscreen(ei,Nr,Bn,or),st=st||this.isInsideGrid(ei,Nr,Bn,or),!s&&this.grid.hitTestCircle(Jn,Tr,$t,U)&&(bt=!0,!B))return{circles:[],offscreen:!1,collisionDetected:bt,occluded:!1}}}}return{circles:!B&&bt||!st?[]:he,offscreen:_t,collisionDetected:bt,occluded:Ue.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let p=1/0,_=1/0,x=-1/0,S=-1/0;for(const B of r){const j=new i.P(B.x+Ji,B.y+Ji);p=Math.min(p,j.x),_=Math.min(_,j.y),x=Math.max(x,j.x),S=Math.max(S,j.y),s.push(j)}const I=this.grid.query(p,_,x,S).concat(this.ignoredGrid.query(p,_,x,S)),R={},$={};for(const B of I){const j=B.key;if(R[j.bucketInstanceId]===void 0&&(R[j.bucketInstanceId]={}),R[j.bucketInstanceId][j.featureIndex])continue;const U=[new i.P(B.x1,B.y1),new i.P(B.x2,B.y1),new i.P(B.x2,B.y2),new i.P(B.x1,B.y2)];i.bv(s,U)&&(R[j.bucketInstanceId][j.featureIndex]=!0,$[j.bucketInstanceId]===void 0&&($[j.bucketInstanceId]=[]),$[j.bucketInstanceId].push(j.featureIndex))}return $}insertCollisionBox(r,s,p,_,x){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:x},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,p,_,x){const S=s?this.ignoredGrid:this.grid,I={bucketInstanceId:p,featureIndex:_,collisionGroupID:x};for(let R=0;R<r.length;R+=4)S.insertCircle(I,r[R],r[R+1],r[R+2])}projectAndGetPerspectiveRatio(r,s,p,_,x,S,I){const R=[s,p,_,1];let $=!1;_||this.transform.pitch>0?(i.ab.vec4.transformMat4(R,R,r),this.fogState&&x&&I.name!=="globe"&&($=function(U,q,ce,ie,he,de){const ve=de.calculateFogTileMatrix(he),Me=[q,ce,ie];return i.ab.vec3.transformMat4(Me,Me,ve),qe(U,i.ab.vec3.length(Me),de.pitch,de._fov)}(this.fogState,s,p,_,x.toUnwrapped(),this.transform)>.9)):ha(R,R,r);const B=R[3];return{point:new i.P((R[0]/B+1)/2*this.transform.width+Ji,(-R[1]/B+1)/2*this.transform.height+Ji),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/B*.5,1.5),signedDistanceFromCamera:B,occluded:S&&R[2]>B||$}}isOffscreen(r,s,p,_){return p<Ji||r>=this.screenRightBoundary||_<Ji||s>this.screenBottomBoundary}isInsideGrid(r,s,p,_){return p>=0&&r<this.gridRightBoundary&&_>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=i.ab.mat4.identity([]);return i.ab.mat4.translate(r,r,[-100,-100,0]),r}}function Wu(f,r,s){const p=r.createTileMatrix(f,f.worldSize,s.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),f.projMatrix,p)}function Ca(f,r,s){if(r.projection.name===s.projection.name)return f.projMatrix;const p=s.clone();return p.setProjection(r.projection),Wu(p,r.getProjection(),f)}function kl(f,r,s){return r.name===s.projection.name?f.projMatrix:Wu(s,r,f)}class qu{constructor(r,s,p,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Ta{constructor(r,s,p,_,x,S=!1){this.text=new qu(r?r.text:null,s,p,x),this.icon=new qu(r?r.icon:null,s,_,x),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ip{constructor(r,s,p,_=!1){this.text=r,this.icon=s,this.skipFade=p,this.clipped=_}}class Ts{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class kx{constructor(r,s,p,_,x){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=x}}class Ap{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:p=>p.collisionGroupID===s}}return this.collisionGroups[r]}}function Oo(f,r,s,p,_){const{horizontalAlign:x,verticalAlign:S}=i.bD(f),I=-(x-.5)*r,R=-(S-.5)*s,$=i.bC(f,p);return new i.P(I+$[0]*_,R+$[1]*_)}function Pp(f,r,s,p,_){const x=new i.P(f,r);return s&&x._rotate(p?_:-_),x}class Oh{constructor(r,s,p,_,x,S){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new wi(this.transform,x),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ap(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,s,p,_,x=1){const S=p.getBucket(s),I=p.latestFeatureIndex;if(!S||!I||s.fqid!==S.layerIds[0])return;const R=S.layers[0].layout,$=S.layers[0].paint,B=p.collisionBoxArray,j=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),U=p.tileSize/i.ag,q=p.tileID.toUnwrapped();this.transform.setProjection(S.projection);const ce=(ie=p.tileID,he=S.getProjection(),de=this.transform,he.name===this.projection?de.calculateProjMatrix(ie.toUnwrapped()):Wu(de,he,ie));var ie,he,de;const ve=R.get("text-pitch-alignment")==="map",Me=R.get("text-rotation-alignment")==="map";s.compileFilter(s.options);const Te=s.dynamicFilter(),Be=s.dynamicFilterNeedsFeature(),Pe=this.transform.calculatePixelsToTileUnitsMatrix(p),Le=ui(ce,p.tileID.canonical,ve,Me,this.transform,S.getProjection(),Pe);let Ae=null;if(ve){const $t=Ep(ce,p.tileID.canonical,ve,Me,this.transform,S.getProjection(),Pe);Ae=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,$t)}let Ue=null;Te&&p.latestFeatureIndex&&(Ue={unwrappedTileID:q,dynamicFilter:Te,dynamicFilterNeedsFeature:Be}),this.retainedQueryData[S.bucketInstanceId]=new kx(S.bucketInstanceId,I,S.sourceLayerIndex,S.index,p.tileID);const[tt,gt]=S.layers[0].layout.get("text-size-scale-range"),ct=i.aw(x,tt,gt),[St,bt]=R.get("icon-size-scale-range"),st=i.aw(x,St,bt),_t={bucket:S,layout:R,paint:$,posMatrix:ce,textLabelPlaneMatrix:Le,labelToScreenMatrix:Ae,clippingData:Ue,scale:j,textPixelRatio:U,holdingForFade:p.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:i.bp(S.textSizeData,this.transform.zoom,ct),partiallyEvaluatedIconSize:i.bp(S.iconSizeData,this.transform.zoom,st),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(_)for(const $t of S.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:Et,symbolInstanceEnd:yt}=$t;r.push({sortKey:ot,symbolInstanceStart:Et,symbolInstanceEnd:yt,parameters:_t})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:_t})}attemptAnchorPlacement(r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de,ve){const{textOffset0:Me,textOffset1:Te,crossTileID:Be}=U,Pe=[Me,Te],Le=Oo(r,p,_,Pe,x),Ae=this.collisionIndex.placeCollisionBox(ce,x,s,Pp(Le.x,Le.y,S,I,this.transform.angle),j,R,$,B.predicate);if(he){const Ue=ce.getSymbolInstanceIconSize(ve,this.transform.zoom,U.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,Ue,he,Pp(Le.x,Le.y,S,I,this.transform.angle),j,R,$,B.predicate).box.length===0)return}if(Ae.box.length>0){let Ue;return this.prevPlacement&&this.prevPlacement.variableOffsets[Be]&&this.prevPlacement.placements[Be]&&this.prevPlacement.placements[Be].text&&(Ue=this.prevPlacement.variableOffsets[Be].anchor),this.variableOffsets[Be]={textOffset:Pe,width:p,height:_,anchor:r,textScale:x,prevAnchor:Ue},this.markUsedJustification(ce,r,U,ie),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,ie,U),this.placedOrientations[Be]=ie),{shift:Le,placedGlyphBoxes:Ae}}}placeLayerBucketPart(r,s,p,_,x=1){const{bucket:S,layout:I,paint:R,posMatrix:$,textLabelPlaneMatrix:B,labelToScreenMatrix:j,clippingData:U,textPixelRatio:q,holdingForFade:ce,collisionBoxArray:ie,partiallyEvaluatedTextSize:he,partiallyEvaluatedIconSize:de,collisionGroup:ve,latestFeatureIndex:Me}=r.parameters,Te=I.get("text-optional"),Be=I.get("icon-optional"),Pe=I.get("text-allow-overlap"),Le=I.get("icon-allow-overlap"),Ae=I.get("text-rotation-alignment")==="map",Ue=I.get("text-pitch-alignment")==="map",tt=I.get("symbol-z-elevate"),gt=R.get("symbol-z-offset"),ct=I.get("symbol-elevation-reference")==="sea",[St,bt]=I.get("text-size-scale-range"),[st,_t]=I.get("icon-size-scale-range"),$t=i.aw(x,St,bt),ot=i.aw(x,st,_t);this.transform.setProjection(S.projection);let Et=Pe&&(Le||!S.hasIconData()||Be),yt=Le&&(Pe||!S.hasTextData()||Te);const Gt=!gt.isConstant();!S.collisionArrays&&ie&&S.deserializeCollisionBoxes(ie),p&&_&&S.updateCollisionDebugBuffers(this.transform.zoom,ie,$t,ot);const Ot=(Tt,Bt,Ht)=>{const{crossTileID:rn,numVerticalGlyphVertices:dn}=Tt;let Dn=null;if(U&&U.dynamicFilterNeedsFeature||Gt){const zr=this.retainedQueryData[S.bucketInstanceId];Dn=Me.loadFeature({featureIndex:Tt.featureIndex,bucketIndex:zr.bucketIndex,sourceLayerIndex:zr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(U&&!(0,U.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Dn,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new i.P(Tt.tileAnchorX,Tt.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[rn]=new Ip(!1,!1,!1,!0),void s.add(rn);const wn=gt.evaluate(Dn,{});if(s.has(rn))return;if(ce)return void(this.placements[rn]=new Ip(!1,!1,!1));let Tn=!1,$n=!1,Jn=!0,Tr=!1,ei=!1,Nr=null,Bn={box:null,offscreen:null,occluded:null},or={box:null,offscreen:null,occluded:null},vn=null,Xn=null,pr=null,_r=0,Xr=0,Ni=0;Ht.textFeatureIndex?_r=Ht.textFeatureIndex:Tt.useRuntimeCollisionCircles&&(_r=Tt.featureIndex),Ht.verticalTextFeatureIndex&&(Xr=Ht.verticalTextFeatureIndex);const Pi=zr=>{zr.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const Or=this.transform.elevation;zr.elevation=ct?wn:wn+(Or?Or.getAtTileOffset(zr.tileID,zr.tileAnchorX,zr.tileAnchorY):0),zr.elevation+=Tt.zOffset},Oi=Ht.textBox;if(Oi){Pi(Oi);const zr=er=>{let gi=i.bq.horizontal;if(S.allowVerticalPlacement&&!er&&this.prevPlacement){const Vi=this.prevPlacement.placedOrientations[rn];Vi&&(this.placedOrientations[rn]=Vi,gi=Vi,this.markUsedOrientation(S,gi,Tt))}return gi},Or=(er,gi)=>{if(S.allowVerticalPlacement&&dn>0&&Ht.verticalTextBox){for(const Vi of S.writingModes)if(Vi===i.bq.vertical?(Bn=gi(),or=Bn):Bn=er(),Bn&&Bn.box&&Bn.box.length)break}else Bn=er()};if(I.get("text-variable-anchor")){let er=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[rn]){const Dr=this.prevPlacement.variableOffsets[rn];er.indexOf(Dr.anchor)>0&&(er=er.filter(mo=>mo!==Dr.anchor),er.unshift(Dr.anchor))}const gi=(Dr,mo,ma)=>{const Uo=S.getSymbolInstanceTextSize(he,Tt,this.transform.zoom,Bt),Ro=(Dr.x2-Dr.x1)*Uo+2*Dr.padding,ns=(Dr.y2-Dr.y1)*Uo+2*Dr.padding,ga=Tt.hasIconTextFit&&!Le?mo:null;ga&&Pi(ga);let Jo={box:[],offscreen:!1,occluded:!1};const oc=Pe?2*er.length:er.length;for(let rs=0;rs<oc;++rs){const ac=this.attemptAnchorPlacement(er[rs%er.length],Dr,Ro,ns,Uo,Ae,Ue,q,$,ve,rs>=er.length,Tt,Bt,S,ma,ga,he,de);if(ac&&(Jo=ac.placedGlyphBoxes,Jo&&Jo.box&&Jo.box.length)){Tn=!0,Nr=ac.shift;break}}return Jo};Or(()=>gi(Oi,Ht.iconBox,i.bq.horizontal),()=>{const Dr=Ht.verticalTextBox;return Dr&&Pi(Dr),S.allowVerticalPlacement&&!(Bn&&Bn.box&&Bn.box.length)&&dn>0&&Dr?gi(Dr,Ht.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Bn&&(Tn=Bn.box,Jn=Bn.offscreen,Tr=Bn.occluded);const Vi=zr(!(!Bn||!Bn.box));if(!Tn&&this.prevPlacement){const Dr=this.prevPlacement.variableOffsets[rn];Dr&&(this.variableOffsets[rn]=Dr,this.markUsedJustification(S,Dr.anchor,Tt,Vi))}}else{const er=(gi,Vi)=>{const Dr=S.getSymbolInstanceTextSize(he,Tt,this.transform.zoom,Bt,x),mo=this.collisionIndex.placeCollisionBox(S,Dr,gi,new i.P(0,0),Pe,q,$,ve.predicate);return mo&&mo.box&&mo.box.length&&(this.markUsedOrientation(S,Vi,Tt),this.placedOrientations[rn]=Vi),mo};Or(()=>er(Oi,i.bq.horizontal),()=>{const gi=Ht.verticalTextBox;return S.allowVerticalPlacement&&dn>0&&gi?(Pi(gi),er(gi,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),zr(!!(Bn&&Bn.box&&Bn.box.length))}}if(vn=Bn,Tn=vn&&vn.box&&vn.box.length>0,Jn=vn&&vn.offscreen,Tr=vn&&vn.occluded,Tt.useRuntimeCollisionCircles){const zr=S.text.placedSymbolArray.get(Tt.centerJustifiedTextSymbolIndex>=0?Tt.centerJustifiedTextSymbolIndex:Tt.verticalPlacedTextSymbolIndex),Or=i.br(S.textSizeData,he,zr),er=I.get("text-padding");Xn=this.collisionIndex.placeCollisionCircles(S,Pe,zr,S.lineVertexArray,S.glyphOffsetArray,Or,$,B,j,p,Ue,ve.predicate,Tt.collisionCircleDiameter*Or/i.bw,er,this.retainedQueryData[S.bucketInstanceId].tileID),Tn=Pe||Xn.circles.length>0&&!Xn.collisionDetected,Jn=Jn&&Xn.offscreen,Tr=Xn.occluded}if(Ht.iconFeatureIndex&&(Ni=Ht.iconFeatureIndex),Ht.iconBox){const zr=Or=>{Pi(Or);const er=Tt.hasIconTextFit&&Nr?Pp(Nr.x,Nr.y,Ae,Ue,this.transform.angle):new i.P(0,0),gi=S.getSymbolInstanceIconSize(de,this.transform.zoom,Tt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,gi,Or,er,Le,q,$,ve.predicate)};or&&or.box&&or.box.length&&Ht.verticalIconBox?(pr=zr(Ht.verticalIconBox),$n=pr.box.length>0):(pr=zr(Ht.iconBox),$n=pr.box.length>0),Jn=Jn&&pr.offscreen,ei=pr.occluded}const Ko=Te||Tt.numHorizontalGlyphVertices===0&&dn===0,po=Be||Tt.numIconVertices===0;if(Ko||po?po?Ko||($n=$n&&Tn):Tn=$n&&Tn:$n=Tn=$n&&Tn,Tn&&vn&&vn.box&&this.collisionIndex.insertCollisionBox(vn.box,I.get("text-ignore-placement"),S.bucketInstanceId,or&&or.box&&Xr?Xr:_r,ve.ID),$n&&pr&&this.collisionIndex.insertCollisionBox(pr.box,I.get("icon-ignore-placement"),S.bucketInstanceId,Ni,ve.ID),Xn&&(Tn&&this.collisionIndex.insertCollisionCircles(Xn.circles,I.get("text-ignore-placement"),S.bucketInstanceId,_r,ve.ID),p)){const zr=S.bucketInstanceId;let Or=this.collisionCircleArrays[zr];Or===void 0&&(Or=this.collisionCircleArrays[zr]=new Ts);for(let er=0;er<Xn.circles.length;er+=4)Or.circles.push(Xn.circles[er+0]),Or.circles.push(Xn.circles[er+1]),Or.circles.push(Xn.circles[er+2]),Or.circles.push(Xn.collisionDetected?1:0)}const Kr=S.projection.name!=="globe";Et=Et&&(Kr||!Tr),yt=yt&&(Kr||!ei),this.placements[rn]=new Ip(Tn||Et,$n||yt,Jn||S.justReloaded),s.add(rn)};if(tt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(S,this.retainedQueryData[S.bucketInstanceId].tileID),S.updateZOffset()),S.sortFeaturesByY){const Tt=S.getSortedSymbolIndexes(this.transform.angle);for(let Bt=Tt.length-1;Bt>=0;--Bt){const Ht=Tt[Bt];Ot(S.symbolInstances.get(Ht),Ht,S.collisionArrays[Ht])}S.hasAnyZOffset&&i.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const Tt=S.getSortedIndexesByZOffset();for(let Bt=0;Bt<Tt.length;++Bt){const Ht=Tt[Bt];Ot(S.symbolInstances.get(Ht),Ht,S.collisionArrays[Ht])}}else for(let Tt=r.symbolInstanceStart;Tt<r.symbolInstanceEnd;Tt++)Ot(S.symbolInstances.get(Tt),Tt,S.collisionArrays[Tt]);if(p&&S.bucketInstanceId in this.collisionCircleArrays){const Tt=this.collisionCircleArrays[S.bucketInstanceId];i.ab.mat4.invert(Tt.invProjMatrix,$),Tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(r,s,p,_){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:R,crossTileID:$}=p,B=i.bB(s),j=_===i.bq.vertical?R:B==="left"?x:B==="center"?S:B==="right"?I:-1;x>=0&&(r.text.placedSymbolArray.get(x).crossTileID=j>=0&&x!==j?0:$),S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=j>=0&&S!==j?0:$),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=j>=0&&I!==j?0:$),R>=0&&(r.text.placedSymbolArray.get(R).crossTileID=j>=0&&R!==j?0:$)}markUsedOrientation(r,s,p){const _=s===i.bq.horizontal||s===i.bq.horizontalOnly?s:0,x=s===i.bq.vertical?s:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:$}=p,B=r.text.placedSymbolArray;S>=0&&(B.get(S).placedOrientation=_),I>=0&&(B.get(I).placedOrientation=_),R>=0&&(B.get(R).placedOrientation=_),$>=0&&(B.get($).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let p=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const _=s?s.symbolFadeChange(r):1,x=s?s.opacities:{},S=s?s.variableOffsets:{},I=s?s.placedOrientations:{};for(const R in this.placements){const $=this.placements[R],B=x[R];B?(this.opacities[R]=new Ta(B,_,$.text,$.icon,null,$.clipped),p=p||$.text!==B.text.placed||$.icon!==B.icon.placed):(this.opacities[R]=new Ta(null,_,$.text,$.icon,$.skipFade,$.clipped),p=p||$.text||$.icon)}for(const R in x){const $=x[R];if(!this.opacities[R]){const B=new Ta($,_,!1,!1);B.isHidden()||(this.opacities[R]=B,p=p||$.text.placed||$.icon.placed)}}for(const R in S)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=S[R]);for(const R in I)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=I[R]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s,p,_){const x=new Set;for(const S of s){const I=S.getBucket(r);I&&S.latestFeatureIndex&&r.fqid===I.layerIds[0]&&(this.updateBucketOpacities(I,x,S,S.collisionBoxArray,p,_,S.tileID,r.scope),I.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(I,S.tileID),I.updateZOffset()))}}updateBucketOpacities(r,s,p,_,x,S,I,R){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const $=r.layers[0].layout,B=r.layers[0].paint,j=!!r.layers[0].dynamicFilter(),U=new Ta(null,0,!1,!1,!0),q=$.get("text-allow-overlap"),ce=$.get("icon-allow-overlap"),ie=$.get("text-variable-anchor"),he=$.get("text-rotation-alignment")==="map",de=$.get("text-pitch-alignment")==="map",ve=B.get("symbol-z-offset"),Me=$.get("symbol-elevation-reference")==="sea",Te=!ve.isConstant(),Be=new Ta(null,0,q&&(ce||!r.hasIconData()||$.get("icon-optional")),ce&&(q||!r.hasTextData()||$.get("text-optional")),!0);!r.collisionArrays&&_&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(_);const Pe=(Ae,Ue,tt)=>{for(let gt=0;gt<Ue/4;gt++)Ae.opacityVertexArray.emplaceBack(tt)};let Le=0;S&&r.updateReplacement(I,S);for(let Ae=0;Ae<r.symbolInstances.length;Ae++){const Ue=r.symbolInstances.get(Ae),{numHorizontalGlyphVertices:tt,numVerticalGlyphVertices:gt,crossTileID:ct,numIconVertices:St,tileAnchorX:bt,tileAnchorY:st}=Ue;let _t=null;const $t=this.retainedQueryData[r.bucketInstanceId];Te&&Ue&&$t&&(_t=p.latestFeatureIndex.loadFeature({featureIndex:Ue.featureIndex,bucketIndex:$t.bucketIndex,sourceLayerIndex:$t.sourceLayerIndex,layoutVertexArrayOffset:0}));const ot=ve.evaluate(_t,{}),Et=s.has(ct);let yt=this.opacities[ct];Et?yt=U:yt||(yt=Be,this.opacities[ct]=yt),s.add(ct);const Gt=tt>0||gt>0,Ot=St>0,Tt=this.placedOrientations[ct],Bt=Tt===i.bq.vertical,Ht=Tt===i.bq.horizontal||Tt===i.bq.horizontalOnly;!Gt&&!Ot||yt.isHidden()||Le++;let rn=!1;if((Gt||Ot)&&S)for(const dn of r.activeReplacements){if(i.bx(dn,x,i.by.Symbol,R)||dn.min.x>bt||bt>dn.max.x||dn.min.y>st||st>dn.max.y)continue;const Dn=i.bz(bt,st,I.canonical,dn.footprintTileId.canonical);if(rn=i.bA(Dn,dn.footprint),rn)break}if(Gt){const dn=rn?Es:Op(yt.text);Pe(r.text,tt,Bt?Es:dn),Pe(r.text,gt,Ht?Es:dn);const Dn=yt.text.isHidden(),{leftJustifiedTextSymbolIndex:wn,centerJustifiedTextSymbolIndex:Tn,rightJustifiedTextSymbolIndex:$n,verticalPlacedTextSymbolIndex:Jn}=Ue,Tr=r.text.placedSymbolArray,ei=Dn||Bt?1:0;wn>=0&&(Tr.get(wn).hidden=ei),Tn>=0&&(Tr.get(Tn).hidden=ei),$n>=0&&(Tr.get($n).hidden=ei),Jn>=0&&(Tr.get(Jn).hidden=Dn||Ht?1:0);const Nr=this.variableOffsets[ct];Nr&&this.markUsedJustification(r,Nr.anchor,Ue,Tt);const Bn=this.placedOrientations[ct];Bn&&(this.markUsedJustification(r,"left",Ue,Bn),this.markUsedOrientation(r,Bn,Ue))}if(Ot){const dn=rn?Es:Op(yt.icon),{placedIconSymbolIndex:Dn,verticalPlacedIconSymbolIndex:wn}=Ue,Tn=r.icon.placedSymbolArray,$n=yt.icon.isHidden()?1:0;Dn>=0&&(Pe(r.icon,St,Bt?Es:dn),Tn.get(Dn).hidden=$n),wn>=0&&(Pe(r.icon,Ue.numVerticalIconVertices,Ht?Es:dn),Tn.get(wn).hidden=$n)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const dn=r.collisionArrays[Ae];if(dn){let Dn=new i.P(0,0),wn=!0;if(dn.textBox||dn.verticalTextBox){if(ie){const $n=this.variableOffsets[ct];$n?(Dn=Oo($n.anchor,$n.width,$n.height,$n.textOffset,$n.textScale),he&&Dn._rotate(de?this.transform.angle:-this.transform.angle)):wn=!1}j&&(wn=!yt.clipped),dn.textBox&&Zu(r.textCollisionBox.collisionVertexArray,yt.text.placed,!wn||Bt,ot,Me,Dn.x,Dn.y),dn.verticalTextBox&&Zu(r.textCollisionBox.collisionVertexArray,yt.text.placed,!wn||Ht,ot,Me,Dn.x,Dn.y)}const Tn=wn&&!!(!Ht&&dn.verticalIconBox);dn.iconBox&&Zu(r.iconCollisionBox.collisionVertexArray,yt.icon.placed,Tn,ot,Me,Ue.hasIconTextFit?Dn.x:0,Ue.hasIconTextFit?Dn.y:0),dn.verticalIconBox&&Zu(r.iconCollisionBox.collisionVertexArray,yt.icon.placed,!Tn,ot,Me,Ue.hasIconTextFit?Dn.x:0,Ue.hasIconTextFit?Dn.y:0)}}}if(r.fullyClipped=Le===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Ae=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Ae.invProjMatrix,r.placementViewportMatrix=Ae.viewportMatrix,r.collisionCircleArray=Ae.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const p=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Zu(f,r,s,p,_,x,S){f.emplaceBack(r?1:0,s?1:0,x||0,S||0,p,_?1:0),f.emplaceBack(r?1:0,s?1:0,x||0,S||0,p,_?1:0),f.emplaceBack(r?1:0,s?1:0,x||0,S||0,p,_?1:0),f.emplaceBack(r?1:0,s?1:0,x||0,S||0,p,_?1:0)}const Yu=Math.pow(2,25),Nx=Math.pow(2,24),Vx=Math.pow(2,17),Xu=Math.pow(2,16),Ku=Math.pow(2,9),jx=Math.pow(2,8),Oc=Math.pow(2,1);function Op(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,s=Math.floor(127*f.opacity);return s*Yu+r*Nx+s*Vx+r*Xu+s*Ku+r*jx+s*Oc+r}const Es=0;class tl{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,s,p,_,x,S){const I=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(I,_,r[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((R,$)=>R.sortKey-$.sortKey));this._currentPartIndex<I.length;){const R=I[this._currentPartIndex];if(s.placeLayerBucketPart(R,this._seenCrossTileIDs,p,R.symbolInstanceStart===0,S),this._currentPartIndex++,x())return!0}return!1}}class Ux{constructor(r,s,p,_,x,S,I,R,$){this.placement=new Oh(r,x,S,I,R,$),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,s,p,_,x){const S=i.q.now(),I=()=>{const R=i.q.now()-S;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=s[r[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=$)&&(!R.maxzoom||R.maxzoom>$)){const B=R,j=B.layout.get("symbol-z-elevate"),U=B.layout.get("symbol-sort-key").constantOr(1)!==void 0,q=B.layout.get("symbol-z-order"),ce=q==="viewport-y"||q==="auto"&&!(q!=="viewport-y"&&U),ie=B.layout.get("text-allow-overlap")||B.layout.get("icon-allow-overlap")||B.layout.get("text-ignore-placement")||B.layout.get("icon-ignore-placement"),he=ce&&ie,de=this._inProgressLayer=this._inProgressLayer||new tl(B),ve=i.aC(R.source,R.scope);if(de.continuePlacement(j||he?_[ve]:p[ve],this.placement,this._showCollisionBoxes,R,I,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Dp=512/i.ag/2;class Hx{constructor(r,s,p){this.tileID=r,this.bucketInstanceId=p,this.index=new i.bE(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=r.canonical.x*i.ag,x=r.canonical.y*i.ag;for(let S=0;S<s.length;S++){const{key:I,crossTileID:R,tileAnchorX:$,tileAnchorY:B}=s.get(S),j=Math.floor((_+$)*Dp),U=Math.floor((x+B)*Dp);this.index.add(j,U),this.keys.push(I),this.crossTileIDs.push(R)}this.index.finish()}findMatches(r,s,p){const _=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),x=Dp/Math.pow(2,s.canonical.z-this.tileID.canonical.z),S=s.canonical.x*i.ag,I=s.canonical.y*i.ag;for(let R=0;R<r.length;R++){const $=r.get(R);if($.crossTileID)continue;const{key:B,tileAnchorX:j,tileAnchorY:U}=$,q=Math.floor((S+j)*x),ce=Math.floor((I+U)*x),ie=this.index.range(q-_,ce-_,q+_,ce+_);for(const he of ie){const de=this.crossTileIDs[he];if(this.keys[he]===B&&!p.has(de)){p.add(de),$.crossTileID=de;break}}}}}class F_{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Gx{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const p in this.indexes){const _=this.indexes[p],x={};for(const S in _){const I=_[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+s),x[I.tileID.key]=I}this.indexes[p]=x}this.lng=r}addBucket(r,s,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<s.symbolInstances.length;x++)s.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const _=this.usedCrossTileIDs[r.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>r.overscaledZ)for(const I in S){const R=S[I];R.tileID.isChildOf(r)&&R.findMatches(s.symbolInstances,r,_)}else{const I=S[r.scaledTo(Number(x)).key];I&&I.findMatches(s.symbolInstances,r,_)}}for(let x=0;x<s.symbolInstances.length;x++){const S=s.symbolInstances.get(x);S.crossTileID||(S.crossTileID=p.generate(),_.add(S.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Hx(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const p of s.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let s=!1;for(const p in this.indexes){const _=this.indexes[p];for(const x in _)r[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[x]),delete _[x],s=!0)}return s}}class Rp{constructor(){this.layerIndexes={},this.crossTileIDs=new F_,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,p,_){let x=this.layerIndexes[r.fqid];x===void 0&&(x=this.layerIndexes[r.fqid]=new Gx);let S=!1;const I={};_.name!=="globe"&&x.handleWrapJump(p);for(const R of s){const $=R.getBucket(r);$&&r.fqid===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(R.tileID,$,this.crossTileIDs)&&(S=!0),I[$.bucketInstanceId]=!0)}return x.removeStaleBuckets(I)&&(S=!0),S}pruneUnusedLayers(r){const s={};r.forEach(p=>{s[p]=!0});for(const p in this.layerIndexes)s[p]||delete this.layerIndexes[p]}}const Nl=771;class Wn{constructor(r,s,p,_){this.blendFunction=r,this.blendColor=s,this.mask=p,this.blendEquation=_}}Wn.Replace=[1,0,1,0],Wn.disabled=new Wn(Wn.Replace,i.aj.transparent,[!1,!1,!1,!1]),Wn.unblended=new Wn(Wn.Replace,i.aj.transparent,[!0,!0,!0,!0]),Wn.alphaBlended=new Wn([1,Nl,1,Nl],i.aj.transparent,[!0,!0,!0,!0]),Wn.alphaBlendedNonPremultiplied=new Wn([770,Nl,770,Nl],i.aj.transparent,[!0,!0,!0,!0]),Wn.multiply=new Wn([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class Cn{constructor(r,s,p){this.func=r,this.mask=s,this.range=p}}Cn.ReadOnly=!1,Cn.ReadWrite=!0,Cn.disabled=new Cn(519,Cn.ReadOnly,[0,1]);const Dh=7680;class Rn{constructor(r,s,p,_,x,S){this.test=r,this.ref=s,this.mask=p,this.fail=_,this.depthFail=x,this.pass=S}}Rn.disabled=new Rn({func:519,mask:0},0,0,Dh,Dh,Dh);const Dc=1029,Rh=2305;class Ln{constructor(r,s,p){this.enable=r,this.mode=s,this.frontFace=p}}function Rc(f,r){const s=i.bG(f,3);i.ab.mat4.fromQuat(f,r),i.bI(f,3,s)}function Vl(f,r){const s=i.ab.quat.identity([]);return i.ab.quat.rotateZ(s,s,-r),i.ab.quat.rotateX(s,s,-f),s}function zp(f,r){const s=[f[0],f[1],0],p=[r[0],r[1],0];if(i.ab.vec3.length(s)>=1e-15){const S=i.ab.vec3.normalize([],s);i.ab.vec3.scale(p,S,i.ab.vec3.dot(p,S)),r[0]=p[0],r[1]=p[1]}const _=i.ab.vec3.cross([],r,f);if(i.ab.vec3.len(_)<1e-15)return null;const x=Math.atan2(-_[1],_[0]);return Vl(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),x)}Ln.disabled=new Ln(!1,Dc,Rh),Ln.backCCW=new Ln(!0,Dc,Rh),Ln.backCW=new Ln(!0,Dc,2304),Ln.frontCW=new Ln(!0,1028,2304),Ln.frontCCW=new Ln(!0,1028,Rh);class zh{constructor(r,s){this.position=r,this.orientation=s}get position(){return this._position}set position(r){if(r){const s=r instanceof i.aa?r:new i.aa(r[0],r[1],r[2]);this._renderWorldCopies&&(s.x=i.bF(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(r,s){if(this.orientation=null,!this.position)return;const p=this.position,_=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(r)):0,x=i.aa.fromLngLat(r,_),S=[x.x-p.x,x.y-p.y,x.z-p.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=zp(S,s)}setPitchBearing(r,s){this.orientation=Vl(i.ai(r),i.ai(-s))}}class Do{constructor(r,s){this._transform=i.ab.mat4.identity([]),this.orientation=s,this.position=r}get mercatorPosition(){const r=this.position;return new i.aa(r[0],r[1],r[2])}get position(){const r=i.bG(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var s;r&&i.bI(this._transform,3,[(s=r)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.ab.quat.identity([]),r&&Rc(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,s){this._orientation=Vl(r,s),Rc(this._transform,this._orientation)}forward(){const r=i.bG(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.bG(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.bG(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,s){const p=new Float64Array(16);return i.ab.mat4.invert(p,this.getWorldToCamera(r,s)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,s,p){const _=this.position;i.ab.vec3.scale(_,_,-r);const x=new Float64Array(16);return i.ab.mat4.fromScaling(x,[p,p,p]),i.ab.mat4.translate(x,x,_),x[10]*=s,x}getWorldToCamera(r,s){const p=new Float64Array(16),_=new Float64Array(4),x=this.position;return i.ab.quat.conjugate(_,this._orientation),i.ab.vec3.scale(x,x,-r),i.ab.mat4.fromQuat(p,_),i.ab.mat4.translate(p,p,x),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=s,p[9]*=s,p[10]*=s,p[11]*=s,p}getCameraToClipPerspective(r,s,p,_){const x=new Float64Array(16);return i.ab.mat4.perspective(x,r,s,p,_),x}getCameraToClipOrthographic(r,s,p,_,x,S){const I=new Float64Array(16);return i.ab.mat4.ortho(I,r,s,p,_,x,S),I}getDistanceToElevation(r,s=!1){const p=r===0?0:i.bH(r,s?i.aS(this.position[1]):this.position[1]),_=this.forward();return(p-this.position[2])/_[2]}clone(){return new Do([...this.position],[...this.orientation])}}const oo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Yt{constructor(r=0,s=0,p=0,_=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=p,this.right=_}interpolate(r,s,p){return s.top!=null&&r.top!=null&&(this.top=i.af(r.top,s.top,p)),s.bottom!=null&&r.bottom!=null&&(this.bottom=i.af(r.bottom,s.bottom,p)),s.left!=null&&r.left!=null&&(this.left=i.af(r.left,s.left,p)),s.right!=null&&r.right!=null&&(this.right=i.af(r.right,s.right,p)),this}getCenter(r,s){const p=i.aw((this.left+r-this.right)/2,0,r),_=i.aw((this.top+s-this.bottom)/2,0,s);return new i.P(p,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Yt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Lp=(f,r,s)=>(1-s)*f+s*r,Lh=f=>f*f*f*f*f;class Ju{constructor(r,s,p,_,x,S,I){this.tileSize=512,this._renderWorldCopies=x===void 0||x,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=p??0,this._maxPitch=_??60,this.setProjection(S),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yt,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Do,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Ju(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,s=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const p=this.getProjection(),_=!i.bn(s,p);return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const s=r!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const s=-r*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=i.aw(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.ai(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let _=0,x=0;for(let S=0;S<s.length;S++){const I=new i.P(s[S][0]*this.width,p+s[S][1]*(this.height-p)),R=r.pointCoordinate(I);if(!R)continue;const $=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);_+=R[3]*$,x+=$}return x===0?NaN:_/x}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*s,_=this._mercatorZfromZoom(r),x=this._mercatorZfromZoom(this._maxZoom),S=Math.max(_-p,x);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[s.x,s.y,s.z]:[r.x,r.y,r.z];const _=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,p));return i.aw(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let s=!1;if(r.orientation&&!i.ab.quat.exactEquals(r.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];i.ab.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,s=new zh;return s.position=new i.aa(r[0],r[1],r[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(r){if(!i.ab.quat.length(r))return!1;i.ab.quat.normalize(r,r);const s=i.ab.vec3.transformQuat([],[0,0,-1],r),p=i.ab.vec3.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const _=zp(s,p);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(r){const s=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;r[2]=i.aw(r[2],_/p,_/s),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,p){this._unmodified=!1,this._edgeInsets.interpolate(r,s,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new i.bQ(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new i.P(0,0)),_=this.pointCoordinate(new i.P(this.width,0)),x=this.pointCoordinate(new i.P(this.width,this.height)),S=this.pointCoordinate(new i.P(0,this.height)),I=Math.floor(Math.min(p.x,_.x,x.x,S.x)),R=Math.floor(Math.max(p.x,_.x,x.x,S.x)),$=1;for(let B=I-$;B<=R+$;B++)B!==0&&s.push(new i.bQ(B,r))}return s}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,s,p){let _=[];const x=p!==void 0,S=!x;if(S&&this.zoom<s||x&&p[0]===0&&p[1]===0)return _;const I=new Set,R=(B,j,U,q,ce)=>{const ie=i.c5(j,B,U,q,ce);I.has(ie)||(_.push(new i.aG(B,j,U,q,ce)),I.add(ie))};for(let B=0;B<r.length;B++){const j=r[B];if(S&&j.canonical.z!==s)continue;const U=j.canonical,q=j.overscaledZ,ce=j.wrap,ie=1<<U.z,he=U.x+1<ie,de=U.x>0,ve=U.y+1<ie,Me=U.y>0,Te=j.wrap-(de?0:1),Be=j.wrap+(he?0:1),Pe=de?U.x-1:ie-1,Le=he?U.x+1:0;if(x)p[0]<0?(R(q,Be,U.z,Le,U.y),p[1]<0&&ve&&(R(q,ce,U.z,U.x,U.y+1),R(q,Be,U.z,Le,U.y+1)),p[1]>0&&Me&&(R(q,ce,U.z,U.x,U.y-1),R(q,Be,U.z,Le,U.y-1))):p[0]>0?(R(q,Te,U.z,Pe,U.y),p[1]<0&&ve&&(R(q,ce,U.z,U.x,U.y+1),R(q,Te,U.z,Pe,U.y+1)),p[1]>0&&Me&&(R(q,ce,U.z,U.x,U.y-1),R(q,Te,U.z,Pe,U.y-1))):p[1]<0&&ve?R(q,ce,U.z,U.x,U.y+1):Me&&R(q,ce,U.z,U.x,U.y-1);else{const Ae=j.visibleQuadrants;1&Ae&&(R(q,Te,U.z,Pe,U.y),Me&&(R(q,ce,U.z,U.x,U.y-1),R(q,Te,U.z,Pe,U.y-1))),2&Ae&&(R(q,Be,U.z,Le,U.y),Me&&(R(q,ce,U.z,U.x,U.y-1),R(q,Be,U.z,Le,U.y-1))),4&Ae&&(R(q,Te,U.z,Pe,U.y),ve&&(R(q,ce,U.z,U.x,U.y+1),R(q,Te,U.z,Pe,U.y+1))),8&Ae&&(R(q,Be,U.z,Le,U.y),ve&&(R(q,ce,U.z,U.x,U.y+1),R(q,Be,U.z,Le,U.y+1)))}}const $=[];for(const B of _)_.some(j=>B.isChildOf(j))||$.push(B);if(_=$.filter(B=>!r.some(j=>!!(B.overscaledZ<s&&j.isChildOf(B))||B.equals(j)||B.isChildOf(j))),S){const B=1<<s,j=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),U=[B*j.x,B*j.y],q=4,ce=q*q;_=_.filter(ie=>{const he=ie.canonical.x+.5-U[0],de=ie.canonical.y+.5-U[1];return he*he+de*de<ce})}return _}coveringTiles(r){let s=this.coveringZoomLevel(r);const p=s,_=this.elevation&&this.elevation.exaggeration(),x=_&&!r.isTerrainDEM,S=this.projection.name==="mercator";if(r.minzoom!==void 0&&s<r.minzoom)return[];r.maxzoom!==void 0&&s>r.maxzoom&&(s=r.maxzoom);const I=this.locationCoordinate(this.center),R=this.center.lat,$=1<<s,B=[$*I.x,$*I.y,0],j=this.projection.name==="globe",U=!j,q=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,U),ce=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ie=$*i.bH(1,this.center.lat),he=this._camera.position[2]/i.bH(1,this.center.lat),de=[$*ce.x,$*ce.y,he*(U?1:ie)],ve=j||_,Me=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Te=this.isLODDisabled(!0)?s:0;let Be;if(this._elevation&&r.isTerrainDEM)Be=1e4*this._elevation.exaggeration();else if(this._elevation){const ot=this._elevation.getMinMaxForVisibleTiles();Be=ot?ot.max:this._centerAltitude}else Be=this._centerAltitude;const Pe=r.isTerrainDEM?-Be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Le=this.projection.isReprojectedInTileSpace?i.bS(this):1,Ae=ot=>{const yt=new i.aa(ot.x+25e-6,ot.y,ot.z),Gt=new i.aa(ot.x,ot.y+25e-6,ot.z),Ot=ot.toLngLat(),Tt=yt.toLngLat(),Bt=Gt.toLngLat(),Ht=this.locationCoordinate(Ot),rn=this.locationCoordinate(Tt),dn=this.locationCoordinate(Bt),Dn=Math.hypot(rn.x-Ht.x,rn.y-Ht.y),wn=Math.hypot(dn.x-Ht.x,dn.y-Ht.y);return Math.sqrt(Dn*wn)*Le/25e-6},Ue=ot=>{const Et=Be,yt=Pe;return{aabb:i.bV(this,$,0,0,0,ot,yt,Et,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:Et,wrap:ot,fullyVisible:!1}},tt=[];let gt=[];const ct=s,St=r.reparseOverscaled?p:s,bt=(he-this._centerAltitude)*ie,st=ot=>{if(!this._elevation||!ot.tileID||!S)return;const Et=this._elevation.getMinMaxForTile(ot.tileID),yt=ot.aabb;Et?(yt.min[2]=Et.min,yt.max[2]=Et.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(ot.shouldSplit=$t(ot),ot.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},_t=(ot,Et)=>{if(.707*Et<ot)return 1;const yt=Et/ot;return yt/(1.4144271570014144+(Math.pow(1.1,yt-1.4144271570014144+1)-1)/(1.1-1)-1)},$t=ot=>{if(ot.zoom<Te)return!0;if(ot.zoom===ct)return!1;if(ot.shouldSplit!=null)return ot.shouldSplit;const Et=ot.aabb.distanceX(de),yt=ot.aabb.distanceY(de);let Gt=bt,Ot=1;if(j){Gt=ot.aabb.distanceZ(de);const wn=Math.pow(2,ot.zoom),Tn=i.aS((ot.y+1)/wn),$n=i.aS(ot.y/wn),Jn=Math.min(Math.max(R,Tn),$n),Tr=i.c9(Jn)/i.c9(R);if(Ot=Jn===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Tr/this._mercatorScaleRatio),this.zoom<=i.c6&&ot.zoom===ct-1&&Tr>=.9)return!0}else if(x&&(Gt=ot.aabb.distanceZ(de)*ie),this.projection.isReprojectedInTileSpace&&p<=5){const wn=Math.pow(2,ot.zoom),Tn=Ae(new i.aa((ot.x+.5)/wn,(ot.y+.5)/wn));Ot=Tn>.85?1:Tn}if(!S){const wn=Math.sqrt(Et*Et+yt*yt+Gt*Gt);let Tn=(1<<ct-ot.zoom)*Me*Ot;return Tn*=_t(Math.max(Gt,bt),wn),wn<Tn}let Tt=Number.MAX_VALUE,Bt=0;const Ht=ot.aabb.getCorners(),rn=[];for(const wn of Ht){i.ab.vec3.sub(rn,wn,de),j||(x?rn[2]*=ie:rn[2]=bt);const Tn=i.ab.vec3.dot(rn,this._camera.forward());Tn<Tt&&(Tt=Tn,Bt=Math.abs(rn[2]))}let dn=(1<<ct-ot.zoom)*Me*Ot;if(dn*=_t(Math.max(Bt,bt),Tt),Tt<dn)return!0;const Dn=ot.aabb.closestPoint(B);return Dn[0]===B[0]&&Dn[1]===B[1]};if(this.renderWorldCopies)for(let ot=1;ot<=3;ot++)tt.push(Ue(-ot)),tt.push(Ue(ot));for(tt.push(Ue(0));tt.length>0;){const ot=tt.pop(),Et=ot.x,yt=ot.y;let Gt=ot.fullyVisible;const Ot=()=>this.projection.name==="globe"&&(ot.y===0||ot.y===(1<<ot.zoom)-1);if(!Gt){let Tt=ve?ot.aabb.intersects(q):ot.aabb.intersectsFlat(q);if(Tt===0&&Ot()){const Bt=new i.bT(ot.zoom,Et,yt);Tt=i.bU(this,$,Bt,!0).intersects(q)}if(Tt===0)continue;Gt=Tt===2}if(ot.zoom!==ct&&$t(ot))for(let Tt=0;Tt<4;Tt++){const Bt=(Et<<1)+Tt%2,Ht=(yt<<1)+(Tt>>1),rn={aabb:S?ot.aabb.quadrant(Tt):i.bV(this,$,ot.zoom+1,Bt,Ht,ot.wrap,ot.minZ,ot.maxZ,this.projection),zoom:ot.zoom+1,x:Bt,y:Ht,wrap:ot.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:ot.minZ,maxZ:ot.maxZ};x&&!j&&(rn.tileID=new i.aG(ot.zoom+1===ct?St:ot.zoom+1,ot.wrap,ot.zoom+1,Bt,Ht),st(rn)),tt.push(rn)}else{const Tt=ot.zoom===ct?St:ot.zoom;if(r.minzoom&&r.minzoom>Tt)continue;let Bt=0;if(!Gt){let Dn=ve?ot.aabb.intersectsPrecise(q):ot.aabb.intersectsPreciseFlat(q);if(Dn===0&&Ot()){const wn=new i.bT(ot.zoom,Et,yt);Dn=i.bU(this,$,wn,!0).intersectsPrecise(q)}if(Dn===0)continue;if(r.calculateQuadrantVisibility)if(q.containsPoint(ot.aabb.center))Bt=15;else for(let wn=0;wn<4;wn++)ot.aabb.quadrant(wn).intersects(q)!==0&&(Bt|=1<<wn)}const Ht=B[0]-(.5+Et+(ot.wrap<<ot.zoom))*(1<<s-ot.zoom),rn=B[1]-.5-yt,dn=ot.tileID?ot.tileID:new i.aG(Tt,ot.wrap,ot.zoom,Et,yt);r.calculateQuadrantVisibility&&(dn.visibleQuadrants=Bt),gt.push({tileID:dn,distanceSq:Ht*Ht+rn*rn})}}if(this.fogCullDistSq){const ot=this.fogCullDistSq,Et=this.horizonLineFromTop();gt=gt.filter(yt=>{const Gt=[0,0,0,1],Ot=[i.ag,i.ag,0,1],Tt=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Gt,Gt,Tt),i.ab.vec4.transformMat4(Ot,Ot,Tt);const Bt=i.ab.vec4.min([],Gt,Ot),Ht=i.ab.vec4.max([],Gt,Ot),rn=i.bW(Bt,Ht);if(rn===0)return!0;let dn=!1;const Dn=this._elevation;if(Dn&&rn>ot&&Et!==0){const wn=this.calculateProjMatrix(yt.tileID.toUnwrapped());let Tn;r.isTerrainDEM||(Tn=Dn.getMinMaxForTile(yt.tileID)),Tn||(Tn={min:Pe,max:Be});const $n=i.c7(this.rotation),Jn=[$n[0]*i.ag,$n[1]*i.ag,Tn.max];i.ab.vec3.transformMat4(Jn,Jn,wn),dn=(1-Jn[1])*this.height*.5<Et}return rn<ot||dn})}return gt.sort((ot,Et)=>ot.distanceSq-Et.distanceSq).map(ot=>ot.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=i.aw(r.lat,-i.bX,i.bX),p=this.projection.project(r.lng,s);return new i.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,s){let p,_;const x=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;p=(s.x-x.x)/I,_=(s.y-x.y)/I}else{const I=this.pointCoordinate(s),R=this.pointCoordinate(x);p=I.x-R.x,_=I.y-R.y}const S=this.locationCoordinate(r);this.setLocation(new i.aa(S.x-p,S.y-_))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,s){const p=s?i.bH(s,r.lat):void 0,_=this.projection.project(r.lng,r.lat);return new i.aa(_.x,_.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,s){const p=s??this._centerAltitude,_=[r.x,r.y,0,1],x=[r.x,r.y,1,1];i.ab.vec4.transformMat4(_,_,this.pixelMatrixInverse),i.ab.vec4.transformMat4(x,x,this.pixelMatrixInverse);const S=x[3];i.ab.vec4.scale(_,_,1/_[3]),i.ab.vec4.scale(x,x,1/S);const I=_[2],R=x[2];return{p0:_,p1:x,t:I===R?0:(p-I)/(R-I)}}screenPointToMercatorRay(r){const s=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return i.ab.vec4.transformMat4(s,s,this.pixelMatrixInverse),i.ab.vec4.transformMat4(p,p,this.pixelMatrixInverse),i.ab.vec4.scale(s,s,1/s[3]),i.ab.vec4.scale(p,p,1/p[3]),s[2]=i.bH(s[2],this._center.lat)*this.worldSize,p[2]=i.bH(p[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(s,s,1/this.worldSize),i.ab.vec4.scale(p,p,1/this.worldSize),new i.aq([s[0],s[1],s[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],p,s)))}rayIntersectionCoordinate(r){const{p0:s,p1:p,t:_}=r,x=i.bH(s[2],this._center.lat),S=i.bH(p[2],this._center.lat);return new i.aa(i.af(s[0],p[0],_)/this.worldSize,i.af(s[1],p[1],_)/this.worldSize,i.af(x,S,_))}pointCoordinate(r,s=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,s)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let s=this.projection.pointCoordinate3D(this,r.x,r.y);if(s)return new i.aa(s[0],s[1],s[2]);let p=0,_=this.horizonLineFromTop();if(r.y>_)return this.pointCoordinate(r);const x=.02*_,S=r.clone();for(let I=0;I<10&&_-p>x;I++){S.y=i.af(p,_,.66);const R=this.projection.pointCoordinate3D(this,S.x,S.y);R?(_=S.y,s=R):p=S.y}return s?new i.aa(s[0],s[1],s[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(r);const s=this.pointCoordinate(r);return s.y>=0&&s.y<=1}_coordinatePoint(r,s){const p=s&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,_=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return i.ab.vec4.transformMat4(_,_,this.pixelMatrix),_[3]>0?new i.P(_[0]/_[3],_[1]/_[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:s}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,x=this.pointLocation3D(new i.P(s,r)),S=this.pointLocation3D(new i.P(_,r)),I=this.pointLocation3D(new i.P(_,p)),R=this.pointLocation3D(new i.P(s,p));let $=Math.min(x.lng,S.lng,I.lng,R.lng),B=Math.max(x.lng,S.lng,I.lng,R.lng),j=Math.min(x.lat,S.lat,I.lat,R.lat),U=Math.max(x.lat,S.lat,I.lat,R.lat);const q=Math.pow(2,-this.zoom)/16*270,ce=this.projection.name==="globe"?1:4,ie=(he,de,ve,Me,Te)=>{const Be=(he+ve)/2,Pe=(de+Me)/2,Le=new i.P(Be,Pe),{lng:Ae,lat:Ue}=this.pointLocation3D(Le),tt=Math.max(0,$-Ae,j-Ue,Ae-B,Ue-U);$=Math.min($,Ae),B=Math.max(B,Ae),j=Math.min(j,Ue),U=Math.max(U,Ue),(Te<ce||tt>q)&&(ie(he,de,Be,Pe,Te+1),ie(Be,Pe,ve,Me,Te+1))};if(ie(s,r,_,r,1),ie(_,r,_,p,1),ie(_,p,s,p,1),ie(s,p,s,r,1),this.projection.name==="globe"){const[he,de]=i.bZ(this);he?(U=90,B=180,$=-180):de&&(j=-90,B=180,$=-180)}return new i.az(new i.bO($,j),new i.bO(B,U))}_getBoundsRectangular(r,s){const{top:p,left:_}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,I=new i.P(_,p),R=new i.P(S,p),$=new i.P(S,x),B=new i.P(_,x);let j=this.pointCoordinate(I,r),U=this.pointCoordinate(R,r);const q=this.pointCoordinate($,s),ce=this.pointCoordinate(B,s),ie=(he,de)=>(de.y-he.y)/(de.x-he.x);return j.y>1&&U.y>=0?j=new i.aa((1-ce.y)/ie(ce,j)+ce.x,1):j.y<0&&U.y<=1&&(j=new i.aa(-ce.y/ie(ce,j)+ce.x,0)),U.y>1&&j.y>=0?U=new i.aa((1-q.y)/ie(q,U)+q.x,1):U.y<0&&j.y<=1&&(U=new i.aa(-q.y/ie(q,U)+q.x,0)),new i.az().extend(this.coordinateLocation(j)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=r.visibleDemTiles.reduce((p,_)=>{if(_.dem){const x=_.dem.tree;p.min=Math.min(p.min,x.minimums[0]),p.max=Math.max(p.max,x.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*r.exaggeration(),s.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-s*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,s){return this.projection.createTileMatrix(this,s,r)}calculateDistanceTileData(r){const s=r.key,p=this._distanceTileDataCache;if(p[s])return p[s];const _=r.canonical,x=1/this.height,S=this.cameraWorldSize,I=S/this.zoomScale(_.z),R=(_.x+Math.pow(2,_.z)*r.wrap)*I,$=_.y*I,B=this.point;B.x*=S/this.worldSize,B.y*=S/this.worldSize;const j=this.angle,U=Math.sin(-j),q=-Math.cos(-j);return p[s]={bearing:[U,q],center:[(B.x-R)*x,(B.y-$)*x],scale:I/i.ag*x},p[s]}calculateFogTileMatrix(r){const s=r.key,p=this._fogTileMatrixCache;if(p[s])return p[s];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.ab.mat4.multiply(_,this.worldToFogMatrix,_),p[s]=new Float32Array(_),p[s]}calculateProjMatrix(r,s=!1,p=!1){const _=r.key;let x;if(x=p?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,x[_])return x[_];const S=this.calculatePosMatrix(r,this.worldSize);let I;return I=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(S,I,S),x[_]=new Float32Array(S),x[_]}calculatePixelsToTileUnitsMatrix(r){const s=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[s])return p[s];const _=i.b_(r,this);return p[s]=_,p[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,s=i.ab.mat4.fromScaling([],[r,r,r]);return i.ab.mat4.multiply(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const s=i.bH(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(s),_=this._camera.forward(),x=i.bH(1,this._center.lat);p[2]/=x,_[2]/=x,i.ab.vec3.normalize(_,_);const S=r.raycast(p,_,r.exaggeration());if(S){const I=i.ab.vec3.scaleAndAdd([],p,_,S),R=new i.aa(I[0],I[1],i.bH(I[2],i.aS(I[1]))),$=(R.z+i.ab.vec3.length([R.x-p[0],R.y-p[1],R.z-p[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ($),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const s=this._elevation,p=i.bH(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),x=s.getAtPointOrZero(new i.aa(..._)),S=this.pixelsPerMeter/this.worldSize*x,I=this._minimumHeightOverTerrain(),R=_[2]-S;if(R<=I)if(R<0||r){const $=this.locationCoordinate(this._center,this._centerAltitude),B=[_[0],_[1],$.z-_[2]],j=i.ab.vec3.length(B);B[2]-=(I-R)/this._pixelsPerMercatorPixel;const U=i.ab.vec3.length(B);if(U===0)return;i.ab.vec3.scale(B,B,j/U*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],$.z*this._pixelsPerMercatorPixel-B[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const U=this.center;return U.lat=i.aw(U.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(U.lng=i.aw(U.lng,this.minLng,this.maxLng)),this.center=U,void(this._constraining=!1)}const s=this._unmodified,{x:p,y:_}=this.point;let x=0,S=p,I=_;const R=this.width/2,$=this.height/2,B=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(_-$<B&&(I=B+$),_+$>j&&(I=j-$),j-B<this.height&&(x=Math.max(x,this.height/(j-B)),I=(j+B)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const U=this.worldMinX*this.scale,q=this.worldMaxX*this.scale,ce=this.worldSize/2-(U+q)/2;S=(p+ce+this.worldSize)%this.worldSize-ce,S-R<U&&(S=U+R),S+R>q&&(S=q-R),q-U<this.width&&(x=Math.max(x,this.width/(q-U)),S=(q+U)/2)}S===p&&I===_||(this.center=this.unproject(new i.P(S,I))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const _=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this.projection.zAxisUnit==="meters"?p:1,S=this._camera.getWorldToCamera(this.worldSize,x);let I;const R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(R[8]=2*-r.x/this.width,R[9]=2*r.y/this.height,this.isOrthographic){let Ue=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),tt=Ue*this.aspect,gt=-tt,ct=-Ue;tt-=r.x,gt-=r.x,Ue+=r.y,ct+=r.y,I=this._camera.getCameraToClipOrthographic(gt,tt,ct,Ue,this._nearZ,this._farZ),((St,bt,st,_t)=>{for(let $t=0;$t<16;$t++)St[$t]=Lp(bt[$t],st[$t],_t)})(I,I,R,Lh(this.pitch>=15?1:this.pitch/15))}else I=R;const $=i.ab.mat4.mul([],R,S);let B=i.ab.mat4.mul([],I,S);if(this.projection.isReprojectedInTileSpace){const Ue=this.locationCoordinate(this.center),tt=i.ab.mat4.identity([]);i.ab.mat4.translate(tt,tt,[Ue.x*this.worldSize,Ue.y*this.worldSize,0]),i.ab.mat4.multiply(tt,tt,i.c0(this)),i.ab.mat4.translate(tt,tt,[-Ue.x*this.worldSize,-Ue.y*this.worldSize,0]),i.ab.mat4.multiply(B,B,tt),i.ab.mat4.multiply($,$,tt),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],B,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=B,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),s){const Ue=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ue[8]=2*-r.x/this.width,Ue[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Ue,S)}else this.expandedFarZProjMatrix=this.projMatrix;const j=i.ab.mat4.invert([],I);this.frustumCorners=i.c2.fromInvProjectionMatrix(j,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const U=new Float32Array(16);i.ab.mat4.identity(U),i.ab.mat4.scale(U,U,[1,-1,1]),i.ab.mat4.rotateX(U,U,this._pitch),i.ab.mat4.rotateZ(U,U,this.angle);const q=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(q);const ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-r.x/this.width,q[9]=2*(r.y+ce)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(U,q,U);const ie=this.point,he=ie.x,de=ie.y,ve=this.width%2/2,Me=this.height%2/2,Te=Math.cos(this.angle),Be=Math.sin(this.angle),Pe=he-Math.round(he)+Te*ve+Be*Me,Le=de-Math.round(de)+Te*Me+Be*ve,Ae=new Float64Array(B);if(i.ab.mat4.translate(Ae,Ae,[Pe>.5?Pe-1:Pe,Le>.5?Le-1:Le,0]),this.alignedProjMatrix=Ae,B=i.ab.mat4.create(),i.ab.mat4.scale(B,B,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=i.ab.mat4.create(),i.ab.mat4.scale(B,B,[1,-1,1]),i.ab.mat4.translate(B,B,[-1,-1,0]),i.ab.mat4.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,$),this._calcFogMatrices(),this._distanceTileDataCache={},B=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ue=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Ue,Ue,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,p=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,x=[r,r,s];i.ab.vec3.scale(x,x,_),i.ab.vec3.scale(p,p,-1),i.ab.vec3.multiply(p,p,x);const S=i.ab.mat4.create();i.ab.mat4.translate(S,S,p),i.ab.mat4.scale(S,S,x),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,s,_)}_computeCameraPosition(r){const s=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),_=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-r/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-p[0]*x,_.y/this.worldSize-p[1]*x,r/this.worldSize*this._centerAltitude-p[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],_=r[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(x=Math.min((s-p)/_,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,r,x),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,s=this._camera.forward(),{pitch:p,bearing:_}=this._camera.getPitchBearing(),x=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),I=Math.max((r[2]-x)/Math.cos(p),S),R=this._zoomFromMercatorZ(I);i.ab.vec3.scaleAndAdd(r,r,s,I),this._pitch=i.aw(p,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(_,-Math.PI,Math.PI),this._setZoom(i.aw(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let s=0,p=i.bY,_=0,x=1/0;for(;p-s>1e-6&&p>s;){const S=s+.5*(p-s),I=this.tileSize*Math.pow(2,S),R=this.getCameraToCenterDistance(this.projection,S,I),$=this.scaleZoom(R/(r*this.tileSize)),B=Math.abs(S-$);B<x&&(x=B,_=S),S<$?s=S:p=S}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,s){const p=Math.min(r.x,s.x),_=Math.max(r.x,s.x),x=Math.min(r.y,s.y),S=Math.max(r.y,s.y);if(x<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new i.P(p,x),new i.P(_,S),new i.P(p,S),new i.P(_,x)],R=this.renderWorldCopies?-3:0,$=this.renderWorldCopies?4:1;for(const B of I){const j=this.pointRayIntersection(B);if(j.t<0)return!0;const U=this.rayIntersectionCoordinate(j);if(U.x<R||U.y<0||U.x>$||U.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,s){const p=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,r)),_=this._zoomFromMercatorZ(p)+s;return p-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([s,p,_],x){const S=[s,p,_,1];i.ab.vec4.transformMat4(S,S,x);const I=S[3]=Math.max(S[3],1e-6);return S[0]/=I,S[1]/=I,S[2]/=I,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,s=this.zoom,p=this.worldSize){const _=i.b$(r,s,this.width,this.height,1024),x=r.pixelSpaceConversion(this.center.lat,p,_);let S=.5/Math.tan(.5*this._fov)*this.height*x;return this.isOrthographic&&(S=Lp(1,S,Lh(this.pitch>=15?1:this.pitch/15))),S}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const nl=(f,r)=>{if(r>0&&f.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const s=f.transform,p=Math.max(Math.abs(s._zoom-(f.minCutoffZoom-1)),1),_=s.isLODDisabled(!1)?i.ac(60,45,s.pitch):i.ac(30,15,s.pitch),x=s._farZ-s._nearZ,S=r*s.height,I=((1-(R=_))*s.cameraToCenterDistance+R*(s._farZ+S))*p;var R;return{shouldRenderCutoff:_<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(I-s._nearZ)/x,(I-S-s._nearZ)/x]}}},Qi={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Ms{constructor(r,s){this.aabb=r,this.lastCascade=s}}class $p{add(r,s){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],s.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],s.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],s.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],s.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],s.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],s.max[2])):this.receivers[r.key]=new Ms(s,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,s,p){const _=i.cd.fromPoints(r.points);let x=0;for(const S in this.receivers){const I=this.receivers[S];if(!I||!_.intersectsAabb(I.aabb))continue;I.aabb.min=_.closestPoint(I.aabb.min),I.aabb.max=_.closestPoint(I.aabb.max);const R=I.aabb.getCorners();for(let $=0;$<p.length;$++){let B=!0;for(const j of R){const U=[j[0]*s,j[1]*s,j[2]];if(i.ab.vec3.transformMat4(U,U,p[$].matrix),U[0]<-1||U[0]>1||U[1]<-1||U[1]>1){B=!1;break}}if(I.lastCascade=$,x=Math.max(x,$),B)break}}return x+1}}class jl{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new $p,this._depthMode=new Cn(r.context.gl.LEQUAL,Cn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Qi,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Qi,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Qi,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,s){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const _=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||_<=0||(this._shadowLayerCount=p.style.order.reduce((ce,ie)=>{const he=p.style._mergedLayers[ie];return ce+(he.hasShadowPass()&&!he.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const x=p.context,S=Qi.shadowMapResolution,I=Qi.shadowMapResolution;if(this._cascades.length===0||Qi.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ce=0;ce<Qi.cascadeCount;++ce){const ie=p._shadowMapDebug,he=x.gl,de=x.createFramebuffer(S,I,ie,"texture"),ve=new i.T(x,{width:S,height:I,data:null},he.DEPTH_COMPONENT16);if(de.depthAttachment.set(ve.texture),ie){const Me=new i.T(x,{width:S,height:I,data:null},he.RGBA8);de.colorAttachment.set(Me.texture)}this._cascades.push({framebuffer:de,texture:ve,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Hl(s);let R=0;if(r.elevation){const ce=r.elevation,ie=[1e4,-1e4];ce.visibleDemTiles.filter(he=>he.dem).forEach(he=>{const de=he.dem.tree;ie[0]=Math.min(ie[0],de.minimums[0]),ie[1]=Math.max(ie[1],de.maximums[0])}),ie[0]!==1e4&&(R=(ie[1]-ie[0])*ce.exaggeration())}const $=1.5*r.cameraToCenterDistance,B=3*$,j=new Float64Array(16);for(let ce=0;ce<this._cascades.length;++ce){const ie=this._cascades[ce];let he=r.height/50,de=1;Qi.cascadeCount===1?de=B:ce===0?de=$:(he=$,de=B);const[ve,Me]=Wx(r,this.shadowDirection,he,de,Qi.shadowMapResolution,R);ie.scale=r.scale,ie.matrix=ve,ie.boundingSphereRadius=Me,i.ab.mat4.invert(j,ie.matrix),ie.frustum=i.bR.fromInvProjectionMatrix(j,1,0,!0),ie.far=de}const U=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[U].far,this._cascades[U].far],this._uniformValues.u_shadow_intensity=_,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Qi.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Qi.shadowMapResolution,this._uniformValues.u_shadowmap_0=oo.ShadowMap0,this._uniformValues.u_shadowmap_1=oo.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const q=p.transform.elevation;for(const ce of this._groundShadowTiles){let ie={min:0,max:0};if(q){const he=q.getMinMaxForTile(ce);he&&(ie=he)}this.addShadowReceiver(ce.toUnwrapped(),ie.min,ie.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,s){if(!this.enabled)return;const p=this.painter,_=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),_.viewport.set([0,0,Qi.shadowMapResolution,Qi.shadowMapResolution]);for(let x=0;x<this._numCascadesToRender;++x){p.currentShadowCascade=x,_.bindFramebuffer.set(this._cascades[x].framebuffer.framebuffer),_.clear({color:i.aj.white,depth:1});for(const S of r.order){const I=r._mergedLayers[S];if(!I.hasShadowPass()||I.isHidden(p.transform.zoom))continue;const R=r.getLayerSourceCache(I),$=R?s[R.id]:void 0;(I.type==="model"||$&&$.length)&&p.renderLayer(p,R,I,$)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,s=r.style,p=r.context,_=s.directionalLight,x=s.ambientLight;if(!_||!x)return;const S=[],I=nl(r,r.longestCutoffRange);I.shouldRenderCutoff&&S.push("RENDER_CUTOFF"),S.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&S.push("NORMAL_OFFSET");const R=Fp(s,_,x),$=new Cn(p.gl.LEQUAL,Cn.ReadOnly,r.depthRangeFor3D);for(const B of this._groundShadowTiles){const j=B.toUnwrapped(),U=r.isTileAffectedByFog(B),q=r.getOrCreateProgram("groundShadow",{defines:S,overrideFog:U});this.setupShadows(j,q),r.uploadCommonUniforms(p,q,j,null,I);const ce={u_matrix:r.transform.calculateProjMatrix(j),u_ground_shadow_factor:R};q.draw(r,p.gl.TRIANGLES,$,Rn.disabled,Wn.multiply,Ln.disabled,ce,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Wn.unblended:Wn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const s=this.painter.transform,p=s.calculatePosMatrix(r,s.worldSize);return i.ab.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return i.ab.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,s,p,_=0){if(!this.enabled)return;const x=this.painter.transform,S=this.painter.context,I=S.gl,R=this._uniformValues,$=new Float64Array(16),B=x.calculatePosMatrix(r,x.worldSize);for(let j=0;j<this._cascades.length;j++)i.ab.mat4.multiply($,this._cascades[j].matrix,B),R[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from($),S.activeTexture.set(I.TEXTURE0+oo.ShadowMap0+j),this._cascades[j].texture.bind(I.NEAREST,I.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const j=i.cc(r.canonical),U=2/x.tileSize*i.ag/Qi.shadowMapResolution,q=U*this._cascades[0].boundingSphereRadius,ce=U*this._cascades[this._cascades.length-1].boundingSphereRadius,ie=(p==="vector-tile"?1:3)/Math.pow(2,_-r.canonical.z-(1-x.zoom+Math.floor(x.zoom)));R.u_shadow_normal_offset=[j,q*ie,ce*ie],R.u_shadow_bias=[6e-5,.0012,.012]}else R.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(S,R)}setupShadowsFromMatrix(r,s,p=!1){if(!this.enabled)return;const _=this.painter.context,x=_.gl,S=this._uniformValues,I=new Float64Array(16);for(let R=0;R<Qi.cascadeCount;R++)i.ab.mat4.multiply(I,this._cascades[R].matrix,r),S[R===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),_.activeTexture.set(x.TEXTURE0+oo.ShadowMap0+R),this._cascades[R].texture.bind(x.NEAREST,x.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const R=Qi.normalOffset;S.u_shadow_normal_offset=[1,R,R],S.u_shadow_bias=[6e-5,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(_,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,s,p,_){if(_[2]>=0)return{};const x=function(R,$,B){const j=B/(1<<R.canonical.z);return new i.cd([R.canonical.x*j+R.wrap*B,R.canonical.y*j+R.wrap*B,0],[(R.canonical.x+1)*j+R.wrap*B,(R.canonical.y+1)*j+R.wrap*B,$])}(r,s,p).getCorners(),S=s/-_[2];_[0]<0?(i.ab.vec3.add(x[0],x[0],[_[0]*S,0,0]),i.ab.vec3.add(x[3],x[3],[_[0]*S,0,0])):_[0]>0&&(i.ab.vec3.add(x[1],x[1],[_[0]*S,0,0]),i.ab.vec3.add(x[2],x[2],[_[0]*S,0,0])),_[1]<0?(i.ab.vec3.add(x[0],x[0],[0,_[1]*S,0]),i.ab.vec3.add(x[1],x[1],[0,_[1]*S,0])):_[1]>0&&(i.ab.vec3.add(x[2],x[2],[0,_[1]*S,0]),i.ab.vec3.add(x[3],x[3],[0,_[1]*S,0]));const I={};return I.vertices=x,I.planes=[Ul(x[1],x[0],x[4]),Ul(x[2],x[1],x[5]),Ul(x[3],x[2],x[6]),Ul(x[0],x[3],x[7])],I}addShadowReceiver(r,s,p){this._receivers.add(r,i.cd.fromTileIdAndHeight(r,s,p))}getMaxCascadeForTile(r){const s=this._receivers.get(r);return s&&s.lastCascade?s.lastCascade:0}}function Ul(f,r,s){const p=i.ab.vec3.sub([],s,r),_=i.ab.vec3.sub([],f,r),x=i.ab.vec3.cross([],p,_),S=i.ab.vec3.length(x);return S===0?[0,0,1,0]:(i.ab.vec3.scale(x,x,1/S),[x[0],x[1],x[2],-i.ab.vec3.dot(x,r)])}function Hl(f){const r=f.properties.get("direction"),s=i.cb(r.x,r.y,r.z);s[2]=i.aw(s[2],0,75);const p=i.ce([s[0],s[1],s[2]]);return i.ab.vec3.fromValues(p.x,p.y,p.z)}function Fp(f,r,s){const p=r.properties.get("color-use-theme")==="none",_=r.properties.get("color"),x=r.properties.get("intensity"),S=r.properties.get("direction"),I=[S.x,S.y,S.z],R=s.properties.get("color-use-theme")==="none",$=s.properties.get("color"),B=s.properties.get("intensity"),j=Math.max(i.ab.vec3.dot([0,0,1],I),0),U=[0,0,0];i.ab.vec3.scale(U,$.toRenderColor(R?null:f.getLut(r.scope)).toArray01Linear().slice(0,3),B);const q=[0,0,0];return i.ab.vec3.scale(q,_.toRenderColor(p?null:f.getLut(s.scope)).toArray01Linear().slice(0,3),j*x),i.cf([U[0]>0?U[0]/(U[0]+q[0]):0,U[1]>0?U[1]/(U[1]+q[1]):0,U[2]>0?U[2]/(U[2]+q[2]):0])}function Wx(f,r,s,p,_,x){const S=f.zoom,I=f.scale,R=f.worldSize,$=1/R,B=f.aspect,j=Math.sqrt(1+B*B)*Math.tan(.5*f.fovX),U=j*j,q=p-s,ce=p+s;let ie,he;U>q/ce?(ie=p,he=p*j):(ie=.5*ce*(1+U),he=.5*Math.sqrt(q*q+2*(p*p+s*s)*U+ce*ce*U*U));const de=f.projection.pixelsPerMeter(f.center.lat,R),ve=f._camera.getCameraToWorldMercator(),Me=[0,0,-ie*$];i.ab.vec3.transformMat4(Me,Me,ve);let Te=he*$;const Be=f._edgeInsets;if(!(Be.left===0&&Be.top===0&&Be.right===0&&Be.bottom===0||Be.left===Be.right&&Be.top===Be.bottom)){const Gt=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?de:1),Ot=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,s,p);Ot[8]=2*-f.centerOffset.x/f.width,Ot[9]=2*f.centerOffset.y/f.height;const Tt=new Float64Array(16);i.ab.mat4.mul(Tt,Ot,Gt);const Bt=new Float64Array(16);i.ab.mat4.invert(Bt,Tt);const Ht=i.bR.fromInvProjectionMatrix(Bt,R,S,!0);for(const rn of Ht.points){const dn=((Pe=rn)[0]/=I,Pe[1]/=I,Pe[2]=i.bH(Pe[2],f._center.lat),Pe);Te=Math.max(Te,i.ab.vec3.len(i.ab.vec3.subtract([],Me,dn)))}}var Pe;Te*=_/(_-1);const Le=Math.acos(r[2]),Ae=Math.atan2(-r[0],-r[1]),Ue=new Do;Ue.position=Me,Ue.setPitchBearing(Le,Ae);const tt=Ue.getWorldToCamera(R,de),gt=Te*R,ct=Math.min(f._mercatorZfromZoom(17)*R*-2,-2*gt),St=Ue.getCameraToClipOrthographic(-gt,gt,-gt,gt,ct,(gt+x*de)/r[2]),bt=new Float64Array(16);i.ab.mat4.multiply(bt,St,tt);const st=i.ab.vec3.fromValues(Math.floor(1e6*Me[0])/1e6*R,Math.floor(1e6*Me[1])/1e6*R,0),_t=.5*_,$t=[0,0,0];i.ab.vec3.transformMat4($t,st,bt),i.ab.vec3.scale($t,$t,_t);const ot=[Math.floor($t[0]),Math.floor($t[1]),Math.floor($t[2])],Et=[0,0,0];i.ab.vec3.sub(Et,$t,ot),i.ab.vec3.scale(Et,Et,-1/_t);const yt=new Float64Array(16);return i.ab.mat4.identity(yt),i.ab.mat4.translate(yt,yt,Et),i.ab.mat4.multiply(bt,yt,bt),[bt,gt]}class Bp extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(r,s){return i.aM(this.requestManager.transformRequest(s,i.R.Model).url).then(p=>{if(!p)return;const _=i.aN(p),x=new i.aO(r,void 0,void 0,_);return x.computeBoundsAndApplyParent(),x}).catch(p=>{if(p&&p.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${r} from ${s}: ${p.message}`)))})}load(r,s,p={keepNumReferences:!1}){this.models[s]||(this.models[s]={});const _=Object.keys(r);this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+_.length;const x=[];for(const S of _)x.push(this.loadModel(S,r[S]));Promise.allSettled(x).then(S=>{for(let I=0;I<S.length;I++){const{status:R,value:$}=S[I];if(R==="fulfilled"&&$){const B=this.models[s][_[I]];this.models[s][_[I]]={model:$,numReferences:p.keepNumReferences&&B?B.numReferences:1}}}this.numModelsLoading[s]-=_.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(S=>{this.fire(new i.y(new Error(`Could not load models: ${S.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,s){return!!this.getModel(r,s)}getModel(r,s){return this.models[s]||(this.models[s]={}),this.models[s][r]?this.models[s][r].model:void 0}addModel(r,s,p){this.models[p]||(this.models[p]={}),this.modelUris[p]||(this.modelUris[p]={}),this.hasModel(r,p)&&this.models[p][r].numReferences++,this.modelUris[p][r]=this.requestManager.normalizeModelURL(s),this.load({[r]:this.modelUris[p][r]},p)}addModels(r,s){this.models[s]||(this.models[s]={}),this.modelUris[s]||(this.modelUris[s]={});const p=this.modelUris[s];for(const _ in r)this.models[s][_]={},p[_]=this.requestManager.normalizeModelURL(r[_]);this.load(p,s,{keepNumReferences:!0})}reloadModels(r){this.load(this.modelUris[r],r)}addModelsFromBucket(r,s){this.models[s]||(this.models[s]={}),this.modelUris[s]||(this.modelUris[s]={});const p={};for(const _ of r)this.hasModel(_,s)?this.models[s][_].numReferences++:(this.modelUris[s][_]=this.requestManager.normalizeModelURL(_),p[_]=this.modelUris[s][_]);this.load(p,s)}removeModel(r,s){if(this.models[s]&&this.models[s][r]&&(this.models[s][r].numReferences--,this.models[s][r].numReferences===0)){const p=this.models[s][r].model;delete this.models[s][r],delete this.modelUris[s][r],p.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,s){this.models[s]||(this.models[s]={});for(const p in this.models[s])this.models[s][p].model&&this.models[s][p].model.upload(r.context)}}const qx=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),B_={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function kp(f){return f=f||{},Object.assign(f,B_)}class Np extends i.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(r){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(S,I){const[R,$]=S,{center:B,radius:j}=I,[U,q]=B,ce=Math.abs(R-U);return Math.sqrt((ce>180?360-ce:ce)**2+($-q)**2)<=j}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=new i.P(this._map.transform.width/2,this._map.transform.height/2),_=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(r?_:p,s);x.length>0&&(this._selectedFloorplan&&x[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=x[0],this._floorplanSelected(!1)))}_floorplanSelected(r){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(x){const[[S,I],[R,$]]=x,B=(R-S+360)%360,j=B>180?360-B:B;return{center:[(S+j/2+360)%360,(I+$)/2],radius:Math.sqrt(j**2+($-I)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const s=this._floorplanStates[this._indoorData.id].selectedBuilding,p=this._floorplanStates[this._indoorData.id].selectedLevel;let _;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const x of this._indoorData.levels)x.id===this._selectedLevel.id&&(_=x.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:_})),s){const x=this._indoorData.buildings.find(S=>S.id===s);this._buildingSelected(x,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(p){const x=this._indoorData.levels.find(S=>S.id===p);this._updateLevels(x,r)}else r&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(r,s){s&&r&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const p=this._indoorData.levels.filter(_=>r.levels.includes(_.id));this.fire(new i.z("buildingselected",{buildingId:r.id,levels:p}))}_levelSelected(r){if(r==="overview")this._updateLevels(void 0,!0);else{const s=this._indoorData.levels.find(p=>p.id===r);this._updateLevels(s,!0)}this.fire(new i.z("levelselected",{levelId:r==="overview"?void 0:r}))}_updateLevels(r,s){if(!r)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(s&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function p($){const B=$.indexOf("/floor/");if(B===-1)return $;const j=B+7,U=$.indexOf("/",j);return U===-1?$.slice(j):$.slice(j,U)}this._selectedLevel=r,this._floorplanStates[this._indoorData.id].selectedLevel=r?r.id:void 0;const _=[],x={},S={},I={},R={};for(const $ of this._indoorData.levels)if(_.push($.id),x[$.id]=$.height,S[$.id]=$.base,r){if(this.mergeFloors){const B=p(r.id),j=p($.id);I[$.id]=j===B?"true":"false"}else I[$.id]=$.id===r.id?"true":"false";R[$.id]=$.base<r.base?"true":"false"}else R[$.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",_]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",I]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",R]),r&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!r.isUnderground),s&&r.extent)){const $=this._map.cameraForBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),B=this._map.getZoom(),j=$.zoom?Math.abs(B-$.zoom):0;this._map.fitBounds(r.extent,j>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:B})}}selectFloorplan(r){const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],_=this._map.queryRenderedFeatures(p,s);if(_.length>0){for(const x of _)if(JSON.parse(x.properties["indoor-data"]).floorplanIDs.includes(r)){this._selectedFloorplan=x,this._floorplanSelected(!0);break}}}selectBuilding(r){const s=this._indoorData.buildings.find(p=>p.id===r);this._buildingSelected(s,!0)}selectLevel(r){this._levelSelected(r)}}function Zx(f){if(!f.metadata||!f.metadata.content_area)return;const r=i.q.devicePixelRatio,{left:s,top:p,width:_,height:x}=f.metadata.content_area,S=s*r,I=p*r;return[S,I,S+_*r,I+x*r]}function k_(f){if(f)return f.map(([r,s])=>[r*i.q.devicePixelRatio,s*i.q.devicePixelRatio])}const Gl=(f,r)=>ua(f,r&&r.filter(s=>s.identifier!=="source.canvas")),Yx=i.ay(qn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),N_=i.ay(qn,["setCenter","setZoom","setBearing","setPitch"]),Vp=new Set(["background","sky","slot","custom"]),Qu={version:8,layers:[],sources:{}},V_={duration:300,delay:0};class fa extends i.E{constructor(r,s={}){super(),this.map=r,this.scope=s.scope||"",this.globalId=null,this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=i.l({},V_),this._buildingIndex=new $_(this),this.crossTileSymbolIndex=new Rp,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new Ye,this.dispatcher=s.dispatcher?s.dispatcher:new i.D(i.ci(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new Mt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new i.cj(r._requestManager,s.localFontFamily?i.ck.all:s.localIdeographFontFamily?i.ck.ideographs:i.ck.none,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new Bp(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=s.configOptions?s.configOptions:new Map,this._configDependentLayers=s.configDependentLayers?s.configDependentLayers:new Set,this._config=s.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:s.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=s.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const p=this;this._rtlTextPluginCallback=fa.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(x,S)=>{if(i.cm(x),S&&S.every(I=>I))for(const I in p._sourceCaches){const R=p._sourceCaches[I],$=R.getSource().type;$!=="vector"&&$!=="geojson"||R.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const x=this.getOwnSource(_.sourceId);if(x&&x.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===x.id&&this._validateLayer(I)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(i.f(r))return r;const s=i.cn(r);if(!s.startsWith("http"))try{return new URL(s,location.href).toString()}catch{return s}return s}return`json://${i.co(JSON.stringify(r))}`}_diffStyle(r,s,p){this.globalId=this._getGlobalId(r);const _=(x,S)=>{try{S(null,this.setState(x,p))}catch(I){S(I,!1)}};if(typeof r=="string"){const x=this.map._requestManager.normalizeStyleURL(r),S=this.map._requestManager.transformRequest(x,i.R.Style);i.n(S,(I,R)=>{I?this.fire(new i.y(I)):R&&_(R,s)})}else typeof r=="object"&&_(r,s)}loadURL(r,s={}){this.fire(new i.z("dataloading",{dataType:"style"}));const p=typeof s.validate=="boolean"?s.validate:!i.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,s.accessToken),this.resolvedImports.add(r);const _=this.importsCache.get(r);if(_)return this._load(_,p);const x=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.n(x,(S,I)=>{if(this._request=null,S)this.fire(new i.y(S));else if(I)return this.importsCache.set(r,I),this._load(I,p)})}loadJSON(r,s={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=i.q.frame(()=>{this._request=null,this._load(r,s.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(Qu,!1)}_loadImports(r,s,p){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const _=[];for(const x of r){const S=this._createFragmentStyle(x),I=new Promise(B=>{S.once("style.import.load",B),S.once("error",B)}).then(()=>this.mergeAll());if(_.push(I),this.resolvedImports.has(x.url)){S.loadEmpty();continue}const R=x.data||this.importsCache.get(x.url);R?(S.loadJSON(R,{validate:s}),this._isInternalStyle(R)&&(S.globalId=null)):x.url?S.loadURL(x.url,{validate:s}):S.loadEmpty();const $={style:S,id:x.id,config:x.config};if(p){const B=this.fragments.findIndex(({id:j})=>j===p);this.fragments=this.fragments.slice(0,B).concat($).concat(this.fragments.slice(B))}else this.fragments.push($)}return Promise.allSettled(_)}getImportGlobalIds(r=this,s=new Set){for(const p of r.fragments)p.style.globalId&&s.add(p.style.globalId),this.getImportGlobalIds(p.style,s);return[...s.values()]}_createFragmentStyle(r){const s=this.scope?i.aC(r.id,this.scope):r.id;let p;const _=this._initialConfig&&this._initialConfig[s];(r.config||_)&&(p=i.l({},r.config,_));const x=new fa(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return x.setEventedParent(this.map,{style:x}),x}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,s){const p=r.indoor?kp(r.schema):r.schema;if(this._isInternalStyle(r)){const S=i.l({},Qu,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(S,s)}if(this.updateConfig(this._config,p),s&&Gl(this,Ao(r)))return;this._loaded=!0,this.stylesheet=i.cp(r);const _=()=>{for(const $ in r.sources)this.addSource($,r.sources[$],{validate:!1,isInitialLoad:!0});r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const S=Mh(this.stylesheet.layers);if(this._order=S.map($=>$.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const $=this.stylesheet.lights[0];this.light=new ae($.properties,$.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ae(this.stylesheet.light)),this._layers={};for(const $ of S){const B=i.cu($,this.scope,this._styleColorTheme.lut,this.options);B.configDependencies.size!==0&&this._configDependentLayers.add(B.fqid),B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B;const j=this.getOwnLayerSourceCache(B),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&B.canCastShadows()&&U&&(j.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const I=this.stylesheet.terrain;I&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(I,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const R=this.isRootStyle();r.imports?this._loadImports(r.imports,s).then(()=>{this._reloadImports(),this.fire(new i.z(R?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(R?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const S=this._evaluateColorThemeData(x);this._loadColorTheme(S).then(()=>{_()}).catch(I=>{i.w(`Couldn't load color theme from the stylesheet: ${I}`),_()})}else this._styleColorTheme.lut=null,_()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,s,p,_,x,S,I,R,$,B;const j={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(U=>{if(U.stylesheet){if(U.light!=null&&(r=U.light),U.stylesheet.lights)for(const q of U.stylesheet.lights)q.type==="ambient"&&U.ambientLight!=null&&(s=U.ambientLight),q.type==="directional"&&U.directionalLight!=null&&(p=U.directionalLight);_=this._prioritizeTerrain(_,U.terrain,U.stylesheet.terrain),U.stylesheet.fog&&U.fog!=null&&(x=U.fog),U.stylesheet.snow&&U.snow!=null&&(S=U.snow),U.stylesheet.rain&&U.rain!=null&&(I=U.rain),U.stylesheet.camera!=null&&(B=U.stylesheet.camera),U.stylesheet.projection!=null&&(R=U.stylesheet.projection),U.stylesheet.transition!=null&&($=U.stylesheet.transition),j[U.scope]=U._styleColorTheme}}),this.light=r,this.ambientLight=s,this.directionalLight=p,this.fog=x,this.snow=S,this.rain=I,this._styleColorThemeForScope=j,_===null?delete this.terrain:this.terrain=_,this.camera=B||{"camera-projection":"perspective"},this.projection=R||{name:"mercator"},this.transition=i.l({},V_,$),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const s=p=>{for(const _ of p.fragments)s(_.style);r(p)};s(this)}_prioritizeTerrain(r,s,p){const _=r&&r.drapeRenderMode===0;return p===null?s&&s.drapeRenderMode===0?s:_?r:null:s!=null&&(!r||_||s&&s.drapeRenderMode===1)?s:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{r=this._prioritizeTerrain(r,s.terrain,s.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(s=>{s.stylesheet.projection!=null&&(r=s.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},s={},p={};this.forEachFragmentStyle(_=>{for(const x in _._sourceCaches){const S=i.aC(x,_.scope);r[S]=_._sourceCaches[x]}for(const x in _._otherSourceCaches){const S=i.aC(x,_.scope);s[S]=_._otherSourceCaches[x]}for(const x in _._symbolSourceCaches){const S=i.aC(x,_.scope);p[S]=_._symbolSourceCaches[x]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},s=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(x=>{for(const S of x._order){const I=x._layers[S];if(I.type==="slot"){const R=i.cq(S);if(r[R])continue;r[R]=[]}I.slot&&r[I.slot]?r[I.slot].push(I):s.push(I)}}),this._mergedOrder=[];const _=(x=[])=>{for(const S of x)if(S.type==="slot"){const I=i.cq(S.id);r[I]&&_(r[I]),this._mergedSlots.push(I)}else{const I=i.aC(S.id,S.scope);this._mergedOrder.push(I),p[I]=S,S.is3D()&&(this._has3DLayers=!0),S.type==="circle"&&(this._hasCircleLayers=!0),S.type==="symbol"&&(this._hasSymbolLayers=!0),S.type==="clip"&&(this._clipLayerPresent=!0)}};_(s),this._mergedOrder.sort((x,S)=>{const I=p[x],R=p[S];return I.hasInitialOcclusionOpacityProperties?R.is3D()?1:0:I.is3D()&&R.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(s,p,_){const x=i.l({},p);for(const I of Object.keys(i.a3.colorTheme))x[I]===void 0&&(x[I]=i.a3.colorTheme[I].default);const S=new i.a4(qx,s,new Map(_));return S.setTransitionOrValue(x,_),S.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const s=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,_)=>{const x="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let S=r;S.startsWith(x)||(S=x+S);const I="mapbox-reserved-lut",R=new Image;R.src=S,R.onerror=()=>{this._styleColorTheme.lutLoading=!1,_(new Error("Failed to load image data"))},R.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==s)return void p();this._styleColorTheme.lutLoading=!1;const{width:$,height:B,data:j}=i.q.getImageData(R);if(B>32)return void _(new Error("The height of the image must be less than or equal to 32 pixels."));if($!==B*B)return void _(new Error("The width of the image must be equal to the height squared."));this.getImage(I)&&this.removeImage(I),this.addImage(I,{data:new i.r({width:$,height:B},j),pixelRatio:1,sdf:!1,usvg:!1,version:0});const U=this.imageManager.getImage(I,this.scope);U?(this._styleColorTheme.lut={image:U.data,data:r},p()):_(new Error("Missing LUT image."))}})}getLut(r){const s=this._styleColorThemeForScope[r];return s?s.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(s,p,_){let x,S,I;const R=i.q.devicePixelRatio>1?"@2x":"";let $=i.n(p.transformRequest(p.normalizeSpriteURL(s,R,".json"),i.R.SpriteJSON),(U,q)=>{$=null,I||(I=U,x=q,j())}),B=i.o(p.transformRequest(p.normalizeSpriteURL(s,R,".png"),i.R.SpriteImage),(U,q)=>{B=null,I||(I=U,S=q,j())});function j(){if(I)_(I);else if(x&&S){const U=i.q.getImageData(S),q={};for(const ce in x){const{width:ie,height:he,x:de,y:ve,sdf:Me,pixelRatio:Te,stretchX:Be,stretchY:Pe,content:Le}=x[ce],Ae=new i.r({width:ie,height:he});i.r.copy(U,Ae,{x:de,y:ve},{x:0,y:0},{width:ie,height:he},null),q[ce]={data:Ae,pixelRatio:Te,sdf:Me,stretchX:Be,stretchY:Pe,content:Le,usvg:!1}}_(null,q)}}return{cancel(){$&&($.cancel(),$=null),B&&(B.cancel(),B=null)}}}(r,this.map._requestManager,(s,p)=>{if(this._spriteRequest=null,s)this.fire(new i.y(s));else if(p)for(const _ in p)this.imageManager.addImage(_,this.scope,p[_]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(r){if(!i.f(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const s=this.map._spriteFormat==="auto";var p,_;this._spriteRequest=(_=(x,S)=>{if(this._spriteRequest=null,x)s?this._loadSprite(r):this.fire(new i.y(x));else if(S)for(const I in S)this.imageManager.addImage(I,this.scope,S[I]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((p=this.map._requestManager).transformRequest(p.normalizeIconsetURL(r),i.R.Iconset),(x,S)=>{if(x)return void _(x);const I={},R=i.cg(new i.bh(S));for(const $ of R.icons){const B={version:1,pixelRatio:i.q.devicePixelRatio,content:Zx($),stretchX:$.metadata?k_($.metadata.stretch_x_areas):void 0,stretchY:$.metadata?k_($.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:$};I[$.name]=B}_(null,I)}))}_validateLayer(r){const s=this.getOwnSource(r.source);if(!s)return;const p=r.sourceLayer;p&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(p)===-1)&&this.fire(new i.y(new Error(`Source layer "${p}" does not exist on source "${s.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,s)=>{const p=this.fragments[s];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const s in this._sourceCaches){const p=this._sourceCaches[s].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const s=[];for(const p of r){const _=this._layers[p];_&&_.type!=="custom"&&s.push(_.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const s=this.getOwnLayer(r);if(s)return s;this.fire(new i.y(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const s=this.getOwnSource(r);if(s)return s;this.fire(new i.y(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,s){const p=this.map.painter;if(p)for(let _=r.minzoom||0;_<(r.maxzoom||25.5);_++){const x=r.getProgramIds();if(x)for(const S of x){const I=r.getDefaultProgramParams(S,s.zoom,this._styleColorTheme.lut);I&&(p.style=this,this.fog&&(p._fogVisible=!0,I.overrideFog=!0,p.getOrCreateProgram(S,I)),p._fogVisible=!1,I.overrideFog=!1,p.getOrCreateProgram(S,I),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(I.overrideRtt=!0,p.getOrCreateProgram(S,I)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const s=this.calculateLightsBrightness();r.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s));const p=this._changes.isDirty();let _=!1;if(this._changes.isDirty()){const S=this._changes.getLayerUpdatesByScope();for(const I in S){const{updatedIds:R,removedIds:$}=S[I];(R||$)&&(this._updateWorkerLayers(I,R,$),_=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const x={};for(const S in this._mergedSourceCaches){const I=this._mergedSourceCaches[S];x[S]=I.used,I.used=!1,I.tileCoverLift=0}for(const S of this._mergedOrder){const I=this._mergedLayers[S];if(I.recalculate(r,this._availableImages),!I.isHidden(r.zoom)){const R=this.getLayerSourceCache(I);R&&(R.used=!0,R.tileCoverLift=Math.max(R.tileCoverLift,I.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(I,r)}):this.precompilePrograms(I,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&_&&this.mergeLayers();for(const S in x){const I=this._mergedSourceCaches[S];x[S]!==I.used&&I.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,s,p){const _=this.getFragmentStyle(r);_&&this.dispatcher.broadcast("updateLayers",{layers:s?_._serializeLayers(s):[],scope:r,removedIds:p||[],options:_.options})}setState(r,s){if(this._checkLoaded(),Gl(this,Ao(r)))return!1;(r=i.cp(r)).layers=Mh(r.layers);const p=function(S,I){if(!S)return[{command:qn.setStyle,args:[I]}];let R=[];try{if(!i.bn(S.version,I.version))return[{command:qn.setStyle,args:[I]}];if(i.bn(S.center,I.center)||R.push({command:qn.setCenter,args:[I.center]}),i.bn(S.zoom,I.zoom)||R.push({command:qn.setZoom,args:[I.zoom]}),i.bn(S.bearing,I.bearing)||R.push({command:qn.setBearing,args:[I.bearing]}),i.bn(S.pitch,I.pitch)||R.push({command:qn.setPitch,args:[I.pitch]}),i.bn(S.sprite,I.sprite)||R.push({command:qn.setSprite,args:[I.sprite]}),i.bn(S.glyphs,I.glyphs)||R.push({command:qn.setGlyphs,args:[I.glyphs]}),i.bn(S.imports,I.imports)||function(q=[],ce=[],ie){ce=ce||[];const he=(q=q||[]).map(uo),de=ce.map(uo),ve=q.reduce(Ss,{}),Me=ce.reduce(Ss,{}),Te=he.slice();let Be,Pe,Le,Ae;for(Be=0,Pe=0;Be<he.length;Be++)Le=he[Be],Me.hasOwnProperty(Le)?Pe++:(ie.push({command:qn.removeImport,args:[Le]}),Te.splice(Te.indexOf(Le,Pe),1));for(Be=0,Pe=0;Be<de.length;Be++)Le=de[de.length-1-Be],Te[Te.length-1-Be]!==Le&&(ve.hasOwnProperty(Le)?(ie.push({command:qn.removeImport,args:[Le]}),Te.splice(Te.lastIndexOf(Le,Te.length-Pe),1)):Pe++,Ae=Te[Te.length-Be],ie.push({command:qn.addImport,args:[Me[Le],Ae]}),Te.splice(Te.length-Be,0,Le));for(const Ue of ce){const tt=ve[Ue.id];tt&&!i.bn(tt,Ue)&&ie.push({command:qn.updateImport,args:[Ue.id,Ue]})}}(S.imports,I.imports,R),i.bn(S.transition,I.transition)||R.push({command:qn.setTransition,args:[I.transition]}),i.bn(S.light,I.light)||R.push({command:qn.setLight,args:[I.light]}),i.bn(S.fog,I.fog)||R.push({command:qn.setFog,args:[I.fog]}),i.bn(S.snow,I.snow)||R.push({command:qn.setSnow,args:[I.snow]}),i.bn(S.rain,I.rain)||R.push({command:qn.setRain,args:[I.rain]}),i.bn(S.projection,I.projection)||R.push({command:qn.setProjection,args:[I.projection]}),i.bn(S.lights,I.lights)||R.push({command:qn.setLights,args:[I.lights]}),i.bn(S.camera,I.camera)||R.push({command:qn.setCamera,args:[I.camera]}),!i.bn(S["color-theme"],I["color-theme"]))return[{command:qn.setStyle,args:[I]}];const $={},B=[];(function(q,ce,ie,he){let de;for(de in ce=ce||{},q=q||{})q.hasOwnProperty(de)&&(ce.hasOwnProperty(de)||Bl(de,ie,he));for(de in ce){if(!ce.hasOwnProperty(de))continue;const ve=ce[de];q.hasOwnProperty(de)?i.bn(q[de],ve)||(q[de].type==="geojson"&&ve.type==="geojson"&&wr(q,ce,de)?ie.push({command:qn.setGeoJSONSourceData,args:[de,ve.data]}):pn(de,ce,ie,he)):Ih(de,ce,ie)}})(S.sources,I.sources,B,$);const j=[];S.layers&&S.layers.forEach(q=>{q.source&&$[q.source]?R.push({command:qn.removeLayer,args:[q.id]}):j.push(q)});let U=S.terrain;U&&$[U.source]&&(R.push({command:qn.setTerrain,args:[void 0]}),U=void 0),R=R.concat(B),i.bn(U,I.terrain)||R.push({command:qn.setTerrain,args:[I.terrain]}),function(q,ce,ie){ce=ce||[];const he=(q=q||[]).map(uo),de=ce.map(uo),ve=q.reduce(Ss,{}),Me=ce.reduce(Ss,{}),Te=he.slice(),Be=Object.create(null);let Pe,Le,Ae,Ue,tt,gt,ct;for(Pe=0,Le=0;Pe<he.length;Pe++)Ae=he[Pe],Me.hasOwnProperty(Ae)?Le++:(ie.push({command:qn.removeLayer,args:[Ae]}),Te.splice(Te.indexOf(Ae,Le),1));for(Pe=0,Le=0;Pe<de.length;Pe++)Ae=de[de.length-1-Pe],Te[Te.length-1-Pe]!==Ae&&(ve.hasOwnProperty(Ae)?(ie.push({command:qn.removeLayer,args:[Ae]}),Te.splice(Te.lastIndexOf(Ae,Te.length-Le),1)):Le++,gt=Te[Te.length-Pe],ie.push({command:qn.addLayer,args:[Me[Ae],gt]}),Te.splice(Te.length-Pe,0,Ae),Be[Ae]=!0);for(Pe=0;Pe<de.length;Pe++)if(Ae=de[Pe],Ue=ve[Ae],tt=Me[Ae],!Be[Ae]&&!i.bn(Ue,tt))if(i.bn(Ue.source,tt.source)&&i.bn(Ue["source-layer"],tt["source-layer"])&&i.bn(Ue.type,tt.type)){for(ct in ir(Ue.layout,tt.layout,ie,Ae,null,qn.setLayoutProperty),ir(Ue.paint,tt.paint,ie,Ae,null,qn.setPaintProperty),i.bn(Ue.slot,tt.slot)||ie.push({command:qn.setSlot,args:[Ae,tt.slot]}),i.bn(Ue.filter,tt.filter)||ie.push({command:qn.setFilter,args:[Ae,tt.filter]}),i.bn(Ue.minzoom,tt.minzoom)&&i.bn(Ue.maxzoom,tt.maxzoom)||ie.push({command:qn.setLayerZoomRange,args:[Ae,tt.minzoom,tt.maxzoom]}),Ue)Ue.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?ir(Ue[ct],tt[ct],ie,Ae,ct.slice(6),qn.setPaintProperty):i.bn(Ue[ct],tt[ct])||ie.push({command:qn.setLayerProperty,args:[Ae,ct,tt[ct]]}));for(ct in tt)tt.hasOwnProperty(ct)&&!Ue.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?ir(Ue[ct],tt[ct],ie,Ae,ct.slice(6),qn.setPaintProperty):i.bn(Ue[ct],tt[ct])||ie.push({command:qn.setLayerProperty,args:[Ae,ct,tt[ct]]}))}else ie.push({command:qn.removeLayer,args:[Ae]}),gt=Te[Te.lastIndexOf(Ae)+1],ie.push({command:qn.addLayer,args:[tt,gt]})}(j,I.layers,R)}catch($){console.warn("Unable to compute style diff:",$),R=[{command:qn.setStyle,args:[I]}]}return R}(this.serialize(),r).filter(S=>!(S.command in N_));if(p.length===0)return!1;const _=p.filter(S=>!(S.command in Yx));if(_.length>0)throw new Error(`Unimplemented: ${_.map(S=>S.command).join(", ")}.`);const x=[];return p.forEach(S=>{x.push(this[S.command].apply(this,S.args))}),s&&Promise.all(x).then(s),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,s){return this.getImage(r)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,s),this._afterImageUpdated(r),this)}updateImage(r,s,p=!1){this.imageManager.updateImage(r,this.scope,s),p&&this._afterImageUpdated(r)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,s,p={}){return this._checkLoaded(),this._validate(Fl,`models.${r}`,s,null,p)||(this.modelManager.addModel(r,s,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,s,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(Ua,`sources.${r}`,s,null,p))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const _=So(r,s,this.dispatcher,this);_.scope=this.scope,_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(_.id),source:_.serialize(),sourceId:_.id}));const x=S=>{const I=(S?"symbol:":"other:")+_.id,R=i.aC(I,this.scope),$=this._sourceCaches[I]=new da(R,_,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[_.id]=$,$.onAdd(this.map)};x(!1),s.type!=="vector"&&s.type!=="geojson"||x(!0),_.onAdd&&_.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const s=this.getOwnSource(r);if(!s)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(r);for(const _ of p){const x=i.cq(_.id);delete this._sourceCaches[x],this._changes.discardSourceCacheUpdate(_.id),_.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,s){this._checkLoaded(),this.getOwnSource(r).setData(s),this._changes.setDirty()}getOwnSource(r){const s=this.getOwnSourceCache(r);return s&&s.getSource()}getOwnSources(){const r=[];for(const s in this._otherSourceCaches){const p=this.getOwnSourceCache(s);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const s in r){const p=r[s]._tiles;for(const _ in p){const x=p[_];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const _ of r){if(this._validate(Rl,"lights",_))return;switch(_.type){case"ambient":if(this.ambientLight){const x=this.ambientLight;x.set(_),x.updateTransitions(s)}else this.ambientLight=new An(_,jt||(jt=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const x=this.directionalLight;x.set(_),x.updateTransitions(s)}else this.directionalLight=new An(_,Wt||(Wt=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new i.a8(this.z||0,s);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,s=this.ambientLight;if(!r||!s)return;const p=U=>.2126*(U[0]<=.03928?U[0]/12.92:Math.pow((U[0]+.055)/1.055,2.4))+.7152*(U[1]<=.03928?U[1]/12.92:Math.pow((U[1]+.055)/1.055,2.4))+.0722*(U[2]<=.03928?U[2]/12.92:Math.pow((U[2]+.055)/1.055,2.4)),_=r.properties.get("color").toRenderColor(null).toArray01(),x=r.properties.get("intensity"),S=r.properties.get("direction"),I=1-i.cb(S.x,S.y,S.z)[2]/90,R=p(_)*x*I,$=s.properties.get("color").toRenderColor(null).toArray01(),B=s.properties.get("intensity"),j=p($)*B;return Number(((R+j)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(i.cr(r)){const s=i.cs(r),p=this.fragments.find(({id:x})=>x===s);if(!p)throw new Error(`Style import '${r}' not found`);const _=i.cq(r);return p.style.getFragmentStyle(_)}{const s=this.fragments.find(({id:p})=>p===r);return s?s.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const s={},p=(_,x="")=>`${_}::${x}`;this._featuresetSelectors={};for(const _ in r){const x=this._featuresetSelectors[_]=[];for(const S of r[_].selectors){if(S.featureNamespace){const R=this.getOwnLayer(S.layer);if(!R){i.w(`Layer is undefined for selector: ${S.layer}`);continue}const $=p(R.source,R.sourceLayer);if($ in s&&s[$]!==S.featureNamespace){i.w(`"featureNamespace ${S.featureNamespace} of featureset ${_}'s selector is not associated to the same source, skip this selector`);continue}s[$]=S.featureNamespace}let I;if(S.properties)for(const R in S.properties){const $=i.U(S.properties[R]);$.result==="success"&&(I=I||{},I[R]=$.value)}x.push({layerId:S.layer,namespace:S.featureNamespace,properties:I,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const s=this.getFragmentStyle(r);if(!s||!s.stylesheet.featuresets)return[];const p=[];for(const _ in s.stylesheet.featuresets)p.push({featuresetId:_,importId:s.scope?s.scope:void 0});return p}getFeaturesetLayers(r,s){const p=this.getFragmentStyle(s),_=p.stylesheet.featuresets;if(!_||!_[r])return this.fire(new i.y(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const x=[];for(const S of _[r].selectors){const I=p.getOwnLayer(S.layer);I&&x.push(I)}return x}getConfigProperty(r,s){const p=this.getFragmentStyle(r);if(!p)return null;const _=i.aC(s,p.scope),x=p.options.get(_),S=x?x.value||x.default:null;return S?S.serialize():null}setConfigProperty(r,s,p){const _=this.getFragmentStyle(r);if(!_)return;const x=_.stylesheet.indoor?kp(_.stylesheet.schema):_.stylesheet.schema;if(!x||!x[s])return;const S=i.U(p);if(S.result!=="success")return void Gl(this,S.value);const I=S.value.expression,R=i.aC(s,_.scope),$=_.options.get(R);if(!$)return;let B;const{minValue:j,maxValue:U,stepValue:q,type:ce,values:ie}=x[s],he=i.U(x[s].default);he.result==="success"&&(B=he.value.expression),B?(this.options.set(R,Object.assign({},$,{value:I,default:B,minValue:j,maxValue:U,stepValue:q,type:ce,values:ie})),this.updateConfigDependencies(s)):this.fire(new i.y(new Error(`No schema defined for the config option "${s}" in the "${r}" fragment.`)))}getConfig(r){const s=this.getFragmentStyle(r);if(!s)return null;const p=s.stylesheet.schema;if(!p)return null;const _={};for(const x in p){const S=i.aC(x,s.scope),I=s.options.get(S),R=I?I.value||I.default:null;_[x]=R?R.serialize():null}return _}setConfig(r,s){const p=this.getFragmentStyle(r);p&&(p.updateConfig(s,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const s=this.getFragmentStyle(r);return s?s.stylesheet.schema:null}setSchema(r,s){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=s,p.updateConfig(p._config,s),this.updateConfigDependencies())}updateConfig(r,s){if(this._config=r,r||s)if(s)for(const p in s){let _,x;const S=i.U(s[p].default);if(S.result==="success"&&(_=S.value.expression),r&&r[p]!==void 0){const U=i.U(r[p]);U.result==="success"&&(x=U.value.expression)}const{minValue:I,maxValue:R,stepValue:$,type:B,values:j}=s[p];if(_){const U=i.aC(p,this.scope);this.options.set(U,{default:_,value:x,minValue:I,maxValue:R,stepValue:$,type:B,values:j})}else this.fire(new i.y(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const s of this._configDependentLayers){const p=this.getLayer(s);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(s=>{const p=s._styleColorTheme.colorThemeOverride?s._styleColorTheme.colorThemeOverride:s._styleColorTheme.colorTheme;if(p){const _=s._evaluateColorThemeData(p);(!s._styleColorTheme.lut&&_!==""||s._styleColorTheme.lut&&_!==s._styleColorTheme.lut.data)&&s.setColorTheme(p)}}),this._changes.setDirty()}addLayer(r,s,p={}){this._checkLoaded();const _=r.id;if(this._layers[_])return void this.fire(new i.y(new Error(`Layer with id "${_}" already exists on this map`)));let x;if(r.type==="custom"){if(Gl(this,i.ct(r)))return;x=i.cu(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=i.cp(r),r=i.l(r,{source:_})),this._validate(Ll,`layers.${_}`,r,{arrayIndex:-1},p))return;x=i.cu(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}})}x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid);let S=this._order.length;if(s){const B=this._order.indexOf(s);if(B===-1)return void this.fire(new i.y(new Error(`Layer with id "${s}" does not exist on this map.`)));x.slot===this._layers[s].slot?S=B:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,_),this._layerOrderChanged=!0,this._layers[_]=x;const I=this.getOwnLayerSourceCache(x),R=!!this.directionalLight&&this.directionalLight.shadowsEnabled();I&&x.canCastShadows()&&R&&(I.castsShadows=!0);const $=this._changes.getRemovedLayer(x);if($&&x.source&&I&&x.type!=="custom"){this._changes.discardLayerRemoval(x);const B=i.aC(x.source,x.scope);$.type!==x.type?this._changes.updateSourceCache(B,"clear"):(this._changes.updateSourceCache(B,"reload"),I.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),x.scope=this.scope,this.mergeLayers()}moveLayer(r,s){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===s)return;const _=this._order.indexOf(r);this._order.splice(_,1);let x=this._order.length;if(s){const S=this._order.indexOf(s);if(S===-1)return void this.fire(new i.y(new Error(`Layer with id "${s}" does not exist on this map.`)));p.slot===this._layers[s].slot?x=S:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(x,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const s=this._checkLayer(r);if(!s)return;s.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const _=this.getOwnLayerSourceCache(s);if(_&&_.castsShadows){let x=!1;for(const S in this._layers)if(this._layers[S].source===s.source&&this._layers[S].canCastShadows()){x=!0;break}_.castsShadows=x}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const s in this._layers)if(this._layers[s].type===r)return!0;return!1}setLayerZoomRange(r,s,p){this._checkLoaded();const _=this._checkLayer(r);_&&(_.minzoom===s&&_.maxzoom===p||(s!=null&&(_.minzoom=s),p!=null&&(_.maxzoom=p),this._updateLayer(_)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,s){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==s&&(p.slot=s,this._updateLayer(p))}setFilter(r,s,p={}){this._checkLoaded();const _=this._checkLayer(r);if(_&&!i.bn(_.filter,s))return s==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(ni,`layers.${_.id}.filter`,s,{layerType:_.type},p)||(_.filter=i.cp(s),this._updateLayer(_)))}getFilter(r){const s=this._checkLayer(r);if(s)return i.cp(s.filter)}setLayoutProperty(r,s,p,_={}){this._checkLoaded();const x=this._checkLayer(r);if(x&&!i.bn(x.getLayoutProperty(s),p)){if(p!=null&&(!_||_.validate!==!1)&&Gl(x,Pc.call(Ao,{key:`layers.${r}.layout.${s}`,layerType:x.type,objectKey:s,value:p,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;x.setLayoutProperty(s,p),x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid),this._updateLayer(x)}}getLayoutProperty(r,s){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(s)}setPaintProperty(r,s,p,_={}){this._checkLoaded();const x=this._checkLayer(r);if(!x||i.bn(x.getPaintProperty(s),p)||p!=null&&(!_||_.validate!==!1)&&Gl(x,$l.call(Ao,{key:`layers.${r}.paint.${s}`,layerType:x.type,objectKey:s,value:p,styleSpec:i.a3})))return;const S=x.setPaintProperty(s,p);x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid),S&&this._updateLayer(x),this._changes.updatePaintProperties(x)}getPaintProperty(r,s){const p=this._checkLayer(r);if(p)return p.getPaintProperty(s)}setFeatureState(r,s){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:R,importId:$}=r.target,B=this.getFragmentStyle($),j=B.getFeaturesetLayers(R);for(const{source:U,sourceLayer:q}of j)B.setFeatureState({id:r.id,source:U,sourceLayer:q},s)}else if("layerId"in r.target){const{layerId:R}=r.target,$=this.getLayer(R);this.setFeatureState({id:r.id,source:$.source,sourceLayer:$.sourceLayer},s)}return}const p=r.source,_=r.sourceLayer,x=this._checkSource(p);if(!x)return;const S=x.type;if(S==="geojson"&&_)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!_)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const I=this.getOwnSourceCaches(p);for(const R of I)R.setFeatureState(_,r.id,s)}removeFeatureState(r,s){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:R,importId:$}=r.target,B=this.getFragmentStyle($),j=B.getFeaturesetLayers(R);for(const{source:U,sourceLayer:q}of j)B.removeFeatureState({id:r.id,source:U,sourceLayer:q},s)}else if("layerId"in r.target){const{layerId:R}=r.target,$=this.getLayer(R);this.removeFeatureState({id:r.id,source:$.source,sourceLayer:$.sourceLayer},s)}return}const p=r.source,_=this._checkSource(p);if(!_)return;const x=_.type,S=x==="vector"?r.sourceLayer:void 0;if(x==="vector"&&!S)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const I=this.getOwnSourceCaches(p);for(const R of I)R.removeFeatureState(S,r.id,s)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let x;if("featuresetId"in r.target){const{featuresetId:S,importId:I}=r.target,R=this.getFragmentStyle(I),$=R.getFeaturesetLayers(S);for(const{source:B,sourceLayer:j}of $){const U=R.getFeatureState({id:r.id,source:B,sourceLayer:j});if(U&&!x)x=U;else if(!i.bn(x,U))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:S}=r.target,I=this.getLayer(S);x=this.getFeatureState({id:r.id,source:I.source,sourceLayer:I.sourceLayer})}return x}const s=r.source,p=r.sourceLayer,_=this._checkSource(s);if(_){if(_.type!=="vector"||p)return r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(p,r.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),s=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(r){for(const s of Object.values(this._mergedLayers))r(s)&&this._updateLayer(s)}_updateLayer(r){this._changes.updateLayer(r);const s=this.getLayerSourceCache(r),p=i.aC(r.source,r.scope),_=this._changes.getUpdatedSourceCaches();r.source&&!_[p]&&s&&s.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),s.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const s=I=>this._mergedLayers[I].is3D(),p=this.order,_={},x=[];for(let I=p.length-1;I>=0;I--){const R=p[I];if(s(R)){_[R]=I;for(const $ of r){const B=$[R];if(B)for(const j of B)x.push(j)}}}x.sort((I,R)=>R.intersectionZ-I.intersectionZ);const S=[];for(let I=p.length-1;I>=0;I--){const R=p[I];if(s(R))for(let $=x.length-1;$>=0;$--){const B=x[$].feature;if(B.layer&&_[B.layer.id]<I)break;S.push(B),x.pop()}else for(const $ of r){const B=$[R];if(B)for(const j of B)S.push(j.feature)}}return S}queryRenderedFeatures(r,s,p){let _;s&&!Array.isArray(s)&&s.filter&&(this._validate(ni,"queryRenderedFeatures.filter",s.filter,null,s),_=i.aZ(s.filter));const x={},S=B=>{if(Vp.has(B.type))return;const j=this.getOwnLayerSourceCache(B),U=x[j.id]=x[j.id]||{sourceCache:j,layers:{},has3DLayers:!1};B.is3D()&&(U.has3DLayers=!0),U.layers[B.fqid]=U.layers[B.fqid]||{styleLayer:B,targets:[]},U.layers[B.fqid].targets.push({filter:_})};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const B of s.layers){const j=this._layers[B];if(!j)return this.fire(new i.y(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];S(j)}}else for(const B in this._layers)S(this._layers[B]);const I=this._queryRenderedFeatures(r,x,p),R=this._flattenAndSortRenderedFeatures(I),$=[];for(const B of R)i.cs(B.layer.id)===this.scope&&$.push(B);return $}queryRenderedFeatureset(r,s,p){let _;s&&!Array.isArray(s)&&s.filter&&(this._validate(ni,"queryRenderedFeatures.filter",s.filter,null,s),_=i.aZ(s.filter));const x="mock",S=[];if(s&&s.target)S.push(Object.assign({},s,{targetId:x,filter:_}));else{const B=this.getFeaturesetDescriptors();for(const j of B)S.push({targetId:x,filter:_,target:j});for(const{style:j}of this.fragments){const U=j.getFeaturesetDescriptors();for(const q of U)S.push({targetId:x,filter:_,target:q})}}const I=this.queryRenderedTargets(r,S,p),R=[],$=new Set;for(const B of I)for(const j of B.variants[x])bs(j,B,$)||R.push(new i.cw(B,j));return R}queryRenderedTargets(r,s,p){const _={},x=(I,R,$,B)=>{const j=_[R.id]=_[R.id]||{sourceCache:R,layers:{},has3DLayers:!1};if(j.layers[I.fqid]=j.layers[I.fqid]||{styleLayer:I,targets:[]},I.is3D()&&(j.has3DLayers=!0),!B)return $.uniqueFeatureID=!1,void j.layers[I.fqid].targets.push($);j.layers[I.fqid].targets.push(Object.assign({},$,{namespace:B.namespace,properties:B.properties,uniqueFeatureID:B.uniqueFeatureID}))};for(const I of s)if("featuresetId"in I.target){const{featuresetId:R,importId:$}=I.target,B=this.getFragmentStyle($);if(!B||!B._featuresetSelectors)continue;const j=B._featuresetSelectors[R];if(!j){this.fire(new i.y(new Error(`The featureset '${R}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const U of j){const q=B.getOwnLayer(U.layerId);q&&!Vp.has(q.type)&&x(q,B.getOwnLayerSourceCache(q),I,U)}}else if("layerId"in I.target){const{layerId:R}=I.target,$=this.getLayer(R);if(!$||Vp.has($.type))continue;x($,this.getLayerSourceCache($),I)}const S=this._queryRenderedFeatures(r,_,p);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(r,s,p){const _=[],x=!!this.map._showQueryGeometry,S=Mn.createFromScreenPoints(r,p);for(const I in s){const R=Vu(S,s[I],this._availableImages,p,x);Object.keys(R).length&&_.push(R)}if(this.placement)for(const I in s){if(!s[I].sourceCache._onlySymbols)continue;const R=xp(S.screenGeometry,s[I],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(R).length&&_.push(R)}return _}querySourceFeatures(r,s){const p=s&&s.filter;p&&this._validate(ni,"querySourceFeatures.filter",p,null,s);let _=[];const x=this.getOwnSourceCaches(r);for(const S of x)_=_.concat(z_(S,s));return _}addSourceType(r,s,p){return fa.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(fa.setSourceType(r,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:s.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,s,p={}){this._checkLoaded();const _=this.light.getLight();let x=!1;for(const I in r)if(!i.bn(r[I],_[I])){x=!0;break}if(!x)return;const S=this._getTransitionParameters();this.light.setLight(r,s,p),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,s=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),s===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const _=r.source==null;if(s===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const I="terrain-dem-src";this.addSource(I,p.source),p=i.cp(p),p=i.l(p,{source:I})}const x=i.l({},p),S={};if(this.terrain&&_){x.source=this.terrain.get().source;const I=this.terrain?this.getFragmentStyle(this.terrain.scope):null;I&&(S.style=I.serialize())}if(this._validate(zl,"terrain",x,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!_||this.terrain&&s!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,s),this.fire(new i.z("data",{dataType:"style"}))}else{const x=this.terrain,S=x.get();for(const I of Object.keys(i.a3.terrain))!p.hasOwnProperty(I)&&i.a3.terrain[I].default&&(p[I]=i.a3.terrain[I].default);for(const I in r)if(!i.bn(r[I],S[I])){x.set(r,this.options),this.stylesheet.terrain=r;const R=this._getTransitionParameters({duration:0});x.updateTransitions(R),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const s=this.fog=new dt(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_createSnow(r){const s=this.snow=new bn(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_createRain(r){const s=this.rain=new In(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!i.bn(s.get(),r)){s.set(r,this.options),this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const s=this.snow;if(!i.bn(s.get(),r)){s.set(r,this.options),this.stylesheet.snow=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const s=this.rain;if(!i.bn(s.get(),r)){s.set(r,this.options),this.stylesheet.rain=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const _ in this._layers)this._layers[_].lut=this._styleColorTheme.lut;for(const _ in this._sourceCaches)this._sourceCaches[_].clearTiles()},s=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!s)return this._styleColorTheme.lut=null,void r();const p=this._evaluateColorThemeData(s);this._loadColorTheme(p).then(()=>{this.fire(new i.z("colorthemeset")),r()}).catch(_=>{i.w(`Couldn't set color theme: ${_}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,s){const p=this.getFragmentStyle(r);p&&(p._styleColorTheme.colorThemeOverride=s,p._reloadColorTheme())}_getTransitionParameters(r){return{now:i.q.now(),transition:i.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],s=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):s.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...s)}_createTerrain(r,s){const p=this.terrain=new pe(r,s,this.scope,this.options);s===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const _=this._getTransitionParameters({duration:0});p.updateTransitions(_)}_force3DLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="symbol"&&this._updateLayer(s)}}_validate(r,s,p,_,x={}){if(x&&x.validate===!1)return!1;const S=i.l({},this.serialize());return Gl(this,r.call(Ao,i.l({key:s,style:S,value:p,styleSpec:i.a3},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const s=this.getSourceCaches(r);for(const p of s)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const s=this.getSourceCaches(r);for(const p of s)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let s;this.directionalLight&&(s=Hl(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(r,void 0,void 0,s)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const s=this._sourceCaches[r];s.resume(),s.reload()}}_updatePlacement(r,s,p,_,x,S,I=!1){let R=!1,$=!1;const B={},j={};for(const U of this._mergedOrder){const q=this._mergedLayers[U];if(q.type!=="symbol")continue;const ce=i.aC(q.source,q.scope);let ie=B[ce];if(!ie){const de=this.getLayerSourceCache(q);if(!de)continue;const ve=de.getRenderableIds(!0).map(Me=>de.getTileByID(Me));j[ce]=ve.slice(),ie=B[ce]=ve.sort((Me,Te)=>Te.tileID.overscaledZ-Me.tileID.overscaledZ||(Me.tileID.isLessThan(Te.tileID)?-1:1))}const he=this.crossTileSymbolIndex.addLayer(q,ie,s.center.lng,s.projection);R=R||he}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),I=I||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),s.zoom))&&(this.pauseablePlacement=new Ux(s,this._mergedOrder,I,p,_,x,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,B,j,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),$=!0),R&&this.pauseablePlacement.placement.setStale()),$||R){this._buildingIndex.onNewFrame(s.zoom);for(let U=0;U<this._mergedOrder.length;U++){const q=this._mergedLayers[this._mergedOrder[U]];if(q.type!=="symbol")continue;const ce=this.isLayerClipped(q);this.placement.updateLayerOpacities(q,B[i.aC(q.source,q.scope)],U,ce?S:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,s){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:x})=>x===r.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!s)return p.push(r),this._loadImports([r],!0);const _=p.findIndex(({id:x})=>x===s);return _===-1&&this.fire(new i.y(new Error(`Import with id "${s}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,_).concat(r).concat(p.slice(_)),this._loadImports([r],!0,s)}updateImport(r,s){this._checkLoaded();const p=this.stylesheet.imports||[],_=this.getImportIndex(r);return _===-1?this:typeof s=="string"?(this.setImportUrl(r,s),this):(s.url&&s.url!==p[_].url&&this.setImportUrl(r,s.url),i.bn(s.config,p[_].config)||this.setImportConfig(r,s.config,s.data.schema),i.bn(s.data,p[_].data)||this.setImportData(r,s.data),this)}moveImport(r,s){this._checkLoaded();let p=this.stylesheet.imports||[];const _=this.getImportIndex(r);if(_===-1)return this;const x=this.getImportIndex(s);if(x===-1)return this;const S=p[_],I=this.fragments[_];return p=p.filter(({id:R})=>R!==r),this.fragments=this.fragments.filter(({id:R})=>R!==r),this.stylesheet.imports=p.slice(0,x).concat(S).concat(p.slice(x)),this.fragments=this.fragments.slice(0,x).concat(I).concat(this.fragments.slice(x)),this.mergeLayers(),this}setImportUrl(r,s){this._checkLoaded();const p=this.stylesheet.imports||[],_=this.getImportIndex(r);if(_===-1)return this;p[_].url=s;const x=this.fragments[_];return x.style=this._createFragmentStyle(p[_]),x.style.on("style.import.load",()=>this.mergeAll()),x.style.loadURL(s),this}setImportData(r,s){this._checkLoaded();const p=this.getImportIndex(r),_=this.stylesheet.imports||[];return p===-1?this:s?(this.fragments[p].style.setState(s),this._reloadImports(),this):(delete _[p].data,this.setImportUrl(r,_[p].url))}setImportConfig(r,s,p){this._checkLoaded();const _=this.getImportIndex(r),x=this.stylesheet.imports||[];if(_===-1)return this;s?x[_].config=s:delete x[_].config;const S=this.fragments[_];p&&S.style.stylesheet&&(S.style.stylesheet.schema=p);const I=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=s,S.style.updateConfig(s,I),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const s=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(s.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const s=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return s===-1&&this.fire(new i.y(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),s}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const s in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[s];p&&r.push(p.getSource())}return r}getSource(r,s){const p=this.getSourceCache(r,s);return p&&p.getSource()}getLayerSource(r){const s=this.getLayerSourceCache(r);return s&&s.getSource()}getSourceCache(r,s){const p=i.aC(r,s);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const s=i.aC(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const s=[];return this._mergedOtherSourceCaches[r]&&s.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&s.push(this._mergedSymbolSourceCaches[r]),s}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const s in r){const p=r[s];p==="reload"?this.reloadSource(s):p==="clear"&&this.clearSource(s)}}updateLayers(r){const s=this._changes.getUpdatedPaintProperties();for(const p of s){const _=this.getLayer(p);_&&_.updateTransitions(r)}}getImages(r,s,p){this.imageManager.getImages(s.icons,s.scope,p),this._updateTilesForChangedImages();const _=x=>{x&&x.setDependencies(s.tileID.key,s.type,s.icons)};_(this._otherSourceCaches[s.source]),_(this._symbolSourceCaches[s.source])}rasterizeImages(r,s,p){this.imageManager.rasterizeImages(s,p)}getGlyphs(r,s,p){this.glyphManager.getGlyphs(s.stacks,s.scope,p)}getResource(r,s,p){return i.cy(s,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const s=[];return this._otherSourceCaches[r]&&s.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&s.push(this._symbolSourceCaches[r]),s}_isSourceCacheLoaded(r){const s=this.getOwnSourceCaches(r);return s.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${r}'`))),!1):s.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,s){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(p||s&&s.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}fa.getSourceType=function(f){return ki[f]},fa.setSourceType=function(f,r){ki[f]=r},fa.registerForPluginStateChange=i.ch;var $h=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,ed=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Fh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,rl="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Bh=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,jp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Wl=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,zc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,td=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,nd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,ql=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Zl=[];Yl($h,Zl),Yl(Fh,Zl),Yl(ed,Zl);const Lc={"_prelude_fog.vertex.glsl":jp,"_prelude_terrain.vertex.glsl":Bh,"_prelude_shadow.vertex.glsl":nd,"_prelude_fog.fragment.glsl":Wl,"_prelude_shadow.fragment.glsl":ql,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":zc,"_prelude_raster_particle.glsl":td},rd={};Qn("",Bh),Qn(Wl,jp),Qn(ql,nd),Qn(zc,""),Qn(td,"");const kh=Qn(ed,Fh),id=$h;var $c={background:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Qn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Qn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Qn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Qn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Qn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Qn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Qn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Qn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Qn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Qn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Qn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Qn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Qn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Qn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Qn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Qn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rl),skyboxGradient:Qn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rl),skyboxCapture:Qn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Qn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Qn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Qn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Qn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Qn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Qn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Qn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Qn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Yl(f,r){const s=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of s)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=p.split(" ");for(const x of _)r.includes(x)||r.push(x)}}function Qn(f,r){const s=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let _=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);_&&(_=_.map($=>{const B=$.split(" ");return B[B.length-1]}),_=[...new Set(_)]);const x={},S=[],I=[];if(f=f.replace(s,($,B)=>(I.push(B),"")),(r=r.replace(s,($,B)=>(S.push(B),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let R=[...Zl];Yl(f,R),Yl(r,R);for(const $ of[...S,...I])Lc[$]||console.error(`Undefined include: ${$}`),rd[$]||(rd[$]=[],Yl(Lc[$],rd[$])),R=[...R,...rd[$]];return{fragmentSource:f=f.replace(p,($,B,j,U,q)=>(x[q]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${j} ${U} ${q};
#else
uniform ${j} ${U} u_${q};
#endif
`:B==="initialize"?`
#ifdef HAS_UNIFORM_u_${q}
    ${j} ${U} ${q} = u_${q};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${j} ${U} ${q};
#endif
`:B==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,($,B,j,U,q)=>{const ce=U==="float"?"vec2":U,ie=q.match(/color/)?"color":ce;return B==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${q}
in ${j} ${U} a_${q};
#endif
`:x[q]?B==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${j} ${ce} a_${q};
out ${j} ${U} ${q};
#else
uniform ${j} ${U} u_${q};
#endif
`:B==="initialize"?ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${j} ${U} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ie}(a_${q}, u_${q}_t);
#else
    ${j} ${U} ${q} = u_${q};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${j} ${U} a_${q};
    out ${j} ${U} ${q};
#endif
`:B==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${q} = a_${q};
#endif
`:void 0:B==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${j} ${ce} a_${q};
#else
uniform ${j} ${U} u_${q};
#endif
`:B==="define-instanced"?ie==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${q}0;
in vec4 a_${q}1;
in vec4 a_${q}2;
in vec4 a_${q}3;
#else
uniform ${j} ${U} u_${q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${j} ${ce} a_${q};
#else
uniform ${j} ${U} u_${q};
#endif
`:B==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${j} ${U} ${q} = a_${q};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${j} ${U} ${q} = a_${q};
#else
    ${j} ${U} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${j} ${U} ${q} = unpack_mix_${ie}(a_${q}, u_${q}_t);
#else
    ${j} ${U} ${q} = u_${q};
#endif
`}),staticAttributes:_,usedDefines:R,vertexIncludes:S,fragmentIncludes:I}}class j_{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,s,p,_,x,S,I,R){this.context=r;let $=this.boundPaintVertexBuffers.length!==_.length;for(let j=0;!$&&j<_.length;j++)this.boundPaintVertexBuffers[j]!==_[j]&&($=!0);let B=this.boundDynamicVertexBuffers.length!==I.length;for(let j=0;!B&&j<I.length;j++)this.boundDynamicVertexBuffers[j]!==I[j]&&(B=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==p||$||B||this.boundIndexBuffer!==x||this.boundVertexOffset!==S)this.freshBind(s,p,_,x,S,I,R);else{r.bindVertexArrayOES.set(this.vao);for(const j of I)j&&(j.bind(),R&&j.instanceCount&&j.setVertexAttribDivisor(r.gl,s,R));x&&x.dynamicDraw&&x.bind()}}freshBind(r,s,p,_,x,S,I){const R=r.numAttributes,$=this.context,B=$.gl;this.vao&&this.destroy(),this.vao=$.gl.createVertexArray(),$.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=S,s.enableAttributes(B,r),s.bind(),s.setVertexAttribPointers(B,r,x);for(const j of p)j.enableAttributes(B,r),j.bind(),j.setVertexAttribPointers(B,r,x);for(const j of S)j&&(j.enableAttributes(B,r),j.bind(),j.setVertexAttribPointers(B,r,x),I&&j.instanceCount&&j.setVertexAttribDivisor(B,r,I));_&&_.bind(),$.currentNumAttributes=R}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Fc(f,r){const s=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new i.aa(0,p/s).toLngLat().lat,new i.aa(0,(p+1)/s).toLngLat().lat]}function U_(f,r,s,p,_,x,S){const I=f.context,R=I.gl,$=s.hillshadeFBO;if(!$)return;f.prepareDrawTile();const B=f.isTileAffectedByFog(r),j=f.getOrCreateProgram("hillshade",{overrideFog:B});I.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,$.colorAttachment.get());const U=((he,de,ve,Me)=>{const Te=ve.paint.get("hillshade-shadow-color"),Be=ve.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Pe=ve.paint.get("hillshade-highlight-color"),Le=ve.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ae=ve.paint.get("hillshade-accent-color"),Ue=ve.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",tt=ve.paint.get("hillshade-emissive-strength");let gt=i.ai(ve.paint.get("hillshade-illumination-direction"));if(ve.paint.get("hillshade-illumination-anchor")==="viewport")gt-=he.transform.angle;else if(he.style&&he.style.enable3dLights()&&he.style.directionalLight){const St=he.style.directionalLight.properties.get("direction"),bt=i.cb(St.x,St.y,St.z);gt=i.ai(bt[1])}const ct=!he.options.moving;return{u_matrix:Me||he.transform.calculateProjMatrix(de.tileID.toUnwrapped(),ct),u_image:0,u_latrange:Fc(0,de.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),gt],u_shadow:Te.toRenderColor(Be?null:ve.lut),u_highlight:Pe.toRenderColor(Le?null:ve.lut),u_emissive_strength:tt,u_accent:Ae.toRenderColor(Ue?null:ve.lut)}})(f,s,p,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(I,j,r.toUnwrapped());const{tileBoundsBuffer:q,tileBoundsIndexBuffer:ce,tileBoundsSegments:ie}=f.getTileBoundsBuffers(s);j.draw(f,R.TRIANGLES,_,x,S,Ln.disabled,U,p.id,q,ce,ie)}function H_(f,r,s){if(!r.needsDEMTextureUpload)return;const p=f.context,_=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(s.stride);const x=s.getPixels();r.demTexture?r.demTexture.update(x,{premultiply:!1}):r.demTexture=new i.T(p,x,_.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Xx(f,r,s){const p=f.context,_=p.gl;if(!r.dem)return;const x=r.dem;if(p.activeTexture.set(_.TEXTURE1),H_(f,r,x),!r.demTexture)return;r.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);const S=x.dim;p.activeTexture.set(_.TEXTURE0);let I=r.hillshadeFBO;if(!I){const U=new i.T(p,{width:S,height:S,data:null},_.RGBA8);U.bind(_.LINEAR,_.CLAMP_TO_EDGE),I=r.hillshadeFBO=p.createFramebuffer(S,S,!0,"renderbuffer"),I.colorAttachment.set(U.texture)}p.bindFramebuffer.set(I.framebuffer),p.viewport.set([0,0,S,S]);const{tileBoundsBuffer:R,tileBoundsIndexBuffer:$,tileBoundsSegments:B}=f.getMercatorTileBoundsBuffers(),j=[];f.linearFloatFilteringSupported()&&j.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:j}).draw(f,_.TRIANGLES,Cn.disabled,Rn.disabled,Wn.unblended,Ln.disabled,((U,q)=>{const ce=q.stride,ie=i.ab.mat4.create();return i.ab.mat4.ortho(ie,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(ie,ie,[0,-i.ag,0]),{u_matrix:ie,u_image:1,u_dimension:[ce,ce],u_zoom:U.overscaledZ}})(r.tileID,x),s.id,R,$,B),r.needsHillshadePrepare=!1}class Ur{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Up extends Ur{getDefault(){return i.aj.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Hp extends Ur{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Gp extends Ur{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Wp extends Ur{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class G_ extends Ur{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class W_ extends Ur{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Kx extends Ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class od extends Ur{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class ad extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class q_ extends Ur{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ko extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class qp extends Ur{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Nh extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class Vh extends Ur{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Zp extends Ur{getDefault(){return i.aj.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Yp extends Ur{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class jh extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class Xp extends Ur{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Kp extends Ur{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let Uh=class extends Ur{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Z_ extends Ur{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Y_ extends Ur{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Bc extends Ur{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Jx extends Ur{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Qx extends Ur{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class eb extends Ur{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class tb extends Ur{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class nb extends Ur{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class rb extends Ur{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Jp extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Qp extends Ur{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Hh extends Ur{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class kc extends Hh{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class em extends Hh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class X_ extends Hh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class K_ extends em{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const tm=(f,r,s)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:s}),il=(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:s,u_zoom_transition:_,u_merc_center:x,u_image0:0,u_frustum_tl:S,u_frustum_tr:I,u_frustum_br:R,u_frustum_bl:$,u_globe_pos:B,u_globe_radius:j,u_viewport:U,u_grid_matrix:ie?Float32Array.from(ie):new Float32Array(9),u_skirt_height:q,u_far_z_cutoff:ce});function nm(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const qo=new class{constructor(){this.operations={}}newMorphing(f,r,s,p,_){if(f in this.operations){const x=this.operations[f];x.to.tileID.key!==s.tileID.key&&(x.queued=s)}else this.operations[f]={startTime:p,phase:0,duration:_,from:r,to:s,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const s=this.operations[r];for(s.phase=(f-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Gh={0:null,1:"TERRAIN_VERTEX_MORPHING"};function sd(f,r,s){if(r===0)return 0;const p=r<1&&s===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*p}function J_(f,r){const s=1<<f.z;return!r&&(f.x===0||f.x===s-1)||f.y===0||f.y===s-1}const Wh=f=>({u_matrix:f});function ld(f,r,s,p,_){if(_>0){const x=i.q.now(),S=(x-f.timeAdded)/_,I=r?(x-r.timeAdded)/_:-1,R=s.getSource(),$=p.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),B=!r||Math.abs(r.tileID.overscaledZ-$)>Math.abs(f.tileID.overscaledZ-$),j=B&&f.refreshedUponExpiration?1:i.aw(B?S:1-I,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class rm extends da{constructor(r){const s={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new i.D(i.ci(),null),_=So("mock-dem",s,p,r.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,s){r.state="loaded",s(null)}}class ib extends da{constructor(r){const s=So("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.D(i.ci(),null),r.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,s,p){if(r.freezeTileCoverage)return;this.transform=r;const _=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,S)=>{if(x[S.key]="",!this._tiles[S.key]){const I=new Qs(S,this._source.tileSize*S.overscaleFactor(),r.tileZoom);I.state="loaded",this._tiles[S.key]=I}return x},{});for(const x in this._tiles)x in _||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(r){const s=this.proxyCachedFBO[r];if(s!==void 0){const p=Object.values(s);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class im extends i.aG{constructor(r,s,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=s,this.projMatrix=p}}class Nc extends i.cJ{constructor(r,s){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,_,x]=function(R){const $=new i.b4,B=new i.aU,j=131;$.reserve(17161),B.reserve(33800);const U=i.ag/128,q=i.ag+U/2,ce=q+U;for(let he=-U;he<ce;he+=U)for(let de=-U;de<ce;de+=U){const ve=de<0||de>q||he<0||he>q?24575:0,Me=i.aw(Math.round(de),0,i.ag),Te=i.aw(Math.round(he),0,i.ag);$.emplaceBack(Me+ve,Te)}const ie=(he,de)=>{const ve=de*j+he;B.emplaceBack(ve+1,ve,ve+j),B.emplaceBack(ve+j,ve+j+1,ve+1)};for(let he=1;he<129;he++)for(let de=1;de<129;de++)ie(de,he);return[0,129].forEach(he=>{for(let de=0;de<130;de++)ie(de,he),ie(he,de)}),[$,B,32768]}(),S=r.context;this.gridBuffer=S.createVertexBuffer(p,i.b6.members),this.gridIndexBuffer=S.createIndexBuffer(_),this.gridSegments=i.b7.simpleSegment(0,0,p.length,_.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,p.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ib(s.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const I=S.gl;this._overlapStencilMode=new Rn({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new rm(s.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,s,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const _=r.terrain.properties,x=r.terrain.drapeRenderMode===0,S=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const I=r.terrain&&r.terrain.scope,R=_.get("source"),$=x?this._mockSourceCache:r.getSourceCache(R,I);if(!$)return void i.w(`Couldn't find terrain source "${R}".`);if(this.sourceCache=$,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(s):_.get("exaggeration"),!s.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const B=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const j=this.getScaledDemTileSize();this.sourceCache.update(s,j,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,B(),this._initializing=!0),B(),s.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const s=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const _=s!=null?p-s:Number.MAX_VALUE;if(Math.abs(_)<2)return this._exaggeration;const x=r.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(x);let I=x-this._previousZoom;const R=this._previousUpdateTimestamp;let $=x;this._evaluationZoom!=null&&($=this._evaluationZoom,Math.abs(x-$)>.5&&(I=.5*(x-$+I)),I*_<0&&($+=I)),this._evaluationZoom=$;const B=S.getExaggeration($),j=B===S.getExaggeration(Math.max(0,$-.1));if(j&&Math.abs(B-this._exaggeration)<.01)return B;let U=Math.min(.1,.00375*(this._updateTimestamp-R));return(j||B<.1||Math.abs(I)<1e-4)&&(U=Math.min(.2,4*U)),i.af(this._exaggeration,B,U)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=s.getIds().map(R=>{const $=s.getTileByID(R).tileID;return $.projMatrix=p.calculateProjMatrix($.toUnwrapped()),$});(function(R,$){const B=$.transform.pointCoordinate($.transform.getCameraPoint()),j=new i.P(B.x,B.y);R.sort((U,q)=>{if(q.overscaledZ-U.overscaledZ)return q.overscaledZ-U.overscaledZ;const ce=new i.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),ie=new i.P(q.canonical.x+(1<<q.canonical.z)*q.wrap,q.canonical.y),he=j.mult(1<<U.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(ce)-he.distSqr(ie)})})(_,this.painter);const x=this.proxyToSource||{};this.proxyToSource={},_.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const R in S){const $=S[R];if(!$.used||($!==this.sourceCache&&this.resetTileLookupCache($.id),this._setupProxiedCoordsForOrtho($,r[R],x),$.usedForTerrain))continue;const B=r[R];$.getSource().reparseOverscaled&&this._assignTerrainTiles(B)}this.proxiedCoords[s.id]=_.map(R=>new im(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1;const I={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const $=this.terrainTileForTile[R.key];if(!$)continue;const B=$.tileID.key;B in I||(this._visibleDemTiles.push($),I[B]=B)}}_assignTerrainTiles(r){this._initializing||r.forEach(s=>{if(this.terrainTileForTile[s.key])return;const p=this._findTileCoveringTileID(s,this.sourceCache);p&&(this.terrainTileForTile[s.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,s=r.gl;for(const p in this.terrainTileForTile){const _=this.terrainTileForTile[p],x=_.dem;!x||_.demTexture&&!_.needsDEMTextureUpload||(r.activeTexture.set(s.TEXTURE1),H_(this.painter,_,x))}}_prepareDemTileUniforms(r,s,p,_){if(!s||s.demTexture==null)return!1;const x=r.tileID.canonical,S=Math.pow(2,s.tileID.canonical.z-x.z),I=_||"";return p[`u_dem_tl${I}`]=[x.x*S%1,x.y*S%1],p[`u_dem_scale${I}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const s=this._visibleDemTiles.reduce((p,_)=>{if(!_.dem)return p;const x=_.dem.tree.minimums[0];return x>0&&r++,p+x},0);return r?s/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,s=r.gl;r.activeTexture.set(s.TEXTURE2);const p=this._getLoadedAreaMinimum(),_=new i.cK({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(_,{premultiply:!1}):x=this._emptyDEMTexture=new i.T(r,_,s.R32F,{premultiply:!1}),x}setupElevationDraw(r,s,p){const _=this.painter.context,x=_.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let I=null,R=null,$=1;if(p&&p.morphing&&this._useVertexMorphing){const q=p.morphing.srcDemTile,ce=p.morphing.dstDemTile;$=p.morphing.phase,q&&ce&&(this._prepareDemTileUniforms(r,q,S,"_prev")&&(R=q),this._prepareDemTileUniforms(r,ce,S)&&(I=ce))}const B=q=>q&&q.demTexture&&this.painter.linearFloatFilteringSupported()?x.LINEAR:x.NEAREST;let j=null;var U;if(this.enabled?R&&I?(j=I.demTexture,_.activeTexture.set(x.TEXTURE4),R.demTexture.bind(B(R),x.CLAMP_TO_EDGE),S.u_dem_lerp=$):(I=this.terrainTileForTile[r.tileID.key],j=this._prepareDemTileUniforms(r,I,S)?I.demTexture:this.emptyDEMTexture):j=this.emptyDEMTexture,_.activeTexture.set(x.TEXTURE2),j&&(S.u_dem_size=(U=j).size[0]===1?1:U.size[0]-2,j.bind(B(I),x.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,s,S),p&&p.useMeterToDem&&I){const q=(1<<I.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=q}if(p&&p.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),s.setTerrainUniformValues(_,S),this.painter.transform.projection.name==="globe"){const q=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);s.setGlobeUniformValues(_,q)}}globeUniformValues(r,s,p){const _=r.projection;return{u_tile_tl_up:_.upVector(s,0,0),u_tile_tr_up:_.upVector(s,i.ag,0),u_tile_br_up:_.upVector(s,i.ag,i.ag),u_tile_bl_up:_.upVector(s,0,i.ag),u_tile_up_scale:p?i.cL(1):_.upVectorScale(s,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const s=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,x,S,I,R){if(_.transform.projection.name==="globe")(function($,B,j,U,q){const ce=$.context,ie=ce.gl;let he,de;const ve=$.transform,Me=i.cC($,ce,ve),Te=(St,bt)=>{if(de===bt)return;const st=[Gh[bt],"PROJECTION_GLOBE_VIEW"];Me&&st.push("CUSTOM_ANTIALIASING");const _t=$.isTileAffectedByFog(St);he=$.getOrCreateProgram("globeRaster",{defines:st,overrideFog:_t}),de=bt},Be=$.colorModeForRenderPass(),Pe=new Cn(ie.LEQUAL,Cn.ReadWrite,$.depthRangeFor3D);qo.update(q);const Le=i.cD(ve),Ae=[i.at(ve.center.lng),i.aA(ve.center.lat)],Ue=$.globeSharedBuffers,tt=[ve.width*i.q.devicePixelRatio,ve.height*i.q.devicePixelRatio],gt=Float32Array.from(ve.globeMatrix),ct={useDenormalizedUpVectorScale:!0};{const St=$.transform,bt=sd(St.zoom,B.exaggeration(),B.sourceCache._source.tileSize);de=-1;const st=ie.TRIANGLES;for(const _t of U){const $t=j.getTile(_t),ot=Rn.disabled,Et=B.prevTerrainTileForTile[_t.key],yt=B.terrainTileForTile[_t.key];nm(Et,yt)&&qo.newMorphing(_t.key,Et,yt,q,250),ce.activeTexture.set(ie.TEXTURE0),$t.texture&&$t.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const Gt=qo.getMorphValuesForProxy(_t.key),Ot=Gt?1:0;Gt&&i.J(ct,{morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:i.cB(Gt.phase)}});const Tt=i.cE(_t.canonical),Bt=i.cF(Tt.getCenter().lat),Ht=i.cG(_t.canonical,Tt,Bt,St.worldSize/St._pixelsPerMercatorPixel),rn=i.bb(i.cH(_t.canonical)),dn=il(St.expandedFarZProjMatrix,gt,Le,rn,i.ae(St.zoom),Ae,St.frustumCorners.TL,St.frustumCorners.TR,St.frustumCorners.BR,St.frustumCorners.BL,St.globeCenterInViewSpace,St.globeRadius,tt,bt,St._farZ,Ht);if(Te(_t,Ot),he&&(B.setupElevationDraw($t,he,ct),$.uploadCommonUniforms(ce,he,_t.toUnwrapped()),Ue)){const[Dn,wn,Tn]=Ue.getGridBuffers(Bt,bt!==0);he.draw($,st,Pe,ot,Be,Ln.backCCW,dn,"globe_raster",Dn,wn,Tn)}}}if(Ue&&($.renderDefaultNorthPole||$.renderDefaultSouthPole)){const St=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Me&&St.push("CUSTOM_ANTIALIASING"),he=$.getOrCreateProgram("globeRaster",{defines:St});for(const bt of U){const{x:st,y:_t,z:$t}=bt.canonical,ot=_t===0,Et=_t===(1<<$t)-1,[yt,Gt,Ot,Tt]=Ue.getPoleBuffers($t,!1);if(Tt&&(ot||Et)){const Bt=j.getTile(bt);ce.activeTexture.set(ie.TEXTURE0),Bt.texture&&Bt.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);let Ht=i.cI($t,st,ve);const rn=i.bb(i.cH(bt.canonical)),dn=(Dn,wn)=>Dn.draw($,ie.TRIANGLES,Pe,Rn.disabled,Be,Ln.disabled,il(ve.expandedFarZProjMatrix,Ht,Ht,rn,0,Ae,ve.frustumCorners.TL,ve.frustumCorners.TR,ve.frustumCorners.BR,ve.frustumCorners.BL,ve.globeCenterInViewSpace,ve.globeRadius,tt,0,ve._farZ),"globe_pole_raster",wn,Ot,Tt);B.setupElevationDraw(Bt,he,ct),$.uploadCommonUniforms(ce,he,bt.toUnwrapped()),ot&&$.renderDefaultNorthPole&&dn(he,yt),Et&&$.renderDefaultSouthPole&&(Ht=i.ab.mat4.scale(i.ab.mat4.create(),Ht,[1,-1,1]),dn(he,Gt))}}}})(_,x,S,I,R);else{const $=_.context,B=$.gl;let j,U;const q=_.shadowRenderer,ce=nl(_,_.longestCutoffRange),ie=Be=>{if(U===Be)return;const Pe=[];Pe.push(Gh[Be]),ce.shouldRenderCutoff&&Pe.push("RENDER_CUTOFF"),q&&(Pe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&Pe.push("NORMAL_OFFSET")),j=_.getOrCreateProgram("terrainRaster",{defines:Pe}),U=Be},he=_.colorModeForRenderPass(),de=new Cn(B.LEQUAL,Cn.ReadWrite,_.depthRangeFor3D);qo.update(R);const ve=_.transform,Me=sd(ve.zoom,x.exaggeration(),x.sourceCache._source.tileSize);let Te=[0,0,0];if(q){const Be=_.style.directionalLight,Pe=_.style.ambientLight;Be&&Pe&&(Te=Fp(_.style,Be,Pe))}{U=-1;const Be=B.TRIANGLES,[Pe,Le]=[x.gridIndexBuffer,x.gridSegments];for(const Ae of I){const Ue=S.getTile(Ae),tt=Rn.disabled,gt=x.prevTerrainTileForTile[Ae.key],ct=x.terrainTileForTile[Ae.key];nm(gt,ct)&&qo.newMorphing(Ae.key,gt,ct,R,250),$.activeTexture.set(B.TEXTURE0),Ue.texture&&Ue.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const St=qo.getMorphValuesForProxy(Ae.key),bt=St?1:0;let st;St&&(st={morphing:{srcDemTile:St.from,dstDemTile:St.to,phase:i.cB(St.phase)}});const _t=tm(Ae.projMatrix,J_(Ae.canonical,ve.renderWorldCopies)?Me/10:Me,Te);if(ie(bt),!j)continue;x.setupElevationDraw(Ue,j,st);const $t=Ae.toUnwrapped();q&&q.setupShadows($t,j),_.uploadCommonUniforms($,j,$t,null,ce),j.draw(_,Be,de,tt,he,Ln.backCCW,_t,"terrain_raster",x.gridBuffer,Pe,Le)}}}}(s,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const s=this.painter,p=this.painter.context,_=this.proxySourceCache,x=this.proxiedCoords[_.id],S=this._drapedRenderBatches.shift(),I=s.style.order,R=[];let $=0;for(const B of x){const j=_.getTileByID(B.proxyTileKey),U=_.proxyCachedFBO[B.key]?_.proxyCachedFBO[B.key][r]:void 0,q=U!==void 0?_.renderCache[U]:this.pool[$++],ce=U!==void 0;if(j.texture=q.tex,ce&&!q.dirty){R.push(j.tileID);continue}let ie;p.bindFramebuffer.set(q.fb.framebuffer),this.renderedToTile=!1,q.dirty&&(p.clear({color:i.aj.transparent,stencil:0}),q.dirty=!1);for(let he=S.start;he<=S.end;++he){const de=s.style._mergedLayers[I[he]];if(de.isHidden(s.transform.zoom))continue;const ve=s.style.getLayerSourceCache(de),Me=ve?this.proxyToSource[B.key][ve.id]:[B];if(!Me)continue;const Te=Me;p.viewport.set([0,0,q.fb.width,q.fb.height]),ie!==(ve?ve.id:null)&&(this._setupStencil(q,Me,de,ve),ie=ve?ve.id:null),s.renderLayer(s,ve,de,Te)}if(this._drapedRenderBatches.length===0)for(const he of this._pendingGroundEffectLayers){const de=s.style._mergedLayers[I[he]];if(de.isHidden(s.transform.zoom))continue;const ve=s.style.getLayerSourceCache(de),Me=ve?this.proxyToSource[B.key][ve.id]:[B];if(!Me)continue;const Te=Me;p.viewport.set([0,0,q.fb.width,q.fb.height]),ie!==(ve?ve.id:null)&&(this._setupStencil(q,Me,de,ve),ie=ve?ve.id:null),s.renderLayer(s,ve,de,Te)}this.renderedToTile?(q.dirty=!0,R.push(j.tileID)):ce||--$,$===5&&($=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),S.end+1}postRender(){}isLayerOrderingCorrect(r){const s=r.order.length;let p=-1,_=s;for(let x=0;x<s;++x)this._style.isLayerDraped(r._mergedLayers[r.order[x]])?p=Math.max(p,x):_=Math.min(_,x);return _>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{r=Math.min(r,s.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,s,p){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const S=x.tileID,I=1<<S.overscaledZ,{x:R,y:$}=S.canonical,B=R/I,j=(R+1)/I,U=$/I,q=($+1)/I;return{minx:B,miny:U,maxx:j,maxy:q,t:x.dem.tree.raycastRoot(B,U,j,q,r,s,p),tile:x}});_.sort((x,S)=>(x.t!==null?x.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const x of _){if(x.t==null)return null;const S=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,r,s,p);if(S!=null)return S}return null}_createFBO(){const r=this.painter.context,s=r.gl,p=this.drapeBufferSize;r.activeTexture.set(s.TEXTURE0);const _=new i.T(r,{width:p[0],height:p[1],data:null},s.RGBA8);_.bind(s.LINEAR,s.CLAMP_TO_EDGE);const x=r.createFramebuffer(p[0],p[1],!0,null);return x.colorAttachment.set(_.texture),x.depthAttachment=new K_(r,x.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:x,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const s=this._style._mergedLayers[r],p=s.isHidden(this.painter.transform.zoom);return s.type==="hillshade"||s.type==="custom"?!p&&s.shouldRedrape():!p&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof bi){r=!0;break}if(!r)return;const s={};for(let p=0;p<this._style.order.length;++p){const _=this._style._mergedLayers[this._style.order[p]],x=this._style.getLayerSourceCache(_);if(x&&!s[x.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof i.a9){s[x.id]=!0;for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][x.id];if(I)for(const R of I)this._clearRenderCacheForTile(x.id,R)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof Ga){r=!0;break}if(!r)return;const s={};for(let p=0;p<this._style.order.length;++p){const _=this._style._mergedLayers[this._style.order[p]],x=this._style.getLayerSourceCache(_);if(!x||s[x.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const S=_.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const R=this.proxyToSource[I.key][x.id];if(R)for(const $ of R){const B=ld(x.getTile($),x.findLoadedParent($,0),x,this.painter.transform,S);(B.opacity!==1||B.mix!==0)&&this._clearRenderCacheForTile(x.id,$)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,s=r.length;if(s===0)return;const p=[];this._pendingGroundEffectLayers=[];let _,x=0,S=this._style._mergedLayers[r[x]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++x<s;)S=this._style._mergedLayers[r[x]];for(;x<s;++x){const I=this._style._mergedLayers[r[x]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?_===void 0&&(_=x):(I.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(x),_!==void 0&&(p.push({start:_,end:x-1}),_=void 0)))}if(_!==void 0&&p.push({start:_,end:x-1}),p.length!==0){const I=p[p.length-1];this._pendingGroundEffectLayers.every(R=>R>I.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const S=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let I=0;I<S.length;++I){const R=Object.values(S[I]);s.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,_=this._tilesDirty;for(let S=p.length-1;S>=0;S--){const I=p[S];if(s.getTileByID(I.key),s.proxyCachedFBO[I.key]!==void 0){const R=r[I.key],$=this.proxyToSource[I.key];let B=0;for(const j in $){const U=$[j],q=R[j];if(!q||q.length!==U.length||U.some((ce,ie)=>ce!==q[ie]||_[j]&&_[j].hasOwnProperty(ce.key))){B=-1;break}++B}for(const j in s.proxyCachedFBO[I.key])s.renderCache[s.proxyCachedFBO[I.key][j]].dirty=B<0||B!==Object.values(R).length}}const x=[...this._drapedRenderBatches];x.sort((S,I)=>I.end-I.start-(S.end-S.start));for(const S of x)for(const I of p){if(s.proxyCachedFBO[I.key])continue;let R=s.renderCachePool.pop();R===void 0&&s.renderCache.length<50&&(R=s.renderCache.length,s.renderCache.push(this._createFBO())),R!==void 0&&(s.proxyCachedFBO[I.key]={},s.proxyCachedFBO[I.key][S.start]=R,s.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(r,s,p,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,S=x.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let I;if(p.isTileClipped())I=s.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Rn.disabled}_renderTileClippingMasks(r,s){const p=this.painter,_=this.painter.context,x=_.gl;p._tileClippingMaskIDs={},_.setColorMode(Wn.disabled),_.setDepthMode(Cn.disabled);const S=p.getOrCreateProgram("clippingMask");for(const I of r){const R=p._tileClippingMaskIDs[I.key]=--s;S.draw(p,x.TRIANGLES,Cn.disabled,new Rn({func:x.ALWAYS,mask:0},R,255,x.KEEP,x.KEEP,x.REPLACE),Wn.disabled,Ln.disabled,Wh(I.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const s=this.painter.transform;if(r.x<0||r.x>s.width||r.y<0||r.y>s.height)return null;const p=[r.x,r.y,1,1];i.ab.vec4.transformMat4(p,p,s.pixelMatrixInverse),i.ab.vec4.scale(p,p,1/p[3]),p[0]/=s.worldSize,p[1]/=s.worldSize;const _=s._camera.position,x=i.bH(1,s.center.lat),S=[_[0],_[1],_[2]/x,0],I=i.ab.vec3.subtract([],p.slice(0,3),S);i.ab.vec3.normalize(I,I);const R=this.raycast(S,I,this._exaggeration);return R!==null&&R?(i.ab.vec3.scaleAndAdd(S,S,I,R),S[3]=S[2],S[2]*=x,S):null}_setupProxiedCoordsForOrtho(r,s,p){if(r.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(r,s,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const _=this.proxiedCoords[r.id]=[],x=this.proxyCoords;for(let R=0;R<x.length;R++){const $=x[R],B=this._findTileCoveringTileID($,r);if(B){const j=this._createProxiedId($,B,p[$.key]&&p[$.key][r.id]);_.push(j),this.proxyToSource[$.key][r.id]=[j]}}let S=!1;const I=new Set;for(let R=0;R<s.length;R++){const $=r.getTile(s[R]);if(!$||!$.hasData())continue;const B=this._findTileCoveringTileID($.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==$.tileID.canonical.z){const j=this.proxyToSource[B.tileID.key][r.id],U=this._createProxiedId(B.tileID,$,p[B.tileID.key]&&p[B.tileID.key][r.id]);j?j.splice(j.length-1,0,U):this.proxyToSource[B.tileID.key][r.id]=[U];const q=this.proxyToSource[B.tileID.key][r.id];I.has(q)||I.add(q),_.push(U),S=!0}}if(this._sourceTilesOverlap[r.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const R of I)R.sort(($,B)=>B.overscaledZ-$.overscaledZ)}_setupProxiedCoordsForImageSource(r,s,p){if(!r.getSource().loaded())return;const _=this.proxiedCoords[r.id]=[],x=this.proxyCoords,S=r.getSource(),I=S.tileID;if(!I)return;const R=new i.P(I.x,I.y)._div(1<<I.z),$=S.coordinates.map(i.aa.fromLngLat).reduce((j,U)=>(j.min.x=Math.min(j.min.x,U.x-R.x),j.min.y=Math.min(j.min.y,U.y-R.y),j.max.x=Math.max(j.max.x,U.x-R.x),j.max.y=Math.max(j.max.y,U.y-R.y),j),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(j,U)=>{const q=j.wrap+j.canonical.x/(1<<j.canonical.z),ce=j.canonical.y/(1<<j.canonical.z),ie=i.ag/(1<<j.canonical.z),he=U.wrap+U.canonical.x/(1<<U.canonical.z),de=U.canonical.y/(1<<U.canonical.z);return q+ie<he+$.min.x||q>he+$.max.x||ce+ie<de+$.min.y||ce>de+$.max.y};for(let j=0;j<x.length;j++){const U=x[j];for(let q=0;q<s.length;q++){const ce=r.getTile(s[q]);if(!ce||!ce.hasData()||B(U,ce.tileID))continue;const ie=this._createProxiedId(U,ce,p[U.key]&&p[U.key][r.id]),he=this.proxyToSource[U.key][r.id];he?he.push(ie):this.proxyToSource[U.key][r.id]=[ie],_.push(ie)}}}_createProxiedId(r,s,p){let _=this.orthoMatrix;if(p){const x=p.find(S=>S.key===s.tileID.key);if(x)return x}if(s.tileID.key!==r.key){const x=r.canonical.z-s.tileID.canonical.z;let S,I,R;_=i.ab.mat4.create();const $=s.tileID.wrap-r.wrap<<r.overscaledZ;x>0?(S=i.ag>>x,I=S*((s.tileID.canonical.x<<x)-r.canonical.x+$),R=S*((s.tileID.canonical.y<<x)-r.canonical.y)):(S=i.ag<<-x,I=i.ag*(s.tileID.canonical.x-(r.canonical.x+$<<-x)),R=i.ag*(s.tileID.canonical.y-(r.canonical.y<<-x))),i.ab.mat4.ortho(_,0,S,0,S,0,1),i.ab.mat4.translate(_,_,[I,R,0])}return new im(s.tileID,r.key,_)}_findTileCoveringTileID(r,s){let p=s.getTile(r);if(p&&p.hasData())return p;const _=this._findCoveringTileCache[s.id],x=_[r.key];if(p=x?s.getTileByID(x):null,p&&p.hasData()||x===null)return p;let S=p?p.tileID:r,I=S.overscaledZ;const R=s.getSource().minzoom,$=[];if(!x){const j=s.getSource().maxzoom;if(r.canonical.z>=j){const U=r.canonical.z-j;s.getSource().reparseOverscaled?(I=Math.max(r.canonical.z+2,s.transform.tileZoom),S=new i.aG(I,r.wrap,j,r.canonical.x>>U,r.canonical.y>>U)):U!==0&&(I=j,S=new i.aG(I,r.wrap,j,r.canonical.x>>U,r.canonical.y>>U))}S.key!==r.key&&($.push(S.key),p=s.getTile(S))}const B=j=>{$.forEach(U=>{_[U]=j}),$.length=0};for(I-=1;I>=R&&(!p||!p.hasData());I--){p&&B(p.tileID.key);const j=S.calculateScaledKey(I);if(p=s.getTileByID(j),p&&p.hasData())break;const U=_[j];if(U===null)break;U===void 0?$.push(j):p=s.getTileByID(U)}return B(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,s){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[s.key]=!0}}function ob(f,r,s){const p=function(I,R,$){const B=i.ab.vec3.dot(R,I),j=i.ab.vec3.dot($,[.2126,.7152,.0722]),U=(ce,ie,he)=>(1-he)*ce+he*ie,q=U(1-.3*Math.min(j,1),1,Math.min(B+1,1));return U(.92,1,Math.asin(i.aw(R[2],-1,1))/Math.PI+.5)*q}(f,[0,0,1],r),_=[0,0,0];i.ab.vec3.scale(_,s.slice(0,3),p);const x=[0,0,0];i.ab.vec3.scale(x,r.slice(0,3),f[2]);const S=[0,0,0];return i.ab.vec3.add(S,_,x),i.cf(S)}const ab=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Q_=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class e0{static cacheKey(r,s,p,_){let x=`${s}${_?_.cacheKey:""}`;for(const S of p)r.usedDefines.includes(S)&&(x+=`/${S}`);return x}constructor(r,s,p,_,x,S){const I=r.gl;this.program=I.createProgram(),this.configuration=_,this.name=s,this.fixedDefines=[...S];const R=_?_.getBinderAttributes():[],$=(p.staticAttributes||[]).concat(R);let B=_?_.defines():[];B=B.concat(S.map(he=>`#define ${he}`));const j=`#version 300 es
`;let U=j+B.concat("precision mediump float;",id,kh.fragmentSource).join(`
`);for(const he of p.fragmentIncludes)U+=`
${Lc[he]}`;U+=`
${p.fragmentSource}`;let q=j+B.concat("precision highp float;",id,kh.vertexSource).join(`
`);for(const he of p.vertexIncludes)q+=`
${Lc[he]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&p.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(q+=`
uniform int u_instanceID;
`),q+=`
${p.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(q=q.replaceAll("gl_InstanceID","u_instanceID"));const ce=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ce,U),I.compileShader(ce),I.attachShader(this.program,ce);const ie=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(ie,q),I.compileShader(ie),I.attachShader(this.program,ie),this.attributes={},this.numAttributes=$.length;for(let he=0;he<this.numAttributes;he++)if($[he]){const de=$[he].startsWith("a_")?$[he]:`a_${$[he]}`;I.bindAttribLocation(this.program,he,de),this.attributes[de]=he}I.linkProgram(this.program),I.deleteShader(ie),I.deleteShader(ce),this.fixedUniforms=x(r),this.binderUniforms=_?_.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(he=>({u_instanceID:new i.bN(he)}))(r)),(S.includes("TERRAIN")||s.indexOf("symbol")!==-1||s.indexOf("circle")!==-1)&&(this.terrainUniforms=(he=>({u_dem:new i.bN(he),u_dem_prev:new i.bN(he),u_dem_tl:new i.bK(he),u_dem_scale:new i.bM(he),u_dem_tl_prev:new i.bK(he),u_dem_scale_prev:new i.bM(he),u_dem_size:new i.bM(he),u_dem_lerp:new i.bM(he),u_exaggeration:new i.bM(he),u_depth:new i.bN(he),u_depth_size_inv:new i.bK(he),u_depth_range_unpack:new i.bK(he),u_occluder_half_size:new i.bM(he),u_occlusion_depth_offset:new i.bM(he),u_meter_to_dem:new i.bM(he),u_label_plane_matrix_inv:new i.bJ(he)}))(r)),S.includes("GLOBE")&&(this.globeUniforms=(he=>({u_tile_tl_up:new i.bL(he),u_tile_tr_up:new i.bL(he),u_tile_br_up:new i.bL(he),u_tile_bl_up:new i.bL(he),u_tile_up_scale:new i.bM(he)}))(r)),S.includes("FOG")&&(this.fogUniforms=(he=>({u_fog_matrix:new i.bJ(he),u_fog_range:new i.bK(he),u_fog_color:new i.ca(he),u_fog_horizon_blend:new i.bM(he),u_fog_vertical_limit:new i.bK(he),u_fog_temporal_offset:new i.bM(he),u_frustum_tl:new i.bL(he),u_frustum_tr:new i.bL(he),u_frustum_br:new i.bL(he),u_frustum_bl:new i.bL(he),u_globe_pos:new i.bL(he),u_globe_radius:new i.bM(he),u_globe_transition:new i.bM(he),u_is_globe:new i.bN(he),u_viewport:new i.bK(he)}))(r)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(he=>({u_cutoff_params:new i.ca(he)}))(r)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(he=>({u_lighting_ambient_color:new i.bL(he),u_lighting_directional_dir:new i.bL(he),u_lighting_directional_color:new i.bL(he),u_ground_radiance:new i.bL(he)}))(r)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(he=>({u_light_matrix_0:new i.bJ(he),u_light_matrix_1:new i.bJ(he),u_fade_range:new i.bK(he),u_shadow_normal_offset:new i.bL(he),u_shadow_intensity:new i.bM(he),u_shadow_texel_size:new i.bM(he),u_shadow_map_resolution:new i.bM(he),u_shadow_direction:new i.bL(he),u_shadow_bias:new i.bL(he),u_shadowmap_0:new i.bN(he),u_shadowmap_1:new i.bN(he)}))(r))}}setTerrainUniformValues(r,s){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in s)p[_]&&p[_].set(this.program,_,s[_])}}setGlobeUniformValues(r,s){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in s)p[_]&&p[_].set(this.program,_,s[_])}}setFogUniformValues(r,s){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setCutoffUniformValues(r,s){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setLightsUniformValues(r,s){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setShadowUniformValues(r,s){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}_drawDebugWireframe(r,s,p,_,x,S,I,R,$,B){const j=r.options.wireframe;if(j.terrain===!1&&j.layers2D===!1&&j.layers3D===!1)return;const U=r.context;if(!(!(!j.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!j.layers2D||r._terrain&&r._terrain.renderingToTexture||!ab.includes(this.name))||!(!j.layers3D||!Q_.includes(this.name))))return;const q=U.gl,ce=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,x,U);if(!ce)return;const ie=[...this.fixedDefines];ie.push("DEBUG_WIREFRAME");const he=r.getOrCreateProgram(this.name,{config:this.configuration,defines:ie});U.program.set(he.program);const de=(Te,Be,Pe)=>{if(Be[Te]&&Pe[Te])for(const Le in Be[Te])Pe[Te][Le]&&Pe[Te][Le].set(Pe.program,Le,Be[Te][Le].current)};$&&$.setUniforms(he.program,U,he.binderUniforms,I,{zoom:R}),de("fixedUniforms",this,he),de("terrainUniforms",this,he),de("globeUniforms",this,he),de("fogUniforms",this,he),de("lightsUniforms",this,he),de("shadowUniforms",this,he),ce.bind(),U.setColorMode(new Wn([q.ONE,q.ONE_MINUS_SRC_ALPHA,q.ZERO,q.ONE],i.aj.transparent,[!0,!0,!0,!1])),U.setDepthMode(new Cn(s.func===q.LESS?q.LEQUAL:s.func,Cn.ReadOnly,s.range)),U.setStencilMode(Rn.disabled);const ve=3*S.primitiveLength*2,Me=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Te=B||1;for(let Be=0;Be<Te;++Be)he.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Be),q.drawElements(q.LINES,ve,q.UNSIGNED_SHORT,Me)}else B&&B>1?q.drawElementsInstanced(q.LINES,ve,q.UNSIGNED_SHORT,Me,B):q.drawElements(q.LINES,ve,q.UNSIGNED_SHORT,Me);x.bind(),U.program.set(this.program),U.setDepthMode(s),U.setStencilMode(p),U.setColorMode(_)}checkUniforms(r,s,p){if(this.fixedDefines.includes(s)){for(const _ of Object.keys(p))if(!p[_].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${_} not set but required by ${s} being defined`)}}draw(r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he){const de=r.context,ve=de.gl;if(this.failedToCreate)return;de.program.set(this.program),de.setDepthMode(p),de.setStencilMode(_),de.setColorMode(x),de.setCullFace(S);for(const Be of Object.keys(this.fixedUniforms))this.fixedUniforms[Be].set(this.program,Be,I[Be]);ce&&ce.setUniforms(this.program,de,this.binderUniforms,U,{zoom:q});const Me={[ve.POINTS]:1,[ve.LINES]:2,[ve.TRIANGLES]:3,[ve.LINE_STRIP]:1}[s];this.checkUniforms(R,"RENDER_SHADOWS",this.shadowUniforms);const Te=he&&he>0?1:void 0;for(const Be of j.get()){const Pe=Be.vaos||(Be.vaos={});if((Pe[R]||(Pe[R]=new j_)).bind(de,this,$,ce?ce.getPaintVertexBuffers():[],B,Be.vertexOffset,ie||[],Te),this.forceManualRenderingForInstanceIDShaders){const Le=he||1;for(let Ae=0;Ae<Le;++Ae)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ae),B?ve.drawElements(s,Be.primitiveLength*Me,ve.UNSIGNED_SHORT,Be.primitiveOffset*Me*2):ve.drawArrays(s,Be.vertexOffset,Be.vertexLength)}else he&&he>1?ve.drawElementsInstanced(s,Be.primitiveLength*Me,ve.UNSIGNED_SHORT,Be.primitiveOffset*Me*2,he):B?ve.drawElements(s,Be.primitiveLength*Me,ve.UNSIGNED_SHORT,Be.primitiveOffset*Me*2):ve.drawArrays(s,Be.vertexOffset,Be.vertexLength);s===ve.TRIANGLES&&B&&this._drawDebugWireframe(r,p,_,x,B,Be,U,q,ce,he)}}}function qh(f,r){const s=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,f.transform.tileZoom)/s,_=p*(r.tileID.canonical.x+r.tileID.wrap*s),x=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(r,1,f.transform.tileZoom),u_pixel_coord_upper:[_>>16,x>>16],u_pixel_coord_lower:[65535&_,65535&x]}}const Vc={terrain:0,flat:1},jc=i.ab.mat4.create(),Zh=(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de)=>{const ve=r.style.light,Me=ve.properties.get("position"),Te=[Me.x,Me.y,Me.z],Be=i.ab.mat3.create();ve.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Be,-r.transform.angle),i.ab.vec3.transformMat3(Te,Te,Be));const Pe=ve.properties.get("color"),Le=r.transform,Ae={u_matrix:f,u_lightpos:Te,u_lightintensity:ve.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_vertical_gradient:+s,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:jc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Vc[$],u_base_type:Vc[B],u_ao:_,u_edge_radius:x,u_width_scale:S,u_flood_light_color:ce,u_vertical_scale:ie,u_flood_light_intensity:he,u_ground_shadow_factor:de};return Le.projection.name==="globe"&&(Ae.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],Ae.u_zoom_transition=j,Ae.u_inv_rot_matrix=q,Ae.u_merc_center=U,Ae.u_up_dir=Le.projection.upVector(new i.bT(0,0,0),U[0]*i.ag,U[1]*i.ag),Ae.u_height_lift=R),Ae},cd=(f,r,s,p,_,x)=>({u_matrix:f,u_edge_radius:r,u_width_scale:s,u_vertical_scale:p,u_height_type:Vc[_],u_base_type:Vc[x]}),t0=(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he)=>{const de=Zh(f,r,s,p,_,x,S,I,$,B,j,U,q,ce,ie,he,1,[0,0,0]),ve={u_height_factor:-Math.pow(2,I.overscaledZ)/R.tileSize/8};return i.l(de,qh(r,R),ve)},ud=(f,r)=>({u_matrix:f,u_emissive_strength:r}),dd=(f,r,s,p)=>i.l(ud(f,r),qh(s,p)),om=(f,r,s)=>({u_matrix:f,u_world:s,u_emissive_strength:r}),n0=(f,r,s,p,_)=>i.l(dd(f,r,s,p),{u_world:_}),sb=(f,r,s,p)=>{const _=i.ag/s.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/_,r.pixelsToGLUnits[1]/_]}},Xl=(f,r,s=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:s}),Yh=i.ab.mat4.create(),fn=(f,r,s,p,_,x,S)=>{const I=f.transform,R=I.projection.name==="globe",$=R?i.cN(I.zoom,r.canonical)*I._pixelsPerMercatorPixel:i.ar(s,1,x),B={u_matrix:r.projMatrix,u_extrude_scale:$,u_intensity:S,u_inv_rot_matrix:Yh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){B.u_inv_rot_matrix=p,B.u_merc_center=_,B.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],B.u_zoom_transition=i.ae(I.zoom);const j=_[0]*i.ag,U=_[1]*i.ag;B.u_up_dir=I.projection.upVector(new i.bT(0,0,0),j,U)}return B};function am(f,[r,s,p,_],[x,S]){if(x===S)return[0,0,0,0];const I=255*(f-1)/(f*(S-x));return[r*I,s*I,p*I,_*I]}function sm(f,r,[s,p]){return s===p?0:.5/f+(r-s)*(f-1)/(f*(p-s))}const ol=(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de,ve,Me,Te)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:_,u_tl_parent:x,u_scale_parent:$,u_fade_t:B.mix,u_opacity:B.opacity*j.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:j.paint.get("raster-brightness-min"),u_brightness_high:j.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(j.paint.get("raster-saturation")),u_contrast_factor:i.cP(j.paint.get("raster-contrast")),u_spin_weights:Kl(j.paint.get("raster-hue-rotate")),u_perspective_transform:U,u_raster_elevation:q,u_zoom_transition:S,u_merc_center:I,u_cutoff_params:R,u_colorization_mix:am(i.cQ,ie,de),u_colorization_offset:sm(i.cQ,he,de),u_color_ramp:ce,u_texture_offset:[Me/(ve+2*Me),ve/(ve+2*Me)],u_texture_res:[ve+2*Me,ve+2*Me],u_emissive_strength:Te});function Kl(f){f*=Math.PI/180;const r=Math.sin(f),s=Math.cos(f);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const yn=.05,lm=(f,r,s,p,_,x,S,I,R,$,B,j)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:_,u_tl_parent:x,u_scale_parent:$,u_fade_t:B.mix,u_opacity:B.opacity,u_image0:0,u_image1:1,u_raster_elevation:j,u_zoom_transition:S,u_merc_center:I,u_cutoff_params:R}),lb=(f,r,s,p,_,x,S,I,R,$)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:s,u_velocity:p,u_color_ramp:x,u_velocity_res:_,u_max_speed:S,u_uv_offset:I,u_data_scale:[255*R[0],255*R[1]],u_data_offset:$,u_particle_pos_scale:1.1,u_particle_pos_offset:[yn,yn]}),cb=(f,r,s,p,_,x,S,I,R,$)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:s,u_velocity_res:p,u_max_speed:_,u_speed_factor:x,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:I,u_data_scale:[255*R[0],255*R[1]],u_data_offset:$,u_particle_pos_scale:1.1,u_particle_pos_offset:[yn,yn]}),Xh=i.ab.mat4.create(),cm=(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de,ve,Me,Te,Be)=>{const Pe=_.transform,Le={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Pe.getCameraToCenterDistance(ve),u_rotate_symbol:+s,u_aspect_ratio:Pe.width/Pe.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:S,u_coord_matrix:I,u_is_text:+$,u_elevation_from_sea:R?1:0,u_pitch_with_map:+p,u_texsize:B,u_texsize_icon:j,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xh,u_up_vector:[0,-1,0],u_color_adj_mat:Me,u_icon_transition:Te||0,u_gamma_scale:p?_.transform.getCameraToCenterDistance(ve)*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+U,u_scale_factor:Be||1};return ve.name==="globe"&&(Le.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],Le.u_zoom_transition=ce,Le.u_inv_rot_matrix=he,Le.u_merc_center=ie,Le.u_camera_forward=Pe._camera.forward(),Le.u_ecef_origin=i.cR(Pe.globeMatrix,q.toUnwrapped()),Le.u_tile_matrix=Float32Array.from(Pe.globeMatrix),Le.u_up_vector=de),Le},um=(f,r,s,p)=>({u_matrix:f,u_emissive_strength:r,u_opacity:s,u_color:p}),r0=(f,r,s,p,_,x,S,I,R)=>i.l(function($,B,j,U,q,ce){const{width:ie,height:he}=U.imageManager.getPixelSize(B),de=Math.pow(2,ce.tileID.overscaledZ),ve=ce.tileSize*Math.pow(2,U.transform.tileZoom)/de,Me=ve*(ce.tileID.canonical.x+ce.tileID.wrap*de),Te=ve*ce.tileID.canonical.y;return{u_image:0,u_pattern_tl:j.tl,u_pattern_br:j.br,u_texsize:[ie,he],u_pattern_size:j.displaySize,u_pattern_units_to_pixels:q?[U.transform.width,-1*U.transform.height]:[1/i.ar(ce,1,U.transform.tileZoom),1/i.ar(ce,1,U.transform.tileZoom)],u_pixel_coord_upper:[Me>>16,Te>>16],u_pixel_coord_lower:[65535&Me,65535&Te]}}(0,x,S,p,I,R),{u_matrix:f,u_emissive_strength:r,u_opacity:s}),dm=new Float32Array(i.ab.mat4.identity([])),hd=(f,r,s,p,_,x,S,I,R,$,B,j,U,q=[0,0,0],ce)=>{const ie=_.style.light,he=ie.properties.get("position"),de=[-he.x,-he.y,he.z],ve=i.ab.mat3.create();ie.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(ve,-_.transform.angle),i.ab.vec3.transformMat3(de,de,ve));const Me=B.alphaMode==="MASK",Te=ie.properties.get("color").toRenderColor(null),Be=U.paint.get("model-ambient-occlusion-intensity"),Pe=U.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),Le=U.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:s,u_node_matrix:p||dm,u_lightpos:de,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_camera_pos:q,u_opacity:x,u_baseTextureIsAlpha:0,u_alphaMask:+Me,u_alphaCutoff:B.alphaCutoff,u_baseColorFactor:[S.r,S.g,S.b,S.a],u_emissiveFactor:[I[0],I[1],I[2],1],u_metallicFactor:R,u_roughnessFactor:$,u_baseColorTexture:oo.BaseColor,u_metallicRoughnessTexture:oo.MetallicRoughness,u_normalTexture:oo.Normal,u_occlusionTexture:oo.Occlusion,u_emissionTexture:oo.Emission,u_lutTexture:oo.LUT,u_color_mix:[Pe.r,Pe.g,Pe.b,Le],u_aoIntensity:Be,u_emissive_strength:j,u_occlusionTextureTransform:ce||[0,0,0,0]}},Kh=(f,r=dm,s=dm)=>({u_matrix:f,u_instance:r,u_node_matrix:s}),hm={fillExtrusion:f=>({u_matrix:new i.bJ(f),u_lightpos:new i.bL(f),u_lightintensity:new i.bM(f),u_lightcolor:new i.bL(f),u_vertical_gradient:new i.bM(f),u_opacity:new i.bM(f),u_edge_radius:new i.bM(f),u_width_scale:new i.bM(f),u_ao:new i.bK(f),u_height_type:new i.bN(f),u_base_type:new i.bN(f),u_tile_id:new i.bL(f),u_zoom_transition:new i.bM(f),u_inv_rot_matrix:new i.bJ(f),u_merc_center:new i.bK(f),u_up_dir:new i.bL(f),u_height_lift:new i.bM(f),u_flood_light_color:new i.bL(f),u_vertical_scale:new i.bM(f),u_flood_light_intensity:new i.bM(f),u_ground_shadow_factor:new i.bL(f)}),fillExtrusionDepth:f=>({u_matrix:new i.bJ(f),u_edge_radius:new i.bM(f),u_width_scale:new i.bM(f),u_vertical_scale:new i.bM(f),u_height_type:new i.bN(f),u_base_type:new i.bN(f)}),fillExtrusionPattern:f=>({u_matrix:new i.bJ(f),u_lightpos:new i.bL(f),u_lightintensity:new i.bM(f),u_lightcolor:new i.bL(f),u_vertical_gradient:new i.bM(f),u_height_factor:new i.bM(f),u_edge_radius:new i.bM(f),u_width_scale:new i.bM(f),u_ao:new i.bK(f),u_height_type:new i.bN(f),u_base_type:new i.bN(f),u_tile_id:new i.bL(f),u_zoom_transition:new i.bM(f),u_inv_rot_matrix:new i.bJ(f),u_merc_center:new i.bK(f),u_up_dir:new i.bL(f),u_height_lift:new i.bM(f),u_image:new i.bN(f),u_texsize:new i.bK(f),u_pixel_coord_upper:new i.bK(f),u_pixel_coord_lower:new i.bK(f),u_tile_units_to_pixels:new i.bM(f),u_opacity:new i.bM(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new i.bJ(f),u_opacity:new i.bM(f),u_ao_pass:new i.bM(f),u_meter_to_tile:new i.bM(f),u_ao:new i.bK(f),u_flood_light_intensity:new i.bM(f),u_flood_light_color:new i.bL(f),u_attenuation:new i.bM(f),u_edge_radius:new i.bM(f),u_fb:new i.bN(f),u_fb_size:new i.bM(f),u_dynamic_offset:new i.bM(f)}),fill:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f)}),fillPattern:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f),u_image:new i.bN(f),u_texsize:new i.bK(f),u_pixel_coord_upper:new i.bK(f),u_pixel_coord_lower:new i.bK(f),u_tile_units_to_pixels:new i.bM(f)}),fillOutline:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f),u_world:new i.bK(f)}),fillOutlinePattern:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f),u_world:new i.bK(f),u_image:new i.bN(f),u_texsize:new i.bK(f),u_pixel_coord_upper:new i.bK(f),u_pixel_coord_lower:new i.bK(f),u_tile_units_to_pixels:new i.bM(f)}),circle:i.cS,collisionBox:f=>({u_matrix:new i.bJ(f),u_camera_to_center_distance:new i.bM(f),u_extrude_scale:new i.bK(f)}),collisionCircle:f=>({u_matrix:new i.bJ(f),u_inv_matrix:new i.bJ(f),u_camera_to_center_distance:new i.bM(f),u_viewport_size:new i.bK(f)}),debug:f=>({u_color:new i.cz(f),u_matrix:new i.bJ(f),u_overlay:new i.bN(f),u_overlay_scale:new i.bM(f)}),clippingMask:f=>({u_matrix:new i.bJ(f)}),heatmap:f=>({u_extrude_scale:new i.bM(f),u_intensity:new i.bM(f),u_matrix:new i.bJ(f),u_inv_rot_matrix:new i.bJ(f),u_merc_center:new i.bK(f),u_tile_id:new i.bL(f),u_zoom_transition:new i.bM(f),u_up_dir:new i.bL(f)}),heatmapTexture:f=>({u_image:new i.bN(f),u_color_ramp:new i.bN(f),u_opacity:new i.bM(f)}),hillshade:f=>({u_matrix:new i.bJ(f),u_image:new i.bN(f),u_latrange:new i.bK(f),u_light:new i.bK(f),u_shadow:new i.cz(f),u_highlight:new i.cz(f),u_emissive_strength:new i.bM(f),u_accent:new i.cz(f)}),hillshadePrepare:f=>({u_matrix:new i.bJ(f),u_image:new i.bN(f),u_dimension:new i.bK(f),u_zoom:new i.bM(f)}),line:i.cT,linePattern:i.cU,raster:f=>({u_matrix:new i.bJ(f),u_normalize_matrix:new i.bJ(f),u_globe_matrix:new i.bJ(f),u_merc_matrix:new i.bJ(f),u_grid_matrix:new i.cA(f),u_tl_parent:new i.bK(f),u_scale_parent:new i.bM(f),u_fade_t:new i.bM(f),u_opacity:new i.bM(f),u_image0:new i.bN(f),u_image1:new i.bN(f),u_brightness_low:new i.bM(f),u_brightness_high:new i.bM(f),u_saturation_factor:new i.bM(f),u_contrast_factor:new i.bM(f),u_spin_weights:new i.bL(f),u_perspective_transform:new i.bK(f),u_raster_elevation:new i.bM(f),u_zoom_transition:new i.bM(f),u_merc_center:new i.bK(f),u_cutoff_params:new i.ca(f),u_colorization_mix:new i.ca(f),u_colorization_offset:new i.bM(f),u_color_ramp:new i.bN(f),u_texture_offset:new i.bK(f),u_texture_res:new i.bK(f),u_emissive_strength:new i.bM(f)}),rasterParticle:f=>({u_matrix:new i.bJ(f),u_normalize_matrix:new i.bJ(f),u_globe_matrix:new i.bJ(f),u_merc_matrix:new i.bJ(f),u_grid_matrix:new i.cA(f),u_tl_parent:new i.bK(f),u_scale_parent:new i.bM(f),u_fade_t:new i.bM(f),u_opacity:new i.bM(f),u_image0:new i.bN(f),u_image1:new i.bN(f),u_raster_elevation:new i.bM(f),u_zoom_transition:new i.bM(f),u_merc_center:new i.bK(f),u_cutoff_params:new i.ca(f)}),rasterParticleTexture:f=>({u_texture:new i.bN(f),u_opacity:new i.bM(f)}),rasterParticleDraw:f=>({u_particle_texture:new i.bN(f),u_particle_texture_side_len:new i.bM(f),u_tile_offset:new i.bK(f),u_velocity:new i.bN(f),u_color_ramp:new i.bN(f),u_velocity_res:new i.bK(f),u_max_speed:new i.bM(f),u_uv_offset:new i.bK(f),u_data_scale:new i.bK(f),u_data_offset:new i.bM(f),u_particle_pos_scale:new i.bM(f),u_particle_pos_offset:new i.bK(f)}),rasterParticleUpdate:f=>({u_particle_texture:new i.bN(f),u_particle_texture_side_len:new i.bM(f),u_velocity:new i.bN(f),u_velocity_res:new i.bK(f),u_max_speed:new i.bM(f),u_speed_factor:new i.bM(f),u_reset_rate:new i.bM(f),u_rand_seed:new i.bM(f),u_uv_offset:new i.bK(f),u_data_scale:new i.bK(f),u_data_offset:new i.bM(f),u_particle_pos_scale:new i.bM(f),u_particle_pos_offset:new i.bK(f)}),symbol:f=>({u_is_size_zoom_constant:new i.bN(f),u_is_size_feature_constant:new i.bN(f),u_size_t:new i.bM(f),u_size:new i.bM(f),u_camera_to_center_distance:new i.bM(f),u_rotate_symbol:new i.bN(f),u_aspect_ratio:new i.bM(f),u_fade_change:new i.bM(f),u_matrix:new i.bJ(f),u_label_plane_matrix:new i.bJ(f),u_coord_matrix:new i.bJ(f),u_is_text:new i.bN(f),u_elevation_from_sea:new i.bN(f),u_pitch_with_map:new i.bN(f),u_texsize:new i.bK(f),u_texsize_icon:new i.bK(f),u_texture:new i.bN(f),u_texture_icon:new i.bN(f),u_gamma_scale:new i.bM(f),u_device_pixel_ratio:new i.bM(f),u_tile_id:new i.bL(f),u_zoom_transition:new i.bM(f),u_inv_rot_matrix:new i.bJ(f),u_merc_center:new i.bK(f),u_camera_forward:new i.bL(f),u_tile_matrix:new i.bJ(f),u_up_vector:new i.bL(f),u_ecef_origin:new i.bL(f),u_is_halo:new i.bN(f),u_icon_transition:new i.bM(f),u_color_adj_mat:new i.bJ(f),u_scale_factor:new i.bM(f)}),background:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f),u_opacity:new i.bM(f),u_color:new i.cz(f)}),backgroundPattern:f=>({u_matrix:new i.bJ(f),u_emissive_strength:new i.bM(f),u_opacity:new i.bM(f),u_image:new i.bN(f),u_pattern_tl:new i.bK(f),u_pattern_br:new i.bK(f),u_texsize:new i.bK(f),u_pattern_size:new i.bK(f),u_pixel_coord_upper:new i.bK(f),u_pixel_coord_lower:new i.bK(f),u_pattern_units_to_pixels:new i.bK(f)}),terrainRaster:f=>({u_matrix:new i.bJ(f),u_image0:new i.bN(f),u_skirt_height:new i.bM(f),u_ground_shadow_factor:new i.bL(f)}),skybox:f=>({u_matrix:new i.bJ(f),u_sun_direction:new i.bL(f),u_cubemap:new i.bN(f),u_opacity:new i.bM(f),u_temporal_offset:new i.bM(f)}),skyboxGradient:f=>({u_matrix:new i.bJ(f),u_color_ramp:new i.bN(f),u_center_direction:new i.bL(f),u_radius:new i.bM(f),u_opacity:new i.bM(f),u_temporal_offset:new i.bM(f)}),skyboxCapture:f=>({u_matrix_3f:new i.cA(f),u_sun_direction:new i.bL(f),u_sun_intensity:new i.bM(f),u_color_tint_r:new i.ca(f),u_color_tint_m:new i.ca(f),u_luminance:new i.bM(f)}),globeRaster:f=>({u_proj_matrix:new i.bJ(f),u_globe_matrix:new i.bJ(f),u_normalize_matrix:new i.bJ(f),u_merc_matrix:new i.bJ(f),u_zoom_transition:new i.bM(f),u_merc_center:new i.bK(f),u_image0:new i.bN(f),u_grid_matrix:new i.cA(f),u_skirt_height:new i.bM(f),u_far_z_cutoff:new i.bM(f),u_frustum_tl:new i.bL(f),u_frustum_tr:new i.bL(f),u_frustum_br:new i.bL(f),u_frustum_bl:new i.bL(f),u_globe_pos:new i.bL(f),u_globe_radius:new i.bM(f),u_viewport:new i.bK(f)}),globeAtmosphere:f=>({u_frustum_tl:new i.bL(f),u_frustum_tr:new i.bL(f),u_frustum_br:new i.bL(f),u_frustum_bl:new i.bL(f),u_horizon:new i.bM(f),u_transition:new i.bM(f),u_fadeout_range:new i.bM(f),u_color:new i.ca(f),u_high_color:new i.ca(f),u_space_color:new i.ca(f),u_temporal_offset:new i.bM(f),u_horizon_angle:new i.bM(f)}),model:f=>({u_matrix:new i.bJ(f),u_lighting_matrix:new i.bJ(f),u_normal_matrix:new i.bJ(f),u_node_matrix:new i.bJ(f),u_lightpos:new i.bL(f),u_lightintensity:new i.bM(f),u_lightcolor:new i.bL(f),u_camera_pos:new i.bL(f),u_opacity:new i.bM(f),u_baseColorFactor:new i.ca(f),u_emissiveFactor:new i.ca(f),u_metallicFactor:new i.bM(f),u_roughnessFactor:new i.bM(f),u_baseTextureIsAlpha:new i.bN(f),u_alphaMask:new i.bN(f),u_alphaCutoff:new i.bM(f),u_baseColorTexture:new i.bN(f),u_metallicRoughnessTexture:new i.bN(f),u_normalTexture:new i.bN(f),u_occlusionTexture:new i.bN(f),u_emissionTexture:new i.bN(f),u_lutTexture:new i.bN(f),u_color_mix:new i.ca(f),u_aoIntensity:new i.bM(f),u_emissive_strength:new i.bM(f),u_occlusionTextureTransform:new i.ca(f)}),modelDepth:f=>({u_matrix:new i.bJ(f),u_instance:new i.bJ(f),u_node_matrix:new i.bJ(f)}),groundShadow:f=>({u_matrix:new i.bJ(f),u_ground_shadow_factor:new i.bL(f)}),stars:f=>({u_matrix:new i.bJ(f),u_up:new i.bL(f),u_right:new i.bL(f),u_intensity_multiplier:new i.bM(f)}),snowParticle:f=>({u_modelview:new i.bJ(f),u_projection:new i.bJ(f),u_time:new i.bM(f),u_cam_pos:new i.bL(f),u_velocityConeAperture:new i.bM(f),u_velocity:new i.bM(f),u_horizontalOscillationRadius:new i.bM(f),u_horizontalOscillationRate:new i.bM(f),u_boxSize:new i.bM(f),u_billboardSize:new i.bM(f),u_simpleShapeParameters:new i.bK(f),u_screenSize:new i.bK(f),u_thinningCenterPos:new i.bK(f),u_thinningShape:new i.bL(f),u_thinningAffectedRatio:new i.bM(f),u_thinningParticleOffset:new i.bM(f),u_particleColor:new i.ca(f),u_direction:new i.bL(f)}),rainParticle:f=>({u_modelview:new i.bJ(f),u_projection:new i.bJ(f),u_time:new i.bM(f),u_cam_pos:new i.bL(f),u_texScreen:new i.bN(f),u_velocityConeAperture:new i.bM(f),u_velocity:new i.bM(f),u_boxSize:new i.bM(f),u_rainDropletSize:new i.bK(f),u_distortionStrength:new i.bM(f),u_rainDirection:new i.bL(f),u_color:new i.ca(f),u_screenSize:new i.bK(f),u_thinningCenterPos:new i.bK(f),u_thinningShape:new i.bL(f),u_thinningAffectedRatio:new i.bM(f),u_thinningParticleOffset:new i.bM(f),u_shapeDirectionalPower:new i.bM(f),u_shapeNormalPower:new i.bM(f),u_mode:new i.bM(f)}),vignette:f=>({u_vignetteShape:new i.bL(f),u_vignetteColor:new i.ca(f)}),occlusion:f=>({u_matrix:new i.bJ(f),u_anchorPos:new i.bL(f),u_screenSizePx:new i.bK(f),u_occluderSizePx:new i.bK(f),u_color:new i.ca(f)})};class Xa{constructor(r,s,p,_){this.id=Xa.uniqueIdxCounter,Xa.uniqueIdxCounter++,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||_||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=Xa.uniqueIdxCounter,Xa.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Xa.uniqueIdxCounter=0;const No={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class al{constructor(r,s,p,_,x,S){this.length=s.length,this.attributes=p,this.itemSize=s.bytesPerElement,this.dynamicDraw=_,this.instanceCount=S,this.context=r;const I=r.gl;this.buffer=I.createBuffer(),r.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||x||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let p=0;p<this.attributes.length;p++){const _=s.attributes[this.attributes[p].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,s,p){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],S=s.attributes[x.name];S!==void 0&&r.vertexAttribPointer(S,x.components,r[No[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,s,p){for(let _=0;_<this.attributes.length;_++){const x=s.attributes[this.attributes[_].name];x!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(x,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class fm{constructor(r,s,p,_,x){this.context=r,this.width=s,this.height=p;const S=this.framebuffer=r.gl.createFramebuffer();_&&(this.colorAttachment=new kc(r,S)),x&&(this.depthAttachmentType=x,this.depthAttachment=x==="renderbuffer"?new em(r,S):new X_(r,S))}destroy(){const r=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&r.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const s=this.depthAttachment.get();s&&r.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&r.deleteTexture(s)}r.deleteFramebuffer(this.framebuffer)}}class pm{constructor(r,s){this.gl=r,this.clearColor=new Up(this),this.clearDepth=new Hp(this),this.clearStencil=new Gp(this),this.colorMask=new Wp(this),this.depthMask=new G_(this),this.stencilMask=new W_(this),this.stencilFunc=new Kx(this),this.stencilOp=new od(this),this.stencilTest=new ad(this),this.depthRange=new q_(this),this.depthTest=new ko(this),this.depthFunc=new qp(this),this.blend=new Nh(this),this.blendFunc=new Vh(this),this.blendColor=new Zp(this),this.blendEquation=new Yp(this),this.cullFace=new jh(this),this.cullFaceSide=new Xp(this),this.frontFace=new Kp(this),this.program=new Uh(this),this.activeTexture=new Z_(this),this.viewport=new Y_(this),this.bindFramebuffer=new Bc(this),this.bindRenderbuffer=new Jx(this),this.bindTexture=new Qx(this),this.bindVertexBuffer=new eb(this),this.bindElementBuffer=new tb(this),this.bindVertexArrayOES=new nb(this),this.pixelStoreUnpack=new rb(this),this.pixelStoreUnpackPremultiplyAlpha=new Jp(this),this.pixelStoreUnpackFlipY=new Qp(this),this.options=s?Object.assign({},s):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=s&&!!s.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s,p){return new Xa(this,r,s,p)}createVertexBuffer(r,s,p,_,x){return new al(this,r,s,p,_,x)}createRenderbuffer(r,s,p){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,r,s,p),this.bindRenderbuffer.set(null),x}createFramebuffer(r,s,p,_){return new fm(this,r,s,p,_)}clear({color:r,depth:s,stencil:p,colorMask:_}){const x=this.gl;let S=0;r&&(S|=x.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(_||[!0,!0,!0,!0])),s!==void 0&&(S|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),p!==void 0&&(S|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),x.clear(S)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){i.bn(r.blendFunction,Wn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Uc;function Jh(f,r,s,p,_,x,S){const I=f.context,R=I.gl,$=f.transform,B=f.getOrCreateProgram("collisionBox"),j=[];let U=0,q=0;for(let Te=0;Te<p.length;Te++){const Be=p[Te],Pe=r.getTile(Be),Le=Pe.getBucket(s);if(!Le)continue;const Ae=Ca(Be,Le,$);let Ue=Ae;_[0]===0&&_[1]===0||(Ue=f.translatePosMatrix(Ae,Pe,_,x));const tt=S?Le.textCollisionBox:Le.iconCollisionBox,gt=Le.collisionCircleArray;if(gt.length>0){const ct=i.ab.mat4.create(),St=Ue;i.ab.mat4.mul(ct,Le.placementInvProjMatrix,$.glCoordMatrix),i.ab.mat4.mul(ct,ct,Le.placementViewportMatrix),j.push({circleArray:gt,circleOffset:q,transform:St,invTransform:ct,projection:Le.getProjection()}),U+=gt.length/4,q=U}tt&&(f.terrain&&f.terrain.setupElevationDraw(Pe,B),B.draw(f,R.LINES,Cn.disabled,Rn.disabled,f.colorModeForRenderPass(),Ln.disabled,sb(Ue,$,Pe,Le.getProjection()),s.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,null,$.zoom,null,[tt.collisionVertexBuffer,tt.collisionVertexBufferExt]))}if(!S||!j.length)return;const ce=f.getOrCreateProgram("collisionCircle"),ie=new i.cV;ie.resize(4*U),ie._trim();let he=0;for(const Te of j)for(let Be=0;Be<Te.circleArray.length/4;Be++){const Pe=4*Be,Le=Te.circleArray[Pe+0],Ae=Te.circleArray[Pe+1],Ue=Te.circleArray[Pe+2],tt=Te.circleArray[Pe+3];ie.emplace(he++,Le,Ae,Ue,tt,0),ie.emplace(he++,Le,Ae,Ue,tt,1),ie.emplace(he++,Le,Ae,Ue,tt,2),ie.emplace(he++,Le,Ae,Ue,tt,3)}(!Uc||Uc.length<2*U)&&(Uc=function(Te){const Be=2*Te,Pe=new i.aU;Pe.resize(Be),Pe._trim();for(let Le=0;Le<Be;Le++){const Ae=6*Le;Pe.uint16[Ae+0]=4*Le+0,Pe.uint16[Ae+1]=4*Le+1,Pe.uint16[Ae+2]=4*Le+2,Pe.uint16[Ae+3]=4*Le+2,Pe.uint16[Ae+4]=4*Le+3,Pe.uint16[Ae+5]=4*Le+0}return Pe}(U));const de=I.createIndexBuffer(Uc,!0),ve=I.createVertexBuffer(ie,i.cW.members,!0);for(const Te of j){const Be={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Me=$).getCameraToCenterDistance(Te.projection),u_viewport_size:[Me.width,Me.height]};ce.draw(f,R.TRIANGLES,Cn.disabled,Rn.disabled,f.colorModeForRenderPass(),Ln.disabled,Be,s.id,ve,de,i.b7.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,$.zoom)}var Me;ve.destroy(),de.destroy()}const fd=i.ab.mat4.create();function Zo(f){const r=f._camera.getWorldToCamera(f.worldSize,1),s=i.ab.mat4.multiply([],r,f.globeMatrix);i.ab.mat4.invert(s,s);const p=[0,0,0],_=[0,1,0,0];return i.ab.vec4.transformMat4(_,_,s),p[0]=_[0],p[1]=_[1],p[2]=_[2],i.ab.vec3.normalize(p,p),p}function Br({width:f,height:r,anchor:s,textOffset:p,textScale:_},x){const{horizontalAlign:S,verticalAlign:I}=i.bD(s),R=-(S-.5)*f,$=-(I-.5)*r,B=i.bC(s,p);return new i.P((R/_+B[0])*x,($/_+B[1])*x)}function Qh(f,r,s,p,_,x,S,I,R,$,B){const j=f.text.placedSymbolArray,U=f.text.dynamicLayoutVertexArray,q=f.icon.dynamicLayoutVertexArray,ce={},ie=f.getProjection(),he=kl(I,ie,x),de=x.elevation,ve=ie.upVectorScale(I.canonical,x.center.lat,x.worldSize).metersToTile;U.clear();for(let Me=0;Me<j.length;Me++){const Te=j.get(Me),{tileAnchorX:Be,tileAnchorY:Pe,numGlyphs:Le}=Te,Ae=Te.hidden||!Te.crossTileID||f.allowVerticalPlacement&&!Te.placedOrientation?null:p[Te.crossTileID];if(Ae){let Ue=0,tt=0,gt=0;if(de){const yt=de?de.getAtTileOffset(I,Be,Pe):0,[Gt,Ot,Tt]=ie.upVector(I.canonical,Be,Pe);Ue=yt*Gt*ve,tt=yt*Ot*ve,gt=yt*Tt*ve}let[ct,St,bt,st]=Po(Te.projectedAnchorX+Ue,Te.projectedAnchorY+tt,Te.projectedAnchorZ+gt,s?he:S);const _t=Ah(x.getCameraToCenterDistance(ie),st);let $t=_.evaluateSizeForFeature(f.textSizeData,$,Te)*_t/i.bw;s&&($t*=f.tilePixelRatio/R);const ot=Br(Ae,$t);s?({x:ct,y:St,z:bt}=ie.projectTilePoint(Be+ot.x,Pe+ot.y,I.canonical),[ct,St,bt]=Po(ct+Ue,St+tt,bt+gt,S)):(r&&ot._rotate(-x.angle),ct+=ot.x,St+=ot.y,bt=0);const Et=f.allowVerticalPlacement&&Te.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let yt=0;yt<Le;yt++)i.bt(U,ct,St,bt,Et);B&&Te.associatedIconIndex>=0&&(ce[Te.associatedIconIndex]={x:ct,y:St,z:bt,angle:Et})}else ri(Le,U)}if(B){q.clear();const Me=f.icon.placedSymbolArray;for(let Te=0;Te<Me.length;Te++){const Be=Me.get(Te),{numGlyphs:Pe}=Be,Le=ce[Te];if(Be.hidden||!Le)ri(Pe,q);else{const{x:Ae,y:Ue,z:tt,angle:gt}=Le;for(let ct=0;ct<Pe;ct++)i.bt(q,Ae,Ue,tt,gt)}}f.icon.dynamicLayoutVertexBuffer.updateData(q)}f.text.dynamicLayoutVertexBuffer.updateData(U)}function pd(f,r,s,p,_,x,S={}){const I=s.paint.get("icon-translate"),R=s.paint.get("text-translate"),$=s.paint.get("icon-translate-anchor"),B=s.paint.get("text-translate-anchor"),j=s.layout.get("icon-rotation-alignment"),U=s.layout.get("text-rotation-alignment"),q=s.layout.get("icon-pitch-alignment"),ce=s.layout.get("text-pitch-alignment"),ie=s.layout.get("icon-keep-upright"),he=s.layout.get("text-keep-upright"),de=s.paint.get("icon-color-saturation"),ve=s.paint.get("icon-color-contrast"),Me=s.paint.get("icon-color-brightness-min"),Te=s.paint.get("icon-color-brightness-max"),Be=s.layout.get("symbol-elevation-reference")==="sea",Pe=f.context,Le=Pe.gl,Ae=f.transform,Ue=j==="map",tt=U==="map",gt=q==="map",ct=ce==="map",St=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let bt=!1;const st=f.depthModeForSublayer(0,Cn.ReadOnly),_t=[i.at(Ae.center.lng),i.aA(Ae.center.lat)],$t=s.layout.get("text-variable-anchor"),ot=Ae.projection.name==="globe",Et=[],yt=[0,-1,0];for(const Gt of p){const Ot=r.getTile(Gt),Tt=Ot.getBucket(s);if(!Tt||Tt.projection.name==="mercator"&&ot||Tt.fullyClipped)continue;const Bt=Tt.projection.name==="globe",Ht=Bt?i.ae(Ae.zoom):0,rn=kl(Gt,Tt.getProjection(),Ae),dn=Ae.calculatePixelsToTileUnitsMatrix(Ot),Dn=$t&&Tt.hasTextData(),wn=Tt.hasIconTextFit()&&Dn&&Tt.hasIconData(),Tn=Tt.getProjection().createInversionMatrix(Ae,Gt.canonical),$n=pr=>{Ae.depthOcclusionForSymbolsAndCircles&&(s.hasInitialOcclusionOpacityProperties||f.terrain)&&(pr.push("DEPTH_D24"),pr.push("DEPTH_OCCLUSION"))},Jn=()=>{const pr=Ue&&s.layout.get("symbol-placement")!=="point",_r=[];$n(_r);const Xr=pr||wn,Ni=s.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&gt&&_r.push("PITCH_WITH_MAP_TERRAIN"),Bt&&(_r.push("PROJECTION_GLOBE_VIEW"),Xr&&_r.push("PROJECTED_POS_ON_VIEWPORT")),Ni>0&&_r.push("ICON_TRANSITION"),Tt.icon.zOffsetVertexBuffer&&_r.push("Z_OFFSET"),de===0&&ve===0&&Me===0&&Te===1||_r.push("COLOR_ADJUSTMENT"),Tt.sdfIcons&&_r.push("RENDER_SDF");const Pi=Tt.icon.programConfigurations.get(s.id),Oi=f.getOrCreateProgram("symbol",{config:Pi,defines:_r}),Ko=Ot.imageAtlasTexture?Ot.imageAtlasTexture.size:[0,0],po=Tt.iconSizeData,Kr=i.bp(po,Ae.zoom),zr=gt||Ae.pitch!==0,Or=Ki(rn,Ot.tileID.canonical,gt,Ue,Ae,Tt.getProjection(),dn),er=Ep(rn,Ot.tileID.canonical,gt,Ue,Ae,Tt.getProjection(),dn),gi=f.translatePosMatrix(er,Ot,I,$,!0),Vi=f.translatePosMatrix(rn,Ot,I,$),Dr=Xr?fd:Or,mo=Ue&&!gt&&!pr;let ma=yt;!ot&&!Ae.mercatorFromTransition||Ue||(ma=Zo(Ae));const Uo=Bt?ma:yt,Ro=s.getColorAdjustmentMatrix(de,ve,Me,Te),ns=cm(po.kind,Kr,mo,gt,f,Vi,Dr,gi,Be,!1,Ko,[0,0],!0,Gt,Ht,_t,Tn,Uo,Tt.getProjection(),Ro,Ni),ga=Ot.imageAtlasTexture?Ot.imageAtlasTexture:null,Jo=s.layout.get("icon-size").constantOr(0)!==1||Tt.iconsNeedLinear,oc=Tt.sdfIcons||f.options.rotating||f.options.zooming||Jo||zr?Le.LINEAR:Le.NEAREST,rs=Tt.sdfIcons&&s.paint.get("icon-halo-width").constantOr(1)!==0,ac=f.terrain&&gt&&pr?i.ab.mat4.invert(i.ab.mat4.create(),Or):fd;if(pr&&Tt.icon){const nu=Ae.elevation,gf=nu?nu.getAtTileOffsetFunc(Gt,Ae.center.lat,Ae.worldSize,Tt.getProjection()):null,Fm=ui(rn,Ot.tileID.canonical,gt,Ue,Ae,Tt.getProjection(),dn);Ph(Tt,rn,f,!1,Fm,er,gt,ie,gf,Gt)}return{program:Oi,buffers:Tt.icon,uniformValues:ns,atlasTexture:ga,atlasTextureIcon:null,atlasInterpolation:oc,atlasInterpolationIcon:null,isSDF:Tt.sdfIcons,hasHalo:rs,tile:Ot,labelPlaneMatrixInv:ac}},Tr=()=>{const pr=tt&&s.layout.get("symbol-placement")!=="point",_r=[],Xr=pr||$t||wn;f.terrainRenderModeElevated()&&ct&&_r.push("PITCH_WITH_MAP_TERRAIN"),Bt&&(_r.push("PROJECTION_GLOBE_VIEW"),Xr&&_r.push("PROJECTED_POS_ON_VIEWPORT")),Tt.text.zOffsetVertexBuffer&&_r.push("Z_OFFSET"),Tt.iconsInText&&_r.push("RENDER_TEXT_AND_SYMBOL"),_r.push("RENDER_SDF"),$n(_r);const Ni=Tt.text.programConfigurations.get(s.id),Pi=f.getOrCreateProgram("symbol",{config:Ni,defines:_r});let Oi,Ko=[0,0],po=null;const Kr=Tt.textSizeData;Tt.iconsInText&&(Ko=Ot.imageAtlasTexture?Ot.imageAtlasTexture.size:[0,0],po=Ot.imageAtlasTexture?Ot.imageAtlasTexture:null,Oi=ct||Ae.pitch!==0||f.options.rotating||f.options.zooming||Kr.kind==="composite"||Kr.kind==="camera"?Le.LINEAR:Le.NEAREST);const zr=Ot.glyphAtlasTexture?Ot.glyphAtlasTexture.size:[0,0],Or=s.layout.get("text-size-scale-range"),er=i.aw(f.scaleFactor,Or[0],Or[1]),gi=i.bp(Kr,Ae.zoom,er),Vi=Ki(rn,Ot.tileID.canonical,ct,tt,Ae,Tt.getProjection(),dn),Dr=Ep(rn,Ot.tileID.canonical,ct,tt,Ae,Tt.getProjection(),dn),mo=f.translatePosMatrix(Dr,Ot,R,B,!0),ma=f.translatePosMatrix(rn,Ot,R,B),Uo=Xr?fd:Vi,Ro=tt&&!ct&&!pr;let ns=yt;!ot&&!Ae.mercatorFromTransition||tt||(ns=Zo(Ae));const ga=cm(Kr.kind,gi,Ro,ct,f,ma,Uo,mo,Be,!0,zr,Ko,!0,Gt,Ht,_t,Tn,Bt?ns:yt,Tt.getProjection(),null,null,er),Jo=Ot.glyphAtlasTexture?Ot.glyphAtlasTexture:null,oc=Le.LINEAR,rs=s.paint.get("text-halo-width").constantOr(1)!==0,ac=f.terrain&&ct&&pr?i.ab.mat4.invert(i.ab.mat4.create(),Vi):fd;if(pr&&Tt.text){const nu=Ae.elevation,gf=nu?nu.getAtTileOffsetFunc(Gt,Ae.center.lat,Ae.worldSize,Tt.getProjection()):null,Fm=ui(rn,Ot.tileID.canonical,ct,tt,Ae,Tt.getProjection(),dn);Ph(Tt,rn,f,!0,Fm,Dr,ct,he,gf,Gt)}return{program:Pi,buffers:Tt.text,uniformValues:ga,atlasTexture:Jo,atlasTextureIcon:po,atlasInterpolation:oc,atlasInterpolationIcon:Oi,isSDF:!0,hasHalo:rs,tile:Ot,labelPlaneMatrixInv:ac}},ei=Tt.icon.segments.get().length,Nr=Tt.text.segments.get().length,Bn=ei&&!S.onlyText?Jn():null,or=Nr&&!S.onlyIcons?Tr():null,vn=s.paint.get("icon-opacity").constantOr(1),Xn=s.paint.get("text-opacity").constantOr(1);if(St&&Tt.canOverlap){bt=!0;const pr=vn&&!S.onlyText?Tt.icon.segments.get():[],_r=Xn&&!S.onlyIcons?Tt.text.segments.get():[];for(const Xr of pr)Et.push({segments:new i.b7([Xr]),sortKey:Xr.sortKey,state:Bn});for(const Xr of _r)Et.push({segments:new i.b7([Xr]),sortKey:Xr.sortKey,state:or})}else S.onlyText||Et.push({segments:vn?Tt.icon.segments:new i.b7([]),sortKey:0,state:Bn}),S.onlyIcons||Et.push({segments:Xn?Tt.text.segments:new i.b7([]),sortKey:0,state:or})}bt&&Et.sort((Gt,Ot)=>Gt.sortKey-Ot.sortKey);for(const Gt of Et){const Ot=Gt.state;if(Ot)if(f.terrain?f.terrain.setupElevationDraw(Ot.tile,Ot.program,{useDepthForOcclusion:Ae.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ot.labelPlaneMatrixInv}):f.setupDepthForOcclusion(Ae.depthOcclusionForSymbolsAndCircles,Ot.program),Pe.activeTexture.set(Le.TEXTURE0),Ot.atlasTexture&&Ot.atlasTexture.bind(Ot.atlasInterpolation,Le.CLAMP_TO_EDGE,!0),Ot.atlasTextureIcon&&(Pe.activeTexture.set(Le.TEXTURE1),Ot.atlasTextureIcon&&Ot.atlasTextureIcon.bind(Ot.atlasInterpolationIcon,Le.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,Ot.program),Ot.hasHalo){const Tt=Ot.uniformValues;Tt.u_is_halo=1,ef(Ot.buffers,Gt.segments,s,f,Ot.program,st,_,x,Tt,2),Tt.u_is_halo=0}else{if(Ot.isSDF){const Tt=Ot.uniformValues;Ot.hasHalo&&(Tt.u_is_halo=1,ef(Ot.buffers,Gt.segments,s,f,Ot.program,st,_,x,Tt,1)),Tt.u_is_halo=0}ef(Ot.buffers,Gt.segments,s,f,Ot.program,st,_,x,Ot.uniformValues,1)}}}function ef(f,r,s,p,_,x,S,I,R,$){const B=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];_.draw(p,p.context.gl.TRIANGLES,x,S,I,Ln.disabled,R,s.id,f.layoutVertexBuffer,f.indexBuffer,r,s.paint,p.transform.zoom,f.programConfigurations.get(s.id),B,$)}function mm(f,r,s,p,_,x,S){const I=f.context.gl,R=s.paint.get("fill-pattern"),$=s.is3D(),B=$?f.stencilModeFor3D():Rn.disabled,j=R&&R.constantOr(1);let U,q,ce,ie,he;S?(q=j&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=I.LINES):(q=j?"fillPattern":"fill",U=I.TRIANGLES);for(const de of p){const ve=r.getTile(de);if(j&&!ve.patternsLoaded())continue;const Me=ve.getBucket(s);if(!Me)continue;f.prepareDrawTile();const Te=Me.programConfigurations.get(s.id),Be=f.isTileAffectedByFog(de),Pe=f.getOrCreateProgram(q,{config:Te,overrideFog:Be});j&&(f.context.activeTexture.set(I.TEXTURE0),ve.imageAtlasTexture&&ve.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Te.updatePaintBuffers());const Le=R.constantOr(null);if(Le&&ve.imageAtlas){const tt=ve.imageAtlas,gt=i.A.from(Le).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),ct=tt.patternPositions[gt];ct&&Te.setConstantPatternPositions(ct)}const Ae=f.translatePosMatrix(de.projMatrix,ve,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),Ue=s.paint.get("fill-emissive-strength");if(S){ie=Me.indexBuffer2,he=Me.segments2;const tt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];ce=q==="fillOutlinePattern"&&j?n0(Ae,Ue,f,ve,tt):om(Ae,Ue,tt)}else ie=Me.indexBuffer,he=Me.segments,ce=j?dd(Ae,Ue,f,ve):ud(Ae,Ue);f.uploadCommonUniforms(f.context,Pe,de.toUnwrapped()),Pe.draw(f,U,_,$?B:f.stencilModeForClipping(de),x,Ln.disabled,ce,s.id,Me.layoutVertexBuffer,ie,he,s.paint,f.transform.zoom,Te,void 0)}}function md(f,r,s,p,_,x,S,I){s.resetLayerRenderingStats(f);const R=f.context,$=R.gl,B=f.transform,j=s.paint.get("fill-extrusion-pattern"),U=j.constantOr(1),q=s.paint.get("fill-extrusion-opacity"),ce=f.style.enable3dLights(),ie=s.paint.get(ce&&!U?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),he=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),ie],de=s.layout.get("fill-extrusion-edge-radius"),ve=de>0&&!s.paint.get("fill-extrusion-rounded-roof"),Me=ve?0:de,Te=B.projection.name==="globe"?i.d3():0,Be=B.projection.name==="globe",Pe=Be?i.ae(B.zoom):0,Le=[i.at(B.center.lng),i.aA(B.center.lat)],Ae=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ue=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ae?null:s.lut).toArray01().slice(0,3),tt=s.paint.get("fill-extrusion-flood-light-intensity"),gt=s.paint.get("fill-extrusion-vertical-scale"),ct=s.paint.get("fill-extrusion-line-width").constantOr(1)!==0,St=s.paint.get("fill-extrusion-height-alignment"),bt=s.paint.get("fill-extrusion-base-alignment"),st=nl(f,s.paint.get("fill-extrusion-cutoff-fade-range")),_t=[];let $t;Be&&_t.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&_t.push("FAUX_AO"),ve&&_t.push("ZERO_ROOF_RADIUS"),I&&_t.push("HAS_CENTROID"),tt>0&&_t.push("FLOOD_LIGHT"),st.shouldRenderCutoff&&_t.push("RENDER_CUTOFF"),ct&&_t.push("RENDER_WALL_MODE");const ot=f.renderPass==="shadow",Et=f.shadowRenderer,yt=ot&&!!Et;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Gt=[0,0,0];if(Et){const Bt=f.style.directionalLight,Ht=f.style.ambientLight;Bt&&Ht&&(Gt=Fp(f.style,Bt,Ht)),ot||(_t.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Et.useNormalOffset&&_t.push("NORMAL_OFFSET")),$t=_t.concat(["SHADOWS_SINGLE_CASCADE"])}const Ot=yt?"fillExtrusionDepth":U?"fillExtrusionPattern":"fillExtrusion",Tt=s.getLayerRenderingStats();for(const Bt of p){const Ht=r.getTile(Bt),rn=Ht.getBucket(s);if(!rn||rn.projection.name!==B.projection.name)continue;let dn=!1;Et&&(dn=Et.getMaxCascadeForTile(Bt.toUnwrapped())===0);const Dn=f.isTileAffectedByFog(Bt),wn=rn.programConfigurations.get(s.id),Tn=f.getOrCreateProgram(Ot,{config:wn,defines:dn?$t:_t,overrideFog:Dn});if(f.terrain&&f.terrain.setupElevationDraw(Ht,Tn,{useMeterToDem:!0}),!rn.centroidVertexBuffer){const or=Tn.attributes.a_centroid_pos;or!==void 0&&$.vertexAttrib2f(or,0,0)}!ot&&Et&&Et.setupShadows(Ht.tileID.toUnwrapped(),Tn,"vector-tile",Ht.tileID.overscaledZ),U&&(f.context.activeTexture.set($.TEXTURE0),Ht.imageAtlasTexture&&Ht.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),wn.updatePaintBuffers());const $n=j.constantOr(null);if($n&&Ht.imageAtlas){const or=Ht.imageAtlas,vn=i.A.from($n).getPrimary().scaleSelf(i.q.devicePixelRatio),Xn=or.patternPositions[vn.serialize()];Xn&&wn.setConstantPatternPositions(Xn)}const Jn=s.paint.get("fill-extrusion-vertical-gradient"),Tr=1/rn.tileToMeter;let ei;if(ot&&Et){if(qc(Ht.tileID,rn,f))continue;const or=Et.calculateShadowPassMatrixFromTile(Ht.tileID.toUnwrapped());ei=cd(or,Me,Tr,gt,St,bt)}else{const or=f.translatePosMatrix(Bt.expandedProjMatrix,Ht,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),vn=B.projection.createInversionMatrix(B,Bt.canonical);ei=U?t0(or,f,Jn,q,he,Me,Tr,Bt,Ht,Te,St,bt,Pe,Le,vn,Ue,gt):Zh(or,f,Jn,q,he,Me,Tr,Bt,Te,St,bt,Pe,Le,vn,Ue,gt,tt,Gt)}f.uploadCommonUniforms(R,Tn,Bt.toUnwrapped(),null,st);let Nr=rn.segments;if(B.projection.name==="mercator"&&!ot&&(Nr=rn.getVisibleSegments(Ht.tileID,f.terrain,f.transform.getFrustum(0)),!Nr.get().length))continue;if(Tt)if(ot)for(const or of Nr.get())Tt.numRenderedVerticesInShadowPass+=or.primitiveLength;else for(const or of Nr.get())Tt.numRenderedVerticesInTransparentPass+=or.primitiveLength;const Bn=[];(f.terrain||I)&&Bn.push(rn.centroidVertexBuffer),Be&&Bn.push(rn.layoutVertexExtBuffer),ct&&Bn.push(rn.wallVertexBuffer),Tn.draw(f,R.gl.TRIANGLES,_,x,S,Ln.backCCW,ei,s.id,rn.layoutVertexBuffer,rn.indexBuffer,Nr,s.paint,f.transform.zoom,wn,Bn)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function Hc(f,r,s,p,_,x,S,I,R,$,B,j,U,q,ce,ie,he,de,ve){const Me=f.context,Te=Me.gl,Be=f.transform,Pe=f.transform.zoom,Le=[],Ae=nl(f,s.paint.get("fill-extrusion-cutoff-fade-range"));$==="clear"?(Le.push("CLEAR_SUBPASS"),ve&&(Le.push("CLEAR_FROM_TEXTURE"),Me.activeTexture.set(Te.TEXTURE0),ve.bind(Te.LINEAR,Te.CLAMP_TO_EDGE))):$==="sdf"&&Le.push("SDF_SUBPASS"),he&&Le.push("HAS_CENTROID"),Ae.shouldRenderCutoff&&Le.push("RENDER_CUTOFF");const Ue=s.layout.get("fill-extrusion-edge-radius"),tt=(gt,ct,St,bt,st)=>{const _t=ct.programConfigurations.get(s.id),$t=f.isTileAffectedByFog(gt),ot=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:_t,defines:Le,overrideFog:$t}),Et=((Gt,Ot,Tt,Bt,Ht,rn,dn,Dn,wn,Tn,$n)=>({u_matrix:Ot,u_opacity:Tt,u_ao_pass:Bt?1:0,u_meter_to_tile:Ht,u_ao:rn,u_flood_light_intensity:dn,u_flood_light_color:Dn,u_attenuation:wn,u_edge_radius:Tn,u_fb:0,u_fb_size:$n,u_dynamic_offset:1}))(0,bt,B,R,st,[j,U*st],q,ce,ie,Pe>=17?0:Ue*st,ve?ve.size[0]:0),yt=[];he&&yt.push(ct.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Me,ot,gt.toUnwrapped(),null,Ae),ot.draw(f,Me.gl.TRIANGLES,_,x,S,I,Et,s.id,ct.vertexBuffer,ct.indexBuffer,St,s.paint,Pe,_t,yt)};for(const gt of p){const ct=r.getTile(gt),St=ct.getBucket(s);if(!St||St.projection.name!==Be.projection.name||!St.groundEffect||St.groundEffect&&!St.groundEffect.hasData())continue;const bt=St.groundEffect,st=1/St.tileToMeter;{const _t=f.translatePosMatrix(gt.projMatrix,ct,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),$t=bt.getDefaultSegment();tt(gt,bt,$t,_t,st)}if(de)for(let _t=0;_t<4;_t++){const $t=i.d4[_t](gt),ot=r.getTile($t);if(!ot)continue;const Et=ot.getBucket(s);if(!Et||Et.projection.name!==Be.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;const yt=Et.groundEffect;let Gt,Ot;_t===0?(Gt=[-i.ag,0,0],Ot=1):_t===1?(Gt=[i.ag,0,0],Ot=0):_t===2?(Gt=[0,-i.ag,0],Ot=3):(Gt=[0,i.ag,0],Ot=2);const Tt=yt.regionSegments[Ot];if(!Tt)continue;const Bt=new Float32Array(16);i.ab.mat4.translate(Bt,gt.projMatrix,Gt),tt(gt,yt,Tt,f.translatePosMatrix(Bt,ct,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),st)}}}function Gc(f,r,s,p,_,x,S){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const I=x?x.findDEMTileFor(s):null;if(!(I&&I.dem||S))return;x&&I&&I.dem&&p.selfDEMTileTimestamp!==I.dem._timestamp&&(p.borderDoneWithNeighborZ=[-1,-1,-1,-1],p.selfDEMTileTimestamp=I.dem._timestamp);const R=de=>new i.P(Math.ceil((de+i.d7)*i.d8),0),$=de=>{const ve=r.getSource().minzoom,Me=Be=>{const Pe=r.getTileByID(Be);if(Pe&&Pe.hasData())return Pe.getBucket(_)},Te=[0,-1,1];for(const Be of Te){if(de.overscaledZ+Be<ve)continue;const Pe=Me(de.calculateScaledKey(de.overscaledZ+Be));if(Pe)return Pe}},B=[0,0,0],j=(de,ve)=>(B[0]=Math.min(de.min.y,ve.min.y),B[1]=Math.max(de.max.y,ve.max.y),B[2]=i.ag-ve.min.x>de.max.x?ve.min.x-i.ag:de.max.x,B),U=(de,ve)=>(B[0]=Math.min(de.min.x,ve.min.x),B[1]=Math.max(de.max.x,ve.max.x),B[2]=i.ag-ve.min.y>de.max.y?ve.min.y-i.ag:de.max.y,B),q=[(de,ve)=>j(de,ve),(de,ve)=>j(ve,de),(de,ve)=>U(de,ve),(de,ve)=>U(ve,de)],ce=(de,ve,Me,Te,Be,Pe,Le)=>{if(!x)return 0;const Ae=[[Pe?Me:de,Pe?de:Me,0],[Pe?Me:ve,Pe?ve:Me,0]],Ue=Le<0?i.ag+Le:Le,tt=[Pe?Ue:(de+ve)/2,Pe?(de+ve)/2:Ue,0];return Me===0&&Le<0||Me!==0&&Le>0?x.getForTilePoints(Be,[tt],!0,Te):Ae.push(tt),x.getForTilePoints(s,Ae,!0,I),Math.max(Ae[0][2],Ae[1][2],tt[2])/x.exaggeration()};for(let de=0;de<4;de++){const ve=p.borderFeatureIndices[de];if(ve.length===0)continue;const Me=i.d4[de](s),Te=$(Me);if(!(Te&&Te instanceof i.d5))continue;const Be=x?x.findDEMTileFor(Me):null;if(!(Be&&Be.dem||S)||(x&&Be&&Be.dem&&p.borderDEMTileTimestamp[de]!==Be.dem._timestamp&&(p.borderDoneWithNeighborZ[de]=-1,p.borderDEMTileTimestamp[de]=Be.dem._timestamp),p.borderDoneWithNeighborZ[de]===Te.canonical.z))continue;Te.centroidVertexArray.length===0&&Te.createCentroidsBuffer();const Pe=(de<2?1:5)-de,Le=Te.borderDoneWithNeighborZ[Pe]!==p.canonical.z,Ae=Te.borderFeatureIndices[Pe];let Ue=0;if(p.canonical.z!==Te.canonical.z){for(const tt of ve)p.showCentroid(p.featuresOnBorder[tt]);if(Le)for(const tt of Ae)Te.showCentroid(Te.featuresOnBorder[tt]);p.borderDoneWithNeighborZ[de]=Te.canonical.z,Te.borderDoneWithNeighborZ[Pe]=p.canonical.z}for(const tt of ve){const gt=p.featuresOnBorder[tt],ct=p.centroidData[gt.centroidDataIndex],St=gt.borders[de];let bt;for(;Ue<Ae.length;){bt=Te.featuresOnBorder[Ae[Ue]];const st=bt.borders[Pe];if(st[1]>St[0]+3||st[0]>St[0]-3)break;Te.showCentroid(bt),Ue++}if(bt&&Ue<Ae.length){const st=Ue;let _t=0;for(;!(bt.borders[Pe][0]>St[1]-3)&&(_t++,++Ue!==Ae.length);)bt=Te.featuresOnBorder[Ae[Ue]];bt=Te.featuresOnBorder[Ae[st]];let $t=!1;if(_t>=1){const yt=bt.borders[Pe];Math.abs(St[0]-yt[0])<3&&Math.abs(St[1]-yt[1])<3&&(_t=1,$t=!0,Ue=st+1)}else if(_t===0){p.showCentroid(gt);continue}const ot=Te.centroidData[bt.centroidDataIndex];S&&$t&&(((ie=ct).flags|(he=ot).flags)&i.d6?(ie.flags|=i.d6,he.flags|=i.d6):(ie.flags&=~i.d6,he.flags&=~i.d6));const Et=gt.intersectsCount()>1||bt.intersectsCount()>1;if(_t>1)Ue=st,ct.centroidXY=ot.centroidXY=new i.P(0,0);else if(Be&&Be.dem&&!Et){const yt=q[de](ct,ot),Gt=de%2?i.ag-1:0,Ot=ce(yt[0],Math.min(i.ag-1,yt[1]),Gt,Be,Me,de<2,yt[2]);ct.centroidXY=ot.centroidXY=R(Ot)}else Et?ct.centroidXY=ot.centroidXY=new i.P(0,0):(ct.centroidXY=p.encodeBorderCentroid(gt),ot.centroidXY=Te.encodeBorderCentroid(bt));p.writeCentroidToBuffer(ct),Te.writeCentroidToBuffer(ot)}else p.showCentroid(gt)}p.borderDoneWithNeighborZ[de]=Te.canonical.z,Te.borderDoneWithNeighborZ[Pe]=p.canonical.z}var ie,he;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const Wc=[1,0,0],Vt=[0,1,0],on=[0,0,1];function qc(f,r,s){const p=s.transform,_=s.shadowRenderer;if(!_)return!0;const x=f.toUnwrapped(),S=p.tileSize*_._cascades[s.currentShadowCascade].scale;let I=r.maxHeight;if(p.elevation){const ie=p.elevation.getMinMaxForTile(f);ie&&(I+=ie.max)}const R=[..._.shadowDirection];R[2]=-R[2];const $=_.computeSimplifiedTileShadowVolume(x,I,S,R);if(!$)return!1;const B=[Wc,Vt,on,R,[R[0],0,R[2]],[0,R[1],R[2]]],j=p.projection.name==="globe",U=p.scaleZoom(S),q=i.bR.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,U,!j),ce=_.getCurrentCascadeFrustum();return q.intersectsPrecise($.vertices,$.planes,B)===0||ce.intersectsPrecise($.vertices,$.planes,B)===0}function Yr(f){return[f[0]*i.d9,f[1]*i.d9,f[2]*i.d9,0]}function ut(f,r,s,p,_,x,S,I,R){const $=p.getSource(),B=s.globeSharedBuffers;if(!B)return;let j,U,q;if(r&&(j=p.getTile(r)),$ instanceof i.aJ?(U=$.texture,q=i.cI(0,0,s.transform)):j&&r&&(U=j.texture,q=i.cI(r.canonical.z,r.canonical.x,s.transform)),!U||!q)return;f||(q=i.ab.mat4.scale(i.ab.mat4.create(),q,[1,-1,1]));const ce=s.context,ie=ce.gl,he=_.paint.get("raster-resampling")==="nearest"?ie.NEAREST:ie.LINEAR,de=s.colorModeForDrapableLayerRenderPass(x),ve=S.defines;ve.push("GLOBE_POLES");const Me=new Cn(ie.LEQUAL,Cn.ReadWrite,s.depthRangeFor3D),Te=Float32Array.from(s.transform.expandedFarZProjMatrix),Be=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));s.terrain&&s.terrain.prepareDrawTile(),ce.activeTexture.set(ie.TEXTURE0),U.bind(he,ie.CLAMP_TO_EDGE),ce.activeTexture.set(ie.TEXTURE1),U.bind(he,ie.CLAMP_TO_EDGE),U.useMipmap&&ce.extTextureFilterAnisotropic&&s.transform.pitch>20&&ie.texParameterf(ie.TEXTURE_2D,ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ce.extTextureFilterAnisotropicMax);const[Pe,Le,Ae,Ue]=r?B.getPoleBuffers(r.canonical.z,!1):B.getPoleBuffers(0,!0),tt=_.paint.get("raster-elevation");let gt;f?(gt=Pe,s.renderDefaultNorthPole=tt!==0):(gt=Le,s.renderDefaultSouthPole=tt!==0);const ct=Yr(S.mix),St=((st,_t,$t,ot,Et,yt,Gt,Ot,Tt,Bt,Ht,rn,dn)=>ol(st,_t,$t,new Float32Array(16),new Float32Array(9),[0,0],ot,[0,0],[0,0,0,0],1,{opacity:1,mix:0},yt,[0,0],Ot,2,Bt,Ht,rn,1,0,dn))(Te,Be,q,i.ae(s.transform.zoom),0,_,0,tt,0,ct,S.offset,S.range,x),bt=s.getOrCreateProgram("raster",{defines:ve});s.uploadCommonUniforms(ce,bt,null),bt.draw(s,ie.TRIANGLES,Me,R,de,I,St,_.id,gt,Ae,Ue)}function i0(f){const r=f._nearZ,s=f.projection.farthestPixelDistance(f),p=s-r,_=.2*f.height,x=r+_;return[r,s,(x-_-r)/p,(x-r)/p]}function tf(f,r,s,p){if(f)return r instanceof Li&&f instanceof el?r.getTextureDescriptor(f,s,!0):{texture:f.texture,mix:Yr(p.mix),offset:p.offset,buffer:0,tileSize:1}}var gm=i.da([{name:"a_index",type:"Int16",components:1}]);class o0{constructor(r,s,p,_){const x={width:p[0],height:p[1],data:null},S=r.gl;this.targetColorTexture=new i.T(r,x,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,x,S.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(s,_),this.lastInvalidatedAt=0}updateParticleTexture(r,s){if(this.particleTextureDimension===s.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,_=s.width*s.height;this.particleTexture0=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1});const x=new i.db;x.reserve(_);for(let S=0;S<_;S++)x.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(x,gm.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=s.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function a0(f,r,s){if(!f)return null;const p=r.getTextureDescriptor(f,s,!0);if(!p)return null;let{texture:_,mix:x,offset:S,tileSize:I,buffer:R,format:$}=p;if(!_||!$)return null;let B=!1;return $==="uint32"&&(B=!0,x[3]=0,x=am(i.dc,x,[0,s.paint.get("raster-particle-max-speed")]),S=sm(i.dc,S,[0,s.paint.get("raster-particle-max-speed")])),{texture:_,textureOffset:[R/(I+2*R),I/(I+2*R)],tileSize:I,scalarData:B,scale:x,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[$]]}}function s0(f){const r=f._nearZ,s=f.projection.farthestPixelDistance(f),p=s-r,_=.2*f.height,x=r+_;return[r,s,(x-_-r)/p,(x-r)/p]}const Zc=new i.aj(1,0,0,1),ub=new i.aj(0,1,0,1),db=new i.aj(0,0,1,1),l0=new i.aj(1,0,1,1),nf=new i.aj(0,1,1,1);function sl(f,r,s,p,_,x,S){const I=f.context,R=f.transform,$=I.gl,B=R.projection.name==="globe",j=B?["PROJECTION_GLOBE_VIEW"]:[];let U=i.ab.mat4.clone(s.projMatrix);if(B&&i.ae(R.zoom)>0){const ct=i.ba(s.canonical,R),St=i.dd(ct);U=i.ab.mat4.multiply(new Float32Array(16),R.globeMatrix,St),i.ab.mat4.multiply(U,R.projMatrix,U)}const q=i.ab.mat4.create();q[12]+=2*_/(i.q.devicePixelRatio*R.width),q[13]+=2*x/(i.q.devicePixelRatio*R.height),i.ab.mat4.multiply(U,q,U);const ce=f.getOrCreateProgram("debug",{defines:j}),ie=r.getTileByID(s.key);f.terrain&&f.terrain.setupElevationDraw(ie,ce);const he=Cn.disabled,de=Rn.disabled,ve=f.colorModeForRenderPass(),Me="$debug";I.activeTexture.set($.TEXTURE0),f.emptyTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),B?ie._makeGlobeTileDebugBuffers(f.context,R):ie._makeDebugTileBoundsBuffers(f.context,R.projection);const Te=ie._tileDebugBuffer||f.debugBuffer,Be=ie._tileDebugIndexBuffer||f.debugIndexBuffer,Pe=ie._tileDebugSegments||f.debugSegments;if(ce.draw(f,$.LINE_STRIP,he,de,ve,Ln.disabled,Xl(U,p),Me,Te,Be,Pe,null,null,null,[ie._globeTileDebugBorderBuffer]),S){const ct=ie.latestRawTileData,St=Math.floor((ct&&ct.byteLength||0)/1024);let bt=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(bt+=` => ${s.overscaledZ}`),bt+=` ${ie.state}`,bt+=` ${St}kb`,function(st,_t){st.initDebugOverlayCanvas();const $t=st.debugOverlayCanvas,ot=st.context.gl,Et=st.debugOverlayCanvas.getContext("2d");Et.clearRect(0,0,$t.width,$t.height),Et.shadowColor="white",Et.shadowBlur=2,Et.lineWidth=1.5,Et.strokeStyle="white",Et.textBaseline="top",Et.font="bold 36px Open Sans, sans-serif",Et.fillText(_t,5,5),Et.strokeText(_t,5,5),st.debugOverlayTexture.update($t),st.debugOverlayTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}(f,bt)}const Le=r.getTile(s).tileSize,Ae=512/Math.min(Le,512)*(s.overscaledZ/R.zoom)*.5,Ue=ie._tileDebugTextBuffer||f.debugBuffer,tt=ie._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,gt=ie._tileDebugTextSegments||f.debugSegments;ce.draw(f,$.TRIANGLES,he,de,Wn.alphaBlended,Ln.disabled,Xl(U,i.aj.transparent,Ae),Me,Ue,tt,gt,null,null,null,[ie._globeTileDebugTextBuffer])}function _m(f,r,s,p){Jl(f,0,r+s/2,f.transform.width,s,p)}function ym(f,r,s,p){Jl(f,r-s/2,0,s,f.transform.height,p)}function Jl(f,r,s,p,_,x){const S=f.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(r*i.q.devicePixelRatio,s*i.q.devicePixelRatio,p*i.q.devicePixelRatio,_*i.q.devicePixelRatio),S.clear({color:x}),I.disable(I.SCISSOR_TEST)}const rf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ka}=rf;function Is(f,r,s,p){f.emplaceBack(r,s,p)}class c0{constructor(r){this.vertexArray=new i.de,this.indices=new i.aU,Is(this.vertexArray,-1,-1,1),Is(this.vertexArray,1,-1,1),Is(this.vertexArray,-1,1,1),Is(this.vertexArray,1,1,1),Is(this.vertexArray,-1,-1,-1),Is(this.vertexArray,1,-1,-1),Is(this.vertexArray,-1,1,-1),Is(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Ka),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function Wi(f,r,s,p,_,x){const S=f.context.gl,I=r.paint.get("sky-atmosphere-color"),R=r.paint.get("sky-atmosphere-halo-color"),$=r.paint.get("sky-atmosphere-sun-intensity"),B=((j,U,q,ce,ie)=>({u_matrix_3f:j,u_sun_direction:U,u_sun_intensity:q,u_color_tint_r:[ce.r,ce.g,ce.b,ce.a],u_color_tint_m:[ie.r,ie.g,ie.b,ie.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),p),_,$,I,R);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+x,r.skyboxTexture,0),s.draw(f,S.TRIANGLES,Cn.disabled,Rn.disabled,Wn.unblended,Ln.frontCW,B,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const hb=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class gd{constructor(r){const s=new i.df;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const p=new i.aU;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(s,hb.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const kr=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class gr{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class u0{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Wn([1,Nl,1,Nl],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Wn([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new gr,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const s=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new gd(s);const p=this.params.sizeRange,_=this.params.intensityRange,x=function(B){const j=i.di(30),U=[];for(let q=0;q<B;++q){const ce=2*Math.PI*j(),ie=Math.acos(1-2*j())-.5*Math.PI;U.push(i.ab.vec3.fromValues(Math.cos(ie)*Math.cos(ce),Math.cos(ie)*Math.sin(ce),Math.sin(ie)))}return U}(this.params.starsCount),S=i.di(300),I=new i.dg,R=new i.aU;let $=0;for(let B=0;B<x.length;++B){const j=i.ab.vec3.scale([],x[B],200),U=Math.max(0,1+.01*p*(1*S()-.5)),q=Math.max(0,1+.01*_*(1*S()-.5));I.emplaceBack(j[0],j[1],j[2],-1,-1,U,q),I.emplaceBack(j[0],j[1],j[2],1,-1,U,q),I.emplaceBack(j[0],j[1],j[2],1,1,U,q),I.emplaceBack(j[0],j[1],j[2],-1,1,U,q),R.emplaceBack($+0,$+1,$+2),R.emplaceBack($+0,$+2,$+3),$+=4}this.starsVx=s.createVertexBuffer(I,kr.members),this.starsIdx=s.createIndexBuffer(R),this.starsSegments=i.b7.simpleSegment(0,0,I.length,R.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,s){const p=r.context,_=p.gl,x=r.transform,S=new Cn(_.LEQUAL,Cn.ReadOnly,[0,1]),I=i.ae(x.zoom),R=r.style.getLut(s.scope),$=s.properties.get("color-use-theme")==="none",B=s.properties.get("color").toRenderColor($?null:R).toArray01(),j=s.properties.get("high-color-use-theme")==="none",U=s.properties.get("high-color").toRenderColor(j?null:R).toArray01(),q=s.properties.get("space-color-use-theme")==="none",ce=s.properties.get("space-color").toRenderColor(q?null:R).toArray01PremultipliedAlpha(),ie=5e-4,he=i.dh(s.properties.get("horizon-blend"),0,1,ie,.25),de=i.cC(r,p,x)&&he===ie?x.worldSize/(2*Math.PI*1.025)-1:x.globeRadius,ve=r.frameCounter/1e3%1,Me=i.ab.vec3.length(x.globeCenterInViewSpace),Te=Math.sqrt(Math.pow(Me,2)-Math.pow(de,2)),Be=Math.acos(Te/Me),Pe=Le=>{const Ae=x.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Le&&Ae.push("ALPHA_PASS");const Ue=r.getOrCreateProgram("globeAtmosphere",{defines:Ae}),tt=((ct,St,bt,st,_t,$t,ot,Et,yt,Gt,Ot,Tt)=>({u_frustum_tl:ct,u_frustum_tr:St,u_frustum_br:bt,u_frustum_bl:st,u_horizon:_t,u_transition:$t,u_fadeout_range:ot,u_color:Et,u_high_color:yt,u_space_color:Gt,u_temporal_offset:Ot,u_horizon_angle:Tt}))(x.frustumCorners.TL,x.frustumCorners.TR,x.frustumCorners.BR,x.frustumCorners.BL,x.frustumCorners.horizon,I,he,B,U,ce,ve,Be);r.uploadCommonUniforms(p,Ue);const gt=this.atmosphereBuffer;gt&&Ue.draw(r,_.TRIANGLES,S,Rn.disabled,Le?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Ln.backCW,tt,Le?"atmosphere_glow_alpha":"atmosphere_glow",gt.vertexBuffer,gt.indexBuffer,gt.segments)};Pe(!1),Pe(!0)}drawStars(r,s){const p=i.aw(s.properties.get("star-intensity"),0,1);if(p===0)return;const _=r.context,x=_.gl,S=r.transform,I=r.getOrCreateProgram("stars"),R=i.ab.quat.identity([]);i.ab.quat.rotateX(R,R,-S._pitch),i.ab.quat.rotateZ(R,R,-S.angle),i.ab.quat.rotateX(R,R,i.ai(S._center.lat)),i.ab.quat.rotateY(R,R,-i.ai(S._center.lng));const $=i.ab.mat4.fromQuat(new Float32Array(16),R),B=i.ab.mat4.multiply([],S.starsProjMatrix,$),j=i.ab.mat3.fromMat4([],$),U=i.ab.mat3.invert([],j),q=[0,1,0];i.ab.vec3.transformMat3(q,q,U),i.ab.vec3.scale(q,q,this.params.sizeMultiplier);const ce=[1,0,0];i.ab.vec3.transformMat3(ce,ce,U),i.ab.vec3.scale(ce,ce,this.params.sizeMultiplier);const ie=(he=q,de=ce,ve=p,{u_matrix:Float32Array.from(B),u_up:he,u_right:de,u_intensity_multiplier:ve});var he,de,ve;r.uploadCommonUniforms(_,I),this.starsVx&&this.starsIdx&&I.draw(r,x.TRIANGLES,Cn.disabled,Rn.disabled,this.colorModeAlphaBlendedWriteRGB,Ln.disabled,ie,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function As(f,r){const s=[...f],p=r.cameraWorldSizeForFog/r.worldSize,_=i.ab.mat4.identity([]);return i.ab.mat4.scale(_,_,[p,p,1]),i.ab.mat4.multiply(s,_,s),i.ab.mat4.multiply(s,r.worldToFogMatrix,s),s}function Yc(f,r,s,p,_){const x=s.material,S=p.context,{baseColorTexture:I,metallicRoughnessTexture:R}=x.pbrMetallicRoughness,{normalTexture:$,occlusionTexture:B,emissionTexture:j}=x;function U(ce,ie,he){if(ce&&(f.push(ie),S.activeTexture.set(S.gl.TEXTURE0+he),ce.gfxTexture)){const{minFilter:de,magFilter:ve,wrapS:Me,wrapT:Te}=ce.sampler;ce.gfxTexture.bindExtraParam(de,ve,Me,Te)}}U(I,"HAS_TEXTURE_u_baseColorTexture",oo.BaseColor),U(R,"HAS_TEXTURE_u_metallicRoughnessTexture",oo.MetallicRoughness),U($,"HAS_TEXTURE_u_normalTexture",oo.Normal),U(B,"HAS_TEXTURE_u_occlusionTexture",oo.Occlusion),U(j,"HAS_TEXTURE_u_emissionTexture",oo.Emission),_&&(_.texture||(_.texture=new i.dk(p.context,_.image,[_.image.height,_.image.height,_.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+oo.LUT),_.texture&&_.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),s.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(s.texcoordBuffer)),s.colorBuffer&&(f.push(s.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(s.colorBuffer)),s.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(s.normalBuffer)),s.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(s.pbrBuffer)),x.alphaMode!=="OPAQUE"&&x.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),x.defined||f.push("DIFFUSE_SHADED");const q=p.shadowRenderer;q&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&f.push("NORMAL_OFFSET"))}function Ps(f,r,s,p,_,x){const S=s.paint.get("model-opacity").constantOr(1),I=r.context,R=new Cn(r.context.gl.LEQUAL,Cn.ReadWrite,r.depthRangeFor3D),$=r.transform,B=f.mesh,j=B.material,U=j.pbrMetallicRoughness,q=r.style.fog;let ce;ce=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:i.ab.mat4.multiply([],p.zScaleMatrix,f.nodeModelMatrix),i.ab.mat4.multiply(ce,p.negCameraPosMatrix,ce);const ie=i.ab.mat4.invert([],ce);i.ab.mat4.transpose(ie,ie);const he=s.paint.get("model-color-use-theme").constantOr("default")==="none",de=s.paint.get("model-emissive-strength").constantOr(0),ve=hd(new Float32Array(f.worldViewProjection),new Float32Array(ce),new Float32Array(ie),null,r,S,U.baseColorFactor.toRenderColor(null),j.emissiveFactor,U.metallicFactor,U.roughnessFactor,j,de,s),Me={defines:[]},Te=[],Be=r.shadowRenderer;Be&&(Be.useNormalOffset=!1),Yc(Me.defines,Te,B,r,he?null:s.lut);let Pe=null;if(q){const Ue=As(f.nodeModelMatrix,r.transform);if(Pe=new Float32Array(Ue),$.projection.name!=="globe"){const tt=B.aabb.min,gt=B.aabb.max,[ct,St]=q.getOpacityForBounds(Ue,tt[0],tt[1],gt[0],gt[1]);Me.overrideFog=ct>=ze||St>=ze}}const Le=nl(r,s.paint.get("model-cutoff-fade-range"));Le.shouldRenderCutoff&&Me.defines.push("RENDER_CUTOFF");const Ae=r.getOrCreateProgram("model",Me);r.uploadCommonUniforms(I,Ae,null,Pe,Le),r.renderPass!=="shadow"&&Be&&Be.setupShadowsFromMatrix(f.nodeModelMatrix,Ae),Ae.draw(r,I.gl.TRIANGLES,R,_,x,B.material.doubleSided?Ln.disabled:Ln.backCCW,ve,s.id,B.vertexBuffer,B.indexBuffer,B.segments,s.paint,r.transform.zoom,void 0,Te)}function of(f,r,s,p,_,x,S){let I;I=f.projection.name==="globe"?i.dl(s,f):[...s],i.ab.mat4.multiply(I,I,r.matrix);const R=i.ab.mat4.multiply([],p,I);if(r.meshes)for(const $ of r.meshes){if($.material.alphaMode!=="BLEND"){S.push({mesh:$,depth:0,modelIndex:_,worldViewProjection:R,nodeModelMatrix:I});continue}const B=i.ab.vec3.transformMat4([],$.centroid,R);!f.isOrthographic&&B[2]<=0||x.push({mesh:$,depth:B[2],modelIndex:_,worldViewProjection:R,nodeModelMatrix:I})}if(r.children)for(const $ of r.children)of(f,$,s,p,_,x,S)}function _d(f,r,s,p){const _=s.shadowRenderer;if(!_)return;const x=_.getShadowPassDepthMode(),S=_.getShadowPassColorMode(),I=_.calculateShadowPassMatrixFromMatrix(r),R=Kh(I);s.getOrCreateProgram("modelDepth",{defines:s._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,x,Rn.disabled,S,Ln.backCCW,R,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,s.transform.zoom,void 0,void 0)}function Ja(f,r,s){const p=r.updateZoomBasedPaintProperties(),_=function(x,S,I){let R,$,B,j=x.terrain?x.terrain.exaggeration():0;if(x.terrain&&j>0){const U=x.terrain,q=U.findDEMTileFor(I);q&&q.dem?R=i.dn.create(U,I,q):j=0}if(j===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),j===S.validForExaggeration&&(j===0||R&&R._demTile&&R._demTile.tileID===S.validForDEMTile.id&&R._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const U in S.instancesPerModel){const q=S.instancesPerModel[U];for(let ce=0;ce<q.instancedDataArray.length;++ce){const ie=(R?j*R.getElevationAt(0|q.instancedDataArray.float32[16*ce],0|q.instancedDataArray.float32[16*ce+1],!0,!0):0)+q.instancesEvaluatedElevation[ce];q.instancedDataArray.float32[16*ce+6]=ie,$=$?Math.min(S.terrainElevationMin,ie):ie,B=B?Math.max(S.terrainElevationMax,ie):ie}}return S.terrainElevationMin=$||0,S.terrainElevationMax=B||0,S.validForExaggeration=j,S.validForDEMTile=R&&R._demTile?{id:R._demTile.tileID,timestamp:R._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,s);(p||_)&&(r.uploaded=!1,r.upload(f.context))}const fo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function af(f,r){const s=1<<f.canonical.z,p=r.getFreeCameraOptions().position,_=r.elevation,x=f.canonical.x/s,S=(f.canonical.x+1)/s,I=f.canonical.y/s,R=(f.canonical.y+1)/s;let $=r._centerAltitude;if(_){const q=_.getMinMaxForTile(f);q&&q.max>$&&($=q.max)}const B=i.aw(p.x,x,S)-p.x,j=i.aw(p.y,I,R)-p.y,U=i.bH($,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(B*B+j*j+U*U))}function yd(f,r,s,p,_,x,S){const I=f.context,R=f.renderPass==="shadow",$=f.shadowRenderer,B=R&&$?$.getShadowPassDepthMode():new Cn(I.gl.LEQUAL,Cn.ReadWrite,f.depthRangeFor3D),j=f.isTileAffectedByFog(x);if(s.meshes)for(const U of s.meshes){const q=["MODEL_POSITION_ON_GPU"],ce=[];let ie,he,de;p.instancedDataArray.length>20&&q.push("INSTANCED_ARRAYS");const ve=nl(f,r.paint.get("model-cutoff-fade-range"));if(ve.shouldRenderCutoff&&q.push("RENDER_CUTOFF"),R&&$)ie=f.getOrCreateProgram("modelDepth",{defines:q}),he=Kh(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(s.matrix)),de=$.getShadowPassColorMode();else{Yc(q,ce,U,f,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),ie=f.getOrCreateProgram("model",{defines:q,overrideFog:j});const Te=U.material,Be=Te.pbrMetallicRoughness,Pe=r.paint.get("model-opacity").constantOr(1),Le=r.paint.get("model-emissive-strength").constantOr(0);he=hd(x.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),null,f,Pe,Be.baseColorFactor.toRenderColor(null),Te.emissiveFactor,Be.metallicFactor,Be.roughnessFactor,Te,Le,r,_),$&&(S.shadowUniformsInitialized?ie.setShadowUniformValues(I,$.getShadowUniformValues()):($.setupShadows(x.toUnwrapped(),ie,"model-tile",x.overscaledZ),S.shadowUniformsInitialized=!0)),de=ve.shouldRenderCutoff||Pe<1||Te.alphaMode!=="OPAQUE"?Wn.alphaBlended:Wn.unblended}f.uploadCommonUniforms(I,ie,x.toUnwrapped(),null,ve);const Me=U.material.doubleSided?Ln.disabled:Ln.backCCW;if(p.instancedDataArray.length>20)ce.push(p.instancedDataBuffer),ie.draw(f,I.gl.TRIANGLES,B,Rn.disabled,de,Me,he,r.id,U.vertexBuffer,U.indexBuffer,U.segments,r.paint,f.transform.zoom,void 0,ce,p.instancedDataArray.length);else{const Te=R?"u_instance":"u_normal_matrix";for(let Be=0;Be<p.instancedDataArray.length;++Be)he[Te]=new Float32Array(p.instancedDataArray.arrayBuffer,64*Be,16),ie.draw(f,I.gl.TRIANGLES,B,Rn.disabled,de,Me,he,r.id,U.vertexBuffer,U.indexBuffer,U.segments,r.paint,f.transform.zoom,void 0,ce)}}if(s.children)for(const U of s.children)yd(f,r,U,p,_,x,S)}const vm=[1,-1,1];function xm(f,r,s,p){if(!s.modelManager)return!0;const _=s.modelManager;if(!s.shadowRenderer)return!0;const x=s.shadowRenderer,S=r.aabb;let I=!0,R=f.maxHeight;if(R===0){let B=0;for(const j in f.instancesPerModel){const U=_.getModel(j,p);U?B=Math.max(B,Math.max(Math.max(U.aabb.max[0],U.aabb.max[1]),U.aabb.max[2])):I=!1}R=f.maxScale*B*1.41+f.maxVerticalOffset,I&&(f.maxHeight=R)}S.max[2]=R,S.min[2]+=f.terrainElevationMin,S.max[2]+=f.terrainElevationMax,i.ab.vec3.transformMat4(S.min,S.min,r.tileMatrix),i.ab.vec3.transformMat4(S.max,S.max,r.tileMatrix);const $=S.intersects(x.getCurrentCascadeFrustum());return s.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=$===2),$===0}function Ql(f,r){const s=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],_=f.uniformValues.u_cutoff_params[2],x=f.uniformValues.u_cutoff_params[3];return p===s||x===_?1:i.aw(((r-s)/(p-s)-_)/(x-_),0,1)}function bm(f,r,s,p){if(r.pitch<20)return 1;const _=r.getWorldToCameraMatrix();i.ab.mat4.multiply(_,_,f);const x=i.ab.vec4.fromValues(s.min[0],s.min[1],s.min[2],1);let S=i.ab.vec4.transformMat4(i.ab.vec4.create(),x,_),I=S,R=S;x[1]=s.max[1],S=i.ab.vec4.transformMat4(i.ab.vec4.create(),x,_),I=S[1]<I[1]?S:I,R=S[1]>R[1]?S:R,x[0]=s.max[0],S=i.ab.vec4.transformMat4(i.ab.vec4.create(),x,_),I=S[1]<I[1]?S:I,R=S[1]>R[1]?S:R,x[1]=s.min[1],S=i.ab.vec4.transformMat4(i.ab.vec4.create(),x,_),I=S[1]<I[1]?S:I,R=S[1]>R[1]?S:R;const $=i.aw(p[0],0,1),B=100*r.pixelsPerMeter*i.aw(p[1],0,1),j=i.aw(p[2],0,1),U=i.ab.vec4.lerp(i.ab.vec4.create(),I,R,$),q=Math.tan(.5*r.fovX),ce=-U[2]*q;if(B===0)return U[1]<-Math.abs(ce)?j:1;const ie=(-Math.abs(ce)-U[1])/B,he=(ve,Me,Te)=>(1-Te)*ve+Te*Me,de=i.aw(he(1,j,ie),j,1);return he(1,de,i.aw((r.pitch-20)/20,0,1))}class ll{}class wm{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,s,p){{const j=this._storage.get(s.id);if(j)return j.lastUsedFrameIdx=r,j.buf}const _=p.gl,x=_.getBufferParameter(_.ELEMENT_ARRAY_BUFFER,_.BUFFER_SIZE),S=new ArrayBuffer(x),I=new Int16Array(S);_.getBufferSubData(_.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const R=new i.dq;for(let j=0;j<x/2;j+=3){const U=I[j],q=I[j+1],ce=I[j+2];R.emplaceBack(U,q),R.emplaceBack(q,ce),R.emplaceBack(ce,U)}const $=p.bindVertexArrayOES.current,B=new ll;return B.buf=new Xa(p,R),B.lastUsedFrameIdx=r,this._storage.set(s.id,B),p.bindVertexArrayOES.set($),B.buf}update(r){for(const[s,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(s))}destroy(){for(const[r,s]of this._storage)s.buf.destroy(),this._storage.delete(r)}}class sf{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Sm=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Cm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class eo{constructor(r,s){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...s,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...s,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Tm=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Em{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,s){const p=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new i.dr,I=new i.aU;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),I.emplaceBack(0,1,2),I.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(S,Tm.members),this.vignetteIdx=r.context.createIndexBuffer(I)}const _=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,p);const S={u_vignetteShape:(x={vignetteShape:[s.start,s.range,Math.pow(10,s.fadePower)],vignetteColor:[s.color.r,s.color.g,s.color.b,s.color.a*s.strength]}).vignetteShape,u_vignetteColor:x.vignetteColor};p.draw(r,r.context.gl.TRIANGLES,Cn.disabled,Rn.disabled,Wn.alphaBlended,Ln.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,_,{})}var x}}class vd{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,s){const p=r.getFreeCameraOptions().position,_=p.toAltitude(),x=p.toLngLat(),S=i.ai(x.lng),I=i.ai(x.lat),R=r.pixelsPerMeter/s,$=S*i.ds,B=i.ds*Math.log(Math.tan(Math.PI/4+I/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const j=-this._offsetYPrev+B,U=-this._elevationPrev+_;this._accumulatedOffsetX+=(-this._offsetXPrev+$)*R,this._accumulatedOffsetY+=j*R,this._accumulatedElevation+=U*R,this._offsetXPrev=$,this._offsetYPrev=B,this._elevationPrev=_}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function cl(f,r){return[-(f[0]-Math.floor(f[0]/r)*r),-(f[1]-Math.floor(f[1]/r)*r),-(f[2]-Math.floor(f[2]/r)*r)]}function lf(f){const r=i.di(1323123451230),s=[];for(let p=0;p<f;++p){const _=2*r()-1,x=2*r()-1,S=2*r()-1;s.push(i.ab.vec3.fromValues(_,x,S))}return s}function Qa(f,r,s,p,_){const x=i.aw((_-s)/(p-s),0,1);return(1-x)*f+x*r}class cf{constructor(r){this._movement=new vd,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Em,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,s){const p=r.transform;this._movement.update(p,this._ppmScaleFactor);const _=p.starsProjMatrix,x=i.ab.quat.identity([]);i.ab.quat.rotateX(x,x,i.ai(90)-p._pitch),i.ab.quat.rotateZ(x,x,-p.angle);const S=i.ab.mat4.fromQuat(new Float32Array(16),x),I=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),R=i.ab.mat4.transpose([],I),$=i.ab.mat4.multiply([],R,S),B=Date.now()/1e3;return this._accumulatedTimeFromStart+=(B-this._prevTime)*s,this._prevTime=B,{projectionMatrix:_,modelviewMatrix:$}}}class Xc extends cf{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new eo(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const s=r.context;if(!this.particlesVx){const p=lf(this.particlesCount),_=new i.dt,x=new i.aU;let S=0;const I=i.di(1323123451230);for(let R=0;R<p.length;++R){const $=p[R],B=[2*I()-1,I(),I(),I()];_.emplaceBack($[0],$[1],$[2],-1,-1,...B),_.emplaceBack($[0],$[1],$[2],1,-1,...B),_.emplaceBack($[0],$[1],$[2],1,1,...B),_.emplaceBack($[0],$[1],$[2],-1,1,...B),x.emplaceBack(S+0,S+1,S+2),x.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=s.createVertexBuffer(_,Sm.members),this.particlesIdx=s.createIndexBuffer(x)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const s=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},p=r.transform.zoom;if(s.revealStart>p)return;const _=Qa(0,1,s.revealStart,s.revealStart+s.revealRange,p);if(!this.particlesVx||!this.particlesIdx)return;const x=structuredClone(this._params);let S=[-x.direction.x,x.direction.y,-100];i.ab.vec3.normalize(S,S);const I=structuredClone(this._vignetteParams);I.strength*=_,x.overrideStyleParameters||(x.intensity=r.style.rain.state.density,x.timeFactor=r.style.rain.state.intensity,x.color=structuredClone(r.style.rain.state.color),S=structuredClone(r.style.rain.state.direction),x.screenThinning.intensity=r.style.rain.state.centerThinning,x.dropletSizeX=r.style.rain.state.dropletSize[0],x.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],x.distortionStrength=100*r.style.rain.state.distortionStrength,I.strength=1,I.color=structuredClone(r.style.rain.state.vignetteColor));const R=this.updateOnRender(r,x.timeFactor),$=r.context,B=$.gl,j=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new i.T($,{width:r.width,height:r.height,data:null},B.RGBA8)),x.distortionStrength>0&&($.activeTexture.set(B.TEXTURE0),this.screenTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),B.copyTexSubImage2D(B.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const U=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms($,U),$.activeTexture.set(B.TEXTURE0),this.screenTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const q=[x.color.r,x.color.g,x.color.b,x.color.a],ce=(ie,he)=>{const de=cl(this._movement.getPosition(),ie),ve=x.dropletSizeX,Me=x.dropletSizeX*x.dropletSizeYScale,Te=r.width/2,Be=r.height/2,Pe=Qa(0,x.screenThinning.start,0,1,x.screenThinning.intensity),Le=Qa(.001,x.screenThinning.range,0,1,x.screenThinning.intensity),Ae=Qa(0,x.screenThinning.particleOffset,0,1,x.screenThinning.intensity),Ue=(tt={modelview:R.modelviewMatrix,projection:R.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:de,velocityConeAperture:x.velocityConeAperture,velocity:x.velocity,boxSize:ie,rainDropletSize:[ve,Me],distortionStrength:x.distortionStrength,rainDirection:S,color:q,screenSize:[j.width,j.height],thinningCenterPos:[Te,Be],thinningShape:[Pe,Le,Math.pow(10,x.screenThinning.fadePower)],thinningAffectedRatio:x.screenThinning.affectedRatio,thinningParticleOffset:Ae,shapeDirectionalPower:x.shapeDirPower,shapeNormalPower:x.shapeNormalPower,mode:he?0:1},{u_modelview:Float32Array.from(tt.modelview),u_projection:Float32Array.from(tt.projection),u_time:tt.time,u_cam_pos:tt.camPos,u_texScreen:0,u_velocityConeAperture:tt.velocityConeAperture,u_velocity:tt.velocity,u_boxSize:tt.boxSize,u_rainDropletSize:tt.rainDropletSize,u_distortionStrength:tt.distortionStrength,u_rainDirection:tt.rainDirection,u_color:tt.color,u_screenSize:tt.screenSize,u_thinningCenterPos:tt.thinningCenterPos,u_thinningShape:tt.thinningShape,u_thinningAffectedRatio:tt.thinningAffectedRatio,u_thinningParticleOffset:tt.thinningParticleOffset,u_shapeDirectionalPower:tt.shapeDirectionalPower,u_shapeNormalPower:tt.shapeNormalPower,u_mode:tt.mode});var tt;const gt=Math.round(x.intensity*this.particlesCount),ct=i.b7.simpleSegment(0,0,4*gt,2*gt);U.draw(r,B.TRIANGLES,Cn.disabled,Rn.disabled,Wn.alphaBlended,Ln.disabled,Ue,"rain_particles",this.particlesVx,this.particlesIdx,ct,{})};x.distortionStrength>0&&ce(x.boxSize,!0),ce(x.boxSize,!1),this._vignette.draw(r,I)}}const Mm=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Im extends cf{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new eo(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const s=r.context;if(!this.particlesVx){const p=lf(this.particlesCount),_=new i.du,x=new i.aU;let S=0;const I=i.di(1323123451230);for(let R=0;R<p.length;++R){const $=p[R],B=I(),j=I(),U=I(),q=[R/p.length,B,j,U],ce=[I(),I()];_.emplaceBack($[0],$[1],$[2],-1,-1,...q,...ce),_.emplaceBack($[0],$[1],$[2],1,-1,...q,...ce),_.emplaceBack($[0],$[1],$[2],1,1,...q,...ce),_.emplaceBack($[0],$[1],$[2],-1,1,...q,...ce),x.emplaceBack(S+0,S+1,S+2),x.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=s.createVertexBuffer(_,Mm.members),this.particlesIdx=s.createIndexBuffer(x)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const s=structuredClone(this._params);let p=[-s.direction.x,s.direction.y,-100];i.ab.vec3.normalize(p,p);const _=structuredClone(this._vignetteParams),x=s.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=r.transform.zoom;if(x.revealStart>S)return;const I=Qa(0,1,x.revealStart,x.revealStart+x.revealRange,S);_.strength*=I,s.overrideStyleParameters||(s.intensity=r.style.snow.state.density,s.timeFactor=r.style.snow.state.intensity,s.color=structuredClone(r.style.snow.state.color),p=structuredClone(r.style.snow.state.direction),s.screenThinning.intensity=r.style.snow.state.centerThinning,s.billboardSize=2.79*r.style.snow.state.flakeSize,_.strength=1,_.color=structuredClone(r.style.snow.state.vignetteColor));const R=this.updateOnRender(r,s.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const $=r.context,B=$.gl,j=r.transform,U=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms($,U),((q,ce,ie)=>{const he=cl(this._movement.getPosition(),q),de=j.width/2,ve=j.height/2,Me=Qa(0,ie.screenThinning.start,0,1,ie.screenThinning.intensity),Te=Qa(.001,ie.screenThinning.range,0,1,ie.screenThinning.intensity),Be=Qa(0,ie.screenThinning.particleOffset,0,1,ie.screenThinning.intensity),Pe=(Le={modelview:R.modelviewMatrix,projection:R.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:he,velocityConeAperture:ie.velocityConeAperture,velocity:ie.velocity,horizontalOscillationRadius:ie.horizontalOscillationRadius,horizontalOscillationRate:ie.horizontalOscillationRate,boxSize:q,billboardSize:1*ie.billboardSize,simpleShapeParameters:[ie.shapeFadeStart,ie.shapeFadePower],screenSize:[j.width,j.height],thinningCenterPos:[de,ve],thinningShape:[Me,Te,Math.pow(10,ie.screenThinning.fadePower)],thinningAffectedRatio:ie.screenThinning.affectedRatio,thinningParticleOffset:Be,color:[ie.color.r,ie.color.g,ie.color.b,ie.color.a],direction:p},{u_modelview:Float32Array.from(Le.modelview),u_projection:Float32Array.from(Le.projection),u_time:Le.time,u_cam_pos:Le.camPos,u_velocityConeAperture:Le.velocityConeAperture,u_velocity:Le.velocity,u_horizontalOscillationRadius:Le.horizontalOscillationRadius,u_horizontalOscillationRate:Le.horizontalOscillationRate,u_boxSize:Le.boxSize,u_billboardSize:Le.billboardSize,u_simpleShapeParameters:Le.simpleShapeParameters,u_screenSize:Le.screenSize,u_thinningCenterPos:Le.thinningCenterPos,u_thinningShape:Le.thinningShape,u_thinningAffectedRatio:Le.thinningAffectedRatio,u_thinningParticleOffset:Le.thinningParticleOffset,u_particleColor:Le.color,u_direction:Le.direction});var Le;const Ae=Math.round(ie.intensity*this.particlesCount),Ue=i.b7.simpleSegment(0,0,4*Ae,2*Ae);this.particlesVx&&this.particlesIdx&&U.draw(r,B.TRIANGLES,Cn.disabled,Rn.disabled,Wn.alphaBlended,Ln.disabled,Pe,"snow_particles",this.particlesVx,this.particlesIdx,Ue,{})})(s.boxSize,0,s),this._vignette.draw(r,_)}}const xd={symbol:function(f,r,s,p,_){if(f.renderPass!=="translucent")return;const x=Rn.disabled,S=f.colorModeForRenderPass(),I=s.layout.get("text-variable-anchor"),R=s.layout.get("text-size-scale-range"),$=i.aw(f.scaleFactor,R[0],R[1]);I&&function(U,q,ce,ie,he,de,ve,Me){const Te=q.transform,Be=he==="map",Pe=de==="map";for(const Le of U){const Ae=ie.getTile(Le),Ue=Ae.getBucket(ce);if(!Ue||!Ue.text||!Ue.text.segments.get().length)continue;const tt=i.bp(Ue.textSizeData,Te.zoom,Me),gt=kl(Le,Ue.getProjection(),Te),ct=Te.calculatePixelsToTileUnitsMatrix(Ae),St=Ki(gt,Ae.tileID.canonical,Pe,Be,Te,Ue.getProjection(),ct),bt=Ue.hasIconTextFit()&&Ue.hasIconData();if(tt){const st=Math.pow(2,Te.zoom-Ae.tileID.overscaledZ);Qh(Ue,Be,Pe,ve,i.cX,Te,St,Le,st,tt,bt)}}}(p,f,s,r,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),_,$);const B=s.paint.get("icon-opacity").constantOr(1)!==0,j=s.paint.get("text-opacity").constantOr(1)!==0;s.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(B||j)?pd(f,r,s,p,x,S):(B&&pd(f,r,s,p,x,S,{onlyIcons:!0}),j&&pd(f,r,s,p,x,S,{onlyText:!0})),r.map.showCollisionBoxes&&(Jh(f,r,s,p,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Jh(f,r,s,p,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,s,p){if(f.renderPass!=="translucent")return;const _=s.paint.get("circle-opacity"),x=s.paint.get("circle-stroke-width"),S=s.paint.get("circle-stroke-opacity"),I=s.layout.get("circle-sort-key").constantOr(1)!==void 0,R=s.paint.get("circle-emissive-strength");if(_.constantOr(1)===0&&(x.constantOr(1)===0||S.constantOr(1)===0))return;const $=f.context,B=$.gl,j=f.transform,U=f.depthModeForSublayer(0,Cn.ReadOnly),q=Rn.disabled,ce=f.colorModeForDrapableLayerRenderPass(R),ie=j.projection.name==="globe",he=[i.at(j.center.lng),i.aA(j.center.lat)],de=[];for(let Me=0;Me<p.length;Me++){const Te=p[Me],Be=r.getTile(Te),Pe=Be.getBucket(s);if(!Pe||Pe.projection.name!==j.projection.name)continue;const Le=Pe.programConfigurations.get(s.id),Ae=i.cY(s),Ue=f.isTileAffectedByFog(Te);ie&&Ae.push("PROJECTION_GLOBE_VIEW"),Ae.push("DEPTH_D24"),f.terrain&&j.depthOcclusionForSymbolsAndCircles&&Ae.push("DEPTH_OCCLUSION");const tt=f.getOrCreateProgram("circle",{config:Le,defines:Ae,overrideFog:Ue}),gt=Pe.layoutVertexBuffer,ct=Pe.globeExtVertexBuffer,St=Pe.indexBuffer,bt=j.projection.createInversionMatrix(j,Te.canonical),st={programConfiguration:Le,program:tt,layoutVertexBuffer:gt,globeExtVertexBuffer:ct,indexBuffer:St,uniformValues:i.cZ(f,Te,Be,bt,he,s),tile:Be};if(I){const _t=Pe.segments.get();for(const $t of _t)de.push({segments:new i.b7([$t]),sortKey:$t.sortKey,state:st})}else de.push({segments:Pe.segments,sortKey:0,state:st})}I&&de.sort((Me,Te)=>Me.sortKey-Te.sortKey);const ve={useDepthForOcclusion:j.depthOcclusionForSymbolsAndCircles};for(const Me of de){const{programConfiguration:Te,program:Be,layoutVertexBuffer:Pe,globeExtVertexBuffer:Le,indexBuffer:Ae,uniformValues:Ue,tile:tt}=Me.state,gt=Me.segments;f.terrain&&f.terrain.setupElevationDraw(tt,Be,ve),f.uploadCommonUniforms($,Be,tt.tileID.toUnwrapped()),Be.draw(f,B.TRIANGLES,U,q,ce,Ln.disabled,Ue,s.id,Pe,Ae,gt,s.paint,j.zoom,Te,[Le])}},heatmap:function(f,r,s,p){if(s.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const _=f.context,x=_.gl,S=Rn.disabled,I=new Wn([x.ONE,x.ONE,x.ONE,x.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(q,ce,ie,he){const de=q.gl,ve=ce.width*he,Me=ce.height*he;q.activeTexture.set(de.TEXTURE1),q.viewport.set([0,0,ve,Me]);let Te=ie.heatmapFbo;if(!Te||Te&&(Te.width!==ve||Te.height!==Me)){Te&&Te.destroy();const Be=de.createTexture();de.bindTexture(de.TEXTURE_2D,Be),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MAG_FILTER,de.LINEAR),Te=ie.heatmapFbo=q.createFramebuffer(ve,Me,!0,null),function(Pe,Le,Ae,Ue,tt,gt){const ct=Pe.gl;ct.texImage2D(ct.TEXTURE_2D,0,Pe.extRenderToTextureHalfFloat?ct.RGBA16F:ct.RGBA,tt,gt,0,ct.RGBA,Pe.extRenderToTextureHalfFloat?ct.HALF_FLOAT:ct.UNSIGNED_BYTE,null),Ue.colorAttachment.set(Ae)}(q,0,Be,Te,ve,Me)}else de.bindTexture(de.TEXTURE_2D,Te.colorAttachment.get()),q.bindFramebuffer.set(Te.framebuffer)})(_,f,s,f.transform.projection.name==="globe"?.5:.25),_.clear({color:i.aj.transparent});const R=f.transform,$=R.projection.name==="globe",B=$?["PROJECTION_GLOBE_VIEW"]:[],j=$?Ln.frontCCW:Ln.disabled,U=[i.at(R.center.lng),i.aA(R.center.lat)];for(let q=0;q<p.length;q++){const ce=p[q];if(r.hasRenderableParent(ce))continue;const ie=r.getTile(ce),he=ie.getBucket(s);if(!he||he.projection.name!==R.projection.name)continue;const de=f.isTileAffectedByFog(ce),ve=he.programConfigurations.get(s.id),Me=f.getOrCreateProgram("heatmap",{config:ve,defines:B,overrideFog:de}),{zoom:Te}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ie,Me),f.uploadCommonUniforms(_,Me,ce.toUnwrapped());const Be=R.projection.createInversionMatrix(R,ce.canonical);Me.draw(f,x.TRIANGLES,Cn.disabled,S,I,j,fn(f,ce,ie,Be,U,Te,s.paint.get("heatmap-intensity")),s.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,s.paint,f.transform.zoom,ve,$?[he.globeExtVertexBuffer]:null)}_.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(_,x){const S=_.context,I=S.gl,R=x.heatmapFbo;if(!R)return;S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get()),S.activeTexture.set(I.TEXTURE1);let $=x.colorRampTexture;$||($=x.colorRampTexture=new i.T(S,x.colorRamp,I.RGBA8)),$.bind(I.LINEAR,I.CLAMP_TO_EDGE),_.getOrCreateProgram("heatmapTexture").draw(_,I.TRIANGLES,Cn.disabled,Rn.disabled,_.colorModeForRenderPass(),Ln.disabled,((B,j,U,q)=>({u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}))(0,x),x.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,x.paint,_.transform.zoom)}(f,s))},line:function(f,r,s,p){if(f.renderPass!=="translucent")return;const _=s.paint.get("line-opacity"),x=s.paint.get("line-width");if(_.constantOr(1)===0||x.constantOr(1)===0)return;const S=s.paint.get("line-emissive-strength"),I=s.paint.get("line-occlusion-opacity"),R=s.layout.get("line-elevation-reference"),$=s.layout.get("line-width-unit")==="meters",B=R==="sea",j=f.context,U=j.gl;if(s.hasElevatedBuckets&&f.transform.projection.name==="globe")return;const q=s.layout.get("line-cross-slope"),ce=q!==void 0,ie=q<1,he=f.colorModeForDrapableLayerRenderPass(S),de=f.terrain&&f.terrain.renderingToTexture,ve=de?1:i.q.devicePixelRatio,Me=s.paint.get("line-dasharray"),Te=Me.constantOr(1),Be=s.layout.get("line-cap"),Pe=Me.constantOr(null),Le=Be.constantOr(null),Ae=s.paint.get("line-pattern"),Ue=Ae.constantOr(1),tt=Ae.constantOr(null),gt=s.paint.get("line-opacity").constantOr(1);let ct=!Ue&&gt!==1||f.depthOcclusion&&I>0&&I<1;const St=s.paint.get("line-gradient"),bt=Ue?"linePattern":"line",st=i.c_(s);let _t;if(de&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ct=!1),I!==0&&f.depthOcclusion){const ot=s.paint._values["line-opacity"];ot&&ot.value&&ot.value.kind==="constant"?_t=ot.value:i.w(`Occlusion opacity for layer ${s.id} is supported only when line-opacity isn't data-driven.`)}x.value.kind!=="constant"&&x.value.isLineProgressConstant===!1&&st.push("VARIABLE_LINE_WIDTH");const $t=(ot,Et,yt,Gt,Ot)=>{for(const Tt of ot){const Bt=r.getTile(Tt);if(Ue&&!Bt.patternsLoaded())continue;const Ht=Bt.getBucket(s);if(!Ht||Ht.hasZOffset&&!Ot||!Ht.hasZOffset&&Ot)continue;f.prepareDrawTile();const rn=Ht.programConfigurations.get(s.id),dn=f.isTileAffectedByFog(Tt),Dn=f.getOrCreateProgram(bt,{config:rn,defines:Et,overrideFog:dn,overrideRtt:!Ot&&void 0});if(tt&&Bt.imageAtlas){const Bn=i.A.from(tt).getPrimary().scaleSelf(ve).serialize(),or=Bt.imageAtlas.patternPositions[Bn];or&&rn.setConstantPatternPositions(or)}if(!Ue&&Pe&&Le&&Bt.lineAtlas){const Bn=Bt.lineAtlas.getDash(Pe,Le);Bn&&rn.setConstantPatternPositions(Bn)}let[wn,Tn]=s.paint.get("line-trim-offset");(Le==="round"||Le==="square")&&wn!==Tn&&(wn===0&&(wn-=1),Tn===1&&(Tn+=1));const $n=de?Tt.projMatrix:null,Jn=$?1/Ht.tileToMeter/i.ar(Bt,1,f.transform.zoom):1,Tr=$?1/Ht.tileToMeter/i.ar(Bt,1,Math.floor(f.transform.zoom)):1,ei=Ue?i.c$(f,Bt,s,$n,ve,Jn,Tr,[wn,Tn]):i.d0(f,Bt,s,$n,Ht.lineClipsArray.length,ve,Jn,Tr,[wn,Tn]);if(St){const Bn=Ht.gradients[s.id];let or=Bn.texture;if(s.gradientVersion!==Bn.version){let vn=256;if(s.stepInterpolant){const Xn=r.getSource().maxzoom,pr=Tt.canonical.z===Xn?Math.ceil(1<<f.transform.maxZoom-Tt.canonical.z):1;vn=i.aw(i.d1(Ht.maxLineLength/i.ag*1024*pr),256,j.maxTextureSize)}Bn.gradient=i.d2({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:vn,image:Bn.gradient||void 0,clips:Ht.lineClipsArray}),Bn.texture?Bn.texture.update(Bn.gradient):Bn.texture=new i.T(j,Bn.gradient,U.RGBA8),Bn.version=s.gradientVersion,or=Bn.texture}j.activeTexture.set(U.TEXTURE1),or.bind(s.stepInterpolant?U.NEAREST:U.LINEAR,U.CLAMP_TO_EDGE)}Te&&(j.activeTexture.set(U.TEXTURE0),Bt.lineAtlasTexture&&Bt.lineAtlasTexture.bind(U.LINEAR,U.REPEAT),rn.updatePaintBuffers()),Ue&&(j.activeTexture.set(U.TEXTURE0),Bt.imageAtlasTexture&&Bt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),rn.updatePaintBuffers()),Ot&&!B&&f.terrain.setupElevationDraw(Bt,Dn),f.uploadCommonUniforms(j,Dn,Tt.toUnwrapped());const Nr=Bn=>{_t!=null&&(_t.value=gt*I),Dn.draw(f,U.TRIANGLES,yt,Bn,he,Ln.disabled,ei,s.id,Ht.layoutVertexBuffer,Ht.indexBuffer,Ht.segments,s.paint,f.transform.zoom,rn,[Ht.layoutVertexBuffer2,Ht.patternVertexBuffer,Ht.zOffsetVertexBuffer]),_t!=null&&(_t.value=gt)};if(ct&&!Ot){const Bn=f.stencilModeForClipping(Tt).ref;Bn===0&&de&&j.clear({stencil:0});const or={func:U.EQUAL,mask:255};ei.u_alpha_discard_threshold=.8,Nr(new Rn(or,Bn,255,U.KEEP,U.KEEP,U.INVERT)),ei.u_alpha_discard_threshold=0,Nr(new Rn(or,Bn,255,U.KEEP,U.KEEP,U.KEEP))}else ct&&Ot&&(ei.u_alpha_discard_threshold=.001),Nr(Ot?Gt:f.stencilModeForClipping(Tt))}};if(s.hasNonElevatedBuckets){const ot=!de&&f.terrain;I!==0&&ot?i.w(`Occlusion opacity for layer ${s.id} is supported on terrain only if the layer has line-z-offset enabled.`):ot?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${s.id}.`):$t(p,st,f.depthModeForSublayer(0,Cn.ReadOnly),Rn.disabled,!1)}if(s.hasElevatedBuckets){st.push("ELEVATED"),ce&&st.push(ie?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),B&&st.push("ELEVATION_REFERENCE_SEA");const ot=ct?f.stencilModeFor3D():Rn.disabled,Et=new Cn(f.depthOcclusion?U.GREATER:U.LEQUAL,Cn.ReadOnly,f.depthRangeFor3D);f.forceTerrainMode=!0,$t(p,st,Et,ot,!0),f.forceTerrainMode=!1}ct&&(f.resetStencilClippingMasks(),de&&j.clear({stencil:0})),I===0||f.depthOcclusion||de||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,r,s,p){const _=s.paint.get("fill-color"),x=s.paint.get("fill-opacity"),S=s.is3D(),I=new Cn(f.context.gl.LEQUAL,Cn.ReadWrite,f.depthRangeFor3D);if(x.constantOr(1)===0)return;const R=s.paint.get("fill-emissive-strength"),$=f.colorModeForDrapableLayerRenderPass(R),B=s.paint.get("fill-pattern"),j=f.opaquePassEnabledForLayer()&&!B.constantOr(1)&&_.constantOr(i.aj.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===j){const U=S?I:f.depthModeForSublayer(1,f.renderPass==="opaque"?Cn.ReadWrite:Cn.ReadOnly);mm(f,r,s,p,U,$,!1)}if(!S&&f.renderPass==="translucent"&&s.paint.get("fill-antialias")){const U=S?I:f.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,Cn.ReadOnly);mm(f,r,s,p,U,$,!0)}},"fill-extrusion":function(f,r,s,p){const _=s.paint.get("fill-extrusion-opacity"),x=f.context,S=x.gl,I=f.terrain,R=I&&I.renderingToTexture;if(_===0)return;const $=f.conflationActive&&f.style.isLayerClipped(s,r.getSource()),B=f.style.order.indexOf(s.fqid);if($&&function(j,U,q,ce,ie){for(const he of ce){const de=U.getTile(he).getBucket(q);de&&(de.updateReplacement(he,j.replacementSource,ie),de.uploadCentroid(j.context))}}(f,r,s,p,B),I||$)for(const j of p){const U=r.getTile(j).getBucket(s);U&&Gc(f.context,r,j,U,s,I,$)}if(f.renderPass==="shadow"&&f.shadowRenderer){const j=f.shadowRenderer;if(I&&_<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const U=j.getShadowPassDepthMode(),q=j.getShadowPassColorMode();md(f,r,s,p,U,Rn.disabled,q,$)}else if(f.renderPass==="translucent"){const j=!s.paint.get("fill-extrusion-pattern").constantOr(1),U=s.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!R&&U.a!==0){const q=new Cn(f.context.gl.LEQUAL,Cn.ReadWrite,f.depthRangeFor3D);_===1&&j?md(f,r,s,p,q,Rn.disabled,Wn.unblended,$):(md(f,r,s,p,q,Rn.disabled,Wn.disabled,$),md(f,r,s,p,q,f.stencilModeFor3D(),f.colorModeForRenderPass(),$),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&j&&(!I&&f.transform.projection.name!=="globe"||R)){const q=s.paint.get("fill-extrusion-opacity"),ce=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),ie=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),he=s.paint.get("fill-extrusion-flood-light-intensity"),de=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ve=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(de?null:s.lut).toArray01().slice(0,3),Me=ce>0&&ie>0,Te=he>0,Be=(Le,Ae,Ue)=>(1-Ue)*Le+Ue*Ae,Pe=Le=>{const Ae=f.depthModeForSublayer(1,Cn.ReadOnly,S.LEQUAL,!0),Ue=s.paint.get(Le?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),tt=Be(.1,3,Ue),gt=f._showOverdrawInspector;if(!gt){const ct=new Rn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),St=new Wn([S.ONE,S.ONE,S.ONE,S.ONE],i.aj.transparent,[!1,!1,!1,!0],S.MIN);Hc(f,r,s,p,Ae,ct,St,Ln.disabled,Le,"sdf",q,ce,ie,he,ve,tt,$,!1)}{const ct=gt?Rn.disabled:new Rn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),St=gt?f.colorModeForRenderPass():new Wn([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],i.aj.transparent,[!0,!0,!0,!0]);Hc(f,r,s,p,Ae,ct,St,Ln.disabled,Le,"color",q,ce,ie,he,ve,tt,$,!1)}};if(R){const Le=(Ae,Ue,tt)=>{const gt=f.depthModeForSublayer(1,Cn.ReadOnly,S.LEQUAL,!1),ct=s.paint.get(Ae?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),St=Be(.1,3,ct);{const bt=new Wn([S.ONE,S.ONE,S.ONE,S.ONE],i.aj.transparent,[!1,!1,!1,!0]);Hc(f,r,s,p,gt,Rn.disabled,bt,Ln.disabled,Ae,"clear",q,ce,ie,he,ve,St,$,Ue)}{const bt=new Rn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),st=new Wn([S.ONE,S.ONE,S.ONE,S.ONE],i.aj.transparent,[!1,!1,!1,!0],S.MIN);Hc(f,r,s,p,gt,bt,st,Ln.disabled,Ae,"sdf",q,ce,ie,he,ve,St,$,Ue)}{const bt=Ae?S.ZERO:S.ONE_MINUS_DST_ALPHA,st=new Rn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),_t=new Wn([bt,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],i.aj.transparent,[!0,!0,!0,!0]);Hc(f,r,s,p,gt,st,_t,Ln.disabled,Ae,"color",q,ce,ie,he,ve,St,$,Ue)}{const bt=new Wn([S.ONE,S.ONE,S.ONE,Ae?S.ZERO:S.ONE],i.aj.transparent,[!1,!1,!1,!0],Ae?S.FUNC_ADD:S.MAX);Hc(f,r,s,p,gt,Rn.disabled,bt,Ln.disabled,Ae,"clear",q,ce,ie,he,ve,St,$,Ue,tt)}};if(Me||Te){let Ae;if(f.prepareDrawTile(),I){const Ue=I.drapeBufferSize[0],tt=I.drapeBufferSize[1];Ae=I.framebufferCopyTexture,Ae&&(!Ae||Ae.size[0]===Ue&&Ae.size[1]===tt)||(Ae&&Ae.destroy(),Ae=I.framebufferCopyTexture=new i.T(x,new i.r({width:Ue,height:tt}),S.RGBA8)),Ae.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,Ue,tt)}Me&&Le(!0,!1,Ae),Te&&Le(!1,!0,Ae)}}else Me&&Pe(!0),Te&&Pe(!1),(Me||Te)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,s,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const _=f.context,x=f.terrain&&f.terrain.renderingToTexture,[S,I]=f.renderPass!=="translucent"||x?[{},p]:f.stencilConfigForOverlap(p);for(const R of I){const $=r.getTile(R);if($.needsHillshadePrepare&&f.renderPass==="offscreen")Xx(f,$,s);else if(f.renderPass==="translucent"){const B=f.depthModeForSublayer(0,Cn.ReadOnly),j=s.paint.get("hillshade-emissive-strength"),U=f.colorModeForDrapableLayerRenderPass(j),q=x&&f.terrain?f.terrain.stencilModeForRTTOverlap(R):S[R.overscaledZ];U_(f,R,$,s,B,q,U)}}_.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,s,p,_,x){if(f.renderPass!=="translucent"||s.paint.get("raster-opacity")===0)return;const S=f.transform.projection.name==="globe",I=s.paint.get("raster-elevation")!==0,R=I&&S;if(f.renderElevatedRasterBackface&&!R)return;const $=f.context,B=$.gl,j=r.getSource(),U=function(Pe,Le,Ae,Ue){const tt=Le.paint.get("raster-color"),gt=Pe.type==="raster-array",ct=[],St=Le.paint.get("raster-resampling"),bt=Le.paint.get("raster-color-mix");let st=Le.paint.get("raster-color-range");const _t=[bt[0],bt[1],bt[2],0],$t=bt[3];let ot=St==="nearest"?Ue.NEAREST:Ue.LINEAR;if(gt&&(ct.push("RASTER_ARRAY"),tt||ct.push("RASTER_COLOR"),St==="linear"&&ct.push("RASTER_ARRAY_LINEAR"),ot=Ue.NEAREST,!st&&Pe.rasterLayers)){const Et=Pe.rasterLayers.find(({id:yt})=>yt===Le.sourceLayer);Et&&Et.fields&&Et.fields.range&&(st=Et.fields.range)}if(st=st||[0,1],tt){ct.push("RASTER_COLOR"),Ae.activeTexture.set(Ue.TEXTURE2),Le.updateColorRamp(st);let Et=Le.colorRampTexture;Et||(Et=Le.colorRampTexture=new i.T(Ae,Le.colorRamp,Ue.RGBA8)),Et.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}return{mix:_t,range:st,offset:$t,defines:ct,resampling:ot}}(j,s,$,B);if(j instanceof i.aJ&&!p.length&&!S)return;const q=s.paint.get("raster-emissive-strength"),ce=f.colorModeForDrapableLayerRenderPass(q),ie=f.terrain&&f.terrain.renderingToTexture,he=!f.options.moving,de=s.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;if(j instanceof i.aJ&&!p.length&&(j.onNorthPole||j.onSouthPole)){const Pe=I?f.stencilModeFor3D():Rn.disabled;return void ut(!!j.onNorthPole,null,f,r,s,q,U,Ln.disabled,Pe)}if(!p.length)return;const[ve,Me]=j instanceof i.aJ||ie?[{},p]:f.stencilConfigForOverlap(p),Te=Me[Me.length-1].overscaledZ;R&&U.defines.push("PROJECTION_GLOBE_VIEW"),I&&U.defines.push("RENDER_CUTOFF");const Be=(Pe,Le,Ae)=>{for(const Ue of Pe){const tt=Ue.toUnwrapped(),gt=r.getTile(Ue);if(ie&&(!gt||!gt.hasData()))continue;$.activeTexture.set(B.TEXTURE0);const ct=tf(gt,j,s,U);if(!ct||!ct.texture)continue;const{texture:St,mix:bt,offset:st,tileSize:_t,buffer:$t}=ct;let ot,Et;ie?(ot=Cn.disabled,Et=Ue.projMatrix):I?(ot=new Cn(B.LEQUAL,Cn.ReadWrite,f.depthRangeFor3D),Et=S?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(tt,he)):(ot=f.depthModeForSublayer(Ue.overscaledZ-Te,s.paint.get("raster-opacity")===1?Cn.ReadWrite:Cn.ReadOnly,B.LESS),Et=f.transform.calculateProjMatrix(tt,he));const yt=f.terrain&&ie?f.terrain.stencilModeForRTTOverlap(Ue):ve[Ue.overscaledZ],Gt=x?0:s.paint.get("raster-fade-duration");gt.registerFadeDuration(Gt);const Ot=r.findLoadedParent(Ue,0),Tt=ld(gt,Ot,r,f.transform,Gt);let Bt,Ht;f.terrain&&f.terrain.prepareDrawTile(),$.activeTexture.set(B.TEXTURE0),St.bind(de,B.CLAMP_TO_EDGE),$.activeTexture.set(B.TEXTURE1),Ot?(Ot.texture&&Ot.texture.bind(de,B.CLAMP_TO_EDGE),Bt=Math.pow(2,Ot.tileID.overscaledZ-gt.tileID.overscaledZ),Ht=[gt.tileID.canonical.x*Bt%1,gt.tileID.canonical.y*Bt%1]):St.bind(de,B.CLAMP_TO_EDGE),St.useMipmap&&$.extTextureFilterAnisotropic&&f.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const rn=f.transform;let dn;const Dn=I?i0(rn):[0,0,0,0];let wn,Tn,$n,Jn,Tr,ei=0;if(R&&j instanceof i.aJ&&j.coordinates.length>3)wn=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Tn=Float32Array.from(rn.globeMatrix),$n=Float32Array.from(i.cD(rn)),Jn=[i.at(rn.center.lng),i.aA(rn.center.lat)],dn=j.elevatedGlobePerspectiveTransform,Tr=j.elevatedGlobeGridMatrix||new Float32Array(9);else if(R){const vn=i.cE(Ue.canonical);ei=i.cF(vn.getCenter().lat),wn=Float32Array.from(i.bb(i.cH(Ue.canonical))),Tn=Float32Array.from(rn.globeMatrix),$n=Float32Array.from(i.cD(rn)),Jn=[i.at(rn.center.lng),i.aA(rn.center.lat)],dn=[0,0],Tr=Float32Array.from(i.cG(Ue.canonical,vn,ei,rn.worldSize/rn._pixelsPerMercatorPixel))}else dn=j instanceof i.aJ?j.perspectiveTransform:[0,0],wn=new Float32Array(16),Tn=new Float32Array(9),$n=new Float32Array(16),Jn=[0,0],Tr=new Float32Array(9);const Nr=ol(Et,wn,Tn,$n,Tr,Ht||[0,0],i.ae(f.transform.zoom),Jn,Dn,Bt||1,Tt,s,dn,I?s.paint.get("raster-elevation"):0,2,bt,st,U.range,_t,$t,q),Bn=f.isTileAffectedByFog(Ue),or=f.getOrCreateProgram("raster",{defines:U.defines,overrideFog:Bn});if(f.uploadCommonUniforms($,or,tt),j instanceof i.aJ){const vn=j.elevatedGlobeVertexBuffer,Xn=j.elevatedGlobeIndexBuffer;if(ie||!S)j.boundsBuffer&&j.boundsSegments&&or.draw(f,B.TRIANGLES,ot,Rn.disabled,ce,Ln.disabled,Nr,s.id,j.boundsBuffer,f.quadTriangleIndexBuffer,j.boundsSegments);else if(vn&&Xn){const pr=rn.zoom<=i.c6?j.elevatedGlobeSegments:j.getSegmentsForLongitude(rn.center.lng);pr&&or.draw(f,B.TRIANGLES,ot,Rn.disabled,ce,Le,Nr,s.id,vn,Xn,pr)}}else if(R){ot=new Cn(B.LEQUAL,Cn.ReadOnly,f.depthRangeFor3D);const vn=f.globeSharedBuffers;if(vn){const[Xn,pr,_r]=vn.getGridBuffers(ei,!1);or.draw(f,B.TRIANGLES,ot,Ae||yt,f.colorModeForRenderPass(),Le,Nr,s.id,Xn,pr,_r)}}else{const{tileBoundsBuffer:vn,tileBoundsIndexBuffer:Xn,tileBoundsSegments:pr}=f.getTileBoundsBuffers(gt);or.draw(f,B.TRIANGLES,ot,yt,ce,Ln.disabled,Nr,s.id,vn,Xn,pr)}}if(!(j instanceof i.aJ)&&R)for(const Ue of Pe){const tt=Ue.canonical.y===(1<<Ue.canonical.z)-1;Ue.canonical.y===0&&ut(!0,Ue,f,r,s,q,U,Le,Ae||Rn.disabled),tt&&ut(!1,Ue,f,r,s,q,U,Le===Ln.frontCW?Ln.backCW:Ln.frontCW,Ae||Rn.disabled)}};R?Be(Me,f.renderElevatedRasterBackface?Ln.backCW:Ln.frontCW,f.stencilModeFor3D()):Be(Me,Ln.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,s,p,_,x){f.renderPass==="offscreen"&&function(S,I,R,$){if(!$.length)return;const B=S.context,j=B.gl,U=I.getSource();if(!(U instanceof Li))return;const q=Math.ceil(Math.sqrt(R.paint.get("raster-particle-count")));let ce=R.particlePositionRGBAImage;if(!ce||ce.width!==q){const Me=function(Te){const Be=Te*Te,Pe=new Uint8Array(4*Be),Le=function(Ue){return Ue|=0,Ue=Math.imul(2747636419^Ue,2654435769),Ue=Math.imul(Ue^Ue>>>16,2654435769),((Ue=Math.imul(Ue^Ue>>>16,2654435769))>>>0)/4294967296},Ae=1/1.1;for(let Ue=0;Ue<Be;Ue++){const tt=Ae*(Le(2*Ue+0)+yn),gt=Ae*(Le(2*Ue+1)+yn),ct=255*tt%1,St=255*gt%1,bt=ct,st=gt-St/255,_t=St;Pe[4*Ue+0]=255*(tt-ct/255),Pe[4*Ue+1]=255*bt,Pe[4*Ue+2]=255*st,Pe[4*Ue+3]=255*_t}return Pe}(q);ce=R.particlePositionRGBAImage=new i.r({width:q,height:q},Me)}let ie=R.particleFramebuffer;ie?ie.width!==q&&(ie.destroy(),ie=R.particleFramebuffer=B.createFramebuffer(q,q,!0,null)):ie=R.particleFramebuffer=B.createFramebuffer(q,q,!0,null);const he=[];for(const Me of $){const Te=I.getTile(Me);if(!(Te instanceof el))continue;const Be=a0(Te,U,R);if(!Be)continue;const Pe=[Te.tileSize,Te.tileSize];let Le=R.tileFramebuffer;Le||(Le=R.tileFramebuffer=B.createFramebuffer(Pe[0],Pe[1],!0,null));let Ae=Te.rasterParticleState;Ae||(Ae=Te.rasterParticleState=new o0(B,Me,Pe,ce));const Ue=Ae.update(R.lastInvalidatedAt);Ae.particleTextureDimension!==q&&Ae.updateParticleTexture(Me,ce);const tt=Ae.targetColorTexture;Ae.targetColorTexture=Ae.backgroundColorTexture,Ae.backgroundColorTexture=tt;const gt=Ae.particleTexture0;Ae.particleTexture0=Ae.particleTexture1,Ae.particleTexture1=gt,he.push([Me,Be,Ae,Ue])}if(he.length===0)return;const de=i.q.now(),ve=R.previousDrawTimestamp?.001*(de-R.previousDrawTimestamp):.0167;if(R.previousDrawTimestamp=de,R.hasColorMap()){B.activeTexture.set(j.TEXTURE0+2);let Me=R.colorRampTexture;Me||(Me=R.colorRampTexture=new i.T(B,R.colorRamp,j.RGBA8)),Me.bind(j.LINEAR,j.CLAMP_TO_EDGE)}B.bindFramebuffer.set(R.tileFramebuffer.framebuffer),function(Me,Te,Be){const Pe=Me.context,Le=Pe.gl,Ae=Te.tileFramebuffer;Pe.activeTexture.set(Le.TEXTURE0);const Ue={u_texture:0,u_opacity:1.05*(gt=Te.paint.get("raster-particle-fade-opacity-factor"))/(gt+.05)},tt=Me.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var gt;for(const ct of Be){const[,,St,bt]=ct;Ae.colorAttachment.set(St.targetColorTexture.texture),Pe.viewport.set([0,0,Ae.width,Ae.height]),Pe.clear({color:i.aj.transparent}),bt&&(St.backgroundColorTexture.bind(Le.NEAREST,Le.CLAMP_TO_EDGE),tt.draw(Me,Le.TRIANGLES,Cn.disabled,Rn.disabled,Wn.alphaBlended,Ln.disabled,Ue,Te.id,Me.viewportBuffer,Me.quadTriangleIndexBuffer,Me.viewportSegments))}}(S,R,he),function(Me,Te,Be,Pe){const Le=Me.context,Ae=Le.gl,Ue=Be.tileFramebuffer,tt=Me.transform.projection.name==="globe",gt=Be.paint.get("raster-particle-max-speed");for(const ct of Pe){const[St,bt,st]=ct;Le.activeTexture.set(Ae.TEXTURE0+0),bt.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Ue.colorAttachment.set(st.targetColorTexture.texture);const _t=Me.getOrCreateProgram("rasterParticleDraw",{defines:bt.defines,overrideFog:!1});Le.activeTexture.set(Ae.TEXTURE0+1);const $t=bt.scalarData?[]:[0,1,2,3].map(yt=>i.d4[yt](St));$t.push(St);const ot=St.canonical.x,Et=St.canonical.y;for(const yt of $t){const Gt=Te.getTile(tt?yt.wrapped():yt);if(!Gt)continue;const Ot=Gt.rasterParticleState;if(!Ot)continue;const Tt=yt.canonical.x+(1<<yt.canonical.z)*(yt.wrap-St.wrap),Bt=yt.canonical.y;Ot.particleTexture0.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE);const Ht=lb(1,Ot.particleTexture0.size[0],[Tt-ot,Bt-Et],0,bt.texture.size,2,gt,bt.textureOffset,bt.scale,bt.offset);_t.draw(Me,Ae.POINTS,Cn.disabled,Rn.disabled,Wn.alphaBlended,Ln.disabled,Ht,Be.id,Ot.particleIndexBuffer,void 0,Ot.particleSegment)}}}(S,I,R,he),B.bindFramebuffer.set(R.particleFramebuffer.framebuffer),function(Me,Te,Be,Pe){const Le=Me.context,Ae=Le.gl,Ue=Te.paint.get("raster-particle-max-speed"),tt=Pe*Te.paint.get("raster-particle-speed-factor")*.15,gt=function(St){return Math.pow(St,6)}(.01+1*Te.paint.get("raster-particle-reset-rate-factor")),ct=Te.particleFramebuffer;Le.viewport.set([0,0,ct.width,ct.height]);for(const St of Be){const[,bt,st]=St;Le.activeTexture.set(Ae.TEXTURE0+0),bt.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Le.activeTexture.set(Ae.TEXTURE0+1);const _t=st.particleTexture0;_t.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE);const $t=cb(1,_t.size[0],0,bt.texture.size,Ue,tt,gt,bt.textureOffset,bt.scale,bt.offset);ct.colorAttachment.set(st.particleTexture1.texture),Le.clear({color:i.aj.transparent}),Me.getOrCreateProgram("rasterParticleUpdate",{defines:bt.defines}).draw(Me,Ae.TRIANGLES,Cn.disabled,Rn.disabled,Wn.unblended,Ln.disabled,$t,Te.id,Me.viewportBuffer,Me.quadTriangleIndexBuffer,Me.viewportSegments)}}(S,R,he,ve)}(f,r,s,p),f.renderPass==="translucent"&&(function(S,I,R,$,B){const j=S.context,U=j.gl,q=I.getSource().tileSize,ce=5*(1-i.ac(i.bY,i.bY+1,S.transform.zoom))*q+R.paint.get("raster-particle-elevation"),ie=!S.options.moving,he=S.transform.projection.name==="globe";if(!$.length)return;const[de,ve]=S.stencilConfigForOverlap($),Me=[];he&&Me.push("PROJECTION_GLOBE_VIEW");const Te=S.stencilModeFor3D();for(const Be of ve){const Pe=Be.toUnwrapped(),Le=I.getTile(Be);if(!Le.rasterParticleState)continue;const Ae=Le.rasterParticleState,Ue=100;Le.registerFadeDuration(Ue);const tt=I.findLoadedParent(Be,0),gt=ld(Le,tt,I,S.transform,Ue);let ct,St;S.terrain&&S.terrain.prepareDrawTile(),j.activeTexture.set(U.TEXTURE0),Ae.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),j.activeTexture.set(U.TEXTURE1),tt&&tt.rasterParticleState?(tt.rasterParticleState.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),ct=Math.pow(2,tt.tileID.overscaledZ-Le.tileID.overscaledZ),St=[Le.tileID.canonical.x*ct%1,Le.tileID.canonical.y*ct%1]):Ae.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const bt=he?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(Pe,ie),st=S.transform,_t=s0(st),$t=i.cE(Be.canonical),ot=i.cF($t.getCenter().lat);let Et,yt,Gt,Ot,Tt;he?(Et=Float32Array.from(i.bb(i.cH(Be.canonical))),yt=Float32Array.from(st.globeMatrix),Gt=Float32Array.from(i.cD(st)),Ot=[i.at(st.center.lng),i.aA(st.center.lat)],Tt=Float32Array.from(i.cG(Be.canonical,$t,ot,st.worldSize/st._pixelsPerMercatorPixel))):(Et=new Float32Array(16),yt=new Float32Array(9),Gt=new Float32Array(16),Ot=[0,0],Tt=new Float32Array(9));const Bt=lm(bt,Et,yt,Gt,Tt,St||[0,0],i.ae(S.transform.zoom),Ot,_t,ct||1,gt,ce),Ht=S.isTileAffectedByFog(Be),rn=S.getOrCreateProgram("rasterParticle",{defines:Me,overrideFog:Ht});if(S.uploadCommonUniforms(j,rn,Pe),he){const dn=new Cn(U.LEQUAL,Cn.ReadOnly,S.depthRangeFor3D),Dn=0,wn=S.globeSharedBuffers;if(wn){const[Tn,$n,Jn]=wn.getGridBuffers(ot,Dn!==0);rn.draw(S,U.TRIANGLES,dn,Te,Wn.alphaBlended,S.renderElevatedRasterBackface?Ln.frontCCW:Ln.backCCW,Bt,R.id,Tn,$n,Jn)}}else{const dn=S.depthModeForSublayer(0,Cn.ReadOnly),Dn=de[Be.overscaledZ],{tileBoundsBuffer:wn,tileBoundsIndexBuffer:Tn,tileBoundsSegments:$n}=S.getTileBoundsBuffers(Le);rn.draw(S,U.TRIANGLES,dn,Dn,Wn.alphaBlended,Ln.disabled,Bt,R.id,wn,Tn,$n)}}S.resetStencilClippingMasks()}(f,r,s,p),f.style.map.triggerRepaint())},background:function(f,r,s,p){const _=s.paint.get("background-color"),x=s.paint.get("background-color-use-theme").constantOr("default")==="none",S=s.paint.get("background-opacity"),I=s.paint.get("background-emissive-strength"),R=s.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const $=f.context,B=$.gl,j=f.transform,U=j.tileSize,q=s.paint.get("background-pattern");let ce;if(q!==void 0&&(q===null||(ce=f.imageManager.getPattern(q.toString(),s.scope,f.style.getLut(s.scope)),!ce)))return;const ie=!q&&_.a===1&&S===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==ie)return;const he=Rn.disabled,de=f.depthModeForSublayer(0,ie==="opaque"?Cn.ReadWrite:Cn.ReadOnly),ve=f.colorModeForDrapableLayerRenderPass(I),Me=q?"backgroundPattern":"background";let Te,Be=p;if(Be||(Te=f.getBackgroundTiles(),Be=Object.values(Te).map(Pe=>Pe.tileID)),q&&($.activeTexture.set(B.TEXTURE0),f.imageManager.bind(f.context,s.scope)),R){const Pe=f.getOrCreateProgram(Me,{overrideFog:!1,overrideRtt:!0}),Le=new Float32Array(i.ab.mat4.identity([])),Ae=new i.aG(0,0,0,0,0),Ue=q?r0(Le,I,S,f,0,s.scope,ce,R,{tileID:Ae,tileSize:U}):um(Le,I,S,_.toRenderColor(x?null:s.lut));Pe.draw(f,B.TRIANGLES,de,he,ve,Ln.disabled,Ue,s.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const Pe of Be){const Le=f.isTileAffectedByFog(Pe),Ae=f.getOrCreateProgram(Me,{overrideFog:Le}),Ue=Pe.toUnwrapped(),tt=p?Pe.projMatrix:f.transform.calculateProjMatrix(Ue);f.prepareDrawTile();const gt=r?r.getTile(Pe):Te?Te[Pe.key]:new Qs(Pe,U,j.zoom,f),ct=q?r0(tt,I,S,f,0,s.scope,ce,R,{tileID:Pe,tileSize:U}):um(tt,I,S,_.toRenderColor(x?null:s.lut));f.uploadCommonUniforms($,Ae,Ue);const{tileBoundsBuffer:St,tileBoundsIndexBuffer:bt,tileBoundsSegments:st}=f.getTileBoundsBuffers(gt);Ae.draw(f,B.TRIANGLES,de,he,ve,Ln.disabled,ct,s.id,St,bt,st)}},sky:function(f,r,s){const p=f._atmosphere?i.ae(f.transform.zoom):1,_=s.paint.get("sky-opacity")*p;if(_===0)return;const x=f.context,S=s.paint.get("sky-type"),I=new Cn(x.gl.LEQUAL,Cn.ReadOnly,[0,1]),R=f.frameCounter/1e3%1;S==="atmosphere"?f.renderPass==="offscreen"?s.needsSkyboxCapture(f)&&(function($,B,j,U){const q=$.context,ce=q.gl;let ie=B.skyboxFbo;if(!ie){ie=B.skyboxFbo=q.createFramebuffer(32,32,!0,null),B.skyboxGeometry=new c0(q),B.skyboxTexture=q.gl.createTexture(),ce.bindTexture(ce.TEXTURE_CUBE_MAP,B.skyboxTexture),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MAG_FILTER,ce.LINEAR);for(let Me=0;Me<6;++Me)ce.texImage2D(ce.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,ce.RGBA,32,32,0,ce.RGBA,ce.UNSIGNED_BYTE,null)}q.bindFramebuffer.set(ie.framebuffer),q.viewport.set([0,0,32,32]);const he=B.getCenter($,!0),de=$.getOrCreateProgram("skyboxCapture"),ve=new Float64Array(16);i.ab.mat4.identity(ve),i.ab.mat4.rotateY(ve,ve,.5*-Math.PI),Wi($,B,de,ve,he,0),i.ab.mat4.identity(ve),i.ab.mat4.rotateY(ve,ve,.5*Math.PI),Wi($,B,de,ve,he,1),i.ab.mat4.identity(ve),i.ab.mat4.rotateX(ve,ve,.5*-Math.PI),Wi($,B,de,ve,he,2),i.ab.mat4.identity(ve),i.ab.mat4.rotateX(ve,ve,.5*Math.PI),Wi($,B,de,ve,he,3),i.ab.mat4.identity(ve),Wi($,B,de,ve,he,4),i.ab.mat4.identity(ve),i.ab.mat4.rotateY(ve,ve,Math.PI),Wi($,B,de,ve,he,5),q.viewport.set([0,0,$.width,$.height])}(f,s),s.markSkyboxValid(f)):f.renderPass==="sky"&&function($,B,j,U,q){const ce=$.context,ie=ce.gl,he=$.transform,de=$.getOrCreateProgram("skybox");ce.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_CUBE_MAP,B.skyboxTexture);const ve=((Me,Te,Be,Pe,Le)=>({u_matrix:Me,u_sun_direction:Te,u_cubemap:0,u_opacity:Pe,u_temporal_offset:Le}))(he.skyboxMatrix,B.getCenter($,!1),0,U,q);$.uploadCommonUniforms(ce,de),de.draw($,ie.TRIANGLES,j,Rn.disabled,$.colorModeForRenderPass(),Ln.backCW,ve,"skybox",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(f,s,I,_,R):S==="gradient"&&f.renderPass==="sky"&&function($,B,j,U,q){const ce=$.context,ie=ce.gl,he=$.transform,de=$.getOrCreateProgram("skyboxGradient");B.skyboxGeometry||(B.skyboxGeometry=new c0(ce)),ce.activeTexture.set(ie.TEXTURE0);let ve=B.colorRampTexture;ve||(ve=B.colorRampTexture=new i.T(ce,B.colorRamp,ie.RGBA8)),ve.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const Me=((Te,Be,Pe,Le,Ae)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:Be,u_radius:i.ai(Pe),u_opacity:Le,u_temporal_offset:Ae}))(he.skyboxMatrix,B.getCenter($,!1),B.paint.get("sky-gradient-radius"),U,q);$.uploadCommonUniforms(ce,de),de.draw($,ie.TRIANGLES,j,Rn.disabled,$.colorModeForRenderPass(),Ln.backCW,Me,"skyboxGradient",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(f,s,I,_,R)},debug:function(f,r,s,p,_,x){for(let S=0;S<s.length;S++)if(_){const $=new i.aj(p.r*.8,p.g*.8,p.b*.8,1);sl(f,r,s[S],p,-1,-1,x),sl(f,r,s[S],p,-1,1,x),sl(f,r,s[S],p,1,1,x),sl(f,r,s[S],p,1,-1,x),sl(f,r,s[S],$,0,0,x)}else sl(f,r,s[S],p,0,0,x)},custom:function(f,r,s,p){const _=f.context,x=s.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&s.isDraped(r)){if(f.renderPass==="offscreen"){const S=x.prerender;if(S){if(f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;S.call(x,_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ae(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else S.call(x,_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const I=x.renderToTile;if(I){const R=p[0].canonical,$=new i.aa(R.x+p[0].wrap*(1<<R.z),R.y,R.z);_.setDepthMode(Cn.disabled),_.setStencilMode(Rn.disabled),_.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),I.call(x,_.gl,$),_.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),_.setStencilMode(Rn.disabled);const S=x.renderingMode==="3d"?new Cn(f.context.gl.LEQUAL,Cn.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,Cn.ReadOnly);if(_.setDepthMode(S),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;x.render(_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ae(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else x.render(_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState(),_.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,s,p){if(f.renderPass==="opaque")return;const _=s.paint.get("model-opacity").constantOr(1);if(_===0)return;const x=s.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!x||f.terrain&&_<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const S=f.shadowRenderer,I=s.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,I||(S.enabled=!1));const R=()=>{S&&(S.useNormalOffset=!0,I||(S.enabled=!0))},$=r.getSource();if(f.renderPass==="light-beam"&&$.type!=="batched-model")return;if($.type==="vector"||$.type==="geojson")return function(de,ve,Me,Te,Be){const Pe=de.transform;if(Pe.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Pe.projection.name} projection is not yet implemented`);const Le=Pe.getFreeCameraOptions().position;if(!de.modelManager)return;const Ae=de.modelManager;Me.modelManager=Ae;const Ue=de.shadowRenderer;if(!Me._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const tt=Me._unevaluatedLayout._values["model-id"],gt=Object.assign({},Me.layout.get("model-id").parameters),ct=de.style.order.indexOf(Me.fqid);for(const St of Te){const bt=ve.getTile(St).getBucket(Me);if(!bt||bt.projection.name!==Pe.projection.name)continue;const st=bt.getModelUris();st&&!bt.modelsRequested&&(Ae.addModelsFromBucket(st,Be),bt.modelsRequested=!0);const _t=af(St,Pe);gt.zoom=_t;const $t=tt.possiblyEvaluate(gt);if(Ja(de,bt,St),fo.shadowUniformsInitialized=!1,fo.useSingleShadowCascade=!!Ue&&Ue.getMaxCascadeForTile(St.toUnwrapped())===0,de.renderPass==="shadow"&&Ue){if(de.currentShadowCascade===1&&bt.isInsideFirstShadowMapFrustum)continue;const yt=Pe.calculatePosMatrix(St.toUnwrapped(),Pe.worldSize);if(fo.tileMatrix.set(yt),fo.shadowTileMatrix=Float32Array.from(Ue.calculateShadowPassMatrixFromMatrix(yt)),fo.aabb.min.fill(0),fo.aabb.max[0]=fo.aabb.max[1]=i.ag,fo.aabb.max[2]=0,xm(bt,fo,de,Me.scope))continue}const ot=1<<St.canonical.z,Et=[((Le.x-St.wrap)*ot-St.canonical.x)*i.ag,(Le.y*ot-St.canonical.y)*i.ag,Le.z*ot*i.ag];de.conflationActive&&Object.keys(bt.instancesPerModel).length>0&&de.style.isLayerClipped(Me,ve.getSource())&&bt.updateReplacement(St,de.replacementSource,ct,Be)&&(bt.uploaded=!1,bt.upload(de.context));for(let yt in bt.instancesPerModel){const Gt=bt.instancesPerModel[yt];Gt.features.length>0&&(yt=$t.evaluate(Gt.features[0].feature,{}));const Ot=Ae.getModel(yt,Be);if(Ot&&Ot.uploaded)for(const Tt of Ot.nodes)yd(de,Me,Tt,Gt,Et,St,fo)}}}(f,r,s,p,$.type==="vector"?s.scope:""),void R();if(!$.loaded())return;if($.type==="batched-model")return function(de,ve,Me,Te){Me.resetLayerRenderingStats(de);const Be=de.context,Pe=de.transform,Le=de.style.fog,Ae=de.shadowRenderer;if(Pe.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Pe.projection.name} projection is not yet implemented`);const Ue=de.transform.getFreeCameraOptions().position,tt=i.ab.vec3.scale([],[Ue.x,Ue.y,Ue.z],de.transform.worldSize),gt=i.ab.vec3.negate([],tt),ct=i.ab.mat4.identity([]),St=i.dj(Pe.center.lat,Pe.zoom),bt=i.ab.mat4.fromScaling([],[1,1,1/St]);i.ab.mat4.translate(ct,ct,gt);const st=Me.paint.get("model-opacity").constantOr(1),_t=new Cn(Be.gl.LEQUAL,Cn.ReadWrite,de.depthRangeFor3D),$t=new Cn(Be.gl.LEQUAL,Cn.ReadOnly,de.depthRangeFor3D),ot=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Et=de.renderPass==="shadow",yt=Et&&Ae?Ae.getCurrentCascadeFrustum():Pe.getFrustum(Pe.scaleZoom(Pe.worldSize)),Gt=Me.paint.get("model-front-cutoff"),Ot=Gt[2]<1,Tt=nl(de,Me.paint.get("model-cutoff-fade-range")),Bt=Me.getLayerRenderingStats();(function(Ht,rn,dn,Dn){const wn=Ht.terrain?Ht.terrain.exaggeration():0,Tn=Ht.transform.zoom;for(const $n of Dn){const Jn=rn.getTile($n).getBucket(dn);Jn&&(Ht.conflationActive&&Jn.updateReplacement($n,Ht.replacementSource),Jn.evaluateScale(Ht,dn),Ht.terrain&&wn>0&&Jn.elevationUpdate(Ht.terrain,wn,$n,dn.source),Jn.needsReEvaluation(Ht,Tn,dn)&&Jn.evaluate(dn))}})(de,ve,Me,Te),function(){let Ht,rn,dn;Ot?(Ht=Te.length-1,rn=-1,dn=-1):(Ht=0,rn=Te.length,dn=1);const Dn=new Float64Array(16),wn=i.ab.vec3.create(),Tn=new i.P(0,0);for(let $n=Ht;$n!==rn;$n+=dn){const Jn=Te[$n],Tr=ve.getTile(Jn).getBucket(Me);if(!Tr||!Tr.uploaded)continue;let ei=!1;Ae&&(ei=Ae.getMaxCascadeForTile(Jn.toUnwrapped())===0);const Nr=Pe.calculatePosMatrix(Jn.toUnwrapped(),Pe.worldSize),Bn=Tr.modelTraits;!Et&&Ot&&(i.ab.mat4.invert(Dn,Nr),i.ab.vec3.transformMat4(wn,tt,Dn),Tn.x=wn[0],Tn.y=wn[1]);const or=[];for(const vn of Tr.getNodesInfo()){if(vn.hiddenByReplacement||!vn.node.meshes)continue;const Xn=vn.node;let pr=0;de.terrain&&Xn.elevation&&(pr=Xn.elevation*de.terrain.exaggeration());const _r=(()=>{const er=vn.aabb;return ot.min=[...er.min],ot.max=[...er.max],ot.min[2]+=pr,ot.max[2]+=pr,i.ab.vec3.transformMat4(ot.min,ot.min,Nr),i.ab.vec3.transformMat4(ot.max,ot.max,Nr),ot})(),Xr=vn.evaluatedScale;if(Xr[0]<=1&&Xr[1]<=1&&Xr[2]<=1&&_r.intersects(yt)===0)continue;if(!Et&&Ot){const er=.16666666666666666;vn.cameraCollisionOpacity=tt[0]>_r.min[0]&&tt[0]<_r.max[0]&&tt[1]>_r.min[1]&&tt[1]<_r.max[1]&&tt[2]*St<_r.max[2]&&Xn.footprint&&i.bA(Tn,Xn.footprint)?Math.max(vn.cameraCollisionOpacity-er,0):Math.min(1,vn.cameraCollisionOpacity+er)}const Ni=[...Nr],Pi=Xn.anchor?Xn.anchor[0]:0,Oi=Xn.anchor?Xn.anchor[1]:0;i.ab.mat4.translate(Ni,Ni,[Pi*(Xr[0]-1),Oi*(Xr[1]-1),pr]),i.ab.vec3.exactEquals(Xr,i.dm)||i.ab.mat4.scale(Ni,Ni,Xr);const Ko=i.ab.mat4.multiply([],Ni,Xn.matrix),po=i.ab.mat4.multiply([],Pe.expandedFarZProjMatrix,Ko),Kr=i.ab.mat4.multiply([],Pe.expandedFarZProjMatrix,Ni),zr=i.ab.vec4.transformMat4([],[Pi,Oi,pr,1],po)[2];Xn.hidden=!1;let Or=st;Et||(Ot&&(Or*=vn.cameraCollisionOpacity,Or*=bm(Ni,Pe,vn.aabb,Gt)),Or*=Ql(Tt,zr)),Or!==0?or.push({nodeInfo:vn,depth:zr,opacity:Or,wvpForNode:po,wvpForTile:Kr,nodeModelMatrix:Ko,tileModelMatrix:Ni}):Xn.hidden=!0}Et||or.sort((vn,Xn)=>!Ot||vn.opacity===1&&Xn.opacity===1?vn.depth<Xn.depth?-1:1:vn.opacity===1?-1:Xn.opacity===1?1:vn.depth>Xn.depth?-1:1);for(const vn of or){const Xn=vn.nodeInfo,pr=Xn.node;let _r=i.ab.mat4.multiply([],bt,vn.tileModelMatrix);i.ab.mat4.multiply(_r,ct,_r);const Xr=i.ab.mat4.invert([],_r);i.ab.mat4.transpose(Xr,Xr),i.ab.mat4.scale(Xr,Xr,vm),_r=i.ab.mat4.multiply(_r,_r,pr.matrix);const Ni=de.renderPass==="light-beam",Pi=Me.paint.get("model-color-use-theme").constantOr("default")==="none",Oi=Bn&i.dp.HasMapboxMeshFeatures,Ko=Oi?0:Xn.evaluatedRMEA[0][2];for(let po=0;po<pr.meshes.length;++po){const Kr=pr.meshes[po],zr=po===pr.lightMeshIndex;let Or=vn.wvpForNode;if(zr){if(!Ni&&!de.terrain&&de.shadowRenderer){de.currentLayer<de.firstLightBeamLayer&&(de.firstLightBeamLayer=de.currentLayer);continue}Or=vn.wvpForTile}else if(Ni)continue;const er={defines:[]},gi=[];if(!Et&&Ae&&(Ae.useNormalOffset=!!Kr.normalBuffer),Yc(er.defines,gi,Kr,de,Pi?null:Me.lut),Oi||er.defines.push("DIFFUSE_SHADED"),ei&&er.defines.push("SHADOWS_SINGLE_CASCADE"),Bt&&(Et?Bt.numRenderedVerticesInShadowPass+=Kr.vertexArray.length:Bt.numRenderedVerticesInTransparentPass+=Kr.vertexArray.length),Et){_d(Kr,vn.nodeModelMatrix,de,Me);continue}let Vi=null;if(Le){const ns=As(vn.nodeModelMatrix,de.transform);if(Vi=new Float32Array(ns),Pe.projection.name!=="globe"){const ga=Kr.aabb.min,Jo=Kr.aabb.max,[oc,rs]=Le.getOpacityForBounds(ns,ga[0],ga[1],Jo[0],Jo[1]);er.overrideFog=oc>=ze||rs>=ze}}const Dr=Kr.material;let mo;Dr.occlusionTexture&&Dr.occlusionTexture.offsetScale&&(mo=Dr.occlusionTexture.offsetScale,er.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ma=de.getOrCreateProgram("model",er);!Et&&Ae&&Ae.setupShadowsFromMatrix(vn.tileModelMatrix,ma,Ae.useNormalOffset),de.uploadCommonUniforms(Be,ma,null,Vi);const Uo=Dr.pbrMetallicRoughness;Uo.metallicFactor=.9,Uo.roughnessFactor=.5;const Ro=hd(new Float32Array(Or),new Float32Array(_r),new Float32Array(Xr),new Float32Array(pr.matrix),de,vn.opacity,Uo.baseColorFactor.toRenderColor(null),Dr.emissiveFactor,Uo.metallicFactor,Uo.roughnessFactor,Dr,Ko,Me,[0,0,0],mo);!zr&&(Xn.hasTranslucentParts||vn.opacity<1)&&ma.draw(de,Be.gl.TRIANGLES,_t,Rn.disabled,Wn.disabled,Ln.backCCW,Ro,Me.id,Kr.vertexBuffer,Kr.indexBuffer,Kr.segments,Me.paint,de.transform.zoom,void 0,gi),ma.draw(de,Be.gl.TRIANGLES,zr?$t:_t,Rn.disabled,zr||vn.opacity<1||Xn.hasTranslucentParts?Wn.alphaBlended:Wn.unblended,Ln.backCCW,Ro,Me.id,Kr.vertexBuffer,Kr.indexBuffer,Kr.segments,Me.paint,de.transform.zoom,void 0,gi)}}}}()}(f,r,s,p),void R();if($.type!=="model")return;const B=$.getModels(),j=[],U=f.transform.getFreeCameraOptions().position,q=i.ab.vec3.scale([],[U.x,U.y,U.z],f.transform.worldSize);i.ab.vec3.negate(q,q);const ce=[],ie=[];let he=0;for(const de of B){const ve=s.paint.get("model-rotation").constantOr(null),Me=s.paint.get("model-scale").constantOr(null),Te=s.paint.get("model-translation").constantOr(null);de.computeModelMatrix(f,ve,Me,Te,!0,!0,!1);const Be=i.ab.mat4.identity([]),Pe=i.dj(de.position.lat,f.transform.zoom),Le=i.ab.mat4.fromScaling([],[1,1,1/Pe]);i.ab.mat4.translate(Be,Be,q),j.push({zScaleMatrix:Le,negCameraPosMatrix:Be});for(const Ae of de.nodes)of(f.transform,Ae,de.matrix,f.transform.expandedFarZProjMatrix,he,ce,ie);he++}if(ce.sort((de,ve)=>ve.depth-de.depth),f.renderPass!=="shadow"){if(_===1)for(const de of ie)Ps(de,f,s,j[de.modelIndex],Rn.disabled,f.colorModeForRenderPass());else{for(const de of ie)Ps(de,f,s,j[de.modelIndex],Rn.disabled,Wn.disabled);for(const de of ie)Ps(de,f,s,j[de.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const de of ce)Ps(de,f,s,j[de.modelIndex],Rn.disabled,f.colorModeForRenderPass());R()}else{for(const de of ie)_d(de.mesh,de.nodeModelMatrix,f,s);for(const de of ce)_d(de.mesh,de.nodeModelMatrix,f,s);R()}}},bd={line:function(f,r,s){if(f.hasElevatedBuckets=!1,f.hasNonElevatedBuckets=!1,f._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||f._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const p=r.getVisibleCoordinates();for(const _ of p){const x=r.getTile(_).getBucket(f);if(x&&(x.hasZOffset?f.hasElevatedBuckets=!0:f.hasNonElevatedBuckets=!0,f.hasElevatedBuckets&&f.hasNonElevatedBuckets))break}}}else f.hasNonElevatedBuckets=!0},model:function(f,r,s){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(s.modelManager&&s.modelManager.upload(s,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const _=p.getModels();for(const x of _)x.upload(s.context)},raster:function(f,r,s){const p=r.getSource();if(!(p instanceof Li&&p.loaded()))return;const _=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!_)return;const x=f.paint.get("raster-array-band")||p.getInitialBand(_);if(x==null)return;const S=r.getIds().map(I=>r.getTileByID(I));for(const I of S)I.updateNeeded(_,x)&&p.prepareTile(I,_,x)},"raster-particle":function(f,r,s){const p=r.getSource();if(!(p instanceof Li&&p.loaded()))return;const _=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!_)return;const x=f.paint.get("raster-particle-array-band")||p.getInitialBand(_);if(x==null)return;const S=r.getIds().map(I=>r.getTileByID(I));for(const I of S)I.updateNeeded(_,x)&&p.prepareTile(I,_,x)}};class Am{constructor(r,s,p,_,x){this.context=new pm(r,s),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=x,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const S=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const R of S)this._debugParams.enabledLayers[R]=!0;x.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),x.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),x.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),x.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const R of S)x.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],R);this.occlusionParams=new sf(x),this.setup(),this.numSublayers=da.maxUnderzooming+da.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new jl(this),this._wireframeDebugCache=new wm,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const I=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,I,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=_}updateTerrain(r,s){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Nc(this,r));const _=this._terrain;this.transform.elevation=p?_:null,_.update(r,this.transform,s),this.transform.elevation&&!_.enabled&&(this.transform.elevation=null)}_updateFog(r){const s=r.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,_]=s.getFovAdjustedRange(this.transform._fov);if(p>_)return void(this.transform.fogCullDistSq=null);const x=p+.78*(_-p);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Nc(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,s){if(this.width=r*i.q.devicePixelRatio,this.height=s*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,s=new i.b4;s.emplaceBack(0,0),s.emplaceBack(i.ag,0),s.emplaceBack(0,i.ag),s.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=r.createVertexBuffer(s,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const p=new i.b4;p.emplaceBack(0,0),p.emplaceBack(i.ag,0),p.emplaceBack(0,i.ag),p.emplaceBack(i.ag,i.ag),this.debugBuffer=r.createVertexBuffer(p,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const _=new i.b4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const x=new i.aT;x.emplaceBack(0,0,0,0),x.emplaceBack(i.ag,0,i.ag,0),x.emplaceBack(0,i.ag,0,i.ag),x.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=r.createVertexBuffer(x,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const S=new i.aU;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(S);const I=new i.b5;for(const $ of[0,1,3,2,0])I.emplaceBack($);this.debugIndexBuffer=r.createIndexBuffer(I),this.emptyTexture=new i.T(r,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=i.ab.mat4.create();const R=this.context.gl;this.stencilClearMode=new Rn({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,Cn.disabled,this.stencilClearMode,Wn.disabled,Ln.disabled,Wh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,s,p){if(!s||this.currentStencilSource===s.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const R of p)if(this._tileClippingMaskIDs[R.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=s.id;const _=this.context,x=_.gl;this.nextStencilID+p.length>256&&this.clearStencil(),_.setColorMode(Wn.disabled),_.setDepthMode(Cn.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of p){const R=s.getTile(I),$=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:B,tileBoundsIndexBuffer:j,tileBoundsSegments:U}=this.getTileBoundsBuffers(R);S.draw(this,x.TRIANGLES,Cn.disabled,new Rn({func:x.ALWAYS,mask:0},$,255,x.KEEP,x.KEEP,x.REPLACE),Wn.disabled,Ln.disabled,Wh(I.projMatrix),"$clipping",B,j,U)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new Rn({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const s=this.context.gl;return new Rn({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,p=r.sort((S,I)=>I.overscaledZ-S.overscaledZ),_=p[p.length-1].overscaledZ,x=p[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let I=0;I<x;I++)S[I+_]=new Rn({func:s.GEQUAL,mask:255},I+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=x,[S,p]}return[{[_]:Rn.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Wn([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Wn.unblended:Wn.alphaBlended}colorModeForDrapableLayerRenderPass(r){const s=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Wn([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,s,p,_=!1){if(this.depthOcclusion)return new Cn(this.context.gl.GREATER,Cn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!_)return Cn.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Cn(p||this.context.gl.LEQUAL,s,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,s=Math.ceil(this.width),p=Math.ceil(this.height),_=this.context.bindFramebuffer.get(),x=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===s&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),s!==0&&p!==0&&(this.depthFBO=new fm(this.context,s,p,!1,"texture"),this.depthTexture=new i.T(this.context,{width:s,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(_),r.bindTexture(r.TEXTURE_2D,x),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,s,p,0,0,s,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,s)=>r+s/this._fpsHistory.length,0))}render(r,s){const p=i.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=s;const _=this.style._mergedLayers,x=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(x).filter(st=>{const _t=_[st];return!(_t.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[_t.type]});let I=S(),R=!1,$=!1;for(const st of I){const _t=_[st];_t.type==="circle"&&(R=!0),_t.type==="symbol"&&(_t.hasInitialOcclusionOpacityProperties?$=!0:R=!0)}let B=I.map(st=>_[st]);const j=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let U=0,q=!1;for(const st in j){const _t=j[st];_t.used&&(_t.prepare(this.context),_t.getSource().usedInConflation&&++U)}let ce=!1;for(const st of B)st.isHidden(this.transform.zoom)||(st.type==="clip"&&(ce=!0),this.prepareLayer(st));const ie={},he={},de={},ve={},Me={};for(const st in j){const _t=j[st];ie[st]=_t.getVisibleCoordinates(),he[st]=ie[st].slice().reverse(),de[st]=_t.getVisibleCoordinates(!0).reverse(),ve[st]=_t.getShadowCasterCoordinates(),Me[st]=_t.sortCoordinatesByDistance(ie[st])}const Te=st=>{const _t=this.style.getLayerSourceCache(st);return _t&&_t.used?_t.getSource():null};if(U||ce||this._clippingActiveLastFrame){const st=[],_t=[];let $t=0;for(const ot of B)this.isSourceForClippingOrConflation(ot,Te(ot))&&(st.push(ot),_t.push($t)),$t++;if(ce||st.length>1||this._clippingActiveLastFrame){ce=!1;const ot=[];for(let Et=0;Et<st.length;Et++){const yt=st[Et],Gt=_t[Et],Ot=this.style.getLayerSourceCache(yt);if(!Ot||!Ot.used||!Ot.getSource().usedInConflation&&yt.type!=="clip")continue;let Tt=i.dx,Bt=i.by.None;const Ht=[];let rn=!0;if(yt.type==="clip"){Tt=Gt;for(const dn of yt.layout.get("clip-layer-types"))Bt|=dn==="model"?i.by.Model:dn==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const dn of yt.layout.get("clip-layer-scope"))Ht.push(dn);yt.isHidden(this.transform.zoom)?rn=!1:ce=!0}rn&&ot.push({layer:yt.fqid,cache:Ot,order:Tt,clipMask:Bt,clipScope:Ht})}this.replacementSource.setSources(ot),q=!0}}this._clippingActiveLastFrame=ce,q||this.replacementSource.clear(),this.conflationActive=q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let st=0;st<B.length;st++){const _t=B[st],$t=_t.cutoffRange();if(this.longestCutoffRange=Math.max($t,this.longestCutoffRange),$t>0){const ot=Te(_t);ot&&(this.minCutoffZoom=Math.max(ot.minzoom,this.minCutoffZoom)),_t.minzoom&&(this.minCutoffZoom=Math.max(_t.minzoom,this.minCutoffZoom))}_t.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=st),this._lastOcclusionLayer=st)}const Be=this.style&&this.style.fog;Be?(this._fogVisible=Be.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Be.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(de),this.opaquePassCutoff=0,I=S(),B=I.map(st=>_[st]));const Pe=this._shadowRenderer;if(Pe){Pe.updateShadowParameters(this.transform,this.style.directionalLight);for(const st in j)for(const _t of ie[st]){let $t={min:0,max:0};this.terrain&&($t=this.terrain.getMinMaxForTile(_t)||$t),Pe.addShadowReceiver(_t.toUnwrapped(),$t.min,$t.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new u0(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Le=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ae=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Le&&!this._snow&&(this._snow=new Im(this)),!Le&&this._snow&&(this._snow.destroy(),delete this._snow),Ae&&!this._rain&&(this._rain=new Xc(this)),!Ae&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Ft.has(this.context.gl))return;this.renderPass="offscreen";for(const st of B){const _t=r.getLayerSourceCache(st);if(!st.hasOffscreenPass()||st.isHidden(this.transform.zoom))continue;const $t=_t?he[_t.id]:void 0;(st.type==="custom"||st.type==="raster"||st.type==="raster-particle"||st.isSky()||$t&&$t.length)&&this.renderLayer(this,_t,st,$t)}this.depthRangeFor3D=[0,1-(B.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ve)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ue=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),tt=(()=>{if(s.showOverdrawInspector)return i.aj.black;const st=this.style.fog;if(st&&this.transform.projection.supportsFog){const _t=this.style.getLut(st.scope);if(!Ue){const $t=st.properties.get("color-use-theme")==="none",ot=st.properties.get("color").toRenderColor($t?null:_t).toArray01();return new i.aj(...ot)}if(Ue){const $t=st.properties.get("space-color-use-theme")==="none",ot=st.properties.get("space-color").toRenderColor($t?null:_t).toArray01();return new i.aj(...ot)}}return i.aj.transparent})();if(this.context.clear({color:tt,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ue&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){const st=B[this.currentLayer],_t=r.getLayerSourceCache(st);if(st.isSky())continue;const $t=_t?(st.is3D()?Me:he)[_t.id]:void 0;this._renderTileClippingMasks(st,_t,$t),this.renderLayer(this,_t,st,$t)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ue&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){const st=B[this.currentLayer],_t=r.getLayerSourceCache(st);st.isSky()&&this.renderLayer(this,_t,st,_t?he[_t.id]:void 0)}function gt(st,_t){let $t;return _t&&($t=(st.type==="symbol"?de:st.is3D()?Me:he)[_t.id]),$t}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<I.length;){const st=B[this.currentLayer];if(st.type==="raster"||st.type==="raster-particle"){const _t=r.getLayerSourceCache(st);this.renderLayer(this,_t,st,gt(st,_t))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ct=0;Pe&&(ct=Pe.getShadowCastingLayerCount());let St=!1,bt=-1;for(let st=0;st<I.length;++st){const _t=B[st];_t.isHidden(this.transform.zoom)||_t.is3D()&&(bt=st)}for($&&bt===-1&&(R=!0);this.currentLayer<I.length;){const st=B[this.currentLayer],_t=r.getLayerSourceCache(st);if(st.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(st)){if(st.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(R&&!St&&this.terrain&&!this.transform.isOrthographic&&(St=!0,this.blitDepth()),$&&bt!==-1&&this.currentLayer===bt+1&&!this.transform.isOrthographic&&this.blitDepth(),st.is3D()||this.terrain||this._renderTileClippingMasks(st,_t,_t?ie[_t.id]:void 0),this.renderLayer(this,_t,st,gt(st,_t)),!this.terrain&&Pe&&ct>0&&st.hasShadowPass()&&--ct==0&&(Pe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const $t=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=$t;this.currentLayer++){const ot=B[this.currentLayer];if(!ot.hasLightBeamPass())continue;const Et=r.getLayerSourceCache(ot);this.renderLayer(this,Et,ot,Et?he[Et.id]:void 0)}this.currentLayer=$t,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const $t=this.currentLayer;this.depthOcclusion=!0;for(const ot of this.layersWithOcclusionOpacity){this.currentLayer=ot;const Et=B[this.currentLayer],yt=r.getLayerSourceCache(Et),Gt=yt?he[yt.id]:void 0;Et.is3D()||this.terrain||this._renderTileClippingMasks(Et,yt,yt?ie[yt.id]:void 0),this.renderLayer(this,yt,Et,Gt)}this.depthOcclusion=!1,this.currentLayer=$t,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let st=null;B.forEach(_t=>{const $t=r.getLayerSourceCache(_t);$t&&!_t.isHidden(this.transform.zoom)&&$t.getVisibleCoordinates().length&&(!st||st.getSource().maxzoom<$t.getSource().maxzoom)&&(st=$t)}),st&&this.options.showTileBoundaries&&xd.debug(this,st,st.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&xd.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(st){const _t=st.transform.padding;_m(st,st.transform.height-(_t.top||0),3,Zc),_m(st,_t.bottom||0,3,ub),ym(st,_t.left||0,3,db),ym(st,st.transform.width-(_t.right||0),3,l0);const $t=st.transform.centerPoint;(function(ot,Et,yt,Gt){Jl(ot,Et-1,yt-10,2,20,Gt),Jl(ot,Et-10,yt-1,20,2,Gt)})(st,$t.x,st.transform.height-$t.y,nf)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),q||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:s}=this.transform.projection,p=!s||!s.includes(r.type);if(bd[r.type]&&(p||this.terrain&&r.type==="custom")){const _=this.style.getLayerSourceCache(r);bd[r.type](r,_,this)}this.gpuTimingEnd()}renderLayer(r,s,p,_){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||_&&_.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||xd[p.type](r,s,p,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,p=this.context.gl;let _=this.gpuTimers[r.id];_||(_=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),_.calls++,p.beginQuery(s.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,s=this.context.gl,p=s.createQuery();this.deferredRenderGpuTimeQueries.push(p),s.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const s={};for(const p in r){const _=r[p],x=this.context.extTimerQuery,S=x.getQueryParameter(_.query,this.context.gl.QUERY_RESULT)/1e6;x.deleteQueryEXT(_.query),s[p]=S}return s}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.gl;let p=0;for(const _ of r)p+=s.getQueryParameter(_,s.QUERY_RESULT)/1e6,s.deleteQuery(_);return p}translatePosMatrix(r,s,p,_,x){if(!p[0]&&!p[1])return r;const S=x?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(S){const $=Math.sin(S),B=Math.cos(S);p=[p[0]*B-p[1]*$,p[0]*$+p[1]*B]}const I=[x?p[0]:i.ar(s,p[0],this.transform.zoom),x?p[1]:i.ar(s,p[1],this.transform.zoom),0],R=new Float32Array(16);return i.ab.mat4.translate(R,r,I),R}saveTileTexture(r){const s=r.size[0],p=this._tileTextures[s];p?p.push(r):this._tileTextures[s]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,s,p){const _=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,x=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(x.push("LIGHTING_3D_MODE"),x.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):_||x.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||x.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(x.push("TERRAIN"),this.linearFloatFilteringSupported()&&x.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&x.push("GLOBE"),!this._fogVisible||_||s!==void 0&&!s||x.push("FOG","FOG_DITHERING"),_&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}getOrCreateProgram(r,s){this.cache=this.cache||{};const p=s&&s.defines||[],_=s&&s.config,x=this.currentGlobalDefines(r,s&&s.overrideFog,s&&s.overrideRtt).concat(p),S=e0.cacheKey($c[r],r,x,_);return this.cache[S]||(this.cache[S]=new e0(this.context,r,$c[r],_,hm[r],x)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,s){if(this.style.enable3dLights()){const p=this.style.directionalLight,_=this.style.ambientLight;if(p&&_){const x=((S,I,R)=>{const $=S.properties.get("direction"),B=S.properties.get("color-use-theme")==="none",j=S.properties.get("color").toRenderColor(B?null:R.getLut(S.scope)).toArray01(),U=S.properties.get("intensity"),q=I.properties.get("color-use-theme")==="none",ce=I.properties.get("color").toRenderColor(q?null:R.getLut(I.scope)).toArray01(),ie=I.properties.get("intensity"),he=[$.x,$.y,$.z],de=i.cM(ce,ie),ve=i.cM(j,U);return{u_lighting_ambient_color:de,u_lighting_directional_dir:he,u_lighting_directional_color:ve,u_ground_radiance:ob(he,ve,de)}})(p,_,this.style);s.setLightsUniformValues(r,x)}}}uploadCommonUniforms(r,s,p,_,x){if(this.uploadCommonLightUniforms(r,s),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const I=S.getOpacity(this.transform.pitch),R=(($,B,j,U,q,ce,ie,he,de,ve,Me,Te)=>{const Be=$.transform,Pe=B.properties.get("color-use-theme")==="none",Le=B.properties.get("color").toRenderColor(Pe?null:$.style.getLut(B.scope)).toArray01();Le[3]=U;const Ae=$.frameCounter/1e3%1,[Ue,tt]=B.properties.get("vertical-range");return{u_fog_matrix:j?Be.calculateFogTileMatrix(j):Te||$.identityMat,u_fog_range:B.getFovAdjustedRange(Be._fov),u_fog_color:Le,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ue,tt),tt],u_fog_temporal_offset:Ae,u_frustum_tl:q,u_frustum_tr:ce,u_frustum_br:ie,u_frustum_bl:he,u_globe_pos:de,u_globe_radius:ve,u_viewport:Me,u_globe_transition:i.ae(Be.zoom),u_is_globe:+(Be.projection.name==="globe")}})(this,S,p,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],_);s.setFogUniformValues(r,R)}x&&s.setCutoffUniformValues(r,x.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,s=r.createTexture();return r.bindTexture(r.TEXTURE_2D,s),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,s=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const _ of p)s[_.key]=r[_.key]||new Qs(_,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,s){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!s||s.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let s=this._cachedTileFogOpacities[r.key];return s||(this._cachedTileFogOpacities[r.key]=s=this.style.fog.getOpacityForTile(r)),s[0]>=ze||s[1]>=ze}setupDepthForOcclusion(r,s,p){const _=this.context,x=_.gl,S=!!p;var I;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),_.activeTexture.set(x.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((I=this.depthRangeFor3D)[1]-I[0]),-1-2*I[0]/(I[1]-I[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),_.activeTexture.set(x.TEXTURE0),S||s.setTerrainUniformValues(_,p)}}function uf(f,r){let s=!1,p=null;const _=()=>{p=null,s&&(f(),p=setTimeout(_,r),s=!1)};return()=>(s=!0,p||_(),p)}class d0{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=uf(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const s=Pm(r);if(this._hashName){const p=this._hashName;let _=!1;const x=location.hash.slice(1).split("&").map(S=>{const I=S.split("=")[0];return I===p?(_=!0,`${I}=${s}`):S}).filter(S=>S);return _||x.push(`${p}=${s}`),`#${x.join("&")}`}return`#${s}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let s;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(s=p)}),(s&&s[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(s[3]||0):r.getBearing();return r.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:p,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Pm(f,r){const s=f.getCenter(),p=Math.round(100*f.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),S=Math.round(s.lng*x)/x,I=Math.round(s.lat*x)/x,R=f.getBearing(),$=f.getPitch();let B=r?`/${S}/${I}/${p}`:`${p}/${I}/${S}`;return(R||$)&&(B+="/"+Math.round(10*R)/10),$&&(B+=`/${Math.round($)}`),B}const wd={linearity:.3,easing:i.dy(0,0,.3,1)},h0=i.l({deceleration:2500,maxSpeed:1400},wd),f0=i.l({deceleration:20,maxSpeed:1400},wd),p0=i.l({deceleration:1e3,maxSpeed:360},wd),m0=i.l({deceleration:1e3,maxSpeed:90},wd);class g0{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=i.q.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)s.zoom+=x.zoomDelta||0,s.bearing+=x.bearingDelta||0,s.pitch+=x.pitchDelta||0,x.panDelta&&s.pan._add(x.panDelta),x.around&&(s.around=x.around),x.pinchAround&&(s.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(s.pan.mag()){const x=Cd(s.pan.mag(),p,i.l({},h0,r||{}));_.offset=s.pan.mult(x.amount/s.pan.mag()),_.center=this._map.transform.center,Sd(_,x)}if(s.zoom){const x=Cd(s.zoom,p,f0);_.zoom=this._map.transform.zoom+x.amount,Sd(_,x)}if(s.bearing){const x=Cd(s.bearing,p,p0);_.bearing=this._map.transform.bearing+i.aw(x.amount,-179,179),Sd(_,x)}if(s.pitch){const x=Cd(s.pitch,p,m0);_.pitch=this._map.transform.pitch+x.amount,Sd(_,x)}if(_.zoom||_.bearing){const x=s.pinchAround===void 0?s.around:s.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Sd(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Cd(f,r,s){const{maxSpeed:p,linearity:_,deceleration:x}=s,S=i.aw(f*_/(r/1e3),-p,p),I=Math.abs(S)/(x*_);return{easing:s.easing,duration:1e3*I,amount:S*(I/2)}}class Vo extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,p,_={}){const x=be(s.getCanvasContainer(),p),S=s.unproject(x);super(r,i.l({point:x,lngLat:S,originalEvent:p},_)),this._defaultPrevented=!1,this.target=s}}class Td extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,p){const _=r==="touchend"?p.changedTouches:p.touches,x=Ie(s.getCanvasContainer(),_),S=x.map(R=>s.unproject(R)),I=x.reduce((R,$,B,j)=>R.add($.div(j.length)),new i.P(0,0));super(r,{points:x,point:I,lngLats:S,lngLat:s.unproject(I),originalEvent:p}),this._defaultPrevented=!1}}class _0 extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s){super("wheel",{originalEvent:s}),this._defaultPrevented=!1}}class fb{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new _0(this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new Vo(r.type,this._map,r))}mouseup(r){this._map.fire(new Vo(r.type,this._map,r))}preclick(r){const s=i.l({},r);s.type="preclick",this._map.fire(new Vo(s.type,this._map,s))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Vo(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Vo(r.type,this._map,r))}mouseover(r){this._map.fire(new Vo(r.type,this._map,r))}mouseout(r){this._map.fire(new Vo(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Td(r.type,this._map,r))}touchmove(r){this._map.fire(new Td(r.type,this._map,r))}touchend(r){this._map.fire(new Td(r.type,this._map,r))}touchcancel(r){this._map.fire(new Td(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pb{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Vo(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Vo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Vo(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class di{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(ne(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const p=s,_=this._startPos,x=this._lastPos;if(!_||!x||x.equals(p)||!this._box&&p.dist(_)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=K("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const S=Math.min(_.x,p.x),I=Math.max(_.x,p.x),R=Math.min(_.y,p.y),$=Math.max(_.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${R}px)`,this._box.style.width=I-S+"px",this._box.style.height=$-R+"px")})}mouseupWindow(r,s){if(!this._active)return;const p=this._startPos,_=s;if(p&&r.button===0){if(this.reset(),ee(),p.x!==_.x||p.y!==_.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(p,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ue(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new i.z(r,{originalEvent:s}))}}function df(f,r){const s={};for(let p=0;p<f.length;p++)s[f[p].identifier]=r[p];return s}class mb{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,s,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const x=new i.P(0,0);for(const S of _)x._add(S);return x.div(_.length)}(s),this.touches=df(p,s)))}touchmove(r,s,p){if(this.aborted||!this.centroid)return;const _=df(p,s);for(const x in this.touches){const S=_[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(r,s,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Om{constructor(r){this.singleTap=new mb(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,s,p){this.singleTap.touchstart(r,s,p)}touchmove(r,s,p){this.singleTap.touchmove(r,s,p)}touchend(r,s,p){const _=this.singleTap.touchend(r,s,p);if(_){const x=r.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(_)<30;if(x&&S||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Ed{constructor(){this._zoomIn=new Om({numTouches:1,numTaps:2}),this._zoomOut=new Om({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,p){this._zoomIn.touchstart(r,s,p),this._zoomOut.touchstart(r,s,p)}touchmove(r,s,p){this._zoomIn.touchmove(r,s,p),this._zoomOut.touchmove(r,s,p)}touchend(r,s,p){const _=this._zoomIn.touchend(r,s,p),x=this._zoomOut.touchend(r,s,p);return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const y0={0:1,2:2};class Md{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,s){return!1}_move(r,s){return{}}mousedown(r,s){if(this._lastPoint)return;const p=Ee(r);this._correctButton(r,p)&&(this._lastPoint=s,this._eventButton=p)}mousemoveWindow(r,s){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(_,x){const S=y0[x];return _.buttons===void 0||(_.buttons&S)!==S}(r,this._eventButton))this.reset();else if(this._moved||!(s.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(p,s)}}mouseupWindow(r){this._lastPoint&&Ee(r)===this._eventButton&&(this._moved&&ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hf extends Md{mousedown(r,s){super.mousedown(r,s),this._lastPoint&&(this._active=!0)}_correctButton(r,s){return s===0&&!r.ctrlKey}_move(r,s){return{around:s,panDelta:s.sub(r)}}}class es extends Md{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const p=.8*(s.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Id extends Md{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const p=-.5*(s.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class mi{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,s,p){return this._calculateTransform(r,s,p)}touchmove(r,s,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,s,p)}}touchend(r,s,p){this._calculateTransform(r,s,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,p){p.length>0&&(this._active=!0);const _=df(p,s),x=new i.P(0,0),S=new i.P(0,0);let I=0;for(const $ in _){const B=_[$],j=this._touches[$];j&&(x._add(B),S._add(B.sub(j)),I++,_[$]=B)}if(this._touches=_,I<this._minTouches||!S.mag())return;const R=S.div(I);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(I),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class pa{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,s,p){return{}}touchstart(r,s,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,p){const _=this._firstTwoTouches;if(!_)return;r.preventDefault();const[x,S]=_,I=Kc(p,s,x),R=Kc(p,s,S);if(!I||!R)return;const $=this._aroundCenter?null:I.add(R).div(2);return this._move([I,R],$,r)}touchend(r,s,p){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,S=Kc(p,s,_),I=Kc(p,s,x);S&&I||(this._active&&ee(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kc(f,r,s){for(let p=0;p<f.length;p++)if(f[p].identifier===s)return r[p]}function Ad(f,r){return Math.log(f/r)/Math.LN2}class v0 extends pa{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Ad(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ad(this._distance,p),pinchAround:s}}}function x0(f,r){return 180*f.angleWith(r)/Math.PI}class Pd extends pa{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:x0(this._vector,p),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const _=x0(r,p);return Math.abs(_)<s}}function Dm(f){return Math.abs(f.y)>Math.abs(f.x)}class gb extends pa{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Dm(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,p){const _=this._lastPoints;if(!_)return;const x=r[0].sub(_[0]),S=r[1].sub(_[1]);return this._map._cooperativeGestures&&!i.dz()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(x,S,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(x.y+S.y)/2*-.5})}gestureBeginsVertically(r,s,p){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,x=s.mag()>=2;if(!_&&!x)return;if(!_||!x)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const S=r.y>0==s.y>0;return Dm(r)&&Dm(s)&&S}}const Rm={panStep:100,bearingStep:15,pitchStep:10};class zm{constructor(){const r=Rm;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,p=0,_=0,x=0,S=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),S=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:I=>{const R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:ec,zoom:s?Math.round(R)+s*(r.shiftKey?2:1):R,bearing:I.getBearing()+p*this._bearingStep,pitch:I.getPitch()+_*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:I.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ec(f){return f*(2-f)}const tc=4.000244140625,Os=1/450;class Ea{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Os,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=i.q.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,s!==0&&s%tc==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=s,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=be(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>tc?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&B!==0&&(B=1/B);const j=s(),U=Math.pow(2,j),q=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(q*B))),this._type==="wheel"&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:s(),_=this._startZoom,x=this._easing;let S,I=!1;if(this._type==="wheel"&&_&&x){const $=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),B=x($);S=i.af(_,p,B),$<1?this._frameId||(this._frameId=!0):I=!0}else S=p,I=!0;this._active=!0,I&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let R=S-s();return R*this._lastDelta<0&&(R=0),{noInertia:!0,needsRenderFrame:!I,zoomDelta:R,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=i.dA;if(this._prevEase){const p=this._prevEase,_=(i.q.now()-p.start)/p.duration,x=p.easing(_+.01)-p.easing(_),S=.27/Math.sqrt(x*x+1e-4)*.01,I=Math.sqrt(.0729-S*S);s=i.dy(S,I,.25,1)}return this._prevEase={start:i.q.now(),duration:r,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ul{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,s){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dl{constructor(){this._tap=new Om({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,s,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=s[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,s,p))}touchmove(r,s,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=s[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,s,p)}touchend(r,s,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,s,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _b{constructor(r,s,p){this._el=r,this._mousePan=s,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yb{constructor(r,s,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class vb{constructor(r,s,p,_){this._el=r,this._touchZoom=s,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ff=f=>f.zoom||f.drag||f.pitch||f.rotate;class b0 extends i.z{}class To{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,s){const p=i.ab.vec3.sub([],s,r);this.radius=i.ab.vec3.length(p[2]<0?i.ab.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){i.ab.vec3.div(r,r,this.constants),i.ab.vec3.normalize(r,r),i.ab.vec3.mul(r,r,this.constants);const s=i.ab.vec3.scale([],r,this.radius);if(s[2]>0){const p=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(s,[0,0,1])),_=i.ab.vec3.scale([],i.ab.vec3.normalize([],[s[0],s[1],0]),this.radius),x=i.ab.vec3.add([],s,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],_,p),s),2));s[0]=x[0],s[1]=x[1]}return s}}function Jc(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class w0{constructor(r,s){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new g0(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new To,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),i.aP(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,x,S]of this._listeners){const I=_===document?this.handleWindowEvent:this.handleEvent;_.addEventListener(x,I,S)}}destroy(){for(const[r,s,p]of this._listeners){const _=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(s,_,p)}}_addDefaultHandlers(r){const s=this._map,p=s.getCanvasContainer();this._add("mapEvent",new fb(s,r));const _=s.boxZoom=new di(s,r);this._add("boxZoom",_);const x=new Ed,S=new nc;s.doubleClickZoom=new ul(S,x),this._add("tapZoom",x),this._add("clickZoom",S);const I=new dl;this._add("tapDragZoom",I);const R=s.touchPitch=new gb(s);this._add("touchPitch",R);const $=new es(r),B=new Id(r);s.dragRotate=new yb(r,$,B),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const j=new hf(r),U=new mi(s,r);s.dragPan=new _b(p,j,U),this._add("mousePan",j),this._add("touchPan",U,["touchZoom","touchRotate"]);const q=new Pd,ce=new v0;s.touchZoomRotate=new vb(p,ce,q,I),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),this._add("blockableMapEvent",new pb(s));const ie=s.scrollZoom=new Ea(s,this);this._add("scrollZoom",ie,["mousePan"]);const he=s.keyboard=new zm;this._add("keyboard",he);for(const de of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[de]&&s[de].enable(r[de])}_add(r,s,p){this._handlers.push({handlerName:r,handler:s,allowed:p}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ff(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,s,p){for(const _ in r)if(_!==p&&(!s||s.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const s=[];for(const p of r)this._el.contains(p.target)&&s.push(p);return s}handleEvent(r,s){this._updatingCamera=!0;const p=r.type==="renderFrame",_=p?void 0:r,x={needsRenderFrame:!1},S={},I={},R=r.touches?this._getMapTouches(r.touches):void 0,$=R?Ie(this._el,R):p?void 0:be(this._el,r);for(const{handlerName:U,handler:q,allowed:ce}of this._handlers){if(!q.isEnabled())continue;let ie;this._blockedByActive(I,ce,U)?q.reset():q[s||r.type]&&(ie=q[s||r.type](r,$,R),this.mergeHandlerResult(x,S,ie,U,_),ie&&ie.needsRenderFrame&&this._triggerRenderFrame()),(ie||q.isActive())&&(I[U]=q)}const B={};for(const U in this._previousActiveHandlers)I[U]||(B[U]=_);this._previousActiveHandlers=I,(Object.keys(B).length||Jc(x))&&(this._changes.push([x,S,B]),this._triggerRenderFrame()),(Object.keys(I).length||Jc(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=x;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(r,s,p,_,x){if(!p)return;i.l(r,p);const S={handlerName:_,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(s.zoom=S),p.panDelta!==void 0&&(s.drag=S),p.pitchDelta!==void 0&&(s.pitch=S),p.bearingDelta!==void 0&&(s.rotate=S)}_applyChanges(){const r={},s={},p={};for(const[_,x,S]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.aroundCoord!==void 0&&(r.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),i.l(s,x),i.l(p,S);this._updateMapTransform(r,s,p),this._changes=[]}_updateMapTransform(r,s,p){const _=this._map,x=_.transform,S=ve=>[ve.x,ve.y,ve.z];if((ve=>{const Me=this._eventsInProgress.drag;return Me&&!this._handlersById[Me.handlerName].isActive()})()&&!Jc(r)){const ve=x.zoom;x.cameraElevationReference="sea",this._originalZoom!=null&&x._orthographicProjectionAtLowPitch&&x.projection.name!=="globe"&&x.pitch===0?(x.cameraElevationReference="ground",x.zoom=this._originalZoom):(x.recenterOnTerrain(),x.cameraElevationReference="ground"),ve!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&_._stop(!0),!Jc(r))return void this._fireEvents(s,p,!0);let{panDelta:I,zoomDelta:R,bearingDelta:$,pitchDelta:B,around:j,aroundCoord:U,pinchAround:q}=r;x._isCameraConstrained&&(R>0&&(R=0),x._isCameraConstrained=!1),q!==void 0&&(j=q),(R||(ve=>s[ve]&&!this._eventsInProgress[ve])("drag"))&&j&&(this._dragOrigin=S(x.pointCoordinate3D(j)),this._originalZoom=x.zoom,this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",_._stop(!0),j=j||_.transform.centerPoint,$&&(x.bearing+=$),B&&(x.pitch+=B),x._updateCameraState();const ce=[0,0,0];if(I)if(x.projection.name==="mercator"){const ve=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(j).dir),Me=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(j.sub(I)).dir);ce[0]=Me[0]-ve[0],ce[1]=Me[1]-ve[1]}else{const ve=x.pointCoordinate(j);if(x.projection.name==="globe"){I=I.rotate(-x.angle);const Me=x._pixelsPerMercatorPixel/x.worldSize;ce[0]=-I.x*i.dB(i.aS(ve.y))*Me,ce[1]=-I.y*i.dB(x.center.lat)*Me}else{const Me=x.pointCoordinate(j.sub(I));ve&&Me&&(ce[0]=Me.x-ve.x,ce[1]=Me.y-ve.y)}}const ie=x.zoom,he=[0,0,0];if(R){const ve=S(U||x.pointCoordinate3D(j)),Me={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],ve,x._camera.position))};if(Me.dir[2]<0){const Te=x.zoomDeltaToMovement(ve,R);i.ab.vec3.scale(he,Me.dir,Te)}}const de=i.ab.vec3.add(ce,ce,he);x._translateCameraConstrained(de),R&&Math.abs(x.zoom-ie)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,p,!0)}_fireEvents(r,s,p){const _=ff(this._eventsInProgress),x=ff(r),S={};for(const B in r){const{originalEvent:j}=r[B];this._eventsInProgress[B]||(S[`${B}start`]=j),this._eventsInProgress[B]=r[B]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const B in S)this._fireEvent(B,S[B]);x&&this._fireEvent("move",x.originalEvent);for(const B in r){const{originalEvent:j}=r[B];this._fireEvent(B,j)}const I={};let R;for(const B in this._eventsInProgress){const{handlerName:j,originalEvent:U}=this._eventsInProgress[B];this._handlersById[j].isActive()||(delete this._eventsInProgress[B],R=s[j]||U,I[`${B}end`]=R)}for(const B in I)this._fireEvent(B,I[B]);const $=ff(this._eventsInProgress);if(p&&(_||x)&&!$){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;B?(j(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:R})):(this._map.fire(new i.z("moveend",{originalEvent:R})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new i.z(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new b0("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const S0="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Qc extends i.E{constructor(r,s){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=s.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,p){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.l({offset:r},s),p)}panTo(r,s,p){return this.easeTo(i.l({center:r},s),p)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,p){return this.easeTo(i.l({zoom:r},s),p)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,p){return this.easeTo(i.l({bearing:r},s),p)}resetNorth(r,s){return this.rotateTo(0,i.l({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=i.az.convert(r);const p=s&&s.bearing||0,_=s&&s.pitch||0,x=r.getNorthWest(),S=r.getSouthEast();return this._cameraForBounds(this.transform,x,S,p,_,s)}_extendPadding(r){const s={top:0,right:0,bottom:0,left:0};return r==null?i.l({},s,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:i.l({},s,r)}_extendCameraOptions(r){return(r=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,s){const p=s.max[0]-s.min[0],_=s.max[1]-s.min[1];return p/_>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):_/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,s,p,_,x,S){const I=r.clone(),R=this._extendCameraOptions(S);I.bearing=_,I.pitch=x;const $=i.bO.convert(s),B=i.bO.convert(p),j=.5*($.lat+B.lat),U=.5*($.lng+B.lng),q=i.dC(j,U),ce=i.ab.vec3.normalize([],q),ie=i.ab.vec3.normalize([],i.ab.vec3.cross([],ce,[0,1,0])),he=i.ab.vec3.cross([],ie,ce),de=[ie[0],ie[1],ie[2],0,he[0],he[1],he[2],0,ce[0],ce[1],ce[2],0,0,0,0,1],ve=[q,i.dC($.lat,$.lng),i.dC(B.lat,$.lng),i.dC(B.lat,B.lng),i.dC($.lat,B.lng),i.dC(j,$.lng),i.dC(j,B.lng),i.dC($.lat,U),i.dC(B.lat,U)];let Me=i.cd.fromPoints(ve.map(yt=>[i.ab.vec3.dot(ie,yt),i.ab.vec3.dot(he,yt),i.ab.vec3.dot(ce,yt)]));const Te=i.ab.vec3.transformMat4([],Me.center,de);i.ab.vec3.squaredLength(Te)===0&&i.ab.vec3.set(Te,0,0,1),i.ab.vec3.normalize(Te,Te),i.ab.vec3.scale(Te,Te,i.ax),I.center=i.dD(Te);const Be=I.getWorldToCameraMatrix(),Pe=i.ab.mat4.invert(new Float64Array(16),Be);Me=i.cd.applyTransform(Me,i.ab.mat4.multiply([],Be,de));const Le=this._extendAABB(Me,I,R,_);if(!Le)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Me=Le,i.ab.vec3.transformMat4(Te,Te,Be);const Ae=.5*(Me.max[2]-Me.min[2]),Ue=this._minimumAABBFrustumDistance(I,Me),tt=i.ab.vec3.scale([],[0,0,1],Ae),gt=i.ab.vec3.add(tt,Te,tt),ct=Ue+(I.pitch===0?0:i.ab.vec3.distance(Te,gt)),St=I.globeCenterInViewSpace,bt=i.ab.vec3.sub([],Te,[St[0],St[1],St[2]]);i.ab.vec3.normalize(bt,bt),i.ab.vec3.scale(bt,bt,ct);const st=i.ab.vec3.add([],Te,bt);i.ab.vec3.transformMat4(st,st,Pe);const _t=i.ds/i.ax,$t=i.ab.vec3.length(st),ot=i.bH(Math.max($t*_t-i.ds,Number.EPSILON),0),Et=Math.min(I.zoomFromMercatorZAdjusted(ot),R.maxZoom);return Et>.5*(i.c6+i.bY)?(I.setProjection({name:"mercator"}),I.zoom=Et,this._cameraForBounds(I,s,p,_,x,S)):{center:I.center,zoom:Et,bearing:_,pitch:x}}_extendAABB(r,s,p,_){const x=.5*((p.padding.left||0)+(p.padding.right||0)),S=.5*((p.padding.top||0)+(p.padding.bottom||0)),I=S,R=x,$=x,B=S,j=s.width-(R+$),U=s.height-(I+B),q=i.ab.vec3.sub([],r.max,r.min),ce=Math.min(j/q[0],U/q[1]),ie=Math.min(s.scaleZoom(s.scale*ce),p.maxZoom);if(isNaN(ie))return null;const he=s.scale/s.zoomScale(ie),de=new i.cd([r.min[0]-R*he,r.min[1]-B*he,r.min[2]],[r.max[0]+$*he,r.max[1]+I*he,r.max[2]]),ve=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new i.P(p.offset.x,p.offset.y):i.P.convert(p.offset)).rotate(-i.ai(_));return de.center[0]-=ve.x*he,de.center[1]+=ve.y*he,de}queryTerrainElevation(r,s){const p=this.transform.elevation;return p?(s=i.l({},{exaggerated:!0},s),p.getAtPoint(i.aa.fromLngLat(r),null,s.exaggerated)):null}_cameraForBounds(r,s,p,_,x,S){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,s,p,_,x,S);const I=r.clone(),R=this._extendCameraOptions(S);I.bearing=_,I.pitch=x;const $=i.bO.convert(s),B=i.bO.convert(p),j=new i.bO($.lng,B.lat),U=new i.bO(B.lng,$.lat),q=I.project($),ce=I.project(B),ie=this.queryTerrainElevation($),he=this.queryTerrainElevation(B),de=this.queryTerrainElevation(j),ve=this.queryTerrainElevation(U),Me=[[q.x,q.y,Math.min(ie||0,he||0,de||0,ve||0)],[ce.x,ce.y,Math.max(ie||0,he||0,de||0,ve||0)]];let Te=i.cd.fromPoints(Me);const Be=I.getWorldToCameraMatrix(),Pe=i.ab.mat4.invert(new Float64Array(16),Be);Te=i.cd.applyTransform(Te,Be);const Le=this._extendAABB(Te,I,R,_);if(!Le)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Le;const Ae=.5*i.ab.vec3.sub([],Te.max,Te.min)[2],Ue=this._minimumAABBFrustumDistance(I,Te),tt=[0,0,1,0];i.ab.vec4.transformMat4(tt,tt,Be),i.ab.vec4.normalize(tt,tt);const gt=i.ab.vec3.scale([],tt,Ue+Ae),ct=i.ab.vec3.add([],Te.center,gt);i.ab.vec3.transformMat4(Te.center,Te.center,Pe),i.ab.vec3.transformMat4(ct,ct,Pe);const St=I.unproject(new i.P(Te.center[0],Te.center[1])),bt=i.dE(I.projection,St),st=Math.pow(2,bt),_t=Math.min(I._zoomFromMercatorZ(ct[2]*I.pixelsPerMeter*st/I.worldSize),R.maxZoom);return I.mercatorFromTransition&&_t<.5*(i.c6+i.bY)?(I.setProjection({name:"globe"}),I.zoom=_t,this._cameraForBounds(I,s,p,_,x,S)):{center:St,zoom:_t,bearing:_,pitch:x}}fitBounds(r,s,p){const _=this.cameraForBounds(r,s);return this._fitInternal(_,s,p)}fitScreenCoordinates(r,s,p,_,x){const S=i.P.convert(r),I=i.P.convert(s),R=new i.P(Math.min(S.x,I.x),Math.min(S.y,I.y)),$=new i.P(Math.max(S.x,I.x),Math.max(S.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,I))return this;const B=this.transform.pointLocation3D(R),j=this.transform.pointLocation3D($),U=this.transform.pointLocation3D(new i.P(R.x,$.y)),q=this.transform.pointLocation3D(new i.P($.x,R.y)),ce=[Math.min(B.lng,j.lng,U.lng,q.lng),Math.min(B.lat,j.lat,U.lat,q.lat)],ie=[Math.max(B.lng,j.lng,U.lng,q.lng),Math.max(B.lat,j.lat,U.lat,q.lat)],he=_&&_.pitch?_.pitch:this.getPitch(),de=this._cameraForBounds(this.transform,ce,ie,p,he,_);return this._fitInternal(de,_,x)}_fitInternal(r,s,p){return r?(s=i.l(r,s)).linear?this.easeTo(s,p):this.flyTo(s,p):this}jumpTo(r,s){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let _=!1,x=!1,S=!1;"zoom"in r&&p.zoom!==+r.zoom&&(_=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=i.bO.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(x=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(S=!0,p.pitch=+r.pitch);const I=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(I))if(r.retainPadding===!1){const R=p.clone();R.padding=I,p.setLocationAtPoint(p.center,R.centerPoint)}else p.padding=I;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new i.z("movestart",s)).fire(new i.z("move",s)),_&&this.fire(new i.z("zoomstart",s)).fire(new i.z("zoom",s)).fire(new i.z("zoomend",s)),x&&this.fire(new i.z("rotatestart",s)).fire(new i.z("rotate",s)).fire(new i.z("rotateend",s)),S&&this.fire(new i.z("pitchstart",s)).fire(new i.z("pitch",s)).fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(S0),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,s){const p=this.transform;if(!p.projection.supportsFreeCamera)return i.w(S0),this;this.stop();const _=p.zoom,x=p.pitch,S=p.bearing;p.setFreeCameraOptions(r);const I=_!==p.zoom,R=x!==p.pitch,$=S!==p.bearing;return this.fire(new i.z("movestart",s)).fire(new i.z("move",s)),I&&this.fire(new i.z("zoomstart",s)).fire(new i.z("zoom",s)).fire(new i.z("zoomend",s)),$&&this.fire(new i.z("rotatestart",s)).fire(new i.z("rotate",s)).fire(new i.z("rotateend",s)),R&&this.fire(new i.z("pitchstart",s)).fire(new i.z("pitch",s)).fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s)),this}easeTo(r,s){this._stop(!1,r.easeId),((r=i.l({offset:[0,0],duration:500,easing:i.dA},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,_=this.getZoom(),x=this.getBearing(),S=this.getPitch(),I=this.getPadding(),R="zoom"in r?+r.zoom:_,$="bearing"in r?this._normalizeBearing(r.bearing,x):x,B="pitch"in r?+r.pitch:S,j=this._extendPadding(r.padding),U=i.P.convert(r.offset);let q,ce,ie;if(p.projection.name==="globe"){const tt=i.aa.fromLngLat(p.center),gt=U.rotate(-p.angle);tt.x+=gt.x/p.worldSize,tt.y+=gt.y/p.worldSize;const ct=tt.toLngLat(),St=i.bO.convert(r.center||ct);this._normalizeCenter(St),q=p.centerPoint.add(gt),ce=new i.P(tt.x,tt.y).mult(p.worldSize),ie=new i.P(i.at(St.lng),i.aA(St.lat)).mult(p.worldSize).sub(ce)}else{q=p.centerPoint.add(U);const tt=p.pointLocation(q),gt=i.bO.convert(r.center||tt);this._normalizeCenter(gt),ce=p.project(tt),ie=p.project(gt).sub(ce)}const he=p.zoomScale(R-_);let de,ve;r.around&&(de=i.bO.convert(r.around),ve=p.locationPoint(de));const Me=this._zooming||R!==_,Te=this._rotating||x!==$,Be=this._pitching||B!==S,Pe=!p.isPaddingEqual(j),Le=r.retainPadding===!1?p.clone():p,Ae=tt=>gt=>{if(Me&&(tt.zoom=i.af(_,R,gt)),Te&&(tt.bearing=i.af(x,$,gt)),Be&&(tt.pitch=i.af(S,B,gt)),Pe&&(Le.interpolatePadding(I,j,gt),q=Le.centerPoint.add(U)),de)tt.setLocationAtPoint(de,ve);else{const ct=tt.zoomScale(tt.zoom-_),St=R>_?Math.min(2,he):Math.max(.5,he),bt=Math.pow(St,1-gt),st=tt.unproject(ce.add(ie.mult(gt*bt)).mult(ct));tt.setLocationAtPoint(tt.renderWorldCopies?st.wrap():st,q)}return r.preloadOnly||this._fireMoveEvents(s),tt};if(r.preloadOnly){const tt=this._emulate(Ae,r.duration,p);return this._preloadTiles(tt),this}const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Me,this._rotating=Te,this._pitching=Be,this._padding=Pe,this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,Ue),this._ease(Ae(p),tt=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(s,tt)},r),this}_prepareEase(r,s,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),s||p.moving||this.fire(new i.z("movestart",r)),this._zooming&&!p.zooming&&this.fire(new i.z("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new i.z("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new i.z("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.z("move",r)),this._zooming&&this.fire(new i.z("zoom",r)),this._rotating&&this.fire(new i.z("rotate",r)),this._pitching&&this.fire(new i.z("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new i.z("zoomend",r)),_&&this.fire(new i.z("rotateend",r)),x&&this.fire(new i.z("pitchend",r)),this.fire(new i.z("moveend",r))}flyTo(r,s){if(this._prefersReducedMotion(r)){const yt=i.ay(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(yt,s)}this.stop(),r=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},r);const p=this.transform,_=this.getZoom(),x=this.getBearing(),S=this.getPitch(),I=this.getPadding(),R="zoom"in r?i.aw(+r.zoom,p.minZoom,p.maxZoom):_,$="bearing"in r?this._normalizeBearing(r.bearing,x):x,B="pitch"in r?+r.pitch:S,j=this._extendPadding(r.padding),U=p.zoomScale(R-_),q=i.P.convert(r.offset);let ce=p.centerPoint.add(q);const ie=p.pointLocation(ce),he=i.bO.convert(r.center||ie);this._normalizeCenter(he);const de=p.project(ie),ve=p.project(he).sub(de);let Me=r.curve;const Te=Math.max(p.width,p.height),Be=Te/U,Pe=ve.mag();if("minZoom"in r){const yt=i.aw(Math.min(r.minZoom,_,R),p.minZoom,p.maxZoom),Gt=Te/p.zoomScale(yt-_);Me=Math.sqrt(Gt/Pe*2)}const Le=Me*Me;function Ae(yt){const Gt=(Be*Be-Te*Te+(yt?-1:1)*Le*Le*Pe*Pe)/(2*(yt?Be:Te)*Le*Pe);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function Ue(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function tt(yt){return(Math.exp(yt)+Math.exp(-yt))/2}const gt=Ae(0);let ct=function(yt){return tt(gt)/tt(gt+Me*yt)},St=function(yt){return Te*((tt(gt)*(Ue(Gt=gt+Me*yt)/tt(Gt))-Ue(gt))/Le)/Pe;var Gt},bt=(Ae(1)-gt)/Me;if(Math.abs(Pe)<1e-6||!isFinite(bt)){if(Math.abs(Te-Be)<1e-6)return this.easeTo(r,s);const yt=Be<Te?-1:1;bt=Math.abs(Math.log(Be/Te))/Me,St=function(){return 0},ct=function(Gt){return Math.exp(yt*Me*Gt)}}r.duration="duration"in r?+r.duration:1e3*bt/("screenSpeed"in r?+r.screenSpeed/Me:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const st=x!==$,_t=B!==S,$t=!p.isPaddingEqual(j),ot=r.retainPadding===!1?p.clone():p,Et=yt=>Gt=>{const Ot=Gt*bt,Tt=1/ct(Ot);yt.zoom=Gt===1?R:_+yt.scaleZoom(Tt),st&&(yt.bearing=i.af(x,$,Gt)),_t&&(yt.pitch=i.af(S,B,Gt)),$t&&(ot.interpolatePadding(I,j,Gt),ce=ot.centerPoint.add(q));const Bt=Gt===1?he:yt.unproject(de.add(ve.mult(St(Ot))).mult(Tt));return yt.setLocationAtPoint(yt.renderWorldCopies?Bt.wrap():Bt,ce),yt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(s),yt};if(r.preloadOnly){const yt=this._emulate(Et,r.duration,p);return this._preloadTiles(yt),this}return this._zooming=!0,this._rotating=st,this._pitching=_t,this._padding=$t,this._prepareEase(s,!1),this._ease(Et(p),()=>this._afterEase(s),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,s)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,s,p){p.animate===!1||p.duration===0?(r(1),s()):(this._easeStart=i.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,s){r=i.bF(r,-180,180);const p=Math.abs(r-s);return Math.abs(r-360-s)<p&&(r-=360),Math.abs(r+360-s)<p&&(r+=360),r}_normalizeCenter(r){const s=this.transform;if(s.maxBounds||s.projection.name!=="globe"&&!s.renderWorldCopies)return;const p=r.lng-s.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,s,p){const _=Math.ceil(15*s/1e3),x=[],S=r(p.clone());for(let I=0;I<=_;I++){const R=S(I/_);x.push(R.clone())}return x}_preloadTiles(r,s){}}class pf{constructor(r={}){this.options=r,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const s=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const _=K("span","mapboxgl-ctrl-icon",this._compactButton);return _.setAttribute("aria-hidden","true"),_.setAttribute("title",p),this._innerContainer=K("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(r){const p=s.reduce((_,x,S)=>(x.value&&(_+=`${x.key}=${x.value}${S<s.length-1?"&":""}`),_),"?");r.href=`${i.e.FEEDBACK_URL}/${p}#${Pm(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const s=this._map.style._mergedSourceCaches;for(const _ in s){const x=s[_];if(x.used){const S=x.getSource();S.attribution&&r.indexOf(S.attribution)<0&&r.push(S.attribution)}}r.sort((_,x)=>_.length-x.length),r=r.filter((_,x)=>{for(let S=x+1;S<r.length;S++)if(r[S].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Yo{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=K("div","mapboxgl-ctrl");const s=K("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const s in r){const p=r[s].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const s=r[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class Xo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,p=s?this._queue.concat(s):this._queue;for(const _ of p)if(_.id===r)return void(_.cancelled=!0)}run(r=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const p of s)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class eu{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const s=i.cB((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,s,p){this._start=this.getValue(s),this._end=r,this._startTime=s,this._endTime=s+p}}const rc={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class ic extends i.z{constructor(r,s,p,_){const{point:x,lngLat:S,originalEvent:I,target:R}=r;super(r.type,{point:x,lngLat:S,originalEvent:I,target:R}),this.preventDefault=()=>{r.preventDefault()},this.id=s,this.interaction=p,this.feature=_}}class Lm{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,s){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const p=s.filter;let _=s.type;p&&this.filters.set(r,i.aZ(p)),_==="mouseover"&&(_="mouseenter"),_==="mouseout"&&(_="mouseleave");const x=this.interactionsByType.get(_)||new Map;_==="mouseenter"||_==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,s)):x.size===0&&this.map.on(_,this.handleType),x.size===0&&this.interactionsByType.set(_,x),x.set(r,s),this.typeById.set(r,_)}get(r){const s=this.typeById.get(r);if(!s)return;const p=this.interactionsByType.get(s);return p?p.get(r):void 0}remove(r){const s=this.typeById.get(r);if(!s)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(s);p&&(p.delete(r),s==="mouseenter"||s==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):p.size===0&&this.map.off(s,this.handleType))}queryTargets(r,s){const p=[];for(const[_,x]of s)x.target&&p.push({targetId:_,target:x.target,filter:this.filters.get(_)});return this.map.style.queryRenderedTargets(r,p,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const s=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());s.length&&(r.type="mouseenter",this.handleType(r,s));const p=new Map;for(const[_,{feature:x}]of this.prevHoveredFeatures)this.hoveredFeatures.has(_)||p.set(x.id,x);p.size&&(r.type="mouseleave",this.handleType(r,Array.from(p.values())))}handleOut(r){const s=Array.from(this.hoveredFeatures.values()).map(({feature:p})=>p);s.length&&(r.type="mouseleave",this.handleType(r,s)),this.hoveredFeatures.clear()}handleType(r,s){const p=Array.from(this.interactionsByType.get(r.type)).reverse(),_=!!s;s=s||this.queryTargets(r.point,p);const x=r.type==="mouseenter";let S=!1;const I=new Set;for(const R of s){for(const[$,B]of p){if(!B.target)continue;const j=R.variants?R.variants[$]:null;if(j){for(const U of j){if(bs(U,R,I,$))continue;const q=new i.cw(R,U),ce=Nu(U,R,$);_&&(q.state=this.map.getFeatureState(q));const ie=x?this.prevHoveredFeatures.get(ce):null,he=new ic(r,$,B,q),de=ie?ie.stop:B.handler(he);if(x&&this.hoveredFeatures.set(ce,{feature:R,stop:de}),de!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[R,$]of p){const{handler:B,target:j}=$;if(!j&&B(new ic(r,R,$,null))!==!1)break}}}function sr(f,r){if(Array.isArray(f)&&Array.isArray(r)){const s=new Set(f),p=new Set(r);return s.size===p.size&&f.every(_=>p.has(_))}return i.bn(f,r)}const hl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},xb={showCompass:!0,showZoom:!0,visualizePitch:!1};class bb{constructor(r,s,p=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new es({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Id({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(r,s){this.mouseRotate.mousedown(r,s),this.mousePitch&&this.mousePitch.mousedown(r,s),ne()}move(r,s){const p=this.map,_=this.mouseRotate.mousemoveWindow(r,s),x=_&&_.bearingDelta;if(x&&p.setBearing(p.getBearing()+x),this.mousePitch){const S=this.mousePitch.mousemoveWindow(r,s),I=S&&S.pitchDelta;I&&p.setPitch(p.getPitch()+I)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ue(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),be(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,be(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ie(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Ie(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function mf(f,r,s){if(f=new i.bO(f.lng,f.lat),r){const p=new i.bO(f.lng-360,f.lat),_=new i.bO(f.lng+360,f.lat),x=360*Math.ceil(Math.abs(f.lng-s.center.lng)/360),S=s.locationPoint(f).distSqr(r),I=r.x<0||r.y<0||r.x>s.width||r.y>s.height;s.locationPoint(p).distSqr(r)<S&&(I||Math.abs(p.lng-s.center.lng)<x)?f=p:s.locationPoint(_).distSqr(r)<S&&(I||Math.abs(_.lng-s.center.lng)<x)&&(f=_)}for(;Math.abs(f.lng-s.center.lng)>180;){const p=s.locationPoint(f);if(p.x>=0&&p.y>=0&&p.x<=s.width&&p.y<=s.height)break;f.lng>s.center.lng?f.lng-=360:f.lng+=360}return f}const ts={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ma extends i.E{constructor(r,s){if(super(),(r instanceof HTMLElement||s)&&(r=i.l({element:r},s)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=K("div");const x=41,S=27,I=J("svg",{display:"block",height:x*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${x}`},this._element),R=J("radialGradient",{id:"shadowGradient"},J("defs",{},I));J("stop",{offset:"10%","stop-opacity":.4},R),J("stop",{offset:"100%","stop-opacity":.05},R),J("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),J("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),J("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),J("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=i.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const p=this._element.classList;for(const x in ts)p.remove(`mapboxgl-marker-anchor-${x}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const _=r&&r.className?r.className.trim().split(/\s+/):[];p.add(..._),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.bO.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const s=r.code,p=r.charCode||r.keyCode;s!=="Space"&&s!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const s=r.originalEvent.target,p=this._element;this._popup&&(s===p||p.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,s=this._pos;if(!r||!s)return!1;const p=r.unproject(s),_=r.getFreeCameraOptions();if(!_.position)return!1;const x=_.position.toLngLat();return x.distanceTo(p)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const s=this._pos;if(!s||s.x<0||s.x>r.transform.width||s.y<0||s.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(s);let _;r._showingGlobe()&&i.dH(r.transform,this._lngLat)?_=0:(_=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${ts[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const r=this._pos,s=this._map,p=this.getPitchAlignment();if(!s||!r||p!=="map")return"";if(!s._showingGlobe()){const R=s.getPitch();return R?`rotateX(${R}deg)`:""}const _=i.c4(i.dI(s.transform,this._lngLat)),x=r.sub(i.dJ(s.transform)),S=Math.abs(x.x)+Math.abs(x.y);if(S===0)return"";const I=_/S;return`rotateX(${-x.y*I}deg) rotateY(${x.x*I}deg)`}_calculateZTransform(){const r=this._pos,s=this._map;if(!s||!r)return"";let p=0;const _=this.getRotationAlignment();if(_==="map")if(s._showingGlobe()){const x=s.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),S=s.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);p=i.c4(Math.atan2(S.y,S.x))-90}else p=-s.getBearing();else if(_==="horizon"){const x=i.ac(4,6,s.getZoom()),S=i.dJ(s.transform);S.y+=x*s.transform.height;const I=r.sub(S),R=i.c4(Math.atan2(I.y,I.x));p=(R>90?R-270:R+90)*(1-x)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=mf(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const s=this._map;if(!s)return;const p=this._pointerdownPos,_=this._positionDelta;if(p&&_){if(!this._isDragging){const x=this._clickTolerance||s._clickTolerance;if(r.point.dist(p)<x)return;this._isDragging=!0}this._pos=r.point.sub(_),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(r){const s=this._map,p=this._pos;s&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const s=this._map;return s&&(r?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Eo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},jo={maxWidth:100,unit:"metric"},to={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},C0={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},hi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $m(f=new i.P(0,0),r="bottom"){if(typeof f=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new i.P(0,f);case"top-left":return new i.P(s,s);case"top-right":return new i.P(-s,s);case"bottom":return new i.P(0,-f);case"bottom-left":return new i.P(s,-s);case"bottom-right":return new i.P(-s,-s);case"left":return new i.P(f,0);case"right":return new i.P(-f,0)}return new i.P(0,0)}return f instanceof i.P||Array.isArray(f)?i.P.convert(f):i.P.convert(f[r]||[0,0])}return{version:O,supported:Y.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends Qc{constructor(f){z.mark(L.create);const r=f;if((f=i.l({},hl,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&i.dF(window)&&(f.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ju(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Xo,this._domRenderTaskQueue=new Xo,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},rc,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new eu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new We(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?Object.assign({},f.contextCreateOptions):{},typeof f.container=="string"){const s=document.getElementById(f.container);if(!s)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=s}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),this._spriteFormat=f.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Cm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new w0(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||i.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this.indoor=new Np(this),f.hash&&(this._hash=new d0(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const s=f.bounds;s&&(this.resize(),this.fitBounds(s,i.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new pf({customAttribution:f.customAttribution})),this._logoControl=new Yo,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new i.z(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new i.z(`${s.dataType}dataloading`,s))}),this._interactions=new Lm(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(s,p.firstChild):p.appendChild(s),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.z("movestart",f)).fire(new i.z("move",f)),this.fire(new i.z("resize",f)),r&&this.fire(new i.z("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(i.az.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let s;r==="globe"&&f.zoom>=i.bY?(f.setMercatorFromTransition(),s=!0):r==="mercator"&&f.zoom<i.bY&&(f.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(i.bO.convert(f))}unproject(f){return this.transform.pointLocation3D(i.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,s){const p=_=>{let x=[];if(Array.isArray(r)){const S=r.filter(I=>this.getLayer(I));x=S.length?this.queryRenderedFeatures(_,{layers:S}):[]}else x=this.queryRenderedFeatures(_,{target:r});return x};if(f==="mouseenter"||f==="mouseover"){let _=!1;return{listener:s,targets:r,delegates:{mousemove:S=>{const I=p(S.point);I.length?_||(_=!0,s.call(this,new Vo(f,this,S.originalEvent,{features:I}))):_=!1},mouseout:()=>{_=!1}}}}if(f==="mouseleave"||f==="mouseout"){let _=!1;return{listener:s,targets:r,delegates:{mousemove:I=>{p(I.point).length?_=!0:_&&(_=!1,s.call(this,new Vo(f,this,I.originalEvent)))},mouseout:I=>{_&&(_=!1,s.call(this,new Vo(f,this,I.originalEvent)))}}}}{const _=x=>{const S=p(x.point);S.length&&(x.features=S,s.call(this,x),delete x.features)};return{listener:s,targets:r,delegates:{[f]:_}}}}on(f,r,s){if(typeof r=="function"||s===void 0)return super.on(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(f,r,s){if(typeof r=="function"||s===void 0)return super.once(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,s);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(f,r,s){if(typeof r=="function"||s===void 0)return super.off(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._delegatedListeners?this._delegatedListeners[f]:void 0;return p&&(_=>{for(let x=0;x<_.length;x++){const S=_[x];if(S.listener===s&&sr(S.targets,r)){for(const I in S.delegates)this.off(I,S.delegates[I]);return _.splice(x,1),this}}})(p),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(f===void 0||f instanceof i.P||Array.isArray(f)||r!==void 0||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],!r){const x=this.style.queryRenderedFeatures(f,void 0,this.transform),S=this.style.queryRenderedFeatureset(f,void 0,this.transform);return x.concat(S)}let s=!0;if(r.target&&(s=this._isTargetValid(r.target),s&&!r.layers))return this.style.queryRenderedFeatureset(f,r,this.transform);let p=!0;if(r.layers&&Array.isArray(r.layers)){for(const x of r.layers)if(!this._isValidId(x)){p=!1;break}if(p&&!r.target)return this.style.queryRenderedFeatures(f,r,this.transform)}let _=[];return p&&(_=_.concat(this.style.queryRenderedFeatures(f,r,this.transform))),s&&(_=_.concat(this.style.queryRenderedFeatureset(f,r,this.transform))),_}querySourceFeatures(f,r){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,r){return r=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(s,p)=>{s?(i.w(`Unable to perform style diff: ${String(s.message||s.error||s)}. Rebuilding the style from scratch.`),this._updateStyle(f,r)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const s=i.l({},r);r&&r.config&&(s.initialConfig=r.config,delete s.config),this.style=new fa(this,s).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new fa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(f)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isTargetValid(f){return"featuresetId"in f?this._isValidId("importId"in f?f.importId:f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const r of f)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(f)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,s){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,s)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:s=1,sdf:p=!1,stretchX:_,stretchY:x,content:S}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:I,height:R,data:$}=i.q.getImageData(r);this.style.addImage(f,{data:new i.r({width:I,height:R},$),pixelRatio:s,stretchX:_,stretchY:x,content:S,sdf:p,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:R}=r,$=r;this.style.addImage(f,{data:new i.r({width:I,height:R},new Uint8Array($.data)),pixelRatio:s,stretchX:_,stretchY:x,content:S,sdf:p,usvg:!1,version:0,userImage:$}),$.onAdd&&$.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const s=this.style.getImage(f);if(!s)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.q.getImageData(r):r,{width:_,height:x,data:S}=p;if(_===void 0||x===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==(s.usvg?s.icon.usvg_tree.width:s.data.width)||x!==(s.usvg?s.icon.usvg_tree.height:s.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${_}, ${x})
                must be that same as the previous version of the image
                (${s.data.width}, ${s.data.height})`)));const I=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let R=!1;s.usvg?(s.data=new i.r({width:_,height:x},new Uint8Array(S)),s.usvg=!1,s.icon=void 0,R=!0):s.data.replace(S,I),this.style.updateImage(f,s,R)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){i.o(this._requestManager.transformRequest(f,i.R.Image),(s,p)=>{r(s,p instanceof HTMLImageElement?i.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,s){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,s),this._update(!0)):this}setFilter(f,r,s={}){return this._isValidId(f)?(this.style.setFilter(f,r,s),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,s,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,s,p),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,s,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,s,p),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,s){return this.style.setConfigProperty(f,r,s),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(f){return this._lazyInitEmptyStyle(),this.style.setSnow(f),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(f){return this._lazyInitEmptyStyle(),this.style.setRain(f),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setImportColorTheme(f,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(f,r),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(f),this.transform):0}setFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,r),this._update())}removeFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,r),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let s,p,_,x=this._container;for(;x&&(!p||!_);){const S=window.getComputedStyle(x).transform;S&&S!=="none"&&(s=S.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(p=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(_=s[3])),x=x.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=_?Math.abs(r/_):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=K("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=K("div","mapboxgl-canvas-container",f);this._canvas=K("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=K("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(_=>{p[_]=K("div",`mapboxgl-ctrl-${_}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const s=i.q.devicePixelRatio||1;this._canvas.width=s*Math.ceil(f),this._canvas.height=s*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=i.l({},Y.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(Ve(r,!0),this.painter=new Am(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(r)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new i.z("renderstart")),++this._frameId;const s=this.painter.context.extTimerQuery,p=i.q.now(),_=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=_.createQuery(),_.beginQuery(s.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,B=this.transform.pitch,j=i.q.now(),U=new i.a8($,{now:j,fadeDuration:x,pitch:B,transition:this.style.transition});this.style.update(U)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(p);const I=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),I&&(this._placementDirty=I.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,z.mark(L.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const $=i.q.now()-p;_.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const B=_.getQueryParameter(r,_.QUERY_RESULT)/1e6;_.deleteQuery(r),this.fire(new i.z("gpu-timing-frame",{cpuTime:$,gpuTime:B}))},50)}if(this.listens("gpu-timing-layer")){const $=this.painter.collectGpuTimers();setTimeout(()=>{const B=this.painter.queryGpuTimers($);this.fire(new i.z("gpu-timing-layer",{layerTimes:B}))},50)}if(this.listens("gpu-timing-deferred-render")){const $=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const B=this.painter.queryGpuTimeDeferredRender($);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:B}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(R||this._repaint)this.triggerRepaint();else{const $=this.idle();if($&&(S=this._updateAverageElevation(p,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),$&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,z.mark(L.fullLoad),this._performanceMetricsCollection&&En(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const s=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const _=this.transform.averageElevation;let x=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=f;const S=Math.abs(_-x);if(S>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(x),s(x);this._averageElevation.easeTo(x,f,300)}else if(S>1e-4)return this._averageElevation.jumpTo(x),s(x)}return!!this._averageElevation.isEasing(f)&&s(this._averageElevation.getValue(f))}_authenticate(){_e(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===et||f.status===401)){const r=this.painter.context.gl;Ve(r,!1),this._logoControl instanceof Yo&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),_n(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&ln(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const s=this.painter.context.gl,p=s.createFramebuffer();function _(x){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,x,0);const S=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,S),S}return s.bindFramebuffer(s.FRAMEBUFFER,p),this._canvasPixelComparison(_(f),r.canvasCopies.map(_),r.timeStamps)}_canvasPixelComparison(f,r,s){let p=s[1]-s[0];const _=f.length/4;for(let x=0;x<r.length;x++){const S=r[x];let I=0;for(let R=0;R<S.length;R+=4)S[R]===f[R]&&S[R+1]===f[R+1]&&S[R+2]===f[R+2]&&S[R+3]===f[R+3]&&(I+=1);p+=(s[x+2]-s[x+1])*(1-I/_)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ft.delete(this.painter.context.gl),Nt.remove(),It.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=i.q.frame(r=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return i.bl(r,(s,p)=>s._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){i.dG(f,r)}get version(){return O}},NavigationControl:class{constructor(f={}){this.options=i.l({},xb,f),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),K("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),K("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:r}):s.resetNorth({},{originalEvent:r}))}),this._compassIcon=K("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),s=r===f.getMaxZoom(),p=r===f.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new bb(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const s=K("button",f,this._container);return s.type="button",s.addEventListener("click",r),s}_setButtonTitle(f,r){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",s),f.firstElementChild&&f.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends i.E{constructor(f={}){super();const r=navigator.geolocation;this.options=i.l({geolocation:r},Eo,f),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=uf(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,f(s)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(s=>r(s.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),s=f.coords;return!!r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",f)),this._finish()}}_updateCamera(f){const r=new i.bO(f.coords.longitude,f.coords.latitude),s=f.coords.accuracy,p=this._map.getBearing(),_=i.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(s),_,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new i.bO(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=i.bH(1,f._center.lat)*f.worldSize,s=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=K("button","mapboxgl-ctrl-geolocate",this._container),K("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K("div","mapboxgl-user-location"),this._dotElement.appendChild(K("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(K("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ma({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=K("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ma({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pf,ScaleControl:class{constructor(f={}){this.options=i.l({},jo,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,s=r._containerHeight/2,p=r._containerWidth/2-f/2,_=r.unproject([p,s]),x=r.unproject([p+f,s]),S=_.distanceTo(x);if(this.options.unit==="imperial"){const I=3.2808*S;I>5280?this._setScale(f,I/5280,"mile"):this._setScale(f,I,"foot")}else this.options.unit==="nautical"?this._setScale(f,S/1852,"nautical-mile"):S>=1e3?this._setScale(f,S/1e3,"kilometer"):this._setScale(f,S,"meter")}_setScale(f,r,s){this._map._requestDomTask(()=>{const p=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let I=x/S;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(R){const $=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*$)/$}(I),S*I}(r),_=p/r;this._container.innerHTML=this._isNumberFormatSupported&&s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(p):`${p}&nbsp;${to[s]}`,this._container.style.width=f*_+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=K("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(f){super(),this.options=i.l(Object.create(C0),f),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=i.bO.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),s=document.createElement("body");let p;for(s.innerHTML=f;p=s.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=K("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const s=this._closeButton=K("button","mapboxgl-popup-close-button",r);s.type="button",s.setAttribute("aria-label","Close popup"),s.innerHTML='<span aria-hidden="true">&#215;</span>',s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,s=this._container,p=this._pos;if(!r||!s||!p)return"bottom";const _=s.offsetWidth,x=s.offsetHeight,S=p.x<_/2,I=p.x>r.transform.width-_/2;if(p.y+f<x)return S?"top-left":I?"top-right":"top";if(p.y>r.transform.height-x){if(S)return"bottom-left";if(I)return"bottom-right"}return S?"left":I?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,s=this._content;if(!r||!this._lngLat&&!this._trackPointer||!s)return;let p=this._container;if(p||(p=this._container=K("div","mapboxgl-popup",r.getContainer()),this._tip=K("div","mapboxgl-popup-tip",p),p.appendChild(s)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=mf(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const _=this._pos=this._trackPointer&&f instanceof i.P?f:r.project(this._lngLat),x=$m(this.options.offset),S=this._anchor=this._getAnchor(x.y),I=$m(this.options.offset,S),R=_.add(I).round();r._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${ts[S]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&r._showingGlobe()){const _=i.dH(r.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(hi);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Ma,Style:fa,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:zh,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(f){i.e.ACCESS_TOKEN=f},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(f){i.e.API_URL=f},get workerCount(){return i.dO.workerCount},set workerCount(f){i.dO.workerCount=f},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){i.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){i.dP(f)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(f){i.dQ.workerUrl=f},get workerClass(){return i.dQ.workerClass},set workerClass(f){i.dQ.workerClass=f},get workerParams(){return i.dQ.workerParams},set workerParams(f){i.dQ.workerParams=f},get dracoUrl(){return i.dR()},set dracoUrl(f){i.dS(f)},get meshoptUrl(){return i.dT()},set meshoptUrl(f){i.dU(f)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var w=d;return w})}(gv)),gv.exports}var Lre=zre();const lh=Ac(Lre),$re="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20id='_27129'%20data-name='%2027129'%20width='35'%20height='35'%20transform='translate(0.489%20-0.497)'%20fill='%23fff'%20stroke='%23707070'%20stroke-width='1'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20id='_19630'%20data-name='%2019630'%20transform='translate(-0.489%200.497)'%20clip-path='url(%23clip-path)'%3e%3cg%20id='_25614'%20data-name='%2025614'%20transform='translate(2.5%202.66)'%3e%3cpath%20id='Premium'%20d='M106.479,128a.987.987,0,0,1,.8.4l.071.115,4.3,7.935.05.122.016.053.026.134.008.124a1.025,1.025,0,0,1-.036.263l-.062.165-.05.091a1,1,0,0,1-.1.134l.079-.1-.033.046L99.367,151.311a.953.953,0,0,1-.391.305l-.129.043-.1.022-.166.013-.132-.008-.155-.034a.944.944,0,0,1-.228-.1l-.013-.009a.885.885,0,0,1-.171-.137L85.653,137.525l-.034-.042-.053-.078a.981.981,0,0,1-.14-.4l-.008-.122,0-.087.017-.117a.952.952,0,0,1,.032-.113l.029-.078.037-.075,4.278-7.9a.987.987,0,0,1,.733-.508l.133-.011Zm-3.949,9.873h-7.9l3.952,10.119Zm-10.015,0H88.589l7.044,8-3.12-8Zm16.058,0h-3.923l-3.117,7.991,7.039-7.991Zm-13.975-7.9H91.27L88.061,135.9H92.7l1.9-5.924Zm5.9,0H96.67l-1.9,5.924h7.615l-1.9-5.924Zm5.4,0h-3.324l1.9,5.924H109.1l-3.207-5.924Z'%20transform='translate(-83.496%20-128)'%20fill='%23353535'/%3e%3cg%20id='location-dealer'%20transform='translate(0%2018.832)'%3e%3cpath%20id='_76624'%20data-name='%2076624'%20d='M92.935,683.145q-2.142-3.788-4.315-7.557a1.072,1.072,0,0,0-1.825-.046,1.048,1.048,0,0,0-.011,1.174q1.586,2.77,3.165,5.544a.674.674,0,0,1,.151.333H65.84c.391-.687.756-1.329,1.121-1.97.744-1.3,1.493-2.6,2.232-3.91a1.078,1.078,0,0,0-.653-1.63,1.1,1.1,0,0,0-1.252.624c-1.384,2.421-2.738,4.86-4.163,7.257a1.153,1.153,0,0,0,1.053,1.811c4.413-.039,8.826-.017,13.24-.017q7.243,0,14.486,0A1.071,1.071,0,0,0,92.935,683.145Z'%20transform='translate(-62.921%20-675.048)'%20fill='%23fd4b17'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Fre="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20id='_27130'%20data-name='%2027130'%20width='35'%20height='35'%20transform='translate(-0.742%20-0.444)'%20fill='%23fff'%20stroke='%23707070'%20stroke-width='1'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20id='_19631'%20data-name='%2019631'%20transform='translate(0.742%200.444)'%20clip-path='url(%23clip-path)'%3e%3cg%20id='location-dealer'%20transform='translate(1.258%202.164)'%3e%3cpath%20id='_76625'%20data-name='%2076625'%20d='M191.7,77.521a1.1,1.1,0,0,0,1.082-1.172,9.3,9.3,0,0,1,.474-2.812,8.576,8.576,0,0,1,8.4-5.966,8.325,8.325,0,0,1,7.38,4.707,8.012,8.012,0,0,1,.948,4.947,9.457,9.457,0,0,1-1.167,3.244,41.158,41.158,0,0,1-7.275,9.236c-.147.148-.213.07-.316-.027-.839-.784-1.649-1.6-2.422-2.444a28.638,28.638,0,0,1-5.1-7.246,1.077,1.077,0,1,0-1.954.9,16.11,16.11,0,0,0,.918,1.8,39.762,39.762,0,0,0,7.91,9.32,1.093,1.093,0,0,0,1.694-.028,53.419,53.419,0,0,0,4.636-4.943,30.81,30.81,0,0,0,4.043-6.028,10.781,10.781,0,0,0,1.264-4.639,11.23,11.23,0,0,0-2.1-6.458,10.673,10.673,0,0,0-11-4.262,11,11,0,0,0-8.5,10.7A1.1,1.1,0,0,0,191.7,77.521Z'%20transform='translate(-186.323%20-65.39)'%20fill='%23353535'/%3e%3cpath%20id='_76626'%20data-name='%2076626'%20d='M92.982,683.158q-2.145-3.793-4.322-7.569a1.074,1.074,0,0,0-1.828-.046,1.05,1.05,0,0,0-.011,1.176q1.588,2.775,3.17,5.552a.676.676,0,0,1,.152.333h-24.3c.392-.688.757-1.331,1.123-1.973.745-1.305,1.5-2.608,2.235-3.916a1.08,1.08,0,0,0-.654-1.633,1.1,1.1,0,0,0-1.254.625c-1.386,2.425-2.742,4.868-4.169,7.268a1.155,1.155,0,0,0,1.055,1.814c4.42-.039,8.84-.017,13.26-.017q7.254,0,14.509,0A1.072,1.072,0,0,0,92.982,683.158Z'%20transform='translate(-62.921%20-654.537)'%20fill='%23fd4b17'/%3e%3cpath%20id='_76627'%20data-name='%2076627'%20d='M391.812,262.363a4.319,4.319,0,1,0-4.336,4.319A4.325,4.325,0,0,0,391.812,262.363Zm-6.478,0a2.159,2.159,0,1,1,2.2,2.164A2.165,2.165,0,0,1,385.334,262.359Z'%20transform='translate(-372.4%20-251.563)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Bre="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20id='_27131'%20data-name='%2027131'%20width='35'%20height='35'%20transform='translate(-0.163%20-0.463)'%20fill='%23fff'%20stroke='%23707070'%20stroke-width='1'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20id='_19632'%20data-name='%2019632'%20transform='translate(0.163%200.463)'%20clip-path='url(%23clip-path)'%3e%3cg%20id='service'%20transform='translate(3.588%202.031)'%3e%3cpath%20id='_76628'%20data-name='%2076628'%20d='M584.948,546.268a1.088,1.088,0,0,0-1.989-.884c-.552.994-2.762,1.547-5.855,1.547a1.1,1.1,0,0,0,0,2.209h.331C580.308,549.141,583.843,548.588,584.948,546.268Z'%20transform='translate(-560.534%20-529.145)'%20fill='%23fd4b17'/%3e%3cpath%20id='_76629'%20data-name='%2076629'%20d='M154.845,104.731l-1.436-.552a12.172,12.172,0,0,0-24.3.221l-.663.442a1.364,1.364,0,0,0-.442.884v4.64a1.1,1.1,0,0,0,2.209,0v-3.977l.663-.442a1.4,1.4,0,0,0,.442-.994,9.942,9.942,0,1,1,19.885,0,1.061,1.061,0,0,0,.773.994l1.436.552v3.756a1.1,1.1,0,1,0,2.209,0v-4.64A1.046,1.046,0,0,0,154.845,104.731Z'%20transform='translate(-128%20-92.8)'%20fill='%23353535'/%3e%3cpath%20id='_76630'%20data-name='%2076630'%20d='M174.656,235.6a6.3,6.3,0,1,1,6.3-6.3,5.378,5.378,0,0,1-.11,1.326,1.127,1.127,0,1,0,2.209.442,9.667,9.667,0,0,0,.221-1.768,8.507,8.507,0,1,0-13.146,7.07,11.13,11.13,0,0,0-7.512,8.506,1.118,1.118,0,0,0,.884,1.326h.221a1.076,1.076,0,0,0,1.1-.884c.884-4.529,4.861-7.512,9.942-7.512a1.044,1.044,0,0,0,1.1-1.1,1.2,1.2,0,0,0-1.215-1.1Zm8.4,2.1a1.1,1.1,0,0,0-1.326,1.768,10.07,10.07,0,0,1,3.977,5.965,1.076,1.076,0,0,0,1.1.884h.221a1.146,1.146,0,0,0,.884-1.326A12.082,12.082,0,0,0,183.052,237.7Z'%20transform='translate(-161.399%20-216.381)'%20fill='%23353535'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",kre="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20id='_27132'%20data-name='%2027132'%20width='35'%20height='35'%20transform='translate(0.431%200)'%20fill='%23fff'%20stroke='%23707070'%20stroke-width='1'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20id='_19633'%20data-name='%2019633'%20transform='translate(-0.431)'%20clip-path='url(%23clip-path)'%3e%3cg%20id='icon_ride'%20transform='translate(-0.195%202.191)'%3e%3cpath%20id='_76631'%20data-name='%2076631'%20d='M6.915,541.682a7.223,7.223,0,0,0,0,14.432,7.223,7.223,0,0,0,0-14.432Zm0,12.535a5.323,5.323,0,0,1,0-10.637,5.323,5.323,0,0,1,0,10.637Z'%20transform='translate(0%20-525.473)'%20fill='%23fd4b17'/%3e%3cpath%20id='_76632'%20data-name='%2076632'%20d='M327.306,13.653a1.684,1.684,0,0,0,1.225.534h5.184a1.819,1.819,0,0,0,0-3.634h-4.471l-3.193-3.348a1.723,1.723,0,0,0-1.232-.532,1.7,1.7,0,0,0-1.231.532l-4.445,4.639a1.877,1.877,0,0,0,.008,2.578l4.363,4.514v6.207a1.743,1.743,0,1,0,3.484,0l0-6.964a1.861,1.861,0,0,0-.514-1.293l-3.639-3.758,1.975-2.064Zm2.186-6.89a3.308,3.308,0,0,0,3.23-3.383,3.232,3.232,0,1,0-6.457,0A3.311,3.311,0,0,0,329.491,6.763Z'%20transform='translate(-307.846)'%20fill='%23353535'/%3e%3cpath%20id='_76633'%20data-name='%2076633'%20d='M644.157,541.682a7.223,7.223,0,1,0,6.917,7.217,7.059,7.059,0,0,0-6.917-7.217Zm0,12.534a5.321,5.321,0,1,1,5.1-5.317A5.205,5.205,0,0,1,644.157,554.216Z'%20transform='translate(-615.685%20-525.473)'%20fill='%23fd4b17'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Nre="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20id='_27133'%20data-name='%2027133'%20width='35'%20height='35'%20transform='translate(-0.07%20-0.463)'%20fill='%23fff'%20stroke='%23707070'%20stroke-width='1'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20id='_19634'%20data-name='%2019634'%20transform='translate(0.07%200.463)'%20clip-path='url(%23clip-path)'%3e%3cg%20id='_25615'%20data-name='%2025615'%20transform='translate(2.522%202.539)'%3e%3cpath%20id='_76634'%20data-name='%2076634'%20d='M153.941,96a9.668,9.668,0,0,0-9.668,9.668l.019.6a9.609,9.609,0,0,0,.273,1.764l.1.36-9.709,9.711-.276.3a4.64,4.64,0,0,0,.276,6.24l.314.283a4.626,4.626,0,0,0,6.231-.283l9.706-9.711.363.1a9.668,9.668,0,0,0,11.384-12.868l-.669-1.728-3.159,3.157A2.209,2.209,0,1,1,156,100.481l3.159-3.159-1.728-.672a9.646,9.646,0,0,0-3.492-.65Zm0,2.417.541.019.131.014-.317.319a4.626,4.626,0,0,0,0,6.545l.309.283a4.626,4.626,0,0,0,6.233-.283l.317-.321.017.133a7.251,7.251,0,0,1-9.849,7.306l-.735-.285-10.8,10.792a2.209,2.209,0,0,1-3.277-2.956l.193-.213,10.755-10.75-.285-.732a7.251,7.251,0,0,1,6.763-9.871Z'%20transform='translate(-133.609%20-96)'%20fill='%23353535'/%3e%3cline%20id='_2596'%20data-name='%202596'%20y1='4.585'%20x2='4.585'%20transform='translate(4.767%2020.765)'%20fill='none'%20stroke='%23fd4b17'%20stroke-linecap='round'%20stroke-width='3'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",jr={IS_MOBILE:/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||"ontouchstart"in window&&navigator.maxTouchPoints>0,IS_DEV:!1,ACCESS_TOEKN:"pk.eyJ1IjoiZXJwYW5vbWVyIiwiYSI6ImNtODN2M3lzNjBsc24yanI0Y3FkNXo5aDYifQ.9g2y8zRNHFfPTqfaXIWxCg",DEFAULT_CENTER:[-118.0013,33.82981],DEFAULT_RADIUS:20,E_BIKES:{8792002461944:{name:"Carbon Fold 1",img:"https://newurtopia.com/cdn/shop/files/20241022-144851.png?v=1729579789"},8922206961912:{name:"Carbon 1 ST",img:"https://newurtopia.com/cdn/shop/files/0010.png?v=1737363451"},8794812776696:{name:"Fusion GT",img:"https://newurtopia.com/cdn/shop/files/19566.png?v=1729236036"},8230663028984:{name:"Carbon 1 Pro",img:"https://newurtopia.com/cdn/shop/products/collectionblack.png?v=1703557822"},7902779474168:{name:"Carbon 1/1s",img:"https://newurtopia.de/cdn/shop/files/1sb_b90f667e-42ce-4987-8784-4040af3a37a3.png?v=1695624132"},7948552077560:{name:"Chord/ChordX",img:"https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Mask_Group_18754.png?v=1689236445"}},SERVICES:{1:{name:"Premium Dealer",icon:$re},2:{name:"Standard Dealer",icon:Fre},3:{name:"Test Ride",icon:Bre},4:{name:"Free Assembly",icon:kre},5:{name:"Service",icon:Nre}},THEME:{token:{colorPrimary:"#111",colorBgElevated:"#111",colorFillTertiary:"#E8E8E8",colorLink:"#222",colorLinkHover:"#444",colorLinkActive:"#000",fontFamily:'"Helvetica Now Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, Helvetica Neue, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},components:{Select:{colorPrimary:"#ff4d4f",colorBgElevated:"#fff",controlItemBgActive:"#e6f4ff"},Popover:{colorTextHeading:"#111",colorPrimary:"#111",colorBgElevated:"#eee"},Modal:{colorBgElevated:"#fff"},Calendar:{colorPrimary:"#ff4d4f",colorBgElevated:"#fff"}}},WEEK:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]};function zw(e=0,t=0){return t===0?e*1609.34:e*621371e-9}function cT(e=[],t=[]){return e=new lh.LngLat(...e),t=new lh.LngLat(...t),((e.distanceTo(t)/1e3).toFixed(2)*.621371).toFixed(2)}function Lw(e=[],t=0){return!e.length||t<0?[]:new lh.LngLat(...e).toBounds(t*1).toArray()}function UO(e,t){const o=new Set(t);return e.every(c=>o.has(c))}function x_(e,t){return new Promise(o=>{const c=e.getZoom();e.once("moveend",o),e.easeTo({center:t,zoom:c})})}var Vre=Object.defineProperty,jre=Object.defineProperties,Ure=Object.getOwnPropertyDescriptors,Wv=Object.getOwnPropertySymbols,j$=Object.prototype.hasOwnProperty,U$=Object.prototype.propertyIsEnumerable,HO=(e,t,o)=>t in e?Vre(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Mg=(e,t)=>{for(var o in t||(t={}))j$.call(t,o)&&HO(e,o,t[o]);if(Wv)for(var o of Wv(t))U$.call(t,o)&&HO(e,o,t[o]);return e},GO=(e,t)=>jre(e,Ure(t)),Hre=(e,t)=>{var o={};for(var c in e)j$.call(e,c)&&t.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&Wv)for(var c of Wv(e))t.indexOf(c)<0&&U$.call(e,c)&&(o[c]=e[c]);return o},uT=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)},Gre=(e,t,o)=>(uT(e,t,"read from private field"),o?o.call(e):t.get(e)),WO=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},qO=(e,t,o,c)=>(uT(e,t,"write to private field"),t.set(e,o),o),ZO=(e,t,o)=>(uT(e,t,"access private method"),o),Dg=(e,t,o)=>new Promise((c,d)=>{var y=O=>{try{i(o.next(O))}catch(L){d(L)}},w=O=>{try{i(o.throw(O))}catch(L){d(L)}},i=O=>O.done?c(O.value):Promise.resolve(O.value).then(y,w);i((o=o.apply(e,t)).next())}),ia=class{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(e){if(e instanceof ia)return new ia(e.lng,e.lat);if(Array.isArray(e)&&e.length===2)return new ia(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null&&("lng"in e||"lon"in e)&&"lat"in e)return new ia(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},Rg=class{constructor(e,t){this._sw=ia.convert(e),this._ne=ia.convert(t)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ia(this.getWest(),this.getNorth())}getSouthEast(){return new ia(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(e){if(!e)throw new Error("Invalid LngLatBounds convert value: falsy");if(e instanceof Rg)return new Rg(e.getSouthWest(),e.getNorthEast());if(Array.isArray(e)&&e.length===2)return new Rg(ia.convert(e[0]),ia.convert(e[1]));if(Array.isArray(e)&&e.length===4)return new Rg(ia.convert([e[0],e[1]]),ia.convert([e[2],e[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function Wre(){const t=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[t.slice(0,8),t.slice(8,12),"4"+t.slice(12,15)+"-8"+t.slice(15,18),t.slice(18,30)].join("-")}var ZS=class{constructor(e){this.id=e??Wre()}toString(){return this.id}static convert(e){return new ZS(e instanceof ZS?e.id:e.toString())}},qre="Unknown error",Zre=class extends Error{constructor(e,t){super(String(e.message||e.error||qre)),this.name="MapboxError",this.statusCode=t}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function YO(e){return Dg(this,null,function*(){if(!e.ok){const t=yield e.json();throw new Zre(t,e.status)}})}var XO=globalThis.fetch,Yre=globalThis.AbortController;function KO(){if(!XO)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:XO,AbortController:Yre}}function Xre(...e){const t=[];for(const o of e){if(!o)continue;const c=Object.entries(o);for(const[d,y]of c)y!=null&&t.push(`${d}=${encodeURIComponent(String(y))}`)}return t.join("&")}var H$="https://api.mapbox.com/search/geocode/v6",Kre=`${H$}/forward`,Jre=`${H$}/reverse`,Qre=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/,eie=/[\s,]+/,zg,_v,YS,tie=class{constructor(e={}){WO(this,_v),WO(this,zg,void 0);const t=e,{accessToken:o}=t,c=Hre(t,["accessToken"]);this.accessToken=o,this.defaults=Mg({},c)}get responseHeaders(){return Gre(this,zg)}forward(e,t){return Dg(this,null,function*(){if(!e)throw new Error("searchText is required");let o;t&&({signal:o}=t);const c=GO(Mg(Mg({},this.defaults),t),{q:e}),d=new URL(`${Kre}`);d.search=ZO(this,_v,YS).call(this,c);const{fetch:y}=KO(),w=o?{signal:o}:{},i=yield y(d.toString(),w);qO(this,zg,i.headers),yield YO(i);const O=yield i.json();return O.url=d.toString(),O})}reverse(e,t){return Dg(this,null,function*(){if(!e)throw new Error("lngLat is required");let o;t&&({signal:o}=t);let c;if(typeof e=="string"){const[z,F]=e.split(",");c=new ia(Number(z),Number(F))}else c=ia.convert(e);const d=GO(Mg(Mg({},this.defaults),t),{longitude:c.lng,latitude:c.lat}),y=new URL(`${Jre}`);y.search=ZO(this,_v,YS).call(this,d,!0);const{fetch:w}=KO(),i=o?{signal:o}:{},O=yield w(y.toString(),i);qO(this,zg,O.headers),yield YO(O);const L=yield O.json();return L.url=y.toString(),L})}suggest(e,t){return Dg(this,null,function*(){if(Qre.test(e)){const c=e.trim().split(eie).map(d=>d.trim()).join(",");return this.reverse(c,t)}else return this.forward(e,t)})}retrieve(e){return Dg(this,null,function*(){return e})}};zg=new WeakMap;_v=new WeakSet;YS=function(e,t=!1){return t&&["proximity","autocomplete","bbox"].forEach(o=>{o in e&&delete e[o]}),Xre({q:e.q,longitude:e.longitude,latitude:e.latitude,access_token:this.accessToken,permanent:e.permanent,language:e.language,country:e.country,limit:e.limit,autocomplete:e.autocomplete,worldview:e.worldview},e.sessionToken&&{session_token:ZS.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:ia.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:Rg.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};function nie(e,t,o){let c=null;return(...d)=>{c!==null&&clearTimeout(c),c=setTimeout(()=>{c=null,e(...d)},t)}}function wc(e){return Array.isArray?Array.isArray(e):q$(e)==="[object Array]"}const rie=1/0;function iie(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-rie?"-0":t}function oie(e){return e==null?"":iie(e)}function Sl(e){return typeof e=="string"}function G$(e){return typeof e=="number"}function aie(e){return e===!0||e===!1||sie(e)&&q$(e)=="[object Boolean]"}function W$(e){return typeof e=="object"}function sie(e){return W$(e)&&e!==null}function $a(e){return e!=null}function $w(e){return!e.trim().length}function q$(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const lie="Incorrect 'index' type",cie=e=>`Invalid value for key ${e}`,uie=e=>`Pattern length exceeds max of ${e}.`,die=e=>`Missing ${e} property in key`,hie=e=>`Property 'weight' in key '${e}' must be a positive integer`,JO=Object.prototype.hasOwnProperty;class fie{constructor(t){this._keys=[],this._keyMap={};let o=0;t.forEach(c=>{let d=Z$(c);this._keys.push(d),this._keyMap[d.id]=d,o+=d.weight}),this._keys.forEach(c=>{c.weight/=o})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Z$(e){let t=null,o=null,c=null,d=1,y=null;if(Sl(e)||wc(e))c=e,t=QO(e),o=XS(e);else{if(!JO.call(e,"name"))throw new Error(die("name"));const w=e.name;if(c=w,JO.call(e,"weight")&&(d=e.weight,d<=0))throw new Error(hie(w));t=QO(w),o=XS(w),y=e.getFn}return{path:t,id:o,weight:d,src:c,getFn:y}}function QO(e){return wc(e)?e:e.split(".")}function XS(e){return wc(e)?e.join("."):e}function pie(e,t){let o=[],c=!1;const d=(y,w,i)=>{if($a(y))if(!w[i])o.push(y);else{let O=w[i];const L=y[O];if(!$a(L))return;if(i===w.length-1&&(Sl(L)||G$(L)||aie(L)))o.push(oie(L));else if(wc(L)){c=!0;for(let z=0,F=L.length;z<F;z+=1)d(L[z],w,i+1)}else w.length&&d(L,w,i+1)}};return d(e,Sl(t)?t.split("."):t,0),c?o:o[0]}const mie={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},gie={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},_ie={location:0,threshold:.6,distance:100},yie={useExtendedSearch:!1,getFn:pie,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var cr={...gie,...mie,..._ie,...yie};const vie=/[^ ]+/g;function xie(e=1,t=3){const o=new Map,c=Math.pow(10,t);return{get(d){const y=d.match(vie).length;if(o.has(y))return o.get(y);const w=1/Math.pow(y,.5*e),i=parseFloat(Math.round(w*c)/c);return o.set(y,i),i},clear(){o.clear()}}}class dT{constructor({getFn:t=cr.getFn,fieldNormWeight:o=cr.fieldNormWeight}={}){this.norm=xie(o,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((o,c)=>{this._keysMap[o.id]=c})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Sl(this.docs[0])?this.docs.forEach((t,o)=>{this._addString(t,o)}):this.docs.forEach((t,o)=>{this._addObject(t,o)}),this.norm.clear())}add(t){const o=this.size();Sl(t)?this._addString(t,o):this._addObject(t,o)}removeAt(t){this.records.splice(t,1);for(let o=t,c=this.size();o<c;o+=1)this.records[o].i-=1}getValueForItemAtKeyId(t,o){return t[this._keysMap[o]]}size(){return this.records.length}_addString(t,o){if(!$a(t)||$w(t))return;let c={v:t,i:o,n:this.norm.get(t)};this.records.push(c)}_addObject(t,o){let c={i:o,$:{}};this.keys.forEach((d,y)=>{let w=d.getFn?d.getFn(t):this.getFn(t,d.path);if($a(w)){if(wc(w)){let i=[];const O=[{nestedArrIndex:-1,value:w}];for(;O.length;){const{nestedArrIndex:L,value:z}=O.pop();if($a(z))if(Sl(z)&&!$w(z)){let F={v:z,i:L,n:this.norm.get(z)};i.push(F)}else wc(z)&&z.forEach((F,N)=>{O.push({nestedArrIndex:N,value:F})})}c.$[y]=i}else if(Sl(w)&&!$w(w)){let i={v:w,n:this.norm.get(w)};c.$[y]=i}}}),this.records.push(c)}toJSON(){return{keys:this.keys,records:this.records}}}function Y$(e,t,{getFn:o=cr.getFn,fieldNormWeight:c=cr.fieldNormWeight}={}){const d=new dT({getFn:o,fieldNormWeight:c});return d.setKeys(e.map(Z$)),d.setSources(t),d.create(),d}function bie(e,{getFn:t=cr.getFn,fieldNormWeight:o=cr.fieldNormWeight}={}){const{keys:c,records:d}=e,y=new dT({getFn:t,fieldNormWeight:o});return y.setKeys(c),y.setIndexRecords(d),y}function jy(e,{errors:t=0,currentLocation:o=0,expectedLocation:c=0,distance:d=cr.distance,ignoreLocation:y=cr.ignoreLocation}={}){const w=t/e.length;if(y)return w;const i=Math.abs(c-o);return d?w+i/d:i?1:w}function wie(e=[],t=cr.minMatchCharLength){let o=[],c=-1,d=-1,y=0;for(let w=e.length;y<w;y+=1){let i=e[y];i&&c===-1?c=y:!i&&c!==-1&&(d=y-1,d-c+1>=t&&o.push([c,d]),c=-1)}return e[y-1]&&y-c>=t&&o.push([c,y-1]),o}const Jd=32;function Sie(e,t,o,{location:c=cr.location,distance:d=cr.distance,threshold:y=cr.threshold,findAllMatches:w=cr.findAllMatches,minMatchCharLength:i=cr.minMatchCharLength,includeMatches:O=cr.includeMatches,ignoreLocation:L=cr.ignoreLocation}={}){if(t.length>Jd)throw new Error(uie(Jd));const z=t.length,F=e.length,N=Math.max(0,Math.min(c,F));let G=y,Y=N;const K=i>1||O,J=K?Array(F):[];let X;for(;(X=e.indexOf(t,Y))>-1;){let ee=jy(t,{currentLocation:X,expectedLocation:N,distance:d,ignoreLocation:L});if(G=Math.min(ee,G),Y=X+z,K){let be=0;for(;be<z;)J[X+be]=1,be+=1}}Y=-1;let se=[],te=1,ne=z+F;const ue=1<<z-1;for(let ee=0;ee<z;ee+=1){let be=0,Ie=ne;for(;be<Ie;)jy(t,{errors:ee,currentLocation:N+Ie,expectedLocation:N,distance:d,ignoreLocation:L})<=G?be=Ie:ne=Ie,Ie=Math.floor((ne-be)/2+be);ne=Ie;let Ee=Math.max(1,N-Ie+1),Re=w?F:Math.min(N+Ie,F)+z,Qe=Array(Re+2);Qe[Re+1]=(1<<ee)-1;for(let We=Re;We>=Ee;We-=1){let me=We-1,Oe=o[e.charAt(me)];if(K&&(J[me]=+!!Oe),Qe[We]=(Qe[We+1]<<1|1)&Oe,ee&&(Qe[We]|=(se[We+1]|se[We])<<1|1|se[We+1]),Qe[We]&ue&&(te=jy(t,{errors:ee,currentLocation:me,expectedLocation:N,distance:d,ignoreLocation:L}),te<=G)){if(G=te,Y=me,Y<=N)break;Ee=Math.max(1,2*N-Y)}}if(jy(t,{errors:ee+1,currentLocation:N,expectedLocation:N,distance:d,ignoreLocation:L})>G)break;se=Qe}const ge={isMatch:Y>=0,score:Math.max(.001,te)};if(K){const ee=wie(J,i);ee.length?O&&(ge.indices=ee):ge.isMatch=!1}return ge}function Cie(e){let t={};for(let o=0,c=e.length;o<c;o+=1){const d=e.charAt(o);t[d]=(t[d]||0)|1<<c-o-1}return t}const qv=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class X${constructor(t,{location:o=cr.location,threshold:c=cr.threshold,distance:d=cr.distance,includeMatches:y=cr.includeMatches,findAllMatches:w=cr.findAllMatches,minMatchCharLength:i=cr.minMatchCharLength,isCaseSensitive:O=cr.isCaseSensitive,ignoreDiacritics:L=cr.ignoreDiacritics,ignoreLocation:z=cr.ignoreLocation}={}){if(this.options={location:o,threshold:c,distance:d,includeMatches:y,findAllMatches:w,minMatchCharLength:i,isCaseSensitive:O,ignoreDiacritics:L,ignoreLocation:z},t=O?t:t.toLowerCase(),t=L?qv(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const F=(G,Y)=>{this.chunks.push({pattern:G,alphabet:Cie(G),startIndex:Y})},N=this.pattern.length;if(N>Jd){let G=0;const Y=N%Jd,K=N-Y;for(;G<K;)F(this.pattern.substr(G,Jd),G),G+=Jd;if(Y){const J=N-Jd;F(this.pattern.substr(J),J)}}else F(this.pattern,0)}searchIn(t){const{isCaseSensitive:o,ignoreDiacritics:c,includeMatches:d}=this.options;if(t=o?t:t.toLowerCase(),t=c?qv(t):t,this.pattern===t){let K={isMatch:!0,score:0};return d&&(K.indices=[[0,t.length-1]]),K}const{location:y,distance:w,threshold:i,findAllMatches:O,minMatchCharLength:L,ignoreLocation:z}=this.options;let F=[],N=0,G=!1;this.chunks.forEach(({pattern:K,alphabet:J,startIndex:X})=>{const{isMatch:se,score:te,indices:ne}=Sie(t,K,J,{location:y+X,distance:w,threshold:i,findAllMatches:O,minMatchCharLength:L,includeMatches:d,ignoreLocation:z});se&&(G=!0),N+=te,se&&ne&&(F=[...F,...ne])});let Y={isMatch:G,score:G?N/this.chunks.length:1};return G&&d&&(Y.indices=F),Y}}class Fu{constructor(t){this.pattern=t}static isMultiMatch(t){return eD(t,this.multiRegex)}static isSingleMatch(t){return eD(t,this.singleRegex)}search(){}}function eD(e,t){const o=e.match(t);return o?o[1]:null}class Tie extends Fu{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const o=t===this.pattern;return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}class Eie extends Fu{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const c=t.indexOf(this.pattern)===-1;return{isMatch:c,score:c?0:1,indices:[0,t.length-1]}}}class Mie extends Fu{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const o=t.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}class Iie extends Fu{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const o=!t.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,t.length-1]}}}class Aie extends Fu{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const o=t.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Pie extends Fu{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const o=!t.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,t.length-1]}}}class K$ extends Fu{constructor(t,{location:o=cr.location,threshold:c=cr.threshold,distance:d=cr.distance,includeMatches:y=cr.includeMatches,findAllMatches:w=cr.findAllMatches,minMatchCharLength:i=cr.minMatchCharLength,isCaseSensitive:O=cr.isCaseSensitive,ignoreDiacritics:L=cr.ignoreDiacritics,ignoreLocation:z=cr.ignoreLocation}={}){super(t),this._bitapSearch=new X$(t,{location:o,threshold:c,distance:d,includeMatches:y,findAllMatches:w,minMatchCharLength:i,isCaseSensitive:O,ignoreDiacritics:L,ignoreLocation:z})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class J$ extends Fu{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let o=0,c;const d=[],y=this.pattern.length;for(;(c=t.indexOf(this.pattern,o))>-1;)o=c+y,d.push([c,o-1]);const w=!!d.length;return{isMatch:w,score:w?0:1,indices:d}}}const KS=[Tie,J$,Mie,Iie,Pie,Aie,Eie,K$],tD=KS.length,Oie=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Die="|";function Rie(e,t={}){return e.split(Die).map(o=>{let c=o.trim().split(Oie).filter(y=>y&&!!y.trim()),d=[];for(let y=0,w=c.length;y<w;y+=1){const i=c[y];let O=!1,L=-1;for(;!O&&++L<tD;){const z=KS[L];let F=z.isMultiMatch(i);F&&(d.push(new z(F,t)),O=!0)}if(!O)for(L=-1;++L<tD;){const z=KS[L];let F=z.isSingleMatch(i);if(F){d.push(new z(F,t));break}}}return d})}const zie=new Set([K$.type,J$.type]);class Lie{constructor(t,{isCaseSensitive:o=cr.isCaseSensitive,ignoreDiacritics:c=cr.ignoreDiacritics,includeMatches:d=cr.includeMatches,minMatchCharLength:y=cr.minMatchCharLength,ignoreLocation:w=cr.ignoreLocation,findAllMatches:i=cr.findAllMatches,location:O=cr.location,threshold:L=cr.threshold,distance:z=cr.distance}={}){this.query=null,this.options={isCaseSensitive:o,ignoreDiacritics:c,includeMatches:d,minMatchCharLength:y,findAllMatches:i,ignoreLocation:w,location:O,threshold:L,distance:z},t=o?t:t.toLowerCase(),t=c?qv(t):t,this.pattern=t,this.query=Rie(this.pattern,this.options)}static condition(t,o){return o.useExtendedSearch}searchIn(t){const o=this.query;if(!o)return{isMatch:!1,score:1};const{includeMatches:c,isCaseSensitive:d,ignoreDiacritics:y}=this.options;t=d?t:t.toLowerCase(),t=y?qv(t):t;let w=0,i=[],O=0;for(let L=0,z=o.length;L<z;L+=1){const F=o[L];i.length=0,w=0;for(let N=0,G=F.length;N<G;N+=1){const Y=F[N],{isMatch:K,indices:J,score:X}=Y.search(t);if(K){if(w+=1,O+=X,c){const se=Y.constructor.type;zie.has(se)?i=[...i,...J]:i.push(J)}}else{O=0,w=0,i.length=0;break}}if(w){let N={isMatch:!0,score:O/w};return c&&(N.indices=i),N}}return{isMatch:!1,score:1}}}const JS=[];function $ie(...e){JS.push(...e)}function QS(e,t){for(let o=0,c=JS.length;o<c;o+=1){let d=JS[o];if(d.condition(e,t))return new d(e,t)}return new X$(e,t)}const Zv={AND:"$and",OR:"$or"},e2={PATH:"$path",PATTERN:"$val"},t2=e=>!!(e[Zv.AND]||e[Zv.OR]),Fie=e=>!!e[e2.PATH],Bie=e=>!wc(e)&&W$(e)&&!t2(e),nD=e=>({[Zv.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function Q$(e,t,{auto:o=!0}={}){const c=d=>{let y=Object.keys(d);const w=Fie(d);if(!w&&y.length>1&&!t2(d))return c(nD(d));if(Bie(d)){const O=w?d[e2.PATH]:y[0],L=w?d[e2.PATTERN]:d[O];if(!Sl(L))throw new Error(cie(O));const z={keyId:XS(O),pattern:L};return o&&(z.searcher=QS(L,t)),z}let i={children:[],operator:y[0]};return y.forEach(O=>{const L=d[O];wc(L)&&L.forEach(z=>{i.children.push(c(z))})}),i};return t2(e)||(e=nD(e)),c(e)}function kie(e,{ignoreFieldNorm:t=cr.ignoreFieldNorm}){e.forEach(o=>{let c=1;o.matches.forEach(({key:d,norm:y,score:w})=>{const i=d?d.weight:null;c*=Math.pow(w===0&&i?Number.EPSILON:w,(i||1)*(t?1:y))}),o.score=c})}function Nie(e,t){const o=e.matches;t.matches=[],$a(o)&&o.forEach(c=>{if(!$a(c.indices)||!c.indices.length)return;const{indices:d,value:y}=c;let w={indices:d,value:y};c.key&&(w.key=c.key.src),c.idx>-1&&(w.refIndex=c.idx),t.matches.push(w)})}function Vie(e,t){t.score=e.score}function jie(e,t,{includeMatches:o=cr.includeMatches,includeScore:c=cr.includeScore}={}){const d=[];return o&&d.push(Nie),c&&d.push(Vie),e.map(y=>{const{idx:w}=y,i={item:t[w],refIndex:w};return d.length&&d.forEach(O=>{O(y,i)}),i})}class vp{constructor(t,o={},c){this.options={...cr,...o},this.options.useExtendedSearch,this._keyStore=new fie(this.options.keys),this.setCollection(t,c)}setCollection(t,o){if(this._docs=t,o&&!(o instanceof dT))throw new Error(lie);this._myIndex=o||Y$(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){$a(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const o=[];for(let c=0,d=this._docs.length;c<d;c+=1){const y=this._docs[c];t(y,c)&&(this.removeAt(c),c-=1,d-=1,o.push(y))}return o}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:o=-1}={}){const{includeMatches:c,includeScore:d,shouldSort:y,sortFn:w,ignoreFieldNorm:i}=this.options;let O=Sl(t)?Sl(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return kie(O,{ignoreFieldNorm:i}),y&&O.sort(w),G$(o)&&o>-1&&(O=O.slice(0,o)),jie(O,this._docs,{includeMatches:c,includeScore:d})}_searchStringList(t){const o=QS(t,this.options),{records:c}=this._myIndex,d=[];return c.forEach(({v:y,i:w,n:i})=>{if(!$a(y))return;const{isMatch:O,score:L,indices:z}=o.searchIn(y);O&&d.push({item:y,idx:w,matches:[{score:L,value:y,norm:i,indices:z}]})}),d}_searchLogical(t){const o=Q$(t,this.options),c=(i,O,L)=>{if(!i.children){const{keyId:F,searcher:N}=i,G=this._findMatches({key:this._keyStore.get(F),value:this._myIndex.getValueForItemAtKeyId(O,F),searcher:N});return G&&G.length?[{idx:L,item:O,matches:G}]:[]}const z=[];for(let F=0,N=i.children.length;F<N;F+=1){const G=i.children[F],Y=c(G,O,L);if(Y.length)z.push(...Y);else if(i.operator===Zv.AND)return[]}return z},d=this._myIndex.records,y={},w=[];return d.forEach(({$:i,i:O})=>{if($a(i)){let L=c(o,i,O);L.length&&(y[O]||(y[O]={idx:O,item:i,matches:[]},w.push(y[O])),L.forEach(({matches:z})=>{y[O].matches.push(...z)}))}}),w}_searchObjectList(t){const o=QS(t,this.options),{keys:c,records:d}=this._myIndex,y=[];return d.forEach(({$:w,i})=>{if(!$a(w))return;let O=[];c.forEach((L,z)=>{O.push(...this._findMatches({key:L,value:w[z],searcher:o}))}),O.length&&y.push({idx:i,item:w,matches:O})}),y}_findMatches({key:t,value:o,searcher:c}){if(!$a(o))return[];let d=[];if(wc(o))o.forEach(({v:y,i:w,n:i})=>{if(!$a(y))return;const{isMatch:O,score:L,indices:z}=c.searchIn(y);O&&d.push({score:L,key:t,value:y,idx:w,norm:i,indices:z})});else{const{v:y,n:w}=o,{isMatch:i,score:O,indices:L}=c.searchIn(y);i&&d.push({score:O,key:t,value:y,norm:w,indices:L})}return d}}vp.version="7.1.0";vp.createIndex=Y$;vp.parseIndex=bie;vp.config=cr;vp.parseQuery=Q$;$ie(Lie);const Uie={class:"er-flex er-items-center er-space-x-4"},Hie={key:0},Gie={key:1,class:"er-flex er-items-center"},Wie={class:"er-flex er-flex-col er-text-left er-ml-4 er-overflow-hidden"},qie={class:"text-size14 er-font-bold"},Zie={key:2,class:"er-flex er-items-center"},Yie={class:"er-flex er-flex-col er-text-left er-ml-4 er-overflow-hidden"},Xie={class:"text-size14 er-font-bold"},Kie={key:3,class:"er-text-center er-pb-6"},Jie={class:"er-text-2xl"},Qie={class:"er-text-xl"},eoe={class:"er-flex er-pb-4 er-flex-col"},toe={class:"er-flex"},noe={key:0,class:"er-flex er-mt-4 er-gap-y-2 er-flex-wrap"},roe=["src"],ioe={class:"text-size14"},ooe={__name:"Search",props:{map:Object,formState:Object},setup(e){const t=e,o=new tie({accessToken:jr.ACCESS_TOEKN,country:"US",language:"en",limit:5}),c=tn(null),d=tn("default"),y=He(()=>{const J=[];for(const X of t.formState.service)J.push({key:X,name:jr.SERVICES[X].name});for(const X of t.formState.ebikes)J.push({key:X,name:jr.E_BIKES[X].name});return J}),w=tn([]),i=async()=>{c.value.$el.querySelector(".ant-collapse-header").click(),d.value=d.value==="primary"?"default":"primary"};function O(J){return`${J} miles`}async function L(J=""){const X={value:"Location",options:[{value:0,label:"No Result",disabled:!0}]};if(!J)return X;try{const se=await o.forward(J);if(se.features.length){X.options.shift();for(const te of se.features)X.options.push({type:X.value,title:te.properties.full_address,key:te.properties.mapbox_id,label:te.properties.full_address,value:te.properties.full_address,full_address:te.properties.full_address,name_preferred:te.properties.name_preferred,center:[te.properties.coordinates.longitude,te.properties.coordinates.latitude]})}console.log(se)}catch(se){console.log("error",se)}return X}async function z(J=""){const X={value:"Store",options:[{value:1,label:"No Result",disabled:!0}]};if(!J)return X;const te=new vp(t.formState.storeList.filter(ne=>ne.show),{keys:["name"]}).search(J,{limit:5});if(te.length){X.options.shift();for(const ne of te)X.options.push({type:X.value,title:ne.item.address,key:ne.item.id,label:ne.item.address,value:ne.item.address,address:ne.item.address,name:ne.item.name,center:ne.item.location})}return X}const F=()=>{console.log(""),t.formState.service=[],t.formState.ebikes=[]},N=J=>{t.formState.service=t.formState.service.filter(X=>X!==J.key),t.formState.ebikes=t.formState.ebikes.filter(X=>X!==J.key)},G=nie(async J=>{w.value=[await z(J),await L(J)]},300);function Y(J,X){console.log(J,X),t.formState.center=X.center,x_(t.map,X.center)}const K=J=>(console.log(J),t.formState.center=jr.DEFAULT_CENTER,t.formState.miles=jr.DEFAULT_RADIUS,x_(t.map,jr.DEFAULT_CENTER),J.stopPropagation(),!1);return(J,X)=>{const se=yne,te=yo,ne=rX,ue=ps,ge=Pre,ee=Xg,be=ep,Ie=rte,Ee=fre,Re=Hv,Qe=Uv,et=Zg;return lr(),$r(hr,null,[X[11]||(X[11]=gn("div",{class:"text-size20 er-font-bold"},"Find a Dealer",-1)),gn("div",Uie,[le(ne,{value:e.formState.search,"onUpdate:value":X[0]||(X[0]=We=>e.formState.search=We),listHeight:600,options:w.value,onSelect:Y,onSearch:Ar(G),class:"er-w-full",allowClear:!1,clearIcon:null},{option:yr(We=>[We.value==="Location"||We.value==="Store"?(lr(),$r("span",Hie,Gr(We.value),1)):We.type==="Location"?(lr(),$r("div",Gie,[X[4]||(X[4]=gn("svg",{xmlns:"http://www.w3.org/2000/svg",class:"er-min-w-10",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#444"},[gn("path",{d:"M480-200Q339-304 269.5-402T200-594q0-125 78-205.5T480-880q124 0 202 80.5T760-594q0 94-69.5 192T480-200Zm0-320q33 0 56.5-23.5T560-600q0-33-23.5-56.5T480-680q-33 0-56.5 23.5T400-600q0 33 23.5 56.5T480-520ZM200-80v-80h560v80H200Z"})],-1)),gn("div",Wie,[gn("span",qie,Gr(We.name_preferred),1),gn("span",null,Gr(We.full_address.slice(We.full_address.indexOf(",")+1).trim()),1)])])):We.type==="Store"?(lr(),$r("div",Zie,[X[5]||(X[5]=gn("svg",{xmlns:"http://www.w3.org/2000/svg",class:"er-min-w-10",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#444"},[gn("path",{d:"M160-720v-80h640v80H160Zm0 560v-240h-40v-80l40-200h640l40 200v80h-40v240h-80v-240H560v240H160Zm80-80h240v-160H240v160Z"})],-1)),gn("div",Yie,[gn("span",Xie,Gr(We.name),1),gn("span",null,Gr(We.address),1)])])):(lr(),$r("div",Kie,Gr(We.label),1))]),default:yr(()=>[le(te,{placeholder:"Search by Your location Or Store name",clearIcon:null,allowClear:!1,class:"er-font-bold"},{suffix:yr(()=>[gn("div",null,[le(se,{type:"vertical"})])]),_:1})]),_:1},8,["value","options","onSearch"]),le(ue,{type:"primary",danger:"",class:"!er-px-4",onClick:mc(K,["stop","prevent"]),title:"Recharge Location"},{default:yr(()=>X[6]||(X[6]=[gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fff"},[gn("path",{d:"M516-120 402-402 120-516v-56l720-268-268 720h-56Z"})],-1)])),_:1})]),gn("div",null,[gn("div",Jie,[X[7]||(X[7]=gn("b",null,"Radius: ",-1)),gn("span",Qie,Gr(e.formState.miles)+" miles",1)]),le(ge,{value:e.formState.miles,"onUpdate:value":X[1]||(X[1]=We=>e.formState.miles=We),min:5,max:50,step:1,"tip-formatter":O},null,8,["value"])]),gn("div",eoe,[gn("div",toe,[le(ue,{shape:"round",type:d.value,onClick:i},{default:yr(()=>[X[8]||(X[8]=Fi(" Filters ")),le(Ar(lT))]),_:1},8,["type"]),X[10]||(X[10]=gn("span",{class:"er-flex-1"},null,-1)),le(ue,{type:"link",class:"er-underline",onClick:F},{default:yr(()=>X[9]||(X[9]=[Fi("Reset All")])),_:1})]),y.value.length?(lr(),$r("div",noe,[(lr(!0),$r(hr,null,Hs(y.value,We=>(lr(),Vs(ee,{key:We.key,bordered:!1,onClose:mc(me=>N(We),["prevent"]),closable:""},{default:yr(()=>[Fi(Gr(We.name),1)]),_:2},1032,["onClose"]))),128))])):Lo("",!0)]),le(et,{ghost:"",expandIcon:null,accordion:""},{default:yr(()=>[le(Qe,{showArrow:!1,header:null,ref_key:"collapsePanelRef",ref:c},{default:yr(()=>[le(Re,{value:e.formState.service,"onUpdate:value":X[2]||(X[2]=We=>e.formState.service=We)},{default:yr(()=>[le(Ee,{gutter:[0,12]},{default:yr(()=>[(lr(!0),$r(hr,null,Hs(Ar(jr).SERVICES,(We,me)=>(lr(),Vs(Ie,{span:12,key:me},{default:yr(()=>[le(be,{value:Number(me)},{default:yr(()=>[gn("img",{width:"24",height:"24",src:We.icon,alt:"",class:"er-align-bottom er-mr-3"},null,8,roe),gn("span",ioe,Gr(We.name),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"]),le(se),le(Re,{value:e.formState.ebikes,"onUpdate:value":X[3]||(X[3]=We=>e.formState.ebikes=We)},{default:yr(()=>[le(Ee,{gutter:[0,12]},{default:yr(()=>[(lr(!0),$r(hr,null,Hs(Ar(jr).E_BIKES,(We,me)=>(lr(),Vs(Ie,{span:12,key:me},{default:yr(()=>[le(be,{value:Number(me)},{default:yr(()=>[Fi(Gr(We.name),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),_:1},512)]),_:1})],64)}}};typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const rD=()=>{};function aoe(e,t){function o(...c){return new Promise((d,y)=>{Promise.resolve(e(()=>t.apply(this,c),{fn:t,thisArg:this,args:c})).then(d).catch(y)})}return o}const soe=e=>e();function loe(e,t={}){let o,c,d=rD;const y=O=>{clearTimeout(O),d(),d=rD};let w;return O=>{const L=kI(e),z=kI(t.maxWait);return o&&y(o),L<=0||z!==void 0&&z<=0?(c&&(y(c),c=null),Promise.resolve(O())):new Promise((F,N)=>{d=t.rejectOnCancel?N:F,w=O,z&&!c&&(c=setTimeout(()=>{o&&y(o),c=null,F(w())},z)),o=setTimeout(()=>{c&&y(c),c=null,F(O())},L)})}}function coe(e,t,o={}){const{eventFilter:c=soe,...d}=o;return On(e,aoe(c,t),d)}function Lg(e,t,o={}){const{debounce:c=0,maxWait:d=void 0,...y}=o;return coe(e,t,{...y,eventFilter:loe(c,{maxWait:d})})}const uoe={class:"er-relative"},doe={class:"er-py-8"},hoe={class:"er-grid er-grid-cols-2 er-gap-6"},foe=["onClick"],poe=["src","alt"],moe={class:"text-size14 er-font-medium er-my-2"},goe={class:"er-py-8"},_oe={class:"er-flex er-items-center er-justify-between er-mb-6"},yoe={class:"text-size14 er-font-medium"},voe={class:"er-text-primary"},xoe={class:"text-size14 er-font-medium er-my-6"},boe={class:"er-text-primary"},woe={class:"er-grid er-grid-cols-5 er-gap-3"},Soe=["onClick"],Coe={class:"er-py-8"},Toe={class:"er-py-8 er-space-y-8"},Eoe={class:"er-flex er-flex-col er-items-center er-justify-center"},Moe=["src"],Ioe={class:"text-size16 er-font-bold er-my-4"},Aoe=["href"],Poe={class:"er-flex er-justify-end er-space-x-4 er-w-full"},Ooe={__name:"BookNow",props:{store:Object,close:Function,modal:Object},setup(e){const t=["Step 1/3: Choose E-bike Model","Step 2/3: Select Date and Time","Step 3/3: Submit","Thank You!"],o={username:[{require:!0}],phone:[{require:!0,max:20,pattern:/\d+/,message:"Please enter your phone number correctly"}],email:[{require:!0,type:"email"}]},c=e,d=tn(!1),y=tn([]),w=tn(1),i=tn(null);function O(se,te=ai()){const ne=ai();te.isBefore(ne,"day")&&(te=ne);let ue=te.day();for(let ge=0;ge<7;ge++){const ee=(ue+ge)%7;if(se[ee])return te.add(ge,"day").format("YYYY-MM-DD")}return te.format("YYYY-MM-DD")}function L(se=ai()){console.log(c.store);const te=ai(se),ne=c.store.businessHours[te.day()];console.log(ne);let[ue,ge]=ne.split("-");ue=Number(ue.split(":").shift()),ge=Number(ge.split(":").shift());const ee=[];for(let be=ue;be<ge;be++)ee.push(te.hour(be).format("HH:mm"));return y.value=ee,te.hour(ue).format("HH:mm")}const z=tn({ebike:c.store.availableSizes[0],date:O(c.store.businessHours),time:L(O(c.store.businessHours)),username:"",phone:"",email:""}),F=()=>{w.value--},N=()=>{w.value++};Qr(()=>{si(()=>{c.modal.update({title:t[w.value-1]})})});const G=se=>{z.value.ebike=se},Y=se=>se.isBefore(ai(),"day")||se.isAfter(ai().add(2,"month"))||!c.store.businessHours[se.day()],K=se=>{z.value.time=L(se)},J=se=>{z.value.time=se},X=async()=>{console.log("submit");try{const se=await i.value.validate();d.value=!0,console.log(se)}catch(se){console.log("invalired",se)}finally{d.value=!1,w.value++}};return On(()=>w.value,se=>{c.modal.update({title:t[se-1]})}),(se,te)=>{const ne=eX,ue=_a,ge=yQ,ee=yo,be=H4,Ie=yu,Ee=_$,Re=jf,Qe=ps;return lr(),$r("div",uoe,[(lr(),$r("svg",{onClick:te[0]||(te[0]=(...et)=>e.close&&e.close(...et)),xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#222"},te[5]||(te[5]=[gn("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"},null,-1)]))),Ns(gn("div",doe,[gn("div",hoe,[(lr(!0),$r(hr,null,Hs(e.store.availableSizes,et=>(lr(),$r("div",{onClick:We=>G(et),class:np(["er-transition er-border er-border-solid er-rounded-3xl er-w-full er-border-border er-p-4 er-flex er-items-center er-flex-col er-cursor-pointer er-relative",z.value.ebike===et?"er-bg-primary/75 er-text-white":""]),key:et},[te[6]||(te[6]=gn("svg",{class:"er-absolute er-right-2 er-top-2",xmlns:"http://www.w3.org/2000/svg",height:"30px",viewBox:"0 -960 960 960",width:"30px",fill:"#fff"},[gn("path",{d:"M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z"})],-1)),gn("img",{class:"er-object-cover er-aspect-[16/10]",src:`${Ar(jr).E_BIKES[et].img}&width=300`,alt:Ar(jr).E_BIKES[et].name},null,8,poe),gn("span",moe,Gr(Ar(jr).E_BIKES[et].name),1)],10,foe))),128))])],512),[[bl,w.value===1]]),Ns(gn("div",goe,[le(ge,{mode:"month",onChange:K,fullscreen:!1,disabledDate:Y,value:z.value.date,"onUpdate:value":te[1]||(te[1]=et=>z.value.date=et),valueFormat:"YYYY-MM-DD"},{headerRender:yr(({value:et,onChange:We})=>[gn("div",_oe,[gn("span",yoe,[te[7]||(te[7]=Fi("Selected Date: ")),gn("span",voe,Gr(z.value.date),1)]),le(ue,{class:"er-w-5/12",value:et.format("YYYY-MM"),onChange:me=>{console.log(),We(Ar(ai)(O(e.store.businessHours,Ar(ai)(me))))}},{default:yr(()=>[(lr(),$r(hr,null,Hs(3,me=>le(ne,{key:me,value:Ar(ai)().add(me-1,"month").format("YYYY-MM")},{default:yr(()=>[Fi(Gr(Ar(ai)().add(me-1,"month").format("YYYY-MM")),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onChange"])])]),_:1},8,["value"]),gn("div",xoe,[te[8]||(te[8]=Fi("Selected Time: ")),gn("span",boe,Gr(z.value.time),1)]),gn("div",woe,[(lr(!0),$r(hr,null,Hs(y.value,et=>(lr(),$r("div",{onClick:We=>J(et),key:et,class:np([z.value.time===et?"er-bg-primary/75 er-text-white":"","text-size12 er-font-medium er-transition er-border er-border-solid er-rounded-lg er-w-full er-border-border er-p-4 er-flex er-items-center er-flex-col er-cursor-pointer er-relative"])},Gr(et),11,Soe))),128))])],512),[[bl,w.value===2]]),Ns(gn("div",Coe,[le(Ie,{layout:"vertical",model:z.value,ref_key:"formsRef",ref:i,rules:o},{default:yr(()=>[le(be,{label:"Your Name:",name:"username",required:""},{default:yr(()=>[le(ee,{type:"text",value:z.value.username,"onUpdate:value":te[2]||(te[2]=et=>z.value.username=et),placeholder:"Pleace Enter..."},null,8,["value"])]),_:1}),le(be,{label:"Phone Number:",name:"phone",required:""},{default:yr(()=>[le(ee,{type:"tel",value:z.value.phone,"onUpdate:value":te[3]||(te[3]=et=>z.value.phone=et),placeholder:"Pleace Enter..."},null,8,["value"])]),_:1}),le(be,{label:"Email@:",name:"email",required:""},{default:yr(()=>[le(ee,{type:"email",value:z.value.email,"onUpdate:value":te[4]||(te[4]=et=>z.value.email=et),placeholder:"Pleace Enter..."},null,8,["value"])]),_:1})]),_:1},8,["model"])],512),[[bl,w.value===3]]),Ns(gn("div",Toe,[le(Re,{column:1,size:"small",bordered:""},{default:yr(()=>[le(Ee,{label:"E-Bike"},{default:yr(()=>[gn("div",Eoe,[gn("img",{width:"150",style:{"max-width":"150px"},src:`${Ar(jr).E_BIKES[z.value.ebike].img}&width=200`,alt:""},null,8,Moe),gn("span",Ioe,Gr(Ar(jr).E_BIKES[z.value.ebike].name),1)])]),_:1}),le(Ee,{label:"DateTime"},{default:yr(()=>[Fi(Gr(z.value.date)+" "+Gr(z.value.time),1)]),_:1}),le(Ee,{label:"Your Name"},{default:yr(()=>[Fi(Gr(z.value.username),1)]),_:1}),le(Ee,{label:"Phone"},{default:yr(()=>[Fi(Gr(z.value.phone),1)]),_:1}),le(Ee,{label:"Email"},{default:yr(()=>[Fi(Gr(z.value.email),1)]),_:1})]),_:1}),le(Re,{column:1,size:"small",bordered:""},{title:yr(()=>te[9]||(te[9]=[gn("div",{class:"text-size14 er-font-medium"},"Store Info:",-1)])),default:yr(()=>[le(Ee,{label:"Store Name"},{default:yr(()=>[Fi(Gr(e.store.name),1)]),_:1}),le(Ee,{label:"Store Address"},{default:yr(()=>[gn("a",{class:"!er-text-primary",href:`https://www.google.com/maps?q=${e.store.location.map(et=>et.toFixed(4)).reverse().toString()}`,target:"_blank",rel:"noopener noreferrer"},Gr(e.store.address),9,Aoe)]),_:1})]),_:1})],512),[[bl,w.value===4]]),gn("div",Poe,[w.value>1&&w.value<=3?(lr(),Vs(Qe,{key:0,onClick:F,disabled:d.value},{default:yr(()=>te[10]||(te[10]=[Fi("Prev")])),_:1},8,["disabled"])):Lo("",!0),w.value<3?(lr(),Vs(Qe,{key:1,class:"!er-flex er-items-center er-text-center er-justify-center next",type:"primary",danger:"",onClick:N,disabled:d.value},{default:yr(()=>te[11]||(te[11]=[gn("span",null,"Next",-1),gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fff"},[gn("path",{d:"m560-240-56-58 142-142H160v-80h486L504-662l56-58 240 240-240 240Z"})],-1)])),_:1},8,["disabled"])):Lo("",!0),w.value===3?(lr(),Vs(Qe,{key:2,type:"primary",danger:"",onClick:X,loading:d.value},{default:yr(()=>te[12]||(te[12]=[Fi("Submit")])),_:1},8,["loading"])):Lo("",!0),w.value===4?(lr(),Vs(Qe,{key:3,type:"primary",onClick:e.close,danger:""},{default:yr(()=>te[13]||(te[13]=[Fi("Done")])),_:1},8,["onClick"])):Lo("",!0)])])}}};console.log(va);function eF(e){return new Promise(t=>{const o=d=>{console.log(d),c.destroy()},c=va.info();c.update({content:le(Ooe,{store:e,close:o,modal:c}),icon:null,footer:null,wrapClassName:"modal",title:"Book a Test Ride",maskClosable:!0,centered:!0})})}class Doe{constructor(){this.events=new Map}on(t,o){this.events.has(t)||this.events.set(t,new Set),this.events.get(t).add(o)}off(t,o){this.events.has(t)&&(this.events.get(t).delete(o),this.events.get(t).size===0&&this.events.delete(t))}emit(t,...o){this.events.has(t)&&this.events.get(t).forEach(c=>c(...o))}once(t,o){const c=(...d)=>{o(...d),this.off(t,c)};this.on(t,c)}}const ch=new Doe,tF=(e,t)=>{const o=e.__vccOpts||e;for(const[c,d]of t)o[c]=d;return o},Roe={class:"er-flex-1 er-pb-8 er-flex er-flex-col er-overflow-hidden",style:{margin:"0 -20px"}},zoe={class:"er-flex er-items-center text-size14 er-px-10 er-py-4 er-pb-4 er-shadow-2xl"},Loe={class:"er-text-primary er-pl-2"},$oe=["onClick"],Foe={class:"er-flex er-items-start er-text-dark er-space-x-2"},Boe={class:"text-size16 er-font-bold"},koe={class:"text-size14 er-text-primary er-font-bold er-whitespace-nowrap"},Noe={class:"er-flex er-items-start er-space-x-4"},Voe=["href"],joe=["href"],Uoe=["href"],Hoe={key:0,class:"er-flex er-flex-col"},Goe={class:"er-opacity-80 text-size12 er-py-1 er-space-y-0.5 marker:er-text-transparent er-pl-2"},Woe={key:1,class:"er-flex er-flex-col"},qoe={class:"er-opacity-80 text-size12 er-py-1 er-space-y-0.5 marker:er-text-transparent er-pl-2"},Zoe={__name:"StoreList",props:{map:Object,formState:Object},setup(e){const t=tn(),o=tn(null),c=e;function d(i){ch.emit("hidePopover"),eF(i)}const y=He(()=>(si(()=>{o.value&&(o.value.scrollTop=0)}),c.formState.storeList.filter(O=>O.show).sort((O,L)=>O.distance-L.distance))),w=async i=>{const O=c.map.getBounds(),L=i.location,z=O.contains(L),F=Number(cT(i.location,c.formState.center));t.value=i.id,z||(c.formState.center=i.location,await x_(c.map,i.location)),F>c.formState.miles/2&&(c.formState.center=i.location,await x_(c.map,i.location)),setTimeout(()=>{ch.emit("storeListItemClick",i)})};return(i,O)=>{const L=tv,z=ps;return lr(),$r("div",Roe,[gn("div",zoe,[O[3]||(O[3]=Fi(" Find nearby stores: ")),gn("span",Loe,Gr(e.formState.storeList.filter(F=>F.show).length),1)]),gn("div",{class:"er-flex er-flex-col er-space-y-4 er-overflow-auto mb:er-max-h-screen",ref_key:"listContainer",ref:o},[(lr(!0),$r(hr,null,Hs(y.value,(F,N)=>(lr(),$r(hr,{key:F.id},[F.show?(lr(),$r("div",{key:0,class:np(["er-relative er-flex er-flex-col er-space-y-2 er-cursor-pointer er-pr-4 er-px-8 er-py-4 hover:er-opacity-85",t.value===F.id?"er-bg-[#eee]":"er-bg-white"]),onClick:mc(G=>w(F),["stop"])},[gn("div",Foe,[O[4]||(O[4]=gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#444"},[gn("path",{d:"M160-720v-80h640v80H160Zm0 560v-240h-40v-80l40-200h640l40 200v80h-40v240h-80v-240H560v240H160Zm80-80h240v-160H240v160Z"})],-1)),gn("span",Boe,Gr(F.name),1),O[5]||(O[5]=gn("span",{class:"er-flex-1"},null,-1)),gn("span",koe,Gr(F.distance)+" Miles",1)]),gn("div",Noe,[gn("a",{class:"er-button er-button-text er-whitespace-normal",href:`https://www.google.com/maps?q=${F.location.map(G=>G.toFixed(4)).reverse().toString()}`,target:"_blank",rel:"noopener noreferrer",onClick:O[0]||(O[0]=mc(()=>{},["stop"]))},Gr(F.address),9,Voe),O[8]||(O[8]=gn("span",{class:"er-flex-1"},null,-1)),F.phone?(lr(),$r("a",{key:0,href:`tel:${F.phone}`,onClick:O[1]||(O[1]=mc(()=>{},["stop"]))},O[6]||(O[6]=[gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fd4b17"},[gn("path",{d:"M162-120q-18 0-30-12t-12-30v-162q0-13 9-23.5t23-14.5l138-28q14-2 28.5 2.5T342-374l94 94q38-22 72-48.5t65-57.5q33-32 60.5-66.5T681-524l-97-98q-8-8-11-19t-1-27l26-140q2-13 13-22.5t25-9.5h162q18 0 30 12t12 30q0 125-54.5 247T631-329Q531-229 409-174.5T162-120Z"})],-1)]),8,joe)):Lo("",!0),F.email?(lr(),$r("a",{key:1,href:`mailto:${F.email}`,onClick:O[2]||(O[2]=mc(()=>{},["stop"]))},O[7]||(O[7]=[gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fd4b17"},[gn("path",{d:"M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-280 320-200v-80L480-520 160-720v80l320 200Z"})],-1)]),8,Uoe)):Lo("",!0)]),F.categories.length?(lr(),$r("div",Hoe,[O[9]||(O[9]=gn("span",{class:"text-size14 er-font-bold er-opacity-75"},"Services:",-1)),gn("ul",Goe,[(lr(!0),$r(hr,null,Hs(F.categories,G=>(lr(),$r("li",{key:G},[le(L,{status:"error"}),Fi(Gr(Ar(jr).SERVICES[G].name||""),1)]))),128))])])):Lo("",!0),F.availableSizes.length?(lr(),$r("div",Woe,[O[10]||(O[10]=gn("span",{class:"text-size14 er-font-bold er-opacity-75"},"Available Test bikes:",-1)),gn("ul",qoe,[(lr(!0),$r(hr,null,Hs(F.availableSizes,G=>(lr(),$r("li",{key:G},[le(L,{status:"error"}),Fi(Gr(Ar(jr).E_BIKES[G].name||""),1)]))),128))])])):Lo("",!0),F.noBook?Lo("",!0):(lr(),Vs(z,{key:2,type:"primary",danger:"",onClick:mc(G=>d(F),["stop"]),class:"!er-absolute er-right-4 er-bottom-5"},{default:yr(()=>O[11]||(O[11]=[gn("div",{class:"er-flex er-items-center er-text-center er-justify-center"},[gn("span",null,"Book now"),gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 -960 960 960",width:"20px",fill:"#fff"},[gn("path",{d:"m256-240-56-56 384-384H240v-80h480v480h-80v-344L256-240Z"})])],-1)])),_:2},1032,["onClick"]))],10,$oe)):Lo("",!0)],64))),128))],512)])}}},Yoe=tF(Zoe,[["__scopeId","data-v-c38d4c26"]]);function Xoe(){const e="https://b2b.newurtopia.com/ibd-api/third_party/list_shops";return new Promise(async t=>{const{data:o,code:c,message:d}=await fetch(e,{headers:{origin:"api-test.newurtopia.com",referer:"api-test.newurtopia.com"}}).then(y=>y.json());if(!d&&c===200)return t(o);t([])})}function Koe(){return new Promise(e=>{if(!navigator.geolocation)return e(jr.DEFAULT_CENTER);window.top.navigator.geolocation.getCurrentPosition(t=>(console.log(":",t.coords.latitude,t.coords.longitude),e([t.coords.longitude,t.coords.latitude])),t=>(console.error(":",t.message),e(jr.DEFAULT_CENTER)),{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})}const Joe={class:"er-flex er-flex-col er-space-y-3 er-w-[225px]"},Qoe={class:"text-size16 er-font-bold"},eae=["href","title"],tae={class:"er-space-x-4"},nae=["href","title"],rae=["href","title"],iae={class:"er-flex er-flex-col er-opacity-80"},oae={class:"er-w-1/2"},aae={key:0,class:"er-flex er-space-x-4"},sae=["src","title","alt"],lae={__name:"Markers",props:{storeList:Array,map:Object},setup(e){const t=e,o=new Map;tn(null);const c=tn({}),d=tn(!1),y=tn(null),w=tn({left:0,top:0}),i=()=>{for(const Y of o.values())Y.remove();o.clear();for(const Y of t.storeList)if(Y.show){const K=new lh.Marker({color:"#fd4b17",className:"er-cursor-pointer"}).setLngLat(Y.location).addTo(t.map);K.getElement().setAttribute("data-id",Y.id),o.set(Y.id,K)}},O=()=>document.body;async function L(Y){const K=t.storeList.find(te=>te.id===Y),{lng:J,lat:X}=t.map.getCenter();Number(cT(K.location,[J,X]))>10&&await x_(t.map,K.location),setTimeout(F,0,K)}function z(Y){N(),eF(Y)}function F(Y){if(!Y)return;d.value=!1,c.value=Y;const K=o.get(Y.id).getElement().getBoundingClientRect();w.value={left:K.left+parseInt(K.width/2),top:K.top},si(()=>{d.value=!0,si(()=>{y.value.click()})})}function N(){d.value=!1}ch.on("hidePopover",N),ch.on("storeListItemClick",F),ch.on("clickMarker",L),Lg(()=>t.storeList,i,{debounce:500,deep:!0});function G(Y){si(()=>{const K=document.querySelector(".youaregoodman");K&&!K.contains(Y.target)&&N()})}return Qr(()=>{document.addEventListener("click",G)}),Cc(()=>{document.removeEventListener("click",G)}),(Y,K)=>{const J=ps,X=jX;return d.value?(lr(),Vs(X,{key:0,title:null,trigger:"click",getPopupContainer:O,destroyTooltipOnHide:""},{content:yr(()=>[gn("div",Joe,[gn("span",Qoe,Gr(c.value.name),1),gn("a",{class:"er-whitespace-normal er-text-primary er-text-xl",href:`https://www.google.com/maps?q=${c.value.location.map(se=>se.toFixed(4)).reverse().toString()}`,title:c.value.address,target:"_blank",rel:"noopener noreferrer"},Gr(c.value.address),9,eae),gn("div",tae,[gn("a",{href:`tel:${c.value.phone}`,title:c.value.phone},K[1]||(K[1]=[gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fd4b17"},[gn("path",{d:"M162-120q-18 0-30-12t-12-30v-162q0-13 9-23.5t23-14.5l138-28q14-2 28.5 2.5T342-374l94 94q38-22 72-48.5t65-57.5q33-32 60.5-66.5T681-524l-97-98q-8-8-11-19t-1-27l26-140q2-13 13-22.5t25-9.5h162q18 0 30 12t12 30q0 125-54.5 247T631-329Q531-229 409-174.5T162-120Z"})],-1)]),8,nae),gn("a",{href:`mailto:${c.value.email}`,title:c.value.email},K[2]||(K[2]=[gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fd4b17"},[gn("path",{d:"M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-280 320-200v-80L480-520 160-720v80l320 200Z"})],-1)]),8,rae)]),K[5]||(K[5]=gn("span",{class:"text-size16 er-font-bold"},"Opening Hours:",-1)),gn("div",iae,[(lr(!0),$r(hr,null,Hs(c.value.businessHours,(se,te)=>(lr(),$r("div",{key:te,class:"er-flex er-text-xl"},[gn("span",oae,Gr(Ar(jr).WEEK[te])+":",1),gn("span",null,Gr(se||"Closed"),1)]))),128))]),c.value.categories.length?(lr(),$r("div",aae,[(lr(!0),$r(hr,null,Hs(c.value.categories,se=>(lr(),$r("img",{width:"30",src:Ar(jr).SERVICES[se].icon,title:Ar(jr).SERVICES[se].name,alt:Ar(jr).SERVICES[se].name,key:se},null,8,sae))),128)),K[3]||(K[3]=gn("span",{class:"er-flex-1"},null,-1))])):Lo("",!0),c.value.noBook?Lo("",!0):(lr(),Vs(J,{key:1,type:"primary",danger:"",onClick:K[0]||(K[0]=se=>z(c.value))},{default:yr(()=>K[4]||(K[4]=[gn("div",{class:"er-flex er-items-center er-text-center er-justify-center"},[gn("span",null,"Book now"),gn("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 -960 960 960",width:"20px",fill:"#fff"},[gn("path",{d:"m256-240-56-56 384-384H240v-80h480v480h-80v-344L256-240Z"})])],-1)])),_:1}))])]),default:yr(()=>[d.value?(lr(),$r("div",{key:0,ref_key:"popover",ref:y,class:"er-absolute",style:Qv({left:`${w.value.left}px`,top:`${w.value.top}px`})},null,4)):Lo("",!0)]),_:1})):Lo("",!0)}}},cae=tF(lae,[["__scopeId","data-v-a758b7d2"]]),uae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAB2AAAAdgB+lymcgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAVRSURBVHic7ZtbbBRVHMZ/Z2b2QrvbLb1awUpKIN4Vq6IGDF6IGqKCUR8IPqoPxBiNiSiaiIm3RxNCUsIl4Y2AVR6MEY0oUvDKJYXGVG62pVtY2tLdsrQ7O3N8mF3KVRrmTE/E/SX7Mrv7nW++nT17zv8/K5g4EsCjwDxgNnAdUAOEgFPAEWAvsA34CshMoLdAmQGsFDAMyOLDFELWhUKyJhSS5x4vPLLAmsJ7A0UEqB0B3gXeAkLlpsELtTU8VlnJ3EScGyKRsy8cdV2SOZsd6TSfpwbZOjhI1nUAbOAz4D1gJAiTQQVQBuwC7oibplzeOFW83FDPZMsa15sHbYflf/exrq9HjrqOAH4FFgG9qo0GEsDMaLTpmG13zE3EIy0zptN4zqc9XiTQlha8drCD3cODCOiVsABvnlCG6gAii+rrE60zmzbaMC8k/Mm7EtpPR/mgq5PWkz0ISEq4Fzimxi4YqoSAKPBb28DAXwjh++QBDAFNk2zeabyZ52qnIqEB+AKY5Fu8OIYqIeB94PYHKuIVCjWJmw5VVp43p97EPfEq8K6Aj1Tpq/oK3ArsTVimeaB5lpgSCSuS9TjtGPx5ZhL9do6FB3bIM67jAHcCHX61VV0BbwDWihsblZ88QLnpUma6VIfCvFg/TQAW8LYKbRVXQK2A7oRlRbpnNxMzTQWSF3M8F6InFybrOixo307Gyefw5oQBP7oqroAnJUSW1NUGdvIAMcsFoMwwmZuoBQgDC/3qqgjgYYD5kxMKpC5PmeFgIAGYV1lXPPyIX10VAdwvgIcSSif/ixBAxPACuDs2uXh4ll9d3wEIaEhYFpXjXOb6wRJeAAkrRNgwAKb71fQbQFhCRW0o+JOHsQAEUGNFwNtwRf1o+g0gyN3kv2J6K00JuH50/AYwKiB9bDTnU2Z85OVY3il7FOEVUnwN7nsOkNCXdV2G8o5fqStSDCDj5BlxHSQc96up4ldgL8CudLAVLAnkXC+AfcOniod3+9VVEcA3AFv6fS3IrsiIa+AUppwfh06cN7YfVAXgbOkfICelArlLM+x4q0xbumwfSgE4wLd+dVUE0AtsTuZytPT2KZC7NIN5L4BNqW767RzARiDpV1fVbvBjQK7o6pZpR/1kOOIaZByTjJNnbd+RYuX4ExXaqgLYB2zot/Pilc5DqP4inLBDSODDrg6G8rYA1gPtKrRVbt++A57fn81Wh4RQtjc44xp0jUZYnTzMplQ3wGG8XaCSxYfKAHLALwIW/3BqKBw2BHMSFb6WihI4OBKlJXmUluQhCs2Vp/C6SEoIYik7R8DXEmKL62pYPWM65VdZJ+jIWrx+qJOtg30IyEh4Atip0mwQFYwu4HtgfvvpbOX64ylipsldsXKMcVaKbSn5tLuflzr3y/3ZIQEcBZ4GflZtNsjNTAJYCSwBmBaN8GxNNc9UV/FgRRzrgjDyUtKWztB6coDNqQF6c2c7YRuAV4F0gF4D5T68Wr5DoflpgGwIh2VzLCabYzHZEA5L4/zmqAO04pXArxmagKXAl3iNzgs7wiOF55YWXntNsweQy1atlctWrS0GsEeHkYkp5VyGqrp6ncMDmgMwDJWduatDawC110/ROTygtjn6n6QUgG4DuikFoNuAbkoB6Dagm1IAug3ophSAbgO6KQWg24BuSgHoNqCbUgC6DeimFIBuA7opBaDbgG7+9wHoKou7AO759xYGf6PhJdAVQArgRG8PcuzOMt83PV4NugL4HXh8386fYCyAPzR50cJtgFNRVe1WVFW7eJf/LZo9TTjrGGuNr9HsRQvleH+V34b3X2Mt/ANR76AzO+lfJAAAAABJRU5ErkJggg==",dae={class:"er-relative"},hae={class:"er-flex er-flex-col er-absolute er-top-6 er-left-6 er-bg-background md:er-max-h-[96vh] er-px-8 er-pt-6 er-rounded-2xl er-shadow-2xl er-space-y-4 er-overflow-hidden er-w-full md:er-max-w-2xl mb:er-static"},fae=["src"],pae={__name:"TestRide",setup(e){const t=tn(null),o=tn(null),c=tn(null),d=tn(null),y=tn({center:jr.DEFAULT_CENTER,search:"",miles:jr.DEFAULT_RADIUS,service:[],ebikes:[],storeList:[]});let w=Xoe();function i(){const L=y.value.center;for(const z of y.value.storeList){const F=cT(L,z.location);if(z.show=!0,z.distance=F,z.noBook=z.noBook||!z.email||z.availableSizes.length<1||!z.businessHours.some(Boolean),F>y.value.miles){z.show=!1;continue}if(y.value.ebikes.length&&!UO(y.value.ebikes,z.availableSizes)){z.show=!1;continue}if(y.value.service.length&&!UO(y.value.service,z.categories)){z.show=!1;continue}}}Qr(async()=>{o.value=new lh.Map({accessToken:jr.ACCESS_TOEKN,container:t.value,style:"mapbox://styles/mapbox/streets-v12",center:jr.DEFAULT_CENTER,bounds:Lw(jr.DEFAULT_CENTER,zw(jr.DEFAULT_RADIUS)),maxBounds:[[-130,22],[-60,55]],minZoom:9,attributionControl:!1,cooperativeGestures:!0,boxZoom:!1,dragRotate:!1,doubleClickZoom:!1}),console.log(lh),o.value.on("load",function({target:L}){d.value.classList=["er-block"],c.value=new lh.Marker(d.value).setLngLat(jr.DEFAULT_CENTER).addTo(L),Koe().then(z=>{const N=L.getMaxBounds().contains(z)?z:jr.DEFAULT_CENTER;N!==jr.DEFAULT_CENTER&&L.jumpTo({center:N,bounds:Lw(N,zw(jr.DEFAULT_RADIUS))}),jr.DEFAULT_CENTER=N})}),o.value.on("moveend",()=>{const L=o.value.getCenter();y.value.center=[L.lng,L.lat]}),o.value.on("click",L=>{const z=L.originalEvent.target.closest(".mapboxgl-marker");z&&ch.emit("clickMarker",z.getAttribute("data-id"))}),o.value.on("movestart",()=>{ch.emit("hideMarkers")}),y.value.storeList=await w.then(),setTimeout(i)}),Lg(()=>y.value.miles,L=>{o.value.setCenter(y.value.center),o.value.fitBounds(Lw(y.value.center,zw(L)),{duration:1e3}),setTimeout(i)},{debounce:500,deep:!0}),Lg(()=>y.value.ebikes,i,{debounce:500,deep:!0}),Lg(()=>y.value.service,i,{debounce:500,deep:!0}),Lg(()=>y.value.center,L=>{c.value.setLngLat(L),d.value.style.display="none",requestAnimationFrame(()=>{d.value.style.display="block"}),setTimeout(i)},{debounce:10,deep:!0});function O(){window.parent.postMessage({height:document.body.scrollHeight},"*")}return window.addEventListener("load",O),window.addEventListener("resize",O),typeof ResizeObserver<"u"&&new ResizeObserver(O).observe(document.body),typeof MutationObserver<"u"&&new MutationObserver(O).observe(document.body,{childList:!0,subtree:!0}),(L,z)=>{const F=wV,N=sh;return lr(),$r(hr,null,[le(N,{theme:Ar(jr).THEME},{default:yr(()=>[le(F,{transformers:[Ar(g8)],"hash-priority":"high"},{default:yr(()=>[gn("div",dae,[Ar(jr).IS_MOBILE?Lo("",!0):(lr(),$r("div",{key:0,id:"map",ref_key:"mapContainer",ref:t},null,512)),gn("div",hae,[le(ooe,{map:o.value,formState:y.value,"onUpdate:formState":z[0]||(z[0]=G=>y.value=G)},null,8,["map","formState"]),Ar(jr).IS_MOBILE?(lr(),$r("div",{key:0,id:"map",ref_key:"mapContainer",ref:t},null,512)):Lo("",!0),le(Yoe,{map:o.value,formState:y.value,"onUpdate:formState":z[1]||(z[1]=G=>y.value=G)},null,8,["map","formState"])])]),le(cae,{map:o.value,storeList:y.value.storeList},null,8,["map","storeList"])]),_:1},8,["transformers"])]),_:1},8,["theme"]),gn("span",{ref_key:"markerPin",ref:d,class:"er-hidden"},[gn("img",{src:Ar(uae),alt:"",class:"map-marker"},null,8,fae)],512)],64)}}};b6(pae).mount("#app")});export default mae();</script>
  <style rel="stylesheet" crossorigin>.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.mapboxgl-canvas{left:0;position:absolute;top:0}.mapboxgl-map:-webkit-full-screen{height:100%;width:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom,.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-left,.mapboxgl-ctrl-right,.mapboxgl-ctrl-top,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.mapboxgl-ctrl-top-left{left:0;top:0}.mapboxgl-ctrl-top{left:50%;top:0;transform:translate(-50%)}.mapboxgl-ctrl-top-right{right:0;top:0}.mapboxgl-ctrl-right{right:0;top:50%;transform:translateY(-50%)}.mapboxgl-ctrl-bottom-right{bottom:0;right:0}.mapboxgl-ctrl-bottom{bottom:0;left:50%;transform:translate(-50%)}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-left{left:0;top:50%;transform:translateY(-50%)}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{float:left;margin:10px 0 0 10px}.mapboxgl-ctrl-top .mapboxgl-ctrl{float:left;margin:10px 0}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{float:right;margin:10px 10px 0 0}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl,.mapboxgl-ctrl-right .mapboxgl-ctrl{float:right;margin:0 10px 10px 0}.mapboxgl-ctrl-bottom .mapboxgl-ctrl{float:left;margin:10px 0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl,.mapboxgl-ctrl-left .mapboxgl-ctrl{float:left;margin:0 0 10px 10px}.mapboxgl-ctrl-group{background:#fff;border-radius:4px}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px #0000001a}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;overflow:hidden;padding:0;width:29px}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl-group button:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:only-child{border-radius:inherit}.mapboxgl-ctrl button:not(:disabled):hover{background-color:#0000000d}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23000'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E")}}@keyframes mapboxgl-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='0.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='0.9' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23000'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{background-color:#ffffff80;margin:0;padding:0 5px}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{background-color:#ffffff80;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:#0000000d}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{right:0;top:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{left:0;top:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}.mapboxgl-ctrl-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:#000000bf;text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:#ffffffbf;border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.mapboxgl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.mapboxgl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.mapboxgl-popup-close-button:hover{background-color:#0000000d}.mapboxgl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px #0000001a;padding:10px 10px 15px;pointer-events:auto;position:relative}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{left:0;opacity:1;position:absolute;top:0;transition:opacity .2s;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.mapboxgl-user-location-dot:before{animation:mapboxgl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.mapboxgl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px #00000059;box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading{height:0;width:0}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after,.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-bottom:7.5px solid #4aa1eb;content:"";position:absolute}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-left:7.5px solid transparent;transform:translateY(-28px) skewY(-20deg)}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after{border-right:7.5px solid transparent;transform:translate(7.5px,-28px) skewY(20deg)}@keyframes mapboxgl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}@media print{.mapbox-improve-map{display:none}}.mapboxgl-scroll-zoom-blocker,.mapboxgl-touch-pan-blocker{align-items:center;background:#000000b3;color:#fff;display:flex;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;text-align:center;top:0;transition:opacity .75s ease-in-out;transition-delay:1s;width:100%}.mapboxgl-scroll-zoom-blocker-show,.mapboxgl-touch-pan-blocker-show{opacity:1;transition:opacity .1s ease-in-out}.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page,.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-ctrl-geocoder,.mapboxgl-ctrl-geocoder *,.mapboxgl-ctrl-geocoder *:after,.mapboxgl-ctrl-geocoder *:before{box-sizing:border-box}.mapboxgl-ctrl-geocoder{font-size:18px;line-height:24px;font-family:Open Sans,-apple-system,BlinkMacSystemFont,Helvetica Neue,Arial,Helvetica,sans-serif;position:relative;background-color:#fff;width:100%;min-width:240px;z-index:1;border-radius:4px;transition:width .25s,min-width .25s}.mapboxgl-ctrl-geocoder--input{font:inherit;width:100%;border:0;background-color:transparent;margin:0;height:50px;color:#404040;color:#000000bf;padding:6px 45px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mapboxgl-ctrl-geocoder--input::-ms-clear{display:none}.mapboxgl-ctrl-geocoder--input:focus{color:#404040;color:#000000bf;outline:0;box-shadow:none;outline:thin dotted}.mapboxgl-ctrl-geocoder .mapboxgl-ctrl-geocoder--pin-right>*{z-index:2;position:absolute;right:8px;top:7px;display:none}.mapboxgl-ctrl-geocoder,.mapboxgl-ctrl-geocoder .suggestions{box-shadow:0 0 10px 2px #0000001a}.mapboxgl-ctrl-geocoder.mapboxgl-ctrl-geocoder--collapsed{width:50px;min-width:50px;transition:width .25s,min-width .25s}.mapboxgl-ctrl-geocoder .suggestions{background-color:#fff;border-radius:4px;left:0;list-style:none;margin:0;padding:0;position:absolute;width:100%;top:110%;top:calc(100% + 6px);z-index:1000;overflow:hidden;font-size:15px}.mapboxgl-ctrl-bottom-left .suggestions,.mapboxgl-ctrl-bottom-right .suggestions{top:auto;bottom:100%}.mapboxgl-ctrl-geocoder .suggestions>li>a{cursor:default;display:block;padding:6px 12px;color:#404040}.mapboxgl-ctrl-geocoder .suggestions>.active>a,.mapboxgl-ctrl-geocoder .suggestions>li>a:hover{color:#404040;background-color:#f3f3f3;text-decoration:none;cursor:pointer}.mapboxgl-ctrl-geocoder--suggestion-title{font-weight:700}.mapboxgl-ctrl-geocoder--suggestion-title,.mapboxgl-ctrl-geocoder--suggestion-address{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mapboxgl-ctrl-geocoder--icon{display:inline-block;vertical-align:middle;speak:none;fill:#757575;top:15px}.mapboxgl-ctrl-geocoder--icon-search{position:absolute;top:13px;left:12px;width:23px;height:23px}.mapboxgl-ctrl-geocoder--button{padding:0;margin:0;border:none;cursor:pointer;background:#fff;line-height:1}.mapboxgl-ctrl-geocoder--icon-close{width:20px;height:20px;margin-top:8px;margin-right:3px}.mapboxgl-ctrl-geocoder--button:hover .mapboxgl-ctrl-geocoder--icon-close{fill:#909090}.mapboxgl-ctrl-geocoder--icon-geolocate{width:22px;height:22px;margin-top:6px;margin-right:3px}.mapboxgl-ctrl-geocoder--icon-loading{width:26px;height:26px;margin-top:5px;margin-right:0;animation:rotate .8s infinite cubic-bezier(.45,.05,.55,.95)}.mapboxgl-ctrl-geocoder--powered-by{display:block;float:left;padding:6px 12px 9px;font-size:13px}.mapboxgl-ctrl-geocoder--powered-by a{color:#909090}.mapboxgl-ctrl-geocoder--powered-by a:not(:hover){text-decoration:none}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media screen and (min-width: 640px){.mapboxgl-ctrl-geocoder.mapboxgl-ctrl-geocoder--collapsed{width:36px;min-width:36px}.mapboxgl-ctrl-geocoder{width:33.3333%;font-size:15px;line-height:20px;max-width:360px}.mapboxgl-ctrl-geocoder .suggestions{font-size:13px}.mapboxgl-ctrl-geocoder--icon{top:8px}.mapboxgl-ctrl-geocoder--icon-close{width:16px;height:16px;margin-top:3px;margin-right:0}.mapboxgl-ctrl-geocoder--icon-geolocate{width:18px;height:18px;margin-top:2px;margin-right:0}.mapboxgl-ctrl-geocoder--icon-search{left:7px;width:20px;height:20px}.mapboxgl-ctrl-geocoder--input{height:36px;padding:6px 35px}.mapboxgl-ctrl-geocoder--icon-loading{width:26px;height:26px;margin-top:-2px;margin-right:-5px}.mapbox-gl-geocoder--error{color:#909090;padding:6px 12px;font-size:16px;text-align:center}.mapboxgl-ctrl-geocoder--powered-by{font-size:11px!important}}#app .ant-divider-vertical{height:100%}#app .ant-collapse{margin:0 -20px;border-radius:0;background-color:#eee}#app .ant-collapse .ant-collapse-header{padding:0}#app .ant-collapse .ant-collapse-content-box{padding:20px}#app .ant-collapse .ant-divider{margin:12px 0}#app .ant-btn-link span{text-decoration-line:underline}#app input[type=search]::-webkit-search-cancel-button{display:none}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content{max-width:100%;margin-block-start:0}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative>svg{position:absolute;right:0;top:0;transform:translateY(-32px);cursor:pointer}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-cell-disabled{pointer-events:all;cursor:not-allowed}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-cell-disabled .ant-picker-calendar-date{border:none}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-cell-disabled:before{height:80%}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-calendar-date-today:before{border:none}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-calendar-date{width:75%;height:100%;display:flex;align-items:center;justify-items:center;text-align:center;margin:auto;border:1px solid #f8f8f8}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-picker-date-panel .ant-picker-calendar-date .ant-picker-calendar-date-value{flex:1;font-weight:500}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .ant-descriptions-header{margin-bottom:10px}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .next svg{transition:all .3s}.modal .ant-modal-content .ant-modal-confirm-body .ant-modal-confirm-content>.er-relative .next:hover svg{transform:translate(3px)}#app a[data-v-c38d4c26]{white-space:normal;text-align:left;border-radius:0;font-size:13px;font-weight:500}.list-move[data-v-c38d4c26],.list-enter-active[data-v-c38d4c26],.list-leave-active[data-v-c38d4c26]{transition:all .3s ease}.list-enter-from[data-v-c38d4c26],.list-leave-to[data-v-c38d4c26]{opacity:0;transform:translateY(30px)}.list-leave-active[data-v-c38d4c26]{position:absolute}.ant-popover a[data-v-a758b7d2]{color:#fd4b17;transition:all .3s}.ant-popover a[data-v-a758b7d2]:hover{text-decoration-line:underline;opacity:.85}@font-face{font-family:Helvetica Now Display;src:url(https://cdn.shopify.com/s/files/1/0583/5810/4213/files/subset-HelveticaNowDisplay-Regular.woff2) format("woff2");font-weight:400;font-display:auto;font-style:normal;font-stretch:normal;unicode-range:U+0020-007E}@font-face{font-family:Helvetica Now Display;src:url(https://cdn.shopify.com/s/files/1/0583/5810/4213/files/subset-HelveticaNowDisplay-Medium.woff2) format("woff2");font-weight:500;font-display:auto;font-style:normal;font-stretch:normal;unicode-range:U+0020-007E}@font-face{font-family:Helvetica Now Display;src:url(https://cdn.shopify.com/s/files/1/0583/5810/4213/files/subset-HelveticaNowDisplay-Bold.woff2) format("woff2");font-weight:700;font-display:auto;font-style:normal;font-stretch:normal;unicode-range:U+0020-007E}@font-face{font-family:Helvetica Now Display;src:url(//newurtopia.com/cdn/shop/files/subset-HelveticaNowDisplay-ExtraBold.woff2?v=11531018436179650945) format("woff2");font-weight:800;font-display:auto;font-style:normal;font-stretch:normal;unicode-range:U+0020-007E}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.text-size12{font-size:12px;font-weight:400;line-height:1.375;letter-spacing:.025em}.text-size14{font-size:14px;font-weight:400;line-height:1.375;letter-spacing:.025em}.text-size16{font-size:16px;font-weight:400;line-height:1.375;letter-spacing:.025em}.text-size20{font-size:20px;font-weight:400;line-height:1.375;letter-spacing:.025em}.\!er-absolute{position:absolute!important}.er-absolute{position:absolute}.er-relative{position:relative}.er-bottom-5{bottom:1.25rem}.er-left-6{left:1.5rem}.er-right-2{right:.5rem}.er-right-4{right:1rem}.er-top-2{top:.5rem}.er-top-6{top:1.5rem}.er-my-2{margin-top:.5rem;margin-bottom:.5rem}.er-my-4{margin-top:1rem;margin-bottom:1rem}.er-my-6{margin-top:1.5rem;margin-bottom:1.5rem}.er-mb-6{margin-bottom:1.5rem}.er-ml-4{margin-left:1rem}.er-mr-3{margin-right:.75rem}.er-mt-4{margin-top:1rem}.er-block{display:block}.\!er-flex{display:flex!important}.er-flex{display:flex}.er-grid{display:grid}.er-hidden{display:none}.er-aspect-\[16\/10\]{aspect-ratio:16/10}.er-w-1\/2{width:50%}.er-w-5\/12{width:41.666667%}.er-w-\[225px\]{width:225px}.er-w-full{width:100%}.er-min-w-10{min-width:2.5rem}.er-flex-1{flex:1 1 0%}.er-cursor-pointer{cursor:pointer}.er-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.er-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.er-flex-col{flex-direction:column}.er-flex-wrap{flex-wrap:wrap}.er-items-start{align-items:flex-start}.er-items-center{align-items:center}.er-justify-end{justify-content:flex-end}.er-justify-center{justify-content:center}.er-justify-between{justify-content:space-between}.er-gap-3{gap:.75rem}.er-gap-6{gap:1.5rem}.er-gap-y-2{row-gap:.5rem}.er-space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.er-space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.er-space-y-0\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.125rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.125rem * var(--tw-space-y-reverse))}.er-space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.er-space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.er-space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.er-space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.er-overflow-auto{overflow:auto}.er-overflow-hidden{overflow:hidden}.er-whitespace-normal{white-space:normal}.er-whitespace-nowrap{white-space:nowrap}.er-rounded-2xl{border-radius:1rem}.er-rounded-3xl{border-radius:1.5rem}.er-rounded-lg{border-radius:.5rem}.er-border{border-width:1px}.er-border-solid{border-style:solid}.er-border-border{--tw-border-opacity: 1;border-color:rgb(235 237 240 / var(--tw-border-opacity, 1))}.er-bg-\[\#eee\]{--tw-bg-opacity: 1;background-color:rgb(238 238 238 / var(--tw-bg-opacity, 1))}.er-bg-background{--tw-bg-opacity: 1;background-color:rgb(247 248 250 / var(--tw-bg-opacity, 1))}.er-bg-primary\/75{background-color:#fd4b17bf}.er-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.er-object-cover{-o-object-fit:cover;object-fit:cover}.er-p-4{padding:1rem}.\!er-px-4{padding-left:1rem!important;padding-right:1rem!important}.er-px-10{padding-left:2.5rem;padding-right:2.5rem}.er-px-8{padding-left:2rem;padding-right:2rem}.er-py-1{padding-top:.25rem;padding-bottom:.25rem}.er-py-4{padding-top:1rem;padding-bottom:1rem}.er-py-8{padding-top:2rem;padding-bottom:2rem}.er-pb-4{padding-bottom:1rem}.er-pb-6{padding-bottom:1.5rem}.er-pb-8{padding-bottom:2rem}.er-pl-2{padding-left:.5rem}.er-pr-4{padding-right:1rem}.er-pt-6{padding-top:1.5rem}.er-text-left{text-align:left}.er-text-center{text-align:center}.er-align-bottom{vertical-align:bottom}.er-text-2xl{font-size:1.5rem;line-height:2rem}.er-text-xl{font-size:1.25rem;line-height:1.75rem}.er-font-bold{font-weight:700}.er-font-medium{font-weight:500}.\!er-text-primary{--tw-text-opacity: 1 !important;color:rgb(253 75 23 / var(--tw-text-opacity, 1))!important}.er-text-dark{--tw-text-opacity: 1;color:rgb(36 39 41 / var(--tw-text-opacity, 1))}.er-text-primary{--tw-text-opacity: 1;color:rgb(253 75 23 / var(--tw-text-opacity, 1))}.er-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.er-underline{text-decoration-line:underline}.er-opacity-75{opacity:.75}.er-opacity-80{opacity:.8}.er-shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.er-transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}@keyframes button-span{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.er-button{--er-btn-bg-color: #fd4b17;--er-btn-text-color: #ffffff;position:relative;font-family:inherit;font-size:1.6rem;font-weight:inherit;line-height:1.25em;border-radius:25px;display:inline-flex;box-sizing:border-box;padding:12px 36px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:all .3s;text-align:center;align-items:center;gap:8px;justify-content:center;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;white-space:nowrap;overflow:hidden;border:2px solid var(--er-btn-bg-color);background-color:var(--er-btn-bg-color);color:var(--er-btn-text-color)}.er-button:hover{filter:brightness(1.2)}.er-button:active{filter:brightness(.8)}.er-button[disabled]{cursor:not-allowed;filter:brightness(.8);opacity:.6}.er-button.er-button-loading{pointer-events:none;color:transparent}.er-button.er-button-loading:after{content:"";position:absolute;width:20px;height:20px;border:4px solid var(--er-btn-text-color);border-top:4px solid transparent;border-radius:50%;animation:button-span 1s linear infinite}.er-button-outline{background-color:transparent;color:var(--er-btn-bg-color);border-color:var(--er-btn-bg-color)}.er-button-outline.er-button-loading:after{border-color:var(--er-btn-bg-color);border-top-color:transparent}.er-button-text{background-color:transparent;color:var(--er-btn-bg-color);border-color:transparent;padding:0;line-height:inherit;font-size:inherit}.er-button-text:hover{text-decoration:underline}.er-button>img,.er-button>svg{display:inline-block;-o-object-fit:contain;object-fit:contain;max-height:1.4em}.er-button-dark{--er-btn-bg-color: #2c2c2c;--er-btn-text-color: #fff}.er-button-white{--er-btn-bg-color: #fff;--er-btn-text-color: #000}.er-button-sale{--er-btn-bg-color: #d50b28;--er-btn-text-color: #fff}.background-image{position:relative;overflow:hidden;z-index:0}.background-image>img,.background-image>video,.background-image>picture>img{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;display:block;margin:0;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;z-index:-1}.background-mask{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;z-index:-1}@keyframes bounce{0%{transform:translateY(-50%) scale(1)}30%{transform:translateY(-65%) scale(1.1,.9)}50%{transform:translateY(-80%) scale(.9,1.1)}75%{transform:translateY(-65%) scale(1)}to{transform:translateY(-50%) scale(1)}}.map-marker{width:50px;height:50px;border-radius:1px;transform:translateY(-50%);animation:bounce .6s ease-out}#map{height:100vh;width:100vw;-webkit-user-select:none;-moz-user-select:none;user-select:none}@media (max-width: 767px){#map{width:100vw;height:100vw;margin-left:-20px;margin-top:0}}.marker\:er-text-transparent *::marker{color:transparent}.marker\:er-text-transparent::marker{color:transparent}.hover\:er-opacity-85:hover{opacity:.85}@media (min-width: 768px){.md\:er-max-h-\[96vh\]{max-height:96vh}.md\:er-max-w-2xl{max-width:42rem}}@media (max-width: 768px){.mb\:er-static{position:static}.mb\:er-max-h-screen{max-height:100vh}}</style>
</head>
<style>
  * {
    margin: 0;
    padding: 0;
    border: 0;
  }

  body,
  html {
    font-family: "Helvetica Now Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, Helvetica Neue, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    font-size: 10px;
  }

  div {
    box-sizing: border-box;
  }

  img,
  video {
    max-width: 100%;
    height: auto;
  }



  .flex1 {
    flex: 1;
  }


  a {
    text-decoration: none;
  }

  header,
  footer {
    height: 106px;
    display: flex;
    align-items: center;
    justify-content: space-evenly;
    overflow: hidden;
  }

  header img,
  footer img {
    height: 80%;
    width: auto;
  }
</style>

<body>
  <div id="app"></div>

</body>
</html>